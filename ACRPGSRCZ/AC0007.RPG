     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas AC Set active flag for batch job')
     F*****************************************************************
     F*                                                               *
     F*  Midas - System Control Module                            *
     F*                                                               *
     F*  AC0007 - Set active flag on datafile of batch jobs           *
     F*                                                               *
     F*  Function: This program sets the active flag for a            *
     F*    (COB)   specific batch job.                                *
     F*                                                               *
     F*  Called By: ACC0001 - Checking of components in COB           *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*  LAST AMEND NO. S01491 *CREATE     DATE 01OCT94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
     F*  S01491 - Autocall.                                           *
     F*                                                               *
     F*****************************************************************
     F*****************************************************************
     F*
     FACDTAFL0UF  E           K        DISK         KINFSR *PSSR
     F*
      /EJECT
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   89  - Record not found                                      *
     F*                                                               *
     F* U7+U8 - Database Error                                        *
     F*                                                               *
     F*****************************************************************
      /EJECT
     E/TITLE E-SPECIFICATIONS
     E                    CPY@    1   1 80
     E*** Array for Object Copyright Statement.
     E*
      /EJECT
     I*
     ILDA       E DSLDA
     I***  Local data area for database error details.
     I*
     IPSDS       SDS
     I***  Program Status Data Structure.
     I                                      244 253 JOB
     I                                      254 263 USER
     I*
      /EJECT
     C/TITLE Main Processing
     C*
     C***  Copyright Statement.
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C           *ENTRY    PLIST
     C                     PARM           WJOB   10
     C                     PARM           WFLG    1
     C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVEL*BLANKS   DBFILE
     C                     MOVEL*BLANKS   DBKEY
     C                     MOVEL'AC0007'  DBPGM
     C                     Z-ADD*ZEROS    DBASE
     C                     OUT  LDA
     C*
     C***  Retrieve batch job record from datafile
     C*
     C           WJOB      CHAIN@DTAFL0              89
     C           *IN89     IFEQ '1'
     C*
     C***  Record not found - Database Error.
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'ACDTAFL0'DBFILE           *************
     C                     MOVELWJOB      DBKEY            * DBASE 001 *
     C                     Z-ADD1         DBASE            *************
     C                     OUT  LDA
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     RETRN
     C*
     C                     ENDIF
     C*
     C***  Update active flag
     C*
     C                     MOVELWFLG      APBJAF
     C                     UPDAT@DTAFL0
     C*
     C                     MOVE '1'       *INLR
     C                     RETRN
      /EJECT
     C/TITLE SR/*PSSR
     C*****************************************************************
     C*                                                               *
     C*  *PSSR  - Subroutine to handle Database Errors.               *
     C*                                                               *
     C*****************************************************************
     C*
     C           *PSSR     BEGSR                            *** *PSSR ***
     C*
     C***  Dump and return to the calling program
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     DUMP
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C********************************************************************
      /EJECT
** CPY@ - OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
