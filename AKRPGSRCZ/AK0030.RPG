     H        1
     F********************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas AK FRA/IRS account keys generation')             *
     F********************************************************************
     F*                                                                  *
     F*  Midas - Account Key Generator
     F*                                                                  *
     F*   AK0030  - FRA/IRS Account Keys Generation                      *
     F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. AR1071025          Date 16Jan13               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245915             Date 22Feb07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG10281           Date 01Feb06               *
      *                 CDL038             Date 10May05               *
      *                 CAS010             Date 09Feb05               *
      *                 CAS007             Date 26Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS005             Date 16Dec02               *
      *                 208275             Date 26Jun02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 188450             Date 22May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 186133             Date 25Jan01               *
      *                 CIR003             Date 12Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 01MAR99               *
      *                 CTI002 Exposure Management / TI Interface     *
     F*                  S01408             Date 09OCT96                 *
     F*                  S01408             Date 08SEP96                 *
     F*                  098903             Date 23FEB96                 *
     F*                  CIR001             DATE 16JAN96                 *
     F*                  085263             DATE 19APR95                 *
     F*                  047369             DATE 10JAN94                 *
     F*                                                                  *
     F********************************************************************
      *                                                                  *
      *  MD046248 - Finastra Rebranding                               *
      *  AR1071025 - Erroneous field will only highlight after the    *
      *              second enter (Recompile)                         *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  245915 - Made Transfer Keys generated switchable with CDL039 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG10281 - Transfer keys to be generated (CDL039)            *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CAS010 - IAS + PB Enhancements Upgrade to MidasPlus          *
      *  CAS007 - Hedge Accounting Control                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  208275 - Wrong error indicators being determined             *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  188450 - Check for Deal Type/Subtype validity (make consistant  *
      *           with MM/FX processing)                                 *
     F*  186133 - DR and CR entries of certain A/C keys for FR and       *
     F*           RX deals should be blank when Exposure Account/        *
     F*           Posting Reference/Contra A/C fields are blank.         *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps.             *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps.                                  *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*   S01408 - Addition of core hook AK0030CCP7                      *
     F*   S01408 - Addition of core hook AK0030CCP6                      *
     F*          - Addition of core hook AK0030CCP5                      *
     F*          - Addition of core hook AK0030CCP4                      *
     F*          - Addition of core hook AK0030CCP3                      *
     F*          - Addition of core hook AK0030CCP2                      *
     F*          - Addition of core hook AK0030CCP1                      *
     F*   098903 - Account Keys Generation for FRA/IRS should also       *
     F*            generate UL and UP account keys.                      *
     F*   CIR001 - Interest Rate Calendars                               *
     F*   085263 - Narrative code 28 redundant - remove from array.      *
     F*   047369 - NARRATIVE CODES SHOULD BE ALPHA AND NOT NUMERIC.      *
     F*            RECOMPILE OVER AMENDED FILE ZACKEYAL.                 *
     F*                                                                  *
     F*****************************************************************
     FAK0030DFCF  E                    WORKSTN
     FZACKEYALO   E                    DISK                      A
     FSDNARRL1IF  E           K        DISK
     FSDDLSTL1IF  E           K        DISK
     FSDACODL0IF  E           K        DISK
     FSDCURRL1IF  E           K        DISK                               CIR003
     FFDDTSTL1IF  E           K        DISK                               188450
     FSDBOOKL1IF  E           K        DISK                                                   CAS004
     F/COPY WNCPYSRC,AK0030F001
     F********************************************************************
     F* ID F  C  H  L   FUNCTION OF INDICATORS
     F*
     F* 03 Exit requested (F3 pressed)
     F* 11 Chain to SDNARRL1 for Required Narrative failed
     F* 12 Initial screen requested (F12 pressed from second screen)
      * 23 Effective/Ineffective Fair Value Hedge Profit Contra Account Invalid               CAS004
      * 24 Posting Reference (SEPRF1) Invalid                                                 CAS004
      * 29 Hedge/Trading Profit Account Invalid                                               CAS004
      * 30 Effective/Ineffective Fair Value Hedge Loss Contra Account Invalid                 CAS004
     F* 31 Unrealized Profit Account (F9) invalid                         098903
     F* 32 Posting Reference 1 or 3? (F9PREF) invalid                     098903
     F* 33 Unrealized Profit Contra Account (F10) invalid                 098903
     F* 34 Unrealized Loss Account (F11) invalid                          098903
     F* 35 Posting Reference 1 or 3? (F11PRF) invalid                     098903
     F* 36 Unrealized Loss Contra Account (F12) invalid                   098903
     F* 37 1st Screen Validated                                           098903
      * 38 Posting Reference (SEPRF2) Invalid                                                 CAS004
      * 40 Hedge/Trading Loss Account Invalid                                                 CAS004
     F* 41 Error occurred in initial screen
     F* 42 Display of Contingent Account field                            CIR003
     F* 43 Display of Swap Position Account field                         CIR003
      * 45 Effective/Ineffective Cash Flow Hedge Profit Contra Account Invalid                CAS004
      * 46 Posting Reference (SEPRF3) Invalid                                                 CAS004
      * 47 Other Comprehensive Income Account/Trading Profit Account Invalid                  CAS004
      * 48 Effective/Ineffective Cash Flow Hedge Loss Contra Account Invalid                  CAS004
      * 49 Posting Reference (SEPRF4) Invalid                                                 CAS004
     F* 50 Invalid Deal Type
     F* 51 Invalid Sub Type
     F* 52 Hedge or Trade? invalid
     F* 53 Principal (F1) invalid
     F* 54 Principal Contra Account (F2) invalid
     F* 55 Exposure Account (F3) invalid
     F* 56 Posting Reference 1 or 3? (F3PREF) invalid
     F* 57 Exposure Contra Account (F4) invalid
     F* 58 Profit Amortisation/Accrual  (F5) invalid
     F* 59 Posting Reference 1 or 3? (F5PREF) invalid
     F* 60 Profit Income Account (F6) invalid
     F* 61 Loss Amortisation Account (F7) invalid
     F* 62 Posting Reference 1 or 3? (F7PREF) invalid
     F* 63 Loss Expense Account (F8) invalid
     F* 64 FRA/IRS screen in error
     F* 65 F3 entered
     F* 66 F3PREF entered
     F* 67 F4 entered
      * 68 Other Comprehensive Income Account/Trading Loss Account Invalid                    CAS004
     F* 71 Fees and Premiums Income (SFINC) invalid                       CIR001
     F* 72 Fees Received Account (SFRCD) invalid                          CIR001
     F* 73 Fees Receivable Account (SFRCB) invalid                        CIR001
     F* 74 Fees Receivable Contra Account (SFRCC) invalid                 CIR001
     F* 75 Fees and Premiums Expense (SFEXP) invalid                      CIR001
     F* 76 Fees Paid Account (SFPYD) invalid                              CIR001
     F* 77 Fees Payable Account (SFPYB) invalid                           CIR001
     F* 78 Fees Payable Contra Account (SFPYC) invalid                    CIR001
     F* 81 Buy-Outs Income (SBINC) invalid                                CIR001
     F* 82 Buy-Outs Receivable Account (SBRCB) invalid                    CIR001
     F* 83 Buy-Outs Receivable Contra Account (SBRCC) invalid             CIR001
     F* 84 Buy-Outs Expense (SBEXP) invalid                               CIR001
     F* 85 Buy-Outs Payable Account (SBPYB) invalid                       CIR001
     F* 86 Buy-Outs Payable Contra Account (SBPYC) invalid                CIR001
     F* U4 Not all Narrative Codes set up - terminate program
     F* U8 Database error - terminate program
     F********************************************************************
     E************        PN          8  2               Missing Narrative085263
     E                    PN          7  2               Narrative codes  085263
     E                    FRAT   10  10  2               FRA/IRS Deal Types
     E                    NR      8   8  2               Reqd. Narratives
     E                    CPY@    1   1 80               Copyright Array
     E                    CCYA      200  3               Currency Array   CIR003
     E/COPY WNCPYSRC,AK0030E001
     E********************************************************************
     I**   Data Structures
     I**
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I** Data Structure for Compilation  - Copyright Insertion
     I*
     IPSDS       SDS
     I                                      244 253 WSID
     I                                      254 263 USRID
     I** Data Structure to retrieve User and Workstation ID.
     I*
     IRUNDAT      DS                             13
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 @MBIN
     I** Rundate Data Area
     I*
     ILDA         DS                            256
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I** Local Data Area
     I*
     IDSFDY     E DSDSFDY
     I** First DS for Access Programs, Short Data Structure
     I*
     IDSSDY     E DSDSSDY                                                                     CGL029
     I** Second DS for Access Programs, Long Data Structure                                   CGL029
     I*                                                                                       CGL029
     ISDBANK    E DSSDBANKPD
     I** Bank Details
     I*
     ISDACOD    E DSSDACODPD                                              CIR001
     I**  EXTERNAL DS FOR ACCOUNT CODES DETAILS                           CIR001
     I*                                                                   CIR001
     ISDDEAL    E DSSDDEALPD                                                                  CAS004
      ** Dealing Data Details                                                                 CAS004
     I              QQACCD                          QQACC1                                    CGL029
      *                                                                                       CAS004
     ISDTCLS    E DSSDTCLSPD                                                                  CDL038
     I** Transaction Classes                                                                  CDL038
     IDLAKEY      DS
     I                                        1  10 DLKEY
     I                                        1   2 DTYPD
     I                                        3   3 EVENTD
     I                                        4   5 STYPD
     I                                        6   8 CYD
     I                                        9   9 FBD
     I                                       10  10 AMTD
     I                                       11  14 CLASD                                     CDL038
     I**********                             11  52 FMKEYS                                    CGL029
     I**********                             11  22 FIRSTA                                    CGL029
     I**********                             11  14 AC1                                       CGL029
     I**********                             15  18 AC2                                       CGL029
     I**********                             19  22 AC3                                       CGL029
     I**********                             23  34 SECA                                      CGL029
     I**********                             23  26 AC4                                       CGL029
     I**********                             27  30 AC5                                       CGL029
     I**********                             31  34 AC6                                       CGL029
     I**********                             35  40 FIRSTN                                    CGL029
     I**********                             35  36 PN1                                       CGL029
     I**********                             37  38 PN2                                       CGL029
     I**********                             39  40 PN3                                       CGL029
     I**********                             41  46 SECN                                      CGL029
     I**********                             41  42 PN4                                       CGL029
     I**********                             43  44 PN5                                       CGL029
     I**********                             45  46 PN6                                       CGL029
     I**********                             47  49 FIRSTP                                    CGL029
     I**********                             47  47 PR1                                       CGL029
     I**********                             48  48 PR2                                       CGL029
     I**********                             49  49 PR3                                       CGL029
     I**********                             50  52 SECP                                      CGL029
     I**********                             50  50 PR4                                       CGL029
     I**********                             51  51 PR5                                       CGL029
     I**********                             52  52 PR6                                       CGL029
     I                                       11  88 FMKEYS                                    CGL029
     I                                       11  40 FIRSTA                                    CGL029
     I                                       11  20 AC1                                       CGL029
     I                                       21  30 AC2                                       CGL029
     I                                       31  40 AC3                                       CGL029
     I                                       41  70 SECA                                      CGL029
     I                                       41  50 AC4                                       CGL029
     I                                       51  60 AC5                                       CGL029
     I                                       61  70 AC6                                       CGL029
     I                                       71  76 FIRSTN                                    CGL029
     I                                       71  72 PN1                                       CGL029
     I                                       73  74 PN2                                       CGL029
     I                                       75  76 PN3                                       CGL029
     I                                       77  82 SECN                                      CGL029
     I                                       77  78 PN4                                       CGL029
     I                                       79  80 PN5                                       CGL029
     I                                       81  82 PN6                                       CGL029
     I                                       83  85 FIRSTP                                    CGL029
     I                                       83  83 PR1                                       CGL029
     I                                       84  84 PR2                                       CGL029
     I                                       85  85 PR3                                       CGL029
     I                                       86  88 SECP                                      CGL029
     I                                       86  86 PR4                                       CGL029
     I                                       87  87 PR5                                       CGL029
     I                                       88  88 PR6                                       CGL029
     ISCRN2       DS                                                      CIR001
     I**********                              1   4 SFINC                              CIR001 CGL029
     I**********                              5   8 SFRCD                              CIR001 CGL029
     I**********                              9  12 SFRCB                              CIR001 CGL029
     I**********                             13  16 SFRCC                              CIR001 CGL029
     I**********                             17  20 SFEXP                              CIR001 CGL029
     I**********                             21  24 SFPYD                              CIR001 CGL029
     I**********                             25  28 SFPYB                              CIR001 CGL029
     I**********                             29  32 SFPYC                              CIR001 CGL029
     I                                        1  10 SFINC                                     CGL029
     I                                       11  20 SFRCD                                     CGL029
     I                                       21  30 SFRCB                                     CGL029
     I                                       31  40 SFRCC                                     CGL029
     I                                       41  50 SFEXP                                     CGL029
     I                                       51  60 SFPYD                                     CGL029
     I                                       61  70 SFPYB                                     CGL029
     I                                       71  80 SFPYC                                     CGL029
     ISCRN3       DS                                                      CIR001
     I**********                              1   4 SBINC                              CIR001 CGL029
     I**********                              5   8 SBRCB                              CIR001 CGL029
     I**********                              9  12 SBRCC                              CIR001 CGL029
     I**********                             13  16 SBEXP                              CIR001 CGL029
     I**********                             17  20 SBPYB                              CIR001 CGL029
     I**********                             21  24 SBPYC                              CIR001 CGL029
     I                                        1  10 SBINC                                     CGL029
     I                                       11  20 SBRCB                                     CGL029
     I                                       21  30 SBRCC                                     CGL029
     I                                       31  40 SBEXP                                     CGL029
     I                                       41  50 SBPYB                                     CGL029
     I                                       51  60 SBPYC                                     CGL029
     IWHEDG1      DS                                                                          CAS004
     I**********                              1   4 SEFVHP                             CAS004 CGL029
     I**********                              5   5 SEPRF1                             CAS004 CGL029
     I**********                              6   9 SEFHPA                             CAS004 CGL029
     I**********                             10  13 SEFVHL                             CAS004 CGL029
     I**********                             14  14 SEPRF2                             CAS004 CGL029
     I**********                             15  18 SEFHLA                             CAS004 CGL029
     I**********                             19  22 SECFHP                             CAS004 CGL029
     I**********                             23  23 SEPRF3                             CAS004 CGL029
     I**********                             24  27 SEPOCI                             CAS004 CGL029
     I**********                             28  31 SECFHL                             CAS004 CGL029
     I**********                             32  32 SEPRF4                             CAS004 CGL029
     I**********                             33  36 SELOCI                             CAS004 CGL029
     I                                        1  10 SEFVHP                                    CGL029
     I                                       11  11 SEPRF1                                    CGL029
     I                                       12  21 SEFHPA                                    CGL029
     I                                       22  31 SEFVHL                                    CGL029
     I                                       32  32 SEPRF2                                    CGL029
     I                                       33  42 SEFHLA                                    CGL029
     I                                       43  52 SECFHP                                    CGL029
     I                                       53  53 SEPRF3                                    CGL029
     I                                       54  63 SEPOCI                                    CGL029
     I                                       64  73 SECFHL                                    CGL029
     I                                       74  74 SEPRF4                                    CGL029
     I                                       75  84 SELOCI                                    CGL029
     IWHEDG2      DS                                                                          CAS004
     I**********                              1   4 SIFVHP                             CAS004 CGL029
     I**********                              5   5 SIPRF1                             CAS004 CGL029
     I**********                              6   9 SIFTPA                             CAS004 CGL029
     I**********                             10  13 SIFVHL                             CAS004 CGL029
     I**********                             14  14 SIPRF2                             CAS004 CGL029
     I**********                             15  18 SIFTLA                             CAS004 CGL029
     I**********                             19  22 SICFHP                             CAS004 CGL029
     I**********                             23  23 SIPRF3                             CAS004 CGL029
     I**********                             24  27 SICTPA                             CAS004 CGL029
     I**********                             28  31 SICFHL                             CAS004 CGL029
     I**********                             32  32 SIPRF4                             CAS004 CGL029
     I**********                             33  36 SICTLA                             CAS004 CGL029
     I                                        1  10 SIFVHP                                    CGL029
     I                                       11  11 SIPRF1                                    CGL029
     I                                       12  21 SIFTPA                                    CGL029
     I                                       22  31 SIFVHL                                    CGL029
     I                                       32  32 SIPRF2                                    CGL029
     I                                       33  42 SIFTLA                                    CGL029
     I                                       43  52 SICFHP                                    CGL029
     I                                       53  53 SIPRF3                                    CGL029
     I                                       54  63 SICTPA                                    CGL029
     I                                       64  73 SICFHL                                    CGL029
     I                                       74  74 SIPRF4                                    CGL029
     I                                       75  84 SICTLA                                    CGL029
     IWHEDG3      DS                                                                          CAS005
     I**********                              1   4 SUFVHP                             CAS005 CAS010
     I**********                              5   5 SUPRF1                             CAS005 CAS010
     I**********                              6   9 SUFTPA                             CAS005 CAS010
     I**********                             10  13 SUFVHL                             CAS005 CAS010
     I**********                             14  14 SUPRF2                             CAS005 CAS010
     I**********                             15  18 SUFTLA                             CAS005 CAS010
     I**********                             19  22 SUCFHP                             CAS005 CAS010
     I**********                             23  23 SUPRF3                             CAS005 CAS010
     I**********                             24  27 SUCTPA                             CAS005 CAS010
     I**********                             28  31 SUCFHL                             CAS005 CAS010
     I**********                             32  32 SUPRF4                             CAS005 CAS010
     I**********                             33  36 SUCTLA                             CAS005 CAS010
     I                                        1  10 SUFVHP                                    CAS010
     I                                       11  11 SUPRF1                                    CAS010
     I                                       12  21 SUFTPA                                    CAS010
     I                                       22  31 SUFVHL                                    CAS010
     I                                       32  32 SUPRF2                                    CAS010
     I                                       33  42 SUFTLA                                    CAS010
     I                                       43  52 SUCFHP                                    CAS010
     I                                       53  53 SUPRF3                                    CAS010
     I                                       54  63 SUCTPA                                    CAS010
     I                                       64  73 SUCFHL                                    CAS010
     I                                       74  74 SUPRF4                                    CAS010
     I                                       75  84 SUCTLA                                    CAS010
     I/COPY WNCPYSRC,AK0030I001
     C           DTST      KLIST                                          188450
     C                     KFLD           TYPE                            188450
     C                     KFLD           STYP                            188450
     C                     KFLD           CLAS                            CDL038
     C********************************************************************
     C                     EXSR INIT
     C                     EXSR MAIN
     C                     SETON                     LR
     C                     RETRN
     C********************************************************************
     C*
     C*  MAIN - Main processing
     C*
     C*  Calls - Y2CLMSC - Clear program message queue (external)
     C*        - FRP     - Validate FRA/IRS screen & Generate
     C*
     C********************************************************************
     C           MAIN      BEGSR
     C*
     C           *IN03     DOWEQ'0'
     C           *IN07     ANDEQ'0'
     C**
     C** Initialise counts of No. Inserts & Amends
     C**
     C                     WRITE#MSGCTL
     C                     EXFMTACKEYSF
     C**
     C** Clear messages from program message queue.
     C**
     C                     CALL 'Y2CLMSC'
     C                     PARM SPGMQ     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C**
     C** If F3 not pressed, validate initial screen
     C**
     C           *IN03     IFEQ '0'
     C*
     C** Set off screen selection indicators
     C*
     C                     SETOF                     415051
     C                     SETOF                     98                                       CDL038
     C**
     C** Send message if required narratives not all found on SDNARRL1
     C**
     C           *IN11     IFEQ '1'
     C                     MOVEL'USR1776' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     41    Initial scr error
     C                     ELSE
     C**
     C**   Send message if Deal Type is blank
     C**
     C           TYPE      IFEQ *BLANKS
     C                     SETON                     50    Deal Type invalid
     C                     MOVEL'USR4217' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE                            Deal Type valid
     C           TYPE      LOKUPFRAT                     80
     C*
     C           *IN80     IFEQ '0'                        Deal Type not found
     C                     SETON                     4150  Deal Type invalid
     C                     MOVEL'USR4217' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END                             Deal Type not found
     C*
     C                     END                             Valid Deal Type
     C**
     C**   Send message if Deal Sub Type is blank or invalid
     C**
     C           STYP      IFEQ *BLANKS
     C                     SETON                     51    Deal SubType invalid
     C                     ELSE
     C           STYP      CHAINSDDLSTL1             51
     C                     END
     C*
     C           *IN51     IFEQ '1'
     C                     SETON                     41
     C                     MOVEL'USR4218' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**                                                                                      CDL038
     C**   Send message if Class is invalid                                                   CDL038
     C**                                                                                      CDL038
     C           CDL038    IFEQ 'Y'                                                           CDL038
     C                     CALL 'AOTCLSR0'                                                    CDL038
     C                     PARM *BLANK    P@RTCD  7                                           CDL038
     C                     PARM '*KEY   ' P@OPTN  7                                           CDL038
     C                     PARM CLAS      P@CLAS  4                                           CDL038
     C                     PARM           SDTCLS                                              CDL038
     C           P@RTCD    IFEQ '*NRF   '                                                     CDL038
     C                     SETON                     4198                                     CDL038
     C                     MOVEL'USR5010' ZAMSID           Message id.                        CDL038
     C                     EXSR ZASNMS                     Send message                       CDL038
     C                     ELSE                                                               CDL038
     C                     MOVELTCCLAS    CLAS                                                CDL038
     C                     END                                                                CDL038
     C                     END                                                                CDL038
     C*                                                                   188450
     C           *IN41     IFEQ '0'                                       188450
     C           DTST      CHAINFDDTSTL1             51                   188450
     C*                                                                   188450
     C           *IN51     IFEQ '1'                                       188450
     C                     SETON                     4150                 188450
     C           CDL038    IFEQ 'Y'                                                           CDL038
     C                     SETON                     98                                       CDL038
     C                     MOVEL'USR5011' ZAMSID           Message id.                        CDL038
     C                     ELSE                                                               CDL038
     C                     MOVEL'USR4219' ZAMSID           Message id.    188450
     C                     ENDIF                                                              CDL038
     C                     EXSR ZASNMS                     Send message   188450
     C                     END                                            188450
     C                     END                                            188450
     C*                                                                   188450
     C                     END
      *                                                                   CIR003
      ** If CIR003 is ON, *IN41 is OFF and Deal Type is 'RX', load all    CIR003
      ** dealing currencies array (CCYA).                                 CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           *IN41     ANDEQ*OFF                                      CIR003
     C           TYPE      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           *LOVAL    SETLLSDCURRL1                                  CIR003
     C                     Z-ADD0         X       30                      CIR003
      *                                                                   CIR003
     C                     READ SDCURRL1                 28               CIR003
     C           *IN28     DOWEQ*OFF                                      CIR003
     C           X         ANDLE200                                       CIR003
      *                                                                   CIR003
     C           *IN28     IFEQ *OFF                                      CIR003
     C           A6DLCI    ANDEQ'Y'                                       CIR003
     C                     ADD  1         X                               CIR003
      *                                                                   CIR003
     C           X         IFLE 200                                       CIR003
     C                     MOVELA6CYCD    CCYA,X                          CIR003
     C                     ELSE                                           CIR003
     C                     MOVEL'USR4220' ZAMSID                          CIR003
     C                     EXSR ZASNMS                                    CIR003
     C                     MOVE *ON       *IN41                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C                     READ SDCURRL1                 28               CIR003
      *                                                                   CIR003
     C                     ENDDO                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C**
     C** If no errors, output and process second screen
     C**
     C           *IN50     IFEQ '0'                        Deal Type valid
     C           *IN51     ANDEQ'0'                        Deal Subtype valid
     C           *IN41     ANDEQ'0'                                         d
     C           *IN03     ANDEQ'0'                        F3 not pressed
     C**
     C** Blank out previous values entered on screen
     C**
     C                     MOVE *BLANKS   F1
     C                     MOVE *BLANKS   F2
     C                     MOVE *BLANKS   F3
     C                     MOVE *BLANKS   F3PREF
     C                     MOVE *BLANKS   F4
     C                     MOVE *BLANKS   F5
     C                     MOVE *BLANKS   F5PREF
     C                     MOVE *BLANKS   F6
     C                     MOVE *BLANKS   F7
     C                     MOVE *BLANKS   F7PREF
     C                     MOVE *BLANKS   F8
     C                     MOVE *BLANKS   F9                              098903
     C                     MOVE *BLANKS   F9PREF                          098903
     C                     MOVE *BLANKS   F10                             098903
     C                     MOVE *BLANKS   F11                             098903
     C                     MOVE *BLANKS   F11PRF                          098903
     C                     MOVE *BLANKS   F12                             098903
     C                     MOVE *BLANKS   SSWP                            CIR003
     C**                                                                  CIR001
     C** Blank out previous values entered on detail screen - 2           CIR001
     C**                                                                  CIR001
     C                     MOVE *BLANK    HORT                            CIR001
     C                     MOVE *BLANKS   SCRN2                           CIR001
     C**                                                                  CIR001
     C** Blank out previous values entered on detail screen - 3           CIR001
     C**                                                                  CIR001
     C                     MOVE *BLANKS   SCRN3                           CIR001
      *                                                                                       CAS004
      ** Blank out previous values entered on Hedge Accounting screen 1                       CAS004
      *                                                                                       CAS004
     C                     MOVE *BLANKS   WHEDG1                                              CAS004
      *                                                                                       CAS004
      ** Blank out previous values entered on Hedge Accounting screen 2                       CAS004
      *                                                                                       CAS004
     C                     MOVE *BLANKS   WHEDG2                                              CAS004
      *                                                                                       CAS005
      ** Blank out previous values entered on Hedge Accounting screen 3                       CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   WHEDG3                                              CAS005
     C*
     C/COPY WNCPYSRC,AK0030C001
     C                     EXSR FRP
     C*
     C                     END                             2nd screen reqd
     C*
     C                     END                             F3 pressed
     C*
     C                     END                             F3 pressed
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C**
     C** FRP - Validate FRA/IRS screen & structure output/
     C**       update to ZACKEYAL
     C**
     C** Called By - MAIN - Main processing
     C**
     C** Calls - ZASNMS - Send message to program message queue
     C**         ACUP   - Update ZACKEYAL
     C**
     C********************************************************************
     C           FRP       BEGSR
     C*
     C           FSTSCR    TAG                                            098903
     C*                                                                   098903
     C                     SETOF                     525354
     C                     SETOF                     555657
     C                     SETOF                     585960
     C                     SETOF                     616263
     C                     SETOF                     646566
     C                     SETOF                     67
     C                     SETOF                     313233               098903
     C                     SETOF                     343536               098903
     C                     SETOF                     37                   098903
     C                     MOVE *OFF      *IN42                           CIR003
     C                     MOVE *OFF      *IN43                           CIR003
      *                                                                                       CAS004
      ** If Hedge Accounting Feature is switched on, clear screen field                       CAS004
      ** error indicators                                                                     CAS004
      *                                                                                       CAS004
     C           CAS004    IFEQ 'Y'                                                           CAS004
     C           CAS007    ANDEQ'Y'                                                           CAS007
     C                     EXSR SRCLRI                                                        CAS004
     C                     ENDIF                                                              CAS004
     C**                                                                  CIR001
     C** Clear messages from program message queue.                       CIR001
     C**                                                                  CIR001
     C                     CALL 'Y2CLMSC'                                 CIR001
     C                     PARM SPGMQ     ZAPGM  10                       CIR001
     C                     PARM '*SAME'   ZAPGRL  5                       CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, display Swap Position Account and Contingent    CIR003
      ** Account fields.                                                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           TYPE      ANDEQ'RX'                                      CIR003
     C                     MOVE *ON       *IN42                           CIR003
     C                     MOVE *ON       *IN43                           CIR003
     C                     ENDIF                                          CIR003
     C*
     C           *IN03     DOUEQ'1'                        F3 pressed
     C           *IN12     OREQ '1'                        F12 pressed
     C           *IN64     OREQ '0'                        No errs in FR scrn
     C*
     C           WS2F12    DOUEQ'0'                        F12 from 2nd scCIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           CIR001    OREQ 'N'                                       CIR001
     C**                                                                  CIR001
     C** IF F12 pressed from detail screen - 2 then clear messages        CIR001
     C** from program message queue.                                      CIR001
     C**                                                                  CIR001
     C           WS2F12    IFEQ '1'                        F12 from 2nd scCIR001
     C                     CALL 'Y2CLMSC'                                 CIR001
     C                     PARM SPGMQ     ZAPGM  10                       CIR001
     C                     PARM '*SAME'   ZAPGRL  5                       CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C                     MOVE '0'       WS2F12                          CIR001
     C*                                                                   CIR001
     C           *IN37     IFEQ '1'                                       098903
     C                     GOTO SECSCR                                    098903
     C                     END                                            098903
     C*                                                                   098903
     C                     WRITE#MSGCTL
     C                     EXFMTACKEYFR
     C**
     C** Clear messages from program message queue.
     C**
     C                     CALL 'Y2CLMSC'
     C                     PARM SPGMQ     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C**
     C** If F3 and F12 not pressed, validate screen
     C**
     C           *IN03     IFEQ '0'                        F3 pressed  X scrn
     C           *IN12     ANDEQ'0'                        F12 pressed X scrn
     C**
     C** Initialise indicators before validation
     C**
     C                     SETOF                     525354
     C                     SETOF                     555657
     C                     SETOF                     585960
     C                     SETOF                     616263
     C                     SETOF                     646566
     C                     SETOF                     67
     C                     MOVE *OFF      *IN44                           CIR003
     C**
     C** Check Hedge or Trade? field is entered and is either H or T
     C**
     C           HORT      IFEQ 'H'
     C           HORT      OREQ 'T'
     C                     ELSE
     C                     SETON                     5264  Errors in FR screen
     C                     MOVEL'USR4267' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F1 (Principal Account) is entered and is valid
     C** non-title Account code
     C**
     C/COPY WNCPYSRC,AK0030C002
     C           F1        IFEQ *BLANKS
     C                     SETON                     53
     C                     ELSE
     C           F1        CHAINSDACODL0             53
     C                     END
     C*
     C           *IN53     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     5364  Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F2 (Principal Contra Account) is entered and is valid
     C** non-title Account code
     C**
     C           F2        IFEQ *BLANKS
     C                     SETON                     54
     C                     ELSE
     C           F2        CHAINSDACODL0             54
     C                     END
     C*
     C           *IN54     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     5464  Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C/COPY WNCPYSRC,AK0030C003
      *                                                                   CIR003
      ** If CIR003 is ON and deal type is 'RX', validate Swap Position    CIR003
      ** Account field.                                                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           TYPE      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
     C           SSWP      IFEQ *BLANKS                                   CIR003
     C                     MOVE *ON       *IN44                           CIR003
     C                     ELSE                                           CIR003
     C           SSWP      CHAINSDACODL0             44                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           *IN44     IFEQ *ON                                       CIR003
     C           A5TOIN    OREQ 'Y'                                       CIR003
     C                     MOVEL'USR4230' ZAMSID                          CIR003
     C                     EXSR ZASNMS                                    CIR003
     C                     MOVE *ON       *IN44                           CIR003
     C                     MOVE *ON       *IN64                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
     C**
     C** Check F3 (Exposure Account) is entered and is valid
     C** non-title Account code
     C**
     C           F3        IFEQ *BLANKS
     C                     SETOF                     65
     C                     ELSE
     C                     SETON                     65
     C           F3        CHAINSDACODL0             55
     C                     END
     C*
     C           *IN55     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     5564  Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F3PREF is valid (1 or 3) if entered
     C**
     C           F3PREF    IFEQ *BLANKS
     C                     SETOF                     66
     C                     ELSE
     C                     SETON                     66
     C           F3PREF    IFEQ '1'
     C           F3PREF    OREQ '3'                        Pref valid
     C                     ELSE
     C                     SETON                     5664  Errors in FX
     C                     MOVEL'USR4259' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C**
     C** Check F4 (Exposure Contra Account) is entered and is valid,
     C** non-title Account code
     C**
     C           F4        IFEQ *BLANKS
     C                     SETOF                     67
     C                     ELSE
     C                     SETON                     67
     C           F4        CHAINSDACODL0             57
     C                     END
     C*
     C           *IN57     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     5764  Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Either all or none of these three fields must be entered
     C**
     C           *IN65     IFEQ '1'                        F3 entered
     C           *IN66     ANDEQ'1'                        F3PREF ent
     C           *IN67     ANDEQ'1'                        F4 entered
     C*
     C                     ELSE
     C           *IN65     IFEQ '0'                        F3 blank
     C           *IN66     ANDEQ'0'                        F3PREF
     C           *IN67     ANDEQ'0'                        F4 blank
     C*
     C                     ELSE
     C                     SETON                     555657
     C                     SETON                     64
     C                     MOVEL'USR4252' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END                             All blank
     C                     END                             All entered
     C**
     C** Check F5 (Profit Amortisation/Accrual) is entered and is
     C** valid, non-title Account code
     C**
     C           F5        IFEQ *BLANKS
     C                     SETON                     58
     C                     ELSE
     C           F5        CHAINSDACODL0             58
     C                     END
     C*
     C           *IN58     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     5864  Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F5PREF is valid (1 or 3)
     C**
     C           F5PREF    IFEQ *BLANKS
     C                     SETON                     59
     C                     ELSE
     C           F5PREF    IFEQ '1'
     C           F5PREF    OREQ '3'                        Pref valid
     C                     ELSE
     C                     SETON                     59
     C                     END
     C                     END
     C*
     C           *IN59     IFEQ '1'
     C                     SETON                     64
     C                     MOVEL'USR4259' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F6 (Profit Income A/c) is entered and is valid,non-title
     C** Account code
     C**
     C           F6        IFEQ *BLANKS
     C                     SETON                     60
     C                     ELSE
     C           F6        CHAINSDACODL0             60
     C                     END
     C*
     C           *IN60     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     64    Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F7 (Loss Amortisation/Accrual) is entered and is
     C** valid, non-title Account code
     C**
     C           F7        IFEQ *BLANKS
     C                     SETON                     61
     C                     ELSE
     C           F7        CHAINSDACODL0             61
     C                     END
     C*
     C           *IN61     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     64    Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F7PREF is valid (1 or 3)
     C**
     C           F7PREF    IFEQ *BLANKS
     C                     SETON                     62
     C                     ELSE
     C           F7PREF    IFEQ '1'
     C           F7PREF    OREQ '3'                        Pref valid
     C                     ELSE
     C                     SETON                     62
     C                     END
     C                     END
     C*
     C           *IN62     IFEQ '1'
     C                     SETON                     64
     C                     MOVEL'USR4259' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**
     C** Check F8 (Loss Expense Account) is entered and is
     C** valid, non-title Account code
     C**
     C           F8        IFEQ *BLANKS
     C                     SETON                     63
     C                     ELSE
     C           F8        CHAINSDACODL0             63
     C                     END
     C*
     C           *IN63     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     64    Errors in FR screen
     C                     MOVEL'USR4230' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C**                                                                  CIR001
     C** IF SWITCHABLE FEATURES FLAG CIR001 = 'Y'                         CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                        CIR001 valid   CIR001
     C           *IN64     ANDEQ'0'                        No errs in FR sCIR001
     C*                                                                   CIR001
     C           WS3F12    DOUEQ'0'                        Alternate F12  CIR001
     C*                                                                   CIR001
     C                     MOVE '0'       WS3F12           Alternate F12  CIR001
     C*                                                                   CIR001
     C           TYPE      IFEQ 'RS'                                      CIR001
     C           TYPE      OREQ 'RX'                                      CIR001
     C           TYPE      OREQ 'RR'                                      CIR001
     C           TYPE      OREQ 'RP'                                      CIR001
     C           TYPE      OREQ 'RF'                                      CIR001
     C*                                                                   CIR001
     C           *IN03     DOUEQ'1'                                       CIR001
     C           *IN12     OREQ '1'                                       CIR001
     C           VALID2    OREQ 'Y'                                       CIR001
     C*                                                                   CIR001
     C                     MOVE 'Y'       VALID2                          CIR001
     C                     EXSR VALS02                                    CIR001
     C*                                                                   CIR001
     C                     MOVE *IN12     WS2F12                          CIR001
     C                     ENDDO                                          CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN03     IFEQ '0'                        No errs in FR sCIR001
     C           *IN12     ANDEQ'0'                        No errs in FR sCIR001
     C*                                                                   CIR001
     C           TYPE      IFEQ 'RS'                                      CIR001
     C           TYPE      OREQ 'RX'                                      CIR001
     C           TYPE      OREQ 'RP'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           TYPE      OREQ 'RR'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           TYPE      OREQ 'RF'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C*                                                                   CIR001
     C           *IN03     DOUEQ'1'                                       CIR001
     C           *IN12     OREQ '1'                                       CIR001
     C           VALID3    OREQ 'Y'                                       CIR001
     C*                                                                   CIR001
     C                     MOVE 'Y'       VALID3                          CIR001
     C*                                                                   CIR001
     C                     EXSR VALS03                                    CIR001
     C*                                                                   CIR001
     C                     MOVE *IN12     WS3F12                          CIR001
     C*                                                                   CIR001
     C                     ENDDO                                          CIR001
     C                     ENDIF                                          CIR001
     C                     ENDIF                                          CIR001
     C                     ENDDO                                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  098903
     C** If no errors on 1st screen, proceed to 2nd if necessary          098903
     C**                                                                  098903
     C           *IN64     IFEQ *OFF                                                          CAS004
     C           WS2F12    ANDEQ'0'                                                           CAS004
     C           *IN03     ANDEQ'0'                                                           CAS004
      *                                                                                       CAS004
     C           *IN64     IFEQ '0'                                       098903
     C           TYPE      ANDNE'RP'                                      098903
     C           TYPE      ANDNE'RR'                                      098903
     C           TYPE      ANDNE'RF'                                      098903
     C           HORT      ANDNE'H'                                       098903
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'RS'                                                          CAS004
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'RX'                                                          CAS004
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'FR'                                                          CAS004
     C*                                                                   098903
     C                     SETON                     37                   098903
     C*                                                                   098903
     C           SECSCR    TAG                                            098903
     C*                                                                   098903
     C           *IN03     DOUEQ'1'                                       098903
     C           *IN12     OREQ '1'                                       098903
     C           *IN64     OREQ '0'                                       098903
     C*                                                                   098903
     C                     WRITE#MSGCTL                                   098903
     C                     EXFMTACKEYSC                                   098903
     C**                                                                  098903
     C** Clear messages from program message queue.                       098903
     C**                                                                  098903
     C                     CALL 'Y2CLMSC'                                 098903
     C                     PARM SPGMQ     ZAPGM                           098903
     C                     PARM '*SAME'   ZAPGRL                          098903
     C**                                                                  098903
     C** If F12 was pressed, return to 1st screen                         098903
     C           *IN12     IFEQ '1'                                       098903
     C                     GOTO FSTSCR                                    098903
     C                     END                                            098903
     C**                                                                  098903
     C** If F3 and F12 not pressed, validate screen                       098903
     C**                                                                  098903
     C           *IN03     IFEQ '0'                                       098903
     C           *IN12     ANDEQ'0'                                       098903
     C**                                                                  098903
     C** Initialize indicators before validation                          098903
     C**                                                                  098903
     C                     SETOF                     313233               098903
     C                     SETOF                     343536               098903
     C                     SETOF                     64                   098903
      *                                                                                       208275
     C                     SELEC                                                              208275
      *                                                                                       208275
     C           F9        WHNE *BLANKS                                                       208275
     C           F9PREF    ANDNE*BLANKS                                                       208275
     C           F10       ANDNE*BLANKS                                                       208275
     C**                                                                  098903
     C** Check F9 (Unrealized Profit) is entered and is valid,            098903
     C** non-title Account code                                           098903
     C**                                                                  098903
     C********** F9        IFEQ *BLANKS                                                098903 208275
     C**********           SETON                     31                                098903 208275
     C**********           ELSE                                                        098903 208275
     C           F9        CHAINSDACODL0             31                   098903
     C**********           END                                                         098903 208275
     C*                                                                   098903
     C********** *IN71     IFEQ '1'                                                    098903 208275
     C           *IN31     IFEQ *ON                                                           208275
     C           A5TOIN    OREQ 'Y'                                       098903
     C                     MOVE *ON       *IN31                                               208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4230' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
     C**                                                                  098903
     C** Check F9PREF is valid (1 or 3)                                   098903
     C**                                                                  098903
     C           F9PREF    IFEQ *BLANKS                                   098903
     C                     SETON                     32                   098903
     C                     ELSE                                           098903
     C           F9PREF    IFEQ '1'                                       098903
     C           F9PREF    OREQ '3'                                       098903
     C                     ELSE                                           098903
     C                     SETON                     32                   098903
     C                     END                                            098903
     C                     END                                            098903
     C*                                                                   098903
     C********** *IN72     IFEQ '1'                                                    098903 208275
     C           *IN32     IFEQ '1'                                                           208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4259' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
     C**                                                                  098903
     C** Check F10 (Unrealized Profit Contra) is entered and is           098903
     C** valid, non-title Account code                                    098903
     C**                                                                  098903
     C********** F10       IFEQ *BLANKS                                                098903 208275
     C**********           SETON                     33                                098903 208275
     C**********           ELSE                                                        098903 208275
     C           F10       CHAINSDACODL0             33                   098903
     C**********           END                                                         098903 208275
     C*                                                                   098903
     C********** *IN73     IFEQ '1'                                                    098903 208275
     C           *IN33     IFEQ *ON                                                           208275
     C           A5TOIN    OREQ 'Y'                                       098903
     C                     MOVE *ON       *IN33                                               208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4230' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
      *                                                                                       208275
     C           F9        WHEQ *BLANKS                                                       208275
     C           F9PREF    ANDEQ*BLANKS                                                       208275
     C           F10       ANDEQ*BLANKS                                                       208275
      *                                                                                       208275
     C                     OTHER                                                              208275
     C                     MOVEA'111'     *IN,31                                              208275
     C                     MOVE *ON       *IN64                                               208275
     C                     MOVEL'USR4252' ZAMSID                                              208275
     C                     EXSR ZASNMS                                                        208275
      *                                                                                       208275
     C                     ENDSL                                                              208275
      *                                                                                       208275
     C                     SELEC                                                              208275
      *                                                                                       208275
     C           F11       WHNE *BLANKS                                                       208275
     C           F11PRF    ANDNE*BLANKS                                                       208275
     C           F12       ANDNE*BLANKS                                                       208275
     C**                                                                  098903
     C** Check F11 (Unrealized Loss) is entered and is valid,             098903
     C** non-title Account code                                           098903
     C**                                                                  098903
     C********** F11       IFEQ *BLANKS                                                098903 208275
     C**********           SETON                     34                                098903 208275
     C**********           ELSE                                                        098903 208275
     C           F11       CHAINSDACODL0             34                   098903
     C**********           END                                                         098903 208275
     C*                                                                   098903
     C********** *IN74     IFEQ '1'                                                    098903 208275
     C           *IN34     IFEQ *ON                                                           208275
     C           A5TOIN    OREQ 'Y'                                       098903
     C                     MOVE *ON       *IN34                                               208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4230' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
     C**                                                                  098903
     C** Check F11PRF is valid (1 or 3)                                   098903
     C**                                                                  098903
     C           F11PRF    IFEQ *BLANKS                                   098903
     C                     SETON                     35                   098903
     C                     ELSE                                           098903
     C           F11PRF    IFEQ '1'                                       098903
     C           F11PRF    OREQ '3'                                       098903
     C                     ELSE                                           098903
     C                     SETON                     35                   098903
     C                     END                                            098903
     C                     END                                            098903
     C*                                                                   098903
     C********** *IN75     IFEQ '1'                                                    098903 208275
     C           *IN35     IFEQ '1'                                                           208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4259' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
     C**                                                                  098903
     C** Check F12 (Unrealized Loss Contra) is entered and is             098903
     C** valid, non-title Account code                                    098903
     C**                                                                  098903
     C********** F12       IFEQ *BLANKS                                                098903 208275
     C**********           SETON                     36                                098903 208275
     C**********           ELSE                                                        098903 208275
     C           F12       CHAINSDACODL0             36                   098903
     C**********           END                                                         098903 208275
     C*                                                                   098903
     C********** *IN76     IFEQ '1'                                                    098903 208275
     C           *IN36     IFEQ *ON                                                           208275
     C           A5TOIN    OREQ 'Y'                                       098903
     C                     MOVE *ON       *IN36                                               208275
     C                     SETON                     64                   098903
     C                     MOVEL'USR4230' ZAMSID                          098903
     C                     EXSR ZASNMS                                    098903
     C                     END                                            098903
      *                                                                                       208275
     C           F11       WHEQ *BLANKS                                                       208275
     C           F11PRF    ANDEQ*BLANKS                                                       208275
     C           F12       ANDEQ*BLANKS                                                       208275
      *                                                                                       208275
     C                     OTHER                                                              208275
     C                     MOVEA'111'     *IN,34                                              208275
     C                     MOVE *ON       *IN64                                               208275
     C                     MOVEL'USR4252' ZAMSID                                              208275
     C                     EXSR ZASNMS                                                        208275
      *                                                                                       208275
     C                     ENDSL                                                              208275
     C*                                                                   098903
     C                     END                                            098903
     C*                                                                   098903
      *                                                                                       CAS004
      ** If Exit and Cancel is not pressed and no errors in the current                       CAS004
      ** screen, go to subroutine that displays hedge accounting screen                       CAS004
      *                                                                                       CAS004
     C           *IN03     IFEQ *OFF                                                          CAS004
     C           *IN12     ANDEQ*OFF                                                          CAS004
     C           *IN64     ANDEQ*OFF                                                          CAS004
     C                     EXSR SRDSPH                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     END                                            098903
     C*                                                                   098903
     C                     END                                            098903
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
     C**
     C** If errors exist on screen, exit subroutine
     C**
     C           *IN64     IFEQ '0'                        No errs in FR scrn
     C*                                                                   CIR001
     C           CIR001    ANDEQ'N'                                       CIR001
     C           *IN64     OREQ '0'                                       CIR001
     C           CIR001    ANDEQ'Y'                                       CIR001
     C           *IN03     ANDEQ'0'                                       CIR001
     C           *IN12     ANDEQ'0'                                       CIR001
     C/COPY WNCPYSRC,AK0030C004
     C**
     C** Set up all fields for ZACKEYAL output/update
     C**
     C                     MOVE *BLANK    DLKEY
     C                     MOVE TYPE      DTYPD
     C                     MOVE STYP      STYPD
     C                     MOVE CLAS      CLASD                                               CDL038
     C                     MOVE *BLANK    FMKEYS
     C**
     C** Deal Date Keys
     C**
     C                     MOVE 'D'       EVENTD
     C*
     C           TYPE      IFNE 'RX'
     C**
     C** Format Key XXDYY....A  (YY=Sub Type,.=blank) (All except RX)
     C**
     C                     MOVE 'A'       AMTD
     C** DR fields
     C                     MOVE F1        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '3'       PR1
     C** CR fields
     C                     MOVE F2        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '1'       PR4
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..I.A  (YY=Sub Type,.=blank) (RS only)           CIR001
      ** If CIR006 is intalled, generate for Caps/Collars/Floors          CIR006
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           TYPE      ANDEQ'RS'                                      CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RP'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RR'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RF'                                      CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP1                                           S01408
      *                                                                   S01408
     C**********           MOVE '  I'     CYD                      CIR001 CIR006
     C                     MOVE 'I'       FBD                             CIR006
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
      *                                                                   CIR006
     C                     MOVE ' '       FBD                             CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP2                                           S01408
      *                                                                   S01408
     C**                                                                  CIR001
     C** Format Key XXIYY...PC  (YY=Sub Type,.=blank) (All except RX)     CIR001
     C**                                                                  CIR001
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP3                                           S01408
      *                                                                   S01408
     C           TYPE      IFEQ 'RS'                                      CIR006
      *                                                                   CIR006
     C                     MOVE 'I'       EVENTD                          CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE 'P'       FBD                             CIR001
     C                     MOVE 'C'       AMTD                            CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C** Format Key XXIYY...RC  (YY=Sub Type,.=blank) (RS only)           CIR001
     C**                                                                  CIR001
     C                     MOVE 'R'       FBD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE ' '       FBD                             CIR001
      *                                                                   CIR006
     C                     ENDIF                                          CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP4                                           S01408
      *                                                                   S01408
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXDYY....E & update file      (All except RX)
     C**
     C                     MOVE 'E'       AMTD
     C** Set up fields
     C           F3        IFEQ *BLANKS
     C                     MOVE *BLANKS   FMKEYS
     C                     ELSE
     C                     MOVE F3        AC1
     C                     MOVE '01'      PN1
     C                     MOVE F3PREF    PR1
     C                     MOVE F4        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '1'       PR4
     C                     END
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..I.E & update file      (RS only)               CIR001
      ** If CIR006 is installed, generate Caps/Collars/Floors             CIR006
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           TYPE      ANDEQ'RS'                                      CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RP'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RR'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RF'                                      CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP5                                           S01408
      *                                                                   S01408
     C**********           MOVE '  I'     CYD                      CIR001 CIR006
     C                     MOVE 'I'       FBD                             CIR006
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE ' '       FBD                             CIR006
     C                     ENDIF                                          CIR001
     C*
     C                     ELSE                            Deal Type=RX
     C**
     C** Format Key XXDYY...OA & update file      (RX only)
     C**
     C                     MOVE 'O'       FBD
     C                     MOVE 'A'       AMTD
     C/COPY WNCPYSRC,AK0030C005
     C** Set up fields
     C                     MOVE F1        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '3'       PR1
     C                     MOVE F2        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '1'       PR4
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..IOA & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  I'     CYD                             CIR001
     C*                                                                   CIR001
      ** If CIR003 is ON, format account keys RXDss..IOA                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   AC2                             CIR003
     C                     MOVE '01'      PN2                             CIR003
     C                     MOVE '2'       PR2                             CIR003
     C                     MOVE SSWP      AC5                             CIR003
     C                     MOVE '01'      PN5                             CIR003
     C                     MOVE '1'       PR5                             CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     EXSR ACUP                                      CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, format account keys RXDss.BIOA                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE ' BI'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     MOVE *BLANKS   AC2                             CIR003
     C                     MOVE *BLANKS   PN2                             CIR003
     C                     MOVE *BLANKS   PR2                             CIR003
     C                     MOVE *BLANKS   AC5                             CIR003
     C                     MOVE *BLANKS   PN5                             CIR003
     C                     MOVE *BLANKS   PR5                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE '   '     CYD                             CIR001
     C**                                                                  CIR001
     C** Format Key XXIYY...PC & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C                     MOVE 'I'       EVENTD                          CIR001
     C                     MOVE 'P'       FBD                             CIR001
     C                     MOVE 'C'       AMTD                            CIR001
     C*                                                                   CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE 'A'       AMTD                            CIR001
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXDYY...TA & update file      (RX only)
     C**
     C                     MOVE 'T'       FBD
     C** Update File
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..ITA & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  I'     CYD                             CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, format account keys RXDss..ITA                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE SSWP      AC2                             CIR003
     C                     MOVE '01'      PN2                             CIR003
     C                     MOVE '1'       PR2                             CIR003
     C                     MOVE *BLANKS   AC5                             CIR003
     C                     MOVE '01'      PN5                             CIR003
     C                     MOVE '2'       PR5                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C** Update File                                                      CIR001
     C                     EXSR ACUP                                      CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, format account keys RXDss.BITA                  CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE ' BI'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     MOVE *BLANKS   AC2                             CIR003
     C                     MOVE *BLANKS   PN2                             CIR003
     C                     MOVE *BLANKS   PR2                             CIR003
     C                     MOVE *BLANKS   AC5                             CIR003
     C                     MOVE *BLANKS   PN5                             CIR003
     C                     MOVE *BLANKS   PR5                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE '   '     CYD                             CIR001
     C**                                                                  CIR001
     C** Format Key XXIYY...RC & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C                     MOVE 'I'       EVENTD                          CIR001
     C                     MOVE 'R'       FBD                             CIR001
     C                     MOVE 'C'       AMTD                            CIR001
     C*                                                                   CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     ENDIF                                          CIR001
     C/COPY WNCPYSRC,AK0030C006
     C**
     C** Format Key XXDYY...OE & update file      (RX only)
     C**
     C                     MOVE 'O'       FBD
     C                     MOVE 'E'       AMTD
     C** Set up fields
     C           *IN65     IFEQ '0'                                       186133
     C           *IN66     ANDEQ'0'                                       186133
     C           *IN67     ANDEQ'0'                                       186133
     C                     MOVE *BLANKS   AC1                             186133
     C                     MOVE *BLANKS   PN1                             186133
     C                     MOVE *BLANKS   PR1                             186133
     C                     MOVE *BLANKS   AC4                             186133
     C                     MOVE *BLANKS   PN4                             186133
     C                     MOVE *BLANKS   PR4                             186133
     C                     ELSE                                           186133
     C                     MOVE F3        AC1
     C                     MOVE F3PREF    PR1
     C                     MOVE F4        AC4
     C                     ENDIF                                          186133
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..IOE & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  I'     CYD                             CIR001
     C*                                                                   CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXDYY...TE & update file      (RX only)
     C**
     C                     MOVE 'T'       FBD
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXDYY..ITE & update file      (RX only)               CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  I'     CYD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
     C*
     C                     END                             RX
     C**
     C** Value Date Keys (only required for Deal Type FR)
     C**
     C           TYPE      IFEQ 'FR'
     C*
     C** Format Key XXVYY....A
     C**
     C                     MOVE 'V'       EVENTD
     C                     MOVE 'A'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C** Accounting entries only required if Trade
     C*
     C           HORT      IFEQ 'T'
     C                     MOVE F2        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F1        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '3'       PR4
     C                     END
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXVYY....E
     C**
     C                     MOVE 'E'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C** Accounting entries only required if Trade
     C*
     C           HORT      IFEQ 'T'
      *                                                                   186133
     C           *IN65     IFEQ '0'                                       186133
     C           *IN66     ANDEQ'0'                                       186133
     C           *IN67     ANDEQ'0'                                       186133
     C                     MOVE *BLANKS   AC1                             186133
     C                     MOVE *BLANKS   PN1                             186133
     C                     MOVE *BLANKS   PR1                             186133
     C                     MOVE *BLANKS   AC4                             186133
     C                     MOVE *BLANKS   PN4                             186133
     C                     MOVE *BLANKS   PR4                             186133
     C                     ELSE                                           186133
     C                     MOVE F4        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F3        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F3PREF    PR4
     C                     END                                            186133
      *                                                                   186133
     C                     END
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXVYY...PI
     C**
     C                     MOVE 'P'       FBD
     C                     MOVE 'I'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C** Accounting entries depend on if Trade or Hedge
     C*
     C                     MOVE '01'      PN4
     C                     MOVE '2'       PR4
     C*
     C           HORT      IFEQ 'H'
     C                     MOVE F7        AC1
     C                     MOVE '01'      PN1
     C                     MOVE F7PREF    PR1
     C*
     C                     ELSE                            Trade
     C*
     C                     MOVE F8        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     END
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXVYY...RI
     C**
     C                     MOVE 'R'       FBD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C** Accounting entries depend on if Trade or Hedge
     C*
     C                     MOVE '01'      PN1
     C                     MOVE '2'       PR1
     C*
     C           HORT      IFEQ 'H'
     C                     MOVE F5        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F5PREF    PR4
     C*
     C                     ELSE                            Trade
     C*
     C                     MOVE F6        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '1'       PR4
     C                     END
     C*
     C** Update file
     C                     EXSR ACUP
     C*
     C                     END                             FR
      *                                                                   CIR003
      ** If CIR003 is ON and TYPE is 'RX', generate account value date    CIR003
      ** account keys.                                                    CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           TYPE      ANDEQ'RX'                                      CIR003
      *                                                                   CIR003
      ** Format Key RXVss...OA                                            CIR003
      *                                                                   CIR003
     C                     MOVE 'V'       EVENTD                          CIR003
     C                     MOVE STYP      STYPD                           CIR003
     C                     MOVE CLAS      CLASD                                               CDL038
     C                     MOVE *BLANKS   CYD                             CIR003
     C                     MOVE 'O'       FBD                             CIR003
     C                     MOVE 'A'       AMTD                            CIR003
     C                     MOVE *BLANKS   FMKEYS                          CIR003
      *                                                                   CIR003
     C                     MOVE '01'      PN1                             CIR003
     C                     MOVE '01'      PN4                             CIR003
      *                                                                   CIR003
      ** Set up fields debit side                                         CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   AC1                             CIR003
     C                     MOVE '2'       PR1                             CIR003
      *                                                                   CIR003
      ** Set up fields credit side                                        CIR003
      *                                                                   CIR003
     C                     MOVE SSWP      AC4                             CIR003
     C                     MOVE '1'       PR4                             CIR003
      *                                                                   CIR003
     C                     EXSR ACUP                                      CIR003
      *                                                                   CIR003
      ** Format Key RXVss..BOA                                            CIR003
      *                                                                   CIR003
     C                     MOVE '  B'     CYD                             CIR003
      *                                                                   CIR003
     C                     EXSR ACUP                                      CIR003
      *                                                                   CIR003
      ** Format Key RXVss...TA                                            CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   CYD                             CIR003
     C                     MOVE 'T'       FBD                             CIR003
      *                                                                   CIR003
      ** Set up fields debit side                                         CIR003
      *                                                                   CIR003
     C                     MOVE SSWP      AC1                             CIR003
     C                     MOVE '1'       PR1                             CIR003
      *                                                                   CIR003
      ** Set up fields credit side                                        CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   AC4                             CIR003
     C                     MOVE '2'       PR4                             CIR003
      *                                                                   CIR003
     C                     EXSR ACUP                                      CIR003
      *                                                                   CIR003
      ** Format Key RXVss..BTA                                            CIR003
      *                                                                   CIR003
     C                     MOVE '  B'     CYD                             CIR003
      *                                                                   CIR003
     C                     EXSR ACUP                                      CIR003
      *                                                                   CIR003
      ** Format Keys RXVssoooOA and RXVsstttTA                            CIR003
      *                                                                   CIR003
     C                     EXSR SRCCYU                                    CIR003
      *                                                                   CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C/COPY WNCPYSRC,AK0030C007
     c**                                                                                      245915
     C           CDL039    IFEQ 'Y'                                                           245915
     C**                                                                                    BUG10281
     C** TRANSFER INTEREST KEYS  Keys (All except Type FR/Trade)                            BUG10281
     C**                                                                                    BUG10281
     C                     MOVE 'T'       EVENTD                                            BUG10281
     C*                                                                                     BUG10281
     C           TYPE      IFEQ 'FR'                                                        BUG10281
     C           HORT      ANDEQ'T'                                                         BUG10281
     C                     ELSE                                                             BUG10281
     C*                                                                                     BUG10281
     C** Format Key XXTYY...PA                                                              BUG10281
     C**                                                                                    BUG10281
     C                     MOVE 'P'       FBD                                               BUG10281
     C                     MOVE 'A'       AMTD                                              BUG10281
     C                     MOVE *BLANKS   FMKEYS                                            BUG10281
     C*                                                                                     BUG10281
     C                     MOVE F7        AC4                                               BUG10281
     C                     MOVE '01'      PN4                                               BUG10281
     C                     MOVE F7PREF    PR4                                               BUG10281
     C** Update file                                                                        BUG10281
     C                     EXSR ACUP                                                        BUG10281
     C**                                                                                    BUG10281
     C** Format Key XXTYY...RA                                                              BUG10281
     C**                                                                                    BUG10281
     C                     MOVE 'R'       FBD                                               BUG10281
     C                     MOVE *BLANKS   FMKEYS                                            BUG10281
     C*                                                                                     BUG10281
     C                     MOVE F5        AC1                                               BUG10281
     C                     MOVE '01'      PN1                                               BUG10281
     C                     MOVE F5PREF    PR1                                               BUG10281
     C** Update file                                                                        BUG10281
     C                     EXSR ACUP                                                        BUG10281
     C                     ENDIF                                                            BUG10281
     C**                                                                                      245915
     C                     ENDIF                                                              245915
     C**
     C** Amortisation/Accrual Date Keys    (All except Type FR/Trade)
     C**
     C                     MOVE 'A'       EVENTD
     C*
     C           TYPE      IFEQ 'FR'
     C           HORT      ANDEQ'T'
     C                     ELSE
     C*
     C** Format Key XXAYY...PA
     C**
     C                     MOVE 'P'       FBD
     C                     MOVE 'A'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE F8        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F7        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F7PREF    PR4
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXAYY...RA
     C**
     C                     MOVE 'R'       FBD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE F5        AC1
     C                     MOVE '01'      PN1
     C                     MOVE F5PREF    PR1
     C                     MOVE F6        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '1'       PR4
     C** Update file
     C                     EXSR ACUP
     C**
     C** Maturity Date Keys
     C**
     C                     MOVE 'M'       EVENTD
     C*
     C           TYPE      IFNE 'RX'
     C**
     C** Format Key XXMYY....A     (Not FR/Trade & RX)
     C**
     C                     MOVE 'A'       AMTD
     C                     MOVE ' '       FBD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE F2        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F1        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '3'       PR4
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXMYY..D.A     (RS only)                              CIR001
      ** If CIR006 is installed, generate for Caps/Collars/Floors         CIR006
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           TYPE      ANDEQ'RS'                                      CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RP'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RR'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RF'                                      CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP6                                           S01408
      *                                                                   S01408
     C**********           MOVE '  D'     CYD                      CIR001 CIR006
     C                     MOVE 'D'       FBD                             CIR006
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE *BLANKS   FBD                             CIR006
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXMYY....E     (Not FR/Trade & RX)
     C**
     C                     MOVE 'E'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C           F3        IFEQ *BLANKS
     C                     MOVE *BLANKS   FMKEYS
     C                     ELSE
     C                     MOVE F4        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F3        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F3PREF    PR4
     C                     END
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXMYY..D.E     (RS only)                              CIR001
      ** If CIR006 is installed, generate Caps/Collars/Floors             CIR006
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           TYPE      ANDEQ'RS'                                      CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RP'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RR'                                      CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TYPE      ANDEQ'RF'                                      CIR006
      *                                                                   S01408
     C/COPY WNCPYSRC,AK0030CCP7                                           S01408
      *                                                                   S01408
     C**********           MOVE '  D'     CYD                      CIR001 CIR006
     C                     MOVE 'D'       FBD                             CIR006
     C                     MOVE 'E'       AMTD                            CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE *BLANKS   FBD                             CIR006
     C                     ENDIF                                          CIR001
     C*
     C                     ELSE                            RX
     C**
     C** Format Key XXMYY...OA     (Only RX)
     C**
     C                     MOVE 'O'       FBD
     C                     MOVE 'A'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C/COPY WNCPYSRC,AK0030C008
     C*
     C                     MOVE F2        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F1        AC4
     C                     MOVE '01'      PN4
     C                     MOVE '3'       PR4
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss...OA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE SSWP      AC2                             CIR003
     C                     MOVE '01'      PN2                             CIR003
     C                     MOVE '1'       PR2                             CIR003
     C                     MOVE *BLANKS   AC5                             CIR003
     C                     MOVE '01'      PN5                             CIR003
     C                     MOVE '2'       PR5                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C** Update file
     C                     EXSR ACUP
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss..BOA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE '  B'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     MOVE *BLANKS   CYD                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C**                                                                  CIR001
     C** Format Key XXMYY..DOA     (RX only)                              CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  D'     CYD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss.BDOA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE ' BD'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXMYY...TA     (Only RX)
     C**
     C                     MOVE 'T'       FBD
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss...TA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE *BLANKS   AC2                             CIR003
     C                     MOVE '01'      PN2                             CIR003
     C                     MOVE '2'       PR2                             CIR003
     C                     MOVE SSWP      AC5                             CIR003
     C                     MOVE '01'      PN5                             CIR003
     C                     MOVE '1'       PR5                             CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C** Update file
     C                     EXSR ACUP
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss..BTA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE '  B'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     MOVE *BLANKS   CYD                             CIR003
     C                     ENDIF                                          CIR003
     C**                                                                  CIR001
     C** Format Key XXMYY..DTA     (RX only)                              CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  D'     CYD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
      *                                                                   CIR003
      ** If CIR003 is ON, format account key RXMss.BDTA                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     MOVE ' BD'     CYD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
      *                                                                   CIR003
      ** If CIR003 is installed, format Base Currency equivalent          CIR003
      ** keys RXMssoooOA and RXMsstttTA                                   CIR003
      *                                                                   CIR003
     C           CIR003    IFEQ 'Y'                                       CIR003
     C                     EXSR SRCCYU                                    CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C/COPY WNCPYSRC,AK0030C009
     C**
     C** Format Key XXMYY...OE     (Only RX)
     C**
     C                     MOVE 'O'       FBD
     C                     MOVE 'E'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C           *IN65     IFEQ '0'                                       186133
     C           *IN66     ANDEQ'0'                                       186133
     C           *IN67     ANDEQ'0'                                       186133
     C                     MOVE *BLANKS   AC1                             186133
     C                     MOVE *BLANKS   PN1                             186133
     C                     MOVE *BLANKS   PR1                             186133
     C                     MOVE *BLANKS   AC4                             186133
     C                     MOVE *BLANKS   PN4                             186133
     C                     MOVE *BLANKS   PR4                             186133
     C                     ELSE                                           186133
     C                     MOVE F4        AC1
     C                     MOVE '01'      PN1
     C                     MOVE '1'       PR1
     C                     MOVE F3        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F3PREF    PR4
     C                     ENDIF                                          186133
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXMYY..DOE     (RX only)                              CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  D'     CYD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
     C**
     C** Format Key XXMYY...TE     (Only RX)
     C**
     C                     MOVE 'T'       FBD
     C** Update file
     C                     EXSR ACUP
     C**                                                                  CIR001
     C** Format Key XXMYY..DTE     (RX only)                              CIR001
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C                     MOVE '  D'     CYD                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     ENDIF                                          CIR001
     C*
     C                     END                             RX
     C                     END                             FR/Trade
     C**
     C** Interest Date Keys  (not Type FR)
     C**
     C           TYPE      IFNE 'FR'
     C**
     C                     MOVE 'I'       EVENTD
     C**
     C** Format Key XXIYY...PI
     C**
     C                     MOVE 'P'       FBD
     C                     MOVE 'I'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE F7        AC1
     C                     MOVE '01'      PN1
     C                     MOVE F7PREF    PR1
     C*
     C           TYPE      IFEQ 'RP'
     C           TYPE      OREQ 'RR'
     C           TYPE      OREQ 'RF'
     C           TYPE      OREQ 'RX'
     C                     MOVE '01'      PN4
     C                     MOVE '2'       PR4
     C                     END
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXIYY...RI
     C**
     C                     MOVE 'R'       FBD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C           TYPE      IFEQ 'RP'
     C           TYPE      OREQ 'RR'
     C           TYPE      OREQ 'RF'
     C           TYPE      OREQ 'RX'
     C                     MOVE '01'      PN1
     C                     MOVE '2'       PR1
     C                     END
     C*
     C                     MOVE F5        AC4
     C                     MOVE '01'      PN4
     C                     MOVE F5PREF    PR4
     C** Update file
     C                     EXSR ACUP
     C*
     C           TYPE      IFEQ 'RS'
     C**
     C** Format Key XXIYY...PN
     C**
     C                     MOVE 'P'       FBD
     C                     MOVE 'N'       AMTD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE '01'      PN4
     C                     MOVE '2'       PR4
     C** Update file
     C                     EXSR ACUP
     C**
     C** Format Key XXIYY...RN
     C**
     C                     MOVE 'R'       FBD
     C                     MOVE *BLANKS   FMKEYS
     C*
     C                     MOVE '01'      PN1
     C                     MOVE '2'       PR1
     C** Update file
     C                     EXSR ACUP
     C**
     C                     END                             RS
     C                     END                             FR
     C**                                                                  CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C**                                                                  CIR001
     C           TYPE      IFEQ 'RS'                                      CIR001
     C           TYPE      OREQ 'RX'                                      CIR001
     C           TYPE      OREQ 'RP'                                      CIR001
     C           TYPE      OREQ 'RF'                                      CIR001
     C           TYPE      OREQ 'RR'                                      CIR001
     C                     EXSR UPFEES                                    CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           TYPE      IFEQ 'RS'                                      CIR001
     C           TYPE      OREQ 'RX'                                      CIR001
     C           TYPE      OREQ 'RP'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           TYPE      OREQ 'RR'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           TYPE      OREQ 'RF'                                      CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C                     EXSR UPBOUT                                    CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDIF                           CIR001         CIR001
     C**                                                                  098903
     C** Unrealized Profit Keys                                           098903
     C**                                                                  098903
     C                     MOVE 'A'       EVENTD                          098903
     C*                                                                   098903
     C           TYPE      IFNE 'RP'                                      098903
     C           TYPE      ANDNE'RR'                                      098903
     C           TYPE      ANDNE'RF'                                      098903
     C           HORT      ANDNE'H'                                       098903
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'RS'                                                          CAS004
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'RX'                                                          CAS004
     C           CAS004    OREQ 'Y'                                                           CAS004
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      ANDEQ'FR'                                                          CAS004
     C**                                                                  098903
     C** Format Key XXAYY...UP                                            098903
     C**                                                                  098903
     C                     MOVE 'U'       FBD                             098903
     C                     MOVE 'P'       AMTD                            098903
     C                     MOVE *BLANKS   FMKEYS                          098903
     C*                                                                   098903
     C           *IN33     IFEQ '1'                                       186133
     C           F9        OREQ *BLANKS                                                       CAS004
     C                     MOVE *BLANKS   AC1                             186133
     C                     MOVE *BLANKS   PN1                             186133
     C                     MOVE *BLANKS   PR1                             186133
     C                     ELSE                                           186133
     C                     MOVE F10       AC1                             098903
     C                     MOVE '01'      PN1                             098903
     C                     MOVE '1'       PR1                             098903
     C                     END                                            186133
     C           *IN31     IFEQ '1'                                       186133
     C           *IN32     OREQ '1'                                       186133
     C           F9        OREQ *BLANKS                                                       CAS004
     C                     MOVE *BLANKS   AC4                             186133
     C                     MOVE *BLANKS   PN4                             186133
     C                     MOVE *BLANKS   PR4                             186133
     C                     ELSE                                           186133
     C                     MOVE F9        AC4                             098903
     C                     MOVE '01'      PN4                             098903
     C                     MOVE F9PREF    PR4                             098903
     C                     END                                            186133
     C** Update file                                                      098903
      ** Setup book code if required                                                          CAS004
      *                                                                                       CAS004
     C           HORT      IFEQ 'H'                                                           CAS004
     C           BNBCPL    ANDEQ'Y'                                                           CAS004
      *                                                                                       CAS004
     C           *LOVAL    SETLLSDBOOKL1                                                      CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
      *                                                                                       CAS004
     C           *IN99     DOWNE*ON                                                           CAS004
     C           BDHGIN    IFEQ 'Y'                                                           CAS004
     C                     MOVELBDBKCD    CYD                                                 CAS004
     C                     EXSR ACUP                                                          CAS004
     C                     ENDIF                                                              CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
     C                     ENDDO                                                              CAS004
      *                                                                                       CAS004
     C                     ELSE                                                               CAS004
      *                                                                                       CAS004
     C                     MOVEL'  '      CYD                                                 CAS004
     C                     EXSR ACUP                                      098903
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
     C**                                                                  098903
     C** Unrealized Loss Keys                                             098903
     C**                                                                  098903
     C** Format Key XXAYY...UL                                            098903
     C**                                                                  098903
     C                     MOVE 'L'       AMTD                            098903
     C                     MOVE *BLANKS   FMKEYS                          098903
     C           *IN34     IFEQ '1'                                       186133
     C           *IN35     OREQ '1'                                       186133
     C           F11       OREQ *BLANKS                                                       CAS004
     C                     MOVE *BLANKS   AC1                             186133
     C                     MOVE *BLANKS   PN1                             186133
     C                     MOVE *BLANKS   PR1                             186133
     C                     ELSE                                           186133
     C*                                                                   098903
     C                     MOVE F11       AC1                             098903
     C                     MOVE '01'      PN1                             098903
     C                     MOVE F11PRF    PR1                             098903
     C                     END                                            186133
     C           *IN36     IFEQ '1'                                       186133
     C           F11       OREQ *BLANKS                                                       CAS004
     C                     MOVE *BLANKS   AC4                             186133
     C                     MOVE *BLANKS   PN4                             186133
     C                     MOVE *BLANKS   PR4                             186133
     C                     ELSE                                           186133
     C                     MOVE F12       AC4                             098903
     C                     MOVE '01'      PN4                             098903
     C                     MOVE '1'       PR4                             098903
     C                     END                                            186133
     C** Update file                                                      098903
      ** Setup book code if required                                                          CAS004
      *                                                                                       CAS004
     C           HORT      IFEQ 'H'                                                           CAS004
     C           BNBCPL    ANDEQ'Y'                                                           CAS004
      *                                                                                       CAS004
     C           *LOVAL    SETLLSDBOOKL1                                                      CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
      *                                                                                       CAS004
     C           *IN99     DOWNE*ON                                                           CAS004
     C           BDHGIN    IFEQ 'Y'                                                           CAS004
     C                     MOVELBDBKCD    CYD                                                 CAS004
     C                     EXSR ACUP                                                          CAS004
     C                     ENDIF                                                              CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
     C                     ENDDO                                                              CAS004
      *                                                                                       CAS004
     C                     ELSE                                                               CAS004
      *                                                                                       CAS004
     C                     MOVEL'  '      CYD                                                 CAS004
     C                     EXSR ACUP                                      098903
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
     C*                                                                   098903
     C                     END                                            098903
      *                                                                                       CAS004
      ** If Hedge Accounting feature is switched on and Hedge,                                CAS004
      *                                                                                       CAS004
     C           CAS004    IFEQ 'Y'                                                           CAS004
     C           CAS007    ANDEQ'Y'                                                           CAS007
     C           HORT      ANDEQ'H'                                                           CAS004
     C           TYPE      IFEQ 'FR'                                                          CAS004
     C           TYPE      OREQ 'RS'                                                          CAS004
     C           TYPE      OREQ 'RX'                                                          CAS004
     C                     EXSR SRGENH                                                        CAS004
      *                                                                                       CAS005
      ** Generate account keys for Hedge screen 3 if CAS005 is on                             CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     EXSR SRGEN2                                                        CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS004
     C                     ENDIF                                                              CAS004
     C**
     C** Deal Type/SubType reset to blanks before redisplaying initial
     C** screen.
     C**
     C                     MOVE *BLANKS   TYPE
     C                     MOVE *BLANKS   STYP
     C                     MOVE *BLANKS   CLAS                                                CDL038
     C                     MOVE '1'       *IN07
     C*
     C                     END                             Errs in FR screen
     C*
     C                     END                             F3/F12 not pressed
     C*
     C                     END                             F3/F12/Errs in scrn
     C*
     C                     END                                            CIR001
     C*                                                                   CIR001
     C                     ENDSR
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C*                                                                 * CIR001
     C*  UPFEES - Update Fees and Premiums                              * CIR001
     C*                                                                 * CIR001
     C*  Calls - ACUP    - Update ZACKEYAL                              * CIR001
     C*                                                                 * CIR001
     C******************************************************************* CIR001
     C           UPFEES    BEGSR                                          CIR001
     C**                                                                  CIR001
     C           SFINC     IFNE *BLANKS                                   CIR001
     C           SFRCD     ANDNE*BLANKS                                   CIR001
     C           SFRCB     ANDNE*BLANKS                                   CIR001
     C           SFRCC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C** Format Key XXDYY...RF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE 'R'       FBD                             CIR001
     C                     MOVE 'F'       AMTD                            CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFRCB     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFRCC     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     c**                                                                                      245915
     C           CDL039    IFEQ 'Y'                                                           245915
     C**                                                                                    BUG10281
     C** Format Key XXTYY...RF                                                              BUG10281
     C**                                                                                    BUG10281
     C                     MOVE 'T'       EVENTD                                            BUG10281
     C                     MOVE *BLANKS   FMKEYS                                            BUG10281
     C*                                                                                     BUG10281
     C                     MOVE SFRCD     AC1                                               BUG10281
     C                     MOVE '01'      PN1                                               BUG10281
     C                     MOVE '1'       PR1                                               BUG10281
     C** Update file                                                                        BUG10281
     C                     EXSR ACUP                                                        BUG10281
     C**                                                                                      245915
     C                     ENDIF                                                              245915
     C**                                                                  CIR001
     C** Format Key XXAYY...RF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'A'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFRCD     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFINC     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C** Format Key XXVYY...RF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'V'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFRCC     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFRCB     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C                     MOVE *BLANKS   AC2                             CIR001
     C                     MOVE '01'      PN2                             CIR001
     C                     MOVE '2'       PR2                             CIR001
     C                     MOVE SFRCD     AC5                             CIR001
     C                     MOVE '01'      PN5                             CIR001
     C                     MOVE '1'       PR5                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C/COPY WNCPYSRC,AK0030C012
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SFEXP     IFNE *BLANKS                                   CIR001
     C           SFPYD     ANDNE*BLANKS                                   CIR001
     C           SFPYB     ANDNE*BLANKS                                   CIR001
     C           SFPYC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C** Format Key XXDYY...PF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE 'P'       FBD                             CIR001
     C                     MOVE 'F'       AMTD                            CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFPYC     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFPYB     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     c**                                                                                      245915
     C           CDL039    IFEQ 'Y'                                                           245915
     C**                                                                                    BUG10281
     C** Format Key XXTYY...PF                                                              BUG10281
     C**                                                                                    BUG10281
     C                     MOVE 'T'       EVENTD                                            BUG10281
     C                     MOVE *BLANKS   FMKEYS                                            BUG10281
     C*                                                                                     BUG10281
     C                     MOVE SFPYD     AC4                                               BUG10281
     C                     MOVE '01'      PN4                                               BUG10281
     C                     MOVE '1'       PR4                                               BUG10281
     C** Update file                                                                        BUG10281
     C                     EXSR ACUP                                                        BUG10281
     C**                                                                                      245915
     C                     ENDIF                                                              245915
     C**                                                                  CIR001
     C** Format Key XXAYY...PF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'A'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFEXP     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFPYD     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C** Format Key XXVYY...PF                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'V'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SFPYB     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SFPYC     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C                     MOVE SFPYD     AC2                             CIR001
     C                     MOVE '01'      PN2                             CIR001
     C                     MOVE '1'       PR2                             CIR001
     C                     MOVE *BLANKS   AC5                             CIR001
     C                     MOVE '01'      PN5                             CIR001
     C                     MOVE '2'       PR5                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C/COPY WNCPYSRC,AK0030C013
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           upfees         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C*                                                                 * CIR001
     C*  UPBOUT - Update Buy Outs                                       * CIR001
     C*                                                                 * CIR001
     C*  Calls - ACUP    - Update ZACKEYAL                              * CIR001
     C*                                                                 * CIR001
     C******************************************************************* CIR001
     C           UPBOUT    BEGSR                                          CIR001
     C**                                                                  CIR001
     C           SBINC     IFNE *BLANKS                                   CIR001
     C           SBRCB     ANDNE*BLANKS                                   CIR001
     C           SBRCC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C** Format Key XXDYY...RB                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE 'R'       FBD                             CIR001
     C                     MOVE 'B'       AMTD                            CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SBRCB     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SBRCC     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C** Format Key XXVYY...RB                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'V'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SBRCC     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SBRCB     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C                     MOVE *BLANKS   AC2                             CIR001
     C                     MOVE '01'      PN2                             CIR001
     C                     MOVE '2'       PR2                             CIR001
     C                     MOVE SBINC     AC5                             CIR001
     C                     MOVE '01'      PN5                             CIR001
     C                     MOVE '1'       PR5                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C/COPY WNCPYSRC,AK0030C014
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SBEXP     IFNE *BLANKS                                   CIR001
     C           SBPYB     ANDNE*BLANKS                                   CIR001
     C           SBPYC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C** Format Key XXDYY...PB                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'D'       EVENTD                          CIR001
     C                     MOVE '   '     CYD                             CIR001
     C                     MOVE 'P'       FBD                             CIR001
     C                     MOVE 'B'       AMTD                            CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SBPYC     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SBPYB     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C** Format Key XXVYY...PB                                            CIR001
     C**                                                                  CIR001
     C                     MOVE 'V'       EVENTD                          CIR001
     C                     MOVE *BLANKS   FMKEYS                          CIR001
     C*                                                                   CIR001
     C                     MOVE SBPYB     AC1                             CIR001
     C                     MOVE '01'      PN1                             CIR001
     C                     MOVE '1'       PR1                             CIR001
     C                     MOVE SBPYC     AC4                             CIR001
     C                     MOVE '01'      PN4                             CIR001
     C                     MOVE '1'       PR4                             CIR001
     C                     MOVE SBEXP     AC2                             CIR001
     C                     MOVE '01'      PN2                             CIR001
     C                     MOVE '1'       PR2                             CIR001
     C                     MOVE *BLANKS   AC5                             CIR001
     C                     MOVE '01'      PN5                             CIR001
     C                     MOVE '2'       PR5                             CIR001
     C** Update file                                                      CIR001
     C                     EXSR ACUP                                      CIR001
     C**                                                                  CIR001
     C/COPY WNCPYSRC,AK0030C015
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           upbout         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS02 - Validate 2nd detail screen                           * CIR001
     C**                                                                * CIR001
     C**  Called By - FRP - Validate FRA/IRS detail screen - 1          * CIR001
     C**                                                                * CIR001
     C**  Calls - Y2CLMSC - Clear program message queue (external)      * CIR001
     C**          VALS2A  - Validate 2nd detail screen (TOP HALF)       * CIR001
     C**          VALS2B  - Validate 2nd detail screen (LOWER HALF)     * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS02    BEGSR                                          CIR001
     C**                                                                  CIR001
     C                     WRITE#MSGCTL                                   CIR001
     C                     EXFMTACKEYFE                                   CIR001
     C**                                                                  CIR001
     C** Clear messages from program message queue.                       CIR001
     C**                                                                  CIR001
     C                     CALL 'Y2CLMSC'                                 CIR001
     C                     PARM SPGMQ     ZAPGM  10                       CIR001
     C                     PARM '*SAME'   ZAPGRL  5                       CIR001
     C**                                                                  CIR001
     C                     SETOF                     717273               CIR001
     C                     SETOF                     747576               CIR001
     C                     SETOF                     7778                 CIR001
     C**                                                                  CIR001
     C           *IN03     IFNE '1'                                       CIR001
     C           *IN12     ANDNE'1'                                       CIR001
     C**                                                                  CIR001
     C           '?'       SCAN SCRN2                    87               CIR001
     C           *IN87     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SFINC     IFNE *BLANKS                                   CIR001
     C           SFRCD     ANDNE*BLANKS                                   CIR001
     C           SFRCB     ANDNE*BLANKS                                   CIR001
     C           SFRCC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C                     EXSR VALS2A                     top half of 2ndCIR001
     C**                                                   detail screen  CIR001
     C                     ELSE                                           CIR001
     C**                                                                  CIR001
     C           SFINC     IFNE *BLANKS                                   CIR001
     C           SFRCD     ORNE *BLANKS                                   CIR001
     C           SFRCB     ORNE *BLANKS                                   CIR001
     C           SFRCC     ORNE *BLANKS                                   CIR001
     C                     SETON                     717273               CIR001
     C                     SETON                     74                   CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR2905' ZAMSID                          CIR001
     C                     EXSR ZASNMS                                    CIR001
     C                     ENDIF                                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SFEXP     IFNE *BLANKS                                   CIR001
     C           SFPYD     ANDNE*BLANKS                                   CIR001
     C           SFPYB     ANDNE*BLANKS                                   CIR001
     C           SFPYC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C                     EXSR VALS2B                     lower half of  CIR001
     C**                                                   2nd det scrn   CIR001
     C                     ELSE                                           CIR001
     C**                                                                  CIR001
     C           SFEXP     IFNE *BLANKS                                   CIR001
     C           SFPYD     ORNE *BLANKS                                   CIR001
     C           SFPYB     ORNE *BLANKS                                   CIR001
     C           SFPYC     ORNE *BLANKS                                   CIR001
     C                     SETON                     757677               CIR001
     C                     SETON                     78                   CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR2905' ZAMSID                          CIR001
     C                     EXSR ZASNMS                                    CIR001
     C                     ENDIF                                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDIF                           *IN03/12       CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals02         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS2A - Validate 2nd detail screen (TOP HALF)                * CIR001
     C**                                                                * CIR001
     C**  Called By - VALS02 - Validate 2nd detail screen               * CIR001
     C**                                                                * CIR001
     C**  Calls     - AOACODR0 - Account Codes (External)               * CIR001
     C**              ZASNMS   - Send message to program message queue  * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS2A    BEGSR                                          CIR001
     C**                                                                  CIR001
     C** Check SFINC (Fees and Premiums Income Account) is entered        CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFINC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     71                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN71     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFRCD (Fees Received) is entered and is valid              CIR001
     C** non-title Account code                                           CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFRCD                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     72                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN72     IFEQ '1'                                       CIR001
     C           A5TOIN    OREQ 'Y'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFRCB (Fees Receivable Account) is entered and is          CIR001
     C** valid non-title Account code                                     CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFRCB                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     73                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN73     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFRCC (Fees Receivable Contra Account) is entered          CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFRCC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     74                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN74     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals2a         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS2B - Validate 2nd detail screen (LOWER HALF)              * CIR001
     C**                                                                * CIR001
     C**  Called By - VALS02 - Validate 2nd detail screen               * CIR001
     C**                                                                * CIR001
     C**  Calls     - AOACODR0 - Account Codes (External)               * CIR001
     C**              ZASNMS   - Send message to program message queue  * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS2B    BEGSR                                          CIR001
     C**                                                                  CIR001
     C** Check SFEXP (Up-Front Fees and Premiums Expense Account)         CIR001
     C** is entered and is valid non-title Account code                   CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFEXP                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     75                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN75     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFPYD (Fees Paid Account) is entered and is                CIR001
     C** valid non-title Account code                                     CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFPYD                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     76                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN76     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFPYB (Fees Payable Account) is entered and is             CIR001
     C** valid non-title Account code                                     CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFPYB                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     77                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN77     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SFPYC (Fees Payable Contra Account) is entered             CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SFPYC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     78                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN78     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID2                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals2b         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS03 - Validate 3rd detail screen                           * CIR001
     C**                                                                * CIR001
     C**  Called By - FRP - Validate FRA/IRS detail screen - 1          * CIR001
     C**                                                                * CIR001
     C**  Calls - Y2CLMSC - Clear program message queue (external)      * CIR001
     C**          VALS2A  - Validate 3rd detail screen (TOP HALF)       * CIR001
     C**          VALS2B  - Validate 3rd detail screen (LOWER HALF)     * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS03    BEGSR                                          CIR001
     C**                                                                  CIR001
     C                     WRITE#MSGCTL                                   CIR001
     C                     EXFMTACKEYBO                                   CIR001
     C**                                                                  CIR001
     C** Clear messages from program message queue.                       CIR001
     C**                                                                  CIR001
     C                     CALL 'Y2CLMSC'                                 CIR001
     C                     PARM SPGMQ     ZAPGM  10                       CIR001
     C                     PARM '*SAME'   ZAPGRL  5                       CIR001
     C**                                                                  CIR001
     C                     SETOF                     818283               CIR001
     C                     SETOF                     848586               CIR001
     C**                                                                  CIR001
     C           *IN03     IFNE '1'                                       CIR001
     C           *IN12     ANDNE'1'                                       CIR001
     C**                                                                  CIR001
     C           '?'       SCAN SCRN3                    88               CIR001
     C           *IN88     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SBINC     IFNE *BLANKS                                   CIR001
     C           SBRCB     ANDNE*BLANKS                                   CIR001
     C           SBRCC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C                     EXSR VALS3A                                    CIR001
     C                     ELSE                                           CIR001
     C**                                                                  CIR001
     C           SBINC     IFNE *BLANKS                                   CIR001
     C           SBRCB     ORNE *BLANKS                                   CIR001
     C           SBRCC     ORNE *BLANKS                                   CIR001
     C                     SETON                     818283               CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4252' ZAMSID                          CIR001
     C                     EXSR ZASNMS                                    CIR001
     C                     ENDIF                                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C           SBEXP     IFNE *BLANKS                                   CIR001
     C           SBPYB     ANDNE*BLANKS                                   CIR001
     C           SBPYC     ANDNE*BLANKS                                   CIR001
     C**                                                                  CIR001
     C                     EXSR VALS3B                                    CIR001
     C                     ELSE                                           CIR001
     C**                                                                  CIR001
     C           SBEXP     IFNE *BLANKS                                   CIR001
     C           SBPYB     ORNE *BLANKS                                   CIR001
     C           SBPYC     ORNE *BLANKS                                   CIR001
     C                     SETON                     848586               CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4252' ZAMSID                          CIR001
     C                     EXSR ZASNMS                                    CIR001
     C                     ENDIF                                          CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDIF                           *IN03/12       CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals03         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS3A - Validate 3rd detail screen (TOP HALF)                * CIR001
     C**                                                                * CIR001
     C**  Called By - VALS03 - Validate 3rd detail screen               * CIR001
     C**                                                                * CIR001
     C**  Calls     - AOACODR0 - Account Codes (External)               * CIR001
     C**              ZASNMS   - Send message to program message queue  * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS3A    BEGSR                                          CIR001
     C**                                                                  CIR001
     C** Check SBINC (Buy-Outs Income Account) is entered                 CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBINC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     81                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN81     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SBRCB (Buy-Outs Receivable Account) is entered             CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBRCB                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     82                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN82     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SBRCC (Buy-Outs Receivable Contra Account) is              CIR001
     C** entered and is valid non-title Account code                      CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBRCC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     83                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN83     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals3a         CIR001
     C******************************************************************* CIR001
      /EJECT                                                              CIR001
     C******************************************************************* CIR001
     C**                                                                * CIR001
     C**  VALS3B - Validate 3rd detail screen (LOWER HALF)              * CIR001
     C**                                                                * CIR001
     C**  Called By - VALS03 - Validate 3rd detail screen               * CIR001
     C**                                                                * CIR001
     C**  Calls     - AOACODR0 - Account Codes (External)               * CIR001
     C**              ZASNMS   - Send message to program message queue  * CIR001
     C**                                                                * CIR001
     C******************************************************************* CIR001
     C           VALS3B    BEGSR                                          CIR001
     C**                                                                  CIR001
     C** Check SBEXP (Buy-Outs Expense Account) is entered                CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBEXP                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     84                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN84     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SBPYB (Buy-Outs Payable Account) is entered                CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBPYB                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     85                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN85     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C** Check SBPYC (Buy-Outs Payable Account) is entered                CIR001
     C** and is valid non-title Account code                              CIR001
     C**                                                                  CIR001
     C                     CALL 'AOACODR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*KEY   ' @OPTN   7                       CIR001
     C                     PARM           SBPYC                           CIR001
     C********** SDACOD    PARM SDACOD    DSFDY                                        CIR001 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANKS                                   CIR001
     C           @RTCD     OREQ *BLANKS                                   CIR001
     C           A5TOIN    ANDEQ'Y'                                       CIR001
     C                     SETON                     86                   CIR001
     C                     ENDIF                                          CIR001
     C*                                                                   CIR001
     C           *IN86     IFEQ '1'                                       CIR001
     C                     MOVE 'N'       VALID3                          CIR001
     C                     MOVEL'USR4230' ZAMSID           screen Msg ID. CIR001
     C                     EXSR ZASNMS                     Send message   CIR001
     C                     ENDIF                                          CIR001
     C**                                                                  CIR001
     C                     ENDSR                           vals3b         CIR001
     C********************************************************************
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRDSPH - Subroutine to Display Hedge Accounting Screens       *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/FRP                                             *                       CAS004
      *                                                               *                       CAS004
      * Calls: SR/SRCLRI, SR/SRVLH1, SR/SRVLH2                        *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRDSPH    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** If Hedge and Hedge Accounting feature is switched on,                                CAS004
      *                                                                                       CAS004
     C           HORT      IFEQ 'H'                                                           CAS004
     C           CAS004    ANDEQ'Y'                                                           CAS004
     C           CAS007    ANDEQ'Y'                                                           CAS007
     C           TYPE      ANDEQ'RS'                                                          CAS004
     C           HORT      OREQ 'H'                                                           CAS004
     C           CAS004    ANDEQ'Y'                                                           CAS004
     C           CAS007    ANDEQ'Y'                                                           CAS007
     C           TYPE      ANDEQ'RX'                                                          CAS004
     C           HORT      OREQ 'H'                                                           CAS004
     C           CAS004    ANDEQ'Y'                                                           CAS004
     C           CAS007    ANDEQ'Y'                                                           CAS007
     C           TYPE      ANDEQ'FR'                                                          CAS004
      *                                                                                       CAS004
      ** Display hedge accounting screen 1 until F3 OR F12 is pressed OR                      CAS004
      ** errors are corrected                                                                 CAS004
      *                                                                                       CAS004
     C           *IN03     DOUEQ*ON                                                           CAS004
     C           *IN12     OREQ *ON                                                           CAS004
     C           WVALH1    OREQ 'Y'                                                           CAS004
      *                                                                                       CAS004
     C                     WRITE#MSGCTL                                                       CAS004
     C                     EXFMTACKEYF1                                                       CAS004
      *                                                                                       CAS004
      ** Clear messages from program message queue.                                           CAS004
      *                                                                                       CAS004
     C                     CALL 'Y2CLMSC'                                                     CAS004
     C                     PARM SPGMQ     ZAPGM                                               CAS004
     C                     PARM '*SAME'   ZAPGRL                                              CAS004
      *                                                                                       CAS004
      ** Clear Hendge Accounting screen field error indicators                                CAS004
      *                                                                                       CAS004
     C                     EXSR SRCLRI                                                        CAS004
     C                     MOVE 'Y'       WVALH1                                              CAS004
      *                                                                                       CAS004
     C           *IN03     IFEQ *OFF                                                          CAS004
     C           *IN12     ANDEQ*OFF                                                          CAS004
     C                     EXSR SRVLH1                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           *IN03     IFEQ *OFF                                                          CAS004
     C           *IN12     ANDEQ*OFF                                                          CAS004
     C           WVALH1    ANDEQ'Y'                                                           CAS004
      *                                                                                       CAS004
      ** Display hedge accounting screen 2 until F3 OR F12 is pressed OR                      CAS004
      ** errors are corrected                                                                 CAS004
      *                                                                                       CAS004
     C           *IN03     DOUEQ*ON                                                           CAS004
     C           *IN12     OREQ *ON                                                           CAS004
     C           WVALH2    OREQ 'Y'                                                           CAS004
      *                                                                                       CAS004
     C                     WRITE#MSGCTL                                                       CAS004
     C                     EXFMTACKEYF2                                                       CAS004
      *                                                                                       CAS004
      ** Clear messages from program message queue.                                           CAS004
      *                                                                                       CAS004
     C                     CALL 'Y2CLMSC'                                                     CAS004
     C                     PARM SPGMQ     ZAPGM                                               CAS004
     C                     PARM '*SAME'   ZAPGRL                                              CAS004
      *                                                                                       CAS004
      ** Clear Hendge Accounting screen field error indicators                                CAS004
      *                                                                                       CAS004
     C                     EXSR SRCLRI                                                        CAS004
     C                     MOVE 'Y'       WVALH2                                              CAS004
      *                                                                                       CAS004
     C           *IN03     IFEQ *OFF                                                          CAS004
     C           *IN12     ANDEQ*OFF                                                          CAS004
     C                     EXSR SRVLH2                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS005
      ** Display Further Enhancement for Hedge Accounting                                     CAS005
      ** screen if CAS005 is installed.                                                       CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     EXSR SRCAS5                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS004
     C                     ENDDO                                                              CAS004
      *                                                                                       CAS004
     C           *IN12     IFEQ *ON                                                           CAS004
     C                     MOVE *OFF      *IN12                                               CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     EXSR SRCLRI                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDDO                                                              CAS004
      *                                                                                       CAS004
     C           *IN12     IFEQ *ON                                                           CAS004
     C                     MOVE *OFF      *IN12                                               CAS004
     C                     MOVE *ON       *IN64                                               CAS004
     C                     EXSR SRCLRI                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRCAS5 - Subroutine to Display Further Enhancements to        *                       CAS005
      *          Hedge Accounting screen                              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRCAS5    BEGSR                                                              CAS005
      *                                                                                       CAS005
     C           *IN03     IFEQ *OFF                                                          CAS005
     C           *IN12     ANDEQ*OFF                                                          CAS005
     C           WVALH2    ANDEQ'Y'                                                           CAS005
      *                                                                                       CAS005
      ** Display hedge accounting screen 3 until F3 OR F12 is pressed OR                      CAS005
      ** errors are corrected                                                                 CAS005
      *                                                                                       CAS005
     C           *IN03     DOUEQ*ON                                                           CAS005
     C           *IN12     OREQ *ON                                                           CAS005
     C           WVALH3    OREQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C                     WRITE#MSGCTL                                                       CAS005
     C                     EXFMTACKEYF3                                                       CAS005
      *                                                                                       CAS005
      ** Clear messages from program message queue.                                           CAS005
      *                                                                                       CAS005
     C                     CALL 'Y2CLMSC'                                                     CAS005
     C                     PARM SPGMQ     ZAPGM                                               CAS005
     C                     PARM '*SAME'   ZAPGRL                                              CAS005
      *                                                                                       CAS005
      ** Clear Hendge Accounting screen field error indicators                                CAS005
      *                                                                                       CAS005
     C                     EXSR SRCLRI                                                        CAS005
     C                     MOVE 'Y'       WVALH3                                              CAS005
      *                                                                                       CAS005
     C           *IN03     IFEQ *OFF                                                          CAS005
     C           *IN12     ANDEQ*OFF                                                          CAS005
     C                     EXSR SRVLH3                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDDO                                                              CAS005
      *                                                                                       CAS005
     C           *IN12     IFEQ *ON                                                           CAS005
     C                     MOVE *OFF      *IN12                                               CAS005
     C                     MOVE 'N'       WVALH2                                              CAS005
     C                     EXSR SRCLRI                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRVLH1 - Subroutine to validate hedge accounting screen 1     *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/SRDSPH                                          *                       CAS004
      *                                                               *                       CAS004
      * Calls: SR/SRACOD                                              *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRVLH1    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** Move Y to WSRVL1 to indicate that this is from SRVLH1                                CAS004
      *                                                                                       CAS004
     C                     MOVE 'Y'       WSRVL1  1                                           CAS004
      *                                                                                       CAS004
      ** Enter ALL or NONE of: Effective Fair Value Hedge Profit Contra                       CAS004
      ** Account; Profit Posting Reference; Hedge Profit Account;                             CAS004
      ** Effective Fair Value Hedge Loss Contra Account; Loss Posting                         CAS004
      ** Reference; Hedge Loss Account                                                        CAS004
      *                                                                                       CAS004
     C                     SELEC                                                              CAS004
      *                                                                                       CAS004
     C           SEFVHP    WHNE *BLANKS                                                       CAS004
     C           SEPRF1    ANDNE*BLANKS                                                       CAS004
     C           SEFHPA    ANDNE*BLANKS                                                       CAS004
     C           SEFVHL    ANDNE*BLANKS                                                       CAS004
     C           SEPRF2    ANDNE*BLANKS                                                       CAS004
     C           SEFHLA    ANDNE*BLANKS                                                       CAS004
      *                                                                                       CAS004
      ** Validate Effective Fair Value Hedge Profit Account                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC  1                                           CAS004
     C                     MOVELSEFVHP    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SEFVHP                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN23                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SEPRF1    IFNE '1'                                                           CAS004
     C           SEPRF1    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN24                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Hedge Profit Account                                                        CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSEFHPA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SEFHPA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN29                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Effective Fair Value Hedge Loss Account                                     CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSEFVHL    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SEFVHL                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN30                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SEPRF2    IFNE '1'                                                           CAS004
     C           SEPRF2    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN38                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Hedge Loss Account                                                          CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSEFHLA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SEFHLA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN40                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           SEFVHP    WHEQ *BLANKS                                                       CAS004
     C           SEPRF1    ANDEQ*BLANKS                                                       CAS004
     C           SEFHPA    ANDEQ*BLANKS                                                       CAS004
     C           SEFVHL    ANDEQ*BLANKS                                                       CAS004
     C           SEPRF2    ANDEQ*BLANKS                                                       CAS004
     C           SEFHLA    ANDEQ*BLANKS                                                       CAS004
      *                                                                                       CAS004
     C                     OTHER                                                              CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR9388' ZAMSID                                              CAS004
     C                     MOVEA'11'      *IN,23                                              CAS004
     C                     MOVEA'11'      *IN,29                                              CAS004
     C                     MOVE *ON       *IN38                                               CAS004
     C                     MOVE *ON       *IN40                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSL                                                              CAS004
      *                                                                                       CAS004
      ** Enter ALL or NONE of: Effective Cash Flow Hedge Profit Contra                        CAS004
      ** Account; Profit Posting Reference; Other Comprehensive Income                        CAS004
      ** Account; Effective Cash Flow Hedge Loss Contra Account; Loss                         CAS004
      ** Posting Reference; Other Comprehensive Income Account(Loss)                          CAS004
      *                                                                                       CAS004
     C                     SELEC                                                              CAS004
      *                                                                                       CAS004
     C           SECFHP    WHNE *BLANKS                                                       CAS004
     C           SEPRF3    ANDNE*BLANKS                                                       CAS004
     C           SEPOCI    ANDNE*BLANKS                                                       CAS004
     C           SECFHL    ANDNE*BLANKS                                                       CAS004
     C           SEPRF4    ANDNE*BLANKS                                                       CAS004
     C           SELOCI    ANDNE*BLANKS                                                       CAS004
      *                                                                                       CAS004
      ** Validate Effective Cash Flow Hedge Profit Account                                    CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSECFHP    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SECFHP                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN45                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SEPRF3    IFNE '1'                                                           CAS004
     C           SEPRF3    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN46                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Other Comprehensive Income Account                                          CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSEPOCI    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SEPOCI                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN47                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Effective Cash Flow Hedge Loss Account                                      CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSECFHL    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SECFHL                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN48                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SEPRF4    IFNE '1'                                                           CAS004
     C           SEPRF4    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN49                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Other Comprehensive Income Account                                          CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSELOCI    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SELOCI                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN68                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           SECFHP    WHEQ *BLANKS                                                       CAS004
     C           SEPRF3    ANDEQ*BLANKS                                                       CAS004
     C           SEPOCI    ANDEQ*BLANKS                                                       CAS004
     C           SECFHL    ANDEQ*BLANKS                                                       CAS004
     C           SEPRF4    ANDEQ*BLANKS                                                       CAS004
     C           SELOCI    ANDEQ*BLANKS                                                       CAS004
      *                                                                                       CAS004
     C                     OTHER                                                              CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     MOVE 'USR9389' ZAMSID                                              CAS004
     C                     MOVEA'11111'   *IN,45                                              CAS004
     C                     MOVE *ON       *IN68                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSL                                                              CAS004
      *                                                                                       CAS004
      ** Move N to WSRVL1 to indicate that SRVLH1 is finished                                 CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WSRVL1                                              CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRVLH2 - Subroutine to validate hedge accounting screen 2     *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/SRDSPH                                          *                       CAS004
      *                                                               *                       CAS004
      * Calls: SR/SRACOD                                              *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRVLH2    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** Move Y to WSRVL2 to indicate that this is from SRVLH2                                CAS004
      *                                                                                       CAS004
     C                     MOVE 'Y'       WSRVL2  1                                           CAS004
      *                                                                                       CAS004
      ** Enter ALL or NONE of: Ineffective Fair Value Hedge Profit Contra                     CAS004
      ** Account; Profit Posting Reference; Trading Profit Account;                           CAS004
      ** Ineffective Fair Value Hedge Loss Contra Account; Loss Posting                       CAS004
      ** Reference; Trading Loss Account                                                      CAS004
      *                                                                                       CAS004
     C                     SELEC                                                              CAS004
      *                                                                                       CAS004
     C           SIFVHP    WHNE *BLANKS                                                       CAS004
     C           SIPRF1    ANDNE*BLANKS                                                       CAS004
     C           SIFTPA    ANDNE*BLANKS                                                       CAS004
     C           SIFVHL    ANDNE*BLANKS                                                       CAS004
     C           SIPRF2    ANDNE*BLANKS                                                       CAS004
     C           SIFTLA    ANDNE*BLANKS                                                       CAS004
      *                                                                                       CAS004
      ** Validate Ineffective Fair Value Hedge Profit Account                                 CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC  1                                           CAS004
     C                     MOVELSIFVHP    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SIFVHP                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN23                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SIPRF1    IFNE '1'                                                           CAS004
     C           SIPRF1    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN24                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Trading Profit Account                                                      CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSIFTPA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SIFTPA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN29                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Ineffective Fair Value Hedge Loss Account                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSIFVHL    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SIFVHL                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN30                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SIPRF2    IFNE '1'                                                           CAS004
     C           SIPRF2    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN38                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Trading Loss Account                                                        CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSIFTLA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SIFTLA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN40                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           SIFVHP    WHEQ *BLANKS                                                       CAS004
     C           SIPRF1    ANDEQ*BLANKS                                                       CAS004
     C           SIFTPA    ANDEQ*BLANKS                                                       CAS004
     C           SIFVHL    ANDEQ*BLANKS                                                       CAS004
     C           SIPRF2    ANDEQ*BLANKS                                                       CAS004
     C           SIFTLA    ANDEQ*BLANKS                                                       CAS004
      *                                                                                       CAS004
     C                     OTHER                                                              CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR9390' ZAMSID                                              CAS004
     C                     MOVEA'11'      *IN,23                                              CAS004
     C                     MOVEA'11'      *IN,29                                              CAS004
     C                     MOVE *ON       *IN38                                               CAS004
     C                     MOVE *ON       *IN40                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSL                                                              CAS004
      *                                                                                       CAS004
      ** Enter ALL or NONE of: Ineffective Cash Flow Hedge Profit Contra                      CAS004
      ** Account; Profit Posting Reference; Trading Profit Account                            CAS004
      ** Ineffective Cash Flow Hedge Loss Contra Account; Loss Posting                        CAS004
      ** Reference; Trading Loss Account                                                      CAS004
      *                                                                                       CAS004
     C                     SELEC                                                              CAS004
      *                                                                                       CAS004
     C           SICFHP    WHNE *BLANKS                                                       CAS004
     C           SIPRF3    ANDNE*BLANKS                                                       CAS004
     C           SICTPA    ANDNE*BLANKS                                                       CAS004
     C           SICFHL    ANDNE*BLANKS                                                       CAS004
     C           SIPRF4    ANDNE*BLANKS                                                       CAS004
     C           SICTLA    ANDNE*BLANKS                                                       CAS004
      *                                                                                       CAS004
      ** Validate Ineffective Cash Flow Hedge Profit Account                                  CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSICFHP    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SICFHP                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN45                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SIPRF3    IFNE '1'                                                           CAS004
     C           SIPRF3    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN46                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Trading Profit Account                                                      CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSICTPA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SICTPA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN47                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Ineffective Cash Flow Hedge Loss Account                                    CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSICFHL    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SICFHL                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN48                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Posting Reference                                                           CAS004
      *                                                                                       CAS004
     C           SIPRF4    IFNE '1'                                                           CAS004
     C           SIPRF4    ANDNE'3'                                                           CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR4259' ZAMSID                                              CAS004
     C                     MOVE *ON       *IN49                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Validate Trading Loss Account                                                        CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WINVAC                                              CAS004
     C                     MOVELSICTLA    PIACOD                                              CAS004
     C                     EXSR SRACOD                                                        CAS004
     C                     MOVELPIACOD    SICTLA                                              CAS004
      *                                                                                       CAS004
     C           WINVAC    IFEQ 'Y'                                                           CAS004
     C                     MOVE *ON       *IN68                                               CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           SICFHP    WHEQ *BLANKS                                                       CAS004
     C           SIPRF3    ANDEQ*BLANKS                                                       CAS004
     C           SICTPA    ANDEQ*BLANKS                                                       CAS004
     C           SICFHL    ANDEQ*BLANKS                                                       CAS004
     C           SIPRF4    ANDEQ*BLANKS                                                       CAS004
     C           SICTLA    ANDEQ*BLANKS                                                       CAS004
      *                                                                                       CAS004
     C                     OTHER                                                              CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     MOVE 'USR9391' ZAMSID                                              CAS004
     C                     MOVEA'11111'   *IN,45                                              CAS004
     C                     MOVE *ON       *IN68                                               CAS004
     C                     EXSR ZASNMS                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSL                                                              CAS004
      *                                                                                       CAS004
      ** Move N to WSRVL2 to indicate that SRVLH2 is finished                                 CAS004
      *                                                                                       CAS004
     C                     MOVE 'N'       WSRVL2                                              CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRVLH3 - Subroutine to validate hedge accounting screen 3     *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRVLH3    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** Move Y to WSRVL3 to indicate that this is from SRVLH3                                CAS005
      *                                                                                       CAS005
     C                     MOVE 'Y'       WSRVL3  1                                           CAS005
      *                                                                                       CAS005
      ** If the first "Unrealised Fair Value Revalued Profit Contra                           CAS005
      ** A/C Code" is NOT blank, all other fields must also have a value                      CAS005
      *                                                                                       CAS005
     C                     SELEC                                                              CAS005
      *                                                                                       CAS005
     C           SUFVHP    WHNE *BLANKS                                                       CAS005
     C           SUPRF1    ANDNE*BLANKS                                                       CAS005
     C           SUFHPA    ANDNE*BLANKS                                                       CAS005
     C           SUFVHL    ANDNE*BLANKS                                                       CAS005
     C           SUPRF2    ANDNE*BLANKS                                                       CAS005
     C           SUFHLA    ANDNE*BLANKS                                                       CAS005
      *                                                                                       CAS005
      ** Validate Unrealised Fair Value Revalued Profit Contra Account                        CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUFVHP    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUFVHP                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN23                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Posting Reference                                                           CAS005
      *                                                                                       CAS005
     C           SUPRF1    IFNE '1'                                                           CAS005
     C           SUPRF1    ANDNE'3'                                                           CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR4259' ZAMSID                                              CAS005
     C                     MOVE *ON       *IN24                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealised Fair Value Revalued Profit Account                               CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUFHPA    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUFHPA                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN29                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealised Fair Value Revalued Loss Contra Account                          CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUFVHL    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUFVHL                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN30                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Posting Reference                                                           CAS005
      *                                                                                       CAS005
     C           SUPRF2    IFNE '1'                                                           CAS005
     C           SUPRF2    ANDNE'3'                                                           CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR4259' ZAMSID                                              CAS005
     C                     MOVE *ON       *IN38                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealised Fair Value Revalued Loss Account                                 CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUFHLA    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUFHLA                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN40                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Proceed if all fields are blanks                                                     CAS005
      *                                                                                       CAS005
     C           SUFVHP    WHEQ *BLANKS                                                       CAS005
     C           SUPRF1    ANDEQ*BLANKS                                                       CAS005
     C           SUFHPA    ANDEQ*BLANKS                                                       CAS005
     C           SUFVHL    ANDEQ*BLANKS                                                       CAS005
     C           SUPRF2    ANDEQ*BLANKS                                                       CAS005
     C           SUFHLA    ANDEQ*BLANKS                                                       CAS005
      *                                                                                       CAS005
      ** Error if not all blanks of have not entered all                                      CAS005
      *                                                                                       CAS005
     C                     OTHER                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR9388' ZAMSID                                              CAS005
     C                     MOVEA'11'      *IN,23                                              CAS005
     C                     MOVEA'11'      *IN,29                                              CAS005
     C                     MOVE *ON       *IN38                                               CAS005
     C                     MOVE *ON       *IN40                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
      *                                                                                       CAS005
     C                     ENDSL                                                              CAS005
      *                                                                                       CAS005
      ** If the first "Unrealised Cash Flow Revalued Profit Contra A/C                        CAS005
      ** Code" is NOT blank, all other fields must also have a value                          CAS005
      *                                                                                       CAS005
     C                     SELEC                                                              CAS005
      *                                                                                       CAS005
     C           SUCFHP    WHNE *BLANKS                                                       CAS005
     C           SUPRF3    ANDNE*BLANKS                                                       CAS005
     C           SUPOCI    ANDNE*BLANKS                                                       CAS005
     C           SUCFHL    ANDNE*BLANKS                                                       CAS005
     C           SUPRF4    ANDNE*BLANKS                                                       CAS005
     C           SULOCI    ANDNE*BLANKS                                                       CAS005
      *                                                                                       CAS005
      ** Validate Unrealized Cash Flow Revalued Profit Contra Account                         CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUCFHP    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUCFHP                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN45                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Posting Reference                                                           CAS005
      *                                                                                       CAS005
     C           SUPRF3    IFNE '1'                                                           CAS005
     C           SUPRF3    ANDNE'3'                                                           CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR4259' ZAMSID                                              CAS005
     C                     MOVE *ON       *IN46                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealized Cash Flow Revalued Profit Account                                CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUPOCI    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUPOCI                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN47                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealized Cash Flow Revalued Loss Contra Account                           CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSUCFHL    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SUCFHL                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN48                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Posting Reference                                                           CAS005
      *                                                                                       CAS005
     C           SUPRF4    IFNE '1'                                                           CAS005
     C           SUPRF4    ANDNE'3'                                                           CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR4259' ZAMSID                                              CAS005
     C                     MOVE *ON       *IN49                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Validate Unrealized Cash Flow Revalued Loss Account                                  CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WINVAC                                              CAS005
     C                     MOVELSULOCI    PIACOD                                              CAS005
     C                     EXSR SRACOD                                                        CAS005
     C                     MOVELPIACOD    SULOCI                                              CAS005
      *                                                                                       CAS005
     C           WINVAC    IFEQ 'Y'                                                           CAS005
     C                     MOVE *ON       *IN68                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           SUCFHP    WHEQ *BLANKS                                                       CAS005
     C           SUPRF3    ANDEQ*BLANKS                                                       CAS005
     C           SUPOCI    ANDEQ*BLANKS                                                       CAS005
     C           SUCFHL    ANDEQ*BLANKS                                                       CAS005
     C           SUPRF4    ANDEQ*BLANKS                                                       CAS005
     C           SULOCI    ANDEQ*BLANKS                                                       CAS005
      *                                                                                       CAS005
     C                     OTHER                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     MOVE 'USR9389' ZAMSID                                              CAS005
     C                     MOVEA'11111'   *IN,45                                              CAS005
     C                     MOVE *ON       *IN68                                               CAS005
     C                     EXSR ZASNMS                                                        CAS005
      *                                                                                       CAS005
     C                     ENDSL                                                              CAS005
      *                                                                                       CAS005
      ** Move N to WSRVL3 to indicate that SRVLH3 is finished                                 CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WSRVL3                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRCLRI - Subroutine to Clear Hedge Accounting Screen Field    *                       CAS004
      *          Error Indicators                                     *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/SRDSPH                                          *                       CAS004
      *                                                               *                       CAS004
      * Calls: None                                                   *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRCLRI    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** Initialise Hedge Accounting screens 1 & 2 error field indicators                     CAS004
      *                                                                                       CAS004
     C                     MOVEA'00'      *IN,23                                              CAS004
     C                     MOVEA'00'      *IN,29                                              CAS004
     C                     MOVE *OFF      *IN38                                               CAS004
     C                     MOVE *OFF      *IN40                                               CAS004
     C                     MOVEA'00000'   *IN,45                                              CAS004
     C                     MOVE *OFF      *IN68                                               CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRGENH - Subroutine to Generata Account Keys for Hedge        *                       CAS004
      *          Accounting                                           *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/FRP                                             *                       CAS004
      *                                                               *                       CAS004
      * Calls: SR/SRBOOK                                              *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRGENH    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** Initialise constant fields                                                           CAS004
      *                                                                                       CAS004
     C                     MOVE *BLANKS   DLKEY                                               CAS004
     C                     MOVE TYPE      DTYPD                                               CAS004
     C                     MOVE STYP      STYPD                                               CAS004
     C                     MOVE CLAS      CLASD                                               CDL038
     C                     MOVE 'A'       EVENTD                                              CAS004
     C                     MOVEL'  '      CYD                                                 CAS004
      *                                                                                       CAS004
      ** xxAyybbFDP - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'FDP'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SEFVHP    AC1                                                 CAS004
     C                     MOVE SEPRF1    PR1                                                 CAS004
     C           SEFVHP    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbFDP - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SEFHPA    AC4                                                 CAS004
     C                     MOVE SEPRF1    PR4                                                 CAS004
     C           SEFHPA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbFDL - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'FDL'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SEFHLA    AC1                                                 CAS004
     C                     MOVE SEPRF2    PR1                                                 CAS004
     C           SEFHLA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbFDL - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SEFVHL    AC4                                                 CAS004
     C                     MOVE SEPRF2    PR4                                                 CAS004
     C           SEFVHL    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbCDP - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'CDP'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SECFHP    AC1                                                 CAS004
     C                     MOVE SEPRF3    PR1                                                 CAS004
     C           SECFHP    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbCDP - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SEPOCI    AC4                                                 CAS004
     C                     MOVE SEPRF3    PR4                                                 CAS004
     C           SEPOCI    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbCDL - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'CDL'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SELOCI    AC1                                                 CAS004
     C                     MOVE SEPRF4    PR1                                                 CAS004
     C           SELOCI    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbCDL - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SECFHL    AC4                                                 CAS004
     C                     MOVE SEPRF4    PR4                                                 CAS004
     C           SECFHL    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbFXP - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'FXP'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SIFVHP    AC1                                                 CAS004
     C                     MOVE SIPRF1    PR1                                                 CAS004
     C           SIFVHP    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbFXP - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SIFTPA    AC4                                                 CAS004
     C                     MOVE SIPRF1    PR4                                                 CAS004
     C           SIFTPA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbFXL - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'FXL'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SIFTLA    AC1                                                 CAS004
     C                     MOVE SIPRF2    PR1                                                 CAS004
     C           SIFTLA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbFXL - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SIFVHL    AC4                                                 CAS004
     C                     MOVE SIPRF2    PR4                                                 CAS004
     C           SIFVHL    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbCXP - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'CXP'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SICFHP    AC1                                                 CAS004
     C                     MOVE SIPRF3    PR1                                                 CAS004
     C           SICFHP    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbCXP - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SICTPA    AC4                                                 CAS004
     C                     MOVE SIPRF3    PR4                                                 CAS004
     C           SICTPA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
      ** xxAyybbCXL - Debit                                                                   CAS004
      *                                                                                       CAS004
     C                     MOVE 'CXL'     DLKEY                                               CAS004
     C                     MOVE *BLANKS   FMKEYS                                              CAS004
     C                     MOVE SICTLA    AC1                                                 CAS004
     C                     MOVE SIPRF4    PR1                                                 CAS004
     C           SICTLA    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN1                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN1                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** xxAyybbCXL - Credit                                                                  CAS004
      *                                                                                       CAS004
     C                     MOVE SICFHL    AC4                                                 CAS004
     C                     MOVE SIPRF4    PR4                                                 CAS004
     C           SICFHL    IFNE *BLANKS                                                       CAS004
     C                     MOVE '01'      PN4                                                 CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE '  '      PN4                                                 CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Call subroutine that sets-up book code if necessary                                  CAS004
      *                                                                                       CAS004
     C                     EXSR SRBOOK                                                        CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      * SRGEN2 - Subroutine to Generata Account Keys for Enhancements *                       CAS005
      *          to CAS001, CAS002 and CAS004                         *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRGEN2    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** xxAyybbFTP - Debit                                                                   CAS005
      *                                                                                       CAS005
     C                     MOVE 'FTP'     DLKEY                                               CAS005
     C                     MOVE *BLANKS   FMKEYS                                              CAS005
     C                     MOVE SUFVHP    AC1                                                 CAS005
     C                     MOVE SUPRF1    PR1                                                 CAS005
     C           SUFVHP    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN1                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN1                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** xxAyybbFTP - Credit                                                                  CAS005
      *                                                                                       CAS005
     C                     MOVE SUFHPA    AC4                                                 CAS005
     C                     MOVE SUPRF1    PR4                                                 CAS005
     C           SUFHPA    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN4                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN4                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call subroutine that sets-up book code if necessary                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRBOOK                                                        CAS005
      *                                                                                       CAS005
      ** xxAyybbFTL - Debit                                                                   CAS005
      *                                                                                       CAS005
     C                     MOVE 'FTL'     DLKEY                                               CAS005
     C                     MOVE *BLANKS   FMKEYS                                              CAS005
     C                     MOVE SUFHLA    AC1                                                 CAS005
     C                     MOVE SUPRF2    PR1                                                 CAS005
     C           SUFHLA    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN1                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN1                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** xxAyybbFTL - Credit                                                                  CAS005
      *                                                                                       CAS005
     C                     MOVE SUFVHL    AC4                                                 CAS005
     C                     MOVE SUPRF2    PR4                                                 CAS005
     C           SUFVHL    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN4                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN4                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call subroutine that sets-up book code if necessary                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRBOOK                                                        CAS005
      *                                                                                       CAS005
      ** xxAyybbCTP - Debit                                                                   CAS005
      *                                                                                       CAS005
     C                     MOVE 'CTP'     DLKEY                                               CAS005
     C                     MOVE *BLANKS   FMKEYS                                              CAS005
     C                     MOVE SUCFHP    AC1                                                 CAS005
     C                     MOVE SUPRF3    PR1                                                 CAS005
     C           SUCFHP    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN1                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN1                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** xxAyybbCTP - Credit                                                                  CAS005
      *                                                                                       CAS005
     C                     MOVE SUPOCI    AC4                                                 CAS005
     C                     MOVE SUPRF3    PR4                                                 CAS005
     C           SUPOCI    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN4                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN4                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call subroutine that sets-up book code if necessary                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRBOOK                                                        CAS005
      *                                                                                       CAS005
      ** xxAyybbCTL - Debit                                                                   CAS005
      *                                                                                       CAS005
     C                     MOVE 'CTL'     DLKEY                                               CAS005
     C                     MOVE *BLANKS   FMKEYS                                              CAS005
     C                     MOVE SULOCI    AC1                                                 CAS005
     C                     MOVE SUPRF4    PR1                                                 CAS005
     C           SULOCI    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN1                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN1                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** xxAyybbCTL - Credit                                                                  CAS005
      *                                                                                       CAS005
     C                     MOVE SUCFHL    AC4                                                 CAS005
     C                     MOVE SUPRF4    PR4                                                 CAS005
     C           SUCFHL    IFNE *BLANKS                                                       CAS005
     C                     MOVE '01'      PN4                                                 CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE '  '      PN4                                                 CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Call subroutine that sets-up book code if necessary                                  CAS005
      *                                                                                       CAS005
     C                     EXSR SRBOOK                                                        CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRBOOK - Subroutine to Set Up Book Code in the Account Key if *                       CAS004
      *          Required                                             *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/SRGENH                                          *                       CAS004
      *                                                               *                       CAS004
      * Calls: SR/ACUP                                                *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRBOOK    BEGSR                                                              CAS004
      *                                                                                       CAS004
     C           BNBCPL    IFEQ 'Y'                                                           CAS004
      *                                                                                       CAS004
     C           *LOVAL    SETLLSDBOOKL1                                                      CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
      *                                                                                       CAS004
     C           *IN99     DOWNE*ON                                                           CAS004
     C           BDHGIN    IFEQ 'Y'                                                           CAS004
     C                     MOVELBDBKCD    CYD                                                 CAS004
     C                     EXSR ACUP                                                          CAS004
     C                     ENDIF                                                              CAS004
     C                     READ SDBOOKL1                 99                                   CAS004
     C                     ENDDO                                                              CAS004
      *                                                                                       CAS004
     C                     ELSE                                                               CAS004
      *                                                                                       CAS004
     C                     EXSR ACUP                                                          CAS004
      *                                                                                       CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
      *****************************************************************                       CAS004
      /EJECT                                                                                  CAS004
      *****************************************************************                       CAS004
      *                                                               *                       CAS004
      * SRACOD - Subroutine to access SDACODPD via access object      *                       CAS004
      *                                                               *                       CAS004
      * Called by: SR/SRVLH1, SR/SRVLH2                               *                       CAS004
      *                                                               *                       CAS004
      * Calls: PGM/AOACODR0                                           *                       CAS004
      *                                                               *                       CAS004
      *****************************************************************                       CAS004
     C           SRACOD    BEGSR                                                              CAS004
      *                                                                                       CAS004
      ** Get Account codes details via access object                                          CAS004
      *                                                                                       CAS004
     C                     CALL 'AOACODR0'                                                    CAS004
     C                     PARM *BLANKS   PRTCD                                               CAS004
     C                     PARM '*KEY  '  POPTN                                               CAS004
     C**********           PARM           PIACOD  4                                    CAS004 CGL029
     C********** SDACOD    PARM           DSFDY                                        CAS004 CGL029
     C                     PARM           PIACOD 10                                           CGL029
     C           SDACOD    PARM           DSSDY                                               CGL029
      *                                                                                       CAS004
     C           PRTCD     IFNE *BLANKS                                                       CAS004
     C           PRTCD     OREQ *BLANKS                                                       CAS004
     C           A5TOIN    ANDEQ'Y'                                                           CAS004
     C           WSRVL1    IFEQ 'Y'                                                           CAS004
     C                     MOVE 'N'       WVALH1                                              CAS004
     C                     ENDIF                                                              CAS004
     C           WSRVL2    IFEQ 'Y'                                                           CAS004
     C                     MOVE 'N'       WVALH2                                              CAS004
     C                     ENDIF                                                              CAS004
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C           WSRVL3    ANDEQ'Y'                                                           CAS005
     C                     MOVE 'N'       WVALH3                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     MOVE 'Y'       WINVAC                                              CAS004
     C                     MOVEL'USR4230' ZAMSID                                              CAS004
     C                     EXSR ZASNMS                                                        CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C                     ENDSR                                                              CAS004
     C********************************************************************                    CAS004
      /EJECT
     C********************************************************************
     C**
     C** ACUP - Update ZACKEYAL
     C**
     C** Called By - FRP - Validate FR screen/ Generate FR keys
     C**
     C** Calls - None
     C**
     C********************************************************************
     C           ACUP      BEGSR
     C**
     C** Move values to file fields
     C**
     C                     MOVE 'D'       RECI
     C*********************MOVE DLKEY     AKEY             Move to file fld                   CDL038
     C                     MOVELDLKEY     AKEY             Move to file fld                   CDL038
     C                     MOVE CLAS      AKEY             Move to file fld                   CDL038
     C                     MOVE AC1       ACD1             Move to file fld
     C                     MOVE AC2       ACD2             Move to file fld
     C                     MOVE AC3       ACD3             Move to file fld
     C                     MOVE AC4       ACD4             Move to file fld
     C                     MOVE AC5       ACD5             Move to file fld
     C                     MOVE AC6       ACD6             Move to file fld
     C                     MOVE PN1       NCD1             Move to file fld
     C                     MOVE PN2       NCD2             Move to file fld
     C                     MOVE PN3       NCD3             Move to file fld
     C                     MOVE PN4       NCD4             Move to file fld
     C                     MOVE PN5       NCD5             Move to file fld
     C                     MOVE PN6       NCD6             Move to file fld
     C                     MOVE PR1       PRF1             Move to file fld
     C                     MOVE PR2       PRF2             Move to file fld
     C                     MOVE PR3       PRF3             Move to file fld
     C                     MOVE PR4       PRF4             Move to file fld
     C                     MOVE PR5       PRF5             Move to file fld
     C                     MOVE PR6       PRF6             Move to file fld
     C**
     C** Write new Account Key and accounting entries to work file
     C**
     C                     MOVE 'I'       CHTP                                                CDL038
     C                     Z-ADDBJRDNB    LCD                                                 CDL038
     C                     WRITEZACKEYAF
     C*
     C                     ENDSR
      /EJECT                                                              CIR003
      ********************************************************************CIR003
      **                                                                  CIR003
      ** SRCCYU - Format Base Currency Equivalent Account Keys            CIR003
      **                                                                  CIR003
      ** Called By:                                                       CIR003
      ** FRP  - Validate FR screen/ Generate FR keys                      CIR003
      **                                                                  CIR003
      ** Calls:                                                           CIR003
      ** ACUP - Update ZACKEYAL                                           CIR003
      **                                                                  CIR003
      ********************************************************************CIR003
     C           SRCCYU    BEGSR                                          CIR003
      *                                                                   CIR003
     C                     Z-ADD1         X                               CIR003
     C                     MOVE *BLANKS   FMKEYS                          CIR003
      *                                                                   CIR003
     C           X         DOWLE200                                       CIR003
     C           CCYA,X    ANDNE*BLANKS                                   CIR003
     C                     MOVE CCYA,X    CYD                             CIR003
     C                     MOVE 'O'       FBD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     MOVE 'T'       FBD                             CIR003
     C                     EXSR ACUP                                      CIR003
     C                     ADD  1         X                               CIR003
     C                     ENDDO                                          CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   CYD                             CIR003
      *                                                                   CIR003
     C                     ENDSR                                          CIR003
      *                                                                   CIR003
     C********************************************************************
      /EJECT
     C********************************************************************
     C*
     C* INIT - Initialise program
     C*
     C* Calls - DBERR - Database error processing
     C*       - AOBANKR0 - SDBANKPD Access Program (external)
     C*
     C********************************************************************
     C           INIT      BEGSR
     C*
     C** Define Local Data Area
     C*
     C           *NAMVAR   DEFN           LDA
     C*
     C** Define Rundat Data Area
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C*                                                                   CIR001
     C** Fields defined as F12 indicator to be used in validating         CIR001
     C** detail screens 2 and 3                                           CIR001
     C*                                                                   CIR001
     C           *LIKE     DEFN *IN12     WS2F12                          CIR001
     C           *LIKE     DEFN *IN12     WS3F12                          CIR001
     C*                                                                   CIR001
     C** Valid2 and Valid3 are validity fields for detail screens         CIR001
     C** 2 and 3. 'Y' = screen valid, 'N' = screen invalid.               CIR001
     C*                                                                   CIR001
     C                     MOVE 'Y'       VALID2  1                       CIR001
     C                     MOVE 'Y'       VALID3  1                       CIR001
      *                                                                                       CAS004
      ** Validity fields for hedge accounting screens                                         CAS004
      *                                                                                       CAS004
     C                     MOVE 'Y'       WVALH1  1                                           CAS004
     C                     MOVE 'Y'       WVALH2  1                                           CAS004
     C*
     C** Clear all fields to send messages to message queue.
     C*
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C                     MOVE *BLANKS   SPGMQ            Program queue
     C                     MOVEL'AK0030  'SPGMQ            Program queue
     C**
     C** Setup LDA field DBPGM
     C**
     C           *LOCK     IN   LDA                                       S01315
     C                     MOVEL'AK0030  'DBPGM
     C                     OUT  LDA                                       S01315
     C*                                                                   CIR001
     C** Check if switchable feature CIR001 is switched on                CIR001
     C*                                                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD                           CIR001
     C                     PARM '*VERIFY' @OPTN                           CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C                     PARM           DSFDY                           CIR001
     C*                                                                   CIR001
     C           @RTCD     IFNE *BLANK                                    CIR001
     C           @RTCD     ANDNE'*NRF   '                                 CIR001
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR001
     C                     MOVEL'002'     DBASE            **DBERROR 002 *CIR001
     C                     MOVEL'CIR001'  DBKEY            ***************CIR001
     C                     EXSR DBERR                                     CIR001
     C                     END                                            CIR001
     C*                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     ELSE                                           CIR001
     C                     MOVE 'N'       CIR001                          CIR001
     C                     END                                            CIR001
      *                                                                   CIR003
      ** Check if switchable feature CIR003 is switched on                CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY' @OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD   6                       CIR003
     C                     PARM           DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANK                                    CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR003
     C                     MOVEL'003'     DBASE            * DB ERROR 03 *CIR003
     C                     MOVEL'CIR003'  DBKEY            ***************CIR003
     C                     EXSR DBERR                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR006
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD   6                       CIR006
     C                     PARM           DSFDY                           CIR006
      *                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR006
     C                     MOVEL'004'     DBASE            * DB ERROR 04 *CIR006
     C                     MOVEL'CIR006'  DBKEY            ***************CIR006
     C                     EXSR DBERR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
      ** Check if Hedge Accounting feature is switched ON                                     CAS004
      *                                                                                       CAS004
     C                     CALL 'AOSARDR0'                                                    CAS004
     C                     PARM *BLANKS   PRTCD   7                                           CAS004
     C                     PARM '*VERIFY' POPTN   7                                           CAS004
     C                     PARM 'CAS004'  PSARD   6                                           CAS004
     C                     PARM           DSFDY                                               CAS004
      *                                                                                       CAS004
     C           PRTCD     IFNE *BLANK                                                        CAS004
     C           PRTCD     ANDNE'*NRF   '                                                     CAS004
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS004
     C                     MOVEL'005'     DBASE                                               CAS004
     C                     MOVEL'CAS004'  DBKEY                                               CAS004
     C                     EXSR DBERR                                                         CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
     C           PRTCD     IFEQ *BLANKS                                                       CAS004
     C                     MOVE 'Y'       CAS004  1                                           CAS004
     C                     ELSE                                                               CAS004
     C                     MOVE 'N'       CAS004                                              CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Use access program to retrieve SDDEALPD Details                                      CAS004
      *                                                                                       CAS004
     C**********           CALL 'AODEALR0'                                             CAS004 CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' PRTCD                                               CAS004
     C                     PARM '*FIRST ' POPTN                                               CAS004
     C********** SDDEAL    PARM SDDEAL    DSFDY                                        CAS004 CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
      *                                                                                       CAS004
      ** If error in access program, exit via DBERR subroutine                                CAS004
      *                                                                                       CAS004
     C           PRTCD     IFNE *BLANKS                                                       CAS004
     C           *LOCK     IN   LDA                                                           CAS004
     C                     MOVEL'SDDEALPD'DBFILE                                              CAS004
     C                     MOVEL'006'     DBASE                                               CAS004
     C                     MOVELPOPTN     DBKEY                                               CAS004
     C                     EXSR DBERR                                                         CAS004
     C                     ENDIF                                                              CAS004
      *                                                                                       CAS004
      ** Check if Enhancement CAS005 is installed                                             CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*VERIFY' POPTN                                               CAS005
     C                     PARM 'CAS005'  PSARD                                               CAS005
     C                     PARM           DSFDY                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFNE *BLANK                                                        CAS005
     C           PRTCD     ANDNE'*NRF   '                                                     CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVEL'007'     DBASE                                               CAS005
     C                     MOVEL'CAS005'  DBKEY                                               CAS005
     C                     EXSR DBERR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005  1                                           CAS005
     C                     MOVE 'Y'       WVALH3  1                                           CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE 'N'       CAS005                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Check if Enhancement CAS007 is installed                                             CAS007
      *                                                                                       CAS007
     C                     CALL 'AOSARDR0'                                                    CAS007
     C                     PARM *BLANKS   PRTCD                                               CAS007
     C                     PARM '*VERIFY' POPTN                                               CAS007
     C                     PARM 'CAS007'  PSARD                                               CAS007
     C                     PARM           DSFDY                                               CAS007
      *                                                                                       CAS007
     C           PRTCD     IFNE *BLANK                                                        CAS007
     C           PRTCD     ANDNE'*NRF   '                                                     CAS007
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS007
     C                     MOVEL'008'     DBASE                                               CAS007
     C                     MOVEL'CAS007'  DBKEY                                               CAS007
     C                     EXSR DBERR                                                         CAS007
     C                     ENDIF                                                              CAS007
      *                                                                                       CAS007
     C           PRTCD     IFEQ *BLANKS                                                       CAS007
     C                     MOVE 'Y'       CAS007  1                                           CAS007
     C                     ELSE                                                               CAS007
     C                     MOVE 'N'       CAS007                                              CAS007
     C                     MOVE 'N'       WVALH3                                              CAS007
     C                     ENDIF                                                              CAS007
      *                                                                                       CAS007
      *                                                                                       CDL038
      ** Access Switchable Feature Details, check if CDL038 is installed                      CDL038
      ** (Extended Deal Sub Types)                                                            CDL038
      *                                                                                       CDL038
     C                     CALL 'AOSARDR0'                                                    CDL038
     C                     PARM *BLANKS   PRTCD                                               CDL038
     C                     PARM '*VERIFY 'POPTN                                               CDL038
     C                     PARM 'CDL038'  PSARD                                               CDL038
     C                     PARM           DSFDY                                               CDL038
      *                                                                                       CDL038
     C           PRTCD     IFEQ *BLANKS                                                       CDL038
     C                     MOVE 'Y'       CDL038  1                                           CDL038
     C                     MOVE *ON       *IN27                                               CDL038
     C                     ELSE                                                               CDL038
     C                     MOVE 'N'       CDL038                                              CDL038
     C                     MOVE *OFF      *IN27                                               CDL038
     C                     ENDIF                                                              CDL038
      *                                                                                       245915
      ** Check if CDL039 is enabled.                                                          245915
      *                                                                                       245915
     C                     CALL 'AOSARDR0'                                                    245915
     C                     PARM *BLANKS   PRTCD                                               245915
     C                     PARM '*VERIFY' POPTN                                               245915
     C                     PARM 'CDL039'  PSARD                                               245915
     C                     PARM           DSFDY                                               245915
      *                                                                                       245915
     C                     MOVE 'N'       CDL039  1                                           245915
      *                                                                                       245915
     C           PRTCD     IFEQ *BLANKS                                                       245915
     C                     MOVE 'Y'       CDL039                                              245915
     C                     ELSE                                                               245915
      *                                                                                       245915
     C           PRTCD     IFNE '*NRF   '                                                     245915
     C           *LOCK     IN   LDA                                                           245915
     C                     MOVEL'SCSARDPD'DBFILE                                              245915
     C                     MOVEL'CDL039'  DBKEY                                               245915
     C                     Z-ADD112       DBASE                                               245915
     C                     OUT  LDA                                                           245915
     C                     EXSR DBERR                                                         245915
     C                     ENDIF                                                              245915
      *                                                                                       245915
     C                     ENDIF                                                              245915
     C/COPY WNCPYSRC,AK0030C016
     C*
     C** Use access program AOBANKR0 to retrieve SDBANKPD Details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** If error in access program, exit via DBERR subroutine
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     Z-ADD001       DBASE            **DBERROR 001 *
     C                     EXSR DBERR                      ***************
     C                     END
     C**
     C** Check that all required Narrative Codes are present
     C** on SDNARRPD
     C**
     C                     Z-ADD0         N       10
     C*
     C***********N         DOWLT8                                         085263
     C           N         DOWLT7                                         085263
     C           N         ADD  1         N
     C           NR,N      CHAINSDNARRL1             11
     C           *IN11     IFEQ '1'
     C                     MOVE NR,N      PN,N
     C                     END
     C*
     C                     END
     C*
     C                     MOVEAPN        PNTEST 16
     C*
     C           PNTEST    IFNE *BLANKS
     C                     SETON                       11
     C                     END
     C*
     C                     SETOF                     030710
     C                     SETOF                     1225
     C                     SETOF                     2631
     C                     SETOF                     323334
     C                     SETOF                     394150
     C                     SETOF                     515254
     C                     SETOF                     555657
     C                     SETOF                     585960
     C                     SETOF                     616263
     C                     SETOF                     6478
     C/COPY WNCPYSRC,AK0030C010
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C*
     C*  ZASNMS - Send message to program message queue
     C*
     C*  Calls - Y2SNMGC - Send message to queue (external)
     C*
     C********************************************************************
     C           ZASNMS    BEGSR
     C**
     C** Declare message file name
     C**
     C                     MOVEL'SDUSRMSG'ZAMSGF
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM SPGMQ     ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
     C*
     C                     ENDSR
     C*****************************************************************
      /EJECT
     C********************************************************************
     C*
     C* DBERR - Database error processing
     C*
     C* Called by - INIT - Initialise program
     C*
     C* Calls     : None
     C*
     C********************************************************************
     C           DBERR     BEGSR
     C*
     C                     SETON                     U7U8LR
     C*
     C                     DUMP
     C                     OUT  LDA
     C                     RETRN
     C*
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C/COPY WNCPYSRC,AK0030C011
** FRAT - FRA/IRA Types
FRRSRXRPRRRFRPRRRF
** NR - Required Narrative Codes
01022324252627
**  CPY@
(c) Finastra International Limited 2001
