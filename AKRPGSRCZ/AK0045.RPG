     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas AK Account keys generation (facility)')          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Customer Lending Module                          *
     F*                                                               *
     F*  AK0045 - Lending Account Keys Generation (Facility)          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. CLE138             Date 02Nov21               *
      *  Prev Amend No. CER050             Date 16Jun19               *
      *                 MD051883           Date 04Apr19               *
      *                 MD051695           Date 08Aug18               *
      *                 MD046248           Date 27Oct17               *
      *                 AR1071025          Date 16Jan13               *
      *                 CLE134             Date 01Aug12               *
      *                 AR787620           Date 10Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 210725             Date 26May06               *
      *                 CDL038             Date 10May05               *
      *                 BUG1605            Date 19Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE031             Date 03Feb03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 192643             Date 26Apr01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 146525             Date 19Nov98               *
      *                 CSD005             Date 01Mar99               *
      *                 131108             Date 06Oct98               *
     F*                 116017             Date 29May98               *
     F*                 119429             DATE 17Feb98               *
     F*                 CLE004             DATE 17MAR97               *
     F*                 072797  *CREATE    DATE 15FEB95               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CLE138 - Class Codes for Facilities                          *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  MD051883 - CLE031: Changes to Value Date Account Keys        *
      *  MD051695 - CLE031 Regression and Settlement Change           *
      *  MD046248 - Finastra Rebranding                               *
      *  AR1071025 - Erroneous field will only highlight after the    *
      *              second enter (Recompile)                         *
      *  CLE134 - Past Due Call Loan Processing                       *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,AKH00005                                 *
      *             WNCPYSRC,AKH00006                                 *
      *             WNCPYSRC,AKH00007                                 *
      *             WNCPYSRC,AKH00008                                 *
      *             WNCPYSRC,AKH00009                                 *
      *             WNCPYSRC,AKH00010                                 *
      *             WNCPYSRC,AKH00011                                 *
      *             WNCPYSRC,AKH00012                                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  210725 - Income Account should have posting reference 1      *
      *           even for facility fee accrual account keys for      *
      *           participants.                                       *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BUG1605 - When calling AOCURRR0, change DSFDY to DSSDY.      *
      *            Allow the Spot Trade Account Equivalent (A6SPAE)   *
      *            field to be blank for base currency.               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE031 - Lending Enhancements.                               *
     F*  192643 - CORRECT CLE004 ACCRUAL FIX AS WRONG NEED INCOME KEY *
     F*         - ALSO CREATE SYNDICATED KEYS.                        *
     F*  146525 - Various Fixes for Lending Enhancements              *
     F*  CSD005 - Standing Data Account Narrative.  Add new field     *
     F*           to SDACODPD.  Recompilation of programs.            *
     F*  131108 - Amortisation key ('S' in 6th character of key) is   *
     F*           incorrectly outputting accounting data when         *
     F*           amortisation account code is blank.                 *
     F*  116017 - Only check for the existance of narrative codes     *
     F*           which are required - remove '02' and '28' from      *
     F*           array (as 078809 in AK0040)                         *
     F*  119429 - Remove Narrative code 28 from array(Not required)   *
     F*  CLE004 - Customer Lending Enhancements - Syndications        *
     F*  072797 - Customer Lending Account keys generation for        *
     F*           Facility Type.                                      *
     F*                                                               *
     F*****************************************************************
     FAK0045DFCF  E                    WORKSTN
     FZACKEYALO   E                    DISK                      A
     FSDACODL0IF  E           K        DISK
     FSDFACTL1IF  E           K        DISK
     FSDNARRL1IF  E           K        DISK
     FSDFEEL1 IF  E           K        DISK
     FSDFACTL2IF  E           K        DISK                                                   CLE138
     F/COPY WNCPYSRC,AKH00005
     F*****************************************************************
     F* ID F  C  H  L   Function of Indicators
     F*
     F* 03  Exit requested
     F* 07  Keys generated successfully
     F* 11  Chain to SDNARRL1 for Required Narrative failed
     F* 12  Previous screen requested
     F* 30  CLE138 is enabled                                                                 CLE138
     F* 40  Second screen in error
     F* 41  First screen in error
     F* 50  Invalid Facility Type    - reverse image on screen
     F* 51  Invalid field UHFCLS- Facility Class Code                                         CLE138
     F* 52  Invalid field UHFC1 - Fee Code 1
     F* 53  Invalid field UHFIA1- Fee Income Account 1
     F* 54  Invalid field UHFAM1- Fee Amortisation Code 1
     F* 55  Invalid field UHFAC1- Fee Accrual Codes 1
     F* 56  Invalid field UHFPR1- Posting Reference 1
     F* 57  Invalid field UHFC2 - Fee Code 2
     F* 58  Invalid field UHFIA2- Fee Income Account 2
     F* 59  Invalid field UHFAM2- Fee Amortisation Code 2
     F* 60  Invalid field UHFAC2- Fee Accrual Codes 2
     F* 61  Invalid field UHFPR2- Posting Reference 2
     F* 62  Invalid field UHFC3 - Fee Code 3
     F* 63  Invalid field UHFIA3- Fee Income Account 3
     F* 64  Invalid field UHFAM3- Fee Amortisation Code 3
     F* 65  Invalid field UHFAC3- Fee Accrual Codes 3
     F* 66  Invalid field UHFPR3- Posting Reference 3
     F* 67  Invalid field UHFC4 - Fee Code 4
     F* 68  Invalid field UHFIA4- Fee Income Account 4
     F* 69  Invalid field UHFAM4- Fee Amortisation Code 4
     F* 70  Invalid field UHFAC4- Fee Accrual Codes 4
     F* 71  Invalid field UHFPR4- Posting Reference 4
     F* 72  Invalid field UHFC5 - Fee Code 5
     F* 73  Invalid field UHFIA5- Fee Income Account 5
     F* 74  Invalid field UHFAM5- Fee Amortisation Code 5
     F* 75  Invalid field UHFAC5- Fee Accrual Codes 5
     F* 76  Invalid field UHFPR5- Posting Reference 5
     F* 80  Access to SDFACTL2 File                                                           CLE138
     F* U7  Database error - terminate program.
     F* U8  Database error - terminate program.
     F******************************************************************
     E***********         HKP         8  2               MISSING NARRS.   119429
     E***********         HKP         7  2        MISSING NARRS.   119429 116017
     E***********         HKN     8   8  2               REQ. NARRATIVES  119429
     E                    HKP         6  2               MISSING NARRS.   116017
     E***********         HKN     7   7  2        REQ. NARRATIVES  119429 116017
     E                    HKN     6   6  2               REQ. NARRATIVES  116017
     E                    CPY@    1   1 80               Copyright Array
      *                                                                                       CLE031
      ** Currency array                                                                       CLE031
     E                    ACY       200  3                                                    CLE031
      *                                                                                       CLE031
      ** Spot trade account code array                                                        CLE031
     E**********          ASP       200  4                                             CLE031 CGL029
     E                    ASP       200 10                                                    CGL029
     E******************************************************************
     I** Data structures
     I*
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I** Data Structure for Compilation  - Copyright Insertion
     I*
     IPSDS       SDS
     I                                      244 253 WSID
     I                                      254 263 USRID
     I** Data Structure to retrieve User and Workstation ID.
     I*
     IRUNDAT      DS                             13
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 @MBIN
     I** Rundate Data Area
     I*
     IFCLTYR      DS
     I/COPY WNCPYSRC,AKH00006
     I**********                              1  10 UHFKEY                                    CLE138
     I                                        1  14 UHFKEY                                    CLE138
     I                                        1   3 UHFTYP
     I                                        4   4 UHEVNT
     I                                        5   7 UHCCY                                     CLE031
     I                                        6   6 UHACMI
     I                                        7   7 UHPIND                CLE004
     I                                        8   9 UHFEEC
     I                                       10  10 UHAMTL
     I**********                             11  52 UHDETL                                    CGL029
     I**********                             11  14 UHAC1                                     CGL029
     I**********                             15  18 UHAC2                                     CGL029
     I**********                             19  22 UHAC3                                     CGL029
     I**********                             23  26 UHAC4                                     CGL029
     I**********                             27  30 UHAC5                                     CGL029
     I**********                             31  34 UHAC6                                     CGL029
     I**********                             35  36 UHNC1                                     CGL029
     I**********                             37  38 UHNC2                                     CGL029
     I**********                             39  40 UHNC3                                     CGL029
     I**********                             41  42 UHNC4                                     CGL029
     I**********                             43  44 UHNC5                                     CGL029
     I**********                             45  46 UHNC6                                     CGL029
     I**********                             47  47 UHPR1                                     CGL029
     I**********                             48  48 UHPR2                                     CGL029
     I**********                             49  49 UHPR3                                     CGL029
     I**********                             50  50 UHPR4                                     CGL029
     I**********                             51  51 UHPR5                                     CGL029
     I**********                             52  52 UHPR6                                     CGL029       
     I**********                             11  88 UHDETL                             CGL029 CLE138
     I**********                             11  20 UHAC1                              CGL029 CLE138
     I**********                             21  30 UHAC2                              CGL029 CLE138
     I**********                             31  40 UHAC3                              CGL029 CLE138
     I**********                             41  50 UHAC4                              CGL029 CLE138
     I**********                             51  60 UHAC5                              CGL029 CLE138
     I**********                             61  70 UHAC6                              CGL029 CLE138
     I**********                             71  72 UHNC1                              CGL029 CLE138
     I**********                             73  74 UHNC2                              CGL029 CLE138
     I**********                             75  76 UHNC3                              CGL029 CLE138
     I**********                             77  78 UHNC4                              CGL029 CLE138
     I**********                             79  80 UHNC5                              CGL029 CLE138
     I**********                             81  82 UHNC6                              CGL029 CLE138
     I**********                             83  83 UHPR1                              CGL029 CLE138
     I**********                             84  84 UHPR2                              CGL029 CLE138
     I**********                             85  85 UHPR3                              CGL029 CLE138
     I**********                             86  86 UHPR4                              CGL029 CLE138
     I**********                             87  87 UHPR5                              CGL029 CLE138
     I**********                             88  88 UHPR6                              CGL029 CLE138
     I                                       11  14 UHCLAS                                    CLE138
     I                                       15  92 UHDETL                                    CLE138
     I                                       15  24 UHAC1                                     CLE138
     I                                       25  34 UHAC2                                     CLE138
     I                                       35  44 UHAC3                                     CLE138
     I                                       45  54 UHAC4                                     CLE138
     I                                       55  64 UHAC5                                     CLE138
     I                                       65  74 UHAC6                                     CLE138
     I                                       75  76 UHNC1                                     CLE138
     I                                       77  78 UHNC2                                     CLE138
     I                                       79  80 UHNC3                                     CLE138
     I                                       81  82 UHNC4                                     CLE138
     I                                       83  84 UHNC5                                     CLE138
     I                                       85  86 UHNC6                                     CLE138
     I                                       87  87 UHPR1                                     CLE138
     I                                       88  88 UHPR2                                     CLE138
     I                                       89  89 UHPR3                                     CLE138
     I                                       90  90 UHPR4                                     CLE138
     I                                       91  91 UHPR5                                     CLE138
     I                                       92  92 UHPR6                                     CLE138
     I/COPY WNCPYSRC,AKH00007
     ISDBANK    E DSSDBANKPD
     I** Bank Details
     I*
     ISDGELR    E DSSDGELRPD
     I** General Ledger Details
     I*
     IDSFDY     E DSDSFDY
     I** First DS for Access Programs, Short Data Structure
     I*
     IDSSDY     E DSDSSDY                                                                     CLE031
      ** Second DS for Access Programs, Long Data Structure                                   CLE031
      *                                                                                       CLE031
     ISCSARD    E DSSCSARDPD                                                                  CLE031
      ** Sar Details                                                                          CLE031
      *                                                                                       CLE031
     ISDCURR    E DSSDCURRPD                                                                  CLE031
      ** Currency Details                                                                     CLE031
      *                                                                                       CLE031
     ISDACOD    E DSSDACODPD                                                                  CLE031
     I              QQACCD                          QQACD1                                    CGL029
      ** Trading Details                                                                      CLE031
      *                                                                                       CLE031
     ISDTRAD    E DSSDTRADPD                                                                  CLE031
     I              QQACCD                          QQACD2                                    CGL029
      ** Trading Details                                                                      CLE031
      *                                                                                       CLE031
     ILDA        UDS                            256
     I                                        1 256 DBLOT
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     C*****************************************************************
     C* Index to Subroutines
     C*
     C* #HINIT   -  Initial set up.
     C* #HFRST   -  First screen validation.
     C* #HSECD   -  Second screen displayed.
     C* #HACUP   -  Insert records on ZACKEYAL.
     C* #HLEIP   -  Customer Lending input validation.
     C* #HKEYS   -  Generate Account Keys.
     C* ZASNMS   -  Send message to program message queue.
     C* #HDBER   -  Database error processing.
     C*
     C*****************************************************************
     C*
     C** Main processing.
     C*
     C                     EXSR #HINIT
     C*
     C** Display initial screen.
     C*
     C           *IN03     DOWEQ'0'
     C           *IN07     ANDEQ'0'
     C                     EXSR #HFRST
     C*
     C** Display second screen, providing that initial screen is valid.
     C*
     C           *IN41     IFEQ '0'
     C           *IN03     ANDEQ'0'
     C                     EXSR #HSECD
     C                     END
     C*
     C                     END
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #HFRST :       First screen validation.                      *
     C*                                                               *
     C*  CALLED BY :   Main processing.                               *
     C*                                                               *
     C*  CALLS :       Y2CLMSC - Clear message queue                  *
     C*                ZASNMS  - Sends message to program msg queue   *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HFRST    BEGSR
     C*
     C** Initial screen validation - Type and Sub Type.
     C*
     C                     WRITE#MSGCTL
     C                     EXFMTACKEYSF
     C*
     C** Clear messages from program message queue.
     C*
     C                     CALL 'Y2CLMSC'
     C                     PARM SPGMQ     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C*
     C                     SETOF                     4150
     C                     MOVE *OFF      *IN51                                               CLE138
     C/COPY WNCPYSRC,AKH00008
     C*
     C** Exit program if F3 is pressed.
     C*
     C           *IN03     IFEQ '0'
     C**
     C** Send message if required narratives not all found on SDNARRL1
     C**
     C           *IN11     IFEQ '1'
     C                     MOVEL'USR1776' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     SETON                     41    Initial scr error
     C                     ELSE
     C*
     C** Send message if Facility Type is blank
     C*
     C           UHTYPE    IFEQ *BLANKS
     C                     SETON                     5041
     C                     MOVEL'USR2652' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C** Send message if Facility Type not found on Facility Type file
     C*
     C           UHTYPE    CHAINSDFACTL1             50
     C           *IN50     IFEQ '1'
     C                     SETON                     41
     C                     MOVEL'USR2653' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C                     MOVE UHTYPE    UHTYPO
      *                                                                                       CLE138
     C           CLE138    IFEQ 'Y'                                                           CLE138
      *                                                                                       CLE138
     C           UHFCLS    IFEQ *BLANKS                                                       CLE138
     C                     SETON                     5141                                     CLE138
     C                     MOVEL'CLE1384' ZAMSID           Message id.                        CLE138
     C                     EXSR ZASNMS                     Send message                       CLE138
      *                                                                                       CLE138
     C                     ELSE                                                               CLE138
     C           KFCLS     CHAINSDFACTL2             80                                       CLE138
     C           *IN80     IFEQ *ON                                                           CLE138
     C                     SETON                     5141                                     CLE138
     C                     MOVEL'CLE1385' ZAMSID           Message id.                        CLE138
     C                     EXSR ZASNMS                     Send message                       CLE138
     C                     ELSE                                                               CLE138
     C                     MOVE UHFCLS    UHFCLO                                              CLE138
     C                     ENDIF                                                              CLE138
     C                     ENDIF                                                              CLE138
      *                                                                                       CLE138
     C                     ENDIF                                                              CLE138
     C/COPY WNCPYSRC,AKH00009
     C                     END
     C                     END
     C*
     C                     END
      *                                                                                       CLE031
      ** If CLE031 is installed, set up currency array                                        CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C           *IN41     ANDEQ*OFF                                                          CLE031
      *                                                                                       CLE031
      ** Initialise counter to 0                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD0         WC                                                  CLE031
      *                                                                                       CLE031
      ** Get the first currency via access object                                             CLE031
      *                                                                                       CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM '*FIRST ' POPTN                                               CLE031
     C                     PARM *BLANK    PCURR   3                                           CLE031
     C********** SDCURR    PARM SDCURR    DSFDY                                       CLE031 BUG1605
     C           SDCURR    PARM SDCURR    DSSDY                                              BUG1605
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE031
     C                     MOVELPOPTN     DBKEY                                               CLE031
     C                     Z-ADD6         DBASE                                               CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR #HDBER                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Save currency and spot trade account equiv to array                                  CLE031
      *                                                                                       CLE031
     C           PRTCD     DOWNE'*EOF   '                                                     CLE031
     C           WC        ANDLE200                                                           CLE031
      *                                                                                       CLE031
      ** Dealing currency                                                                     CLE031
      *                                                                                       CLE031
     C           A6DLCI    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** Validate spot trade a/c equivalent                                                   CLE031
      *                                                                                       CLE031
     C                     CALL 'AOACODR0'                                                    CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM '*KEY   ' POPTN                                               CLE031
     C**********           PARM A6SPAE    PACOD   4                                    CLE031 CGL029
     C                     PARM A6SPAE    PACOD  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C           BJCYCD    ANDNEA6CYCD                                                       BUG1605
     C           A5TOIN    OREQ 'Y'                                                           CLE031
     C           BJCYCD    ANDNEA6CYCD                                                       BUG1605
     C                     MOVE *ON       *IN41                                               CLE031
     C                     MOVEL'USR9740' ZAMSID                                              CLE031
     C                     EXSR ZASNMS                                                        CLE031
     C                     ELSE                                                               CLE031
     C                     ADD  1         WC                                                  CLE031
     C                     MOVE A6CYCD    ACY,WC                                              CLE031
     C                     MOVE A6SPAE    ASP,WC                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Get next currency via access object                                                  CLE031
      *                                                                                       CLE031
     C                     CALL 'AOCURRR0'                                                    CLE031
     C                     PARM *BLANK    PRTCD                                               CLE031
     C                     PARM '*NEXT  ' POPTN                                               CLE031
     C                     PARM *BLANK    PCURR   3                                           CLE031
     C********** SDCURR    PARM SDCURR    DSFDY                                       CLE031 BUG1605
     C           SDCURR    PARM SDCURR    DSSDY                                              BUG1605
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANK                                                        CLE031
     C           PRTCD     ANDNE'*EOF   '                                                     CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDCURRPD'DBFILE                                              CLE031
     C                     MOVELPOPTN     DBKEY                                               CLE031
     C                     Z-ADD7         DBASE                                               CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR #HDBER                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDDO                                                              CLE031
     C                     ENDIF                                                              CLE031
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C*                                                               *
     C*  #HSECD:       Second screen validation.                      *
     C*                                                               *
     C*  CALLED BY :   Main processing                                *
     C*                                                               *
     C*  CALLS :       Y2CLMSC - Clear program message queue          *
     C*                #HLEIP - Validate second screen.               *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HSECD    BEGSR
     C*
     C** Second screen processing. Initialise screen fields and file
     C** control fields.
     C*
     C                     MOVE *BLANKS   UHFC1
     C                     MOVE *BLANKS   UHFC2
     C                     MOVE *BLANKS   UHFC3
     C                     MOVE *BLANKS   UHFC4
     C                     MOVE *BLANKS   UHFC5
     C*
     C                     MOVE *BLANKS   UHFIA1
     C                     MOVE *BLANKS   UHFIA2
     C                     MOVE *BLANKS   UHFIA3
     C                     MOVE *BLANKS   UHFIA4
     C                     MOVE *BLANKS   UHFIA5
     C*
     C                     MOVE *BLANKS   UHFAM1
     C                     MOVE *BLANKS   UHFAM2
     C                     MOVE *BLANKS   UHFAM3
     C                     MOVE *BLANKS   UHFAM4
     C                     MOVE *BLANKS   UHFAM5
     C*
     C                     MOVE *BLANKS   UHFAC1
     C                     MOVE *BLANKS   UHFAC2
     C                     MOVE *BLANKS   UHFAC3
     C                     MOVE *BLANKS   UHFAC4
     C                     MOVE *BLANKS   UHFAC5
     C*
     C                     MOVE *BLANKS   UHFPR1
     C                     MOVE *BLANKS   UHFPR2
     C                     MOVE *BLANKS   UHFPR3
     C                     MOVE *BLANKS   UHFPR4
     C                     MOVE *BLANKS   UHFPR5
     C*
     C** Set off error indicators for screen fields.
     C*
     C                     SETOF                     525354
     C                     SETOF                     555657
     C                     SETOF                     585960
     C                     SETOF                     616263
     C                     SETOF                     646566
     C                     SETOF                     676869
     C                     SETOF                     707172
     C                     SETOF                     737475
     C                     SETOF                     7640
     C*
     C** Set off F12 indicator
     C*
     C                     SETOF                     12
     C*
     C           *IN03     DOUEQ'1'
     C           *IN12     OREQ '1'
     C           *IN40     OREQ '0'
     C*
     C                     WRITE#MSGCTL
     C                     EXFMTACKEYLE
     C*
     C** Clear messages from program message queue.
     C*
     C                     CALL 'Y2CLMSC'
     C                     PARM SPGMQ     ZAPGM  10
     C                     PARM '*SAME'   ZAPGRL  5
     C*
     C           *IN03     IFEQ '0'
     C           *IN12     ANDEQ'0'
     C*
     C                     EXSR #HLEIP
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #HACUP :       Subroutine to add to ZACKEYAL.                *
     C*                                                               *
     C*  CALLED BY :   #HKEYS - Generate Account Keys.                *
     C*                                                               *
     C*  CALLS :                                                      *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HACUP    BEGSR
     C*
     C** Move required fields to file fields.
     C*
     C                     MOVE 'D'       RECI
     C*********************MOVE UHFKEY    AKEY                                                CDL038
     C                     MOVELUHFKEY    AKEY                                                CDL038
     C                     MOVE UHAC1     ACD1
     C                     MOVE UHAC2     ACD2
     C                     MOVE UHAC3     ACD3
     C                     MOVE UHAC4     ACD4
     C                     MOVE UHAC5     ACD5
     C                     MOVE UHAC6     ACD6
     C                     MOVE UHNC1     NCD1
     C                     MOVE UHNC2     NCD2
     C                     MOVE UHNC3     NCD3
     C                     MOVE UHNC4     NCD4
     C                     MOVE UHNC5     NCD5
     C                     MOVE UHNC6     NCD6
     C                     MOVE UHPR1     PRF1
     C                     MOVE UHPR2     PRF2
     C                     MOVE UHPR3     PRF3
     C                     MOVE UHPR4     PRF4
     C                     MOVE UHPR5     PRF5
     C                     MOVE UHPR6     PRF6
     C*
     C                     WRITEZACKEYAF
     C*
     C           CLE031    IFEQ 'Y'                                                         MD051883
     C           UHEVNT    ANDEQ'R'                                                         MD051883
     C           UHAMTL    ANDEQ'F'                                                         MD051883
     C                     EXSR SRVLDT                                                      MD051883
     C                     ENDIF                                                            MD051883
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  #HLEIP:       Subroutine to validate Customer Lending        *
     C*                input.                                         *
     C*                                                               *
     C*  CALLED BY :   #HSECD subroutine.                             *
     C*                                                               *
     C*  CALLS :       #HKEYS subroutine to generate the account keys *
     C*                ZASNMS - send message to program msg queue     *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HLEIP    BEGSR
     C*
     C** Reset error indicators for screen fields.
     C*
     C                     SETOF                     525354
     C                     SETOF                     555657
     C                     SETOF                     585960
     C                     SETOF                     616263
     C                     SETOF                     646566
     C                     SETOF                     676869
     C                     SETOF                     707172
     C                     SETOF                     737475
     C                     SETOF                     7640
     C*
     C** Validate screen fields
     C*
     C** Validate Fee Code(s), corresponding Income Account(s),
     C** Amortisation Account(s), Accrual Account(s) and Posting
     C** Reference(s)
     C*
     C** At least one Fee Code should be input and the rest
     C** are optional.
     C*
     C** UHFC  - Fee Code must be a valid Fee Code in the Fees Code
     C**         file
     C** UHFIA - Fee Income Account must be a valid a/c code and not
     C**         Title only account codes.  Can only be input if the
     C**         corresponding Fee Code is entered.
     C** UHFAM - Fee Amortisation Codes must be a valid a/c code and
     C**         not Title only account codes.  Can only be input if
     C**         the corresponding Fee Code is entered.
     C** UHFAC - Fee Accrual Codes must be a valid a/c code and not
     C**         Title only account codes.  Can only be input if
     C**         the corresponding Fee Code is entered.
     C** UHFPR - Posting Reference must be a '1' or a '3'.  Can only
     C**         be input if the corresponding Fee Code and Fee
     C**         Amortisation or Fee Accrual Account is entered.
     C**         It is mandatory if the Accrual or Amortisation
     C**         Account is entered.  It must not be equal to 3
     C**         when Accrual Summary indicator (from SDDGELRPD)
     C**         is switched on.
     C*
     C           UHFC1     IFEQ *BLANKS
     C           UHFC2     ANDEQ*BLANKS
     C           UHFC3     ANDEQ*BLANKS
     C           UHFC4     ANDEQ*BLANKS
     C           UHFC5     ANDEQ*BLANKS
     C                     SETON                     525762
     C                     SETON                     677240
     C                     MOVEL'USR2654' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C*
     C**  Validate the rest of the details per Fee Code
     C*
     C                     ELSE
     C*
     C** FIRST SET
     C*
     C** UHFC1- Fee Code
     C*
     C           UHFC1     IFNE *BLANKS
     C           UHFC1     CHAINSDFEEL1              52
     C           *IN52     IFEQ '1'                        Entry invalid.
     C                     SETON                     40
     C                     MOVEL'USR2657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** UHFIA1 (Fee Income Account)
     C*
     C           UHFIA1    IFNE *BLANKS
     C           UHFC1     IFEQ *BLANKS
     C                     SETON                     5340  Entry invalid
     C                     MOVEL'USR2655' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFIA1    CHAINSDACODL0             53
     C           *IN53     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4053  Seton if Title Only
     C                     MOVEL'USR2658' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAM1  (Fee Amortisation Codes)
     C*
     C           UHFAM1    IFNE *BLANKS
     C           UHFC1     IFEQ *BLANKS
     C                     SETON                     5440  Entry invalid
     C                     MOVEL'USR2659' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAM1    CHAINSDACODL0             54
     C           *IN54     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4054  Seton if Title Only
     C                     MOVEL'USR2660' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAC1- Fee Accrual Codes
     C*
     C           UHFAC1    IFNE *BLANKS
     C           UHFC1     IFEQ *BLANKS
     C                     SETON                     5540  Entry invalid
     C                     MOVEL'USR2661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAC1    CHAINSDACODL0             55
     C           *IN55     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4055  Seton if Title Only
     C                     MOVEL'USR2662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFPR1- Posting Reference
     C*
     C           UHFPR1    IFNE *BLANKS
     C           UHFC1     IFEQ *BLANKS
     C           UHFAM1    OREQ *BLANKS
     C           UHFAC1    ANDEQ*BLANKS
     C                     SETON                     5640  Entry invalid
     C                     MOVEL'USR2663' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C           UHFPR1    IFNE '1'
     C           UHFPR1    ANDNE'3'
     C           UHFPR1    ANDNE'4'                                       146525
     C           UHFPR1    ANDNE'5'                                       146525
     C                     SETON                     5640  Entry invalid
     C                     MOVEL'USR2664' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFPR1    IFEQ '3'
     C           BKAKSI    ANDEQ'Y'
     C                     SETON                     5640
     C                     MOVEL'USR4268' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           UHFAM1    IFNE *BLANKS
     C           UHFAC1    ORNE *BLANKS
     C                     SETON                     5640  Entry invalid
     C                     MOVEL'USR2665' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** SECOND SET
     C*
     C** UHFC2- Fee Code
     C*
     C           UHFC2     IFNE *BLANKS
     C           UHFC2     CHAINSDFEEL1              57
     C           *IN57     IFEQ '1'                        Entry invalid.
     C                     SETON                     40
     C                     MOVEL'USR2657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** UHFIA2 (Fee Income Account)
     C*
     C           UHFIA2    IFNE *BLANKS
     C           UHFC2     IFEQ *BLANKS
     C                     SETON                     5840  Entry invalid
     C                     MOVEL'USR2655' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFIA2    CHAINSDACODL0             58
     C           *IN58     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4058  Seton if Title Only
     C                     MOVEL'USR2658' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAM2  (Fee Amortisation Codes)
     C*
     C           UHFAM2    IFNE *BLANKS
     C           UHFC2     IFEQ *BLANKS
     C                     SETON                     5940  Entry invalid
     C                     MOVEL'USR2659' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAM2    CHAINSDACODL0             59
     C           *IN59     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4059  Seton if Title Only
     C                     MOVEL'USR2660' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAC2- Fee Accrual Codes
     C*
     C           UHFAC2    IFNE *BLANKS
     C           UHFC2     IFEQ *BLANKS
     C                     SETON                     6040  Entry invalid
     C                     MOVEL'USR2661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAC2    CHAINSDACODL0             60
     C           *IN60     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4060  Seton if Title Only
     C                     MOVEL'USR2662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFPR2- Posting Reference
     C*
     C           UHFPR2    IFNE *BLANKS
     C           UHFC2     IFEQ *BLANKS
     C           UHFAM2    OREQ *BLANKS
     C           UHFAC2    ANDEQ*BLANKS
     C                     SETON                     6140  Entry invalid
     C                     MOVEL'USR2663' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C           UHFPR2    IFNE '1'
     C           UHFPR2    ANDNE'3'
     C           UHFPR2    ANDNE'4'                                       146525
     C           UHFPR2    ANDNE'5'                                       146525
     C                     SETON                     6140  Entry invalid
     C                     MOVEL'USR2664' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFPR2    IFEQ '3'
     C           BKAKSI    ANDEQ'Y'
     C                     SETON                     6140
     C                     MOVEL'USR4268' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           UHFAM2    IFNE *BLANKS
     C           UHFAC2    ORNE *BLANKS
     C                     SETON                     6140  Entry invalid
     C                     MOVEL'USR2665' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** THIRD SET
     C*
     C** UHFC3- Fee Code
     C*
     C           UHFC3     IFNE *BLANKS
     C           UHFC3     CHAINSDFEEL1              62
     C           *IN62     IFEQ '1'                        Entry invalid.
     C                     SETON                     40
     C                     MOVEL'USR2657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** UHFIA3 (Fee Income Account)
     C*
     C           UHFIA3    IFNE *BLANKS
     C           UHFC3     IFEQ *BLANKS
     C                     SETON                     6340  Entry invalid
     C                     MOVEL'USR2655' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFIA3    CHAINSDACODL0             63
     C           *IN63     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4063  Seton if Title Only
     C                     MOVEL'USR2658' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAM3  (Fee Amortisation Codes)
     C*
     C           UHFAM3    IFNE *BLANKS
     C           UHFC3     IFEQ *BLANKS
     C                     SETON                     6440  Entry invalid
     C                     MOVEL'USR2659' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAM3    CHAINSDACODL0             64
     C           *IN64     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4064  Seton if Title Only
     C                     MOVEL'USR2660' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAC3- Fee Accrual Codes
     C*
     C           UHFAC3    IFNE *BLANKS
     C           UHFC3     IFEQ *BLANKS
     C                     SETON                     6540  Entry invalid
     C                     MOVEL'USR2661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAC3    CHAINSDACODL0             65
     C           *IN65     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4065  Seton if Title Only
     C                     MOVEL'USR2662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFPR3- Posting Reference
     C*
     C           UHFPR3    IFNE *BLANKS
     C           UHFC3     IFEQ *BLANKS
     C           UHFAM3    OREQ *BLANKS
     C           UHFAC3    ANDEQ*BLANKS
     C                     SETON                     6640  Entry invalid
     C                     MOVEL'USR2663' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C           UHFPR3    IFNE '1'
     C           UHFPR3    ANDNE'3'
     C           UHFPR3    ANDNE'4'                                       146525
     C           UHFPR3    ANDNE'5'                                       146525
     C                     SETON                     6640  Entry invalid
     C                     MOVEL'USR2664' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFPR3    IFEQ '3'
     C           BKAKSI    ANDEQ'Y'
     C                     SETON                     6640
     C                     MOVEL'USR4268' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           UHFAM3    IFNE *BLANKS
     C           UHFAC3    ORNE *BLANKS
     C                     SETON                     6640  Entry invalid
     C                     MOVEL'USR2665' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** FOURTH SET
     C*
     C** UHFC4- Fee Code
     C*
     C           UHFC4     IFNE *BLANKS
     C           UHFC4     CHAINSDFEEL1              67
     C           *IN67     IFEQ '1'                        Entry invalid.
     C                     SETON                     40
     C                     MOVEL'USR2657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** UHFIA4 (Fee Income Account)
     C*
     C           UHFIA4    IFNE *BLANKS
     C           UHFC4     IFEQ *BLANKS
     C                     SETON                     6840  Entry invalid
     C                     MOVEL'USR2655' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFIA4    CHAINSDACODL0             68
     C           *IN68     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4068  Seton if Title Only
     C                     MOVEL'USR2658' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAM4  (Fee Amortisation Codes)
     C*
     C           UHFAM4    IFNE *BLANKS
     C           UHFC4     IFEQ *BLANKS
     C                     SETON                     6940  Entry invalid
     C                     MOVEL'USR2659' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAM4    CHAINSDACODL0             69
     C           *IN69     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4069  Seton if Title Only
     C                     MOVEL'USR2660' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAC4- Fee Accrual Codes
     C*
     C           UHFAC4    IFNE *BLANKS
     C           UHFC4     IFEQ *BLANKS
     C                     SETON                     7040  Entry invalid
     C                     MOVEL'USR2661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAC4    CHAINSDACODL0             70
     C           *IN70     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4070  Seton if Title Only
     C                     MOVEL'USR2662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFPR4- Posting Reference
     C*
     C           UHFPR4    IFNE *BLANKS
     C           UHFC4     IFEQ *BLANKS
     C           UHFAM4    OREQ *BLANKS
     C           UHFAC4    ANDEQ*BLANKS
     C                     SETON                     7140  Entry invalid
     C                     MOVEL'USR2663' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C           UHFPR4    IFNE '1'
     C           UHFPR4    ANDNE'3'
     C           UHFPR4    ANDNE'4'                                       146525
     C           UHFPR4    ANDNE'5'                                       146525
     C                     SETON                     7140  Entry invalid
     C                     MOVEL'USR2664' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFPR4    IFEQ '3'
     C           BKAKSI    ANDEQ'Y'
     C                     SETON                     7140
     C                     MOVEL'USR4268' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           UHFAM4    IFNE *BLANKS
     C           UHFAC4    ORNE *BLANKS
     C                     SETON                     7140  Entry invalid
     C                     MOVEL'USR2665' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** FIFTH SET
     C*
     C** UHFC5- Fee Code
     C*
     C           UHFC5     IFNE *BLANKS
     C           UHFC5     CHAINSDFEEL1              72
     C           *IN72     IFEQ '1'                        Entry invalid.
     C                     SETON                     40
     C                     MOVEL'USR2657' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C** UHFIA5 (Fee Income Account)
     C*
     C           UHFIA5    IFNE *BLANKS
     C           UHFC5     IFEQ *BLANKS
     C                     SETON                     7340  Entry invalid
     C                     MOVEL'USR2655' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFIA5    CHAINSDACODL0             73
     C           *IN73     IFEQ '1'
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4073  Seton if Title Only
     C                     MOVEL'USR2658' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAM5  (Fee Amortisation Codes)
     C*
     C           UHFAM5    IFNE *BLANKS
     C           UHFC5     IFEQ *BLANKS
     C                     SETON                     7440  Entry invalid
     C                     MOVEL'USR2659' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAM5    CHAINSDACODL0             74
     C           *IN74     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4074  Seton if Title Only
     C                     MOVEL'USR2660' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFAC5- Fee Accrual Codes
     C*
     C           UHFAC5    IFNE *BLANKS
     C           UHFC5     IFEQ *BLANKS
     C                     SETON                     7540  Entry invalid
     C                     MOVEL'USR2661' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFAC5    CHAINSDACODL0             75
     C           *IN75     IFEQ '1'                        Entry invalid.
     C           A5TOIN    OREQ 'Y'
     C                     SETON                     4075  Seton if Title Only
     C                     MOVEL'USR2662' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C                     END
     C*
     C** UHFPR5- Posting Reference
     C*
     C           UHFPR5    IFNE *BLANKS
     C           UHFC5     IFEQ *BLANKS
     C           UHFAM5    OREQ *BLANKS
     C           UHFAC5    ANDEQ*BLANKS
     C                     SETON                     7640  Entry invalid
     C                     MOVEL'USR2663' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C*
     C           UHFPR5    IFNE '1'
     C           UHFPR5    ANDNE'3'
     C           UHFPR5    ANDNE'4'                                       146525
     C           UHFPR5    ANDNE'5'                                       146525
     C                     SETON                     7640  Entry invalid
     C                     MOVEL'USR2664' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     ELSE
     C           UHFPR5    IFEQ '3'
     C           BKAKSI    ANDEQ'Y'
     C                     SETON                     7640
     C                     MOVEL'USR4268' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ELSE
     C           UHFAM5    IFNE *BLANKS
     C           UHFAC5    ORNE *BLANKS
     C                     SETON                     7640  Entry invalid
     C                     MOVEL'USR2665' ZAMSID           Message id.
     C                     EXSR ZASNMS                     Send message
     C                     END
     C                     END
     C*
     C                     END
     C*
     C** Determine if any errors - if so exit subroutine
     C*
     C           *IN40     IFEQ '0'
     C/COPY WNCPYSRC,AKH00039
     C*
     C** Generate Account Keys.
     C*
     C                     EXSR #HKEYS
     C*
     C** Reset Loan Type/ Sub Type to blanks before redisplaying
     C** initial screen.
     C*
     C                     MOVE *BLANKS   UHTYPE
     C                     MOVE '1'       *IN07
     C                     MOVE *BLANKS   UHFCLS                                              CLE138
     C/COPY WNCPYSRC,AKH00010
     C/COPY WNCPYSRC,AKH00111
     C*
     C                     END
     C*
     C                     ENDSR                                        **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #HKEYS:       Subroutine to generate Account Keys.           *
     C*                                                               *
     C*  CALLED BY :   #HLEIP subroutine.                             *
     C*                                                               *
     C*  CALLS :       #HACUP subroutine.                             *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HKEYS    BEGSR
     C*
     C** Setup keys and output fields for ZACKEYAL.
     C** Non-key fields are only output if entered on screen, but the
     C** keyfield Account Key (AKEY) is output regardless.
     C*
     C                     MOVE *BLANKS   UHFKEY
     C                     MOVE UHTYPE    UHFTYP
     C                     MOVE 'F'       UHAMTL
     C                     MOVE *BLANKS   UHDETL
      *                                                                                       CLE138
     C           CLE138    IFEQ 'Y'                                                           CLE138
     C                     MOVE UHFCLO    UHCLAS                                              CLE138
     C                     ELSE                                                               CLE138
     C                     MOVE *BLANKS   UHCLAS                                              CLE138
     C                     ENDIF                                                              CLE138
     C/COPY WNCPYSRC,AKH00011
     C*                                                                   146525
     C*        ****** THIS IS WRONG AS SHOULDNT NEED ACCRUAL ACCOUNT ***  192643
     C*******  Following Keys produced only if Accrual A/c is entered     146525
     C*                                                                   146525
     C*                                                                   146525
     C*
     C*******  Fee Payment Date  *******
     C** The posting will debit Nostro/Settlement account, and credit
     C** the Accrued Fees Receivables for SFC fee
     C*
     C** Key: fffR...nnF  (where fff = Facility Type and nn = Fee Code)
      **  and fffR...nnD for CLE134                                                           CLE134
     C*
     C                     MOVE 'R'       UHEVNT
     C                     MOVE '01'      UHNC1
     C                     MOVE '2'       UHPR1
     C*
     C** Fee Code 1
     C*
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS
     C                     MOVE UHFC1     UHFEEC
     C                     MOVE UHFAC1    UHAC4
     C           UHFAC1    IFNE *BLANKS
     C                     MOVE UHFPR1    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C                     MOVE 'D'       UHAMTL                                              CLE134
     C                     EXSR #HACUP                                                        CLE134
     C                     MOVE 'F'       UHAMTL                                              CLE134
     C                     ENDIF                                                              CLE134
     C/COPY WNCPYSRC,AKH00040
     C                     END
     C                     ELSE                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE UHFIA1    UHAC4                           192643
     C                     MOVE UHFPR1    UHPR4                           192643
     C                     MOVE '01'      UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00041
     C                     END                                            192643
     C** CREATE SYNDICATED KEYS                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE UHFIA1    UHAC4                           192643
     C                     MOVE UHFPR1    UHPR4                           192643
     C                     MOVE '01'      UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00042
     C                     END                                            192643
     C                     END                                            146525
     C                     MOVE *BLANKS   UHACMI                          192643
     C*
     C** Fee Code 2
     C*
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS
     C                     MOVE UHFC2     UHFEEC
     C                     MOVE UHFAC2    UHAC4
     C           UHFAC2    IFNE *BLANKS
     C                     MOVE UHFPR2    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C                     MOVE 'D'       UHAMTL                                              CLE134
     C                     EXSR #HACUP                                                        CLE134
     C                     MOVE 'F'       UHAMTL                                              CLE134
     C                     ENDIF                                                              CLE134
     C/COPY WNCPYSRC,AKH00043
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 3
     C*
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS
     C                     MOVE UHFC3     UHFEEC
     C                     MOVE UHFAC3    UHAC4
     C           UHFAC3    IFNE *BLANKS
     C                     MOVE UHFPR3    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C                     MOVE 'D'       UHAMTL                                              CLE134
     C                     EXSR #HACUP                                                        CLE134
     C                     MOVE 'F'       UHAMTL                                              CLE134
     C                     ENDIF                                                              CLE134
     C/COPY WNCPYSRC,AKH00044
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 4
     C*
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS
     C                     MOVE UHFC4     UHFEEC
     C                     MOVE UHFAC4    UHAC4
     C           UHFAC4    IFNE *BLANKS
     C                     MOVE UHFPR4    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C                     MOVE 'D'       UHAMTL                                              CLE134
     C                     EXSR #HACUP                                                        CLE134
     C                     MOVE 'F'       UHAMTL                                              CLE134
     C                     ENDIF                                                              CLE134
     C/COPY WNCPYSRC,AKH00045
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 5
     C*
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS
     C                     MOVE UHFC5     UHFEEC
     C                     MOVE UHFAC5    UHAC4
     C           UHFAC5    IFNE *BLANKS
     C                     MOVE UHFPR5    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
      *                                                                                       CLE134
     C           CLE134    IFEQ 'Y'                                                           CLE134
     C                     MOVE 'D'       UHAMTL                                              CLE134
     C                     EXSR #HACUP                                                        CLE134
     C                     MOVE 'F'       UHAMTL                                              CLE134
     C                     ENDIF                                                              CLE134
     C/COPY WNCPYSRC,AKH00046
     C                     END
     C                     END                                            146525
     C*                                                                   CLE004
     C** The posting will debit Nostro/Settlement account, and credit     CLE004
     C** the Accrued Fees Receivables for SFC fee                         CLE004
     C*                                                                   CLE004
     C** Key: fffR..PnnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amount Repayment for Participation                           CLE004
     C*                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE 'R'       UHEVNT                          CLE004
     C                     MOVE 'P'       UHPIND                          CLE004
     C                     MOVE '01'      UHNC1                           CLE004
     C                     MOVE '2'       UHPR4                           CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE UHFAC1    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAC1    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR1    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00047
     C                     ENDIF                                          CLE004
     C                     ELSE                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE UHFIA1    UHAC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE UHFPR1    UHPR1                           192643
     C                     MOVE '01'      UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00048
     C                     END                                            192643
     C** CREATE SYNDICATED KEYS                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE UHFIA1    UHAC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE UHFPR1    UHPR1                           192643
     C                     MOVE '01'      UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00049
     C                     END                                            192643
     C                     END                                            146525
     C                     MOVE *BLANKS   UHACMI                          192643
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C***********          MOVE UHFAC2    UHAC4                     CLE004146525
     C                     MOVE UHFAC2    UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAC2    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR2    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00050
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C***********          MOVE UHFAC3    UHAC4                     CLE004146525
     C                     MOVE UHFAC3    UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAC3    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR3    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00051
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C***********          MOVE UHFAC4    UHAC4                     CLE004146525
     C                     MOVE UHFAC4    UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAC4    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR4    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00052
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C***********          MOVE UHFAC5    UHAC4                     CLE004146525
     C                     MOVE UHFAC5    UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAC5    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR5    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00053
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C*                                                                   CLE004
     C** The posting will debit Nostro/Settlement account, and credit     CLE004
     C** the Accrued Fees Receivables for SFC fee                         CLE004
     C*                                                                   CLE004
     C** Key: fffR..InnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amount Repayment for Branch Internal Customer                CLE004
     C*                                                                   CLE004
     C                     MOVE 'R'       UHEVNT                          CLE004
     C                     MOVE 'I'       UHPIND                          CLE004
     C                     MOVE '01'      UHNC1                           CLE004
     C                     MOVE '2'       UHPR4                           CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFIA1    ORNE *BLANKS                                   192643
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAC1    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAC1    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR1    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00054
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C* CREATE SYNDICATED KEYS                                            192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE *BLANKS   UHAC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00055
     C                     END                                            192643
     C                     MOVE *BLANKS   UHACMI                          192643
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAC2    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAC2    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR2    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00056
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAC3    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAC3    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR3    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00057
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAC4    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAC4    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR4    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00058
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAC5    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAC5    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR5    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00059
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     ENDIF                                          CLE004
     C*
     C** The posting will debit Nostro/Settlement account, and credit
     C** the Amortised Fees Receivables.
     C*
     C** Key: fffR.S.nnF  (where fff = Facility Type and nn = Fee Code)
      *                                                                   131108
      ** Re-initialise fields for amortisation                            131108
      *                                                                   131108
     C                     MOVE *BLANKS   UHDETL                          131108
     C*
     C                     MOVE 'S'       UHACMI
     C                     MOVE '01'      UHNC1                           CLE004
     C                     MOVE '2'       UHPR1                           CLE004
     C*
     C** Fee Code 1
     C*
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS
     C                     MOVE UHFC1     UHFEEC
     C                     MOVE UHFAM1    UHAC4
     C           UHFAM1    IFNE *BLANKS
     C                     MOVE UHFPR1    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00060
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 2
     C*
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS
     C                     MOVE UHFC2     UHFEEC
     C                     MOVE UHFAM2    UHAC4
     C           UHFAM2    IFNE *BLANKS
     C                     MOVE UHFPR2    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00061
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 3
     C*
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS
     C                     MOVE UHFC3     UHFEEC
     C                     MOVE UHFAM3    UHAC4
     C           UHFAM3    IFNE *BLANKS
     C                     MOVE UHFPR3    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00062
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 4
     C*
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS
     C                     MOVE UHFC4     UHFEEC
     C                     MOVE UHFAM4    UHAC4
     C           UHFAM4    IFNE *BLANKS
     C                     MOVE UHFPR4    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00063
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 5
     C*
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS
     C                     MOVE UHFC5     UHFEEC
     C                     MOVE UHFAM5    UHAC4
     C           UHFAM5    IFNE *BLANKS
     C                     MOVE UHFPR5    UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00064
     C                     END
     C                     END                                            146525
     C*                                                                   CLE004
     C** The posting will debit Nostro/Settlement account, and credit     CLE004
     C** the Amortised Fees Receivables.                                  CLE004
     C*                                                                   CLE004
     C** Key: fffR.SPnnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amount Repayment at start for Participation                  CLE004
     C*                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE 'S'       UHACMI                          CLE004
     C                     MOVE 'P'       UHPIND                          CLE004
     C                     MOVE '2'       UHPR4                           CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE UHFAM1    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAM1    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR1    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00065
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE UHFAM2    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAM2    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR2    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00066
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE UHFAM3    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAM3    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR3    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00067
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE UHFAM4    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAM4    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR4    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00068
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE UHFAM5    UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C           UHFAM5    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR5    UHPR1                           CLE004
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00069
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C*                                                                   CLE004
     C** The posting will debit Nostro/Settlement account, and credit     CLE004
     C** the Amortised Fees Receivables.                                  CLE004
     C*                                                                   CLE004
     C** Key: fffR.SInnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amount Repayment at start for Branch Internal Customer       CLE004
     C*                                                                   CLE004
     C                     MOVE 'S'       UHACMI                          CLE004
     C                     MOVE 'I'       UHPIND                          CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAM1    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAM1    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR1    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00070
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAM2    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAM2    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR2    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00071
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAM3    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAM3    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR3    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00072
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAM4    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAM4    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR4    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00073
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           146525
     C                     MOVE *BLANKS   UHAC4                           146525
     C                     MOVE *BLANKS   UHPR1                           146525
     C                     MOVE *BLANKS   UHNC1                           146525
     C*                                                                   146525
     C                     MOVE *BLANKS   UHPR4                           146525
     C                     MOVE *BLANKS   UHNC4                           146525
     C***********          MOVE UHFAM5    UHAC1                     CLE004146525
     C***********          MOVE *BLANKS   UHAC4                     CLE004146525
     C***********UHFAM5    IFNE *BLANKS                             CLE004146525
     C***********          MOVE UHFPR5    UHPR1                     CLE004146525
     C***********          MOVE '01'      UHNC4                     CLE004146525
     C***********          ELSE                                     CLE004146525
     C***********          MOVE *BLANKS   UHPR1                     CLE004146525
     C***********          MOVE *BLANKS   UHNC4                     CLE004146525
     C***********          ENDIF                                    CLE004146525
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00074
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C                     ENDIF                                          CLE004
     C*
     C*
     C*******  Accrual Date  *******
     C** The posting will debit Accrued Fees Receivable, and credit
     C** the Fee Income for SFC fee
     C*
     C** Key: fffA...nnF  (where fff = Facility Type and nn = Fee Code)
     C*
     C                     MOVE 'A'       UHEVNT
     C                     MOVE ' '       UHACMI
     C*
     C** Fee Code 1
     C*
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS
     C                     MOVE UHFC1     UHFEEC
     C                     MOVE UHFAC1    UHAC1
     C           UHFAC1    IFNE *BLANKS
     C                     MOVE UHFPR1    UHPR1
     C                     MOVE '01'      UHNC1
     C                     ELSE
     C                     MOVE *BLANKS   UHPR1
     C                     MOVE *BLANKS   UHNC1
     C                     END
     C*
     C                     MOVE UHFIA1    UHAC4
     C           UHFIA1    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00075
     C                     END
     C                     ELSE                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE *BLANKS   UHAC1                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00076
     C                     END                                            192643
     C** CREATE SYNDICATED KEYS                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE *BLANKS   UHAC1                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00077
     C                     END                                            192643
     C                     END                                            146525
     C                     MOVE *BLANKS   UHACMI                          192643
     C*
     C** Fee Code 2
     C*
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS
     C                     MOVE UHFC2     UHFEEC
     C                     MOVE UHFAC2    UHAC1
     C           UHFAC2    IFNE *BLANKS
     C                     MOVE UHFPR2    UHPR1
     C                     MOVE '01'      UHNC1
     C                     ELSE
     C                     MOVE *BLANKS   UHPR1
     C                     MOVE *BLANKS   UHNC1
     C                     END
     C*
     C                     MOVE UHFIA2    UHAC4
     C           UHFIA2    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00078
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 3
     C*
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS
     C                     MOVE UHFC3     UHFEEC
     C                     MOVE UHFAC3    UHAC1
     C           UHFAC3    IFNE *BLANKS
     C                     MOVE UHFPR3    UHPR1
     C                     MOVE '01'      UHNC1
     C                     ELSE
     C                     MOVE *BLANKS   UHPR1
     C                     MOVE *BLANKS   UHNC1
     C                     END
     C*
     C                     MOVE UHFIA3    UHAC4
     C           UHFIA3    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00079
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 4
     C*
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS
     C                     MOVE UHFC4     UHFEEC
     C                     MOVE UHFAC4    UHAC1
     C           UHFAC4    IFNE *BLANKS
     C                     MOVE UHFPR4    UHPR1
     C                     MOVE '01'      UHNC1
     C                     ELSE
     C                     MOVE *BLANKS   UHPR1
     C                     MOVE *BLANKS   UHNC1
     C                     END
     C*
     C                     MOVE UHFIA4    UHAC4
     C           UHFIA4    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00080
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 5
     C*
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS
     C                     MOVE UHFC5     UHFEEC
     C                     MOVE UHFAC5    UHAC1
     C           UHFAC5    IFNE *BLANKS
     C                     MOVE UHFPR5    UHPR1
     C                     MOVE '01'      UHNC1
     C                     ELSE
     C                     MOVE *BLANKS   UHPR1
     C                     MOVE *BLANKS   UHNC1
     C                     END
     C*
     C                     MOVE UHFIA5    UHAC4
     C           UHFIA5    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00081
     C                     END
     C                     END                                            146525
     C*                                                                   CLE004
     C** The posting will debit Accrued Fees Receivable, and credit       CLE004
     C** the Fee Income for SFC fee                                       CLE004
     C*                                                                   CLE004
     C** Key: fffA..PnnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Accrual for Participation                                    CLE004
     C*                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE 'A'       UHEVNT                          CLE004
     C                     MOVE 'P'       UHPIND                          CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE UHFAC1    UHAC4                           CLE004
     C           UHFAC1    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR1    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA1    UHAC1                           CLE004
     C           UHFIA1    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR1    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00082
     C                     ENDIF                                          CLE004
     C                     ELSE                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00083
     C                     END                                            192643
     C** CREATE SYNDICATED KEYS                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE *BLANKS   UHAC1                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00084
     C                     END                                            192643
     C                     END                                            146525
     C                     MOVE *BLANKS   UHACMI                          192643
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE UHFAC2    UHAC4                           CLE004
     C           UHFAC2    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR2    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA2    UHAC1                           CLE004
     C           UHFIA2    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR2    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00085
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE UHFAC3    UHAC4                           CLE004
     C           UHFAC3    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR3    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA3    UHAC1                           CLE004
     C           UHFIA3    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR3    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00086
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE UHFAC4    UHAC4                           CLE004
     C           UHFAC4    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR4    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA4    UHAC1                           CLE004
     C           UHFIA4    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR4    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00087
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE UHFAC5    UHAC4                           CLE004
     C           UHFAC5    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR5    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA5    UHAC1                           CLE004
     C           UHFIA5    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR5    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00088
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C*                                                                   CLE004
     C** The posting will debit Accrued Fees Receivable, and credit       CLE004
     C** the Fee Income for SFC fee                                       CLE004
     C*                                                                   CLE004
     C** Key: fffA..InnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Accrual for Branch Internal Customer                         CLE004
     C*                                                                   CLE004
     C                     MOVE 'A'       UHEVNT                          CLE004
     C                     MOVE 'I'       UHPIND                          CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC1    IFNE *BLANKS                                   146525
     C           UHFIA1    ORNE *BLANKS                                   192643
     C********** UHFC1     IFNE *BLANKS                                   CLE004 192643
     C           UHFC1     ANDNE*BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00089
     C                     ENDIF                                          146525
     C** CREATE SYNDICATED KEYS                                           192643
     C           UHFIA1    IFNE *BLANKS                                   192643
     C           UHFAM1    ANDEQ*BLANKS                                   192643
     C           UHFC1     ANDNE*BLANKS                                   192643
     C                     MOVE 'S'       UHACMI                          192643
     C                     MOVE UHFC1     UHFEEC                          192643
     C                     MOVE *BLANKS   UHAC4                           192643
     C                     MOVE *BLANKS   UHAC1                           192643
     C                     MOVE *BLANKS   UHPR1                           192643
     C                     MOVE *BLANKS   UHNC1                           192643
     C                     MOVE *BLANKS   UHPR4                           192643
     C                     MOVE *BLANKS   UHNC4                           192643
     C** Update file                                                      192643
     C                     EXSR #HACUP                                    192643
     C/COPY WNCPYSRC,AKH00090
     C**********           ENDIF                                          CLE004 192643
     C                     ENDIF                                          192643
     C                     MOVE *BLANKS   UHACMI                          192643
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00091
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00092
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00093
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAC5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00094
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C                     ENDIF                                          CLE004
     C*
     C** Key: fffA.S.nnF  (where fff = Facility Type and nn = Fee Code)
     C** The posting will debit Amortised Fees Receivable, and credit
     C** the Fee Income for SFC fee.
      *                                                                   131108
      ** Re-initialise fields for amortisation                            131108
      *                                                                   131108
     C                     MOVE *BLANKS   UHDETL                          131108
     C*
     C                     MOVE 'S'       UHACMI
     C*
     C** Fee Code 1
     C*
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS
     C                     MOVE UHFC1     UHFEEC
     C                     MOVE UHFAM1    UHAC1
      *                                                                   131108
     C           UHFAM1    IFNE *BLANKS
     C                     MOVE UHFPR1    UHPR1
     C                     MOVE '01'      UHNC1
      *                                                                   131108
     C***********          ELSE                                           131108
     C***********          MOVE *BLANKS   UHPR1                           131108
     C***********          MOVE *BLANKS   UHNC1                           131108
     C***********          END                                            131108
     C*
     C                     MOVE UHFIA1    UHAC4
      *                                                                   131108
     C           UHFIA1    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
      *                                                                   131108
     C                     ELSE                                           131108
     C                     MOVE *BLANKS   UHPR1                           131108
     C                     MOVE *BLANKS   UHNC1                           131108
     C                     END                                            131108
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00095
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 2
     C*
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS
     C                     MOVE UHFC2     UHFEEC
     C                     MOVE UHFAM2    UHAC1
      *                                                                   131108
     C           UHFAM2    IFNE *BLANKS
     C                     MOVE UHFPR2    UHPR1
     C                     MOVE '01'      UHNC1
      *                                                                   131108
     C***********          ELSE                                           131108
     C***********          MOVE *BLANKS   UHPR1                           131108
     C***********          MOVE *BLANKS   UHNC1                           131108
     C***********          END                                            131108
     C*
     C                     MOVE UHFIA2    UHAC4
      *                                                                   131108
     C           UHFIA2    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
      *                                                                   131108
     C                     ELSE                                           131108
     C                     MOVE *BLANKS   UHPR1                           131108
     C                     MOVE *BLANKS   UHNC1                           131108
     C                     END                                            131108
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00096
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 3
     C*
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS
     C                     MOVE UHFC3     UHFEEC
     C                     MOVE UHFAM3    UHAC1
      *                                                                   131108
     C           UHFAM3    IFNE *BLANKS
     C                     MOVE UHFPR3    UHPR1
     C                     MOVE '01'      UHNC1
      *                                                                   131108
     C***********          ELSE                                           131108
     C***********          MOVE *BLANKS   UHPR1                           131108
     C***********          MOVE *BLANKS   UHNC1                           131108
     C***********          END                                            131108
     C*
     C                     MOVE UHFIA3    UHAC4
      *                                                                   131108
     C           UHFIA3    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
      *                                                                   131108
     C                     ELSE                                           131108
     C                     MOVE *BLANKS   UHPR1                           131108
     C                     MOVE *BLANKS   UHNC1                           131108
     C                     END                                            131108
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00097
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 4
     C*
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS
     C                     MOVE UHFC4     UHFEEC
     C                     MOVE UHFAM4    UHAC1
      *                                                                   131108
     C           UHFAM4    IFNE *BLANKS
     C                     MOVE UHFPR4    UHPR1
     C                     MOVE '01'      UHNC1
      *                                                                   131108
     C***********          ELSE                                           131108
     C***********          MOVE *BLANKS   UHPR1                           131108
     C***********          MOVE *BLANKS   UHNC1                           131108
     C***********          END                                            131108
     C*
     C                     MOVE UHFIA4    UHAC4
      *                                                                   131108
     C           UHFIA4    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
      *                                                                   131108
     C                     ELSE                                           131108
     C                     MOVE *BLANKS   UHPR1                           131108
     C                     MOVE *BLANKS   UHNC1                           131108
     C                     END                                            131108
      *                                                                   131108
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00098
     C                     END
     C                     END                                            146525
     C*
     C** Fee Code 5
     C*
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS
     C                     MOVE UHFC5     UHFEEC
     C                     MOVE UHFAM5    UHAC1
      *                                                                   131108
     C           UHFAM5    IFNE *BLANKS
     C                     MOVE UHFPR5    UHPR1
     C                     MOVE '01'      UHNC1
      *                                                                   131108
     C***********          ELSE                                           131108
     C***********          MOVE *BLANKS   UHPR1                           131108
     C***********          MOVE *BLANKS   UHNC1                           131108
     C***********          END                                            131108
     C*
     C                     MOVE UHFIA5    UHAC4
      *                                                                   131108
     C           UHFIA5    IFNE *BLANKS
     C                     MOVE '1'       UHPR4
     C                     MOVE '01'      UHNC4
     C                     ELSE
     C                     MOVE *BLANKS   UHPR4
     C                     MOVE *BLANKS   UHNC4
     C                     END
      *                                                                   131108
     C                     ELSE                                           131108
     C                     MOVE *BLANKS   UHPR1                           131108
     C                     MOVE *BLANKS   UHNC1                           131108
     C                     END                                            131108
     C** Update file
     C                     EXSR #HACUP
     C/COPY WNCPYSRC,AKH00099
     C                     END
     C                     END                                            146525
     C** The posting will debit Amortised Fees Receivable, and credit     CLE004
     C** the Fee Income for SFC fee.                                      CLE004
     C*                                                                   CLE004
     C** Key: fffA.SPnnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amortisation for Participant                                 CLE004
     C*                                                                   CLE004
     C           CLE004    IFEQ 'Y'                                       CLE004
     C                     MOVE 'S'       UHACMI                          CLE004
     C                     MOVE 'P'       UHPIND                          CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE UHFAM1    UHAC4                           CLE004
     C           UHFAM1    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR1    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA1    UHAC1                           CLE004
     C           UHFIA1    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR1    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00100
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE UHFAM2    UHAC4                           CLE004
     C           UHFAM2    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR2    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA2    UHAC1                           CLE004
     C           UHFIA2    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR2    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00101
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE UHFAM3    UHAC4                           CLE004
     C           UHFAM3    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR3    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA3    UHAC1                           CLE004
     C           UHFIA3    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR3    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00102
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE UHFAM4    UHAC4                           CLE004
     C           UHFAM4    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR4    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA4    UHAC1                           CLE004
     C           UHFIA4    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR4    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00103
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE UHFAM5    UHAC4                           CLE004
     C           UHFAM5    IFNE *BLANKS                                   CLE004
     C                     MOVE '1'       UHPR1                                               210725
     C**********           MOVE UHFPR5    UHPR1                                        CLE004 210725
     C                     MOVE '01'      UHNC1                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
     C                     MOVE UHFIA5    UHAC1                           CLE004
     C           UHFIA5    IFNE *BLANKS                                   CLE004
     C                     MOVE UHFPR5    UHPR4                                               210725
     C**********           MOVE '1'       UHPR4                                        CLE004 210725
     C                     MOVE '01'      UHNC4                           CLE004
     C                     ELSE                                           CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C                     ENDIF                                          CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00104
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C** The posting will debit Amortised Fees Receivable, and credit     CLE004
     C** the Fee Income for SFC fee.                                      CLE004
     C*                                                                   CLE004
     C** Key: fffA.SInnF  (where fff = Facility Type and nn = Fee Code)   CLE004
     C*  Fee Amortisation for Branch Internal Customer                    CLE004
     C*                                                                   CLE004
     C                     MOVE 'S'       UHACMI                          CLE004
     C                     MOVE 'I'       UHPIND                          CLE004
     C*                                                                   CLE004
     C** Fee Code 1                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM1    IFNE *BLANKS                                   146525
     C           UHFC1     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC1     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00105
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 2                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM2    IFNE *BLANKS                                   146525
     C           UHFC2     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC2     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00106
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 3                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM3    IFNE *BLANKS                                   146525
     C           UHFC3     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC3     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00107
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 4                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM4    IFNE *BLANKS                                   146525
     C           UHFC4     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC4     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00108
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C** Fee Code 5                                                       CLE004
     C*                                                                   CLE004
     C           UHFAM5    IFNE *BLANKS                                   146525
     C           UHFC5     IFNE *BLANKS                                   CLE004
     C                     MOVE UHFC5     UHFEEC                          CLE004
     C                     MOVE *BLANKS   UHAC1                           CLE004
     C                     MOVE *BLANKS   UHAC4                           CLE004
     C                     MOVE *BLANKS   UHPR1                           CLE004
     C                     MOVE *BLANKS   UHNC1                           CLE004
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPR4                           CLE004
     C                     MOVE *BLANKS   UHNC4                           CLE004
     C** Update file                                                      CLE004
     C                     EXSR #HACUP                                    CLE004
     C/COPY WNCPYSRC,AKH00109
     C                     ENDIF                                          CLE004
     C                     ENDIF                                          146525
     C*                                                                   CLE004
     C                     MOVE *BLANKS   UHPIND                          CLE004
     C                     ENDIF                                          CLE004
      *                                                                                       CLE031
      ** Generate settlement keys when CLE031 is installed                                    CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C                     EXSR #HSETL                                                        CLE031
     C                     ENDIF                                                              CLE031
     C*
     C                     ENDSR                                        **
      *                                                                                       CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  #HSETL: Generate new set of account keys                     *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           #HSETL    BEGSR                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C                     MOVE 'S'       UHEVNT                                              CLE031
     C                     MOVE *BLANKS   UHACMI                                              CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE 'B'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE BLSPTA    UHAC4                                               CLE031
     C                     MOVE '01'      UHNC4                                               CLE031
     C                     MOVE '1'       UHPR4                                               CLE031
      *                                                                                     MD051883
     C                     MOVE UHAC1     WAC1                                              MD051883
     C                     MOVE UHNC1     WPN1                                              MD051883
     C                     MOVE UHPR1     WPR1                                              MD051883
     C                     MOVE *BLANK    UHAC1                                             MD051883
     C                     MOVE *BLANK    UHNC1                                             MD051883
     C                     MOVE *BLANK    UHPR1                                             MD051883
      *                                                                                       CLE031
      ** Update file for each fee codes                                                       CLE031
      *                                                                                       CLE031
     C           UHFC1     IFNE *BLANKS                                                       CLE031
     C                     MOVE UHFC1     UHFEEC                                              CLE031
     C           UHFAC1    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC1    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR1    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC2     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC2     UHFEEC                                              CLE031
     C           UHFAC2    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC2    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR2    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC3     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC3     UHFEEC                                              CLE031
     C           UHFAC3    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC3    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR3    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC4     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC4     UHFEEC                                              CLE031
     C           UHFAC4    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC4    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR4    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC5     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC5     UHFEEC                                              CLE031
     C           UHFAC5    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC5    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR5    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
     C                     MOVE WAC1      UHAC1                                             MD051883
     C                     MOVE WPN1      UHNC1                                             MD051883
     C                     MOVE WPR1      UHPR1                                             MD051883
      *                                                                                       CLE031
      ** Format Key nnnSbbFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE 'C'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE BLSPTA    UHAC1                                               CLE031
     C                     MOVE '01'      UHNC1                                               CLE031
     C                     MOVE '1'       UHPR1                                               CLE031
      *                                                                                     MD051883
     C                     MOVE UHAC4     WAC4                                              MD051883
     C                     MOVE UHNC4     WPN4                                              MD051883
     C                     MOVE UHPR4     WPR4                                              MD051883
     C                     MOVE *BLANK    UHAC4                                             MD051883
     C                     MOVE *BLANK    UHNC4                                             MD051883
     C                     MOVE *BLANK    UHPR4                                             MD051883
      *                                                                                       CLE031
      ** Update file for each fee codes                                                       CLE031
      *                                                                                       CLE031
     C           UHFC1     IFNE *BLANKS                                                       CLE031
     C                     MOVE UHFC1     UHFEEC                                              CLE031
     C           UHFAC1    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC1    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR1    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC2     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC2     UHFEEC                                              CLE031
     C           UHFAC2    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC2    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR2    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC3     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC3     UHFEEC                                              CLE031
     C           UHFAC3    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC3    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR3    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC4     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC4     UHFEEC                                              CLE031
     C           UHFAC4    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC4    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR4    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC5     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC5     UHFEEC                                              CLE031
     C           UHFAC5    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAC5    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR5    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbbBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                     MD051883
     C                     MOVE WAC4      UHAC4                                             MD051883
     C                     MOVE WPN4      UHNC4                                             MD051883
     C                     MOVE WPR4      UHPR4                                             MD051883
      *                                                                                       CLE031
      ** Format Key nnnSzzzbbP (Base Currency Equivalent of Spot                              CLE031
      ** Trade account in Purchase Currency)                                                  CLE031
      *                                                                                       CLE031
     C                     MOVEL'P'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHFEEC                                              CLE031
     C                     MOVE *BLANKS   UHCCY                                               CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE '03'      UHNC1                                               CLE031
     C                     MOVE '1'       UHPR1                                               CLE031
     C                     MOVE 'P'       WRKEY   1                                           CLE031
     C                     EXSR #HCCY                                                         CLE031
      *                                                                                       CLE031
      ** Format Key nnnSzzzbbS (Base Currency Equivalent of Spot                              CLE031
      ** Trade account in Sale Currency)                                                      CLE031
      *                                                                                       CLE031
     C                     MOVE 'S'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHFEEC                                              CLE031
     C                     MOVE *BLANKS   UHCCY                                               CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE '03'      UHNC4                                               CLE031
     C                     MOVE '1'       UHPR4                                               CLE031
     C                     MOVE 'S'       WRKEY                                               CLE031
     C                     EXSR #HCCY                                                         CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   UHCCY                                             MD051695
     C                     MOVE 'S'       UHEVNT                                              CLE031
     C                     MOVE 'S'       UHACMI                                              CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE 'B'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE BLSPTA    UHAC4                                               CLE031
     C                     MOVE '01'      UHNC4                                               CLE031
     C                     MOVE '1'       UHPR4                                               CLE031
      *                                                                                     MD051883
     C                     MOVE UHAC1     WAC1                                              MD051883
     C                     MOVE UHNC1     WPN1                                              MD051883
     C                     MOVE UHPR1     WPR1                                              MD051883
     C                     MOVE *BLANK    UHAC1                                             MD051883
     C                     MOVE *BLANK    UHNC1                                             MD051883
     C                     MOVE *BLANK    UHPR1                                             MD051883
      *                                                                                       CLE031
      ** Update file for each fee codes                                                       CLE031
      *                                                                                       CLE031
     C           UHFC1     IFNE *BLANKS                                                       CLE031
     C                     MOVE UHFC1     UHFEEC                                              CLE031
     C           UHFAM1    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM1    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR1    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC2     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC2     UHFEEC                                              CLE031
     C           UHFAM2    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM2    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR2    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC3     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC3     UHFEEC                                              CLE031
     C           UHFAM3    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM3    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR3    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC4     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC4     UHFEEC                                              CLE031
     C           UHFAM4    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM4    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR4    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffB (Fee Amount in Settlement Currency - Non base)                 CLE031
      *                                                                                       CLE031
     C           UHFC5     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC5     UHFEEC                                              CLE031
     C           UHFAM5    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM5    UHAC1                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC1                                      CLE031 MD051883
     C**********           MOVE UHFPR5    UHPR1                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffB (Fee Amount in Settlement Currency - Base)                     CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
     C                     MOVE WAC1      UHAC1                                             MD051883
     C                     MOVE WPN1      UHNC1                                             MD051883
     C                     MOVE WPR1      UHPR1                                             MD051883
      *                                                                                       CLE031
      ** Format Key nnnSbSFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE 'C'       UHAMTL                                              CLE031
     C                     MOVE *BLANKS   UHDETL                                              CLE031
     C                     MOVE BLSPTA    UHAC1                                               CLE031
     C                     MOVE '01'      UHNC1                                               CLE031
     C                     MOVE '1'       UHPR1                                               CLE031
      *                                                                                     MD051883
     C                     MOVE UHAC4     WAC4                                              MD051883
     C                     MOVE UHNC4     WPN4                                              MD051883
     C                     MOVE UHPR4     WPR4                                              MD051883
     C                     MOVE *BLANK    UHAC4                                             MD051883
     C                     MOVE *BLANK    UHNC4                                             MD051883
     C                     MOVE *BLANK    UHPR4                                             MD051883
      *                                                                                       CLE031
      ** Update file for each fee codes                                                       CLE031
      *                                                                                       CLE031
     C           UHFC1     IFNE *BLANKS                                                       CLE031
     C                     MOVE UHFC1     UHFEEC                                              CLE031
     C           UHFAM1    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM1    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR1    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC2     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC2     UHFEEC                                              CLE031
     C           UHFAM2    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM2    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR2    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC3     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC3     UHFEEC                                              CLE031
     C           UHFAM3    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM3    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR3    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC4     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC4     UHFEEC                                              CLE031
     C           UHFAM4    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM4    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR4    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSFffC (Fee Amount in Fee Currency - Non Base)                        CLE031
      *                                                                                       CLE031
     C           UHFC5     IFNE *BLANKS                                                       CLE031
     C                     MOVE 'F'       UHPIND                                              CLE031
     C                     MOVE UHFC5     UHFEEC                                              CLE031
     C           UHFAM5    IFNE *BLANKS                                                       CLE031
     C**********           MOVE UHFAM5    UHAC4                                      CLE031 MD051883
     C**********           MOVE '01'      UHNC4                                      CLE031 MD051883
     C**********           MOVE UHFPR5    UHPR4                                      CLE031 MD051883
     C                     ENDIF                                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
      ** Format Key nnnSbSBffC (Fee Amount Fee Currency - Base)                               CLE031
      *                                                                                       CLE031
     C                     MOVE 'B'       UHPIND                                              CLE031
     C                     EXSR #HACUP                                                        CLE031
     C                     ENDIF                                                              CLE031
     C                     MOVE WAC4      UHAC4                                             MD051883
     C                     MOVE WPN4      UHNC4                                             MD051883
     C                     MOVE WPR4      UHPR4                                             MD051883
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *                                                                                       CLE031
      *****************************************************************                       CLE031
      /EJECT                                                                                  CLE031
      *****************************************************************                       CLE031
      *                                                               *                       CLE031
      *  #HCCY: Sets up currency code for new account keys            *                       CLE031
      *                                                               *                       CLE031
      *****************************************************************                       CLE031
      *                                                                                       CLE031
     C           #HCCY     BEGSR                                                              CLE031
      *                                                                                       CLE031
     C                     Z-ADD1         WC      30                                          CLE031
      *                                                                                       CLE031
     C           ACY,WC    DOWNE*BLANK                                                        CLE031
      *                                                                                       CLE031
     C                     MOVEAACY,WC    UHCCY                                               CLE031
      *                                                                                       CLE031
     C           WRKEY     IFEQ 'P'                                                           CLE031
     C                     MOVEAASP,WC    UHAC1                                               CLE031
     C                     ELSE                                                               CLE031
     C                     MOVEAASP,WC    UHAC4                                               CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     EXSR #HACUP                                                        CLE031
      *                                                                                       CLE031
     C                     ADD  1         WC                                                  CLE031
     C                     ENDDO                                                              CLE031
      *                                                                                       CLE031
     C                     ENDSR                                                              CLE031
      *****************************************************************                     MD051883
      /EJECT                                                                                MD051883
      *****************************************************************                     MD051883
      *                                                               *                     MD051883
      *  SrVLDT - Subroutine to generate the account keys for         *                     MD051883
      *              value date                                       *                     MD051883
      *                                                               *                     MD051883
      *****************************************************************                     MD051883
     C           SRVLDT    BEGSR                                                            MD051883
      *                                                                                     MD051883
     C                     MOVE UHAMTL    WAMTL   1                                         MD051883
     C           UHPR1     IFEQ '2'                                                         MD051883
     C                     MOVE 'V'       UHAMTL                                            MD051883
     C                     ELSE                                                             MD051883
     C                     MOVE 'J'       UHAMTL                                            MD051883
     C                     ENDIF                                                            MD051883
     C                     MOVE UHAC1     WAC1   10                                         MD051883
     C                     MOVE UHNC1     WPN1    2                                         MD051883
     C                     MOVE UHPR1     WPR1    1                                         MD051883
     C                     MOVE UHAC4     WAC4   10                                         MD051883
     C                     MOVE UHNC4     WPN4    2                                         MD051883
     C                     MOVE UHPR4     WPR4    1                                         MD051883
     C                     MOVE *BLANKS   UHAC4                                             MD051883
     C                     MOVE *BLANKS   UHNC4                                             MD051883
     C                     MOVE *BLANKS   UHPR4                                             MD051883
     C                     MOVELUHFKEY    AKEY                                              MD051883
     C                     MOVE UHAC1     ACD1                                              MD051883
     C                     MOVE UHAC4     ACD4                                              MD051883
     C                     MOVE UHNC1     NCD1                                              MD051883
     C                     MOVE UHNC4     NCD4                                              MD051883
     C                     MOVE UHPR1     PRF1                                              MD051883
     C                     MOVE UHPR4     PRF4                                              MD051883
     C                     WRITEZACKEYAF                                                    MD051883
     C                     MOVE WAC4      UHAC4                                             MD051883
     C                     MOVE WPN4      UHNC4                                             MD051883
     C                     MOVE WPR4      UHPR4                                             MD051883
     C           UHPR4     IFEQ '2'                                                         MD051883
     C                     MOVE 'V'       UHAMTL                                            MD051883
     C                     ELSE                                                             MD051883
     C                     MOVE 'J'       UHAMTL                                            MD051883
     C                     ENDIF                                                            MD051883
     C                     MOVE *BLANKS   UHAC1                                             MD051883
     C                     MOVE *BLANKS   UHNC1                                             MD051883
     C                     MOVE *BLANKS   UHPR1                                             MD051883
     C                     MOVELUHFKEY    AKEY                                              MD051883
     C                     MOVE UHAC1     ACD1                                              MD051883
     C                     MOVE UHAC4     ACD4                                              MD051883
     C                     MOVE UHNC1     NCD1                                              MD051883
     C                     MOVE UHNC4     NCD4                                              MD051883
     C                     MOVE UHPR1     PRF1                                              MD051883
     C                     MOVE UHPR4     PRF4                                              MD051883
     C                     WRITEZACKEYAF                                                    MD051883
     C                     MOVE WAMTL     UHAMTL                                            MD051883
     C                     MOVE WAC1      UHAC1                                             MD051883
     C                     MOVE WPN1      UHNC1                                             MD051883
     C                     MOVE WPR1      UHPR1                                             MD051883
     C                     MOVE WAC4      UHAC4                                             MD051883
     C                     MOVE WPN4      UHNC4                                             MD051883
     C                     MOVE WPR4      UHPR4                                             MD051883
      *                                                                                     MD051883
     C                     ENDSR                                                            MD051883
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  ZASNMS:      Send message to program message queue           *
     C*                                                               *
     C*  CALLS:       Y2SNMGC - send message to program message queue *
     C*                                                               *
     C*  CALLED BY:   FIRST subroutine - first screen validation.     *
     C*               #HLEIP - Validate 2nd screen & generate keys    *
     C*               #HFRST - Validate 1st screen                    *
     C*                                                               *
     C*****************************************************************
     C*
     C           ZASNMS    BEGSR
     C*
     C** Declare message file name
     C*
     C                     MOVEL'SDUSRMSG'ZAMSGF
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM SPGMQ     ZAPGM  10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message Id.
     C                     PARM           ZAMSGF 10        Message file.
     C                     PARM           ZAMSDA132        Message data.
     C                     PARM           ZAMSTP  7        Message type.
     C*
     C                     ENDSR
     C*
     C*****************************************************************
      /EJECT
     C*****************************************************************
     C*                                                               *
     C* #HDBER :      Database error processing                       *
     C*                                                               *
     C* CALLED BY : #HINIT subroutine  - initial set up.              *
     C*                                                               *
     C* CALLS  : None                                                 *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HDBER    BEGSR
     C*
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     OUT  LDA
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #HINIT :      Initial Set up.                                *
     C*                                                               *
     C*  CALLED BY :   Main processing.                               *
     C*                                                               *
     C*  CALLS :       #HDBER  - Database error processing            *
     C*                AOBANKR0 - Access Program for SDBANKPD         *
     C*                AOGELRR0 - Access Program for SDGELRPD         *
     C*                                                               *
     C*****************************************************************
     C*
     C           #HINIT    BEGSR
     C*
     C**  Define Local Data Area
     C*
     C           *NAMVAR   DEFN           LDA
     C*
     C**  Define Rundat Data Area
     C*
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C*
     C** Clear all fields to send messages to message queue.
     C*
     C                     MOVEL*BLANK    ZAPGM            Program queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSID           Message Id.
     C                     MOVEL*BLANK    ZAMSGF           Message file.
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C                     MOVE *BLANKS   SPGMQ            Program queue
     C                     MOVEL'AK0045 ' SPGMQ            Program queue
     C*
     C** Setup LDA field DBPGM
     C*
     C           *LOCK     IN   LDA
     C                     MOVE *BLANKS   DBLOT
     C                     MOVEL'AK0045 ' DBPGM
     C                     OUT  LDA
     C*
     C** Access ICD records:
     C** Use access program AOBANKR0 to retrieve SDBANKPD Details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*DBERR ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** If error in access program, exit via #HDBER  subroutine
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE           ************
     C                     MOVEL'BANK'    DBKEY            * DBERR 01 *
     C                     Z-ADD1         DBASE            ************
     C                     EXSR #HDBER
     C                     END
     C*
     C** Use access program AOGELRR0 to retrieve SDGELRPD Details
     C*
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD
     C                     PARM '*FIRST ' @OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C** If error in access program, exit via #HDBER  subroutine
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDGELRPD'DBFILE           ************
     C                     MOVEL'GELR'    DBKEY            * DBERR 02 *
     C                     Z-ADD2         DBASE            ************
     C                     EXSR #HDBER
     C                     END
     C*
     C*                                                                   CLE004
     C**  Access SAR details file to see if CLE004 is installed           CLE004
     C*                                                                   CLE004
     C                     CALL 'AOSARDR0'                                CLE004
     C                     PARM '       ' @RTCD   7                       CLE004
     C                     PARM '*VERIFY' @OPTN   7                       CLE004
     C                     PARM 'CLE004'  @SARD   6                       CLE004
     C*                                                                   CLE004
     C** If error in access program, exit via DBERR subroutine            CLE004
     C*                                                                   CLE004
     C           @RTCD     IFNE *BLANKS                                   CLE004
     C           @RTCD     ANDNE'*NRF'                                    CLE004
     C           *LOCK     IN   LDA                                       CLE004
     C                     MOVEL'SDSARDPD'DBFILE           ***************CLE004
     C                     MOVEL'*VERIFY' DBKEY            * DBERROR 003 *CLE004
     C                     Z-ADD003       DBASE            ***************CLE004
     C                     EXSR #HDBER                                    CLE004
     C                     END                                            CLE004
      *                                                                   CLE004
     C           @RTCD     IFEQ *BLANK                                    CLE004
     C                     MOVE 'Y'       CLE004  1                       CLE004
     C                     ELSE                                           CLE004
     C                     MOVE 'N'       CLE004                          CLE004
     C                     ENDIF                                          CLE004
     C*                                                                   CLE004
      *                                                                                       CLE031
      ** Get trading details                                                                  CLE031
      *                                                                                       CLE031
     C                     CALL 'AOTRADR0'                                                    CLE031
     C                     PARM '*DBERR ' PRTCD                                               CLE031
     C                     PARM '*FIRST ' POPTN                                               CLE031
     C           SDTRAD    PARM SDTRAD    DSFDY                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFNE *BLANKS                                                       CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SDTRADPD'DBFILE    P                                         CLE031
     C                     MOVELPOPTN     DBKEY     P                                         CLE031
     C                     Z-ADD4         DBASE                                               CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR #HDBER                                                        CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** Check if CLE031 is on.                                                               CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   PRTCD   7                                           CLE031
     C                     PARM '*VERIFY' POPTN   7                                           CLE031
     C                     PARM 'CLE031'  PSARD   6                                           CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
      *                                                                                       CLE031
     C           PRTCD     IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
     C           PRTCD     IFNE '*NRF   '                                                     CLE031
     C           *LOCK     IN   LDA                                                           CLE031
     C                     MOVEL'SCSARDPD'DBFILE    P                                         CLE031
     C                     MOVELPSARD     DBKEY     P                                         CLE031
     C                     Z-ADD5         DBASE                                               CLE031
     C                     OUT  LDA                                                           CLE031
     C                     EXSR #HDBER                                                        CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE138
      ** Check if CLE138 is ON                                                                CLE138
      *                                                                                       CLE138
     C                     CALL 'AOSARDR0'                                                    CLE138
     C                     PARM '       ' @RTCD                                               CLE138
     C                     PARM '*VERIFY' @OPTN                                               CLE138
     C                     PARM 'CLE138'  @SARD                                               CLE138
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE138
      *                                                                                       CLE138
     C           @RTCD     IFEQ *BLANK                                                        CLE138
     C                     MOVE 'Y'       CLE138  1                                           CLE138
     C                     MOVE *ON       *IN30                                               CLE138
     C                     ELSE                                                               CLE138
     C                     MOVE 'N'       CLE138                                              CLE138
     C                     MOVE *OFF      *IN30                                               CLE138
     C                     ENDIF                                                              CLE138
      *                                                                                       CLE138
      ** Define key list to access SDFACTL2                                                   CLE138
      *                                                                                       CLE138
     C           KFCLS     KLIST                                                              CLE138
     C                     KFLD           UHTYPE                                              CLE138
     C                     KFLD           UHFCLS                                              CLE138
      *                                                                                       CLE138
     C/COPY WNCPYSRC,AKH00012
     C/COPY WNCPYSRC,AKH00110
      *                                                                                       CLE134
      ** Check if CLE134 is on.                                                               CLE134
      *                                                                                       CLE134
     C                     CALL 'AOSARDR0'                                                    CLE134
     C                     PARM *BLANKS   PRTCD   7                                           CLE134
     C                     PARM '*VERIFY' POPTN   7                                           CLE134
     C                     PARM 'CLE134'  PSARD   6                                           CLE134
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE134
      *                                                                                       CLE134
     C           PRTCD     IFEQ *BLANK                                                        CLE134
     C                     MOVE 'Y'       CLE134  1                                           CLE134
     C                     ELSE                                                               CLE134
     C                     MOVE 'N'       CLE134                                              CLE134
     C           PRTCD     IFNE '*NRF   '                                                     CLE134
     C           *LOCK     IN   LDA                                                           CLE134
     C                     MOVEL'SCSARDPD'DBFILE    P                                         CLE134
     C                     MOVELPSARD     DBKEY     P                                         CLE134
     C                     Z-ADD8         DBASE                                               CLE134
     C                     OUT  LDA                                                           CLE134
     C                     EXSR #HDBER                                                        CLE134
     C                     ENDIF                                                              CLE134
     C                     ENDIF                                                              CLE134
     C** Check that all required Narrative Codes are present
     C** on SDNARRPD.
     C*
     C                     Z-ADD0         HN      10
     C*
     C***********HN        DOWLT8                                         119429
     C***********HN        DOWLT7                                   119429116017
     C           HN        DOWLT6                                         116017
     C*
     C           HN        ADD  1         HN
     C           HKN,HN    CHAINSDNARRL1             11
     C           *IN11     IFEQ '1'
     C                     MOVE HKN,HN    HKP,HN
     C                     END
     C*
     C                     END
     C*
     C                     MOVEAHKP       UHNARR 16
     C*
     C           UHNARR    IFNE *BLANKS
     C                     SETON                       11
     C                     END
     C*
     C                     ENDSR
     C*****************************************************************
**   HKN- REQUIRED NARRATIVE CODES
012324252627                                                              116017
**  CPY@
(c) Finastra International Limited 2001
