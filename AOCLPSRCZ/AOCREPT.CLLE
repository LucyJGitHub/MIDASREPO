/*********************************************************************/ /*CAP002*/
/*S******CLP**********************************************************/ /*CAP002*/
/*STD    CLPBASEMOD                                                  */
/*EXI *  TEXT('Midas AO Send program message control')               */
/********************************************************************/
/*                                                                  */
/*       Midas     - Access Objects Module                          */
/*                                                                  */
/*       AOCREPT - SEND PROGRAM MESSAGE CONTROL                     */
/*                                                                  */
/*       (c) Finastra International Limited 2001                     */
/*                                                                  */
/*       Last Amend No. MD046248           Date 27Oct17              */
/* Bank Fusion Midas 1.4 Base ---------------------------------------*/
/* Midas Plus 1.4 Base 04 -------------------------------------------*/
/* Midas Plus 1.4 Base ----------------------------------------------*/
/* Midas Plus 1.3 ---------------- Base -----------------------------*/
/* Midas Release 4 --------------- Base -----------------------------*/
/* Midas DBA 3.00 ---------------- Base -----------------------------*/
/*       Prev Amend No. CAP002             Date 01May98              */
/*                      041693             Date 05Jan93              */
/*                      045014               DATE  01DEC92          */
/*                                                                  */
/********************************************************************/
/*                                                                  */
/*       MD046248 - Finastra Rebranding                              */
/*       CAP002 - Mbr converted from an OPM program to an ILE module*/
/*                Also, an ILE *PGM mbr of the same name created    */
/*                ILE modules can make a bound call to the module   */
/*                OPM programs can make a dynamic call to the *PGM  */
/*       041693 - Deliverd as part of fix.                          */
/*                                                                  */
/*       045014 - New program for error fix                         */
/*                                                                  */
/********************************************************************/
/**/
             PGM        PARM(&MSGID &MSGF &MSGFLIB &MSGDTA &MSGREL +
                          &MSGPGM &MSGQ &MSGTYPE)
/**/
/*   Declare variables                                              */
/**/
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGDTA) TYPE(*CHAR) LEN(256)
             DCL        VAR(&MSGF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MSGFLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MSGREL) TYPE(*CHAR) LEN(5)
             DCL        VAR(&MSGPGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MSGQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MSGTYPE) TYPE(*CHAR) LEN(7)
 
             COPYRIGHT TEXT('(c) Finastra International Limited +
                          2001')
 
/**/
/*           Global Monitor Message  */
/**/
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO ABNOR)
/**/
/*           Set up defaults                                         */
/**/
             IF         COND(&MSGFLIB *EQ ' ') THEN(DO)
             CHGVAR     VAR(&MSGFLIB) VALUE('*LIBL')
             ENDDO
             IF         COND(&MSGREL *EQ ' ') THEN(DO)
             CHGVAR     VAR(&MSGREL) VALUE('*PRV')
             ENDDO
             IF         COND((&MSGPGM *EQ ' ') *AND +
                             (&MSGREL *NE '*EXT')) THEN(DO)
             CHGVAR     VAR(&MSGPGM) VALUE('*')
             ENDDO
             IF         COND(&MSGQ *EQ ' ') THEN(DO)
             CHGVAR     VAR(&MSGQ) VALUE('*TOPGMQ')
             ENDDO
             IF         COND(&MSGTYPE *EQ ' ') THEN(DO)
             CHGVAR     VAR(&MSGTYPE) VALUE('*INFO')
             ENDDO
/**/
             IF         COND(&MSGREL *EQ '*EXT') THEN(DO)
             SNDPGMMSG  MSGID(&MSGID) MSGF(&MSGFLIB/&MSGF) +
                          MSGDTA(&MSGDTA) TOPGMQ(&MSGREL) +
                          TOMSGQ(&MSGQ) MSGTYPE(&MSGTYPE)
             ENDDO
             ELSE       CMD(DO)
             SNDPGMMSG  MSGID(&MSGID) MSGF(&MSGFLIB/&MSGF) +
                          MSGDTA(&MSGDTA) TOPGMQ(&MSGREL &MSGPGM) +
                          TOMSGQ(&MSGQ) MSGTYPE(&MSGTYPE)
             ENDDO
/**/
             GOTO       CMDLBL(ENDCLPGM)
/**/
 ABNOR:      SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Error +
                          on Send Program Message') TOPGMQ(*PRV) +
                          MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000 MCH0000 RPG0000)
/**/
 ENDCLPGM:
             ENDPGM
