     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas AO to determine if a window exists')
     F********************************************************************
     F*                                                                  *
     F*  Midas  ACCESS PROGRAMS
     F*                                                                  *
     F*     AOWINS0  - DETERMINE IF A WINDOW PROGRAM EXISTS              *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *      Last Amend No. CPK018           Date 19Mar05             *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *      Last Amend No. BHF270           Date 19Mar05             *
     F*                                                                  *
     F********************************************************************
     F*                                                                  *
      *      CPK018 - Change to make windows switchable. Replace use of  *
      *               - Replace use of SDMREFL1 with SDMREFJ0.           *
      *      BHF270 -  CHANGE THE FORMAT NAME FOR SDOREFL1               *
     F*                                                                  *
     F********************************************************************
     F*
     F* ID F  C  H  L  FUNCTION OF INDICATORS
     F*
     F*       90       FILE ERROR
     F*       91       OPEN ERROR
     F*       92       CLOSE ERROR
     F*       95       NO RECORD FOUND - Window Program Does Not Exist
     F*
      /EJECT
     F*FSTART
      ************************************************************
     F*SDMREFL1IF*E*****      K        DISK                                                   CPK018
     FSDMREFJ0IF  E           K        DISK                                                   CPK018
      * IN  - @DLREGT Mandatory Window
      ************************************************************
     FSDOREFL1IF  E           K        DISK                           UC
      * IN  - @DNREGZ Optional Window
      ************************************************************
      /EJECT
     E*ESTART
      ************************************************************
     E* Description     : Copyright notice for inclusion in all programs
     E*
     E********************************************************************
     E                    CPY@    1   1 80               Copyright     arr
      ************************************************************
      /EJECT
     I*ISTART
      ************************************************************
     I*
     I* Description     : Copyright notice for inclusion in all programs
     I*
     IA@CPY       DS
     I* Copyright array
     I                                        1  80 CPY@
      ************************************************************
      /EJECT
     C*CSTART
      *****************************************************
     C           *ENTRY    PLIST
     C           P@RTCD    PARM           P@RTCD  7        B:Return code
     C                     PARM           P@PGM  10        I:Program Name
     C*****************************************************
     C*
     C*MAIN
     C*
     C**Chain*to*SDMREFL1*for*Window*Record***************                                    CPK018
     C* Chain to SDMREFJ0 for Window Record                                                   CPK018
     C*
     C********** P@PGM     CHAIN@DLREGT              9590    Get record                       CPK018
     C           P@PGM     CHAIN@MREFJ0              9590    Get record                       CPK018
     C           *IN90     CABEQ'1'       T@SKIP             File error
     C           *IN95     IFEQ '1'                          No record found
     C*
     C**Open*File*SDOREFL1*if*a*record*was*not*found*in*SDMREFL1**********                    CPK018
     C* Open File SDOREFL1 if a record was not found in SDMREFJ0                              CPK018
     C*
     C                     OPEN SDOREFL1               91    Open  file
     C           *IN91     CABEQ'1'       T@SKIP             Open  error
     C*
     C* Chain to SDOREFL1 for a window record
     C*
     C***********P@PGM*****CHAIN@DNREGZ              9590    Get record   BHF270
     C           P@PGM     CHAIN@DMREGW              9590    Get record   BHF270
     C           *IN90     CABEQ'1'       T@SKIP             File error
     C           *IN95     CABEQ'1'       T@SKIP             No record found
     C*
     C* Close File SDOREFL1
     C*
     C                     CLOSESDOREFL1               92    Close file
     C           *IN92     CABEQ'1'       T@SKIP             Close error
     C*
     C                     END
      *
      * Return appropriate error code :
      *          _____________
     C           T@SKIP    TAG                             +++ SKIP +++
      *          ~~~~~~~~~~~~~
     C                     MOVE *BLANK    P@RTCD           No Errors
     C   90                MOVE '*ERROR ' P@RTCD           File error
     C   91                MOVE '*OPEN  ' P@RTCD           Open error
     C   92                MOVE '*CLOSE ' P@RTCD           Close error
     C   95                MOVE '*NRF   ' P@RTCD           No record found
      *
      * Return to caller :
      *
     C                     SETON                     LR      Set ind.
     C                     RETRN
      *
      *****************************************************
      *ENDMAIN
** CPY@     : Copyright notice for inclusion in all programs
(c) Misys International Banking Systems Ltd. 2001
