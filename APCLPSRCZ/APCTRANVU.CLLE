000100200528/*********************************************************************/
000200200528/*STD    CLPBASEMOD                                                  */
000300200528/*EXI    TEXT('Midas AP Transaction validate and update')            */
000400200528/*********************************************************************/
000500200528/*                                                                   */
000600200528/*       Midas - APIs                                                */
000700200528/*                                                                   */
000800200528/*       APCTRANVU - Transaction Validate and Update                 */
000900200528/*                                                                   */
001000200528/*       (c) Finastra International Limited 2001                     */
001100200528/*                                                                   */
001200200604/*       Last Amend No. MD045874           Date 22May20              */
001300200528/*       Prev Amend No. CSD101             Date 07Dec18              */
001400200528/*                      CSD102             Date 08Jan19              */
001500200528/*                      MD050018           Date 05Nov18              */
001600200528/*                      MD046248           Date 27Oct17              */
001700200528/*                      CAP212             Date 15Sep14              */
001800200528/*                      AR988155           Date 19Aug14              */
001900200528/*                      MD023834           Date 27Nov13              */
002000200528/*                      MD021554A          Date 16Aug13              */
002100200528/*                      MD019466           Date 02Apr13              */
002200200528/*                      AR1094967          Date 14Mar13              */
002300200528/*                      AR1079502          Date 03Feb13              */
002400200528/*                      AR868657           Date 19Dec12              */
002500200528/*                      AR1021983          Date 01Aug12              */
002600200528/*                      263942             Date 01Aug12              */
002700200528/*                      CLE134             Date 01Aug12              */
002800200528/*                      AR971184           Date 28May12              */
002900200528/*                      CSW210             Date 04May10              */
003000200528/* Bank Fusion Midas 1.4 Base ---------------------------------------*/
003100200528/*                      BUG27488           Date 15Apr10              */
003200200528/* Midas Plus 1.4 Base 04 -------------------------------------------*/
003300200528/*                      BUG22550           Date 29Jan09              */
003400200528/*                      BUG22219           Date 21Jan09              */
003500200528/*                      BUG14457           Date 26Jul07              */
003600200528/*                      BUG14288           Date 10Jul07              */
003700200528/*                      BUG14195           Date 23Jun07              */
003800200528/*                      248218             Date 01Jun07              */
003900200528/*                      247277             Date 24May07              */
004000200528/* Midas Plus 1.4 Base ----------------------------------------------*/
004100200528/*                      244095             Date 01Dec06              */
004200200528/*                      CSD079             Date 05Feb07              */
004300200528/*                      BUG12213           Date 16Jan07              */
004400200528/*                      CRE026             Date 24May06              */
004500200528/*                      BUG13172           Date 30Jan07              */
004600200528/* Midas Plus 1.3 ---------------- Base -----------------------------*/
004700200528/*                      BUG12411           Date 02Nov06              */
004800200528/*                      238091             Date 01Feb06              */
004900200528/*                      BUG8483            Date 29Sep05              */
005000200528/*                      241196             Date 17Jul06              */
005100200528/*                      239969             Date 23May06              */
005200200528/*                      240412             Date 03Jul06              */
005300200528/*                      BUG8069            Date 25May06              */
005400200528/*                      BUG8953            Date 07Nov05              */
005500200528/*                      BUG10837           Date 13Mar06              */
005600200528/*                      BUG10792           Date 07Mar06              */
005700200528/*                      BUG9946            Date 17Jan06              */
005800200528/*                      BUG8867            Date 23Nov05              */
005900200528/*                      BUG9345            Date 23Nov05              */
006000200528/*                      CAP087             Date 19Aug05              */
006100200528/*                      CGL035             Date 01Mar05              */
006200200528/*                      CRE023             Date 29Jul05              */
006300200528/*                      BG7008             Date 24Jun05              */
006400200528/*                      CGP010             Date 17Jan05              */
006500200528/*                      BG6507             Date 05Apr05              */
006600200528/*                      BUG4646            Date 04Nov04              */
006700200528/*                      BUG4821            Date 18Nov04              */
006800200528/*                      CFT118             Date 20Aug04              */
006900200528/*                      BG3913             Date 04Sep04              */
007000200528/*                      CFT115             Date 01Jul04              */
007100200528/*                      CMM105             Date 22Jun04              */
007200200528/*                      BUG2480            Date 26May04              */
007300200528/*                      BUG2687            Date 25May04              */
007400200528/*                      BG1105             Date 15Dec03              */
007500200528/*                      BG1953             Date 16Feb04              */
007600200528/*                      NAD009             Date 31Mar04              */
007700200528/*                      CGP004             Date 16Feb04              */
007800200528/*                      TCA046             Date 26Mar04              */
007900200528/*                      CSC022             Date 24Feb04              */
008000200528/*                      CAP084  *CREATE    Date 23Mar03              */
008100200528/*                                                                   */
008200200528/*                                                                   */
008300200528/*********************************************************************/
008400200528/*                                                                   */
008500200528/*       MD045874 - Dumps in MMVLDNIDAT and GLAMADVU programs due to */
008600200528/*                  commitment control error (CPF4293) in REHISBL.   */
008700200528/*       CSD101 - Password Encryption                                */
008800200528/*       CSD102 - Password Length Extension                          */
008900200528/*       MD050018 - PDP Enhancement: Generate Projected Accnt Movmnt */
009000200528/*                  for Input Cycle Principal Increase Event to PDCL */
009100200528/*       MD046248 - Finastra Rebranding                              */
009200200528/*       CAP212 - FT Nostro Transfer API                             */
009300200528/*       AR988155 - Cannot insert MM deal due to commitment control  */
009400200528/*                  issue on file DLDEALL5. (Child: AR988156)        */
009500200528/*       MD023834 - Delete over ride on ACCNTL1 after every call of  */
009600200528/*                  APTRANVU                                         */
009700200528/*       MD021554A - LEC06A 01001 failed due to FCOOB                */
009800200528/*       MD019466 - Error message encountered upon Insert/Enquire    */
009900200528/*                  Update while system is in Secondary COB          */
010000200528/*       AR1094967 - Add override to LEPDUELB to resolve commitement */
010100200528/*                   error.                                          */
010200200528/*       AR1079502 - Be able to reverse a PDCL created on line       */
010300200528/*       AR868657 - Error in SDCUSDVU while adding new customer.     */
010400200528/*                  Fix is issue an OVRDBF on PMPORTL1 with          */
010500200528/*                  SHARE(*NO) (Child: AR868658)                     */
010600200528/*       AR1021983 - [PDP] Option C - Technical Enhancements Stated  */
010700200528/*                   in POC                                          */
010800200528/*       263942 - Add override for LEFEEDL0 to resolve commitment    */
010900200528/*                issue                                              */
011000200528/*       CLE134 - Past Due Call Loan Processing (Recompile)          */
011100200528/*       AR971184 - For some JMS APIs (CUSD, AMAD, DPMV, OPAY), Front*/
011200200528/*                  Office Id is no more updated in master database  */
011300200528/*                  files which provokes some big problems in third  */
011400200528/*                  party product such as TOF.(Child:AR971185)       */
011500200528/*       CSW210 - SWIFT 2010 Changes                                 */
011600200528/*       BUG27488 - Commitment definition error on ACCNT             */
011700200528/*       BUG22550 - Problem when authorizing ALNA.                   */
011800200528/*       BUG22219 - To prevent commitment control error on LECLIP.   */
011900200528/*       BUG14457 - To prevent commitment control error on SDNOST    */
012000200528/*       BUG14288 - To prevent commitment control error on DEAM API  */
012100200528/*       BUG14195 - Database Error on AMAD module                    */
012200200528/*       248218 - Applied fix 238091.                                */
012300200528/*       247277 - Cater for native JDBC driver as well as toolbox    */
012400200528/*       244095 - Problem with opening ACNUMA file.                  */
012500200528/*       CSD079 - Enhanced Customer Maintenance API                  */
012600200528/*       BUG12213 - Depot details missing on wholesale customer      */
012700200528/*                  input                                            */
012800200528/*       CRE026 - Consumer Banking                                   */
012900200528/*       BUG13172 - A serious midas error occurred (Recompile)       */
013000200528/*       BUG12411 -  Prevent commitment control error on SECS API.   */
013100200528/*                   Problem with opening of SEDEV file.             */
013200200528/*       238091 - Reclaim activation group to ensure that file is    */
013300200528/*                closed after use.                                  */
013400200528/*       BUG8483 - Unauthorised transactions (reverse fix BUG4821)   */
013500200528/*       241196 - Problem with opening PSOLD file                    */
013600200528/*       239969 - Database error in LEFEEMUPD.                       */
013700200528/*       240412 - Keep original files in QTEMP for CIRS.             */
013800200528/*                Also for CACF and SIRS. Apply 236794.              */
013900200528/*       BUG8069 - DLC0601B 00001 file out of balance in DL0215AU    */
014000200528/*                 Prevent commitment control error on DEAMS         */
014100200528/*       BUG8953 - Problem with opening SECEO.                       */
014200200528/*       BUG10837- BNI002 should be changed to CRE023                */
014300200528/*       BUG10792- File sharing problems                             */
014400200528/*       BUG9946 - Correct Depot Movement Type Set up                */
014500200528/*       BUG8867 - File sharing problems                             */
014600200528/*       BUG9345 - Notify if invalid depot movement type entered     */
014700200528/*       CAP087 - Depot Movement - Java Wrapper in Midasplus.        */
014800200528/*                Retain TransType='DPMV' for Repo / Depot Transfer. */
014900200528/*                Also adjust substring position to retrieve DPMV    */
015000200528/*                type from Buffer (this is due to new fields added  */
015100200528/*                into DPMV API XML file).                           */
015200200528/*       CGL035 - EUSD Upgrade to Midasplus                          */
015300200528/*       CRE023 - 2 O'clock Flag Upgrade to MidasPlus                */
015400200528/*       BG7008 - Reverse fix BUG4821                                */
015500200528/*       CGP010 - Global BSPL                                        */
015600200528/*       BG6507 - Jobs are hanging at confirmation screen            */
015700200528/*       BUG4646- Completion of SIRS api                             */
015800200528/*       BUG4821- Prevent display of error message "A serious Midas  */
015900200528/*                error has occured" in JAVA application.            */
016000200528/*       CFT118 - Core changes for GBO018                            */
016100200528/*                Demand Drafts printing - Upgrade to Midasplus.     */
016200200528/*                Core hooks amended:APCTRANU01                      */
016300200528/*       BG3913 - RCLRSC to reset programs that retreive volatile    */
016400200528/*                data in the INZSR (Esp ZMUSER)                     */
016500200528/*       CFT115 - Core changes for GBO015                            */
016600200528/*              - Incoming Payments Beneficiary Validation           */
016700200528/*              - Upgrade to Midasplus                               */
016800200528/*                Core hooks amended:APCTRANU01                      */
016900200528/*       CMM105 - Core changes for GBO005                            */
017000200528/*              - Fixed Deposits Held Under Lien                     */
017100200528/*                       - Upgrade to Midasplus                      */
017200200528/*                Core hooks added: APCTRANU01                       */
017300200528/*       BUG2480 - Send the reservation id to the back end           */
017400200528/*       BUG2687 - Prevent commitment control error on SEDE API.     */
017500200528/*       BG1105 - Increase the message array length                  */
017600200528/*       BG1953 - Switchable commitment control not implemented      */
017700200528/*                correctly - also restore CSC022 changes lost in    */
017800200528/*                merge                                              */
017900200528/*       NAD009 - Midasplus error reporting                          */
018000200528/*       CGP004 - Audit Reporting                                    */
018100200528/*       TCA046 - Database error occurs during insert of WI/WO due   */
018200200528/*                to wrong substring start position. Fix is to adjust*/
018300200528/*                according to changes made in SEDMWIPD/SEDMWOPD.    */
018400200528/*       CSC022 - Commitment Control Changes for MidasPlus.          */
018500200528/*       CAP084 - Synchronous calling of APIs                        */
018600200528/*                                                                   */
018700200528/*********************************************************************/
018800200528/**********  PGM        PARM(&SYS &USER &LANG &TRANSTYPE &UPDATEYN + */                  /*BUG2480*/
018900200528/**********               &BUFFER &MSGARR &APIRETC)                  */                  /*BUG2480*/
019000200528/**********  PGM        PARM(&SYS &USER &LANG &TRANSTYPE &UPDATEYN +
019100200528                          &BUFFER &BUFFER2 &BUFFER3 &BUFFER4 +
019200200528                          &BUFFER5 &BUFFER6 &BUFFER7 &BUFFER8 +
019300200528                          &BUFFER9 &MSGARR &APIRETC &RESERVID)       */         /*BUG4646 AR971184*/
019400200528/**********               &BUFFER &MSGARR &APIRETC &RESERVID)        */          /*BUG2480 BUG4646*/
019500200528             PGM        PARM(&SYS &USER &LANG &TRANSTYPE &UPDATEYN +
019600200528                          &BUFFER &BUFFER2 &BUFFER3 &BUFFER4 +
019700200528                          &BUFFER5 &BUFFER6 &BUFFER7 &BUFFER8 +
019800200528                          &BUFFER9 &MSGARR &APIRETC &RESERVID &APHEAD)                  /*AR971184*/
019900200528
020000200528             DCL        VAR(&SYS)       TYPE(*CHAR) LEN(2)
020100200528             DCL        VAR(&USER)      TYPE(*CHAR) LEN(10)
020200200528             DCL        VAR(&LANG)      TYPE(*CHAR) LEN(2)
020300200528             DCL        VAR(&TRANSTYPE) TYPE(*CHAR) LEN(4)
020400200528             DCL        VAR(&UPDATEYN)  TYPE(*CHAR) LEN(1)
020500200528             DCL        VAR(&BUFFER) TYPE(*CHAR) LEN(9999)
020600200528             DCL        VAR(&BUFFER2)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
020700200528             DCL        VAR(&BUFFER3)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
020800200528             DCL        VAR(&BUFFER4)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
020900200528             DCL        VAR(&BUFFER5)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
021000200528             DCL        VAR(&BUFFER6)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
021100200528             DCL        VAR(&BUFFER7)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
021200200528             DCL        VAR(&BUFFER8)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
021300200528             DCL        VAR(&BUFFER9)   TYPE(*CHAR) LEN(9999)                            /*BUG4646*/
021400200528/******      DCL        VAR(&MSGARR)    TYPE(*CHAR) LEN(2000)                      /*BG1105*/
021500200528             DCL        VAR(&MSGARR)    TYPE(*CHAR) LEN(9999)                      /*BG1105*/
021600200528             DCL        VAR(&APIRETC)   TYPE(*CHAR) LEN(1)
021700200528             DCL        VAR(&RESERVID) TYPE(*CHAR) LEN(15)                               /*BUG2480*/
021800200528             DCL        VAR(&CMTRTN) TYPE(*CHAR) LEN(10)
021900200528             DCL        VAR(&SWS)   TYPE(*CHAR) LEN(8)
022000200528             DCL        VAR(&MPHAS) TYPE(*CHAR) LEN(1)
022100200528             DCL        VAR(&JOBNO) TYPE(*CHAR) LEN(6)
022200200528             DCL        VAR(&JOBNAME) TYPE(*CHAR) LEN(10)                                 /*247277*/
022300200528             DCL        VAR(&JOBUSER) TYPE(*CHAR) LEN(10)                                 /*247277*/
022400200528             DCL        VAR(&TYPE ) TYPE(*CHAR) LEN(1)
022500200528             DCL        VAR(&DMVTYPE) TYPE(*CHAR) LEN(2)
022600200528             DCL        VAR(&SCCMTJOB) TYPE(*CHAR) LEN(256)                               /*CSC022*/
022700200528             DCL        VAR(&JBNM) TYPE(*CHAR) LEN(10)                                    /*CSC022*/
022800200528             DCL        VAR(&RTNCD) TYPE(*CHAR) LEN(7)                                    /*CSC022*/
022900200528             DCL        VAR(&OPTN1) TYPE(*CHAR) LEN(7)                                    /*CSC022*/
023000200528             DCL        VAR(&SAR) TYPE(*CHAR) LEN(6)                                      /*CSC022*/
023100200528             DCL        VAR(&SCSARD) TYPE(*CHAR) LEN(200)                                 /*CSC022*/
023200200528             DCL        VAR(&CSC022) TYPE(*CHAR) LEN(1) VALUE(' ')                        /*CSC022*/
023300200528             DCL        VAR(&CMTNUM) TYPE(*DEC) LEN(3 0)                                  /*CSC022*/
023400200528             DCL        VAR(&CMTJOB1) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
023500200528             DCL        VAR(&CMTJOB2) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
023600200528             DCL        VAR(&CMTJOB3) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
023700200528             DCL        VAR(&CMTJOB4) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
023800200528             DCL        VAR(&CMTJOB5) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
023900200528             DCL        VAR(&CMTJOB6) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
024000200528             DCL        VAR(&CMTJOB7) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
024100200528             DCL        VAR(&CMTJOB8) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
024200200528             DCL        VAR(&CMTJOB9) TYPE(*CHAR) LEN(10)                                 /*CSC022*/
024300200528             DCL        VAR(&CMTJOB10) TYPE(*CHAR) LEN(10)                                /*CSC022*/
024400200528             DCL        VAR(&CMTSKP) TYPE(*CHAR) LEN(1) VALUE(' ')                        /*CSC022*/
024500200528             DCL        VAR(&TRANSID)   TYPE(*CHAR) LEN(300)                             /*CGP004*/
024600200528/**********  DCL        VAR(&BNI002)   TYPE(*CHAR) LEN(1)            */          /*CRE023 BUG10837*/
024700200528             DCL        VAR(&CRE023)   TYPE(*CHAR) LEN(1)                               /*BUG10837*/
024800200528             DCL        VAR(&CRE015)   TYPE(*CHAR) LEN(1)                               /*BUG27488*/
024900200528/**********  DCL        VAR(&APHEAD) TYPE(*CHAR) LEN(200)            */          /*AR971184 CSD102*/
025000200528             DCL        VAR(&APHEAD) TYPE(*CHAR) LEN(318)                                 /*CSD102*/
025100200528             DCL        VAR(&COBFL)  TYPE(*CHAR) LEN(08)                               /*AR1021983*/
025200200528
025300200528/* Parameters for call to MLC0030                                    */
025400200528             DCL        VAR(&PARM)  TYPE(*CHAR) LEN(1000)
025500200528
025600200528             MONMSG     MSGID(CPF0000 MCH0000 RPG0000) EXEC(GOTO +
025700200528                          CMDLBL(ABNOR))
025800200528
025900200528             CHGJOB     LOG(4 00 *SECLVL) LOGCLPGM(*YES) SWS(00000000)
026000200528             CHGVAR     VAR(&COBFL) VALUE(%SST(&APHEAD 73 08))                         /*AR1021983*/
026100200528
026200200528             RTVDTAARA  DTAARA(MPHAS) RTNVAR(&MPHAS)
026300200528/**********  IF         COND(&MPHAS *NE 'A') THEN(DO)                 */               /*AR1021983*/
026400200528/**********  IF         COND((&MPHAS *NE 'A') *AND (&COBFL *NE +
026500200528                          'MIDASCOB')) THEN(DO)                       */      /*AR1021983 MD019466*/
026600200528             IF         COND((&MPHAS *NE 'A') *AND (&MPHAS *NE 'G') +
026700200528                          *AND (&COBFL *NE 'MIDASCOB')) THEN(DO)                        /*MD019466*/
026800200528                CHGVAR     VAR(&MSGARR) VALUE(' : : :Midas not in input +
026900200528                             cycle.  Entry prohibited:')
027000200528                GOTO       CMDLBL(END)
027100200528             ENDDO
027200200528
027300200528/* Reclaim resource                                                   */                  /*BG3913*/
027400200528             RCLRSC                                                                       /*BG3913*/
027500200528
027600200528 /* MPLUS_ERR is created by DBERRCTL */                                                   /*NAD009*/
027700200528             DLTDTAARA  DTAARA(QTEMP/MPLUS_ERR)                                           /*NAD009*/
027800200528             MONMSG     MSGID(CPF0000 MCH0000 RPG0000)                                    /*NAD009*/
027900200528                                                                                          /*NAD009*/
028000200528             CHGVAR     VAR(&CRE015) VALUE('N')                                         /*BUG27488*/
028100200528             CALLPRC    PRC(AOSARDR0) PARM(&RTNCD '*VERIFY' 'CRE015' &SCSARD)           /*BUG27488*/
028200200528             IF         COND(&RTNCD *EQ ' ') THEN(CHGVAR +
028300200528                          VAR(&CRE015) VALUE('Y'))                                      /*BUG27488*/
028400200528/**********  CHGVAR     VAR(&BNI002) VALUE('N')                                  /*CRE023 BUG10837*/
028500200528             CHGVAR     VAR(&CRE023) VALUE('N')                                         /*BUG10837*/
028600200528/**********  CALLPRC    PRC(AOSARDR0) PARM(&RTNCD '*VERIFY' 'BNI002' &SCSARD)*/  /*CRE023 BUG10837*/
028700200528             CALLPRC    PRC(AOSARDR0) PARM(&RTNCD '*VERIFY' 'CRE023' &SCSARD)           /*BUG10837*/
028800200528             IF         COND(&RTNCD *EQ '       ') THEN(DO)                               /*CRE023*/
028900200528/**********     CHGVAR     VAR(&BNI002) VALUE('Y')                    */         /*CRE023 BUG10837*/
029000200528                CHGVAR     VAR(&CRE023) VALUE('Y')                                      /*BUG10837*/
029100200528             ENDDO                                                                        /*CRE023*/
029200200528             IF         COND((&RTNCD *NE '       ') *AND (&RTNCD *NE +
029300200528                          '*NRF   ')) THEN(DO)                                            /*CRE023*/
029400200528                GOTO       CMDLBL(ABNOR)                                                  /*CRE023*/
029500200528             ENDDO                                                                        /*CRE023*/
029600200528                                                                                          /*CRE023*/
029700200528             CHGVAR     VAR(&CSC022) VALUE(' ')                                           /*CSC022*/
029800200528             CHGVAR     VAR(&RTNCD) VALUE('       ')                                      /*CSC022*/
029900200528             CHGVAR     VAR(&OPTN1) VALUE('*VERIFY')                                      /*CSC022*/
030000200528             CHGVAR     VAR(&SAR) VALUE('CSC022')                                         /*CSC022*/
030100200528                                                                                          /*CSC022*/
030200200528             CALLPRC    PRC(AOSARDR0) PARM(&RTNCD &OPTN1 &SAR &SCSARD)                    /*CSC022*/
030300200528                                                                                          /*CSC022*/
030400200528             IF         COND(&RTNCD *EQ '       ') THEN(DO)                               /*CSC022*/
030500200528             CHGVAR     VAR(&CSC022) VALUE('Y')                                           /*CSC022*/
030600200528             RTVDTAARA  DTAARA(SCCMTJOB (1 256)) RTNVAR(&SCCMTJOB)                        /*CSC022*/
030700200528             CHGVAR     VAR(&CMTNUM) VALUE(%SST(&SCCMTJOB 1 3))                           /*CSC022*/
030800200528             CHGVAR     VAR(&CMTJOB1) VALUE(%SST(&SCCMTJOB 4 10))                         /*CSC022*/
030900200528             CHGVAR     VAR(&CMTJOB2) VALUE(%SST(&SCCMTJOB 14 10))                        /*CSC022*/
031000200528             CHGVAR     VAR(&CMTJOB3) VALUE(%SST(&SCCMTJOB 24 10))                        /*CSC022*/
031100200528             CHGVAR     VAR(&CMTJOB4) VALUE(%SST(&SCCMTJOB 34 10))                        /*CSC022*/
031200200528             CHGVAR     VAR(&CMTJOB5) VALUE(%SST(&SCCMTJOB 44 10))                        /*CSC022*/
031300200528             CHGVAR     VAR(&CMTJOB6) VALUE(%SST(&SCCMTJOB 54 10))                        /*CSC022*/
031400200528             CHGVAR     VAR(&CMTJOB7) VALUE(%SST(&SCCMTJOB 64 10))                        /*CSC022*/
031500200528             CHGVAR     VAR(&CMTJOB8) VALUE(%SST(&SCCMTJOB 74 10))                        /*CSC022*/
031600200528             CHGVAR     VAR(&CMTJOB9) VALUE(%SST(&SCCMTJOB 84 10))                        /*CSC022*/
031700200528             CHGVAR     VAR(&CMTJOB10) VALUE(%SST(&SCCMTJOB 94 10))                       /*CSC022*/
031800200528                                                                                          /*CSC022*/
031900200528             RTVJOBA    JOB(&JBNM)                                                        /*BG1953*/
032000200528             IF         COND((&CMTNUM *GT 0) *AND (&CMTJOB1 *EQ +
032100200528                          &JBNM)) THEN(DO)                                                /*CSC022*/
032200200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
032300200528             ENDDO                                                                        /*CSC022*/
032400200528             IF         COND((&CMTNUM *GT 1) *AND (&CMTJOB2 *EQ +
032500200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
032600200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
032700200528             ENDDO                                                                        /*CSC022*/
032800200528             IF         COND((&CMTNUM *GT 2) *AND (&CMTJOB3 *EQ +
032900200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
033000200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
033100200528             ENDDO                                                                        /*CSC022*/
033200200528             IF         COND((&CMTNUM *GT 3) *AND (&CMTJOB4 *EQ +
033300200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
033400200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
033500200528             ENDDO                                                                        /*CSC022*/
033600200528             IF         COND((&CMTNUM *GT 4) *AND (&CMTJOB5 *EQ +
033700200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
033800200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
033900200528             ENDDO                                                                        /*CSC022*/
034000200528             IF         COND((&CMTNUM *GT 5) *AND (&CMTJOB6 *EQ +
034100200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
034200200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
034300200528             ENDDO                                                                        /*CSC022*/
034400200528             IF         COND((&CMTNUM *GT 6) *AND (&CMTJOB7 *EQ +
034500200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
034600200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
034700200528             ENDDO                                                                        /*CSC022*/
034800200528             IF         COND((&CMTNUM *GT 7) *AND (&CMTJOB8 *EQ +
034900200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
035000200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
035100200528             ENDDO                                                                        /*CSC022*/
035200200528             IF         COND((&CMTNUM *GT 8) *AND (&CMTJOB9 *EQ +
035300200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
035400200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
035500200528             ENDDO                                                                        /*CSC022*/
035600200528             IF         COND((&CMTNUM *GT 9) *AND (&CMTJOB10 *EQ +
035700200528                          &JBNM))    THEN(DO)                                             /*CSC022*/
035800200528             CHGVAR     VAR(&CMTSKP) VALUE('Y')                                           /*CSC022*/
035900200528             ENDDO                                                                        /*CSC022*/
036000200528                                                                                          /*CSC022*/
036100200528             ENDDO                                                                        /*CSC022*/
036200200528                                                                                          /*CSC022*/
036300200528/* SQL appears to set up commitment control *DFTACTGRP.  This needs  */
036400200528/* to be *JOB - so end it here, and start it again.                  */
036500200528             IF         COND((&CSC022 *NE 'Y') *OR (&CSC022 *EQ 'Y' +
036600200528                          *AND &CMTSKP *NE 'Y')) THEN(DO)                                 /*CSC022*/
036700200528             ENDCMTCTL
036800200528             MONMSG     MSGID(CPF0000)
036900200528
037000200528             CALL       PGM(SCCMTCTL) PARM('S' &CMTRTN)
037100200528             ENDDO                                                                        /*CSC022*/
037200200528
037300200528/* Check if the reservation ID dataarea exists, if not create it.  This will hold the */ /*BUG2480*/
037400200528/* reservation ID parameter                                                           */ /*BUG2480*/
037500200528             CHKOBJ     OBJ(QTEMP/GPRESERVID) OBJTYPE(*DTAARA)                           /*BUG2480*/
037600200528             MONMSG     MSGID(CPF9801) EXEC(CRTDTAARA +
037700200528                          DTAARA(QTEMP/GPRESERVID) TYPE(*CHAR) LEN(15))                  /*BUG2480*/
037800200528             CHGDTAARA  DTAARA(QTEMP/GPRESERVID) VALUE(&RESERVID)                        /*BUG2480*/
037900200528             DLTOVR     FILE(*ALL) LVL(*JOB)
038000200528
038100200528             OVRDBF     FILE(GPBSRIL0) OVRSCOPE(*JOB) SHARE(*NO)                          /*CGP010*/
038200200528             OVRDBF     FILE(GPBSRQL0) OVRSCOPE(*JOB) SHARE(*NO)                          /*CGP010*/
038300200528             OVRDBF     FILE(CADLFALL) OVRSCOPE(*JOB) SHARE(*NO)
038400200528             OVRDBF     FILE(OTPAYOVR) TOFILE(OTPAY) OVRSCOPE(*JOB) +
038500200528                          SHARE(*NO)
038600200528             OVRDBF     FILE(OTXL0) TOFILE(OTPAYXL0) OVRSCOPE(*JOB) +
038700200528                          SHARE(*NO)
038800200528             OVRDBF     FILE(SDCUSTL0) TOFILE(SDCUSTL0) +
038900200528                          OVRSCOPE(*JOB) SHARE(*NO)
039000200528             OVRDBF     FILE(SDPBDSLR) TOFILE(SDPBDSL0) +
039100200528                          OVRSCOPE(*JOB) SHARE(*NO)
039200200528             OVRDBF     FILE(SDCUSTLR) TOFILE(SDCUSTL0) +
039300200528                          OVRSCOPE(*JOB) SHARE(*NO)
039400200528             OVRDBF     FILE(SDCBRTLR) TOFILE(SDCBRTL1) +
039500200528                          OVRSCOPE(*JOB) SHARE(*NO)
039600200528             OVRDBF     FILE(PTYHSTPR) TOFILE(PTYHSTPD) +
039700200528                          OVRSCOPE(*JOB) SHARE(*NO)
039800200528             OVRDBF     FILE(SDSECSLR) TOFILE(SDSECSL0) +
039900200528                          OVRSCOPE(*JOB) SHARE(*NO)
040000200528             OVRDBF     FILE(PMPORTPD) TOFILE(PMPORTPD) +
040100200528                          OVRSCOPE(*JOB) SHARE(*NO)
040200200528             OVRDBF     FILE(GLBTNOL0) TOFILE(GLBTNOL0) +
040300200528                          OVRSCOPE(*JOB) SHARE(*NO)
040400200528             OVRDBF     FILE(GLJENHL0) TOFILE(GLJENHL0) +
040500200528                          OVRSCOPE(*JOB) SHARE(*NO)
040600200528             OVRDBF     FILE(GLJENHL3) TOFILE(GLJENHL3) +
040700200528                          OVRSCOPE(*JOB) SHARE(*NO)
040800200528             OVRDBF     FILE(GLJENPL4) TOFILE(GLJENPL4) +
040900200528                          OVRSCOPE(*JOB) SHARE(*NO)
041000200528             OVRDBF     FILE(GLCOLLX1) TOFILE(GLCOLLL1) +
041100200528                          OVRSCOPE(*JOB) SHARE(*NO)
041200200528             OVRDBF     FILE(CLOANLXX) TOFILE(CLOAN) OVRSCOPE(*JOB) +
041300200528                          SHARE(*NO)
041400200528             OVRDBF     FILE(FOCLTLXX) TOFILE(FOCLT) OVRSCOPE(*JOB) +
041500200528                          SHARE(*NO)
041600200528             OVRDBF     FILE(FCLTYLXX) TOFILE(FCLTY) OVRSCOPE(*JOB) +
041700200528                          SHARE(*NO)
041800200528             OVRDBF     FILE(FCLTYXFN) TOFILE(FCLTY) OVRSCOPE(*JOB) +
041900200528                          SHARE(*NO)
042000200528             OVRDBF     FILE(LEFCLTL9) TOFILE(LEFCLTL9) +
042100200528                          OVRSCOPE(*JOB) SHARE(*NO)
042200200528             OVRDBF     FILE(LEFCLTL2) TOFILE(LEFCLTL2) +
042300200528                          OVRSCOPE(*JOB) SHARE(*NO)
042400200528             OVRDBF     FILE(FCLTY) TOFILE(FCLTY) OVRSCOPE(*JOB) +
042500200528                          SHARE(*NO)
042600200528             OVRDBF     FILE(LELOAML3) TOFILE(LELOAML3) +
042700200528                          OVRSCOPE(*JOB) SHARE(*NO)
042800200528             OVRDBF     FILE(CLOAN) TOFILE(CLOAN) OVRSCOPE(*JOB) +
042900200528                          SHARE(*NO)
043000200528             OVRDBF     FILE(CLOANC) TOFILE(CLOANC) OVRSCOPE(*JOB) +
043100200528                          SHARE(*NO)                                                   /*MD021554A*/
043200200528             OVRDBF     FILE(LOAMD) TOFILE(LOAMS) OVRSCOPE(*JOB) +
043300200528                          SHARE(*NO)
043400200528             OVRDBF     FILE(LOAMS) TOFILE(LOAMS) OVRSCOPE(*JOB) +
043500200528                          SHARE(*NO)
043600200528             OVRDBF     FILE(LEREF) TOFILE(LEREF) OVRSCOPE(*JOB) +
043700200528                          SHARE(*NO)
043800200528             OVRDBF     FILE(LEFEEDL0) TOFILE(LEFEEDL0) +
043900200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*263942*/
044000200528             OVRDBF     FILE(LEFEEDL1) TOFILE(LEFEEDL1) +
044100200528                          OVRSCOPE(*JOB) SHARE(*NO)
044200200528             OVRDBF     FILE(SDLENOL1) TOFILE(SDLENOL1) +
044300200528                          OVRSCOPE(*JOB) SHARE(*NO)
044400200528             OVRDBF     FILE(SDLENOL0) TOFILE(SDLENOL0) +
044500200528                          OVRSCOPE(*JOB) SHARE(*NO)
044600200528             OVRDBF     FILE(FT101HL3) TOFILE(FT101HL3) +
044700200528                          OVRSCOPE(*JOB) SHARE(*NO)
044800200528             OVRDBF     FILE(FT101HL4) TOFILE(FT101HL4) +
044900200528                          OVRSCOPE(*JOB) SHARE(*NO)
045000200528             OVRDBF     FILE(FT101DL0) TOFILE(FT101DL0) +
045100200528                          OVRSCOPE(*JOB) SHARE(*NO)
045200200528             OVRDBF     FILE(TRADSDZ3) TOFILE(TRADSDY2) +
045300200528                          OVRSCOPE(*JOB) SHARE(*NO)
045400200528             OVRDBF     FILE(SEPCCD) TOFILE(SEPCCD) +
045500200528                          OVRSCOPE(*JOB) SHARE(*NO)
045600200528             OVRDBF     FILE(SEPCBD) TOFILE(SEPCBD) +
045700200528                          OVRSCOPE(*JOB) SHARE(*NO)
045800200528             OVRDBF     FILE(TRADSDY1) TOFILE(TRADSDY1) +
045900200528                          OVRSCOPE(*JOB) SHARE(*NO)
046000200528             OVRDBF     FILE(TRADSDY2) TOFILE(TRADSDY2) +
046100200528                          OVRSCOPE(*JOB) SHARE(*NO)
046200200528             OVRDBF     FILE(TRADS) TOFILE(TRADS) +
046300200528                          OVRSCOPE(*JOB) SHARE(*NO)
046400200528             OVRDBF     FILE(TRADSDZ2) TOFILE(TRADSDY2) +
046500200528                          OVRSCOPE(*JOB) SHARE(*NO)
046600200528             OVRDBF     FILE(BKPHD) TOFILE(BKPHD) +
046700200528                          OVRSCOPE(*JOB) SHARE(*NO)
046800200528             OVRDBF     FILE(BKPOS) TOFILE(BKPOS) +
046900200528                          OVRSCOPE(*JOB) SHARE(*NO)
047000200528             OVRDBF     FILE(SECTYZ1) TOFILE(SECTY) +
047100200528                          OVRSCOPE(*JOB) SHARE(*NO)
047200200528             OVRDBF     FILE(SECTYZ2) TOFILE(SECTY) +
047300200528                          OVRSCOPE(*JOB) SHARE(*NO)
047400200528             OVRDBF     FILE(SECTYZ3) TOFILE(SECTY) +
047500200528                          OVRSCOPE(*JOB) SHARE(*NO)
047600200528             OVRDBF     FILE(SECTY) TOFILE(SECTY) +
047700200528                          OVRSCOPE(*JOB) SHARE(*NO)
047800200528             OVRDBF     FILE(SECTYD) TOFILE(SECTYD) +
047900200528                          OVRSCOPE(*JOB) SHARE(*NO)
048000200528             OVRDBF     FILE(SECEO) TOFILE(SECEO) OVRSCOPE(*JOB) +
048100200528                          SHARE(*NO)                                                     /*BUG8953*/
048200200528             OVRDBF     FILE(FOPCC) TOFILE(FOPCC) OVRSCOPE(*JOB) +
048300200528                          SHARE(*NO)
048400200528
048500200528             OVRDBF     FILE(FOPCK) TOFILE(FOPCK) OVRSCOPE(*JOB) +
048600200528                          SHARE(*NO)
048700200528             OVRDBF     FILE(DEALS) TOFILE(DEALS) +
048800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                       /*BG6507*/
048900200528             OVRDBF     FILE(ZATNRGL1) OVRSCOPE(*JOB) SHARE(*NO)                         /*BUG8867*/
049000200528             OVRDBF     FILE(PSOLD) TOFILE(PSOLD) OVRSCOPE(*JOB) +
049100200528                          SHARE(*NO)                                                      /*241196*/
049200200528
049300200528             IF         COND(&TRANSTYPE = 'INTC') THEN(DO)
049400200528                OVRDBF     FILE(ABCOMPLL) TOFILE(ABCOMPLL) +
049500200528                          OVRSCOPE(*JOB) SHARE(*NO)
049600200528             ENDDO
049700200528
049800200528             IF         COND(&TRANSTYPE = 'IPAY') THEN(DO)
049900200528                OVRDBF     FILE(INPAY) SHARE(*NO)
050000200528                OVRDBF     FILE(INPAYXL0) SHARE(*NO)
050100200528             ENDDO
050200200528             OVRDBF     FILE(SDAULGL0) TOFILE(SDAULGL0) +
050300200528                          OVRSCOPE(*JOB) SHARE(*NO)
050400200528
050500200528             IF         COND(&TRANSTYPE = 'DPMV') THEN(DO)
050600200528/**********     CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 1956 2)) */             /*TCA046*/
050700200528/* Position of Transaction Type has shifted due to change in buffer length             */ /*CAP087*/
050800200528/**********     CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 1962 2)) */  /*TCA046*/ /*TCA046*/
050900200528/**********     CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 1998 2))  */ /*CGL035*/ /*CAP087*/
051000200528/**********     CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 1989 2)) */ /*CAP087*/ /*BUG9946*/
051100200528/**********     CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 2025 2)) */ /*BUG9946*/ /*CSW210*/
051200200528                CHGVAR     VAR(&DMVTYPE) VALUE(%SUBSTRING(&BUFFER 2230 2))                /*CSW210*/
051300200528                IF   COND(&DMVTYPE *NE 'RR' *AND &DMVTYPE *NE 'RP'  +
051400200528                        *AND &DMVTYPE *NE 'BL' *AND &DMVTYPE *NE 'BB'  +
051500200528                        *AND &DMVTYPE *NE 'WI' *AND &DMVTYPE *NE 'WO'  +
051600200528                        *AND &DMVTYPE *NE 'PL' *AND &DMVTYPE *NE 'PD'  +
051700200528                        *AND &DMVTYPE *NE 'DT') THEN(DO)                                 /*BUG9345*/
051800200528                   CHGVAR     VAR(&MSGARR) VALUE('DDDPMV::E:Invalid depot +
051900200528                          movement type.:')                                              /*BUG9345*/
052000200528                   GOTO       CMDLBL(END)                                                /*BUG9345*/
052100200528                ENDDO                                                                    /*BUG9345*/
052200200528             IF         COND((&DMVTYPE = 'RR') *OR (&DMVTYPE = 'RP') *OR +
052300200528                             (&DMVTYPE = 'PL') *OR (&DMVTYPE = 'PD') *OR +
052400200528                             (&DMVTYPE = 'BB') *OR (&DMVTYPE = 'BL') *OR +
052500200528                             (&DMVTYPE = 'DT')) THEN(CHGVAR VAR(&DMVTYPE) +
052600200528                             VALUE('MV'))                                                 /*CAP087*/
052700200528                CHGVAR     VAR(&TRANSTYPE) VALUE('DP' *CAT &DMVTYPE)
052800200528                OVRDBF     FILE(SECTYZ1) TOFILE(SECTY) +
052900200528                          OVRSCOPE(*JOB) SHARE(*NO)
053000200528                OVRDBF     FILE(SECTYZ2) TOFILE(SECTY) +
053100200528                          OVRSCOPE(*JOB) SHARE(*NO)
053200200528                OVRDBF     FILE(DPTMVDL1) SHARE(*NO)                                      /*CAP087*/
053300200528                OVRDBF     FILE(SEDMRPXX) TOFILE(DPTMVD) SHARE(*NO)                       /*CAP087*/
053400200528                OVRDBF     FILE(SEDMRPX1) TOFILE(DPTMVDY1) SHARE(*NO)                     /*CAP087*/
053500200528                OVRDBF     FILE(SEDMRPX2) TOFILE(DPTMVDY2) SHARE(*NO)                     /*CAP087*/
053600200528                OVRDBF     FILE(DPTMV)    OVRSCOPE(*JOB) SHARE(*NO)
053700200528                OVRDBF     FILE(SEPCCD)   OVRSCOPE(*JOB) SHARE(*NO)
053800200528                OVRDBF     FILE(DPTMVDY1) OVRSCOPE(*JOB) SHARE(*NO)
053900200528                OVRDBF     FILE(DPTMVDY2) OVRSCOPE(*JOB) SHARE(*NO)
054000200528                OVRDBF     FILE(DPTMVDZ1) TOFILE(DPTMVDY1) +
054100200528                          OVRSCOPE(*JOB) SHARE(*NO)
054200200528                OVRDBF     FILE(DPTMVDZ2) TOFILE(DPTMVDY2) +
054300200528                          OVRSCOPE(*JOB) SHARE(*NO)
054400200528                OVRDBF FILE(DPTMVDZ3) TOFILE(DPTMVDY2) +
054500200528                          OVRSCOPE(*JOB) SHARE(*NO)
054600200528             ENDDO
054700200528
054800200528 /********** IF         COND(&TRANSTYPE = 'AMAD') THEN(DO) */                             /*CRE026*/
054900200528             IF         COND(&TRANSTYPE = 'AMAD' *OR &TRANSTYPE = +
055000200528                          'ACMC' *OR &TRANSTYPE = 'ACMI'          +
055100200528                           *OR &TRANSTYPE = 'ACMN') THEN(DO)                              /*CRE026*/
055200200528                OVRDBF     FILE(ACCNTLXX) TOFILE(ACCBR) +
055300200528                          OVRSCOPE(*JOB) SHARE(*NO)
055400200528                OVRDBF     FILE(ACCNTL1) TOFILE(ACCNTL0) +
055500200528                          OVRSCOPE(*JOB) SHARE(*NO)
055600200528                OVRDBF     FILE(REIACXX) TOFILE(REIAC) +
055700200528                          OVRSCOPE(*JOB) SHARE(*NO)
055800200528                OVRDBF     FILE(RECOMXX) TOFILE(RECOM) +
055900200528                          OVRSCOPE(*JOB) SHARE(*NO)
056000200528 /**********    OVRDBF     FILE(REAPWDL1) TOFILE(REAPWDL0) +
056100200528                          OVRSCOPE(*JOB) SHARE(*NO) */                                    /*CSD101*/
056200200528                OVRDBF     FILE(ACNUMA) TOFILE(ACNUMA) +
056300200528                          OVRSCOPE(*JOB) SHARE(*NO)                                       /*244095*/
056400200528                IF         COND(&CRE015 *EQ 'Y') THEN(DO)                               /*BUG27488*/
056500200528                OVRDBF     FILE(ACCNT) TOFILE(ACCNT) +
056600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG27488*/
056700200528                ENDDO                                                                   /*BUG27488*/
056800200528             ENDDO
056900200528                                                                                          /*244095*/
057000200528             IF         COND(&TRANSTYPE = 'OPAY') THEN(DO)                                /*244095*/
057100200528                OVRDBF     FILE(ACNUMA) TOFILE(ACNUMA) +
057200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                       /*244095*/
057300200528             ENDDO                                                                        /*244095*/
057400200528
057500200528/* Add override to file FWDRT. */
057600200528             OVRDBF     FILE(FWDRT) TOFILE(FWDRT) OVRSCOPE(*JOB) +
057700200528                          SHARE(*NO)
057800200528/* Add override to file SEDEV. */                                                        /*BUG2687*/
057900200528/*           IF         COND(&TRANSTYPE = 'SEDE') THEN(DO)      */              /*BUG2687 BUG12411*/
058000200528/*           OVRDBF     FILE(SEDEV) SHARE(*NO)                  */              /*BUG2687 BUG12411*/
058100200528             IF         COND((&TRANSTYPE = 'SEDE') *OR +
058200200528                             (&TRANSTYPE = 'SECS')) THEN(DO)                            /*BUG12411*/
058300200528             OVRDBF     FILE(SEDEV) OVRSCOPE(*JOB) SHARE(*NO)                           /*BUG12411*/
058400200528             ENDDO                                                                       /*BUG2687*/
058500200528                                                                                          /*240412*/
058600200528/* Create copy of original file */                                                        /*240412*/
058700200528             IF         COND((&TRANSTYPE = 'CIRS') *OR +
058800200528                             (&TRANSTYPE = 'SIRS') *OR +
058900200528                             (&TRANSTYPE = 'FRA')  *OR +
059000200528                             (&TRANSTYPE = 'CACF')) THEN(DO)                              /*240412*/
059100200528             DLTF       FILE(QTEMP/DLPCSCRX)                                              /*240412*/
059200200528             MONMSG     MSGID(CPF0000 RPG0000)                                            /*240412*/
059300200528             CPYF       FROMFILE(DLPCSCPD) TOFILE(QTEMP/DLPCSCRX)   +
059400200528                          MBROPT(*REPLACE) CRTFILE(*YES)                                  /*240412*/
059500200528             ENDDO                                                                        /*240412*/
059600200528                                                                                          /*240412*/
059700200528/* Add override to file DEAMSDJ */                                                       /*BUG8069*/
059800200528             IF         COND(&TRANSTYPE = 'DEAM') THEN(DO)                               /*BUG8069*/
059900200528             OVRDBF     FILE(DEAMSDJ) TOFILE(DEAMSDJ) OVRSCOPE(*JOB) +
060000200528                          SHARE(*NO)                                                     /*BUG8069*/
060100200528             ENDDO                                                                       /*BUG8069*/
060200200528/* Add override to file DLDEALL5 */                                                     /*AR988155*/
060300200528             IF         COND(&TRANSTYPE = 'LDNI') THEN(DO)                              /*AR988155*/
060400200528             OVRDBF     FILE(DEALSALL) TOFILE(DEALSALL) OVRSCOPE(*JOB) +
060500200528                 SHARE(*NO)                                                             /*AR988155*/
060600200528             OVRDBF     FILE(MMDEALLL) TOFILE(MMDEALLL) OVRSCOPE(*JOB) +
060700200528                 SHARE(*NO)                                                             /*AR988155*/
060800200528             OVRDBF     FILE(DLDEALL5) TOFILE(DLDEALL5) OVRSCOPE(*JOB) +
060900200528                 SHARE(*NO)                                                             /*AR988155*/
061000200528             ENDDO                                                                      /*AR988155*/
061100200528/* Add override to file CPOSN. */                                                         /*CGL035*/
061200200528             IF         COND(&TRANSTYPE = 'PRCS') THEN(DO)                                /*CGL035*/
061300200528             OVRDBF     FILE(CPOSN) SHARE(*NO)                                            /*CGL035*/
061400200528             ENDDO                                                                        /*CGL035*/
061500200528                                                                                         /*CRE023*/
061600200528/**********  IF         COND(&BNI002 = 'Y') THEN(DO)                 */         /*CRE023 BUG10792*/
061700200528             IF         COND(&CRE023 = 'Y') THEN(DO)                                   /*BUG10837*/
061800200528/** Override the sharing of files that have been added for update.   */                  /*CRE023*/
061900200528/** This should prevent commitment problem.                          */                  /*CRE023*/
062000200528                IF         COND(&TRANSTYPE = 'BITP') THEN(DO)                            /*CRE023*/
062100200528                   OVRDBF     FILE(REMEMLL0) SHARE(*NO)                                  /*CRE023*/
062200200528                   OVRDBF     FILE(MEMOSL2) SHARE(*NO)                                   /*CRE023*/
062300200528                ENDDO                                                                    /*CRE023*/
062400200528/**********  ENDDO                                                   */         /*CRE023 BUG10792*/
062500200528             ENDDO                                                                     /*BUG10837*/
062600200528             OVRDBF     FILE(LEEIRDL5) SHARE(*NO) /*239969*/
062700200528             IF         COND(&TRANSTYPE = 'LDNI') THEN(DO) /*MD045874*/
062800200528                OVRDBF     FILE(REHISBL) OVRSCOPE(*JOB) SHARE(*NO) /*MD045874*/
062900200528             ENDDO      /*MD045874*/
063000200528                                                                                          /*CAP212*/
063100200528             IF         COND(&TRANSTYPE = 'FTNT') THEN(DO)                                /*CAP212*/
063200200528                OVRDBF     FILE(NTRAN) OVRSCOPE(*JOB) SHARE(*NO)                          /*CAP212*/
063300200528             ENDDO                                                                        /*CAP212*/
063400200528                                                                                         /*CRE023*/
063500200528/*/COPY WNCPYSRC,APCTRANU01                                          */
063600200528
063700200528             OVRDBF     FILE(MUSER) TOFILE(MUSER) OVRSCOPE(*JOB) +
063800200528                          SHARE(*NO)                                                     /*CRE026*/
063900200528             OVRDBF     FILE(MBRBS) TOFILE(MBRBS) OVRSCOPE(*JOB) +
064000200528                          SHARE(*NO)                                                     /*CRE026*/
064100200528             OVRDBF     FILE(MBROS) TOFILE(MBROS) OVRSCOPE(*JOB) +
064200200528                          SHARE(*NO)                                                     /*CRE026*/
064300200528             OVRDBF     FILE(MCMPS) TOFILE(MCMPS) OVRSCOPE(*JOB) +
064400200528                          SHARE(*NO)                                                     /*CRE026*/
064500200528             OVRDBF     FILE(SDTICSLR) TOFILE(SDTICSL0) +
064600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
064700200528             OVRDBF     FILE(SDCMRKLR) TOFILE(SDCMRKL1) +
064800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
064900200528             OVRDBF     FILE(SDACUSLR) TOFILE(SDACUSL1) +
065000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
065100200528             OVRDBF     FILE(SDCFCDLR) TOFILE(SDCFCDL1) +
065200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
065300200528             OVRDBF     FILE(SDCHEQLR) TOFILE(SDCHEQL1) +
065400200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
065500200528             OVRDBF     FILE(SDCRWALR) TOFILE(SDCRWAL1) +
065600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
065700200528             OVRDBF     FILE(SDFOCSLR) TOFILE(SDFOCSL1) +
065800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
065900200528             OVRDBF     FILE(SDPLCSLR) TOFILE(SDPLCSL0) +
066000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
066100200528             OVRDBF     FILE(SDCMRKL0) TOFILE(SDCMRKL0) +
066200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
066300200528             OVRDBF     FILE(SDACUSL0) TOFILE(SDACUSL0) +
066400200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
066500200528             OVRDBF     FILE(SDCFCDL0) TOFILE(SDCFCDL0) +
066600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
066700200528             OVRDBF     FILE(SDCHEQL0) TOFILE(SDCHEQL0) +
066800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
066900200528             OVRDBF     FILE(SDSAFEL0) TOFILE(SDSAFEL0) +
067000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
067100200528             OVRDBF     FILE(SDPLCSL0) TOFILE(SDPLCSL0) +
067200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
067300200528             OVRDBF     FILE(SDFOX1LR) TOFILE(SDFOX1L0) +
067400200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
067500200528             OVRDBF     FILE(SDCUX2LR) TOFILE(SDCUX2L0) +
067600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CSD079*/
067700200528             OVRDBF     FILE(SDCUX1LR) TOFILE(SDCUX1L0) +
067800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CSD079*/
067900200528             OVRDBF     FILE(SDSECSL1) TOFILE(SDSECSL1) +
068000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
068100200528             OVRDBF     FILE(SDYLDRBD) TOFILE(SDYLDRL0) +
068200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                      /*CRE026*/
068300200528                                                                                         /*CRE026*/
068400200528             OVRDBF     FILE(SDALTNL0) TOFILE(SDALTNL0) +
068500200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG22550*/
068600200528                                                                                        /*BUG22550*/
068700200528             OVRDBF     FILE(SDCSDRL0) TOFILE(SDCSDRL0) +
068800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG12213*/
068900200528             OVRDBF     FILE(SDCBRTL1) TOFILE(SDCBRTL1) +
069000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG14195*/
069100200528                                                                                        /*BUG14288*/
069200200528             OVRDBF     FILE(MMEIRDL0) TOFILE(MMEIRDL0) +
069300200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG14288*/
069400200528                                                                                        /*BUG14288*/
069500200528             OVRDBF     FILE(SDNOSTL0) TOFILE(SDNOSTL0) +
069600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG14457*/
069700200528                                                                                        /*BUG22219*/
069800200528             OVRDBF     FILE(LEFEEDLH) TOFILE(LEFEEDLH) +
069900200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*BUG22219*/
070000200528                                                                                        /*AR868657*/
070100200528             OVRDBF     FILE(PMPORTL1) OVRSCOPE(*JOB) SHARE(*NO)                        /*AR868657*/
070200200528                                                                                        /*AR868657*/
070300200528             OVRDBF     FILE(LEPDUELC) TOFILE(LEPDUELC) +
070400200528                          OVRSCOPE(*JOB) SHARE(*NO)                                    /*AR1079502*/
070500200528             OVRDBF     FILE(LEPDUELB) TOFILE(LEPDUELB) +
070600200528                          OVRSCOPE(*JOB) SHARE(*NO)                                    /*AR1094967*/
070700200528             OVRDBF     FILE(LEPDUELE) TOFILE(LEPDUELE) +
070800200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*MD050018*/
070900200528             OVRDBF     FILE(LEPDUEL6) TOFILE(LEPDUEL6) +
071000200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*MD050018*/
071100200528             OVRDBF     FILE(LEPDUFLA) TOFILE(LEPDUFLA) +
071200200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*MD050018*/
071300200528             OVRDBF     FILE(LEPDUFLE) TOFILE(LEPDUFLE) +
071400200528                          OVRSCOPE(*JOB) SHARE(*NO)                                     /*MD050018*/
071500200528/* Log call to APCTRANVU */                                                              /*CGP004*/
071600200528                                                                                         /*CGP004*/
071700200528             CALL       PGM(GPAUUIUPD) PARM('V' &SYS &USER &LANG +
071800200528                          &TRANSTYPE &UPDATEYN &TRANSID &BUFFER)                         /*CGP004*/
071900200528                                                                                         /*CGP004*/
072000200528/* Call the multilanguage initiation program to put in ML overrides */
072100200528/* before calling APTRANVU                                          */
072200200528/**********  CHGVAR     VAR(&PARM) VALUE(&UPDATEYN)                  */                  /*BUG2480*/
072300200528             CHGVAR     VAR(&PARM) VALUE(&UPDATEYN *CAT &RESERVID)                       /*BUG2480*/
072400200528/**********  CALL       PGM(MLC0030) PARM('APTRANVU' &LANG &SYS +
072500200528                          &TRANSTYPE &PARM &USER &BUFFER &BUFFER2 +
072600200528                          &BUFFER3 &BUFFER4 &BUFFER5 &BUFFER6 +
072700200528                          &BUFFER7 &BUFFER8 &BUFFER9 +
072800200528                          &MSGARR &APIRETC)                          */         /*BUG4646 AR971184*/
072900200528/**********               &TRANSTYPE &PARM &USER &BUFFER &MSGARR +   */                  /*BUG4646*/
073000200528/**********               &APIRETC)                                  */                  /*BUG4646*/
073100200528             CALL       PGM(MLC0030) PARM('APTRANVU' &LANG &SYS +
073200200528                          &TRANSTYPE &PARM &USER &BUFFER &BUFFER2 +
073300200528                          &BUFFER3 &BUFFER4 &BUFFER5 &BUFFER6 +
073400200528                          &BUFFER7 &BUFFER8 &BUFFER9 +
073500200528                          &MSGARR &APIRETC &APHEAD)                                     /*AR971184*/
073600200528
073700200528             IF         COND(&TRANSTYPE = 'AMAD' *OR &TRANSTYPE = +
073800200528                          'ACMC' *OR &TRANSTYPE = 'ACMI'          +
073900200528                           *OR &TRANSTYPE = 'ACMN') THEN(DO)                            /*MD023834*/
074000200528                        DLTOVR     FILE(ACCNTL1) LVL(*JOB)                              /*MD023834*/
074100200528                        MONMSG     MSGID(CPF0000)                                       /*MD023834*/
074200200528             ENDDO                                                                      /*MD023834*/
074300200528                                                                                        /*MD023834*/
074400200528             RTVJOBA    SWS(&SWS)
074500200528             IF         COND(%SUBSTRING(&SWS 7 2) = '11') THEN(GOTO +
074600200528                          CMDLBL(ABNOR))
074700200528
074800200528             GOTO       CMDLBL(END)
074900200528 ABNOR:
075000200528             CHGVAR     VAR(&MSGARR) VALUE(':::Database error has +
075100200528                          occurred in Midas. Please inform a Midas +
075200200528                          System operator:')
075300200528/********    RTVJOBA    NBR(&JOBNO) TYPE(&TYPE)                                            *247277*/
075400200528             RTVJOBA    JOB(&JOBNAME) USER(&JOBUSER) NBR(&JOBNO) +
075500200528                          TYPE(&TYPE)                                                     /*247277*/
075600200528             IF         COND(&TYPE = '0') THEN(DO)
075700200528/******         SNDMSG     MSG('APCTRANVU failed: ' *CAT &SYS *BCAT +                       247277*/
075800200528/******                   &USER *BCAT &TRANSTYPE *TCAT '.  Please +                         247277*/
075900200528/******                   check the job log for ' *CAT &JOBNO *TCAT +                       247277*/
076000200528/******                   '/QUSER/QZDASOINIT') TOMSGQ(MOPERQ)                               247277*/
076100200528             SNDMSG     MSG('APCTRANVU failed: ' *CAT &SYS *BCAT +
076200200528                          &USER *BCAT &TRANSTYPE *TCAT '.  Please +
076300200528                          check the job log for ' *CAT &JOBNO *TCAT +
076400200528                          '/' *CAT &JOBUSER *TCAT '/' *CAT +
076500200528                          &JOBNAME) TOMSGQ(MOPERQ)                                        /*247277*/
076600200528             MONMSG     MSGID(CPF0000)
076700200528             ENDDO
076800200528             IF         COND(&APIRETC = ' ') THEN(DO)
076900200528                CHGVAR     VAR(&APIRETC) VALUE('0')
077000200528             ENDDO
077100200528 END:
077200200528 /* Check whether DBERRCTL has been called */                                             /*NAD009*/
077300200528             CHKOBJ     OBJ(QTEMP/MPLUS_ERR) OBJTYPE(*DTAARA)                             /*NAD009*/
077400200528             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MP_OK))                           /*NAD009*/
077500200528/**********  CHGVAR     VAR(&APIRETC) VALUE('0')                               */ /*NAD009 BUG4821*/
077600200528/**********  CHGVAR     VAR(&APIRETC) VALUE('1')                               */ /*BUG4821 BG7008*/
077700200528             CHGVAR     VAR(&APIRETC) VALUE('0')                                          /*BG7008*/
077800200528MP_OK:                                                                                    /*NAD009*/
077900200528 /* Check for any unhandled errors   */
078000200528             IF         COND(&APIRETC = '0' *AND &MSGARR = *BLANK) +
078100200528                          THEN(DO)
078200200528                CHGVAR     VAR(&MSGARR) VALUE(':::Database error has +
078300200528                          occurred in Midas. Please inform a Midas +
078400200528                          System operator:')
078500200528/********       RTVJOBA    NBR(&JOBNO) TYPE(&TYPE)                                         *247277*/
078600200528             RTVJOBA    JOB(&JOBNAME) USER(&JOBUSER) NBR(&JOBNO) +
078700200528                          TYPE(&TYPE)                                                     /*247277*/
078800200528/******         SNDMSG     MSG('APCTRANVU failed:' *CAT &SYS *BCAT +                       *247277*/
078900200528/******                   &USER *BCAT &TRANSTYPE *TCAT '.  Please +                        *247277*/
079000200528/******                   check the job log for ' *CAT &JOBNO *TCAT +                      *247277*/
079100200528/******                   '/QUSER/QZDASOINIT') TOMSGQ(MOPERQ)                              *247277*/
079200200528             SNDMSG     MSG('APCTRANVU failed:' *CAT &SYS *BCAT +
079300200528                          &USER *BCAT &TRANSTYPE *TCAT '.  Please +
079400200528                          check the job log for ' *CAT &JOBNO *TCAT +
079500200528                          '/' *CAT &JOBUSER *TCAT '/' *CAT +
079600200528                          &JOBNAME) TOMSGQ(MOPERQ)                                        /*247277*/
079700200528                MONMSG     MSGID(CPF0000)
079800200528             ENDDO
079900200528             RCLACTGRP  ACTGRP(*ELIGIBLE)                                                 /*238091*/
080000200528             ENDPGM
