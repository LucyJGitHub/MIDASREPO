     H            Y
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas BU UPdate CLINTCB for Global Ref Flds')          *
     F********************************************************************
     F*                                                                  *
     F*  Midas STANDING DATA MODULE
     F*                                                                  *
     F*     NETMIDAS - BACKGROUND UPDATE OF CLINT FILE                   *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. BUG23967           Date 13May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01230             Date 07/11/89              *S01230
     F*                                                                  *
     F********************************************************************
      *  CER059 - German Feature Upgrade to Delhi                     *
      *     BUG23967 - Add Local Industry Code Field. (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*     S01230 - STANDARDISE PROGRAMS                                *S01230
     F********************************************************************S01230
     F*                                                                  *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                          *
     F*                                                                  *
     F*       30      CHAIN CLINT FAILED/ERROR                           *
     F*       31      ERROR ON CLINT FILE                                *
     F*       32      CHAIN CLINT FAILED/ERROR                           *
     F*                                                                  *
     F********************************************************************
     FCLINT   UF  E           K        DISK
     F                                              KCOMIT
     F            CLINTCAF                          KIGNORE
     F            CLINTCCF                          KIGNORE
     F            CLINTC1F                          KIGNORE
     F            CLINTSEF                          KIGNORE
      /EJECT
     E* Description     : Copyright notice for inclusion in all progra    S01230
     E*                                                                   S01230
     E********************************************************************S01230
     E                    CPY@    1   1 80               Copyright     arrS01230
     E********************************************************************S01230
      /EJECT                                                              S01230
     I*                                                                   S01230
     I* Description     : Copyright notice for inclusion in all programs  S01230
     I*                                                                   S01230
     IA@CPY       DS                                                      S01230
     I* Copyright array                                                   S01230
     I                                        1  80 CPY@                  S01230
     I*                                                                   S01230
      /EJECT                                                              S01230
     C*
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7        RETURN CODE
     C                     PARM           WCNUM   6        CUSTOMER NO.
     C                     PARM           WGREF  12        GLOBAL REF.
     C                     PARM           WGCLS   3        GLOBAL CLASS
     C                     PARM           WGIDU   3        GLOBAL IND CODE
     C                     PARM           WGINS   3        GLOBAL INST COD
     C                     PARM           WCHTP   1        TYPE OF LST CHG
     C                     PARM           WLCD    50       LAST CHG DATE
     C*
     C* DEFINE KEY TO CLINT FILE
     C*
     C           KEY       KLIST
     C                     KFLD           CNUM
     C                     KFLD           RCDT
     C                     MOVE 'A'       RCDT
     C*
      /EJECT
     C****************************************************************
     C*
     C*   M A I N L I N E   P R O G R A M
     C*
     C****************************************************************
     C*
     C* RECORD HAS BEEN CHANGED, RETRIEVE RECORD FROM FILE
     C*
     C           WCHTP     IFEQ 'A'
     C                     MOVE WCNUM     CNUM
     C           KEY       CHAINCLINT                30    CHAIN FAILED
     C*
     C* IF RECORD FOUND, MOVE RECEIVED PARAMETERS INTO FILE FIELDS
     C* AND UPDATE
     C*
     C           *IN30     IFEQ '0'
     C                     MOVE WCNUM     CNUM
     C                     MOVE WGREF     GREF
     C                     MOVE WGCLS     GCLS
     C                     MOVE WGIDU     GIDU
     C                     MOVE WGINS     GINS
     C                     MOVE WCHTP     CHTP
     C                     Z-ADDWLCD      LCD
     C                     UPDATCLINTCBF               30  ERROR
     C                     END
     C*
     C* IF RECORD NOT FOUND OR ERROR OCCURRED ON UPDATE SET ERROR
     C* PARAMETER
     C*
     C           *IN30     IFEQ '1'
     C                     MOVE '*ERROR*' P0RTN
     C                     END
     C*
     C* RECORD IS NOT A CHANGED RECORD
     C*
     C                     END
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
** CPY@     : Copyright notice for inclusion in all programs           grams
(c) Misys International Banking Systems Ltd. 2001
