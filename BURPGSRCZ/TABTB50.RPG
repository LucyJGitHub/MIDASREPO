      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas BU C Lending ICD BackGnd Upd')
     F********************************************************************
     F*                                                                  *
     F*  Midas  STANDING DATA MODULE
     F*                                                                  *
     F*     TABTB50 - BACKGROUND UPDATE OF TABTB50 FILE                  *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*     LAST AMEND NO. S01230             DATE 07/11/89              *S01230
     F*     PREV AMEND NO. S01229             DATE 20/10/89              *S01229
     F*                    E18424             DATE 25/05/89              *S01229
     F*                                                                  *
     F********************************************************************
     F*     S01230  -  STANDARDISE PROGRAMS                              *S01230
     F*     S01229  -  SYNON FIELD NAME CHANGES                          *S01229
     F*     E18424  -  RE-INSTATED LINE SO THAT EVENTS TO END OF BOOK    *E18424
     F*                WOULD BE UPDATED.                                 *E18424
     F********************************************************************S01230
     F*                                                                  *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                          *
     F*                                                                  *
     F*       30      CHAIN TABTB50 FAILED/ERROR                         *
     F*       31      ERROR ON TABTB50 FILE                              *
     F*       32      CHAIN TABLETX FAILED/ERROR                         *
     F*                                                                  *
     F********************************************************************
     FTABTB50 UF  E           K        DISK
     F                                              KCOMIT
     FTABLETA UF  E           K        DISK
     F                                              KCOMIT
     FTABLETXLUF  E           K        DISK
     F                                              KCOMIT
      /EJECT
     E* Description     : Copyright notice for inclusion in all progra    S01230
     E*                                                                   S01230
     E********************************************************************S01230
     E                    CPY@    1   1 80               Copyright     arrS01230
     E********************************************************************S01230
      /EJECT                                                              S01230
     I*
     I* RENAME RECORD ID ON HEADER FILE TO AVOID OVERWRITING
     I*
     ITABLETAF
     I              RECT                            RECTA
     I*                                                                   S01230
     I* Description     : Copyright notice for inclusion in all programs  S01230
     I*                                                                   S01230
     IA@CPY       DS                                                      S01230
     I* Copyright array                                                   S01230
     I                                        1  80 CPY@                  S01230
     I*                                                                   S01230
      /EJECT
     C*
     C           *ENTRY    PLIST
      *
     C                     PARM           WLCD    50       LAST CHANGE DATE
     C*********************PARM           WCHTP   1        LAST CHANGE TYPS01229
     C*********************PARM           WBRLF   1        BASE RATE CHANGS01229
     C*********************PARM           WEEOB   1        EVENTS E/BOOK  S01229
     C                     PARM           WTYLC   1        LAST CHANGE TYPS01229
     C                     PARM           WBRCF   1        BASE RATE CHANGS01229
     C                     PARM           WGEEB   1        EVENTS E/BOOK  S01229
     C                     PARM           WBTIN   1        BILLING/TELEX DY
     C*********************PARM           WLARG  110       LARGE AMOUNT   S01229
     C*********************PARM           WELAC   50       END/LAST ACT PES01229
     C*********************PARM           WPDUE1  30       PAST DUE 1     S01229
     C*********************PARM           WPDUE2  30       PAST DUE 2     S01229
     C*********************PARM           WPDUE3  30       PAST DUE 3     S01229
     C*********************PARM           WPDUE4  30       PAST DUE 4     S01229
     C*********************PARM           WPDUE5  30       PAST DUE 5     S01229
     C*********************PARM           WPDUE6  30       PAST DUE 6     S01229
     C*********************PARM           WPDUE7  30       PAST DUE 7     S01229
     C*********************PARM           WPDUE8  30       PAST DUE 8     S01229
     C*********************PARM           WBDAY   20       DEF. BILLING DYS01229
     C*********************PARM           WHIST   20       HISTORIC RTN   S01229
     C                     PARM           WLGAM  110       LARGE AMOUNT   S01229
     C                     PARM           WELAP   50       END/LAST ACT PES01229
     C                     PARM           WPDN1   30       PAST DUE 1     S01229
     C                     PARM           WPDN2   30       PAST DUE 2     S01229
     C                     PARM           WPDN3   30       PAST DUE 3     S01229
     C                     PARM           WPDN4   30       PAST DUE 4     S01229
     C                     PARM           WPDN5   30       PAST DUE 5     S01229
     C                     PARM           WPDN6   30       PAST DUE 6     S01229
     C                     PARM           WPDN7   30       PAST DUE 7     S01229
     C                     PARM           WPDN8   30       PAST DUE 8     S01229
     C/COPY WNCPYSRC,TABTB50C01
     C                     PARM           WDBDY   20       DEF. BILLING DYS01229
     C/COPY WNCPYSRC,TABTB50C02
     C                     PARM           WHRPR   20       HISTORIC RTN   S01229
     C                     PARM           P0RTN   7        RETURN CODE
     C*
      /EJECT
     C****************************************************************
     C*
     C*   M A I N L I N E   P R O G R A M
     C*
     C****************************************************************
     C*
     C* IF RECORD HAS BEEN CHANGED, RETRIEVE RECORD FROM FILE
     C*
     C***********WCHTP     IFEQ 'A'                                       S01229
     C           WTYLC     IFEQ 'A'                                       S01229
     C                     READ TABTB50F                 30NO RECORDS
     C*
     C* IF RECORD FOUND, MOVE RECEIVED PARAMETERS INTO FILE FIELDS
     C* AND UPDATE
     C*
     C           *IN30     IFEQ '0'
     C                     Z-ADD1         RECT
     C                     Z-ADD50        RCDE
     C*********************MOVE WBRLF     BRLF                            S01229
     C                     MOVE WBRCF     BRLF                            S01229
     C                     MOVE WBTIN     BTIN
     C*********************Z-ADDWLARG     LARG                            S01229
     C*********************Z-ADDWELAC     ELAC                            S01229
     C*********************Z-ADDWPDUE1    PDUE1                           S01229
     C*********************Z-ADDWPDUE2    PDUE2                           S01229
     C*********************Z-ADDWPDUE3    PDUE3                           S01229
     C*********************Z-ADDWPDUE4    PDUE4                           S01229
     C*********************Z-ADDWPDUE5    PDUE5                           S01229
     C*********************Z-ADDWPDUE6    PDUE6                           S01229
     C*********************Z-ADDWPDUE7    PDUE7                           S01229
     C*********************Z-ADDWPDUE8    PDUE8                           S01229
     C*********************Z-ADDWBDAY     BDAY                            S01229
     C                     Z-ADDWLGAM     LARG                            S01229
     C                     Z-ADDWELAP     ELAC                            S01229
     C                     Z-ADDWPDN1     PDUE1                           S01229
     C                     Z-ADDWPDN2     PDUE2                           S01229
     C                     Z-ADDWPDN3     PDUE3                           S01229
     C                     Z-ADDWPDN4     PDUE4                           S01229
     C                     Z-ADDWPDN5     PDUE5                           S01229
     C                     Z-ADDWPDN6     PDUE6                           S01229
     C                     Z-ADDWPDN7     PDUE7                           S01229
     C                     Z-ADDWPDN8     PDUE8                           S01229
     C                     Z-ADDWDBDY     BDAY                            S01229
     C*******              MOVE WEEOB     EEOB
     C*********************MOVE WEEOB     EEOB                     E18424 S01229
     C                     MOVE WGEEB     EEOB                     E18424 S01229
     C*******              Z-ADDWHIST     ????
     C*********************MOVE WCHTP     CHTP                            S01229
     C                     MOVE WTYLC     CHTP                            S01229
     C                     Z-ADDWLCD      LCD
     C                     UPDATTABTB50F               30  ERROR
     C                     END
     C*
     C* IF RECORD NOT FOUND OR ERROR OCCURRED ON UPDATE SET ERROR
     C* PARAMETER
     C*
     C           *IN30     IFEQ '1'
     C                     MOVE '*ERROR*' P0RTN
     C                     END
     C*
     C* RECORD IS NOT A CHANGED RECORD
     C*
     C                     END
     C*
     C* IF RECORD HAS BEEN DELETED FROM THE NEW FILE, RETRIEVE IT
     C* FROM TABTB50
     C*
     C***********WCHTP     IFEQ 'D'                                       S01229
     C           WTYLC     IFEQ 'D'                                       S01229
     C                     READ TABTB50F                 30NO RECORDS
     C*
     C* IF RECORD FOUND, UPDATE RELEVANT FIELDS (WE DON'T ACTUALLY
     C* DELETE ANY RECORDS FROM THE OLD FILES)
     C*
     C           *IN30     IFEQ '0'
     C                     MOVE '*'       RECI
     C*********************MOVE WCHTP     CHTP                            S01229
     C                     MOVE WTYLC     CHTP                            S01229
     C                     Z-ADDWLCD      LCD
     C                     UPDATTABTB50F               30  ERROR
     C                     END
     C*
     C* IF RECORD NOT FOUND OR ERROR OCCURRED ON UPDATE SET ERROR
     C* PARAMETER
     C*
     C           *IN30     IFEQ '1'
     C                     MOVE '*ERROR*' P0RTN
     C                     END
     C*
     C                     END
     C*
     C* IF NO ERRORS HAVE OCCURRED ON TABTB50 UPDATE
     C*
     C           P0RTN     IFEQ *BLANKS
     C*
     C* RETRIEVE OLD TRAILER FILE RECORD
     C*
     C           '01'      CHAINTABLETXF             32    CHAIN FAILED
     C*
     C* IF CHAIN TO FILE SUCCESSFUL
     C*
     C           *IN32     IFEQ '0'
     C*
     C* IF FIRST ACCESS TO THE FILE THEN GET HEADER RECORD
     C*
     C           NINS      ANDEQ0
     C           NAMD      ANDEQ0
     C           NDEL      ANDEQ0
     C*
     C                     READ TABLETAF                 32  EOF
     C*
     C* IF HEADER RECORD FOUND THEN SET PRINT INDICATOR AND UPDATE
     C*
     C           *IN32     IFEQ '0'
     C                     ADD  1         INSC
     C                     UPDATTABLETAF               32    ERROR
     C                     END
     C*
     C                     END
     C*
     C* IF NO ERRORS
     C*
     C           *IN32     IFEQ '0'
     C*
     C* UPDATE AS APPROPRIATE THE NUMBER OF INSERTS,AMENDS OR DELETES
     C* ON THE TRAILER FILE
     C*
     C***********WCHTP     IFEQ 'A'                                       S01229
     C           WTYLC     IFEQ 'A'                                       S01229
     C                     ADD  1         NAMD
     C                     END
     C*
     C***********WCHTP     IFEQ 'D'                                       S01229
     C           WTYLC     IFEQ 'D'                                       S01229
     C                     ADD  1         NDEL
     C                     END
     C*
     C                     UPDATTABLETXF               32    ERROR
     C*
     C                     END
     C*
     C* CHECK FOR ANY ERRORS AND SET ERROR PARAMETER FOR RETURN TO
     C* NEW FILE MAINTENANCE PROGRAM
     C*
     C           *IN32     IFEQ '1'
     C                     MOVE '*ERROR*' P0RTN
     C                     END
     C*
     C                     END
     C*
     C                     SETON                     LR
     C                     RETRN
     C*
** CPY@     : Copyright notice for inclusion in all programs           grams
(c) Misys International Banking Systems Ltd. 2001
