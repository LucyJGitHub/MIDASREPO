/*STD    CLPBASEBND                                                  */
/*EXI    TEXT('Midas CB Check Dashboard for unauthorised')           */
/*********************************************************************/
/*                                                                   */
/*       Midas - Close of Business                                   */
/*                                                                   */
/*       CBC001002 - Check Dashboard for unauthorised                */
/*                                                                   */
/*       (c) Misys International Banking Systems Ltd. 2015           */
/*                                                                   */
/*       Last Amend No. MD033971 *CREATE   Date 15May15              */
/*       Prev Amend No. nnnnnnnn           Date ddMmmyy              */
/*                                                                   */
/*-------------------------------------------------------------------*/
/*                                                                   */
/*       MD033971 - When COB is autoscheduled, unauthorized          */
/*                  transactions are not checked.                    */
/*                                                                   */
/*********************************************************************/
             PGM
 
             DCL        VAR(&SBS) TYPE(*CHAR) LEN(2)
             DCLF       FILE(V_DASHACTN)
 
             RTVDTAARA  DTAARA(SDSTAT (6 2)) RTNVAR(&SBS)
READ:
             RCVF
             MONMSG     MSGID(CPF0864) EXEC(GOTO CMDLBL(END))
             IF         COND((&DLMSID *EQ &SBS) *AND (&DLVAL *GT 0) +
                          *AND (&DLUATH *EQ 'Y')) THEN(GOTO +
                          CMDLBL(ERROR))
             GOTO       CMDLBL(READ)
 
ERROR:      CHGJOB     SWS(XXXXXX11)
            SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Program +
                         CBC001002 ended abnormally - Unauthorized +
                         transactions') TOMSGQ(MOPERQ)
            MONMSG     MSGID(CPF0000 MCH0000)
 
END:
     ENDPGM
