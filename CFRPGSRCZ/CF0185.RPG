     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CF Obtain TRAM System ID to Action')
     F*****************************************************************
     F*                                                               *
     F*     Midas  CONFIRMATION MATCHING                          *
     F*                                                               *
     F*     CF0185 - OBTAIN TRAM SYSTEM ID TO ACTI                    *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01184             Date 15Dec89               *
      *                                    Date DDMmmYY               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
     F*       S01184 - CREATED FOR CONFIRMATION MATCHING              *
     F*                                                               *
     F*****************************************************************
      /SPACE 2
     FCFBRCHL0IF  E           K        DISK
      /SPACE 2
     F****************************************************************
     F*                  FUNCTION OF INDICATORS
     F*
     F*      01   END OF FILE ON PF/CFBRCHL0
     F*  LR       LAST RECORD INDICATOR
     F*
     F*****************************************************************
      *
      ** Accept Parameters START TRAM ID and Termination Indicator.
      *
     C           *ENTRY    PLIST
     C                     PARM           TRAMID  3
     C                     PARM           TERM    1
      *
      ** Set up Key with TRAM ID received and highest possible
      ** value Branch.
      *
     C                     MOVE '999'     HIBRCH  3
     C           IDKEY     KLIST
     C                     KFLD           TRAMID
     C                     KFLD           HIBRCH
      *
      /SPACE 3
      *
      ** Read next TRAM System ID.
      *
     C           IDKEY     SETGTCFBRCHL0
     C                     READ CFBRCHL0                 01
      *
      ** If End of File, return Termination Parameter 'T'
      *
     C           *IN01     IFEQ '1'
     C                     MOVE 'T'       TERM
     C                     ELSE
      ** otherwise, return next TRAM ID.
     C                     MOVE ' '       TERM
     C                     MOVE IMID      TRAMID
     C                     END
      *
      ** Close File and end processing.
      *
     C                     SETON                     LR
     C                     RETRN
     C*****************************************************************
