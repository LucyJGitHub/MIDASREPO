     H        1
      *****************************************************************
/*S*D****RPGBASE*******************************************************                       CSD053
/*STD *  RPGBNOCVT                                                    *                       CSD053
/*EXS *  RPGCVTOPT1                                                   *                       CSD053
/*EXI *  TEXT('Midas CG Referential Integrity Check: Branch code')
/*OVRF*: OVRDBF (File in program) (file on system)                  : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                      *
     F*                                                               *
     F*  CG0100 - Referential Integrity Check                         *
     F*     CGCORRL2 Correspondent details by branch code             *
     F*     CGCORRL7 Correspondent details by override branch         *
     F*     CGUDCRL4 Data reference by booking branch                 *
     F*     CGUDCRL5 Data reference by originating branch             *
     F*     CGUDCRL6 Data reference by overriding branch              *
     F*     CGXDCRL4 Archive Data reference by booking branch         *   082551
     F*     CGXDCRL5 Archive Data reference by originating branch     *   082551
     F*     CGXDCRL6 Archive Data reference by overriding branch      *   082551
     F*                                                               *
     F*  Function:  This program tests the first 10 records and if    *
     F*             they exist the return code will be set to'CGD1181'*
     F*                                                               *
     F*  Called By:                                                   *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD053             Date 01Jun06               *
      *                 CSC022             Date 24Feb04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 082551             Date 03Feb95               *
      *                 S01522             Date 21Nov94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD053 - Correspondence Manager Multilanguage Upgrade        *
      *           (Recompile)                                         *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  082551 - Include Archive files                               *
      *  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  90   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,CG0100DFPG
      *
      *  /Copy point for File Definition
      *
     FCGCORRL2IF  E           K        DISK
     F                                              KINFSR SRFILE
      *
      * Correspondent Details By branch code.
      *
     FCGCORRL7IF  E           K        DISK
     F                                              KINFSR SRFILE
      *
      * Correspondent Details By overriding branch.
      *
     FCGUDCRL4IF  E           K        DISK
     F                                              KINFSR SRFILE
      *
      * Data reference by booking branch.
      *
     FCGUDCRL5IF  E           K        DISK
     F                                              KINFSR SRFILE
      *
      * Data reference by originating branch.
      *
     FCGUDCRL6IF  E           K        DISK
     F                                              KINFSR SRFILE
      *
      * Data reference by overriding branch.
      *
     FCGXDCRL4IF  E           K        DISK                               082551
     F                                              KINFSR SRFILE         082551
      *                                                                   082551
      * Archive Data reference by booking branch.                         082551
      *                                                                   082551
     FCGXDCRL5IF  E           K        DISK                               082551
     F                                              KINFSR SRFILE         082551
      *                                                                   082551
      * Archive Data reference by originating branch.                     082551
      *                                                                   082551
     FCGXDCRL6IF  E           K        DISK                               082551
     F                                              KINFSR SRFILE         082551
      *                                                                   082551
      * Archive Data reference by overriding branch.                      082551
      *                                                                   082551
     F/EJECT
     E/COPY CGCPYSRC,SRERRE
     E/COPY WNCPYSRC,CG0100DEPG
      *
      *  /Copy point for Arrays
      *
     E                    CPY@    1   1 80
     I/COPY WNCPYSRC,CG0100DIPG
      *
      *  /Copy point for Input Specs
      *
     ICPYR@#      DS
      *
      *  Data structure for compilation  - Copyright insertion
      *
     I                                        1  80 CPY@
     I/COPY CGCPYSRC,SRERRI
     IRUNDTA    E DSRUNDAT
      *
      *  Define rundat data area
      *
      *****************************************************************
      *                 M A I N L I N E
      *****************************************************************
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *  Define entry parameters
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7        Return Code
     C                     PARM           I#BRCA  3        Branch code
     C                     PARM           I#CPGM 10        Calling Pgm tr.
      *
      * Initialise program
      *
     C           *IN50     IFEQ '0'
     C                     EXSR SRINIT
     C                     END
      *
     I/COPY WNCPYSRC,CG0100C
      *
      * Check if branch exists on CGCORRL2.
      *
     C                     EXSR SRRRL2
      *
      * Check if branch exists on CGCORRL7.
      *
     C                     EXSR SRRRL7
      *
      * Check if branch exists on CGUDCRL4.
      *
     C                     EXSR SRCRL4
      *
      * Check if branch exists on CGUDCRL5.
      *
     C                     EXSR SRCRL5
      *
      * Check if branch exists on CGUDCRL6.
      *
     C                     EXSR SRCRL6
      *                                                                   082551
      * Check if branch exists on CGXDCRL4.                               082551
      *                                                                   082551
     C                     EXSR SRXCR4                                    082551
      *                                                                   082551
      * Check if branch exists on CGXDCRL5.                               082551
      *                                                                   082551
     C                     EXSR SRXCR5                                    082551
      *                                                                   082551
      * Check if branch exists on CGXDCRL6.                               082551
      *                                                                   082551
     C                     EXSR SRXCR6                                    082551
      *
      *  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      * Return to calling program
      *
     C                     RETRN
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRRRL2   : Process CGCORRL2                                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRRRL2    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRRRL2'  @STK,Q
      *
     C                     Z-ADD1         I#NUMR
      *
     C           I#BRCA    SETLLCGCORRL2
     C           I#BRCA    READECGCORRL2                 90
      *
     C           *IN90     DOWEQ*OFF                       B1
     C           I#NUMR    ANDLT11
      *
      * If record found set return code to CGD1181, and send message.
      *
     C                     MOVEL'CGD1181' W0RTN
      *
      *  Set up message details.
      *
     C                     MOVEL'CGD1242' CGMSID
     C                     MOVELCDCORR    CGMSDT
     C                     MOVELI#CPGM    CGPGMQ
     C                     EXSR CGSNMS
      *
     C           I#BRCA    READECGCORRL2                 90
     C                     ADD  1         I#NUMR
     C                     ENDDO                           E
      *
     C           EXRRL2    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRRRL7   : Process CGCORRL7                                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRRRL7    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRRRL7'  @STK,Q
      *
     C                     Z-ADD1         I#NUMR
      *
     C           I#BRCA    SETLLCGCORRL7
     C           I#BRCA    READECGCORRL7                 90
      *
     C           *IN90     DOWEQ*OFF                       B1
     C           I#NUMR    ANDLT11
      *
      * If record found set return code to CGD1181, and send message.
      *
     C                     MOVEL'CGD1181' W0RTN
      *
      *  Set up message details.
      *
     C                     MOVEL'CGD1243' CGMSID
     C                     MOVELCDCORR    CGMSDT
     C                     MOVELI#CPGM    CGPGMQ
     C                     EXSR CGSNMS
      *
     C           I#BRCA    READECGCORRL7                 90
     C                     ADD  1         I#NUMR
     C                     ENDDO                           E
      *
     C           EXRRL7    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCRL4   : Process CGUDCRL4                                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRCRL4    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCRL4'  @STK,Q
      *
     C                     Z-ADD1         I#NUMR
      *
     C           I#BRCA    SETLLCGUDCRL4
     C           I#BRCA    READECGUDCRL4                 90
      *
     C           *IN90     DOWEQ*OFF                       B1
     C           I#NUMR    ANDLT11
      *
      * If record found set return code to CGD1181, and send message.
      *
     C                     MOVEL'CGD1181' W0RTN
      *
      *  Set up message details.
      *
     C                     MOVEL'CGD1245' CGMSID
     C                     MOVELDRPCOR    CGMSDT
     C                     MOVELI#CPGM    CGPGMQ
     C                     EXSR CGSNMS
      *
     C           I#BRCA    READECGUDCRL4                 90
     C                     ADD  1         I#NUMR
     C                     ENDDO                           E
      *
     C           EXCRL4    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
      *****************************************************************
      *                                                               *
      *  SRCRL5   : Process CGUDCRL5                                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRCRL5    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCRL5'  @STK,Q
      *
     C                     Z-ADD1         I#NUMR
      *
     C           I#BRCA    SETLLCGUDCRL5
     C           I#BRCA    READECGUDCRL5                 90
      *
     C           *IN90     DOWEQ*OFF                       B1
     C           I#NUMR    ANDLT11
      *
      * If record found set return code to CGD1181, and send message.
      *
     C                     MOVEL'CGD1181' W0RTN
      *
      *  Set up message details.
      *
     C                     MOVEL'CGD1246' CGMSID
     C                     MOVELDRPCOR    CGMSDT
     C                     MOVELI#CPGM    CGPGMQ
     C                     EXSR CGSNMS
      *
     C           I#BRCA    READECGUDCRL5                 90
     C                     ADD  1         I#NUMR
     C                     ENDDO                           E
      *
     C           EXCRL5    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRCRL6   : Process CGUDCRL6                                  *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRCRL6    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRCRL6'  @STK,Q
      *
     C                     Z-ADD1         I#NUMR
      *
     C           I#BRCA    SETLLCGUDCRL6
     C           I#BRCA    READECGUDCRL6                 90
      *
     C           *IN90     DOWEQ*OFF                       B1
     C           I#NUMR    ANDLT11
      *
      * If record found set return code to CGD1181, and send message.
      *
     C                     MOVEL'CGD1181' W0RTN
      *
      *  Set up message details.
      *
     C                     MOVEL'CGD1247' CGMSID
     C                     MOVELDRPCOR    CGMSDT
     C                     MOVELI#CPGM    CGPGMQ
     C                     EXSR CGSNMS
      *
     C           I#BRCA    READECGUDCRL6                 90
     C                     ADD  1         I#NUMR
     C                     ENDDO                           E
      *
     C           EXCRL6    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT                                                              082551
      *****************************************************************   082551
      *                                                               *   082551
      *  SRXCR4   : Process CGXDCRL4                                  *   082551
      *                                                               *   082551
      *  CALLED BY: Main processing                                   *   082551
      *                                                               *   082551
      *  CALLS    : None                                              *   082551
      *                                                               *   082551
      *****************************************************************   082551
     CSR         SRXCR4    BEGSR                                          082551
      *                                                                   082551
      *  Set up subroutine stack name                                     082551
      *                                                                   082551
     C                     ADD  1         Q       50                      082551
     C                     MOVEL'SRXCR4'  @STK,Q                          082551
      *                                                                   082551
     C                     Z-ADD1         I#NUMR                          082551
      *                                                                   082551
     C           I#BRCA    SETLLCGXDCRL4                                  082551
     C           I#BRCA    READECGXDCRL4                 90               082551
      *                                                                   082551
     C           *IN90     DOWEQ*OFF                       B1             082551
     C           I#NUMR    ANDLT11                                        082551
      *                                                                   082551
      * If record found set return code to CGD1181, and send message.     082551
      *                                                                   082551
     C                     MOVEL'CGD1181' W0RTN                           082551
      *                                                                   082551
      *  Set up message details.                                          082551
      *                                                                   082551
     C                     MOVEL'CGD1245' CGMSID                          082551
     C                     MOVELDRPCOR    CGMSDT                          082551
     C                     MOVELI#CPGM    CGPGMQ                          082551
     C                     EXSR CGSNMS                                    082551
      *                                                                   082551
     C           I#BRCA    READECGXDCRL4                 90               082551
     C                     ADD  1         I#NUMR                          082551
     C                     ENDDO                           E              082551
      *                                                                   082551
     C           EXXCR4    TAG                                            082551
     C                     MOVEA*BLANKS   @STK,Q                          082551
     C                     SUB  1         Q                               082551
      *                                                                   082551
     CSR                   ENDSR                                          082551
      *****************************************************************   082551
      *                                                               *   082551
      *  SRXCR5   : Process CGXDCRL5                                  *   082551
      *                                                               *   082551
      *  CALLED BY: Main processing                                   *   082551
      *                                                               *   082551
      *  CALLS    : None                                              *   082551
      *                                                               *   082551
      *****************************************************************   082551
     CSR         SRXCR5    BEGSR                                          082551
      *                                                                   082551
      *  Set up subroutine stack name                                     082551
      *                                                                   082551
     C                     ADD  1         Q       50                      082551
     C                     MOVEL'SRXCR5'  @STK,Q                          082551
      *                                                                   082551
     C                     Z-ADD1         I#NUMR                          082551
      *                                                                   082551
     C           I#BRCA    SETLLCGXDCRL5                                  082551
     C           I#BRCA    READECGXDCRL5                 90               082551
      *                                                                   082551
     C           *IN90     DOWEQ*OFF                       B1             082551
     C           I#NUMR    ANDLT11                                        082551
      *                                                                   082551
      * If record found set return code to CGD1181, and send message.     082551
      *                                                                   082551
     C                     MOVEL'CGD1181' W0RTN                           082551
      *                                                                   082551
      *  Set up message details.                                          082551
      *                                                                   082551
     C                     MOVEL'CGD1246' CGMSID                          082551
     C                     MOVELDRPCOR    CGMSDT                          082551
     C                     MOVELI#CPGM    CGPGMQ                          082551
     C                     EXSR CGSNMS                                    082551
      *                                                                   082551
     C           I#BRCA    READECGXDCRL5                 90               082551
     C                     ADD  1         I#NUMR                          082551
     C                     ENDDO                           E              082551
      *                                                                   082551
     C           EXXCR5    TAG                                            082551
     C                     MOVEA*BLANKS   @STK,Q                          082551
     C                     SUB  1         Q                               082551
      *                                                                   082551
     CSR                   ENDSR                                          082551
     C/EJECT                                                              082551
      *****************************************************************   082551
      *                                                               *   082551
      *  SRXCR6   : Process CGXDCRL6                                  *   082551
      *                                                               *   082551
      *  CALLED BY: Main processing                                   *   082551
      *                                                               *   082551
      *  CALLS    : None                                              *   082551
      *                                                               *   082551
      *****************************************************************   082551
     CSR         SRXCR6    BEGSR                                          082551
      *                                                                   082551
      *  Set up subroutine stack name                                     082551
      *                                                                   082551
     C                     ADD  1         Q       50                      082551
     C                     MOVEL'SRXCR6'  @STK,Q                          082551
      *                                                                   082551
     C                     Z-ADD1         I#NUMR                          082551
      *                                                                   082551
     C           I#BRCA    SETLLCGXDCRL6                                  082551
     C           I#BRCA    READECGXDCRL6                 90               082551
      *                                                                   082551
     C           *IN90     DOWEQ*OFF                       B1             082551
     C           I#NUMR    ANDLT11                                        082551
      *                                                                   082551
      * If record found set return code to CGD1181, and send message.     082551
      *                                                                   082551
     C                     MOVEL'CGD1181' W0RTN                           082551
      *                                                                   082551
      *  Set up message details.                                          082551
      *                                                                   082551
     C                     MOVEL'CGD1247' CGMSID                          082551
     C                     MOVELDRPCOR    CGMSDT                          082551
     C                     MOVELI#CPGM    CGPGMQ                          082551
     C                     EXSR CGSNMS                                    082551
      *                                                                   082551
     C           I#BRCA    READECGXDCRL6                 90               082551
     C                     ADD  1         I#NUMR                          082551
     C                     ENDDO                           E              082551
      *                                                                   082551
     C           EXXCR6    TAG                                            082551
     C                     MOVEA*BLANKS   @STK,Q                          082551
     C                     SUB  1         Q                               082551
      *                                                                   082551
     CSR                   ENDSR                                          082551
     C/EJECT
      *****************************************************************
      *                                                               *
      *  SRINIT   : Initialisation                                    *
      *                                                               *
      *  CALLED BY: Main processing                                   *
      *                                                               *
      *  CALLS    : None                                              *
      *                                                               *
      *****************************************************************
     CSR         SRINIT    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *  Set up copyright statement
      *
     C                     MOVEACPY@      ACT@   80
      *
      *  Indicate that set up is complete
      *
     C                     SETON                     50
      *
      *  Define the number of records to process.
      *
     C                     Z-ADD10        I#NUMR  20
      *
      *  Get Rundate - Rundate
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDTA
     C                     IN   RUNDTA
     C                     MOVE AGMRDT    ##MRDT  7        Midas Run date
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date
     C                     MOVE AGRDNB    WURDNB  50       Run day number
     C                     MOVE AGSUC     WUSUC   1        Set up complete
     C                     MOVE AGDFF     WUDFF   1        Date Format
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched
      *
      *  Unwind subroutine stack name
      *
     C           EXINIT    TAG
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     CSR                   ENDSR
     C/EJECT
     C/COPY CGCPYSRC,SRERRPSSR
     C/COPY CGCPYSRC,SCGSNMSC
     C/COPY CGCPYSRC,SRERRC
**  CPY@ table
(c) Finastra International Limited 2001
