     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Check from-group not already in path.')
/*OVRF*: OVRDBF (File in program) (file on system)                  : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                      *
     F*                                                               *
     F*  CG1210 - Check from group not already included in the path.  *
     F*                                                               *
     F*  Function:  This program receives a 6 long parameter and a    *
     F*             240 long parameter and checks that the data in    *
     F*             the 6 long parameter is not already included in   *
     F*             the 240 long parameter.                           *
     F*                                                               *
     F*  Called By: CGC1020 - Referential integrity check: Customer   *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSC022             Date 24Feb04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. 091826             Date 10Aug95               *
      *                 S01522             Date 22Nov94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
     F*  091826 - Various print generator errors                      *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*EDTRCD: Cpysrc Templates Initialise Program F-spec
     F/COPY WNCPYSRC,CG1210DFPG
     E                    #PATH      40  6                                091826
     E                    CPY@    1   1 80
     E*
     E*  Array containing Copyright statement
     E***************** FIRST COMPILE TIME ARRAY *********************
     E*
     E/COPY CGCPYSRC,SRERRE
     E*
     E*  Copysource for error processing
     E*
     E/COPY WNCPYSRC,CG1210DEPG
     I/COPY CGCPYSRC,SRERRI
     I*
     I*  End of Program Error Processing copysource
     I*
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7        Return Code
     C                     PARM           W0FRMG  6        From Group
     C                     PARM           W0PATH240        Path
     C*
     C*  Set up copyright parameter
     C*
     C                     MOVEL*BLANKS   W0RTN   7        Return Code
     C*
     C                     MOVEACPY@      ACT@   80
     C*                                                                   091826
     C                     MOVEAW0PATH    #PATH                           091826
     C*
     C*  Check to see if the from group is included already in the path
     C*
     C           W0FRMG    IFNE *BLANKS
     C***********W0FRMG    SCAN W0PATH                   90               091826
     C           W0FRMG    LOKUP#PATH                    90               091826
     C*
     C*  If path is already in From group - error.
     C*
     C           *IN90     IFEQ *ON
     C                     MOVEL'*LOOP   'W0FILE
     C                     MOVELW0FRMG    W0KEY            Report Date E
     C                     Z-ADD1         W0ERNB
     C                     MOVEL'CGD1408' W0MSGD
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     ENDIF
     C*
     C                     RETRN
      *================================================================
     C/EJECT
     C*
     C* PSSR Processing
     C*
     C/COPY CGCPYSRC,SRERRPSSR
     C*
     C* File and Program Error Processing
     C*
     C/COPY CGCPYSRC,SRERRC
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
