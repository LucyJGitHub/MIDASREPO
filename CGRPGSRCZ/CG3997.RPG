     H        1
      *****************************************************************
/*S*D****RPGBASE*******************************************************                       CSD053
/*STD *  RPGBNOCVT                                                    *                       CSD053
/*EXS *  RPGCVTOPT1                                                   *                       CSD053
/*EXI *  TEXT('Midas CG Standard group-set details')                  *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG3997  - - - - Provide standard group set values.           *
     F*                                                               *
     F*  Function:   - - This program is executed for group set       *
     F*                   9999. It is passed a list of up to 20       *
     F*                   RDEs, and returns the corresponding         *
     F*                   values for each.                            *
     F*                                                               *
     F*  Called by:  - - CG3999 (Format data string)                  *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
     F*  Last Amend No. MD039544           Date 11Aug16               *
      *  Last Amend No. CSD090             Date 06Dec10               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 BUG22356           Date 22Jan09               *
      *                 CER038             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 241599             Date 08Sep06               *
      *                 CPK025             Date 29Aug06               *
      *                 CSD053             Date 01Jun06               *
      *                 CCG018             Date 26Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG2330            Date 29Apr04               *
      *                 CSC022             Date 24Feb04               *
      * Midas Release 4.01 -------------------------------------------*
      *                 205145             Date 24Apr02               *
      *                 CCG015             Date 10Jul01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 137426             Date 22Jul98               *
     F*                 088481             DATE 01JUN95               *
     F*                 087018             DATE 03MAY95               *
     F*                 086244             DATE 06APR95               *
     F*                 086154             DATE 16MAR95               *
     F*                 086157             DATE 16MAR95               *
     F*                 S01522             DATE 16MAR95               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD039544 - Introduce System Value 'CMAddrFromAddCustInf' to  *
      *             extract address from 'Additional Customer         *
      *             Information' tab.                                 *
      *  CSD090 - Customer Segmentation and Overdraft                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG22356 - Customer address line 5 is missing                *
      *  CER038 - Additional fields added to Correspondence           *
      *  241599 - Apply fix 142187.                                   *
      *  142187 - Fields ##ADD1 and ##ADD2 for UDC customer sender    *
      *           are not correct and replaced by #SADD1 and #SADD2.  *
      *  CPK025 - MidasPlus 1.3 packaging.  Field name conflict.      *
      *  CSD053 - Correspondence Manager Multilanguage Upgrade        *
      *         - (Recompile)                                         *
      *  CCG018 - Extract all purpose field for Corr. Manager.        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
     F*  BUG2330- CG programs looking at wrong dataarea for CSC022    *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
     F*  205145 - Midas System Prefix                                 *
      *  CCG015 - Correspondence Manager Phase 1                      *
     F*  137426 - Create a new RDE 'Print Address Label' in the       *
     F*           SYSTEM Group Set.                                   *
     F*  088481 - Primary correspondent type not set up.              *
     F*  087018 - Formatting of item number still not right           *
     F*  086244 - Add processing for PDAT                             *
     F*           Also add time for Run Date                          *
     F*  086154 - Correct Formatting of rundate                       *
     F*  086157 - Allow load of Address elements                      *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*  81 -- Element found in RDE array.                            *
     F*  90 -- Error detected.                                        *
     F*  91 -- Record not found in file CGUDCRL0.                     *
     F*  92 -- Record not found in file CGCORRL0 or CGCORRL4.         *
     F*  93 -- Record not found in file SDCUSTL0.                     *
     F*  94 -- Record not found in file SDBRCHL0.                     *
     F*  95 -- Error detected from call to AOSARDR0                   *                       CCG015
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Subroutine usage                                             *
     F*  ~~~~~~~~~~~~~~~~                                             *
     F*  SRMTCH -- Match entered RDEs to those in array RDE.          *
     F*  SRLOAD -- Load arrays RDE and DTA.                           *
     F*  SRCADD -- Retrieve correspondent details.                    *
     F*  SRSADD -- Retrieve sender's details.                         *
     F*  SREXPG -- Exit the program.                                  *
     F*  SRINIT -- Provide initialisation and definitions.            *
     F*                                                               *
     F*  Copied in routines:                                          *
     F*                                                               *
     F*  *PSSR  -- Program error routine.                             *
     F*  SRFILE -- File error routine.                                *
     F*  SRERR  -- Error reporting routine.                           *
     F*                                                               *
     F*****************************************************************
     F/SPACE
     F*-------------------------------------------------------------------
     F* Copied-in file definitions:
     F*
     F/COPY WNCPYSRC,CG3997FPG
     F*===================================================================
     FSDCUSTL0IF  E           K        DISK
     F                                              KINFSR SRFILE
     F* Customer details
     F*-------------------------------------------------------------------
     FCGCORRL4IF  E           K        DISK
     F                                              KINFSR SRFILE
     F* Correspondent details by customer number
     F*-------------------------------------------------------------------
     FCGCORRL0IF  E           K        DISK
     F                                              KINFSR SRFILE
     F* Correspondent details by correspondent
     F*-------------------------------------------------------------------
     FSDBRCHL0IF  E           K        DISK
     F                                              KINFSR SRFILE
     F* Branch details
     F*-------------------------------------------------------------------
     FCGUDCRL0IF  E           K        DISK                           UC
     F                                              KINFSR SRFILE
     F* UDC data reference details
     F*-------------------------------------------------------------------
     FCGXDCRL0IF  E           K        DISK                           UC
     F                                              KINFSR SRFILE
     F* UDC data reference details - ARCHIVE
     F*-------------------------------------------------------------------
     FCGRDTAL1IF  E           K        DISK                           UC
     F                                              KINFSR SRFILE
     F* UDC RDE master reference
     FCGAPFDPDIF  E           K        DISK                                                   CCG018
     F                                              KINFSR SRFILE                             CCG018
      *                                                                                       CSD090
      ** Midas SD Customer Marketing Groups                                                   CSD090
      *                                                                                       CSD090
     FSDCMRKL0IF  E           K        DISK                                                   CSD090
      *                                                                                       CSD090
     F* All Purposed Field File                                                               CCG018
     F*-------------------------------------------------------------------                    CCG018
     FSDACUSL0IF  E           K        DISK                                                 MD039544
     F                                              KINFSR SRFILE                           MD039544
     F* Additional Customer details                                                         MD039544
     F*-------------------------------------------------------------------
     E/EJECT
     E*-------------------------------------------------------------------
     E* Error processing array:
     E*
     E/COPY CGCPYSRC,SRERRE
     E*
     E                    CPY@    1   1 80               Copyright
     E                    ##R        20 22               RDEs required.
     E                    ##D        20256               Data returned.
     E                    ##S        20256               Data string.
     E                    RDE     1 100 10               RDEs known.
     E                    DTA       100256               Data for RDEs.
     E*
     E* Copied-in array definitions:
     E*
     E/COPY WNCPYSRC,CG3997EPG
     E*
     E*-------------------------------------------------------------------
     I/SPACE
     I*-------------------------------------------------------------------
     I/COPY WNCPYSRC,CG3997IPG
     I*
     I* Copied-in data structures
     I*
     I*...................................................................
      *                                                                                       CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      *                                                                                       CSC022
     E                    WCMT       10 10                                                    CSC022
      *
      * Rename field for CGAPFDPD                                                             CPK025
     I@APFDPD                                                                                 CPK025
     I              PR2P                            XPR2P                                     CPK025
      *
      *                                                                                       CER038
     I           IDS                                                                          CER038
     I                                        1 200 UADDR                                     CER038
     I                                        1  50 UADD1                                     CER038
     I                                       51 100 UADD2                                     CER038
     I                                      101 150 UADD3                                     CER038
     I                                      151 200 UADD4                                     CER038
      *                                                                                       CER038
     I              'Country'             C         WSVL1                                     CER038
     I              'CorrLine5Details'    C         WSVLK1                                    CER038
     I              'CMAddrFromAddCustInf'C         WSVLK2                                  MD039544
      *                                                                                       CER038
      ** Data Structure                                                                       CER038
      *                                                                                       CER038
     ISDCTRY    E DSSDCTRYPD                                                                  CER038
     ISDBANK    E DSSDBANKPD                                                                  CER038
      *                                                                                       CER038
     I/COPY CGCPYSRC,SRERRI
     I/COPY CGCPYSRC,SRPGN
     I*
     I* Error processing data structures
     I*
     I*...................................................................
     IBIGLDA    E DSCGLDA
     I*
     I* Local data area
     I*
     IWDSJOB    E DSSCCMTJOB                                                                  CSC022
     I              COMITNUM                        WCMTNO                                    CSC022
     I              COMITJOB1                       WJOB01                                    CSC022
     I              COMITJOB2                       WJOB02                                    CSC022
     I              COMITJOB3                       WJOB03                                    CSC022
     I              COMITJOB4                       WJOB04                                    CSC022
     I              COMITJOB5                       WJOB05                                    CSC022
     I              COMITJOB6                       WJOB06                                    CSC022
     I              COMITJOB7                       WJOB07                                    CSC022
     I              COMITJOB8                       WJOB08                                    CSC022
     I              COMITJOB9                       WJOB09                                    CSC022
     I              COMITJOB10                      WJOB10                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      *                                                                                       CSC022
     IRUNDTA    E DSRUNDAT                                                086154
     I*                                                                   086154
     I* Get Rundate - Rundate  *                                          086154
     I*                                                                   086154
     ISTATDT    E DSSDSTAT                                                205145
     I*                                                                   205145
     I* Standing Data                                                     205145
     I*                                                                   205145
     I              '*DEC'                C         DECLIT
      *                                                                   087018
     I            DS                                                      087018
     I                                        1   8 @@ITEM                087018
     I                                        1   80@@ITMN                087018
      ** Used to convert item reference from character to numeric         087018
      *                                                                   087018
      *                                                                                       CCG015
      ** Timestamp for Correspondence Manager                                                 CCG015
      ** Format CCYY-MM-DD.HH:MM:SS                                                           CCG015
     I##TMST      DS                                                                          CCGG15
     I                                        1   4 ##TSYY                                    CCG015
     I                                        5   5 ##TSH1                                    CCG015
     I                                        6   7 ##TSMM                                    CCG015
     I                                        8   8 ##TSH2                                    CCG015
     I                                        9  10 ##TSDD                                    CCG015
     I                                       11  11 ##TSP1                                    CCG015
     I                                       12  13 ##TSHH                                    CCG015
     I                                       14  14 ##TSC1                                    CCG015
     I                                       15  16 ##TSMN                                    CCG015
     I                                       17  17 ##TSC2                                    CCG015
     I                                       18  19 ##TSSS                                    CCG015
      *                                                                                       CCG015
      ** Date 8                                                                               CCG015
      ** Format CCYYMMDD                                                                      CCG015
     I##DT8       DS                                                                          CCGG15
     I                                        1   4 ##D8YY                                    CCG015
     I                                        5   6 ##D8MM                                    CCG015
     I                                        7   8 ##D8DD                                    CCG015
      *                                                                                       CCG015
      ** Time 6                                                                               CCG015
      ** Format HHMMSS                                                                        CCG015
     I##TM6       DS                                                                          CCGG15
     I                                        1   4 ##T6HH                                    CCG015
     I                                        5   6 ##T6MN                                    CCG015
     I                                        7   8 ##T6SS                                    CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
      **  Sar Text details                                                                    CCG015
      *                                                                                       CCG015
     IDSFDY     E DSDSFDY                                                                     CCG015
     IDSLDY     E DSDSLDY                                                                     CSD090
      *                                                                                       CSD090
      * Data Structures used by Access Programs                                               CCG015
      *                                                                                       CCG015
     IAPFDS       DS                                                                          CCG018
     I                                        1   1 PR2P                                      CCG018
      * Data Structures used by AllPurposeField                                               CCG018
      *                                                                                       CCG018
     I********************************************************************
     C/EJECT
     C********************************************************************
     C           *ENTRY    PLIST
     C                     PARM           P0RTN
     C                     PARM           P0ACT
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C*
     C* Add subroutine name to stack:
     C*
     C                     Z-ADD1         Q
     C                     MOVEL'@Main@'  @STK,Q
     C*
     C* Initialise:
     C                     EXSR SRINIT
     C*
     C* If not done, or if the item or correspondent has changed,
     C*  load the data array (DTA) for later selection:
     C*
     C           W0DONE    IFNE 'Y'
     C           #@ITEM    ORNE SVITEM
     C           #@DCOR    ORNE SVDCOR
     C                     EXSR SRLOAD
     C                     MOVE 'Y'       W0DONE  1
     C                     MOVE #@ITEM    SVITEM
     C                     MOVE #@DCOR    SVDCOR
     C                     ENDIF
     C*
     C* For each RDE passed, return any corresponding values known:
     C*
     C                     EXSR SRMTCH
     C*
     C* Exit program:
     C                     EXSR SREXPG
     C*
     C                     RETRN
     C********************************************************************
     C/EJECT
     C           *INZSR    BEGSR
      *
      *  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'*INZSR'  @STK,Q
      *                                                                                       CCG015
      **  Check if Correspondence Manager is switched on                                      CCG015
      *                                                                                       CCG015
     C                     CALL 'AOSARDR0'             95                                     CCG015
     C                     PARM '       ' #RTCD   7                                           CCG015
     C                     PARM '*VERIFY' ##OPTN  7                                           CCG015
     C                     PARM 'CCG015'  ##SARD  8                                           CCG015
     C           SCSARD    PARM *BLANKS   DSFDY                                               CCG015
      *                                                                                       CCG015
      **  If the Access Object returns an error code, process a                               CCG015
      **  database error.                                                                     CCG015
      *                                                                                       CCG015
     C           #RTCD     IFNE *BLANK                                                        CCG015
     C           #RTCD     ANDNE'*NRF   '                                                     CCG015
     C           *IN95     OREQ *ON                                                           CCG015
     C                     MOVEL'AOSARDR0'W0FILE           ***************                    CCG015
     C                     MOVEL'CCG015'  W0KEY            * DB ERROR 03 *                    CCG015
     C                     Z-ADD03        W0ERNB           ***************                    CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C           #RTCD     IFEQ *BLANK                                                        CCG015
     C                     MOVEL'Y'       CCG015  1                                           CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'N'       CCG015                                              CCG015
     C                     ENDIF                                                              CCG015
      *
     C                     CALL 'AOSARDR0'             95                                     CER038
     C                     PARM '       ' #RTCD                                               CER038
     C                     PARM '*VERIFY' ##OPTN                                              CER038
     C                     PARM 'CER038'  ##SARD                                              CER038
     C           SCSARD    PARM *BLANKS   DSFDY                                               CER038
      *                                                                                       CER038
     C           #RTCD     IFEQ *BLANK                                                        CER038
     C                     MOVEL'Y'       CER038  1                                           CER038
     C                     ELSE                                                               CER038
     C                     MOVEL'N'       CER038                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CSD090
      ** Access SAR details file to determine if CSD090 switchable feature                    CSD090
      ** is switched on                                                                       CSD090
      *                                                                                       CSD090
     C                     MOVE 'N'       CSD090  1                                           CSD090
      *                                                                                       CSD090
     C                     CALL 'AOSARDR0'                                                    CSD090
     C                     PARM *BLANKS   PRTCD                                               CSD090
     C                     PARM '*VERIFY' POPTN                                               CSD090
     C                     PARM 'CSD090'  PSARD                                               CSD090
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD090
      *                                                                                       CSD090
     C           PRTCD     IFNE *BLANK                                                        CSD090
     C           PRTCD     ANDNE'*NRF'                                                        CSD090
     C                     MOVEL'AOSARDR0'W0FILE                                              CSD090
     C                     MOVEL'CSD090'  W0KEY                                               CSD090
     C                     Z-ADD22        W0ERNB                                              CSD090
     C                     MOVEL'MEM5003' W0MSGD                                              CSD090
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSD090
     C                     EXSR SRERR                                                         CSD090
     C                     ELSE                                                               CSD090
     C                     MOVE 'Y'       CSD090                                              CSD090
     C                     ENDIF                                                              CSD090
      *                                                                                       CER038
     C                     CALL 'AOBANKR0'                                                    CER038
     C                     PARM *BLANKS   #RTCD                                               CER038
     C                     PARM '*FIRST'  ##OPTN                                              CER038
     C           SDBANK    PARM SDBANK    DSFDY                                               CER038
      *                                                                                       CER038
     C                     MOVELWSVLK1    PSVLK1                                              CER038
     C                     MOVEL*BLANKS   WCORR5                                              CER038
     C                     MOVELWSVLK2    PSVLK2                                            MD039544
     C                     MOVEL*BLANKS   ADDTNL                                            MD039544
      *                                                                                       CER038
     C                     CALL 'AOSVALR0'                                                    CER038
     C                     PARM           PRTCD   7                                           CER038
     C                     PARM           PSVLK1 20                                           CER038
     C                     PARM           PSVL1 200                                           CER038
     C                     PARM           PSVLK2 20                                           CER038
     C                     PARM           PSVL2 200                                           CER038
     C                     PARM           PSVLK3 20                                           CER038
     C                     PARM           PSVL3 200                                           CER038
     C                     PARM           PSVLK4 20                                           CER038
     C                     PARM           PSVL4 200                                           CER038
     C                     PARM           PSVLK5 20                                           CER038
     C                     PARM           PSVL5 200                                           CER038
     C                     PARM           PSVLK6 20                                           CER038
     C                     PARM           PSVL6 200                                           CER038
     C                     PARM           PSVLK7 20                                           CER038
     C                     PARM           PSVL7 200                                           CER038
     C                     PARM           PSVLK8 20                                           CER038
     C                     PARM           PSVL8 200                                           CER038
     C                     PARM           PSVLK9 20                                           CER038
     C                     PARM           PSVL9 200                                           CER038
     C                     PARM           PSVLK0 20                                           CER038
     C                     PARM           PSVL0 200                                           CER038
      *                                                                                       CER038
     C           PRTCD     IFEQ *BLANKS                                                       CER038
     C                     MOVELPSVL1     WCORR5  7                                           CER038
     C                     MOVELPSVL2     ADDTNL  1                                         MD039544
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     OPEN CGRDTAL1
      *
      *  Set up copyright statement
      *
     C                     CLEARNUMDS
     C                     CLEARDTA
      *
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     DO   100       A1      30
      *
     C                     MOVELDTA,A1    RDRDE     P
      *
     C           KKRDER    CHAIN@RDTAL1              90
      *
     C           *IN90     IFEQ *OFF
      *
     C           RDELYP    IFEQ DECLIT
     C                     MOVELNUMDS     DTA,A1    P
     C                     ELSE
     C                     MOVE *BLANKS   DTA,A1
     C                     END
      *
     C                     END
      *
     C                     END
     C                     ENDIF                                                              CCG015
      *
     C                     CLOSECGRDTAL1
     C*                                                                   086154
     C* Get Rundate - Rundate  *                                          086154
     C*                                                                   086154
     C           *NAMVAR   DEFN RUNDAT    RUNDTA                          086154
     C                     IN   RUNDTA                                    086154
     C                     MOVE AGMRDT    ##MRDT  7        Midas Run date 086154
     C                     MOVE AGMRDT    WUMRDT  7        Midas Run date 086154
     C                     MOVE AGRDNB    WURDNB  50       Run day number 086154
     C                     MOVE AGSUC     WUSUC   1        Set up complete086154
     C                     MOVE AGDFF     WUDFF   1        Date Format    086154
     C                     MOVE AGMBIN    WUMBIN  1        Multi Branched 086154
      *                                                                   086154
      * Format Date                                                       086154
      *                                                                   086154
     C                     Z-ADDWURDNB    ##DAYN                          086154
     C                     MOVEL'D'       ##DFMT                          086154
      *                                                                   086154
     C                     CALL 'ZA0140'                                  086154
     C                     PARM           ##DAYN  50                      086154
     C                     PARM           ##DFMT  1                       086154
     C                     PARM           ##DATE  60                      086154
     C                     PARM           ##DATA  7                       086154
     C                     PARM           ##RTCD  1                       086154
     C                     PARM           ##DAT8  80                      086154
      *                                                                   086154
      **  Database error                                                  086154
     C           ##RTCD    IFNE *ZERO                                     086154
      *                                                                   086154
     C                     MOVEL'ZA0140  'W0FILE           ***************086154
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 01 *086154
     C                     Z-ADD01        W0ERNB           ***************086154
     C                     MOVEL'MEM5003' W0MSGD                          086154
     C                     MOVEL'MIDAS  ' W0MSGF                          086154
     C                     EXSR SRERR                                     086154
     C                     ENDIF                                          086154
      *                                                                   086154
     C                     Z-ADD##DAT8    NUMVAL                          086154
     C                     MOVE '@'       NUMEDT                          086154
      *                                                                   086244
      * Get Time for Run Date, place after decimal point                  086244
      *                                                                   086244
     C                     TIME           ##TIME  60                      086244
     C           ##TIME    DIV  1000000   ##TIM6  76                      086244
     C                     ADD  ##TIM6    NUMVAL                          086244
      *                                                                   086244
     C           *LIKE     DEFN NUMDS     ##RUND                          086154
      *                                                                                       CCG015
      ** Format system RDE RUND as CCYY-MM-DD.HH:MM:SS                                        CCG015
      ** for Correspondence Manager                                                           CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL*BLANK    ##RND2 19                                           CCG015
     C                     MOVEL'-'       ##TSH1                                              CCG015
     C                     MOVEL'-'       ##TSH2                                              CCG015
     C                     MOVEL'.'       ##TSP1                                              CCG015
     C                     MOVEL':'       ##TSC1                                              CCG015
     C                     MOVEL':'       ##TSC2                                              CCG015
     C                     MOVE ##DAT8    ##DT8                                               CCG015
     C                     MOVE ##D8YY    ##TSYY                                              CCG015
     C                     MOVE ##D8MM    ##TSMM                                              CCG015
     C                     MOVE ##D8DD    ##TSDD                                              CCG015
     C                     MOVE ##TIME    ##TM6                                               CCG015
     C                     MOVE ##T6HH    ##TSHH                                              CCG015
     C                     MOVE ##T6MN    ##TSMN                                              CCG015
     C                     MOVE ##T6SS    ##TSSS                                              CCG015
     C                     MOVEL##TMST    ##RND2                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVELNUMDS     ##RUND                          086154
     C                     ENDIF                                                              CCG015
      *                                                                                       205145
      ** Retrieve Midas system prefix (or library group)                                      205145
     C           CCG015    IFEQ 'Y'                                                           205145
     C           *NAMVAR   DEFN SDSTAT    STATDT                                              205145
     C           *LIKE     DEFN LIBR      #SYPFX                                              205145
     C                     IN   STATDT                                                        205145
     C                     MOVELLIBR      #SYPFX                                              205145
     C                     ELSE                                                               205145
     C                     MOVEL*BLANK    #SYPFX                                              205145
     C                     ENDIF                                                              205145
      *
      *  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C/EJECT
     C********************************************************************
     C**  Subroutine SRMTCH handles the RDE-matching requirement.       **
     C********************************************************************
     C           SRMTCH    BEGSR                           * S R M T C H *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRMTCH'  @STK,Q
     C*
     C* For each RDE (of up to 20 elements),
     C*  clear the result;
     C*  If the RDE is not blank,
     C*   seek the RDE;
     C*   If found in array RDE,
     C*    move the corresponding value from array DTA.
     C*
     C                     DO   20        #I      30
     C                     MOVE *BLANKS   ##D,#I
     C                     MOVE ##R,#I    ##RDE  10
     C           ##RDE     IFNE *BLANKS
     C           ##RDE     ANDNE*HIVAL
     C***********          Z-ADD11        #R      30         start at 11  086157
     C                     Z-ADD1         #R      30         start at 1   086157
     C           ##RDE     LOKUPRDE,#R                   81  ~~~~~~~~~~~
     C           *IN81     IFEQ *ON
     C*
     C* Get destination index:
     C*
     C***        #R        SUB  10        #W      30
     C***                  MOVELDTA,#W    ##D,#I
     C                     MOVELDTA,#R    ##D,#I
     C                     ENDIF
     C                     ENDIF
     C                     ENDDO
     C*
     C           EXMTCH    TAG                             <<<=== EXMTCH
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRLOAD provides initialisation.                    **
     C********************************************************************
     C           SRLOAD    BEGSR                           * S R L O A D *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRLOAD'  @STK,Q
     C*
     C* Clear destination correspondent details:
     C*
     C                     MOVE *BLANKS   #DBICC
     C                     MOVE *BLANKS   #DBICB
     C                     MOVE *BLANKS   #DCTYP
     C                     MOVE *BLANKS   #DCORN
     C                     MOVE *BLANKS   #DFATT
     C                     MOVE *BLANKS   #DADD1
     C                     MOVE *BLANKS   #DADD2
     C                     MOVE *BLANKS   #DADD3
     C                     MOVE *BLANKS   #DADD4
     C                     MOVE *BLANKS   #DADD5
     C                     MOVE *BLANKS   #DADD6
     C                     MOVE *BLANKS   #DADD7
     C                     MOVE *BLANKS   #DADD8
     C                     MOVE *BLANKS   #DZIP
     C                     MOVE *BLANKS   #DPLAB                          137426
     C*
     C* Clear primary correspondent details:
     C*
     C                     MOVE *BLANKS   #PCTYP
     C                     MOVE *BLANKS   #PCORN
     C                     MOVE *BLANKS   #PFATT
     C                     MOVE *BLANKS   #PADD1
     C                     MOVE *BLANKS   #PADD2
     C                     MOVE *BLANKS   #PADD3
     C                     MOVE *BLANKS   #PADD4
     C                     MOVE *BLANKS   #PADD5
     C                     MOVE *BLANKS   #PADD6
     C                     MOVE *BLANKS   #PADD7
     C                     MOVE *BLANKS   #PADD8
     C                     MOVE *BLANKS   #PZIP
     C*
     C* Primary or secondary flag:
     C*
     C                     MOVE 'P'       #PORS   1
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* Clear sender's branch details:
     C*
     C                     MOVE *BLANKS   #SBRNM
     C                     MOVE *BLANKS   #SADD1
     C                     MOVE *BLANKS   #SADD2
     C                     MOVE *BLANKS   #SADD3
     C                     MOVE *BLANKS   #SADD4
     C                     MOVE *BLANKS   #SADD5
     C                     MOVE *BLANKS   #SADD6
     C                     MOVE *BLANKS   #SADD7
     C                     MOVE *BLANKS   #SADD8
     C                     MOVE *BLANKS   #SFAX
     C                     MOVE *BLANKS   #STEL
     C                     MOVE *BLANKS   #SCREF
     C*                                                                                       CCG015
     C* Production time used by Correspondence Manager                                        CCG015
     C*                                                                                       CCG015
     C                     MOVEL*BLANK    ##PRD2 19                                           CCG015
     C*
     C* Get details from CGUDCRPD, SDCUSTPD, CGCORRPD and SDBRCHPD:
     C*
     C                     Z-ADD#@ITEM    DRITEM
     C                     MOVE #@DCOR    DRDCOR
     C*
     C* Make item character:
     C*
     C***                  MOVE #@ITEM    @@ITEM  8
     C********** *LIKE     DEFN NUMDS     @@ITEM                          087018
     C**********           CLEARNUMDS                                     087018
     C**********           Z-ADD#@ITEM    NUMVAL                          087018
     C**********           MOVELNUMDS     @@ITEM                          087018
     C                     Z-ADD#@ITEM    @@ITMN                          087018
     C*
     C* Seek the UDC data reference record:
     C*
     C           #@ARCH    IFEQ 'A'
     C           KKUDCR    CHAINCGXDCRL0             91
     C                     ELSE
     C           KKUDCR    CHAINCGUDCRL0             91
     C                     ENDIF
     C           *IN91     IFEQ *ON
     C                     MOVE *BLANKS   DRPCOR
     C                     MOVE *BLANKS   DRBRCA
     C                     MOVE *BLANKS   DRORBR
     C                     MOVE *BLANKS   #OBRNM
     C                     MOVE *BLANKS   DRMODI
     C***                  MOVE *BLANKS   DRMTRN
     C                     MOVE *BLANKS   DRMTRN                          086244
     C                     MOVE *BLANKS   DRISTS
     C                     MOVE *BLANKS   DRPTYP
     C                     MOVE *BLANKS   DRPSTP
     C                     Z-ADD*ZEROS    DRRDNB                          086244
     C                     Z-ADD*ZEROS    DRATIM                          086244
     C                     MOVE *BLANKS   DRLGID                                              CCG015
     C                     MOVE *BLANKS   DRAUSR                                              CCG015
     C                     CLEARNUMDS                                     086244
     C                     MOVE '@'       NUMEDT                          086244
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     MOVELNUMDS     ##PDAT                          086244
     C                     ELSE                                                               CCG015
     C                     MOVEL*BLANK    ##PRD2                                              CCG015
     C                     ENDIF                                                              CCG015
     C                     ELSE
      *                                                                   086244
      * Format Production Date and Time                                   086244
      *                                                                   086244
     C                     Z-ADDDRRDNB    ##DAYN                          086244
     C                     MOVEL'D'       ##DFMT                          086244
      *                                                                   086244
     C                     CALL 'ZA0140'                                  086244
     C                     PARM           ##DAYN  50                      086244
     C                     PARM           ##DFMT  1                       086244
     C                     PARM           ##DATE  60                      086244
     C                     PARM           ##DATA  7                       086244
     C                     PARM           ##RTCD  1                       086244
     C                     PARM           ##DAT8  80                      086244
      *                                                                   086244
      **  Database error                                                  086244
     C           ##RTCD    IFNE *ZERO                                     086244
      *                                                                   086244
     C                     MOVEL'ZA0140  'W0FILE           ***************086244
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 02 *086244
     C                     Z-ADD02        W0ERNB           ***************086244
     C                     MOVEL'MEM5003' W0MSGD                          086244
     C                     MOVEL'MIDAS  ' W0MSGF                          086244
     C                     EXSR SRERR                                     086244
     C                     ENDIF                                          086244
      *                                                                   086244
     C                     Z-ADD##DAT8    NUMVAL                          086244
     C                     MOVE '@'       NUMEDT                          086244
      *                                                                   086244
      * Get Time for Run Date, place after decimal point                  086244
      *                                                                   086244
     C           DRATIM    DIV  1000000   ##TIM6                          086244
     C                     ADD  ##TIM6    NUMVAL                          086244
      *                                                                   086244
      ** Format system RDE PDAT as CCYY-MM-DD.HH:MM:SS                                        CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'-'       ##TSH1                                              CCG015
     C                     MOVEL'-'       ##TSH2                                              CCG015
     C                     MOVEL'.'       ##TSP1                                              CCG015
     C                     MOVEL':'       ##TSC1                                              CCG015
     C                     MOVEL':'       ##TSC2                                              CCG015
     C                     MOVE ##DAT8    ##DT8                                               CCG015
     C                     MOVE ##D8YY    ##TSYY                                              CCG015
     C                     MOVE ##D8MM    ##TSMM                                              CCG015
     C                     MOVE ##D8DD    ##TSDD                                              CCG015
     C                     MOVE ##TIME    ##TM6                                               CCG015
     C                     MOVE ##T6HH    ##TSHH                                              CCG015
     C                     MOVE ##T6MN    ##TSMN                                              CCG015
     C                     MOVE ##T6SS    ##TSSS                                              CCG015
     C                     MOVEL##TMST    ##PRD2                                              CCG015
     C                     ELSE                                                               CCG015
     C           *LIKE     DEFN NUMDS     ##PDAT                          086244
     C                     MOVELNUMDS     ##PDAT                          086244
     C                     ENDIF                                                              CCG015
     C*
     C* If a primary correspondent is given, this record is secondary:
     C*
     C***********DRPCOR    IFNE *BLANKS                                   086244
     C           DRPCOR    IFNE DRDCOR                                    086244
     C                     MOVE 'S'       #PORS
     C                     ENDIF
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* If an originating branch code is given,
     C*  retrieve the originating branch name:
     C*
     C           DRORBR    IFNE *BLANKS
     C           DRORBR    CHAINSDBRCHL0             94
     C           *IN94     IFEQ *OFF
     C                     MOVE A8BRNM    #OBRNM
     C                     ENDIF
     C                     ENDIF
     C*
     C* Seek destination correspondent details:
     C*
     C                     MOVE #@DCOR    ##CORR
     C           CER038    IFEQ 'Y'                                                           CER038
     C                     MOVE 'N'       CFLAG   1                                           CER038
     C                     ENDIF                                                              CER038
     C                     EXSR SRCADD
     C*
     C           CER038    IFEQ 'Y'                                                           CER038
     C           UADDR     IFNE *BLANKS                                                       CER038
     C                     MOVE 'Y'       CFLAG                                               CER038
     C                     ENDIF                                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     MOVE ##BICC    #DBICC
     C                     MOVE ##BICB    #DBICB
     C                     MOVE ##CTYP    #DCTYP
     C                     MOVE ##CORN    #DCORN
     C                     MOVE ##FATT    #DFATT
     C                     MOVE ##ADD1    #DADD1
     C                     MOVE ##ADD2    #DADD2
     C                     MOVE ##ADD3    #DADD3
     C                     MOVE ##ADD4    #DADD4
     C                     MOVE ##ADD5    #DADD5
     C                     MOVE ##ADD6    #DADD6
     C                     MOVE ##ADD7    #DADD7
     C                     MOVE ##ADD8    #DADD8
     C                     MOVE ##ZIP     #DZIP
     C                     MOVE ##PLAB    #DPLAB           print addr lbl 137426
     C                     MOVE ##FAX     #DFAX                                               CCG015
     C                     MOVE ##ERT     #DERT                                               CCG015
     C                     MOVE ##EML     #DEML                                               CCG015
     C*
     C* Seek primary correspondent details:
     C*
     C           DRPCOR    IFNE *BLANKS
     C                     MOVE DRPCOR    ##CORR
     C                     EXSR SRCADD
     C*
     C                     MOVE ##CTYP    #PCTYP
     C                     MOVE ##CORN    #PCORN
     C                     MOVE ##FATT    #PFATT
     C                     MOVE ##ADD1    #PADD1
     C                     MOVE ##ADD2    #PADD2
     C                     MOVE ##ADD3    #PADD3
     C                     MOVE ##ADD4    #PADD4
     C                     MOVE ##ADD5    #PADD5
     C                     MOVE ##ADD6    #PADD6
     C                     MOVE ##ADD7    #PADD7
     C                     MOVE ##ADD8    #PADD8
     C                     MOVE ##ZIP     #PZIP
     C                     MOVE ##FAX     #PFAX                                               CCG015
     C                     MOVE ##EML     #PEML                                               CCG015
      *                                                                                       CSD090
      ** Get Additional Customer Segmentation Code                                            CSD090
      *                                                                                       CSD090
     C           CSD090    IFEQ 'Y'                                                           CSD090
     C                     MOVEL##CORR    PCUSNO  6                                           CSD090
     C           PCUSNO    CHAINSDCMRKL0             97                                       CSD090
     C           *IN97     IFEQ *OFF                                                          CSD090
      *                                                                                       CSD090
      ** Customer Segmentation Code                                                           CSD090
      *                                                                                       CSD090
     C                     MOVELD7CSDE    #DCSEG                                              CSD090
     C                     ENDIF                                                              CSD090
     C                     ENDIF                                                              CSD090
     C                     ENDIF
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* Seek sender's details:
     C*
     C                     EXSR SRSADD
     C*
     C* End if UDC record found:
     C*
     C                     ENDIF
     C*...................................................................
     C*
     C* Clear the output data array:
     C*
     C***                  DO   100       @D      30
     C***                  MOVE *BLANKS   DTA,@D
     C***                  ENDDO
      *
     C                     RESETDTA
     C*
     C* Now we may finally load array DTA with the appropriate values:
     C*            ~~~~~~~
     C                     MOVEL'00000000'DTA,1             copy
     C                     MOVEL#DADD1    DTA,2             daddr1
     C                     MOVEL#DADD2    DTA,3             daddr2
     C                     MOVEL#DADD3    DTA,4             daddr3
     C                     MOVEL#DADD4    DTA,5             daddr4
     C           CER038    IFEQ 'Y'                                                           CER038
     C           WCORR5    ANDEQWSVL1                                                         CER038
     C           #DADD5    IFEQ *BLANKS                                                       CER038
     C           CFLAG     ANDEQ'N'                                                           CER038
     C**********           MOVE #@DCOR    WFLD6   6                                  CER038 BUG22356
     C           #@DCOR    CHAINCGCORRL0             92                                     BUG22356
     C           *IN92     IFEQ *OFF                                                        BUG22356
     C                     MOVE CDCUST    WFLD6   6                                         BUG22356
     C                     ENDIF                                                            BUG22356
      *                                                                                     BUG22356
     C           WFLD6     CHAINSDCUSTL0             93                                       CER038
     C           *IN93     IFNE *ON                                                           CER038
     C           BBCOLC    ANDNEBJCNCD                                                        CER038
      *                                                                                       CER038
     C                     CALL 'AOCTRYR0'                                                    CER038
     C                     PARM *BLANKS   PRTCD                                               CER038
     C                     PARM '*KEY'    POPTN                                               CER038
     C                     PARM           BBCOLC                                              CER038
     C           SDCTRY    PARM SDCTRY    DSFDY                                               CER038
      *                                                                                       CER038
     C           PRTCD     IFEQ *BLANKS                                                       CER038
     C                     MOVELA4CNNM    #DADD5                                              CER038
     C                     ENDIF                                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     ENDIF                                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     MOVEL#DADD5    DTA,6             daddr5
     C                     MOVEL#DADD6    DTA,7             daddr6
     C                     MOVEL#DADD7    DTA,8             daddr7
     C                     MOVEL#DADD8    DTA,9             daddr8
     C                     MOVEL#DBICC    DTA,10            dbica
     C                     MOVEL#DBICB    DTA,11            dbicb
     C                     MOVEL#@DCOR    DTA,12            dcorr
     C                     MOVEL#DFATT    DTA,13            dfao
     C*********************MOVEL#DCORN    DTA,14            dname                             CCG015
     C*********************MOVEL#DCTYP    DTA,15            dtype                             CCG015
     C*********************MOVEL#DZIP     DTA,16            dzip                              CCG015
     C*********************MOVEL@@ITEM    DTA,17            item_id                           CCG015
     C*********************MOVELDRMODI    DTA,18            mmod                              CCG015
     C*********************MOVELDRMTRN    DTA,19            mtrn                       086244 CCG015
     C*********************MOVEL#OBRNM    DTA,20            obnam                             CCG015
     C*********************MOVELDRORBR    DTA,21            obrch                             CCG015
     C*********************MOVEL#PADD1    DTA,22            paddr1                            CCG015
     C*********************MOVEL#PADD2    DTA,23            paddr2                            CCG015
     C*********************MOVEL#PADD3    DTA,24            paddr3                            CCG015
     C*********************MOVEL#PADD4    DTA,25            paddr4                            CCG015
     C*********************MOVEL#PADD5    DTA,26            paddr5                            CCG015
     C*********************MOVEL#PADD6    DTA,27            paddr6                            CCG015
     C*********************MOVEL#PADD7    DTA,28            paddr7                            CCG015
     C*********************MOVEL#PADD8    DTA,29            paddr8                            CCG015
     C*...................................................................
     C/EJECT
     C*...................................................................
     C*********************MOVEL'00000000'DTA,30            page                              CCG015
     C*********************MOVELDRPCOR    DTA,31            pcorr                             CCG015
      *                                                                   086244
      *  Add PDAT to output                                               086244
      *                                                                   086244
     C***********          MOVEL#PFATT    DTA,32            pfao          086244
     C***********          MOVEL#PCORN    DTA,33            pname         086244
     C***********          MOVEL#PORS     DTA,34            pors          086244
     C***********          MOVE *BLANKS   DTA,35            pctype        086244
     C***********          MOVELDRPSTP    DTA,36            psbtp         086244
     C***********          MOVELDRPTYP    DTA,37            ptype         086244
     C***********          MOVEL#PZIP     DTA,38            pzip          086244
     C***********          MOVEL'00000000'DTA,39            rund          086244
     C***********          MOVEL##RUND    DTA,39            rund    086154086244
     C***********          MOVEL#SADD1    DTA,40            saddr1        086244
     C***********          MOVEL#SADD2    DTA,41            saddr2        086244
     C***********          MOVEL#SADD3    DTA,42            saddr3        086244
     C***********          MOVEL#SADD4    DTA,43            saddr4        086244
     C***********          MOVEL#SADD5    DTA,44            saddr5        086244
     C***********          MOVEL#SADD6    DTA,45            saddr6        086244
     C***********          MOVEL#SADD7    DTA,46            saddr7        086244
     C***********          MOVEL#SADD8    DTA,47            saddr8        086244
     C***********          MOVEL#SBRNM    DTA,48            sbnam         086244
     C***********          MOVEL#SCREF    DTA,49            sclr          086244
     C***********          MOVEL#SFAX     DTA,50            sfax          086244
     C***********          MOVEL#STEL     DTA,51            sphon         086244
     C***********          MOVELDRISTS    DTA,52            status        086244
     C*********************MOVEL##PDAT    DTA,32            pdat    086244                    CCG015
     C*********************MOVEL#PFATT    DTA,33            pfao    086244                    CCG015
     C*********************MOVEL#PCORN    DTA,34            pname   086244                    CCG015
     C*********************MOVEL#PORS     DTA,35            pors    086244                    CCG015
     C***********          MOVE *BLANKS   DTA,36            pctype  086244088481
     C*********************MOVEL#PCTYP    DTA,36            pctype  088481                    CCG015
     C***********          MOVELDRPSTP    DTA,37            psbtp   086244137426
     C***********          MOVELDRPTYP    DTA,38            ptype   086244137426
     C***********          MOVEL#PZIP     DTA,39            pzip    086244137426
     C***********          MOVEL##RUND    DTA,40            rund    086244137426
     C***********          MOVEL#SADD1    DTA,41            saddr1  086244137426
     C***********          MOVEL#SADD2    DTA,42            saddr2  086244137426
     C***********          MOVEL#SADD3    DTA,43            saddr3  086244137426
     C***********          MOVEL#SADD4    DTA,44            saddr4  086244137426
     C***********          MOVEL#SADD5    DTA,45            saddr5  086244137426
     C***********          MOVEL#SADD6    DTA,46            saddr6  086244137426
     C***********          MOVEL#SADD7    DTA,47            saddr7  086244137426
     C***********          MOVEL#SADD8    DTA,48            saddr8  086244137426
     C***********          MOVEL#SBRNM    DTA,49            sbnam   086244137426
     C***********          MOVEL#SCREF    DTA,50            sclr    086244137426
     C***********          MOVEL#SFAX     DTA,51            sfax    086244137426
     C***********          MOVEL#STEL     DTA,52            sphon   086244137426
     C***********          MOVELDRISTS    DTA,53            status  086244137426
     C*********************                                                                   CCG015
     C*********************MOVEL#DPLAB    DTA,37            paddrlabel137426                  CCG015
     C*********************MOVELDRPSTP    DTA,38            psbtp   137426                    CCG015
     C*********************MOVELDRPTYP    DTA,39            ptype   137426                    CCG015
     C*********************MOVEL#PZIP     DTA,40            pzip    137426                    CCG015
     C*********************MOVEL##RUND    DTA,41            rund    137426                    CCG015
     C*********************MOVEL#SADD1    DTA,42            saddr1  137426                    CCG015
     C*********************MOVEL#SADD2    DTA,43            saddr2  137426                    CCG015
     C*********************MOVEL#SADD3    DTA,44            saddr3  137426                    CCG015
     C*********************MOVEL#SADD4    DTA,45            saddr4  137426                    CCG015
     C*********************MOVEL#SADD5    DTA,46            saddr5  137426                    CCG015
     C*********************MOVEL#SADD6    DTA,47            saddr6  137426                    CCG015
     C*********************MOVEL#SADD7    DTA,48            saddr7  137426                    CCG015
     C*********************MOVEL#SADD8    DTA,49            saddr8  137426                    CCG015
     C*********************MOVEL#SBRNM    DTA,50            sbnam   137426                    CCG015
     C*********************MOVEL#SCREF    DTA,51            sclr    137426                    CCG015
     C*********************MOVEL#SFAX     DTA,52            sfax    137426                    CCG015
     C*********************MOVEL#STEL     DTA,53            sphon   137426                    CCG015
     C*********************MOVELDRISTS    DTA,54            status  137426                    CCG015
     C                     MOVEL#DCORN    DTA,15            dname                             CCG015
     C                     MOVEL#DCTYP    DTA,19            dtype                             CCG015
     C                     MOVEL#DZIP     DTA,20            dzip                              CCG015
     C                     MOVEL@@ITEM    DTA,22            item_id                           CCG015
     C                     MOVELDRMODI    DTA,25            mmod                              CCG015
     C                     MOVELDRMTRN    DTA,26            mtrn                              CCG015
     C                     MOVEL#OBRNM    DTA,27            obnam                             CCG015
     C                     MOVELDRORBR    DTA,28            obrch                             CCG015
     C                     MOVEL#PADD1    DTA,29            paddr1                            CCG015
     C                     MOVEL#PADD2    DTA,30            paddr2                            CCG015
     C                     MOVEL#PADD3    DTA,31            paddr3                            CCG015
     C                     MOVEL#PADD4    DTA,32            paddr4                            CCG015
     C                     MOVEL#PADD5    DTA,33            paddr5                            CCG015
     C                     MOVEL#PADD6    DTA,34            paddr6                            CCG015
     C                     MOVEL#PADD7    DTA,35            paddr7                            CCG015
     C                     MOVEL#PADD8    DTA,36            paddr8                            CCG015
     C                     MOVEL'00000000'DTA,37            page                              CCG015
     C                     MOVELDRPCOR    DTA,38            pcorr                             CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     MOVEL##PDAT    DTA,39            pdat                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL##PRD2    DTA,39            pdat                              CCG015
     C                     ENDIF                                                              CCG015
     C                     MOVEL#PFATT    DTA,40            pfao                              CCG015
     C                     MOVEL#PCORN    DTA,41            pname                             CCG015
     C                     MOVEL#PORS     DTA,42            pors                              CCG015
     C                     MOVEL#PCTYP    DTA,43            pctype                            CCG015
     C                     MOVEL#DPLAB    DTA,47            paddrlabel                        CCG015
     C                     MOVELDRPSTP    DTA,48            psbtp                             CCG015
     C                     MOVELDRPTYP    DTA,49            ptype                             CCG015
     C                     MOVEL#PZIP     DTA,50            pzip                              CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     MOVEL##RUND    DTA,53            rund                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL##RND2    DTA,53            rund                              CCG015
     C                     ENDIF                                                              CCG015
     C                     MOVEL#SADD1    DTA,54            saddr1                            CCG015
     C                     MOVEL#SADD2    DTA,55            saddr2                            CCG015
     C                     MOVEL#SADD3    DTA,56            saddr3                            CCG015
     C                     MOVEL#SADD4    DTA,57            saddr4                            CCG015
     C                     MOVEL#SADD5    DTA,58            saddr5                            CCG015
     C                     MOVEL#SADD6    DTA,59            saddr6                            CCG015
     C                     MOVEL#SADD7    DTA,60            saddr7                            CCG015
     C                     MOVEL#SADD8    DTA,61            saddr8                            CCG015
     C                     MOVEL#SBRNM    DTA,62            sbnam                             CCG015
     C                     MOVEL#SCREF    DTA,63            sclr                              CCG015
     C                     MOVEL#SFAX     DTA,64            sfax                              CCG015
     C                     MOVEL#STEL     DTA,67            sphon                             CCG015
     C                     MOVELDRISTS    DTA,68            status                            CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL#DERT     DTA,14            dlvryrte                          CCG015
     C                     MOVEL#DEML     DTA,16            dstemladr                         CCG015
     C                     MOVEL#DFAX     DTA,17            dstfaxnmb                         CCG015
     C                     MOVEL*BLANKS   DTA,18            dstwebadr                         CCG015
     C                     MOVEL'Y'       DTA,21            generpdf                          CCG015
     C                     MOVELDRLGID    DTA,23            language                          CCG015
     C                     MOVEL*BLANKS   DTA,24            mgmtprnt                          CCG015
     C                     MOVEL#PEML     DTA,44            prcemladr                         CCG015
     C                     MOVEL#PFAX     DTA,45            prcfaxnmb                         CCG015
     C                     MOVEL*BLANKS   DTA,46            prcwebadr                         CCG015
     C                     MOVEL*BLANKS   DTA,51            reprint                           CCG015
     C                     MOVELDRAUSR    DTA,52            requestor                         CCG015
     C                     MOVEL*BLANKS   DTA,65            sndemladr                         CCG015
     C                     MOVEL*BLANKS   DTA,66            sndwebadr                         CCG015
     C                     MOVEL#SYPFX    DTA,69            system prfx                       205145
      *                                                                                       CCG018
      ** Set all purpose field                                                                CCG018
     C           *LIKE     DEFN DRPTYP    K#PTYP                                              CCG018
     C           *LIKE     DEFN DRPSTP    K#PSTP                                              CCG018
     C           KAPFD     KLIST                                                              CCG018
     C                     KFLD           K#PTYP                                              CCG018
     C                     KFLD           K#PSTP                                              CCG018
      *                                                                                       CCG018
     C                     CLEARAPFDS                                                         CCG018
      *                                                                                       CCG018
     C                     MOVELDRPTYP    K#PTYP                                              CCG018
     C                     MOVELDRPSTP    K#PSTP                                              CCG018
     C           KAPFD     CHAINCGAPFDPD             96                                       CCG018
     C           *IN96     IFEQ *ON                                                           CCG018
     C                     MOVEL'*DFT'    K#PTYP    P                                         CCG018
     C                     MOVEL'*DFT'    K#PSTP    P                                         CCG018
     C           KAPFD     CHAINCGAPFDPD             96                                       CCG018
     C                     ENDIF                                                              CCG018
      *                                                                                       CCG018
     C           *IN96     IFEQ *OFF                                                          CCG018
     C                     MOVELAPFDS     DTA,70            all purpose field                 CCG018
     C                     ENDIF                                                              CCG018
     C           CSD090    IFEQ 'Y'                                                           CSD090
     C                     MOVEL#DCSEG    DTA,71            customer segmentation             CSD090
     C                     ENDIF                                                              CSD090
      *                                                                                       CCG018
     C                     ENDIF                                                              CCG015
     C*
     C/COPY WNCPYSRC,CG3997C001
     C           EXLOAD    TAG                             <<<=== EXLOAD
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRCADD retrieves correspondent details.            **
     C********************************************************************
     C           SRCADD    BEGSR                           * S R C A D D *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRCADD'  @STK,Q
     C*
     C* Seek values in the correspondent details file:
     C*
     C           ##CORR    CHAINCGCORRL0             92
     C           *IN92     IFEQ *OFF
     C                     MOVE CDBICC    ##BICC
     C                     MOVE CDBICB    ##BICB
     C                     MOVE CDCTYP    ##CTYP
     C                     MOVE CDCORN    ##CORN
     C                     MOVE CDFATT    ##FATT
     C                     MOVE CDADD1    ##ADD1
     C                     MOVE CDADD2    ##ADD2
     C                     MOVE CDADD3    ##ADD3
     C                     MOVE CDADD4    ##ADD4
     C           CER038    IFEQ 'Y'                                                           CER038
     C                     MOVE CDADD1    UADD1                                               CER038
     C                     MOVE CDADD2    UADD2                                               CER038
     C                     MOVE CDADD3    UADD3                                               CER038
     C                     MOVE CDADD4    UADD4                                               CER038
     C                     ENDIF                                                              CER038
     C                     MOVE CDADD5    ##ADD5
     C                     MOVE CDADD6    ##ADD6
     C                     MOVE CDADD7    ##ADD7
     C                     MOVE CDADD8    ##ADD8
     C                     MOVE CDZIP     ##ZIP
     C                     MOVE CDPLAB    ##PLAB                          137426
     C                     MOVE CDFAX     ##FAX                                               CCG015
     C                     MOVE CDERT     ##ERT                                               CCG015
     C                     MOVE CDEML     ##EML                                               CCG015
     C                     ENDIF
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* If certain details were blank, look in SDCUSTL0:
     C*
     C           *IN92     IFEQ *OFF
     C           CDCUST    ANDNE*BLANKS                                   086244
      ** If CMAddrFromAddCustInf is 'Y' look in SDACUSL0 first                              MD039544
     C           ADDTNL    IFEQ 'Y'                                                         MD039544
     C           CDCUST    CHAINSDACUSL0             93                                     MD039544
     C           *IN93     IFEQ *OFF                                                        MD039544
     C                     MOVELE5CNA1    ##ADD1                                            MD039544
     C                     MOVELE5CNA2    ##ADD2                                            MD039544
     C                     MOVELE5CNA3    ##ADD3                                            MD039544
     C                     MOVELE5CNA4    ##ADD4                                            MD039544
     C                     ENDIF                                                            MD039544
     C                     ENDIF                                                            MD039544
      *                                                                                     MD039544
     C           CDCUST    CHAINSDCUSTL0             93
     C           *IN93     IFEQ *OFF
     C* Name:
     C           ##CORN    IFEQ *BLANKS
     C                     MOVELBBCRNM    ##CORN
     C                     ENDIF
     C* Address:
     C           ##ADD1    IFEQ *BLANKS
     C           ##ADD2    ANDEQ*BLANKS
     C                     MOVELBBCNA1    ##ADD1
     C                     MOVELBBCNA2    ##ADD2
     C                     MOVELBBCNA3    ##ADD3
     C                     MOVELBBCNA4    ##ADD4
     C                     ENDIF
     C*
     C                     ENDIF
     C                     ENDIF
     C*
     C           EXCADD    TAG                             <<<=== EXCADD
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRSADD retrieves the sender's details.             **
     C********************************************************************
     C           SRSADD    BEGSR                           * S R S A D D *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRSADD'  @STK,Q
     C*
     C* Seek values in the branch details file:
     C*
     C           DRBRCA    CHAINSDBRCHL0             94
     C           *IN94     IFEQ *OFF
     C                     MOVE A8BRNM    #SBRNM
     C*
     C* Seek values in the correspondent details file
     C*  for the branch's internal customer:
     C*
     C********** CDCUST    CHAINCGCORRL4             92                   087018
     C           A8BICN    CHAINCGCORRL4             92                   087018
     C/COPY WNCPYSRC,CG3997C003
     C           *IN92     IFEQ *OFF
     C                     MOVE CDADD1    #SADD1
     C                     MOVE CDADD2    #SADD2
     C                     MOVE CDADD3    #SADD3
     C                     MOVE CDADD4    #SADD4
     C                     MOVE CDADD5    #SADD5
     C                     MOVE CDADD6    #SADD6
     C                     MOVE CDADD7    #SADD7
     C                     MOVE CDADD8    #SADD8
     C                     MOVE CDFAX     #SFAX
     C                     MOVE CDTEL     #STEL
     C                     MOVE CDCREF    #SCREF
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* If certain details were blank, look in SDCUSTL0:
     C*
     C********** CDCUST    CHAINSDCUSTL0             93                   087018
     C           A8BICN    CHAINSDCUSTL0             93                   087018
     C           *IN93     IFEQ *OFF
     C* Address:
     C/COPY WNCPYSRC,CG3997C004
     C********** ##ADD1    IFEQ *BLANKS                                                       142187
     C********** ##ADD2    ANDEQ*BLANKS                                                       142187
     C           #SADD1    IFEQ *BLANKS                                                       142187
     C           #SADD2    ANDEQ*BLANKS                                                       142187
     C/COPY WNCPYSRC,CG3997C005
     C                     MOVELBBCNA1    #SADD1
     C                     MOVELBBCNA2    #SADD2
     C                     MOVELBBCNA3    #SADD3
     C                     MOVELBBCNA4    #SADD4
     C                     ENDIF
     C* Telephone:
     C           #STEL     IFEQ *BLANKS
     C                     MOVELBBCTNB    #STEL
     C                     ENDIF
     C*
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C*
     C           EXSADD    TAG                             <<<=== EXSADD
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SREXPG exits the program.                          **
     C********************************************************************
     C           SREXPG    BEGSR                           * S R E X P G *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q
     C                     MOVEL'SREXPG'  @STK,Q
     C*
     C* /Copy point for exit processing:
     C*
     C/COPY WNCPYSRC,CG8200DEPP
     C*
     C* Copy any undisplayed messages to the caller:
     C*
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
     C*
     C* Write to the LDA:
     C                     OUT  BIGLDA
     C*
     C           EXEXPG    TAG                             <<<=== EXEXPG
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRINIT provides initialisation.                    **
     C********************************************************************
     C           SRINIT    BEGSR                           * S R I N I T *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
     C*
     C* Define and clear error return code:
     C*
     C                     MOVE *BLANKS   P0RTN   7
     C*
     C* Define the action code:
     C*
     C                     MOVE P0ACT     P0ACT   8
     C*
     C* Move the copyright parameter:
     C*
     C                     MOVEACPY@      ACT@   80
     C*
     C* Get the local data area (*LDA):
     C*
     C           *NAMVAR   DEFN *LDA      BIGLDA
     C                     IN   BIGLDA
     C*
     C* Common values:
     C*
     C           *LIKE     DEFN CDCORR    ##CORR
     C           *LIKE     DEFN CDBICC    ##BICC
     C           *LIKE     DEFN CDBICB    ##BICB
     C           *LIKE     DEFN CDCTYP    ##CTYP
     C           *LIKE     DEFN CDCORN    ##CORN
     C           *LIKE     DEFN CDFATT    ##FATT
     C           *LIKE     DEFN CDADD1    ##ADD1
     C           *LIKE     DEFN CDADD2    ##ADD2
     C           *LIKE     DEFN CDADD3    ##ADD3
     C           *LIKE     DEFN CDADD4    ##ADD4
     C           *LIKE     DEFN CDADD5    ##ADD5
     C           *LIKE     DEFN CDADD6    ##ADD6
     C           *LIKE     DEFN CDADD7    ##ADD7
     C           *LIKE     DEFN CDADD8    ##ADD8
     C           *LIKE     DEFN CDZIP     ##ZIP
     C           *LIKE     DEFN CDPLAB    ##PLAB                          137426
     C           *LIKE     DEFN CDFAX     ##FAX                                               CCG015
     C           *LIKE     DEFN CDERT     ##ERT                                               CCG015
     C           *LIKE     DEFN CDEML     ##EML                                               CCG015
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* Destination correspondent values:
     C*
     C           *LIKE     DEFN CDBICC    #DBICC
     C           *LIKE     DEFN CDBICB    #DBICB
     C           *LIKE     DEFN CDCTYP    #DCTYP
     C           *LIKE     DEFN CDCORN    #DCORN
     C           *LIKE     DEFN CDFATT    #DFATT
     C           *LIKE     DEFN CDADD1    #DADD1
     C           *LIKE     DEFN CDADD2    #DADD2
     C           *LIKE     DEFN CDADD3    #DADD3
     C           *LIKE     DEFN CDADD4    #DADD4
     C           *LIKE     DEFN CDADD5    #DADD5
     C           *LIKE     DEFN CDADD6    #DADD6
     C           *LIKE     DEFN CDADD7    #DADD7
     C           *LIKE     DEFN CDADD8    #DADD8
     C           *LIKE     DEFN CDZIP     #DZIP
     C           *LIKE     DEFN A8BRNM    #OBRNM
     C           *LIKE     DEFN CDPLAB    #DPLAB                          137426
     C           *LIKE     DEFN CDFAX     #DFAX                                               CCG015
     C           *LIKE     DEFN CDERT     #DERT                                               CCG015
     C           *LIKE     DEFN CDEML     #DEML                                               CCG015
     C           *LIKE     DEFN D7CSDE    #DCSEG                                              CSD090
     C*
     C* Primary correspondent values:
     C*
     C           *LIKE     DEFN CDCTYP    #PCTYP
     C           *LIKE     DEFN CDCORN    #PCORN
     C           *LIKE     DEFN CDFATT    #PFATT
     C           *LIKE     DEFN CDADD1    #PADD1
     C           *LIKE     DEFN CDADD2    #PADD2
     C           *LIKE     DEFN CDADD3    #PADD3
     C           *LIKE     DEFN CDADD4    #PADD4
     C           *LIKE     DEFN CDADD5    #PADD5
     C           *LIKE     DEFN CDADD6    #PADD6
     C           *LIKE     DEFN CDADD7    #PADD7
     C           *LIKE     DEFN CDADD8    #PADD8
     C           *LIKE     DEFN CDZIP     #PZIP
     C           *LIKE     DEFN CDFAX     #PFAX                                               CCG015
     C           *LIKE     DEFN CDEML     #PEML                                               CCG015
     C*...................................................................
     C/EJECT
     C*...................................................................
     C* Sender's values:
     C*
     C           *LIKE     DEFN A8BRNM    #SBRNM
     C           *LIKE     DEFN CDADD1    #SADD1
     C           *LIKE     DEFN CDADD2    #SADD2
     C           *LIKE     DEFN CDADD3    #SADD3
     C           *LIKE     DEFN CDADD4    #SADD4
     C           *LIKE     DEFN CDADD5    #SADD5
     C           *LIKE     DEFN CDADD6    #SADD6
     C           *LIKE     DEFN CDADD7    #SADD7
     C           *LIKE     DEFN CDADD8    #SADD8
     C           *LIKE     DEFN CDFAX     #SFAX
     C           *LIKE     DEFN CDTEL     #STEL
     C           *LIKE     DEFN CDCREF    #SCREF
     C*
     C* CGUDCRL0:
     C           KKUDCR    KLIST
     C                     KFLD           #@ITEM
     C                     KFLD           #@DCOR
     C* CGRDTAL1:
     C           KKRDER    KLIST
     C                     KFLD           RDRDE
     C*
     C* Define save values for change in item or correspondent:
     C*
     C           *LIKE     DEFN #@ITEM    SVITEM
     C           *LIKE     DEFN #@DCOR    SVDCOR
      *
      **  Open the appropriate files if not already open
     C           #@ARCH    IFEQ 'A'
     C           ##FIL1    IFNE 'Y'
     C                     OPEN CGXDCRL0
     C                     MOVE 'Y'       ##FIL1  1
     C                     ENDIF
     C                     ELSE
     C           ##FIL2    IFNE 'Y'
     C                     OPEN CGUDCRL0
     C                     MOVE 'Y'       ##FIL2  1
     C                     ENDIF
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,CG3997C002
     C           EXINIT    TAG                             <<<=== EXINIT
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      *                                                                                       CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCMTSK  1                                           CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   PRTCD   7                                           CSC022
     C                     PARM '*VERIFY' POPTN   7                                           CSC022
     C                     PARM 'CSC022'  PSARD   6                                           CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           PRTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C                     MOVE 'N'       WCMTSK                                              CSC022
      *                                                                                       CSC022
     C                     IN   WDSJOB                                                        CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
     C                     Z-ADD1         I       20                                          CSC022
      *                                                                                       CSC022
     C           ##JOB     LOKUPWCMT,I                   51                                   CSC022
     C           *IN51     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ELSE                                                               CSC022
     C           PRTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD21        W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C************NAMVAR   DEFN           WDSJOB                                       CSC022BUG2330
     C           *NAMVAR   DEFN SCCMTJOB  WDSJOB                                             BUG2330
      *                                                                                       CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C** Subroutine *PSSR handles program errors.                       **
     C********************************************************************
     C*
     C/COPY CGCPYSRC,SRERRPSSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* File and Program Error Processing
     C*
     C/COPY CGCPYSRC,SRERRC
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* /Copy point for calculation specifications:
     C*
     C/COPY WNCPYSRC,CG3997CPG
     C*
     C********************************************************************
     O/EJECT
     O********************************************************************
     C* /Copy point for output:
     C*
     O/COPY WNCPYSRC,CG3997DOPG
      *
     O********************************************************************
~~~~~~*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Notes *or this array:
      *
  RDEs*are in alphabetical order -- keep them that way;
  the *|" and description are comments only;
  if R*Es are added or removed, change the program
   to *atch the array indexes appropriately;
  "liv*" RDEs start in element 11.
      *                                                                   137426
  New * entry PRINTADDRL (Print Address Label) added to table.            137426
      * and entry Z47 removed.                                            137426
  New * entry CSEG (Customer Segmentation Code) added to table.                               CSD090
      * and entry Z02 removed.                                                                CSD090
______*________________________________________________________________
      *
Z33   *   |                                                                                   CCG015
Z34   *   |                                                                                   CCG015
Z35   *   |                                                                                   CCG015
Z36   *   |                                                                                   CCG015
Z37   *   |                                                                                   CCG015
Z38   *   |                                                                                   CCG015
Z39   *   |                                                                                   CCG015
Z40   *   |                                                                                   CCG015
Z41   *   |                                                                                   CCG015
Z42   *   |                                                                                   CCG015
Z43   *   |                                                                                   CCG015
Z44   *   |                                                                                   CCG015
Z45   *   |                                                                                   CCG015
Z46   *   |                                                                                   CCG015
Z47   *   |                                                               137426
Z48   *   |                                                               086244
** CPY@
(c) Misys International Banking Systems Ltd. 2001
** RDE -- Array of standard group set report data elements.
COPY      | Number of copies
DADDR1    | Destination address 1
DADDR2    |                     2
DADDR3    |                     3
DADDR4    |                     4
DADDR5    |                     5
DADDR6    |                     6
DADDR7    |                     7
DADDR8    |                     8
DBICA     | Destination BIC address
DBICBB    | Destination BIC branch code
DCORR     | Destination correspondent
DFAO      | Destination "for attention of"
DLVRYRTE  | Delivery route                                                                    CCG015
DNAME     | Destination correspondent name
DSTEMLADR | Destination email address                                                         CCG015
DSTFAXNMB | Destination FAX number                                                            CCG015
DSTWEBADR | Destination web address                                                           CCG015
DTYPE     | Destination correspondent type
DZIP      | Destination zipcode / postcode
GENERPDF  | Generate PDF                                                                      CCG015
ITEM_ID   | Item identifier
LANGUAGE  | Destination language                                                              CCG015
MGMTPRNT  | Management print                                                                  CCG015
MMOD      | Midas module ID
MTRN      | Midas transaction reference
OBNAM     | Originating branch name
OBRCH     | Originating branch
PADDR1    | Primary address 1
PADDR2    |                 2
PADDR3    |                 3
PADDR4    |                 4
PADDR5    |                 5
PADDR6    |                 6
PADDR7    |                 7
PADDR8    |                 8
PAGE      | Page number
PCORR     | Primary correspondent
PDAT      | Production Date                                               086244
PFAO      | Primary "for attention of"
PNAME     | Primary correspondent name
PORS      | Primary or secondary flag
PCTYPE    | Primary correspondent type
PRCEMLADR | Primary recipient email address                                                   CCG015
PRCFAXNMB | Primary recipient FAX number                                                      CCG015
PRCWEBADR | Primary recipient web address                                                     CCG015
PRINTADDRL| Print Address Label Indicator
PSBTP     | Print item sub-type
PTYPE     | Print item type
PZIP      | Primary zipcode / postcode
REPRINT   | Reprint                                                                           CCG015
REQUESTOR | Requestor                                                                         CCG015
RUND      | Run date
SADDR1    | Sender's address 1
SADDR2    |                  2
SADDR3    |                  3
SADDR4    |                  4
SADDR5    |                  5
SADDR6    |                  6
SADDR7    |                  7
SADDR8    |                  8
SBNAM     | Sender's branch name
SCLR      | Sender's clearing reference
SFAX      | Sender's fax number
SNDEMLADR | Sender email address                                                              CCG015
SNDWEBADR | Sender web address                                                                CCG015
SPHON     | Sender's phone number
STATUS    | Item status
SYSTPRFX  | Midas System Prefix (Libraries group)                                             205145
ALLPURFLD | All Purpose Field                                                                 CCG018
CSEG      |                                                                                   CSD090
Z03       |   RDEs named znn are spares.
Z04       |   They are provided to keep this array
Z05       |    in ascending order.
Z06       |
Z07       |
Z08       |
Z09       |
Z10       |
Z11       |
Z12       |
Z13       |
Z14       |
Z15       |
Z16       |
Z17       |
Z18       |
Z19       |
Z20       |
Z21       |
Z22       |
Z23       |
Z24       |
Z25       |
Z26       |
Z27       |
Z28       |
Z29       |
Z30       |
Z31       |
