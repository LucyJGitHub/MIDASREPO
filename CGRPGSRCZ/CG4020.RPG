     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Repo/bond lending confirmation extract')      *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4020 - Repo/Bond Lending Confirmation Extract              *
     F*                                                               *
     F*  Function:  This program extracts the details required to     *
     F*             produce the confirmation reports for Repo and     *
     F*             bond lending transactions (I/C and COB).          *
     F*                                                               *
     F*  Called By: DLC0210A - Input cycle confirmation processing    *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD055446           Date 04Apr20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CER049             Date 06Dec10               *
      *                 AR702741           Date 02Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW208             Date 15Apr08               *
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 245715             Date 13Feb07               *
      *                 243683             Date 18Dec06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG11112           Date 07Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL019             Date 28Mar06               *
      *                 CDL016             Date 28Mar06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10220           Date 22Feb06               *
      *                 BUG9603            Date 13Dec05               *
      *                 237063             Date 20Nov05               *
      *                 CSE071             Date 19Jul05               *
      *                 CDL038             Date 10May05               *
      *                 BUG7411            Date 01Jun05               *
      *                 BUG7326            Date 01Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 229544             Date 15Sep04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 14Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE006 *CREATE     Date 20Sep99               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD055446 - There are parties and fields missing from the BRT *
      *             details tab in Customer Input plus date of birth  *
      *             issues.                                           *
      *           - Recompile over changes in SDCBRTPD.               *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
      *  AR702741 - Include location as parameter in ZFREQB to        *
      *             determine the next settlement date                *
      *             (Child: AR702742)                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CSW208 - SWIFT 2008 Changes                                  *
      *  245715 - Corrct extract for Nominal.                         *
      *  243683 - DLC0400 failed. Apply BUG10220 for TMAN validation. *
      *  BUG11112 - Correspondence Manager changes for CDL033         *
      *             enhancement.                                      *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL019 - Allow Base Rate Changes on Fixed Term Loan/Deposit. *
      *           Print text 'Variable Rates will be Applied to the   *
      *           Deal' when Fix Base Rate field FSFBRT = 'Y'.
      *  CDL016 - Automatic Rollover of Fixed Term Loan/Deposit.      *
      *           Print text '** EAR-MARKED **' in the correspondence *
      *           where a deal is blocked (FSBLKA = 'Y').             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10220- Repo transaction caused DB Error.                  *
      *  BUG9603 - Changes in CGPACKE caused some programs not to     *
      *            compile.                                           *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  BUG7326 - General ledger account incomplete in element       *
      *            <SaleReceiveOurXGeneralLedger> and <SalePayOur     *
      *            XGeneralLedger>. This is due to field ##OGA        *
      *            still 20-char long and not expanded to 24 chars    *
      *            (missed out by CGL029). Also note length of RDEs   *
      *            S_RECOURXG and S_PAYOURXG was increased from 20    *
      *            to 24.                                             *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  229544 - Recompiled due to inserted fields in DLCHISPD.      *
      *  CSD025 - Customer De-Activation                              *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CCG015 - Correspondence Manager - Phase 1                    *
      *  CSD006 - Use DSSDY to call AOBSRTR0.                         *
      *  CSE006 - Repurchase Agreement enhancements                   *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  01   -    Deal read from DEALSDB                             *
     F*  02   -    Deal read from DEALSDC                             *
     F*  03   -    Deal read from DEALSDD                             *
     F*  04   -    Deal read from DEALSDE                             *
     F*  05   -    Deal read from DEALSDG                             *
     F*                                                               *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     F*
     F/COPY WNCPYSRC,CG4010FFPG
     F*
     FDEALS   IF  E           K        DISK
     F                                              KINFSR SRFILE
     FDEALSH  IF  E           K        DISK
     F                                              KINFSR SRFILE
     F            DEALSDBF                          KIGNORE
     F            DEALSDCF                          KIGNORE
     F            DEALSDDF                          KIGNORE
     F            DEALSDEF                          KIGNORE
     F            DEALSDGF                          KIGNORE
     FSDBRTDL1IF  E           K        DISK
     F                                              KINFSR SRFILE
     FSDCBRTL1IF  E           K        DISK
     F                                              KINFSR SRFILE
     FDLDTSCPDIF  E           K        DISK
     F                                              KINFSR SRFILE
     FDLCFSCPDIF  E           K        DISK
     F                                              KINFSR SRFILE
     FSEDPMVL3IF  E           K        DISK
     F                                              KINFSR SRFILE
     FSECTY   IF  E           K        DISK
     F                                              KINFSR SRFILE
     FSECRTNL1IF  E           K        DISK
     F                                              KINFSR SRFILE
     FACCNTL1 IF  E           K        DISK
     F                                              KINFSR SRFILE
     FDLFHSTL0IF  E           K        DISK                                                   CSW208
     F                                              KINFSR SRFILE                             CSW208
     FDLFEEDLBIF  E           K        DISK                                                   CSW208
     F                                              KINFSR SRFILE                             CSW208
      *                                                                                       CER049
      ** Midas DL Stamp Tax Extension File                                                    CER049
      *                                                                                       CER049
     FDLDLDCL3IF  E           K        DISK                                                   CER049
      *                                                                                       CER049
     F/COPY WNCPYSRC,CG4010FFP1
     F*
     F/SPACE 5
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E*
     E/COPY WNCPYSRC,CG4010EEP2
     E*
     E********************##GRP   1 269 10   ##RDEA 22                                        CDL016
     E********************##GRP   1 270 10   ##RDEA 22                                 CDL016 CDL019
     E********************##GRP   1 271 10   ##RDEA 22                               CDL019 BUG11112
     E**********          ##GRP   1 289 10   ##RDEA 22                               BUG11112 CSW208
     E**********          ##GRP   1 297 10   ##RDEA 22                                 CSW208 CER049
     E                    ##GRP   1 308 10   ##RDEA 22                                        CER049
     E*
     E/COPY WNCPYSRC,CG4010EEP1
     E*
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Loan Deal Types.
     E                    #LN     7   7  2
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
     E*
     E**  Report Text
     E                    ##TXT   1  10 10
     IDEALSDBF    01
     IDEALSDCF    02
     IDEALSDDF    03
     IDEALSDEF    04
     I              SCUS                            CNUM
     IDEALSDGF    05
     ISDCBRTD0
     I              H2TITL                          X2TITL
     IDLBHISD0    01
     IDLCHISD0    02
     IDLDHISD0    03
     IDLEHISD0    04
     I*
     I****Convert Ouput Sequence between Numeric and Binary
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9603
     I                                        15632 ##S                                      BUG9603
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I** Used to convert item reference from character to numeric
     I*
     I*---------------------------------------------------------------------
     I* Named constants
     I*
     I              'REPO_MAINT'          C         W#PTYP
     I              'Telephone'           C         W#PHON
     I              'DLFSWIFTConf'        C         W#DLSW                                    CSW208
     I/COPY WNCPYSRC,CG4010I002
     I*---------------------------------------------------------------------
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
      *
     ISDBANK    E DSSDBANKPD
      **  External DS for Bank details
      *
     ISDGELR    E DSSDGELRPD
      **  External DS for General Ledger details
      *
     ISDMMOD    E DSSDMMODPD
      **  External DS for Module details
      *
     ISDDEAL    E DSSDDEALPD
     I              QQACCD                          QQACC1                                    CGL029
      **  External DS for Dealing Module details
      *
     ISDTRAD    E DSSDTRADPD
     I              QQACCD                          QQACC2                                    CGL029
      **  External DS for Trading Module details
      *
     ISDRETL    E DSSDRETLPD
     I              QQACCD                          QQACC3                                    CGL029
      **  External DS for Retail details
      *
     ISDMGME    E DSSDMGMEPD
      **  External DS for Message Management details
      *
     ISDBRCH    E DSSDBRCHPD
      **  External DS for branch details
      *
     ISDBROK    E DSSDBROKPD
      **  External DS for broker details
      *
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          QQDFA1                                    CGL029
      **  External DS for customer details
      *
     ISDNOST    E DSSDNOSTPD
     I              QQACCD                          QQACC4                                    CGL029
      **  External DS for Nostro details
      *
     ISDCNST    E DSSDCNSTPD                                                                BUG10220
      *                                                                                     BUG10220
      *  Define Counterparty Nostros                                                        BUG10220
      *                                                                                     BUG10220
     ISDBSRT    E DSSDBSRTPD
      **  External DS for base rate details
      *
     ISDCURR    E DSSDCURRPD                101
      **  External DS for currency details
      *
     ISCSARD    E DSSCSARDPD                                              CCG015
      ** MIDAS Switchable Features Accessed Via Access Program            CCG015
      *                                                                   CCG015
     I/COPY WNCPYSRC,CG4010I001
     IDSFDY     E DSDSFDY
      **  First DS for access programs, short data structure
      *
     IDSSDY     E DSDSSDY
      **  Second DS for access programs, long data structure
      *
     IDSLDY     E DSDSLDY                                                 CSW036
      **  Very long data structure for access programs                    CSW036
      *                                                                   CSW036
     IDSPARM    E DSDTRIXDD
     I              CHTP                            DTCHTP
      **  External DS for parameters based on PF/DTRIXDD
      *
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     I***##SRDT*     DS                         20                                            CSW208
     I##SRDT      DS                         80                                               CSW208
      **  DS to store subroutine specific data.
      **  - Previous Bind
      **  - This Bind
      **  - Saved Path
     I                                    P   1   50##PBIN                082060
     I                                    P   6  100##TBIN                082060
     I                                       11  80 ##SPAT                082060
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
      *
      ** Parameters for call to CG4985.
     IP1PARM      DS                            768
      * Pay - Settlement method
     I                                        1   20P1PSTM
      * Pay - Our Nostro
     I**********                              3  14 P1PONS                                    CGL029
     I                                        3  14 P1POQQ                                    CGL029
      * Pay - Intermidiary bank no
     I                                       15  25 P1PIBN
      * Pay - Intermidiary account no
     I                                       26  60 P1PIBA
      * Pay - Ordering bank No
     I**********                             61  690P1POBN                                    CSD027
     I                                       61  69 P1POBN                                    CSD027
      * Pay - Ordering customer no
     I**********                             70  780P1POCN                                    CSD027
     I                                       70  78 P1POCN                                    CSD027
      * Receiver Correspondent no
     I                                       79  89 P1RCRN
      * Receiver Correspondent a/c line
     I                                       90 124 P1RCRA
      * Receiver Number
     I                                      125 135 P1RVNO
      * A/C with bank no
     I                                      136 146 P1AWBN
      * A/C with bank a/c line
     I                                      147 181 P1AWBA
      * Beneficiary number
     I                                      182 192 P1BENN
      * Beneficiary account line
     I                                      193 227 P1BENA
      * Details of pay 1
     I                                      228 262 P1DTP1
      * Details of pay 2
     I                                      263 297 P1DTP2
      * Details of pay 3
     I                                      298 332 P1DTP3
      * Details of pay 4
     I                                      333 367 P1DTP4
      * Details of Charges
     I                                      368 370 P1DCHG
      * Bank to bank info - 1
     I                                      371 405 P1BTB1
      * Bank to bank info - 2
     I                                      406 440 P1BTB2
      * Bank to bank info - 3
     I                                      441 475 P1BTB3
      * Bank to bank info - 4
     I                                      476 510 P1BTB4
      * Bank to bank info - 5
     I                                      511 545 P1BTB5
      * Bank to bank info - 6
     I                                      546 580 P1BTB6
      * Currency
     I                                      581 583 P1CCY
      *
      ** 087000 - include additional details to allow determination
      ** of prime retail account for settlement method 04.
     I                                      584 589 P1CNUM
     I                                      590 599 P1ACCD                                    CGL029
     I                                      600 602 P1BRCH                                    CGL029
     I                                      603 620 P1PONS                                    CGL029
     I**********                            590 593 P1ACCD                                    CGL029
     I**********                            594 596 P1BRCH                                    CGL029
      *
      ** Parameters for call to CG4985.
      **
     IP3PARM      DS                            256
      * Output Sequence
     I                                        1   90P1OSEQ
      * UDC item number
     I                                       10  170P1ITEM
      * This bind level
     I                                       18  250P1TBIN
      * Previous bind level
     I                                       26  330P1PBIN
      *
      **  Parameters for call to CG4975.
      **
     IP6PARM      DS                            256
      * Receipt - Settlement method
     I                                        1   20P1RSTM
      * Receipt - Our Nostro
     I**********                              3  14 P1RONS                                    CGL029
     I                                        3  14 P1ROQQ                                    CGL029
      * Receipt - Intermidiary bank no
     I                                       15  25 P1RIBN
      * Receipt - Intermidiary account no
     I                                       26  60 P1RIBA
      * Receipt - Ordering bank No
     I**********                             61  690P1ROBN                                    CSD027
     I                                       61  69 P1ROBN                                    CSD027
      * Receipt - Ordering customer no
     I**********                             70  780P1ROCN                                    CSD027
     I                                       70  78 P1ROCN                                    CSD027
      * Branch
     I                                       79  81 R1BRCH
      * Currency
     I                                       82  84 R1CCY
      *
      ** 087000 - include additional details to allow determination
      ** of prime retail account for settlement method 04.
     I                                       85  90 R1CNUM
     I                                       91 100 R1ACCD                                    CGL029
     I                                      101 118 P1RONS                                    CGL029
     I**********                             91  94 R1ACCD                                    CGL029
     I/COPY WNCPYSRC,CG4010I004
      *
      ** Parameters for call to CG4975.
      **
     IP5PARM      DS                            256
      * Output Sequence
     I                                        1   90R1OSEQ
      * UDC item number
     I                                       10  170R1ITEM
      * This bind level
     I                                       18  250R1TBIN
      * Previous bind level
     I                                       26  330R1PBIN
     IP7PARM      DS                            256
      * Account Officer
     I                                        1   2 P1ACOF
     I/COPY CGCPYSRC,SRERRI
     I/COPY WNCPYSRC,CG4010I003
     I            DS
     I**********                              1  18 W#ACCN                                    CGL029
     I                                        1  24 W#ACCN                                    CGL029
     I                                        1   6 W#CNUM
     I                                        7   7 W#DSH1
     I                                        8  10 W#CCY
     I                                       11  11 W#DSH2
     I                                       12  21 W#ACOD                                    CGL029
     I                                       22  22 W#DSH3                                    CGL029
     I                                       23  24 W#ACSQ                                    CGL029
     I**********                             12  15 W#ACOD                                    CGL029
     I**********                             16  16 W#DSH3                                    CGL029
     I**********                             17  18 W#ACSQ                                    CGL029
      *                                                                                       CSW208
      ** DS for AOSVALR0                                                                      CSW208
      *                                                                                       CSW208
     ISVAL1       DS                            200                                           CSW208
     I                                        1   1 SVAL11                                    CSW208
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           ##COPD  1
     C                     PARM           ##AUTO  1
     C                     PARM           DSPARM
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      **  Initial processing - Once Only
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      **  Initialisation processing
     C                     EXSR SRINZ
      *
      **  Main processing
     C                     EXSR SRMAIN
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
      ** Access Deal
      *
     C                     EXSR SRDEAL
      *
      ** Confirmation Due?
      *
     C                     TESTB'0'       CNFI           99*
     C           RECI      IFEQ 'D'
     C           *IN99     ANDEQ'0'
     C           RECI      OREQ 'R'
     C           *IN99     ANDEQ'0'
      *
      **  Generate reference number by writing to PF/CGUDCRPD
      **  If no confirmation to be produced, then bypass
      *
     C           *LIKE     DEFN DTYP      ##DTYP
     C                     MOVELDTYP      ##DTYP
     C                     MOVE 'N'       ##COPD
     C*
     C/COPY WNCPYSRC,CG4010CP17
     C*
     C                     MOVEL'N'       ##SPPS
     C                     EXSR SRAUTO
     C           ##SPPS    CABEQ'Y'       EXMAIN
     C                     EXSR SRGENR
     C*
     C/COPY WNCPYSRC,CG4010CP19
     C*
     C           ##COPD    CABEQ'N'       EXMAIN
      *
      ** Extract LOAN & DEPOSIT Deals
      *
     C   02                EXSR REPOS
      *
     C                     ENDIF
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  REPOS                                          *
      * Function    :  Extract LOAN & DEPOSIT Deals                   *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           REPOS     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRXLD '  @STK,Q
      *
      *................................................................
      *
      ** EXTRACT - LOAN AND DEPOSIT DEALS
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'IT'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'CI'                                                        BUG11112
     C           DTYP      OREQ 'CF'                                                        BUG11112
     C           CDL033    ANDEQ'Y'                                                         BUG11112
     C                     EXSR D07LAD
     C                     END
      *
      *................................................................
      *
     C           EXXLD     TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D01FXO                                         *
      * Function    :  Extract - FX Outright Deals                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D01FXO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd01FXO'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d01FXO' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Broker Details
     C                     EXSR BROKER
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** FX Deal Details
     C                     EXSR D@FRX
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Receive Settlement Ins
     C                     MOVELPUCY      ##CCY
     C                     MOVE RSCY      ##RSCY  3
     C                     EXSR D@RECS
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Payment Settlement Ins
     C                     MOVELSLCY      ##CCY
     C                     MOVE PSCY      ##PSCY  3
     C                     EXSR D@PAYS
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Customer Details
     C                     EXSR CUST
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
     C*
     C/COPY WNCPYSRC,CG4010CCPG
     C*
     C*
     C/COPY WNCPYSRC,CG40101FXO
     C*
      *
      *................................................................
      *
     C           EX1FXO    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D02FOP                                         *
      * Function    :  Extract - FX Option Deals                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D02FOP    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd02FOP'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d02FOP' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Broker Details
     C                     EXSR BROKER
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Option To Date
     C                     EXSR D@OPTD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** FX Deal Details
     C                     EXSR D@FRX
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Receive Settlement Ins
     C                     MOVELPUCY      ##CCY
     C                     MOVE RSCY      ##RSCY
     C                     EXSR D@RECS
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Payment Settlement Ins
     C                     MOVELSLCY      ##CCY
     C                     MOVE PSCY      ##PSCY
     C                     EXSR D@PAYS
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Customer Details
     C                     EXSR CUST
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
     C*
     C/COPY WNCPYSRC,CG4010CCPG
     C*
     C*
     C/COPY WNCPYSRC,CG40102FOP
     C*
      *
      *................................................................
      *
     C           EX2FOP    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D03FOT                                         *
      * Function    :  Extract - FX Option Takedown Deals             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D03FOT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd03FOT'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d03FOT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Broker Details
     C                     EXSR BROKER
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Option Deal Number
     C                     EXSR D@OPTN
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** FX Deal Details
     C                     EXSR D@FRX
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Receive Settlement Ins
     C                     MOVELPUCY      ##CCY
     C                     MOVE RSCY      ##RSCY
     C                     EXSR D@RECS
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Payment Settlement Ins
     C                     MOVELSLCY      ##CCY
     C                     MOVE PSCY      ##PSCY
     C                     EXSR D@PAYS
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Customer Details
     C                     EXSR CUST
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
     C*
     C/COPY WNCPYSRC,CG4010CCPG
     C*
     C*
     C/COPY WNCPYSRC,CG40103FOT
     C*
      *
      *................................................................
      *
     C           EX3FOT    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D04ICF                                         *
      * Function    :  Extract - Internal Contract FX Deals           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D04ICF    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd04ICF'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d04ICF' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** FX Deal Details
     C                     EXSR D@FRX
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Currency Equivalent
     C                     EXSR D@BCEQ
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
     C/COPY WNCPYSRC,CG4010C001
      *................................................................
      *
     C           EX4ICF    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXICL                                         *
      * Function    :  Extract INTERNAL CONTRACT LOAN DETAILS         *
      *                                                               *
      * Called by   :  SRXFX - Extract FX OUTRIGHT Deals              *
      * Calls       :                                                 *
      *****************************************************************
     C           SRXICL    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRXICL'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number by writing to PF/CGUDCRPD
      **  If no confirmation to be produced, then bypass
      *
     C                     MOVEL'PL'      ##DTYP
     C                     MOVE 'N'       ##COPD
     C                     EXSR SRGENR
     C           ##COPD    CABEQ'N'       EXXICL
      *
      **  Set up loan details, then extract
      *
     C                     MOVELILCY      CCY
     C                     Z-ADDILAM      PCPL
     C                     Z-ADDILIR      INTR
     C                     Z-ADDILIA      TOTI
     C                     EXSR D05ICL
      *
      *................................................................
      *
     C           EXXICL    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXICD                                         *
      * Function    :  Extract INTERNAL CONTRACT DEPOSIT DETAILS      *
      *                                                               *
      * Called by   :  SRXFX - Extract FX OUTRIGHT Deals              *
      * Calls       :                                                 *
      *****************************************************************
     C           SRXICD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRXICD'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number by writing to PF/CGUDCRPD
      **  If no confirmation to be produced, then bypass
      *
     C                     MOVEL'PD'      ##DTYP
     C                     MOVE 'N'       ##COPD
     C                     EXSR SRGENR
     C           ##COPD    CABEQ'N'       EXXICD
      *
      **  Set up deposit details, then extract
      *
     C                     MOVELIDCY      CCY
     C                     Z-ADDIDAM      PCPL
     C                     Z-ADDIDIR      INTR
     C                     Z-ADDIDIA      TOTI
     C                     EXSR D05ICL
      *
      *................................................................
      *
     C           EXXICD    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D05ICL                                         *
      * Function    :  Extract - Internal Contract Loan/Deposit Deals *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D05ICL    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd05ICL'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVE *BLANKS   S#PATH
      *
     C                     MOVEL'\d05ICL' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Maturity Date
     C                     EXSR MATURD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Notice Days
     C                     EXSR NOTICD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Int. Loan & Deposit Details
     C                     EXSR D@INLD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
     C/COPY WNCPYSRC,CG4010C002
      *................................................................
      *
     C           EX5ICL    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D06INF                                         *
      * Function    :  Extract - Internal Funding Deals               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D06INF    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd06INF'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d06INF' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Maturity Date
     C                     EXSR MATURD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Notice Days
     C                     EXSR NOTICD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Int. Loan & Deposit Details
     C                     EXSR D@INLD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Interest Payment Details
     C                     EXSR D@IPY
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
     C/COPY WNCPYSRC,CG4010C003
      *................................................................
      *
     C           EX6INF    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D07LAD                                         *
      * Function    :  Extract - Loan and Deposit Deals               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D07LAD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd07LAD'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\REPOS ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Broker Details
     C                     EXSR BROKER
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Base Deal Details
     C                     EXSR D@BASE
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Maturity Date
     C                     EXSR MATURD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Notice Days
     C                     EXSR NOTICD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Loan & Deposit Details
     C                     EXSR D@LAD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *                                                                                       CER049
      ** Stamp Tax Detail - only extract for loan type of deals.                              CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C           DTYP      IFEQ 'IP'                                                          CER049
     C           DTYP      OREQ 'TI'                                                          CER049
     C           DTYP      OREQ 'CL'                                                          CER049
     C           DTYP      OREQ 'DL'                                                          CER049
     C                     EXSR LNSTAX                                                        CER049
     C           1         OCUR ##SRDT                      1                                 CER049
     C                     MOVEL##SPAT    S#PATH            1                                 CER049
     C                     Z-ADD##PBIN    S#PBIN                                              CER049
     C                     Z-ADD##TBIN    S#TBIN                                              CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
      *
      ** Interest Payment Details
     C                     EXSR D@IPY
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Rollover Details (if deal is rolling over another deal)
     C           RODN      IFNE 0
     C                     EXSR D@ROLD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
     C                     END
      *
      ** Receive Settlement Ins
     C                     MOVELCCY       ##CCY
     C                     MOVE STCY      ##RSCY
     C                     EXSR D@RECS
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Payment Settlement Ins
     C                     MOVELCCY       ##CCY
     C                     MOVE STCY      ##PSCY
     C                     EXSR D@PAYS
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
     C/COPY WNCPYSRC,CG4010C004
      *
      ** Customer Details
     C                     EXSR CUST
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** First & Last/Up Front Interest
     C                     EXSR D@FLUF
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Repo Transaction
     C                     EXSR R@LAD
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *
      ** Repo Transaction
     C                     EXSR R@DEPR
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
     C                     Z-ADD##PBIN    S#PBIN                          089776
     C                     Z-ADD##TBIN    S#TBIN                          089776
      *                                                                                     BUG11112
      **  Floating Rate CD Issued Details                                                   BUG11112
      *                                                                                     BUG11112
     C           DTYP      IFEQ 'CF'                                                        BUG11112
     C           DTYP      OREQ 'TD'                                                        BUG11112
     C           XKRCDT    ANDGT0                                                           BUG11112
     C           DTYP      OREQ 'TI'                                                        BUG11112
     C           XKRCDT    ANDGT0                                                           BUG11112
     C           DTYP      OREQ 'IT'                                                        BUG11112
     C           XKRCDT    ANDGT0                                                           BUG11112
     C           DTYP      OREQ 'IP'                                                        BUG11112
     C           XKRCDT    ANDGT0                                                           BUG11112
     C           DTYP      OREQ 'CI'                                                        BUG11112
     C           XKRCDT    ANDGT0                                                           BUG11112
     C           CDL033    IFEQ 'Y'                                                         BUG11112
     C                     EXSR SRFRCD                                                      BUG11112
     C                     ENDIF                                                            BUG11112
     C                     ENDIF                                                            BUG11112
      *                                                                                       CSW208
      ** Fee Details                                                                          CSW208
     C           CSW208    IFEQ 'Y'                                                           CSW208
     C           DLSWCF    ANDEQ'Y'                                                           CSW208
     C                     MOVEL'Y'       WFEEH   1                                           CSW208
     C                     MOVEL'N'       WFFLG   1                                           CSW208
     C                     MOVEL'N'       WRPT    1                                           CSW208
     C                     Z-ADD*ZEROS    WFPEND  50                                          CSW208
     C                     EXSR SRFEE                                                         CSW208
     C           WFFLG     IFEQ 'Y'                                                           CSW208
     C                     EXSR DL@FEE                                                        CSW208
     C                     ENDIF                                                              CSW208
     C                     ENDIF                                                              CSW208
     C*
     C/COPY WNCPYSRC,CG4010CCPG
     C*
     C*
     C/COPY WNCPYSRC,CG40107LAD
     C*
      *................................................................
      *
     C           EX7LAD    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D08NAB                                         *
      * Function    :  Extract - N A Bought Deals                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D08NAB    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd08NAB'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d08NAB' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Broker Details
     C                     EXSR BROKER
      *
      ** Base Deal Details
     C                     EXSR D@BASE
      *
      ** Maturity Date
     C                     EXSR MATURD
      *
      ** NA Bought Details
     C                     EXSR D@NAB
      *
      ** Issuer Details
     C                     EXSR D@ISSD
      *
      ** Payment Settlement Ins
     C                     MOVELCCY       ##CCY
     C                     MOVE STCY      ##PSCY
     C                     EXSR D@PAYS
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
      *
      ** Customer Details
     C                     EXSR CUST
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
      *
      ** Parcel Size
     C           PSZE      IFNE *ZERO
     C                     EXSR D@PARS
     C                     END
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
      *
     C/COPY WNCPYSRC,CG4010C005
      *................................................................
      *
     C           EX8NAB    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D09NAS                                         *
      * Function    :  Extract - N A Sold Deals                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D09NAS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd09NAS'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d09NAS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Broker Details
     C                     EXSR BROKER
      *
      ** Base Deal Details
     C                     EXSR D@BASE
      *
      ** NA Sold Details
     C                     EXSR D@NAS
      *
      ** Receive Settlement Ins
     C                     MOVELCCY       ##CCY
     C                     MOVE STCY      ##RSCY
     C                     EXSR D@RECS
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
      *
      ** Issuer Details
     C                     EXSR D@ISSD
      *
      ** Customer Details
     C                     EXSR CUST
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
      *
      ** Parcel Size
     C           PSZE      IFNE *ZERO
     C                     EXSR D@PARS
     C                     END
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
      *
     C/COPY WNCPYSRC,CG4010C006
      *................................................................
      *
     C           EX9NAS    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D10FRA                                         *
      * Function    :  Extract - FRA Deals                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D10FRA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd10FRA'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d10FRA' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR FRA'S
      *
     C                     EXSR SRDOOT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Broker Details
     C                     EXSR BROKER
      *
      ** Base Deal Details
     C                     EXSR D@BASE
      *
      ** Maturity Date
     C                     EXSR MATURD
      *
      ** FRA Deal Details
     C                     EXSR D@FRA
      *
      ** Receive Settlement Ins
     C                     MOVELUCUCY     ##CCY
     C                     MOVELRSETM     RSTM             *Settlemt type
     C                     MOVELURACC     RONS             *Our nostro/ A/C
     C                     MOVELCPPBK     RIBN             *Their nostro
     C                     MOVE PSCY      ##RSCY
     C                     EXSR D@RECS
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
      *
      ** Payment Settlement Ins
     C                     MOVELUCUCY     ##CCY
     C                     MOVELPSETM     PSTM             *Settlemt type
     C                     MOVELUPACC     PONS             *Our nostro/ A/C
     C                     MOVEL*BLANK    RVNO
     C                     MOVELCPRBK     AWBN             *Their nostro
     C                     MOVELFACO      BENN             *For account of
     C                     MOVE PSCY      ##PSCY
     C                     EXSR D@PAYS
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
      *
      ** Customer Details
     C                     EXSR CUST
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
      *
      ** Buyer's Name & Seller's Name
     C                     EXSR D@BYSL
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
      *
     C/COPY WNCPYSRC,CG4010C007
      *................................................................
      *
     C           EX0FRA    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D11IRS                                         *
      * Function    :  Extract - IRS Deals                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D11IRS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd11IRS'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d11IRS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Broker Details
     C                     EXSR BROKER
      *
      ** Base Deal Details
     C                     EXSR D@BASE
      *
      ** Maturity Date
     C                     EXSR MATURD
      *
      ** Up-Front Fees
     C           CIR001    IFEQ 'Y'
     C                     EXSR UPFEE
     C                     END
      *
      ** Buy-Outs
     C           CIR001    IFEQ 'Y'
     C                     EXSR BYOUT
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP2
     C*
      *
      ** IRS Our Details
     C                     EXSR D@IRSO
      *
      ** IRS Their Details
     C                     EXSR D@IRST
      *
      ** Our Name/Their Name
     C                     EXSR D@ONTN
      *
      ** Our Effective Interest Rate
     C                     EXSR D@EIRO
      *
      ** Their Effective Interest Rate
     C                     EXSR D@EIRT
      *
      ** Our Interest Payment Details
     C                     EXSR D@IPYO
      *
      ** Their Interest Payment Details
     C                     EXSR D@IPYT
      *
      ** Our Rate Change Details
     C           UBRTT     IFNE *ZERO
     C                     EXSR D@RCHO
     C                     END
      *
      ** Their Rate Change Details
     C           TBRTT     IFNE *ZERO
     C                     EXSR D@RCHT
     C                     END
     C/COPY WNCPYSRC,CG4010C020
      *
      ** Receive Settlement Ins
     C                     MOVELTCUCY     ##CCY
     C                     MOVELRSETM     RSTM             *Settlemt type
     C                     MOVELURACC     RONS             *Our nostro/ A/C
     C                     MOVELCPPBK     RIBN             *Their nostro
     C                     MOVE RSCY      ##RSCY
     C                     EXSR D@RECS
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
      *
      ** Payment Settlement Ins
     C                     MOVELUCUCY     ##CCY
     C                     MOVELPSETM     PSTM             *Settlemt type
     C                     MOVELUPACC     PONS             *Our nostro/ A/C
     C                     MOVEL*BLANK    RVNO
     C                     MOVELCPRBK     AWBN             *Their nostro
     C                     MOVELFACO      BENN             *For account of
     C                     MOVE PSCY      ##PSCY
     C                     EXSR D@PAYS
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
      *
      ** Customer Details
     C                     EXSR CUST
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
      *
     C/COPY WNCPYSRC,CG4010C008
      *................................................................
      *
     C           EX1IRS    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D12CFC                                         *
      * Function    :  Extract - Cap/Floor/Collar Deals               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D12CFC    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'd12CFC'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\d12CFC' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR CAP/FLOOR/COLLAR
      *
     C                     EXSR SRDOOT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Broker Details
     C                     EXSR BROKER
      *
      ** Base Deal Details
     C                     EXSR D@BASE
      *
      ** Maturity Date
     C                     EXSR MATURD
      *
      ** Premium (Up-Front Fees)
     C           CIR001    IFEQ 'Y'
     C                     EXSR UPFEE
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP3
     C*
      *
      ** Cap/Floor/Collar Details
     C                     EXSR D@CFC
      *
      ** Effective Interest Rate
     C                     EXSR D@EIR
      *
      ** Interest Payment Details
     C                     EXSR D@IPY
      *
      ** Rate Change Details
     C                     EXSR D@RCH
     C/COPY WNCPYSRC,CG4010C021
      *
      ** Receive Settlement Ins
     C                     MOVELUCUCY     ##CCY
     C                     MOVELRSETM     RSTM             *Settlemt type
     C                     MOVELURACC     RONS             *Our nostro/ A/C
     C                     MOVELCPPBK     RIBN             *Their nostro
     C                     MOVE RSCY      ##RSCY
     C                     EXSR D@RECS
      *
      ** Extended Settlement Receipts
     C                     EXSR EX@REC
      *
      ** Payment Settlement Ins
     C                     MOVELUCUCY     ##CCY
     C                     MOVELPSETM     PSTM             *Settlemt type
     C                     MOVELUPACC     PONS             *Our nostro/ A/C
     C                     MOVEL*BLANK    RVNO
     C                     MOVELCPRBK     AWBN             *Their nostro
     C                     MOVELFACO      BENN             *For account of
     C                     MOVE PSCY      ##PSCY
     C                     EXSR D@PAYS
      *
      ** Extended Settlement Payments
     C                     EXSR EX@PAY
      *
      ** Customer Details
     C                     EXSR CUST
      *
      ** Counterparty Account Officer Details
     C                     EXSR ACOF
      *
      ** Buyer's Name & Seller's Name
     C                     EXSR D@BYSL
      *
      ** Other Deal Details
     C                     EXSR D@OTH1
      *
     C/COPY WNCPYSRC,CG4010C009
      *................................................................
      *
     C           EX2CFC    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C*
     C/COPY WNCPYSRC,CG4010CCP1
     C*
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C           BRCA      IFNE ##BRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Get Customer Details for Branch Internal Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A8BICN    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA8BICN    W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Store Booking Branch, Branch Internal Customer Number and Name
      *
     C           *LIKE     DEFN BRCA      BBBRCA
     C                     MOVELBRCA      BBBRCA
     C           *LIKE     DEFN BBCUST    BBBICN
     C                     MOVELBBCUST    BBBICN
     C           *LIKE     DEFN BBCRNM    BICRNM
     C                     MOVELBBCRNM    BICRNM
      *
      ** Store : Sender's (i.e. Branch)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      ** (All used in message routing)
      *
     C                     MOVELA8BTID    ##SCSD
     C                     MOVELBBSTAD    ##SSTD
     C                     MOVELBBTXA1    ##STXA
     C/COPY WNCPYSRC,CG4010C025
     C                     END
      *
      ** Branch
     C                     MOVELA8BRCD    ##D,1
      *
      ** Branch Name
     C                     MOVELA8BRNM    ##D,2
     C/COPY WNCPYSRC,CG4010C026
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BROKER                                         *
      * Function    :  Broker Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BROKER    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BROKER'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BROKER' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Broker Details
      *
     C           BRKC      IFNE ##BROK
      *
     C           BRKC      IFNE 'TELX'
     C           BRKC      ANDNE'PHON'
     C           BRKC      ANDNE'MAIL'
     C           BRKC      ANDNE'SWAP'
     C                     CALL 'AOBROKR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM BRKC      ##BROK  4
     C           SDBROK    PARM SDBROK    DSFDY
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBROKPD'W0FILE           ***************
     C                     MOVELBRKC      W0KEY            * DB ERROR 03 *
     C                     Z-ADD3         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     ELSE
     C                     MOVELBRKC      A9BROK
     C                     MOVEL*BLANK    A9BKNM
     C                     MOVEL*BLANK    A9BRTN
     C                     END
     C                     END
      *
      ** Broker
     C                     MOVELA9BROK    ##D,1
      *
      ** Broker Name
     C                     SELEC
     C           A9BROK    WHEQ 'TELX'
     C                     MOVEL'Telex'   ##D,2
     C           A9BROK    WHEQ 'PHON'
     C                     MOVELW#PHON    ##D,2
     C           A9BROK    WHEQ 'MAIL'
     C                     MOVEL'Mail'    ##D,2
     C                     OTHER
     C                     MOVELA9BKNM    ##D,2
     C                     ENDSL
      *
      ** Broker Town
     C                     MOVELA9BRTN    ##D,3
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBROK    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CUST                                           *
      * Function    :  Customer Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CUST      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CUST  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CUST  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Customer Details
      *
     C                     MOVELCNUM      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE           ***************
     C                     MOVELCNUM      W0KEY            * DB ERROR 04 *
     C                     Z-ADD4         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Store Customer Name
      *
     C           *LIKE     DEFN BBCRNM    CPCRNM
     C                     MOVELBBCRNM    CPCRNM
      *
      ** Store : Destination Customer's (i.e. Counterparty)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      **             Default Network for MTnnn messages
      ** (All used in message routing)
      *
     C                     MOVELBBCSID    ##DCSD
      *                                                                   CSW036
      * If CSW036 is active and the second BIC is available               CSW036
     C           CSW036    IFEQ 'Y'                                       CSW036
     C           BBCSI2    ANDNE*BLANKS                                   CSW036
     C                     MOVELBBCSI2    ##DCSD                          CSW036
     C                     ENDIF                                          CSW036
      *                                                                   CSW036
     C                     MOVELBBSTAD    ##DSTD
     C                     MOVELBBTXA1    ##DTXA
     C                     MOVELBBDNW3    ##DDNW           *MT300 messages
      *
      ** Determine Message Routing
      *
     C                     CALL 'CG99DTMR'             99  *
     C                     PARM           ##SCSD 12        *Send. SWIFT Add
     C                     PARM           ##SSTD 12        *Send. STTX  Add
     C                     PARM           ##STXA 10        *Send. Telex Add
     C                     PARM           ##DCSD 12        *Dest. SWIFT Add
     C                     PARM           ##DSTD 12        *Dest. STTX  Add
     C                     PARM           ##DTXA 10        *Dest. Telex Add
     C                     PARM           ##DDNW  6        *Dest. Deflt Netw
     C                     PARM BGMSDL    ##MSDL  1        *Midas/SWIFT D/Lk
     C                     PARM BGMTMI    ##MTMI  1        *Midas/Telex Link
     C                     PARM BLSWPY    ##SWPY  10       *SWIFT conf prty
     C                     PARM BLTXPY    ##TXPY  10       *TELEX conf prty
     C                     PARM *BLANK    ##NETW  6        *Network
     C                     PARM *BLANK    ##RTCD  7
      *
     C           *IN99     IFEQ '1'
     C           ##RTCD    ORNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'CG99DTMR'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 05 *
     C                     Z-ADD5         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Customer
     C                     MOVELBBCUST    ##D,1
      *
      ** Customer Name
     C                     MOVELBBCRNM    ##D,2
      *
      ** Customer Address Line 1
     C                     MOVELBBCNA1    ##D,3
      *
      ** Customer Address Line 2
     C                     MOVELBBCNA2    ##D,4
      *
      ** Customer Address Line 3
     C                     MOVELBBCNA3    ##D,5
      *
      ** Customer Address Line 4
     C                     MOVELBBCNA4    ##D,6
      *
      ** Customer Town
     C                     MOVELBBCRTN    ##D,7
      *
      ** /Copy for bank indicator extract
     C/COPY WNCPYSRC,CG4010CUST
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCUST    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  ACOF                                           *
      * Function    :  Account Officer Details                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           ACOF      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'ACOF  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up data.
     C                     CLEARP7PARM
     C                     MOVELBBACOC    P1ACOF
      *
     C                     CLEARP4PARM
     C                     MOVELS#PATH    P4PARM
      *
     C                     CLEARP5PARM
     C                     Z-ADD##OSEQ    R1OSEQ
     C                     Z-ADD##ITEM    R1ITEM
     C                     Z-ADDDETBIN    R1TBIN
     C                     Z-ADDDEPBIN    R1PBIN
      *
     C                     CALL 'CG4976'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM           P7PARM
     C                     PARM           P4PARM140        Path
     C                     PARM           W0CMT   3
     C                     PARM           P5PARM
     C                     PARM           ##REFR           Reference Name CCG015
     C                     PARM           P@ICR            Increment No   CCG015
     C                     PARM 'N'       ##MAST           Call Master PgmCCG015
      *
      **  Reset Sequence number.
     C                     Z-ADDR1OSEQ    ##OSEQ
     C                     Z-ADDR1TBIN    DETBIN
     C                     Z-ADDR1PBIN    DEPBIN
      *
      *
      *
      *................................................................
      *
     C           EXACOF    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BASE                                         *
      * Function    :  Base Deal Details                              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@BASE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_BASE'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_BASE' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Deal Number
     C                     MOVELDLNO      ##D,1
      *
      ** Deal Date
     C                     MOVELDDAT      ##D,2
      *
      ** Value Date
     C                     MOVELVDAT      ##D,3
     C/COPY WNCPYSRC,CG4010C024
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBASE    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BCEQ                                         *
      * Function    :  Base Currency Equivalent                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@BCEQ    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_BCEQ'  @STK,Q
      *
      *................................................................
      *
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_BCEQ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Base Currency Equivalent
      *
     C                     MOVELBCEQ      ##D,1
     C                     MOVE BASCDP    ##D,1
      *
      ** Base Currency
      *
     C                     MOVELBJCYCD    ##D,2
      *
     C                     MOVELBJCYCD    ##CCY
     C                     EXSR SRDCDT
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,3
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,4
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBCEQ    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BYSL                                         *
      * Function    :  Buyer's Name & Seller's Name                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@BYSL    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_BYSL'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_BYSL' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Buyer's Name & Seller's Name
      *
     C           BYSL      IFEQ 'B'
     C                     MOVELBICRNM    ##D,1
     C                     MOVELCPCRNM    ##D,2
     C                     ELSE
     C                     MOVELCPCRNM    ##D,1
     C                     MOVELBICRNM    ##D,2
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBYSL    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@CFC                                          *
      * Function    :  Cap/Floor/Collar Details                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@CFC     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_CFC '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_CFC ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELUCUCY     ##D,1
      *
      ** Principal
     C                     MOVELUPAMT     ##D,2
     C                     MOVELUCUCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Floor Rate
     C           FLRAT     IFNE *ZERO
     C                     MOVELFLRAT     ##D,3
     C                     END
      *
      ** Ceiling Rate
     C           CLRAT     IFNE *ZERO
     C           CLRAT     ANDLT9999.99999
     C                     MOVELCLRAT     ##D,4
     C                     END
      *
      ** Base Rate Type
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUCUCY     ##CYCD
     C                     MOVELUBRTT     ##BSRC
     C                     ELSE
     C                     MOVELTCUCY     ##CYCD
     C                     MOVELTBRTT     ##BSRC
     C                     END
      *
     C                     MOVEL##BSRC    ##D,5
      *
      ** Base Rate Name
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##CYCD  3
     C                     PARM           ##BSRC  2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE           ***************
     C                     MOVEL##BSRC    W0KEY            * DB ERROR 06 *
     C                     Z-ADD6         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBABSRN    ##D,6
      *
      ** Spread
     C                     MOVEL*BLANKS   R#DATA
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELURTSP     R#DATA
     C           USPIN     IFEQ 'S'
     C                     MOVE '-'       ##SIGN
     C                     END
     C                     ELSE
     C                     MOVELTRTSP     R#DATA
     C           TSPIN     IFEQ 'S'
     C                     MOVE '-'       ##SIGN
     C                     END
     C                     END
     C                     MOVELR#DATA    ##D,7
     C                     MOVEL*BLANKS   R#DATA
      *
      ** Average Rate
     C                     TESTB'3'       UDSTI          99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,8
     C                     ELSE
     C                     MOVEL'N'       ##D,8
     C                     END
      *
      ** Buy/Sell Indicator
      *
     C                     MOVELBYSL      ##D,9
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,10
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,11
      *
      **  Currency Description  (multi-language for Financial Centre)
     C                     MOVELUCUCY     ##D,12
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCFC     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@DEPR                                         *
      * Function    :  Depot Movement Reference                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@DEPR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_DEPR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_DEPR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Depot Movement Reference
     C                     MOVELDDMR      ##D,1
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXDEPR    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@EIR                                          *
      * Function    :  Effective Interest Rate                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@EIR     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_EIR '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_EIR ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Effective Interest Rate
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUEINR     ##D,1
     C                     ELSE
     C                     MOVELTEINR     ##D,1
     C                     END
      *
      ** Short Term Rate Effective
     C           OURTHR    IFEQ 'OUR'
     C                     TESTB'0'       UDNSI          99*
     C                     ELSE
     C                     TESTB'0'       TDNSI          99*
     C                     END
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,2
     C                     ELSE
     C                     MOVEL'N'       ##D,2
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXEIR     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@EIRO                                         *
      * Function    :  Our Effective Interest Rate                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@EIRO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_EIRO'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_EIRO' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Our Effective Interest Rate
     C                     MOVELUEINR     ##D,1
      *
      ** Our Short Term Rate Effective
     C                     TESTB'0'       UDNSI          99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,2
     C                     ELSE
     C                     MOVEL'N'       ##D,2
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXEIRO    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@EIRT                                         *
      * Function    :  Their Effective Interest Rate                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@EIRT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_EIRT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_EIRT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Their Effective Interest Rate
     C                     MOVELTEINR     ##D,1
      *
      ** Their Short Term Rate Effective
     C                     TESTB'0'       TDNSI          99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,2
     C                     ELSE
     C                     MOVEL'N'       ##D,2
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXEIRT    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FLUF                                         *
      * Function    :  First & Last/Up Front Interest                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@FLUF    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_FLUF'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_FLUF' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** First & Last Day Interest
     C                     MOVELJFLID     ##D,1
      *
      ** Front-Up Interest
     C                     MOVELFUID      ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXFLUF    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FRA                                          *
      * Function    :  FRA Details                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@FRA     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_FRA '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_FRA ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELUCUCY     ##D,1
      *
      ** Principal
     C                     MOVELUPAMT     ##D,2
     C                     MOVELUCUCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Contract Period
     C           MDAT      SUB  VDAT      ##W050
     C                     MOVEL##W050    ##D,3
     C                     MOVE '0'       ##D,3
      *
      ** Rate Fix Date
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUINFD     ##D,4
     C                     ELSE
     C                     MOVELTINFD     ##D,4
     C                     END
      *
      ** Base Rate Type
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUCUCY     ##CYCD
     C                     MOVELUBRTT     ##BSRC
     C                     ELSE
     C                     MOVELTCUCY     ##CYCD
     C                     MOVELTBRTT     ##BSRC
     C                     END
      *
     C                     MOVEL##BSRC    ##D,5
      *
      ** Base Rate Name
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##CYCD
     C                     PARM           ##BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE           ***************
     C                     MOVEL##BSRC    W0KEY            * DB ERROR 07 *
     C                     Z-ADD7         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBABSRN    ##D,6
      *
      ** Contract Rate
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELTRTSP     ##D,7            * thr rate fixed
     C                     ELSE
     C                     MOVELURTSP     ##D,7            * our rate fixed
     C                     END
      *
      ** Interest Calculation Basis
     C                     MOVELUICBS     ##D,8
      *
      ** Buy/Sell Indicator
      *
     C                     MOVELBYSL      ##D,9
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,10
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,11
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXFRA     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FRX                                          *
      * Function    :  FX Deal Details                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@FRX     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_FRX '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_FRX ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Purchase Currency
     C                     MOVELPUCY      ##D,1
      *
      ** Purchase Amount
     C                     MOVELPUAM      ##D,2
     C                     MOVELPUCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
     C           *LIKE     DEFN A6CYNM    W#CYNM
     C                     MOVE *BLANKS   W#CYNM
     C                     MOVELA6CYNM    W#CYNM
      *
      ** Exchange Rate
     C                     MOVELEXRT      ##D,3
      *
      ** Sale Currency
     C                     MOVELSLCY      ##D,4
      *
      ** Sale Amount
     C                     MOVELSLAM      ##D,5
     C                     MOVELSLCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,5
      *
      ** Sale Currency Description
     C                     MOVELA6CYNM    ##D,6
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,7
      *
      ** Purchase Currency Description
     C                     MOVELW#CYNM    ##D,8
      *
     C           CDL002    IFEQ 'Y'
      ** Net Purchase Indicator
     C                     MOVELNETBY     ##D,9
      *
      ** Net Sale Indicator
     C                     MOVELNETSL     ##D,10
     C                     ENDIF
      *
     C*
     C           CEU014    IFEQ 'Y'
     C*
     C* If Receipt Settlement currency is not blank, convert Purchase
     C*  amount from Purchase currency to Receipt settlement currency.
     C*
     C           RSCY      IFNE *BLANKS
     C                     MOVE PUCY      W#FRCY
     C                     MOVE RSCY      W#TOCY
     C                     Z-ADDPUAM      W#FRAM
     C                     MOVE RSCY      ##CCY
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
      *
      ** Purchase Amount in Receipt Settlement currency
     C                     MOVELW#TAMT    ##D,11
     C                     MOVE A6NBDP    ##D,11
     C                     ENDIF
     C*
     C*
     C* If Payment Settlement currency is not blank, convert Sale
     C*  amount from Sale currency to Payment settlement currency.
     C*
     C           PSCY      IFNE *BLANKS
     C                     MOVE SLCY      W#FRCY
     C                     MOVE PSCY      W#TOCY
     C                     Z-ADDSLAM      W#FRAM
     C                     MOVE PSCY      ##CCY
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
      *
      ** Sales Amount in Payment Settlement currency
     C                     MOVELW#TAMT    ##D,12
     C                     MOVE A6NBDP    ##D,12
     C                     ENDIF
     C*
     C*
     C* Convert Purchase amount to Equivalent currency amount if the
     C*  Purchase currency is 'In' or 'Euro' currency.
     C*
     C                     MOVE *BLANKS   PEQCY   3
     C                     MOVE PUCY      ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Purchase currency is 'In', the Equivalent currency is in
     C*  'Euro' and the amount is converted to Euros.
     C*
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    PEQCY
     C                     ENDIF
     C*
     C* If the Purchase currency is 'Euro', the Equivalent currency is
     C*  retrieved from Customer file.  The Equivalent currency is the
     C*  'In' currency designated on the Customer file.
     C*
     C           PUCY      IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    PEQCY
     C                     ENDIF
     C           PEQCY     IFNE *BLANKS
     C                     MOVE PEQCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE PUCY      W#FRCY
     C                     MOVE PEQCY     W#TOCY
     C                     Z-ADDPUAM      W#FRAM
     C                     EXSR D@EURO
      *
      ** Purchase Amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,13
     C                     MOVE A6NBDP    ##D,13
      *
      ** Equivalent currency and Description
     C                     MOVELPEQCY     ##D,14
     C                     MOVELA6CYNM    ##D,15
     C                     ENDIF
     C*
     C* Convert Sale amount to Equivalent currency amount if the
     C*  Sale currency is 'In' or 'Euro' currency.
     C*
     C                     MOVE *BLANKS   SEQCY   3
     C                     MOVE SLCY      ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Sale currency is 'In', the Equivalent currency is in
     C*  'Euro' and the amount is converted to Euros.
     C*
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    SEQCY
     C                     ENDIF
     C*
     C* If the Sale currency is 'Euro', the Equivalent currency is
     C*  retrieved from Customer file.  The Equivalent currency is the
     C*  'In' currency designated on the Customer file.
     C*
     C           SLCY      IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    SEQCY
     C                     ENDIF
     C           SEQCY     IFNE *BLANKS
     C                     MOVE SEQCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE SLCY      W#FRCY
     C                     MOVE SEQCY     W#TOCY
     C                     Z-ADDSLAM      W#FRAM
     C                     EXSR D@EURO
      *
      ** Sale Amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,16
     C                     MOVE A6NBDP    ##D,16
      *
      ** Equivalent currency and Description
     C                     MOVELSEQCY     ##D,17
     C                     MOVELA6CYNM    ##D,18
     C                     ENDIF
     C*
     C                     ENDIF
     C*
     C*
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXFRX     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@INLD                                         *
      * Function    :  Int. Loan & Deposit Details                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@INLD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_INLD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_INLD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELCCY       ##D,1
      *
      ** Principal
     C                     MOVELPCPL      ##D,2
     C                     MOVELCCY       ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Interest Rate
     C                     MOVELINTR      ##D,3
      *
      ** IF TOTAL INTEREST OVERRIDE, INTEREST AMOUNT IS ZERO (IE UNKNOWN)
     C                     TESTB'2'       DNSI           99*
      *
      ** Net Interest
     C                     MOVELTOTI      ##D,4
     C                     MOVE A6NBDP    ##D,4
      *
      ** Net Total
     C           PCPL      ADD  TOTI      ##W150
     C                     MOVEL##W150    ##D,5
     C                     MOVE A6NBDP    ##D,5
      *
      ** Total Interest Override
     C                     TESTB'2'       DNSI           99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,6
     C                     ELSE
     C                     MOVEL'N'       ##D,6
     C                     END
      *
      ** Loan/Deposit Indicator
     C                     Z-ADD1         #1
     C           ##DTYP    LOKUP#LN,#1                   99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'L'       ##D,7
     C                     ELSE
     C                     MOVEL'D'       ##D,7
     C                     END
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,8
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,9
     C/COPY WNCPYSRC,CG4010C031
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXINLD    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IPY                                          *
      * Function    :  Interest Payment Details                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@IPY     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_IPY '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_IPY ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Next Interest Payment Date
     C           NIDT      IFNE *ZERO
     C                     MOVELNIDT      ##D,1
     C                     ELSE
     C           MDAT      IFNE *ZERO
     C                     MOVELMDAT      ##D,1
     C                     END
     C                     END
      *
      ** Interest Payment Frequency
     C                     MOVELIPFR      ##D,2
      *
      ** Interest Payment Day
     C           INTF      IFNE *ZERO
     C                     MOVELINTF      ##D,3
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXIPY     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IPYO                                         *
      * Function    :  Our Interest Payment Details                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@IPYO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_IPYO'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_IPYO' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Our Next Interest Payment Date
     C           UNIPD     IFNE *ZERO
     C                     MOVELUNIPD     ##D,1
     C                     ELSE
     C                     MOVELMDAT      ##D,1
     C                     END
      *
      ** Our Interest Payment Frequency
     C           CIR001    IFEQ 'Y'
     C           UIPFR     ANDEQ'Z'
     C           CIR001    OREQ 'Y'
     C           UIPFR     ANDEQ'C'
     C*
     C                     MOVEL'U'       W0OTIN
     C                     Z-ADDUNIPD     W0ZDAY  50
     C*
     C           UIPFR     IFEQ 'Z'
     C                     MOVEL'P'       W0RCIP
     C                     EXSR #LDNDT
     C                     ELSE
     C                     EXSR #LDNCF
     C                     END
     C*
     C                     Z-ADDUNIPD     W0NXDT  50
     C                     Z-ADDW0ZDAY    W0NNDT  50
     C*
     C                     EXSR #LDTFR
     C                     MOVELW0FREQ    ##D,2
     C*
     C                     ELSE
     C*
     C/COPY WNCPYSRC,CG4010CCP4
     C*
     C                     MOVELUIPFR     ##D,2
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP5
     C*
      *
      ** Our Interest Payment Day
     C           UIPFD     IFNE *ZERO
     C                     MOVELUIPFD     ##D,3
     C                     END
      *
      ** Our Interest Processing Method
      ** -- If interest payment frequency is "C" for cash flow, set
      **    the interest processing method to "F".
     C           CIR001    IFEQ 'Y'
      *
     C           UIPFR     IFEQ 'C'
     C                     MOVEL'F'       ##D,4
     C                     ELSE
     C                     MOVELUINPM     ##D,4
     C                     END
      *
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP6
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXIPYO    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IPYT                                         *
      * Function    :  Their Interest Payment Details                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@IPYT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_IPYT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_IPYT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Their Next Interest Payment Date
     C           TNIPD     IFNE *ZERO
     C                     MOVELTNIPD     ##D,1
     C                     ELSE
     C                     MOVELMDAT      ##D,1
     C                     END
      *
      ** Their Interest Payment Frequency
     C           CIR001    IFEQ 'Y'
     C           TIPFR     ANDEQ'Z'
     C           CIR001    OREQ 'Y'
     C           TIPFR     ANDEQ'C'
     C*
     C                     MOVEL'T'       W0OTIN
     C                     Z-ADDTNIPD     W0ZDAY
     C*
     C           TIPFR     IFEQ 'Z'
     C                     MOVEL'P'       W0RCIP
     C                     EXSR #LDNDT
     C                     ELSE
     C                     EXSR #LDNCF
     C                     END
     C*
     C                     Z-ADDTNIPD     W0NXDT
     C                     Z-ADDW0ZDAY    W0NNDT
     C*
     C                     EXSR #LDTFR
     C                     MOVELW0FREQ    ##D,2
     C*
     C                     ELSE
     C*
     C/COPY WNCPYSRC,CG4010CCP7
     C*
     C                     MOVELTIPFR     ##D,2
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP8
     C*
      *
      ** Their Interest Payment Day
     C           TIPFD     IFNE *ZERO
     C                     MOVELTIPFD     ##D,3
     C                     END
      *
      ** Their Interest Processing Method
      ** -- If interest payment frequency is "C" for cash flow, set
      **    the interest processing method to "F".
     C           CIR001    IFEQ 'Y'
      *
     C           TIPFR     IFEQ 'C'
     C                     MOVEL'F'       ##D,4
     C                     ELSE
     C                     MOVELTINPM     ##D,4
     C                     END
      *
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CCP9
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXIPYT    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IRSO                                         *
      * Function    :  IRS Our Details                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@IRSO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_IRSO'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_IRSO' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Our Currency
     C                     MOVELUCUCY     ##D,1
      *
      ** Our Principal
     C                     MOVELUPAMT     ##D,2
     C                     MOVELUCUCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Our Base Rate Type
     C           UBRTT     IFNE *ZERO
     C                     MOVELUBRTT     ##D,3
     C                     END
      *
      ** Our Base Rate Name
     C           UBRTT     IFNE *ZERO
     C                     MOVELUBRTT     ##BSRC
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM UCUCY     ##CYCD
     C                     PARM           ##BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE           ***************
     C                     MOVEL##BSRC    W0KEY            * DB ERROR 08 *
     C                     Z-ADD8         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     ELSE
     C                     MOVEL*BLANK    BABSRN
     C                     END
      *
     C                     MOVELBABSRN    ##D,4
      *
      ** Our Fixed Rate
     C           UBRTT     IFEQ *ZERO
     C                     MOVELUEINR     ##D,5
     C                     END
      *
      ** Our Spread
     C                     MOVEL*BLANKS   R#DATA
     C           UBRTT     IFNE *ZERO
     C                     MOVELURTSP     R#DATA
     C           USPIN     IFEQ 'S'
     C                     MOVE '-'       ##SIGN
     C                     END
     C                     END
     C                     MOVELR#DATA    ##D,6
     C                     MOVEL*BLANKS   R#DATA
      *
      **  Our Calculation Basis
     C                     MOVELUICBS     ##D,7
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,8
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,9
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXIRSO    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IRST                                         *
      * Function    :  IRS Their Details                              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@IRST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_IRST'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_IRST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Their Currency
     C                     MOVELTCUCY     ##D,1
      *
      ** Their Principal
     C                     MOVELTPAMT     ##D,2
     C                     MOVELTCUCY     ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Their Base Rate Type
     C           TBRTT     IFNE *ZERO
     C                     MOVELTBRTT     ##D,3
     C                     END
      *
      ** Their Base Rate Name
     C           TBRTT     IFNE *ZERO
     C                     MOVELTBRTT     ##BSRC
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM TCUCY     ##CYCD
     C                     PARM           ##BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE           ***************
     C                     MOVEL##BSRC    W0KEY            * DB ERROR 09 *
     C                     Z-ADD9         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     ELSE
     C                     MOVEL*BLANK    BABSRN
     C                     END
      *
     C                     MOVELBABSRN    ##D,4
      *
      ** Their Fixed Rate
     C           TBRTT     IFEQ *ZERO
     C                     MOVELTEINR     ##D,5
     C                     END
      *
      ** Their Spread
     C                     MOVEL*BLANKS   R#DATA
     C           TBRTT     IFNE *ZERO
     C                     MOVELTRTSP     R#DATA
     C           TSPIN     IFEQ 'S'
     C                     MOVE '-'       ##SIGN
     C                     END
     C                     END
     C                     MOVELR#DATA    ##D,6
     C                     MOVEL*BLANKS   R#DATA
      *
      **  Their Calculation Basis
     C                     MOVELTICBS     ##D,7
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,8
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,9
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXIRST    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@ISSD                                         *
      * Function    :  Issuer Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@ISSD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_ISSD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_ISSD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Issuer
     C                     MOVELISCN      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE           ***************
     C                     MOVELISCN      W0KEY            * DB ERROR 10 *
     C                     Z-ADD10        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCUST    ##D,1
      *
      ** Issuer Name
     C                     MOVELBBCRNM    ##D,2
      *
      ** Issuer Town
     C                     MOVELBBCRTN    ##D,3
      *
      ** N.A Reference
     C                     MOVELRNNA      ##D,4
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXISSD    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@LAD                                          *
      * Function    :  Loan & Deposit Details                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@LAD     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_LAD '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_LAD ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELCCY       ##D,1
      *
      ** Principal
     C                     MOVELPCPL      ##D,2
     C                     MOVELCCY       ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Interest Rate
     C                     MOVELINTR      ##D,3
      *
      ** IF TOTAL INTEREST OVERRIDE, INTEREST AMOUNT IS ZERO (IE UNKNOWN)
     C                     TESTB'2'       DNSI           99*
      *
      ** Gross Interest
     C                     MOVELTOTI      ##D,4
     C                     MOVE A6NBDP    ##D,4
     C/COPY WNCPYSRC,CG4010C027
      *
      ** DETERMINE TAX AMOUNT
     C           *LIKE     DEFN TOTI      ##TAXA
     C                     Z-ADD*ZERO     ##TAXA
     C/COPY WNCPYSRC,CG4010C014
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'TD'
     C           TAXI      IFEQ 'Y'
     C                     EXSR SRDTAX
     C                     END
     C                     END
     C/COPY WNCPYSRC,CG4010C028
      *
      ** Net Interest
     C           *LIKE     DEFN TOTI      ##NETA
     C           TOTI      SUB  ##TAXA    ##NETA
     C                     MOVEL##NETA    ##D,5
     C                     MOVE A6NBDP    ##D,5
      *
      ** Tax
     C                     MOVEL##TAXA    ##D,6
     C                     MOVE A6NBDP    ##D,6
      *
      ** Tax Indicator
     C/COPY WNCPYSRC,CG4010C017
     C                     MOVELTAXI      ##D,7
     C/COPY WNCPYSRC,CG4010C018
      *
      ** Net total (principal + net interest if interest not up-front, else
      **            principal - net interest)
      *
     C           *LIKE     DEFN PCPL      ##NETT
     C           FUID      IFNE 'Y'
     C           PCPL      ADD  ##NETA    ##NETT
     C                     ELSE
     C           PCPL      SUB  ##NETA    ##NETT
     C                     END
     C                     MOVEL##NETT    ##D,8
     C                     MOVE A6NBDP    ##D,8
      *
      ** Total Interest Override
     C                     TESTB'2'       DNSI           99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##D,9
     C                     ELSE
     C                     MOVEL'N'       ##D,9
     C                     END
      *
      ** Loan/Deposit Indicator
     C                     Z-ADD1         #1
     C           ##DTYP    LOKUP#LN,#1                   99*
     C           *IN99     IFEQ '1'
     C                     MOVEL'L'       ##D,10
     C                     ELSE
     C                     MOVEL'D'       ##D,10
     C                     END
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,11
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,12
      *
      ** Interest paid seperately
     C                     MOVELIPDS      ##D,13
      *
      ** Start or last interest date.
     C                     MOVELSLID      ##D,14
      *
      ** Conf. narrative
     C                     MOVELCNNA      ##D,15
      *
      ** C. D. reference
     C                     MOVELRNNA      ##D,16
     C*
     C           CEU014    IFEQ 'Y'
     C*
     C* If Settlement currency is not blank, convert Net total amount
     C*  from event currency to Settelent currency
     C*
     C           STCY      IFNE *BLANKS
     C                     MOVE CCY       W#FRCY
     C                     MOVE STCY      W#TOCY
     C                     Z-ADD##NETT    W#FRAM
     C                     MOVE STCY      ##CCY
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
      *
      ** Net Total amount in Settlement currency
     C                     MOVELW#TAMT    ##D,17
     C                     MOVE A6NBDP    ##D,17
     C                     ENDIF
     C*
     C* If the Event currency is 'In' or 'Euro', convert the Net total
     C*  amount to Equivalent currency.
     C*
     C                     MOVE *BLANKS   EQCY    3
     C                     MOVE CCY       ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Event is in 'In' currency, the Equivalent currency is
     C*  Euros.
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    EQCY
     C                     ENDIF
     C*
     C* If the Event is in 'Euro' currency, retrieve the 'In' currency
     C*  from Customer file.
     C           CCY       IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    EQCY
     C                     ENDIF
     C           EQCY      IFNE *BLANKS
     C                     MOVE EQCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE CCY       W#FRCY
     C                     MOVE EQCY      W#TOCY
     C                     Z-ADD##NETT    W#FRAM
     C                     EXSR D@EURO
      *
      ** Net Total amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,18
     C                     MOVE A6NBDP    ##D,18
      *
      ** Equivalent currency and description
     C                     MOVELEQCY      ##D,19
     C                     MOVELA6CYNM    ##D,20
     C                     ENDIF
     C*
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,CG4010C032
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXLAD     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@NAB                                          *
      * Function    :  NA Bought Details                              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@NAB     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_NAB '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_NAB ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELCCY       ##D,1
      *
      ** Face Value
     C                     MOVELFVAL      ##D,2
     C                     MOVELCCY       ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Issued/Discount Rate
     C           DTYP      IFEQ 'C1'
     C           DTYP      OREQ 'C2'
     C           DTYP      OREQ 'BP'
     C           DTYP      OREQ 'BD'
     C                     MOVELINTR      ##D,3
     C                     ELSE
     C                     MOVELYRAT      ##D,3
     C                     END
      *
      ** Yield Rate
     C           DTYP      IFEQ 'C2'
     C           DTYP      OREQ 'BP'
     C           DTYP      OREQ 'BD'
     C                     MOVELYRAT      ##D,4
     C                     ELSE
     C                     MOVEL*BLANK    ##D,4
     C                     END
      *
      ** Net Interest
     C           DTYP      IFEQ 'C1'
     C                     MOVELTOTI      ##D,5
     C                     ELSE
     C                     MOVEL*BLANK    ##D,5
     C                     END
     C                     MOVE A6NBDP    ##D,5
      *
      ** Net Total
     C           DTYP      IFEQ 'C1'
     C           FVAL      ADD  TOTI      ##W150
     C                     MOVEL##W150    ##D,6
     C                     ELSE
     C                     MOVELPUPR      ##D,6
     C                     END
     C                     MOVE A6NBDP    ##D,6
      *
      ** Purchase Price
     C                     MOVELPUPR      ##D,7
     C                     MOVE A6NBDP    ##D,7
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,8
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,9
     C*
     C           CEU014    IFEQ 'Y'
     C*
     C           STCY      IFNE *BLANKS
     C                     MOVE CCY       W#FRCY
     C                     MOVE STCY      W#TOCY
     C           DTYP      IFEQ 'C1'
     C                     Z-ADD##W150    W#FRAM
     C                     ELSE
     C                     Z-ADDPUPR      W#FRAM
     C                     END
     C                     MOVE STCY      ##CCY
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
      *
      ** Net Total amount in Settlement currency
     C                     MOVELW#TAMT    ##D,10           Net Total amnt
     C                     MOVE A6NBDP    ##D,10
     C                     Z-ADDPUPR      W#FRAM
     C                     EXSR D@EURO
      *
      ** Purchase price in Settlement currency
     C                     MOVELW#TAMT    ##D,11           Purchase Price
     C                     MOVE A6NBDP    ##D,11
     C                     ENDIF
     C*
     C* If the Event currency is 'In' or 'Euro', convert Net total
     C*   amount and Pruchase price to Equivalent currency.
     C*
     C                     MOVE *BLANKS   EQCY
     C                     MOVE CCY       ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Event currency is 'In' currency, then the Equivalent
     C*  currency is Euros.
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    EQCY
     C                     ENDIF
     C*
     C* If the Event currency is in 'Euro', the the Equivalent 'In'
     C*  currency is retrieved from Customer file.
     C           CCY       IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    EQCY
     C                     ENDIF
     C           EQCY      IFNE *BLANKS
     C                     MOVE EQCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE CCY       W#FRCY
     C                     MOVE EQCY      W#TOCY
     C           DTYP      IFEQ 'C1'
     C                     Z-ADD##W150    W#FRAM
     C                     ELSE
     C                     Z-ADDPUPR      W#FRAM
     C                     END
     C                     EXSR D@EURO
      *
      ** Net Total amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,12           Net Total amnt
     C                     MOVE A6NBDP    ##D,12
     C                     Z-ADDPUPR      W#FRAM
     C                     EXSR D@EURO
      *
      ** Purchase price in Equivalent currency
     C                     MOVELW#TAMT    ##D,13           Purchase Price
     C                     MOVE A6NBDP    ##D,13
     C*
     C* Equivalent currency and description
     C                     MOVELEQCY      ##D,14
     C                     MOVELA6CYNM    ##D,15
     C                     ENDIF
     C*
     C                     ENDIF
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNAB     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@NAS                                          *
      * Function    :  NA Sold Details                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@NAS     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_NAS '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_NAS ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Currency
     C                     MOVELCCY       ##D,1
      *
      ** Face Value
     C                     MOVELFVAL      ##D,2
     C                     MOVELCCY       ##CCY
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Issued/Discount Rate
     C           DTYP      IFEQ 'CS'
     C           DTYP      OREQ 'BS'
     C           DTYP      OREQ 'BR'
     C                     MOVELINTR      ##D,3
     C                     ELSE
     C                     MOVEL*BLANK    ##D,3
     C                     END
      *
      ** Yield Rate
     C                     MOVELYRAT      ##D,4
      *
      ** Sale Price
     C                     MOVELSAPR      ##D,5
     C                     MOVE A6NBDP    ##D,5
      *
      ** Currency Description
     C                     MOVELA6CYNM    ##D,6
      *
      ** Precious Metal Indicator
     C                     MOVELA6PMRT    ##D,7
     C*
     C           CEU014    IFEQ 'Y'
     C*
     C           STCY      IFNE *BLANKS
     C                     MOVE CCY       W#FRCY
     C                     MOVE STCY      W#TOCY
     C                     Z-ADDSAPR      W#FRAM           Sale Price
     C                     MOVE STCY      ##CCY
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
      *
      ** Sale price in Settlement currency
     C                     MOVELW#TAMT    ##D,8
     C                     MOVE A6NBDP    ##D,8
     C                     ENDIF
     C*
     C*
     C* If the Event currency is 'In' or 'Euro' currency, convert the
     C*  Sale price amount to Equivalent currency.
     C*
     C                     MOVE *BLANKS   EQCY
     C                     MOVE CCY       ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Event currency is 'In', the Equivalent currency is
     C*  Euros.
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    EQCY
     C                     ENDIF
     C*
     C* If the Event currency is in 'Euro', the Equivalent 'In'
     C*  currency is retrieved from Customer file.
     C           CCY       IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    EQCY
     C                     ENDIF
     C           EQCY      IFNE *BLANKS
     C                     MOVE EQCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE CCY       W#FRCY
     C                     MOVE EQCY      W#TOCY
     C                     Z-ADDSAPR      W#FRAM
     C                     EXSR D@EURO
      *
      ** Sale price in Equivalent currency
     C                     MOVELW#TAMT    ##D,9
     C                     MOVE A6NBDP    ##D,9
     C*
     C* Equivalent currency and description
     C                     MOVELEQCY      ##D,10
     C                     MOVELA6CYNM    ##D,11
     C                     ENDIF
     C*
     C                     ENDIF
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNAS     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@ONTN                                         *
      * Function    :  Our Name & Their Name                          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@ONTN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_ONTN'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_ONTN' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Our Name
     C                     MOVELBICRNM    ##D,1
      *
      ** Their Name
     C                     MOVELCPCRNM    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXONTN    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OPTD                                         *
      * Function    :  Option To Date                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@OPTD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_OPTD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_OPTD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Option To Date
     C                     MOVELOTDT      ##D,1
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOPTD    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OPTN                                         *
      * Function    :  Option Deal Number                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@OPTN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_OPTN'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_OPTN' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Option Deal Number
     C                     MOVELSODN      ##D,1
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOPTN    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OTH1                                         *
      * Function    :  Other Deal Details                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@OTH1    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_OTH1'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_OTH1' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Cancel/Amend
      *
     C           DTCHTP    IFEQ 'R'
     C           DTCHTP    OREQ 'A'
     C                     MOVELDTCHTP    ##D,1
     C                     END
      *
      ** Federal funds
     C                     EXSR SRDFED
     C                     MOVEL##FEDL    ##D,2            FROM SR/SRDFED
      *
      ** Auto-transmission
     C                     EXSR SRDAUT
     C                     MOVEL##AUTO    ##D,3            FROM SR/SRDAUT
      *
      ** Deal Type
     C                     MOVELDTYP      ##D,4
      *
      ** Deal Sub Type
     C                     MOVELDLST      ##D,5
     C/COPY WNCPYSRC,CG4010C019
      *                                                                                       CDL016
      ** Blocked Flag (extract for Fixed Deposits only)                                       CDL016
     C           CDL016    IFEQ 'Y'                                                           CDL016
     C           DTYP      IFEQ 'IP'                                                          CDL016
     C           DTYP      OREQ 'IT'                                                          CDL016
     C           DTYP      OREQ 'TD'                                                          CDL016
     C           DTYP      OREQ 'TI'                                                          CDL016
     C                     MOVELFSBLKA    ##D,6                                               CDL016
     C                     ENDIF                                                              CDL016
     C                     ENDIF                                                              CDL016
      *                                                                                       CDL016
      ** Fix Base Rate flag (extract for Fixed Deposits only)                                 CDL019
     C           CDL019    IFEQ 'Y'                                                           CDL019
     C           DTYP      IFEQ 'IP'                                                          CDL019
     C           DTYP      OREQ 'IT'                                                          CDL019
     C           DTYP      OREQ 'TD'                                                          CDL019
     C           DTYP      OREQ 'TI'                                                          CDL019
     C                     MOVELFSFBRT    ##D,7                                               CDL019
     C                     ENDIF                                                              CDL019
     C                     ENDIF                                                              CDL019
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOTH1    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@PARS                                         *
      * Function    :  Parcel Size                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@PARS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_PARS'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_PARS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Parcel Size
     C                     MOVELPSZE      ##D,1
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXPARS    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@PAYS                                         *
      * Function    :  Payment Settlement Instructions                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@PAYS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_PAYS'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           WFFLG     IFNE 'Y'                                                           CSW208
     C           1         OCUR ##SRDT
     C                     ELSE                                                               CSW208
     C           5         OCUR ##SRDT                                                        CSW208
     C                     ENDIF                                                              CSW208
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_PAYS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** DETERMINE SETTLEMENT INSTRUCTION FIELDS
      *
     C                     MOVEL'P'       ##PYRC           *Pay/Receive
     C*
     C           CEU003    IFEQ 'Y'
     C           ##PSCY    ANDNE*BLANKS
     C                     MOVEL##PSCY    ##CCY
     C                     ELSE
     C                     MOVEL##CCY     ##CCY            *Settlemt currn
     C                     ENDIF
     C*
     C                     MOVEL'N'       ##ROLL           *Rollover
      *
     C                     MOVELPSTM      ##SETP           *Settlemt type
     C                     MOVELPOBR      ##STBR           *Settlemt branch
     C                     MOVELPONS      ##OURN           *Our nostro/ A/C
     C           RVNO      IFNE *BLANK                     * RECEIVING MT100
     C           RCRN      IFNE *BLANK                     * RECEIVER CORRES
     C                     MOVELRCRN      ##THRN           *Their nostro
     C                     ELSE
     C                     MOVEL*HIVAL    ##THRN           *Their nostro
     C                     END                              = OUR NOSTRO
     C                     ELSE
     C                     MOVELAWBN      ##THRN           *Their nostro
     C                     END
     C                     MOVELBENN      ##FACO           *For account of
     C                     EXSR SRDSET
      *
      **  Payment - Our A/C - Line 1
     C                     MOVEL##OAC1    ##D,1
      *
      **  Payment - Our A/C - Line 2
     C                     MOVEL##OAC2    ##D,2
      *
      **  Payment - Our Nostro Name
     C                     MOVEL##ONN     ##D,3
      *
      **  Payment - Our Nostro Town
     C                     MOVEL##ONT     ##D,4
      *
      **  Payment - Our A/C (Gen.Led.)
     C                     MOVEL##OGA     ##D,5
      *
      **  Payment - Our A/C (Retail)
     C                     MOVEL##ORA     ##D,6
      *
      **  Payment - Their A/C - Line 1
     C                     MOVEL##TAC1    ##D,7
      *
      **  Payment - Their A/C - Line 2
     C                     MOVEL##TAC2    ##D,8
      *
      **  Payment - Their Nostro Name
     C                     MOVEL##TNN     ##D,9
      *
      **  Payment - Their Nostro Town
     C                     MOVEL##TNT     ##D,10
      *
      **  Payment - For A/C Of - Line 1
     C                     MOVEL##FAL1    ##D,11
      *
      **  Payment - For A/C Of - Line 2
     C                     MOVEL##FAL2    ##D,12
      *
      **  Payment - For A/C Of Name
     C                     MOVEL##FAN     ##D,13
      *
      **  Payment - For A/C Of Town
     C                     MOVEL##FAT     ##D,14
      *
      **  Special Instructions
     C                     MOVELSPI       ##D,15
      *
      **  Payment - Settlement Currency and Description
     C           CEU014    IFEQ 'Y'
     C           ##PSCY    ANDNE*BLANKS
     C                     MOVEL##PSCY    ##CCY
     C                     EXSR SRDCDT
     C                     MOVEL##PSCY    ##D,16
     C                     MOVELA6CYNM    ##D,17
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXPAYS    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  EX@PAY                                         *
      * Function    :  Other payment settlement instructions          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           EX@PAY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'EX@PAY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\ex_pay' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Set up data.
     C                     EXSR MOVDTA
      *
     C                     CALL 'CG4985'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM           P1PARM
     C                     PARM           P2PARM140        Path
     C                     PARM           W0CMT   3
     C                     PARM           P3PARM
     C                     PARM           ##REFR           Reference Name CCG015
     C                     PARM           P@ICR            Increment No   CCG015
     C                     PARM 'N'       ##MAST           Call Master PgmCCG015
      *
      **  Reset Sequence number.
     C                     Z-ADDP1OSEQ    ##OSEQ
     C                     Z-ADDP1TBIN    DETBIN
     C                     Z-ADDP1PBIN    DEPBIN
      *
      *................................................................
      *
     C           EXXPAY    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RCH                                          *
      * Function    :  Rate Change Details                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@RCH     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_RCH '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_RCH ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Next Rate Change Date
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUNICD     ##D,1
     C                     ELSE
     C                     MOVELTNICD     ##D,1
     C                     END
      *
      ** Rate Change Frequency
     C           OURTHR    IFEQ 'OUR'
     C                     MOVELUICFR     ##D,2
     C                     ELSE
     C                     MOVELTICFR     ##D,2
     C                     END
      *
      ** Rate Change Day
     C           OURTHR    IFEQ 'OUR'
     C           UICFD     IFNE *ZERO
     C                     MOVELUICFD     ##D,3
     C                     END
     C                     ELSE
     C           TICFD     IFNE *ZERO
     C                     MOVELTICFD     ##D,3
     C                     END
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXRCH     TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RCHO                                         *
      * Function    :  Our Rate Change Details                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@RCHO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_RCHO'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_RCHO' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Our Next Rate Change Date
     C                     MOVELUNICD     ##D,1
      *
      ** Our Rate Change Frequency
     C           CIR001    IFEQ 'Y'
     C           UICFR     ANDEQ'Z'
     C*
     C                     MOVEL'U'       W0OTIN
     C                     MOVEL'R'       W0RCIP
     C                     Z-ADDUNICD     W0ZDAY
     C                     EXSR #LDNDT
     C                     Z-ADDUNICD     W0NXDT
     C                     Z-ADDW0ZDAY    W0NNDT
     C*
     C                     EXSR #LDTFR
     C                     MOVELW0FREQ    ##D,2
     C*
     C                     ELSE
     C*
     C/COPY WNCPYSRC,CG4010CP10
     C*
     C                     MOVELUICFR     ##D,2
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CP11
     C*
      *
      ** Our Rate Change Day
     C           UICFD     IFNE *ZERO
     C                     MOVELUICFD     ##D,3
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXRCHO    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RCHT                                         *
      * Function    :  Their Rate Change Details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@RCHT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_RCHT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_RCHT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Their Next Rate Change Date
     C                     MOVELTNICD     ##D,1
      *
      ** Their Rate Change Frequency
     C           CIR001    IFEQ 'Y'
     C           TICFR     ANDEQ'Z'
     C*
     C                     MOVEL'T'       W0OTIN
     C                     MOVEL'R'       W0RCIP
     C                     Z-ADDTNICD     W0ZDAY
     C                     EXSR #LDNDT
     C*
     C                     Z-ADDTNICD     W0NXDT
     C                     Z-ADDW0ZDAY    W0NNDT
     C*
     C                     EXSR #LDTFR
     C                     MOVELW0FREQ    ##D,2
     C*
     C                     ELSE
     C*
     C/COPY WNCPYSRC,CG4010CP12
     C*
     C                     MOVELTICFR     ##D,2
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CP13
     C*
      *
      ** Their Rate Change Day
     C           TICFD     IFNE *ZERO
     C                     MOVELTICFD     ##D,3
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXRCHT    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RECS                                         *
      * Function    :  Receive Settlement Instructions                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@RECS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_RECS'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           WFFLG     IFNE 'Y'                                                           CSW208
     C           1         OCUR ##SRDT
     C                     ELSE                                                               CSW208
     C           4         OCUR ##SRDT                                                        CSW208
     C                     ENDIF                                                              CSW208
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_RECS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** DETERMINE SETTLEMENT INSTRUCTION FIELDS
      *
     C                     MOVEL'R'       ##PYRC           *Pay/Receive
     C*
     C           CEU003    IFEQ 'Y'
     C           ##RSCY    ANDNE*BLANKS
     C                     MOVEL##RSCY    ##CCY
     C                     ELSE
     C                     MOVEL##CCY     ##CCY            *Settlemt currncy
     C                     ENDIF
     C                     MOVEL'N'       ##ROLL           *Rollover
      *
     C                     MOVELRSTM      ##SETP           *Settlemt type
     C                     MOVELROBR      ##STBR           *Settlemt branch
     C                     MOVELRONS      ##OURN           *Our nostro/ A/C
     C                     MOVELRIBN      ##THRN           *Their nostro
     C                     MOVEL*BLANK    ##FACO           *For account of
     C                     EXSR SRDSET
      *
      **  Receive - Our A/C - Line 1
     C                     MOVEL##OAC1    ##D,1
      *
      **  Receive - Our A/C - Line 2
     C                     MOVEL##OAC2    ##D,2
      *
      **  Receive - Our Nostro Name
     C                     MOVEL##ONN     ##D,3
      *
      **  Receive - Our Nostro Town
     C                     MOVEL##ONT     ##D,4
      *
      **  Receive - Our A/C (Gen.Led.)
     C                     MOVEL##OGA     ##D,5
      *
      **  Receive - Our A/C (Retail)
     C                     MOVEL##ORA     ##D,6
      *
      **  Receive - Their A/C - Line 1
     C                     MOVEL##TAC1    ##D,7
      *
      **  Receive - Their A/C - Line 2
     C                     MOVEL##TAC2    ##D,8
      *
      **  Receive - Their Nostro Name
     C                     MOVEL##TNN     ##D,9
      *
      **  Receive - Their Nostro Town
     C                     MOVEL##TNT     ##D,10
      *
      **  Receive - Settlement Currency and Description
     C           CEU014    IFEQ 'Y'
     C           ##RSCY    ANDNE*BLANKS
     C                     MOVEL##RSCY    ##CCY
     C                     EXSR SRDCDT
     C                     MOVEL##RSCY    ##D,11
     C                     MOVELA6CYNM    ##D,12
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXRECS    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  EX@REC                                         *
      * Function    :  Other receipt settlement instructions          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           EX@REC    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'EX@REC'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\ex_rec' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Set up data.
     C                     EXSR MOVDTB
      *
     C                     CALL 'CG4975'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM           P6PARM
     C                     PARM           P4PARM140        Path
     C                     PARM           W0CMT   3
     C                     PARM           P5PARM
     C                     PARM           ##REFR           Reference Name CCG015
     C                     PARM           P@ICR            Increment No   CCG015
     C                     PARM 'N'       ##MAST           Call Master PgmCCG015
      *
      **  Reset Sequence number.
     C                     Z-ADDR1OSEQ    ##OSEQ
     C                     Z-ADDR1TBIN    DETBIN
     C                     Z-ADDR1PBIN    DEPBIN
      *
      *................................................................
      *
     C           EXXREC    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R@DEPR                                         *
      * Function    :  Process: REPEAT DEPOT MOVTS.                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R@DEPR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'R@DEPR'  @STK,Q
      *
     C           5         OCUR ##SRDT
      *
      **  Set up Path.
     C                     MOVEL'\R_DEPR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      *................................................................
     C*
     C** Check for Depot Movements on File
     C           DLNO      SETLLSEDPMVL3             89
     C           DLNO      READESEDPMVL3                 89
      *
     C           *IN89     DOWEQ*OFF
      *
      *
      **  Increment Bind Levels.
     C                     ADD  1         ##BNDC
     C                     Z-ADD##BNDC    S#TBIN
     C                     EXSR R@DEPM
     C           5         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Increment Bind Levels.
     C                     EXSR R@CRTR
     C           5         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
     C           DLNO      READESEDPMVL3                 89
     C                     ENDDO
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R@LAD                                          *
      * Function    :  Repo Transaction                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R@LAD     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'R_LAD'   @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           4         OCUR ##SRDT
      *
      **  Set up Path.
     C                     MOVEL'\R_LAD ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Set up Transaction Type
     C           DRID      IFEQ 'R'
     C           DTYP      ANDEQ'IT'
     C           DRID      OREQ 'R'
     C           DTYP      ANDEQ'CD'
     C           DRID      OREQ 'R'
     C           DTYP      ANDEQ'TD'
     C                     MOVEL'RP'      ##D,1
     C                     ENDIF
      *
     C           DRID      IFEQ 'R'
     C           DTYP      ANDEQ'IP'
     C           DRID      OREQ 'R'
     C           DTYP      ANDEQ'CL'
     C           DRID      OREQ 'R'
     C           DTYP      ANDEQ'TI'
     C                     MOVEL'RR'      ##D,1
     C                     ENDIF
      *
     C           DRID      IFEQ 'B'
     C           DTYP      ANDEQ'IT'
     C           DRID      OREQ 'B'
     C           DTYP      ANDEQ'CD'
     C           DRID      OREQ 'B'
     C           DTYP      ANDEQ'TD'
     C                     MOVEL'BL'      ##D,1
     C                     ENDIF
      *
     C           DRID      IFEQ 'B'
     C           DTYP      ANDEQ'IP'
     C           DRID      OREQ 'B'
     C           DTYP      ANDEQ'CL'
     C           DRID      OREQ 'B'
     C           DTYP      ANDEQ'TI'
     C                     MOVEL'BB'      ##D,1
     C                     ENDIF
      *
     C           DRID      IFEQ 'P'
     C           DTYP      ANDEQ'IT'
     C           DRID      OREQ 'P'
     C           DTYP      ANDEQ'CD'
     C           DRID      OREQ 'P'
     C           DTYP      ANDEQ'TD'
     C                     MOVEL'PD'      ##D,1
     C                     ENDIF
      *
     C           DRID      IFEQ 'P'
     C           DTYP      ANDEQ'IP'
     C           DRID      OREQ 'P'
     C           DTYP      ANDEQ'CL'
     C           DRID      OREQ 'P'
     C           DTYP      ANDEQ'TI'
     C                     MOVEL'PL'      ##D,1
     C                     ENDIF
      *
      ** Set up Total Maturity Proceeds
      *
      *
      ** Set up Settlement Method
      *
     C                     MOVELSDST      ##D,3
      *
      ** Set up Settlement Details
      *
     C           SDST      IFEQ 1
     C           SDST      OREQ 7
     C           SDST      OREQ 8
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'TI'
     C*
     C                     CALL 'AONOSTR0'
     C           W@RTCD    PARM *BLANKS   P@RTCD  7                             B:Return code
     C                     PARM '*KEY   ' P@OPTN  7                             I:Option       S0123
     C                     PARM *BLANKS   P@CUST  6                             I:Customer No  S0123
     C                     PARM CCY       P@CYCD  3                             I:Currency     S0123
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C                     PARM *BLANKS   P@ACCD 10                                           CGL029
     C                     PARM *BLANKS   P@ACSN  2                             I:A/c Seq      S0123
     C                     PARM OSDA      P@NONB  2                             I:Nostro No    S0123
     C                     PARM *BLANKS   P@BRCD  3                             I:Branch Code  S0123
     C                     PARM *BLANKS   P@CSSN 10                             I:Cust ShortN  S0123
     C                     PARM           P@PNOI  1                             I:Prime Nost InS0123
     C           SDNOST    PARM SDNOST    DSFDY                                 O:Format
     C*
     C           P@RTCD    IFNE *BLANK
     C                     MOVEL'SDNOSTPD'W0FILE
     C                     MOVELP@NONB    W0KEY            ***************
     C                     Z-ADD34        W0ERNB           * DB ERROR 34 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ELSE
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A7CUST    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA7CUST    W0KEY            ***************
     C                     Z-ADD35        W0ERNB           * DB ERROR 35 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,4
     C                     MOVELBBCRTN    ##D,5
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'TD'
     C*
     C           TSTN      IFNE *BLANKS
     C*
     C           *LIKE     DEFN P@RTCD    W@RTCD
     C*****************    CALL 'AONOSTR0'                                                  BUG10220
     C***********W@RTCD    PARM *BLANKS   P@RTCD  7                   B:Return code         BUG10220
     C*****************    PARM '*KEY   ' P@OPTN  7                   I:Option       S0123  BUG10220
     C*****************    PARM *BLANKS   P@CUST  6                   I:Customer No  S0123  BUG10220
     C*****************    PARM CCY       P@CYCD  3                   I:Currency     S0123  BUG10220
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C*****************    PARM *BLANKS   P@ACCD                                    CGL029  BUG10220
     C*****************    PARM *BLANKS   P@ACSN  2                   I:A/c Seq      S0123  BUG10220
     C*****************    PARM TSTN      P@NONB  2                   I:Nostro No    S0123  BUG10220
     C*****************    PARM *BLANKS   P@BRCD  3                   I:Branch Code  S0123  BUG10220
     C*****************    PARM *BLANKS   P@CSSN 10                   I:Cust ShortN  S0123  BUG10220
     C*****************    PARM           P@PNOI  1                   I:Prime Nost InS0123  BUG10220
     C***********SDNOST    PARM SDNOST    DSFDY                       O:Format              BUG10220
     C*****************                                                                     BUG10220
     C***********P@RTCD    IFNE *BLANK                                                      BUG10220
     C*****************    MOVEL'SDNOSTPD'W0FILE                                            BUG10220
     C*****************    MOVELP@NONB    W0KEY            ***************                  BUG10220
     C*****************    Z-ADD36        W0ERNB           * DB ERROR 36 *                  BUG10220
     C*****************    MOVEL'MEM5004' W0MSGD           ***************                  BUG10220
     C*****************    MOVEL'MIDAS  ' W0MSGF                                            BUG10220
     C*****************    EXSR SRERR                                                       BUG10220
     C*****************    ELSE                                                             BUG10220
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR0'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C*****************    PARM A7CUST    ##KEY1 10                                         BUG10220
     C                     PARM TSTN      ##KEY1 10                                         BUG10220
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
      *                                                                                     BUG10220
      *  Call to access pgm for counterparty nostro details.                                BUG10220
      *                                                                                     BUG10220
     C                     MOVELTSTN      @CSNM1                                            BUG10220
     C                     MOVE *BLANK    ##RTCD                                            BUG10220
      *                                                                                     BUG10220
     C                     CALL 'AOCNSTR0'                                                  BUG10220
     C                     PARM *BLANKS   ##RTCD           B:Return code                    BUG10220
     C                     PARM '*KEY'    P@OPTN  7        I:Option                         BUG10220
     C                     PARM           @CSNM1  8        I:Key field                      BUG10220
     C           SDCNST    PARM SDCNST    DSSDY                                             BUG10220
      *                                                                                     BUG10220
     C           ##RTCD    IFNE *BLANK                                                      BUG10220
     C                     MOVEL'SDCUSTPD'W0FILE
     C*****************    MOVELA7CUST    W0KEY            ***************                  BUG10220
     C                     MOVEL@CSNM1    W0KEY            ***************                  BUG10220
     C                     Z-ADD37        W0ERNB           * DB ERROR 37 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *                                                                                     BUG10220
     C                     ELSE                                                             BUG10220
      *                                                                                     BUG10220
      *  Counterparty Nostro name and Counterparty Nostro Town.                             BUG10220
      *                                                                                     BUG10220
     C                     MOVELAWCPNM    ##D,4                                             BUG10220
     C                     MOVELAWCNTN    ##D,5                                             BUG10220
     C                     END                                                              BUG10220
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,4
     C                     MOVELBBCRTN    ##D,5
     C***************      END                                                              BUG10220
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'TD'
     C*
     C                     CALL 'AONOSTR0'
     C           W@RTCD    PARM *BLANKS   P@RTCD  7                             B:Return code
     C                     PARM '*KEY   ' P@OPTN  7                             I:Option       S0123
     C                     PARM *BLANKS   P@CUST  6                             I:Customer No  S0123
     C                     PARM CCY       P@CYCD  3                             I:Currency     S0123
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C                     PARM *BLANKS   P@ACCD                                              CGL029
     C                     PARM *BLANKS   P@ACSN  2                             I:A/c Seq      S0123
     C                     PARM OSDA      P@NONB  2                             I:Nostro No    S0123
     C                     PARM *BLANKS   P@BRCD  3                             I:Branch Code  S0123
     C                     PARM *BLANKS   P@CSSN 10                             I:Cust ShortN  S0123
     C                     PARM           P@PNOI  1                             I:Prime Nost InS0123
     C           SDNOST    PARM SDNOST    DSFDY                                 O:Format
     C*
     C           P@RTCD    IFNE *BLANK
     C                     MOVEL'SDNOSTPD'W0FILE
     C                     MOVELP@NONB    W0KEY            ***************
     C                     Z-ADD38        W0ERNB           * DB ERROR 38 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ELSE
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A7CUST    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA7CUST    W0KEY            ***************
     C                     Z-ADD39        W0ERNB           * DB ERROR 39 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,6
     C                     MOVELBBCRTN    ##D,7
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'TI'
     C*
     C           TSTN      IFNE *BLANKS
     C*****************                                                                     BUG10220
     C*****************    CALL 'AONOSTR0'                                                  BUG10220
     C***********W@RTCD    PARM *BLANKS   P@RTCD  7                    B:Return code        BUG10220
     C*****************    PARM '*KEY   ' P@OPTN  7                    I:Option       S0123 BUG10220
     C*****************    PARM *BLANKS   P@CUST  6                    I:Customer No  S0123 BUG10220
     C*****************    PARM CCY       P@CYCD  3                    I:Currency     S0123 BUG10220
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C*****************    PARM *BLANKS   P@ACCD                                     CGL029 BUG10220
     C*****************    PARM *BLANKS   P@ACSN  2                    I:A/c Seq      S0123 BUG10220
     C*****************    PARM TSTN      P@NONB  2                    I:Nostro No    S0123 BUG10220
     C*****************    PARM *BLANKS   P@BRCD  3                    I:Branch Code  S0123 BUG10220
     C*****************    PARM *BLANKS   P@CSSN 10                    I:Cust ShortN  S0123 BUG10220
     C*****************    PARM           P@PNOI  1                    I:Prime Nost InS0123 BUG10220
     C***********SDNOST    PARM SDNOST    DSFDY                        O:Format             BUG10220
     C*****************                                                                     BUG10220
     C***********P@RTCD    IFNE *BLANK                                                      BUG10220
     C*****************    MOVEL'SDNOSTPD'W0FILE                                            BUG10220
     C*****************    MOVELP@NONB    W0KEY            ***************                  BUG10220
     C*****************    Z-ADD40        W0ERNB           * DB ERROR 40 *                  BUG10220
     C*****************    MOVEL'MEM5004' W0MSGD           ***************                  BUG10220
     C*****************    MOVEL'MIDAS  ' W0MSGF                                            BUG10220
     C*****************    EXSR SRERR                                                       BUG10220
     C*****************    ELSE                                                             BUG10220
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C*****************    PARM A7CUST    ##KEY1 10                                         BUG10220
     C                     PARM TSTN      ##KEY1 10                                         BUG10220
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
      *                                                                                     BUG10220
      *  Call to access pgm for counterparty nostro details.                                BUG10220
      *                                                                                     BUG10220
     C                     MOVELTSTN      @CSNM1                                            BUG10220
     C                     MOVE *BLANK    ##RTCD                                            BUG10220
      *                                                                                     BUG10220
     C                     CALL 'AOCNSTR0'                                                  BUG10220
     C                     PARM *BLANKS   ##RTCD           B:Return code                    BUG10220
     C                     PARM '*KEY'    P@OPTN  7        I:Option                         BUG10220
     C                     PARM           @CSNM1  8        I:Key field                      BUG10220
     C           SDCNST    PARM SDCNST    DSSDY                                             BUG10220
      *                                                                                     BUG10220
     C           ##RTCD    IFNE *BLANK                                                      BUG10220
     C                     MOVEL'SDCUSTPD'W0FILE
     C*****************    MOVELA7CUST    W0KEY            ***************                  BUG10220
     C                     MOVEL@CSNM1    W0KEY            ***************                  BUG10220
     C                     Z-ADD41        W0ERNB           * DB ERROR 41 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ELSE                                                             BUG10220
      *                                                                                     BUG10220
      *  Counterparty Nostro name and Counterparty Nostro Town.                             BUG10220
      *                                                                                     BUG10220
     C                     MOVELAWCPNM    ##D,6                                             BUG10220
     C                     MOVELAWCNTN    ##D,7                                             BUG10220
     C                     END                                                              BUG10220
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,6
     C                     MOVELBBCRTN    ##D,7
     C*****************    END                                                              BUG10220
     C                     END
     C                     END
     C                     END
     C*
     C           DTYP      IFNE 'IP'
     C           DTYP      ANDNE'CL'
     C           DTYP      ANDNE'TI'
     C*
     C                     MOVEL*BLANKS   ##D,8
     C                     MOVEL*BLANKS   ##D,9
     C*
     C                     ELSE
      *
      ** Get Customer Details for For account of customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM FACO      ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELFACO      W0KEY            ***************
     C                     Z-ADD42        W0ERNB           * DB ERROR 42 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVE CNUM      W#CUST  6
     C*
     C           BBCUST    IFEQ W#CUST
     C                     MOVEL##TXT,1   ##D,8
     C                     MOVEL*BLANKS   ##D,9
     C                     ELSE
      *
      ** Get Customer Details for For account of customer
      *
     C                     MOVELCNUM      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELCNUM      W0KEY            ***************
     C                     Z-ADD43        W0ERNB           * DB ERROR 43 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCRNM    ##D,8
     C                     MOVELBBCRTN    ##D,9
      *
     C                     END
     C                     END
     C*
     C                     END
     C*
     C           SDST      IFEQ 4
     C                     MOVELOSDA      ##D,4
     C                     MOVEL*BLANKS   ##D,5
     C                     MOVELOSDA      ##D,6
     C                     MOVEL*BLANKS   ##D,7
     C                     MOVEL*BLANKS   ##D,8
     C                     MOVEL*BLANKS   ##D,9
     C*
     C                     END
     C*
     C           SDST      IFEQ 14
     C                     MOVELOSDA      W#OSDT 10
     C                     MOVE W#OSDT    W#OSDA 100
     C           W#OSDA    CHAINACCNTL1              89
      *
      ** Set Up Account Details
     C                     MOVE '-'       W#DSH1
     C                     MOVE '-'       W#DSH2
     C                     MOVE '-'       W#DSH3
     C                     MOVE CNUM      W#CNUM
     C                     MOVELACOD      W#ACOD
     C                     MOVE ACSQ      W#ACSQ
     C                     MOVELCCY       W#CCY
     C                     MOVELW#ACCN    ##D,4
     C                     MOVEL*BLANKS   ##D,5
     C                     MOVELW#ACCN    ##D,6
     C                     MOVEL*BLANKS   ##D,7
     C                     MOVEL*BLANKS   ##D,8
     C                     MOVEL*BLANKS   ##D,9
     C*
     C                     END
      *
      ** Set up Settlement Details
      *
     C           MDST      IFEQ 1
     C           MDST      OREQ 7
     C           MDST      OREQ 8
      *
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'TD'
     C*
     C                     CALL 'AONOSTR0'
     C           W@RTCD    PARM *BLANKS   P@RTCD  7                             B:Return code
     C                     PARM '*KEY   ' P@OPTN  7                             I:Option       S0123
     C                     PARM *BLANKS   P@CUST  6                             I:Customer No  S0123
     C                     PARM CCY       P@CYCD  3                             I:Currency     S0123
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C                     PARM *BLANKS   P@ACCD                                              CGL029
     C                     PARM *BLANKS   P@ACSN  2                             I:A/c Seq      S0123
     C                     PARM OMDA      P@NONB  2                             I:Nostro No    S0123
     C                     PARM *BLANKS   P@BRCD  3                             I:Branch Code  S0123
     C                     PARM *BLANKS   P@CSSN 10                             I:Cust ShortN  S0123
     C                     PARM           P@PNOI  1                             I:Prime Nost InS0123
     C           SDNOST    PARM SDNOST    DSFDY                                 O:Format
     C*
     C           P@RTCD    IFNE *BLANK
     C                     MOVEL'SDNOSTPD'W0FILE
     C                     MOVELP@NONB    W0KEY            ***************
     C                     Z-ADD49        W0ERNB           * DB ERROR 49 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ELSE
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A7CUST    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA7CUST    W0KEY            ***************
     C                     Z-ADD50        W0ERNB           * DB ERROR 50 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,10
     C                     MOVELBBCRTN    ##D,11
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'TI'
     C*
     C           TMAN      IFNE *BLANKS
     C*
     C**********           CALL 'AONOSTR0'                                                    243683
     C********** W@RTCD    PARM *BLANKS   P@RTCD  7                     B:Return code         243683
     C**********           PARM '*KEY   ' P@OPTN  7                     I:Option        S0123 243683
     C**********           PARM *BLANKS   P@CUST  6                     I:Customer No   S0123 243683
     C**********           PARM CCY       P@CYCD  3                     I:Currency      S0123 243683
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C**********           PARM *BLANKS   P@ACCD                                       CGL029 243683
     C**********           PARM *BLANKS   P@ACSN  2                     I:A/c Seq       S0123 243683
     C**********           PARM TMAN      P@NONB  2                     I:Nostro No     S0123 243683
     C**********           PARM *BLANKS   P@BRCD  3                     I:Branch Code   S0123 243683
     C**********           PARM *BLANKS   P@CSSN 10                     I:Cust ShortN   S0123 243683
     C**********           PARM           P@PNOI  1                     I:Prime Nost In S0123 243683
     C********** SDNOST    PARM SDNOST    DSFDY                         O:Format              243683
     C*
     C********** P@RTCD    IFNE *BLANK                                                        243683
     C**********           MOVEL'SDNOSTPD'W0FILE                                              243683
     C**********           MOVELP@NONB    W0KEY            ***************                    243683
     C**********           Z-ADD51        W0ERNB           * DB ERROR 51 *                    243683
     C**********           MOVEL'MEM5004' W0MSGD           ***************                    243683
     C**********           MOVEL'MIDAS  ' W0MSGF                                              243683
     C**********           EXSR SRERR                                                         243683
     C**********           ELSE                                                               243683
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C**********           PARM A7CUST    ##KEY1 10                                           243683
     C                     PARM TMAN      ##KEY1 10                                           243683
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
      *                                                                                       243683
      *  Call to access pgm for counterparty nostro details.                                  243683
      *                                                                                       243683
     C                     MOVELTMAN      @CSNM1                                              243683
     C                     MOVE *BLANK    ##RTCD                                              243683
      *                                                                                       243683
     C                     CALL 'AOCNSTR0'                                                    243683
     C                     PARM *BLANKS   ##RTCD           B:Return code                      243683
     C                     PARM '*KEY'    P@OPTN  7        I:Option                           243683
     C                     PARM           @CSNM1  8        I:Key field                        243683
     C           SDCNST    PARM SDCNST    DSSDY                                               243683
      *                                                                                       243683
     C           ##RTCD    IFNE *BLANK                                                        243683
     C                     MOVEL'SDCUSTPD'W0FILE
     C**********           MOVELA7CUST    W0KEY            ***************                    243683
     C                     MOVEL@CSNM1    W0KEY            ***************                    243683
     C                     Z-ADD37        W0ERNB           * DB ERROR 37 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *                                                                                       243683
     C                     ELSE                                                               243683
      *                                                                                       243683
      *  Counterparty Nostro name and Counterparty Nostro Town.                               243683
      *                                                                                       243683
     C                     MOVELAWCPNM    ##D,10                                              243683
     C                     MOVELAWCNTN    ##D,11                                              243683
     C                     END                                                                243683
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,10
     C                     MOVELBBCRTN    ##D,11
     C**********           END                                                                243683
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'TI'
     C*
     C                     CALL 'AONOSTR0'
     C           W@RTCD    PARM *BLANKS   P@RTCD  7                             B:Return code
     C                     PARM '*KEY   ' P@OPTN  7                             I:Option       S0123
     C                     PARM *BLANKS   P@CUST  6                             I:Customer No  S0123
     C                     PARM CCY       P@CYCD  3                             I:Currency     S0123
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C                     PARM *BLANKS   P@ACCD                                              CGL029
     C                     PARM *BLANKS   P@ACSN  2                             I:A/c Seq      S0123
     C                     PARM OMDA      P@NONB  2                             I:Nostro No    S0123
     C                     PARM *BLANKS   P@BRCD  3                             I:Branch Code  S0123
     C                     PARM *BLANKS   P@CSSN 10                             I:Cust ShortN  S0123
     C                     PARM           P@PNOI  1                             I:Prime Nost InS0123
     C           SDNOST    PARM SDNOST    DSFDY                                 O:Format
     C*
     C           P@RTCD    IFNE *BLANK
     C                     MOVEL'SDNOSTPD'W0FILE
     C                     MOVELP@NONB    W0KEY            ***************
     C                     Z-ADD53        W0ERNB           * DB ERROR 53 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ELSE
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A7CUST    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA7CUST    W0KEY            ***************
     C                     Z-ADD54        W0ERNB           * DB ERROR 54 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,12
     C                     MOVELBBCRTN    ##D,13
     C                     END
     C                     END
     C                     END
      *
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'TD'
     C*
     C           TMAN      IFNE *BLANKS
     C*
     C**********           CALL 'AONOSTR0'                                                    243683
     C********** W@RTCD    PARM *BLANKS   P@RTCD  7                     B:Return code         243683
     C**********           PARM '*KEY   ' P@OPTN  7                     I:Option        S0123 243683
     C**********           PARM *BLANKS   P@CUST  6                     I:Customer No   S0123 243683
     C**********           PARM CCY       P@CYCD  3                     I:Currency      S0123 243683
     C**********           PARM *BLANKS   P@ACCD  4                      I:A/c Code     S0123 CGL029
     C**********           PARM *BLANKS   P@ACCD                                       CGL029 243683
     C**********           PARM *BLANKS   P@ACSN  2                     I:A/c Seq       S0123 243683
     C**********           PARM TMAN      P@NONB  2                     I:Nostro No     S0123 243683
     C**********           PARM *BLANKS   P@BRCD  3                     I:Branch Code   S0123 243683
     C**********           PARM *BLANKS   P@CSSN 10                     I:Cust ShortN   S0123 243683
     C**********           PARM           P@PNOI  1                     I:Prime Nost In S0123 243683
     C********** SDNOST    PARM SDNOST    DSFDY                         O:Format              243683
     C*
     C********** P@RTCD    IFNE *BLANK                                                        243683
     C**********           MOVEL'SDNOSTPD'W0FILE                                              243683
     C**********           MOVELP@NONB    W0KEY            ***************                    243683
     C**********           Z-ADD56        W0ERNB           * DB ERROR 56 *                    243683
     C**********           MOVEL'MEM5004' W0MSGD           ***************                    243683
     C**********           MOVEL'MIDAS  ' W0MSGF                                              243683
     C**********           EXSR SRERR                                                         243683
     C**********           ELSE                                                               243683
      *
      ** Get Customer Details for Nostro Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C**********           PARM A7CUST    ##KEY1 10                                           243683
     C                     PARM TMAN      ##KEY1 10                                           243683
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
      *                                                                                       243683
      *  Call to access pgm for counterparty nostro details.                                  243683
      *                                                                                       243683
     C                     MOVELTMAN      @CSNM1                                              243683
     C                     MOVE *BLANK    ##RTCD                                              243683
      *                                                                                       243683
     C                     CALL 'AOCNSTR0'                                                    243683
     C                     PARM *BLANKS   ##RTCD           B:Return code                      243683
     C                     PARM '*KEY'    P@OPTN  7        I:Option                           243683
     C                     PARM           @CSNM1  8        I:Key field                        243683
     C           SDCNST    PARM SDCNST    DSSDY                                               243683
      *                                                                                       243683
     C           ##RTCD    IFNE *BLANK                                                        243683
     C                     MOVEL'SDCUSTPD'W0FILE
     C**********           MOVELA7CUST    W0KEY            ***************                    243683
     C                     MOVEL@CSNM1    W0KEY            ***************                    243683
     C                     Z-ADD57        W0ERNB           * DB ERROR 57 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
      *                                                                                       243683
     C                     ELSE                                                               243683
      *                                                                                       243683
      *  Counterparty Nostro name and Counterparty Nostro Town.                               243683
      *                                                                                       243683
     C                     MOVELAWCPNM    ##D,12                                              243683
     C                     MOVELAWCNTN    ##D,13                                              243683
     C                     END                                                                243683
      *
     C                     ELSE
      *
      ** Set up Customer Report Name and Town
      *
     C                     MOVELBBCRNM    ##D,12
     C                     MOVELBBCRTN    ##D,13
     C**********           END                                                                243683
     C                     END
     C                     END
     C                     END
     C*
     C           DTYP      IFNE 'IT'
     C           DTYP      ANDNE'CD'
     C           DTYP      ANDNE'TD'
     C*
     C                     MOVEL*BLANKS   ##D,14
     C                     MOVEL*BLANKS   ##D,15
     C*
     C                     ELSE
      *
      ** Get Customer Details for For account of customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM FACO      ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELFACO      W0KEY            ***************
     C                     Z-ADD42        W0ERNB           * DB ERROR 42 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVE CNUM      W#CUST  6
     C*
     C           BBCUST    IFEQ W#CUST
     C                     MOVEL##TXT,1   ##D,14
     C                     MOVEL*BLANKS   ##D,15
     C                     ELSE
      *
      ** Get Customer Details for For account of customer
      *
     C                     MOVELCNUM      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELCNUM      W0KEY            ***************
     C                     Z-ADD43        W0ERNB           * DB ERROR 43 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCRNM    ##D,14
     C                     MOVELBBCRTN    ##D,15
      *
     C                     END
     C                     END
     C*
     C                     END
     C*
     C           MDST      IFEQ 4
     C                     MOVELOMDA      ##D,10
     C                     MOVEL*BLANKS   ##D,11
     C                     MOVELOMDA      ##D,12
     C                     MOVEL*BLANKS   ##D,13
     C                     MOVEL*BLANKS   ##D,14
     C                     MOVEL*BLANKS   ##D,15
     C*
     C                     END
     C*
     C           MDST      IFEQ 14
     C                     MOVELOMDA      W#OMDT 10
     C                     MOVE W#OMDT    W#OMDA 100
     C           W#OMDA    CHAINACCNTL1              89
      *
      ** Set Up Account Details
     C                     MOVE '-'       W#DSH1
     C                     MOVE '-'       W#DSH2
     C                     MOVE '-'       W#DSH3
     C                     MOVE CNUM      W#CNUM
     C                     MOVELACOD      W#ACOD
     C                     MOVE ACSQ      W#ACSQ
     C                     MOVE CCY       W#CCY
     C                     MOVELW#ACCN    ##D,10
     C                     MOVEL*BLANKS   ##D,11
     C                     MOVELW#ACCN    ##D,12
     C                     MOVEL*BLANKS   ##D,13
     C                     MOVEL*BLANKS   ##D,14
     C                     MOVEL*BLANKS   ##D,15
     C*
     C                     END
     C*
     C           SPI       IFNE *BLANKS
     C                     MOVELSPI       ##D,16
     C                     ELSE
     C                     MOVEL*BLANKS   ##D,16
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C                     ENDSR
     C*
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R@DEPM                                         *
      * Function    :  Repo Transaction Extract                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R@DEPM    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'R_DEPM'  @STK,Q
      *
      **  Retrieve subroutine specific data.
     C           9         OCUR ##SRDT
      *
      **  Set up Path.
     C                     MOVEL'\R_DEPM' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Set up Reference
     C                     MOVELDLNO      ##D,1
      *
      ** Set up Depot Movement reference
     C                     MOVELDPRN      ##D,2
      *
      ** Set up Security Shortname
     C                     MOVELDPSS      ##D,3
      *
      ** Set up Security Report Name
     C           DPSS      CHAINSECTY                89
     C                     MOVELSRPN      ##D,4
      *
      ** Set up Depot Maturity Date
     C           DPMD      IFGT DPDO
     C                     MOVELDPMD      ##D,5
     C                     ELSE
     C                     MOVELDPDO      ##D,5
     C                     ENDIF
     C** Set up Nominal
     C                     MOVELDPNA      ##D,6
     C                     MOVELNMCY      ##CCY                           245715
     C                     EXSR SRDCDT                                    245715
     C                     MOVE A6NBDP    ##D,6                           245715
      *
      ** Set up Nominal Ccy
     C                     MOVELNMCY      ##D,7
     C*
     C** Set Switch Indicator
     C                     MOVELSWRF      ##D,8
     C*
     C** Set Switch Indicator
     C                     MOVELRECORD    ##D,9
     C                     MOVE 'N'       RECORD  1
     C*
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C                     ENDSR
      *
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R@CRTR                                         *
      * Function    :  Process: Certificates Details                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R@CRTR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'R@CRTR'  @STK,Q
      *
      *................................................................
      *
     C           7         OCUR ##SRDT
      *
      **  Set up Path.
     C                     MOVEL'\R_CRTR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      *................................................................
     C*
     C** Check for Certificates on File
     C           DPRN      SETLLSECRTNL1             89
     C           DPRN      READESECRTNL1                 89
     C*
     C           *IN89     DOWEQ*OFF
      *
      ** Set Flag to indicate Certificate Numbers for Depot Movement
     C                     MOVE 'Y'       CERT
      *
      **  Increment Bind Levels.
     C                     Z-ADD##TBIN    S#PBIN
     C                     ADD  1         ##BNDC
     C                     Z-ADD##BNDC    S#TBIN
     C                     EXSR R@CERT
     C           7         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
     C           DPRN      READESECRTNL1                 89
     C                     ENDDO
      *
     C           CERT      IFNE 'Y'
      *
      **  Increment Bind Levels.
     C                     Z-ADD##TBIN    S#PBIN
     C                     ADD  1         ##BNDC
     C                     Z-ADD##BNDC    S#TBIN
     C                     EXSR R@CERT
     C           7         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
     C                     Z-ADD##PBIN    S#PBIN
     C                     Z-ADD##TBIN    S#TBIN
      *
     C                     ENDIF
      *
     C                     MOVE ' '       CERT    1
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      * Subroutine  :  R@CERT                                         *
      * Function    :  Repo Certificates Extract                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R@CERT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'R_CERT'  @STK,Q
      *
      **  Retrieve subroutine specific data.
     C           8         OCUR ##SRDT
      *
      **  Set up Path.
     C                     MOVEL'\R_CERT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C           CERT      IFEQ 'Y'
     C           CNRNN2    IFEQ 0
     C                     MOVELCNRNN1    ##D,1
     C                     MOVEL*BLANKS   ##D,2
     C                     ELSE
     C                     MOVELCNRNN1    ##D,1
     C                     MOVELCNRNN2    ##D,2
     C                     MOVELCNUNIT    ##D,3
     C                     ENDIF
      *
      ** Default in 'N' if no certificates exist so that record is
      ** output.
     C                     ELSE
     C                     MOVEL'N'       ##D,4
     C                     ENDIF
      *
      ** Set up Depot Movement reference
     C                     MOVELDPRN      ##D,5
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C                     MOVE 'N'       RECORD  1
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C                     ENDSR
      *
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@ROLD                                         *
      * Function    :  Rollover Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           D@ROLD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D_ROLD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\D_ROLD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Rollover Deal Number
     C                     MOVELRODN      ##D,1
      *
      ** Save current deal number
     C           *LIKE     DEFN DLNO      S#DLNO
     C                     Z-ADDDLNO      S#DLNO
      *
      ** Access rolled over deal and store amount due at maturity of deal
      *
     C                     Z-ADDRODN      DLNO
     C                     EXSR SRDEAL
     C/COPY WNCPYSRC,CG4010C010
     C           IPDS      IFEQ 'Y'
     C                     Z-ADDPCPL      ##W150
     C                     ELSE
     C           PCPL      ADD  TOTI      ##W150
     C                     END
     C/COPY WNCPYSRC,CG4010C011
      *
      ** Recover current deal
      ***(it*is*the*rolled*over*by*deal*number*on*the*rolled*over*deal)
      ** use saved value, because if current deal reversed, RBDN will
      ** have been set to 000000 on the rolled over deal.
      *
     C******************** Z-ADDRBDN      DLNO
     C                     Z-ADDS#DLNO    DLNO
     C                     EXSR SRDEAL
      *
     C           CEU015    IFEQ 'Y'
     C           RTFC      ANDNE*BLANKS
     C                     Z-ADD##W150    P@FRAM
     C                     MOVELRTFC      P@FRCY
     C                     MOVELCCY       P@TOCY
      *
      ** Convert ##W150 to deal currency equivalent
      *
     C                     CALL 'EU0200'
     C                     PARM *BLANKS   P@RTCD  7
     C                     PARM           P@FRAM 183
     C                     PARM           P@FRCY  3
     C                     PARM           P@TOCY  3
     C                     PARM           P@OUTA 150
     C                     PARM           P@INTA 183
     C                     PARM           P@EXRT 159
     C                     PARM           P@MDIN  1
      *
      ** Database error processing if P@RTCD = *ERROR
      *
     C           P@RTCD    IFEQ '*ERROR*'
     C                     MOVEL'EU0200  'W0FILE           ***************
     C                     MOVELP@RTCD    W0KEY            * DB ERROR 31 *
     C                     Z-ADD31        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     Z-ADDP@OUTA    ##W150
     C                     ENDIF
      *
      ** Calculate the Rollover Capital Change
      *
     C                     SUB  PCPL      ##W150
     C           ##W150    IFLT 0
     C                     Z-SUB##W150    ##W150
     C                     MOVE 'IN'      ##INDE  2
     C                     ELSE
     C                     MOVE 'DE'      ##INDE
     C                     END
      *
     C                     MOVEL##W150    ##D,2
     C                     MOVELCCY       ##CCY
     C                     EXSR SRDCDT
     C                     MOVELA6NBDP    ##D,2
      *
      ** Rollover Capital Indicator
     C                     MOVEL##INDE    ##D,3
      *
     C/COPY WNCPYSRC,CG4010C012
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXROLD    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/COPY WNCPYSRC,CG4010C022
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  MATURD                                         *
      * Function    :  Maturity Date                                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           MATURD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MATURD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\MATURD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Maturity Date
     C                     MOVELMDAT      ##D,1
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXMATU    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  NOTICD                                         *
      * Function    :  Notice Days                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           NOTICD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'NOTICD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\NOTICD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Notice days
     C           NOTD      IFEQ -999
     C                     MOVEL'-999'    ##D,1
     C                     ELSE
     C                     MOVELNOTD      ##D,1
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNOTI    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRAUTO                                         *
      * Function    :  Auto transmission processing                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRAUTO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRAUTO'  @STK,Q
      *
      *................................................................
      *
      ** Get Branch Details
      *
     C           BRCA      IFNE ##BRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD27        W0ERNB           * DB ERROR 27 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
      *
      ** Get Customer Details for Branch Internal Customer
      *
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A8BICN    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA8BICN    W0KEY            ***************
     C                     Z-ADD28        W0ERNB           * DB ERROR 28 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Store Booking Branch, Branch Internal Customer Number and Name
      *
     C                     MOVELBRCA      BBBRCA
     C                     MOVELBBCUST    BBBICN
     C                     MOVELBBCRNM    BICRNM
      *
      ** Store : Sender's (i.e. Branch)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      ** (All used in message routing)
      *
     C                     MOVELA8BTID    ##SCSD
     C                     MOVELBBSTAD    ##SSTD
     C                     MOVELBBTXA1    ##STXA
     C/COPY WNCPYSRC,CG4010C029
      *
      ** Get Customer Details
      *
     C                     MOVELCNUM      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE           ***************
     C                     MOVELCNUM      W0KEY            * DB ERROR 29 *
     C                     Z-ADD29        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Store Customer Name
      *
     C                     MOVELBBCRNM    CPCRNM
      *
      ** Store : Destination Customer's (i.e. Counterparty)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      **             Default Network for MTnnn messages
      ** (All used in message routing)
      *
     C                     MOVELBBCSID    ##DCSD
      *                                                                   CSW036
      * If CSW036 is active and the second BIC is available               CSW036
     C           CSW036    IFEQ 'Y'                                       CSW036
     C           BBCSI2    ANDNE*BLANKS                                   CSW036
     C                     MOVELBBCSI2    ##DCSD                          CSW036
     C                     ENDIF                                          CSW036
      *                                                                   CSW036
     C                     MOVELBBSTAD    ##DSTD
     C                     MOVELBBTXA1    ##DTXA
     C                     MOVELBBDNW3    ##DDNW           *MT300 messages
      *
      ** Determine Message Routing
      *
     C                     CALL 'CG99DTMR'             99  *
     C                     PARM           ##SCSD 12        *Send. SWIFT Ad
     C                     PARM           ##SSTD 12        *Send. STTX  Ad
     C                     PARM           ##STXA 10        *Send. Telex Ad
     C                     PARM           ##DCSD 12        *Dest. SWIFT Ad
     C                     PARM           ##DSTD 12        *Dest. STTX  Ad
     C                     PARM           ##DTXA 10        *Dest. Telex Ad
     C                     PARM           ##DDNW  6        *Dest. Deflt Ne
     C                     PARM BGMSDL    ##MSDL  1        *Midas/SWIFT D/
     C                     PARM BGMTMI    ##MTMI  1        *Midas/Telex Li
     C                     PARM BLSWPY    ##SWPY  10       *SWIFT conf prt
     C                     PARM BLTXPY    ##TXPY  10       *TELEX conf prt
     C                     PARM *BLANK    ##NETW  6        *Network
     C                     PARM *BLANK    ##RTCD  7
      *
     C           *IN99     IFEQ '1'
     C           ##RTCD    ORNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'CG99DTMR'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 30 *
     C                     Z-ADD30        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     EXSR SRDAUT
     C*
     C/COPY WNCPYSRC,CG4010CP20
     C*
     C                     MOVEL'N'       ##SPPS  1
     C                     MOVEL##AUTO    DRATRM
      *
      /COPY WNCPYSRC,CG4010SPPS
      *
      *................................................................
      *
     C           EXAUTO    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDOOT                                         *
      * Function    :  Determine OUR/THEIR Indicator                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDOOT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDOOT'  @STK,Q
      *
      *................................................................
      *
     C                     MOVEL*BLANK    OURTHR  3
      *
      ** FRA
     C           DTYP      IFEQ 'FR'
     C           BYSL      ANDEQ'S'
     C                     MOVEL'OUR'     OURTHR
     C                     END
      *
      ** CAP/FLOOR/COLLAR
     C           DTYP      IFEQ 'RP'
     C           BYSL      ANDEQ'S'
     C           DTYP      OREQ 'RF'
     C           BYSL      ANDEQ'B'
     C           DTYP      OREQ 'RR'
     C           BYSL      ANDEQ'S'
     C                     MOVEL'OUR'     OURTHR
     C                     END
      *
      *................................................................
      *
     C           EXDOOT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDAUT                                         *
      * Function    :  Determine if Auto-Transmission of Confirmation *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDAUT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDAUT'  @STK,Q
      *
      *................................................................
     C                     MOVEL'N'       ##AUTO  1
      *
     C           BGSWDL    IFEQ 'Y'                        * SWIFT/DEALING
     C           BGMTDL    OREQ 'Y'                        * MIDAS/TELEX/DL
      *
     C           *IN01     IFEQ '1'                        * FOREX & NOT
     C           DTYP      ANDNE'PS'                       * POSITION SWAP
     C           *IN02     OREQ '1'                        * LOAN/DEPOSIT &
     C           DTYP      ANDNE'ID'                       * NOT INT.DEPOSIT
     C           DTYP      ANDNE'IL'                       *  OR INT.LOAN
      *
     C           *IN05     OREQ *ON                        * FRA/IRS
     C           DTYP      ANDEQ'FR'                       *  Fwd Rate Agr
     C           CSW005    ANDEQ'Y'                        *  CSW005 on
     C           *IN05     OREQ *ON                        * FRA/IRS
     C           DTYP      ANDEQ'RS'                       *  Single Ccy
     C           CSW005    ANDEQ'Y'                        *  CSW005 on
     C           *IN05     OREQ *ON                        * FRA/IRS
     C           DTYP      ANDEQ'RX'                       *  Cross Ccy
     C           CSW005    ANDEQ'Y'                        *  CSW005 on
     C           *IN05     OREQ *ON                        * FRA/IRS
     C           DTYP      ANDEQ'FR'                       *  Fwd Rate Agr
     C           CSW011    ANDEQ'Y'                        *  CSW005 on
      *
     C           ##NETW    IFNE 'PAPER '                   * NETWORK
     C           ##NETW    OREQ 'PAPER '                   * NETWORK
     C           ENFFCR    ANDNE'Y'                        * FREE FMT CFS RQ
     C                     MOVEL'Y'       ##AUTO
     C                     END
      *
     C                     END
     C                     END
     C*
     C/COPY WNCPYSRC,CG4010CP21
     C*
      *
      *................................................................
      *
     C           EXDAUT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDFED                                         *
      * Function    :  Determine if Federal Funds                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDFED    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDFED'  @STK,Q
      *
      *................................................................
      *
     C                     MOVEL'N'       ##FEDL  1
      *
      * CHECK APPROPRIATE BIT OF DEAL STATIC INDICATORS
      *
     C   01                TESTB'2'       DSTI           99* PUCY = USD
     C   01N99             TESTB'3'       DSTI           99* SLCY = USD
     C   02                TESTB'2'       DSTI           99* DEPOSIT
     C   02N99             TESTB'3'       DSTI           99* LOAN
     C   03                TESTB'3'       DSTI           99* NAB
     C   04                TESTB'3'       DSTI           99* NAS
     C   05                TESTB'2'       UDSTI          99* FRA/IRS
     C   05N99             TESTB'2'       TDSTI          99* FRA/IRS
      *
     C           *IN99     IFEQ '1'
     C                     MOVEL'Y'       ##FEDL
     C                     END
      *
      *................................................................
      *
     C           EXDFED    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDTAX                                         *
      * Function    :  Determine Tax Amount                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDTAX    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDTAX'  @STK,Q
      *
      *................................................................
      *
      ** IF BASIC RATE TAX
      *
     C           S01383    IFEQ 'Y'
      *
     C/COPY WNCPYSRC,CG4010C015
      ** CALL DEPOSITS
      *
     C           DTYP      IFEQ 'CD'
     C           MDAT      ANDEQ0
     C*
     C           VDAT      IFGE BJRDNB
     C           NOTD      IFEQ 0
     C           *LIKE     DEFN MDAT      ##WMDT
     C           VDAT      ADD  1         ##WMDT
     C                     ELSE
     C           NOTD      ADD  VDAT      ##WMDT
     C                     END
     C                     END
     C*
     C           VDAT      IFLT BJRDNB
     C           NOTD      IFEQ 0
     C           BJRDNB    ADD  1         ##WMDT
     C                     ELSE
     C           NOTD      ADD  BJRDNB    ##WMDT
     C                     END
     C                     END
      *
      ** ELSE, FIXED TERM DEPOSITS
      *
     C                     ELSE
     C                     Z-ADDMDAT      ##WMDT
     C                     END
      *
      * USE RELEVANT RATE ACCORDING TO TAX EFFECTIVE DATE
      *
     C           ##WMDT    IFGE DEFF
     C                     Z-ADDBRTR      BNHKTR
     C                     END
     C*
     C           ##WMDT    IFLT DEFF
     C                     Z-ADDPBRTR     BNHKTR
     C                     END
      *
      ** GET CUSTOMER BRT DETAILS
      *
     C           CNUM      CHAINSDCBRTL1             99
     C           *IN99     IFEQ '1'
     C           XRECI     ORNE 'D'
     C                     MOVEL'SDCBRTPD'W0FILE           ***************
     C                     MOVELCNUM      W0KEY            * DB ERROR 11 *
     C                     Z-ADD11        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** FULLY LIABLE
      *
     C           TAXIND    IFEQ 'L'
     C           TOTI      MULT BNHKTR    ##WTAX 155
     C           ##WTAX    DIV  100       ##TAXA
     C                     END
      *
      ** HALF LIABLE
      *
     C           TAXIND    IFEQ 'P'
     C           BNHKTR    MULT 0.5       ##WTXR 155
     C           TOTI      MULT ##WTXR    ##WTAX 155
     C           ##WTAX    DIV  100       ##TAXA
     C                     END
     C/COPY WNCPYSRC,CG4010C016
     C*
     C                     ELSE
      *
      ** IF HONG KONG INTEREST TAX
      *
     C           BNHKTR    IFNE *ZERO
      *
      ** ROUND DOWN INTEREST TAX AMOUNT IF RDFC = Y
      *
     C           JRDFC     IFEQ 'Y'
     C           TOTI      MULT BNHKTR    ##TAXA
     C                     DIV  100       ##TAXA
     C                     ELSE
     C           TOTI      MULT BNHKTR    ##TAXA
     C                     DIV  100       ##TAXA    H
     C                     END
      *
     C                     END
     C                     END
      *
      *................................................................
      *
     C           EXDTAX    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDSET                                         *
      * Function    :  Determine Settlement Instruction Fields        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDSET    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDSET'  @STK,Q
      *
      *................................................................
      *
     C                     CALL 'CG99DSET'             99  *
      *
     C** In
      *
     C                     PARM           ##PYRC  1        *Pay/Receive
     C                     PARM           ##CCY   3        *Settlemt currncy
     C                     PARM           ##ROLL  1        *Rollover
     C                     PARM           ##SETP  2        *Settlemt type
     C                     PARM           ##STBR  3        *Settlemt branch
     C**********           PARM           ##OURN 12        *Our nostro/ A/C                   CGL029
     C                     PARM           ##OURN 18                                           CGL029
     C                     PARM           ##THRN  8        *Their nostro
     C                     PARM           ##FACO  8        *For account of
     C                     PARM BBBRCA    ##BKBR  3        *Booking  branch
     C                     PARM BBBICN    ##BKBB  6        *Booking  br BICN
     C                     PARM ##CUST    ##CNTP  6        *Customer      081961
     C                     PARM BNACCD    ##CSAC 10                                           CGL029
     C                     PARM BMACCD    ##CADC 10                                           CGL029
     C                     PARM BKACCD    ##COMS 10                                           CGL029
     C                     PARM BLACCD    ##DEFA 10                                           CGL029
     C**********           PARM BNACCD    ##CSAC  4        *Compen.Susp. A/C                  CGL029
     C**********           PARM BMACCD    ##CADC  4        *Current A/C dflt                  CGL029
     C**********           PARM BKACCD    ##COMS  4        *Computer Sus A/C                  CGL029
     C**********           PARM BLACCD    ##DEFA  4        *Tradng Dflt A/C                   CGL029
     C                     PARM BJLCCY    ##LOCY  3        *Local Currency
     C                     PARM BLONOC    ##ONOC  1        *Ourselves/Nostro
      *
      ** Out
      *
     C                     PARM *BLANKS   ##OAC1  3        *Our Line 1
     C                     PARM *BLANKS   ##OAC2  3        *Our Line 2
     C                     PARM *BLANKS   ##ONN  30        *Our Nostro Name
     C                     PARM *BLANKS   ##ONT  20        *Our Nostro Town
     C*********************PARM *BLANKS   ##OGA  20        *Our GL A/C                       BUG7326
     C                     PARM *BLANKS   ##OGA  24        *Our GL A/C                       BUG7326
     C                     PARM *BLANKS   ##ORA  20        *Our RE a/C
     C                     PARM *BLANKS   ##TAC1  3        *Thr Line 1
     C                     PARM *BLANKS   ##TAC2  3        *Thr Line 2
     C                     PARM *BLANKS   ##TNN  30        *Thr Nostro Name
     C                     PARM *BLANKS   ##TNT  20        *Thr Nostro Town
     C                     PARM *BLANKS   ##FAL1  3        *FACO Line 1
     C                     PARM *BLANKS   ##FAL2  3        *FACO Line 2
     C                     PARM *BLANKS   ##FAN  30        *FACO Name
     C                     PARM *BLANKS   ##FAT  20        *FACO Town
     C                     PARM *BLANKS   ##RTCD  7        *Return Code
     C/COPY WNCPYSRC,CG4020C001
      *
     C           *IN99     IFEQ '1'
     C           ##RTCD    ORNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'CG99DSET'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 12 *
     C                     Z-ADD12        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *................................................................
      *
     C           EXDSET    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  MOVDTA                                         *
      * Function    :  Set up parameters for call to CG4985.          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           MOVDTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MOVDTA'  @STK,Q
      *
      *................................................................
      *
     C                     CLEARP1PARM
     C                     Z-ADDPSTM      P1PSTM
     C                     MOVELPONS      P1PONS
     C                     MOVELPIBN      P1PIBN
     C                     MOVELPIBA      P1PIBA
     C**********           Z-ADDPOBN      P1POBN                                              CSD027
     C**********           Z-ADDPOCN      P1POCN                                              CSD027
     C                     MOVE POBN      P1POBN    P                                         CSD027
     C                     MOVE POCN      P1POCN    P                                         CSD027
     C                     MOVELRCRN      P1RCRN
     C                     MOVELRCRA      P1RCRA
     C                     MOVELRVNO      P1RVNO
     C                     MOVELAWBN      P1AWBN
     C                     MOVELAWBA      P1AWBA
     C                     MOVELBENN      P1BENN
     C                     MOVELBENA      P1BENA
     C                     MOVELDTP1      P1DTP1
     C                     MOVELDTP2      P1DTP2
     C                     MOVELDTP3      P1DTP3
     C                     MOVELDTP4      P1DTP4
     C                     MOVELDCHG      P1DCHG
     C                     MOVELBTB1      P1BTB1
     C                     MOVELBTB2      P1BTB2
     C                     MOVELBTB3      P1BTB3
     C                     MOVELBTB4      P1BTB4
     C                     MOVELBTB5      P1BTB5
     C                     MOVELBTB6      P1BTB6
      *
     C**  If EMU CEU003 is installed, use settlement currency if
     C**  defined.
     C*
     C                     SELEC
     C           *IN02     WHEQ *ON
     C           *IN03     OREQ *ON
     C           *IN04     OREQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           STCY      ANDNE*BLANKS
     C                     MOVELSTCY      P1CCY
     C                     ELSE
     C                     MOVELCCY       P1CCY
     C                     ENDIF
     C*
     C           *IN01     WHEQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           PSCY      ANDNE*BLANKS
     C                     MOVELPSCY      P1CCY
     C                     ELSE
     C                     MOVELSLCY      P1CCY
     C                     ENDIF
     C*
     C           *IN05     WHEQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           PSCY      ANDNE*BLANKS
     C                     MOVELPSCY      P1CCY
     C                     ELSE
     C                     MOVELUCUCY     P1CCY
     C                     ENDIF
     C*
     C                     ENDSL
      *
     C                     CLEARP2PARM
     C                     MOVELS#PATH    P2PARM
      *
     C                     CLEARP3PARM
     C                     Z-ADD##OSEQ    P1OSEQ
     C                     Z-ADD##ITEM    P1ITEM
     C                     Z-ADDDETBIN    P1TBIN
     C                     Z-ADDDEPBIN    P1PBIN
      *
      ** 087000 - set up details for primary retail account
     C                     MOVELPOBR      P1BRCH
     C                     MOVELCNUM      P1CNUM
     C                     MOVELBMACCD    P1ACCD
      *
      *................................................................
      *
     C           EXVDTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  MOVDTB                                         *
      * Function    :  Set up parameters for call to CG4975.          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           MOVDTB    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MOVDTB'  @STK,Q
      *
      *................................................................
      *
     C                     CLEARP6PARM
     C                     Z-ADDRSTM      P1RSTM
     C                     MOVELRONS      P1RONS
     C                     MOVELRIBN      P1RIBN
     C                     MOVELRIBA      P1RIBA
     C**********           Z-ADDROBN      P1ROBN                                              CSD027
     C**********           Z-ADDROCN      P1ROCN                                              CSD027
     C                     MOVE ROBN      P1ROBN                                              CSD027
     C                     MOVE ROCN      P1ROCN                                              CSD027
     C                     MOVELROBR      R1BRCH
      *
     C**  If EMU CEU003 is installed, use settlement currency if
     C**  defined.
     C*
     C                     SELEC
     C           *IN02     WHEQ *ON
     C           *IN03     OREQ *ON
     C           *IN04     OREQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           STCY      ANDNE*BLANKS
     C                     MOVELSTCY      R1CCY
     C                     ELSE
     C                     MOVELCCY       R1CCY
     C                     ENDIF
     C*
     C           *IN01     WHEQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           RSCY      ANDNE*BLANKS
     C                     MOVELRSCY      R1CCY
     C                     ELSE
     C                     MOVELPUCY      R1CCY
     C                     ENDIF
     C*
     C           *IN05     WHEQ *ON
     C*
     C           CEU003    IFEQ 'Y'
     C           RSCY      ANDNE*BLANKS
     C                     MOVELRSCY      R1CCY
     C                     ELSE
     C                     MOVELTCUCY     R1CCY
     C                     ENDIF
     C*
     C                     ENDSL
      *
     C                     CLEARP4PARM
     C                     MOVELS#PATH    P4PARM
      *
     C                     CLEARP5PARM
     C                     Z-ADD##OSEQ    R1OSEQ
     C                     Z-ADD##ITEM    R1ITEM
     C                     Z-ADDDETBIN    R1TBIN
     C                     Z-ADDDEPBIN    R1PBIN
      *
      ** 087000 - set up details for primary retail account
     C                     MOVELCNUM      R1CNUM
     C                     MOVELBMACCD    R1ACCD
     C/COPY WNCPYSRC,CG4010C033
      *
      *................................................................
      *
     C           EXVDTB    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDEAL                                         *
      * Function    :  Access Deal                                    *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDEAL    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDEAL'  @STK,Q
      *
      *................................................................
      *
     C                     MOVEA'00000'   *IN,01
     C           DLNO      CHAINDEALS                99
     C*
     C/COPY WNCPYSRC,CG4010CP16
     C*
      *
      ** If not found try historic deals
      *
     C           *IN99     IFEQ *ON
     C           DLNO      CHAINDEALSH               99
     C   99                GOTO DELE
     C                     ENDIF
      *
      ** IF DEAL NOT FOUND, OR INVALID FORMAT ACCESSED
      *
     C           *IN01     IFNE '1'
     C           *IN02     ANDNE'1'
     C           *IN03     ANDNE'1'
     C           *IN04     ANDNE'1'
     C           *IN05     ANDNE'1'
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'DEALS   'W0FILE           ***************
     C                     MOVELDLNO      W0KEY            * DB ERROR 13 *
     C                     Z-ADD13        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** If CD issued, customer is current holder of asset
      *
     C           DTYP      IFEQ 'CI'
     C**********           Z-ADDCHNA      CNUM                                                CSD027
     C                     MOVE CHNA      CNUM                                                CSD027
     C                     END
     C           DELE      TAG
      *
      *................................................................
      *
     C           EXDEAL    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELBRCA      DRBRCA
     C                     MOVELORBR      DRORBR
     C                     MOVEL'DL'      DRMODI
     C                     MOVELDLNO      DRMTRN
     C                     MOVEL*BLANK    DRMACT
     C                     MOVELW#PTYP    DRPTYP           * print type
     C                     MOVEL'NORMAL'  DRPSTP           * print s/type
     C*
     C/COPY WNCPYSRC,CG4010CP18
     C*
      *
     C                     MOVELCNUM      ##CUST
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *
     C                     MOVE 'Y'       ##COPD
      *                                                                   CCG015
      ** Pass reference as PRINTTYPE:SUBTYPE.                             CCG015
      *                                                                   CCG015
     C           DRPTYP    CAT  ':':0     COLON  11 P                     CCG015
     C           COLON     CAT  DRPSTP:0  ##REFR    P                     CCG015
      *                                                                   CCG015
     C                     EXSR WRAPRF                                    CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD14        W0ERNB           * DB ERROR 14 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
      *                                                                   CCG015
      ** Set-up Action Code parameter W0ACT                               CCG015
      *                                                                   CCG015
     C           CCG015    IFEQ 'Y'                                       CCG015
     C                     MOVE '*NEWARR 'W0ACT                           CCG015
     C                     MOVELS#PATH    W0SPAT                          CCG015
     C                     ELSE                                           CCG015
     C                     MOVE '*PACK   'W0ACT                           CCG015
     C                     MOVEL*BLANKS   W0SPAT                          CCG015
     C                     ENDIF                                          CCG015
      *                                                                   CCG015
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C*********************PARM '*PACK   'W0ACT                           CCG015
     C                     PARM           W0ACT                           CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                       CCG015
     C                     PARM           ##RN                            CCG015
     C                     PARM           ##DN                            CCG015
     C                     PARM           ##FM                            CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 15 *
     C                     Z-ADD15        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                   CCG015
      ** Write a XML record for RDE.                                      CCG015
      *                                                                   CCG015
     C                     EXSR WRTRDE                                    CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADDS#PBIN    DEPBIN
     C                     Z-ADDS#TBIN    DETBIN
     C/COPY WNCPYSRC,CG4010C023
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *
      ** Run CG9020 only if switchable feature CCG015 is *OFF.            CCG015
      *                                                                   CCG015
     C           CCG015    IFEQ 'N'                                       CCG015
      *                                                                   CCG015
      **  Output PF/CGUDTAPD Record.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 16 *
     C                     Z-ADD16        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
     C                     ENDIF                                          CCG015
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDCDT                                         *
      * Function    :  Determine Currency Details                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDCDT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDCDT'  @STK,Q
      *
      *................................................................
      *
      **  Access array of Currency Details already loaded
     C                     Z-ADD1         C       30
     C           ##CCY     LOKUP##CY,C                   99
      *
      **  If no match is found determine the next free space in the
      **  loaded currency array.
     C           *IN99     IFEQ *OFF
     C                     Z-ADD1         C
     C           *BLANK    LOKUP##CY,C                   99
      *
      **  If no space is left, set the Currency Data data structure to
      **  the 101st occurrence so that when the new details are
      **  retrieved no existing details are overwritten.
     C           *IN99     IFEQ *OFF
     C           101       OCUR SDCURR
      *
      **  If a space is found, set up the new currency into the array
      **  and position the Currency Data data structure on the
      **  occurrence matching the array index.
     C                     ELSE
     C                     MOVE ##CCY     ##CY,C
     C           C         OCUR SDCURR
     C                     ENDIF
      *
      **  Retrieve the currency details.
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   ##RTCD           B:Return Cd
     C                     PARM '*KEY'    ##OPTN           I:Option
     C                     PARM ##CCY     ##CCYP  3        I:Currency Code
     C           SDCURR    PARM *BLANK    DSSDY            O:Format
      *
      **  Database Error
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVEL##CCY     W0KEY            ***************
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C/COPY WNCPYSRC,CG4010C013
      *
      **  If the currency has been retrieved earlier, position the
      **  Currency Data data structure on the relevant occurrence.
     C                     ELSE
     C           C         OCUR SDCURR
     C                     ENDIF
     C*
     C/COPY WNCPYSRC,CG4010CP22
     C*
     C*
     C           EXDCDT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*
     C**   DETERMINE NUMBER OF DECIMAL PLACES - BASE CURRENCY
     C*
     C                     MOVELBJCYCD    ##CCY
     C                     EXSR SRDCDT
     C                     Z-ADDA6NBDP    BASCDP  10
      *
      ** CALL ACCESS PROGRAM FOR GENERAL LEDGER DETAILS
      *
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOGELRR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD19        W0ERNB           * DB ERROR 19 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS
      *
     C                     CALL 'AOMMODR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOMMODR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR DEALING DATA DETAILS
     C*
     C**********           CALL 'AODEALR0'                                                    CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C********** SDDEAL    PARM SDDEAL    DSFDY                                               CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AODEALR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR TRADING DATA DETAILS
     C*
     C                     CALL 'AOTRADR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDTRAD    PARM SDTRAD    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOTRADR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR RETAIL DETAILS
     C*
     C           BGRTBN    IFEQ 'Y'
     C           BGIOAC    OREQ 'Y'
     C                     CALL 'AORETLR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AORETLR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR MESSAGE DETAILS
     C*
     C           BGSWDL    IFEQ 'Y'
     C                     CALL 'AOMGMER0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDMGME    PARM SDMGME    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOMGMER0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
     C/COPY WNCPYSRC,CG4010C030
     C*
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'S01383'  ##SARD  6
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           ##RTCD    ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 25 *
     C                     Z-ADD25        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       S01383  1
     C                     END
     C*
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA
     C*
     C           S01383    IFEQ 'Y'
     C                     MOVE 'D'       KRECI   1
     C           KRECI     CHAINSDBRTDD0             99
     C           *IN99     IFEQ '1'
     C                     MOVEL'SDBRTDPD'W0FILE           ***************
     C                     MOVEL'D    '   W0KEY            * DB ERROR 26 *
     C                     Z-ADD26        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
      *
      ** Access SAR details file to determine if CIR001 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'CIR001'  ##SARD
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           ##RTCD    ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 27 *
     C                     Z-ADD27        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       CIR001  1
     C                     ELSE
     C                     MOVEL'N'       CIR001
     C                     END
      *
      ** Access SAR details file to determine if CDL002 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'CDL002'  ##SARD
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           ##RTCD    ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 28 *
     C                     Z-ADD28        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C*
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       CDL002  1
     C                     ELSE
     C                     MOVEL'N'       CDL002
     C                     ENDIF
      *
      ** Access SAR details file to determine if CSW005 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'CSW005'  ##SARD
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           ##RTCD    ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 31 *
     C                     Z-ADD31        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       CSW005  1
     C                     ELSE
     C                     MOVEL'N'       CSW005
     C                     END
      *
      ** Access SAR details file to determine if CSW011 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'CSW011'  ##SARD
      *
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       CSW011  1
     C                     ELSE
     C                     MOVEL'N'       CSW011
     C                     END
      *
      ** Access SAR details file to determine if CEU014 is installed.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'CEU014'  ##SARD
      *
     C           ##RTCD    IFEQ *BLANK
     C                     MOVEL'Y'       CEU014  1
     C                     ELSE
     C                     MOVEL'N'       CEU014
     C                     END
     C*
     C**  Access SAR details file to see if CEU015 SAR is installed.
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*VERIFY' @OPTN   7
     C                     PARM 'CEU015'  @SARD   6
     C*
     C           @RTCD     IFEQ *BLANK
     C                     MOVE 'Y'       CEU015  1
     C                     ELSE
     C                     MOVE 'N'       CEU015
     C                     ENDIF
     C*
     C**  Check if CEU003 is installed
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*VERIFY' @OPTN   7
     C                     PARM 'CEU003'  @SARD   6
     C*
     C           @RTCD     IFEQ *BLANK
     C                     MOVE 'Y'       CEU003  1
     C                     ELSE
     C                     MOVE 'N'       CEU003
     C                     ENDIF
      *                                                                   CCG015
      ** Access SAR details file to determine if CCG015 is installed.     CCG015
      *                                                                   CCG015
     C                     CALL 'AOSARDR0'                                CCG015
     C                     PARM *BLANKS   PRTCD   7                       CCG015
     C                     PARM '*VERIFY' POPTN   7                       CCG015
     C                     PARM 'CCG015'  PSARD   6                       CCG015
     C           SCSARD    PARM SCSARD    DSSDY                           CCG015
      *                                                                   CCG015
      ** Database Error                                                   CCG015
      *                                                                   CCG015
     C           PRTCD     IFNE *BLANK                                    CCG015
     C           PRTCD     ANDNE'*NRF   '                                 CCG015
     C                     MOVEL'SCSARDPD'W0FILE           ************   CCG015
     C                     MOVEL'*CALL'   W0KEY            * DBERR 35 *   CCG015
     C                     Z-ADD35        W0ERNB           ************   CCG015
     C                     MOVEL'MEM5003' W0MSGD                          CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                          CCG015
     C                     EXSR SRERR                                     CCG015
     C                     END                                            CCG015
      *                                                                   CCG015
     C                     MOVEL'N'       CCG015  1                       CCG015
     C           PRTCD     IFEQ *BLANK                                    CCG015
     C                     MOVEL'Y'       CCG015                          CCG015
     C                     ENDIF                                          CCG015
      *                                                                                       CDL016
      ** Access SAR details file to determine if CDL016 (Automatic                            CDL016
      ** Rollover of Fixed Term Loan/Deposit) is switched on.                                 CDL016
      *                                                                                       CDL016
     C                     CALL 'AOSARDR0'                                                    CDL016
     C                     PARM *BLANKS   PRTCD                                               CDL016
     C                     PARM '*VERIFY' POPTN                                               CDL016
     C                     PARM 'CDL016'  PSARD                                               CDL016
     C           SCSARD    PARM SCSARD    DSSDY                                               CDL016
      *                                                                                       CDL016
      ** Database Error                                                                       CDL016
      *                                                                                       CDL016
     C           PRTCD     IFNE *BLANK                                                        CDL016
     C           PRTCD     ANDNE'*NRF   '                                                     CDL016
     C                     MOVEL'SCSARDPD'W0FILE           ************                       CDL016
     C                     MOVEL'*CALL'   W0KEY            * DBERR 36 *                       CDL016
     C                     Z-ADD36        W0ERNB           ************                       CDL016
     C                     MOVEL'MEM5003' W0MSGD                                              CDL016
     C                     MOVEL'MIDAS  ' W0MSGF                                              CDL016
     C                     EXSR SRERR                                                         CDL016
     C                     END                                                                CDL016
      *                                                                                       CDL016
     C                     MOVEL'N'       CDL016  1                                           CDL016
     C           PRTCD     IFEQ *BLANK                                                        CDL016
     C                     MOVEL'Y'       CDL016                                              CDL016
     C                     ENDIF                                                              CDL016
      *                                                                                       CDL016
      ** Access SAR details file to determine if CDL019 (Allow Base                           CDL019
      ** Rate Changes on Fixed Term Loan/Deposit) is switched on.                             CDL019
      *                                                                                       CDL019
     C                     CALL 'AOSARDR0'                                                    CDL019
     C                     PARM *BLANKS   PRTCD                                               CDL019
     C                     PARM '*VERIFY' POPTN                                               CDL019
     C                     PARM 'CDL019'  PSARD                                               CDL019
     C           SCSARD    PARM SCSARD    DSSDY                                               CDL019
      *                                                                                       CDL019
      ** Database Error                                                                       CDL019
      *                                                                                       CDL019
     C           PRTCD     IFNE *BLANK                                                        CDL019
     C           PRTCD     ANDNE'*NRF   '                                                     CDL019
     C                     MOVEL'SCSARDPD'W0FILE           ************                       CDL019
     C                     MOVEL'*CALL'   W0KEY            * DBERR 37 *                       CDL019
     C                     Z-ADD37        W0ERNB           ************                       CDL019
     C                     MOVEL'MEM5003' W0MSGD                                              CDL019
     C                     MOVEL'MIDAS  ' W0MSGF                                              CDL019
     C                     EXSR SRERR                                                         CDL019
     C                     END                                                                CDL019
      *                                                                                       CDL019
     C                     MOVEL'N'       CDL019  1                                           CDL019
     C           PRTCD     IFEQ *BLANK                                                        CDL019
     C                     MOVEL'Y'       CDL019                                              CDL019
     C                     ENDIF                                                              CDL019
      *                                                                   CSW036
      ** Access SAR details file to determine if CSW036 is installed.     CSW036
      *                                                                   CSW036
     C                     CALL 'AOSARDR0'                                CSW036
     C                     PARM '       ' ##RTCD                          CSW036
     C                     PARM '*VERIFY' ##OPTN                          CSW036
     C                     PARM 'CSW036'  ##SARD                          CSW036
      *                                                                   CSW036
      ** DATABASE ERROR                                                   CSW036
      *                                                                   CSW036
     C           ##RTCD    IFNE *BLANK                                    CSW036
     C           ##RTCD    ANDNE'*NRF   '                                 CSW036
     C                     MOVEL'SCSARDPD'W0FILE           ***************CSW036
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 44 *CSW036
     C                     Z-ADD44        W0ERNB           ***************CSW036
     C                     MOVEL'MEM5003' W0MSGD                          CSW036
     C                     MOVEL'MIDAS  ' W0MSGF                          CSW036
     C                     EXSR SRERR                                     CSW036
     C                     END                                            CSW036
     C*                                                                   CSW036
     C           ##RTCD    IFEQ *BLANK                                    CSW036
     C                     MOVEL'Y'       CSW036  1                       CSW036
     C                     ELSE                                           CSW036
     C                     MOVEL'N'       CSW036                          CSW036
     C                     END                                            CSW036
      *                                                                                     BUG11112
      ** Access SAR details file to determine if CDL033 is installed.                       BUG11112
      *                                                                                     BUG11112
     C                     CALL 'AOSARDR0'                                                  BUG11112
     C                     PARM '       ' ##RTCD                                            BUG11112
     C                     PARM '*VERIFY' ##OPTN                                            BUG11112
     C                     PARM 'CDL033'  ##SARD                                            BUG11112
      *                                                                                     BUG11112
      ** Database Error                                                                     BUG11112
      *                                                                                     BUG11112
     C           ##RTCD    IFNE *BLANK                                                      BUG11112
     C           ##RTCD    ANDNE'*NRF   '                                                   BUG11112
     C                     MOVEL'SCSARDPD'W0FILE                                            BUG11112
     C                     MOVEL'*CALL'   W0KEY                                             BUG11112
     C                     Z-ADD45        W0ERNB                                            BUG11112
     C                     MOVEL'MEM5003' W0MSGD                                            BUG11112
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG11112
     C                     EXSR SRERR                                                       BUG11112
     C                     END                                                              BUG11112
      *                                                                                     BUG11112
     C           ##RTCD    IFEQ *BLANK                                                      BUG11112
     C                     MOVEL'Y'       CDL033  1                                         BUG11112
     C                     ELSE                                                             BUG11112
     C                     MOVEL'N'       CDL033                                            BUG11112
     C                     END                                                              BUG11112
      *                                                                                       CSW208
      ** Check if SWIFT 2008 is switched on                                                   CSW208
      ** - If SWIFT 2008 is switched on, check current setup for                              CSW208
      ** system value DLFSWIFTConf                                                            CSW208
      *                                                                                       CSW208
     C                     MOVEL'N'       CSW208  1                                           CSW208
     C                     MOVEL'N'       DLSWCF  1                                           CSW208
     C                     CALL 'SWIF2008'                                                    CSW208
     C                     PARM *BLANKS   PRTCD                                               CSW208
      *                                                                                       CSW208
     C           PRTCD     IFEQ 'CSW2008'                                                     CSW208
     C                     MOVEL'Y'       CSW208                                              CSW208
     C                     CALL 'AOSVALR0'                                                    CSW208
     C                     PARM           P@RTCD  7                                           CSW208
     C                     PARM W#DLSW    P@OP01 20                                           CSW208
     C           SVAL1     PARM           P@VL01200                                           CSW208
     C                     PARM *BLANK    P@OP02 20                                           CSW208
     C                     PARM           P@VL02200                                           CSW208
     C                     PARM *BLANK    P@OP03 20                                           CSW208
     C                     PARM           P@VL03200                                           CSW208
     C                     PARM *BLANK    P@OP04 20                                           CSW208
     C                     PARM           P@VL04200                                           CSW208
     C                     PARM *BLANK    P@OP05 20                                           CSW208
     C                     PARM           P@VL05200                                           CSW208
     C                     PARM *BLANK    P@OP06 20                                           CSW208
     C                     PARM           P@VL06200                                           CSW208
     C                     PARM *BLANK    P@OP07 20                                           CSW208
     C                     PARM           P@VL07200                                           CSW208
     C                     PARM *BLANK    P@OP08 20                                           CSW208
     C                     PARM           P@VL08200                                           CSW208
     C                     PARM *BLANK    P@OP09 20                                           CSW208
     C                     PARM           P@VL09200                                           CSW208
     C                     PARM *BLANK    P@OP10 20                                           CSW208
     C                     PARM           P@VL10200                                           CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFNE *BLANKS                                                       CSW208
     C           P@RTCD    ANDNE'*NRF   '                                                     CSW208
     C                     MOVEL'SDSVALPD'W0FILE           ***************                    CSW208
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 36 *                    CSW208
     C                     Z-ADD36        W0ERNB           ***************                    CSW208
     C                     MOVEL'MEM5003' W0MSGD                                              CSW208
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW208
     C                     EXSR SRERR                                                         CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFEQ *BLANKS                                                       CSW208
     C           SVAL11    ANDEQ'Y'                                                           CSW208
     C                     MOVELSVAL11    DLSWCF                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Check if CAS009 is switched on                                                       CSW208
      *                                                                                       CSW208
     C                     MOVEL'N'       CAS009  1                                           CSW208
     C                     CALL 'AOSARDR0'                                                    CSW208
     C                     PARM *BLANKS   @RTCD   7                                           CSW208
     C                     PARM '*VERIFY' @OPTN   7                                           CSW208
     C                     PARM 'CAS009'  @SARD   6                                           CSW208
     C           SCSARD    PARM SCSARD    DSSDY                                               CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFNE *BLANKS                                                       CSW208
     C           P@RTCD    ANDNE'*NRF   '                                                     CSW208
     C                     MOVEL'SCSARDPD'W0FILE           ***************                    CSW208
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 37 *                    CSW208
     C                     Z-ADD37        W0ERNB           ***************                    CSW208
     C                     MOVEL'MEM5003' W0MSGD                                              CSW208
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW208
     C                     EXSR SRERR                                                         CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C           P@RTCD    IFEQ *BLANKS                                                       CSW208
     C                     MOVEL'Y'       CAS009                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Define work fields                                                                   CSW208
      *                                                                                       CSW208
     C           *LIKE     DEFN WFPEND    MFPDAT                                              CSW208
     C           *LIKE     DEFN DFNPYD    WFNPYD                                              CSW208
     C           *LIKE     DEFN A6ERLC    WRATE                                               CSW208
     C           *LIKE     DEFN A6MDIN    WMDI1                                               CSW208
     C           *LIKE     DEFN HIAMTS    W#AMTS                                              CSW208
     C           *LIKE     DEFN PFREQ     W#FREQ                                              CSW208
     C           *LIKE     DEFN PDAYNO    W#DAYN                                              CSW208
     C           *LIKE     DEFN PMDAY     W#MDAY                                              CSW208
      *                                                                                       CER049
      ** Check if CER049 is switched on                                                       CER049
      *                                                                                       CER049
     C                     MOVEL'N'       CER049  1                                           CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY' @OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C           SCSARD    PARM SCSARD    DSSDY                                               CER049
      *                                                                                       CER049
     C           P@RTCD    IFNE *BLANKS                                                       CER049
     C           P@RTCD    ANDNE'*NRF   '                                                     CER049
     C                     MOVEL'SCSARDPD'W0FILE           ***************                    CER049
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 44 *                    CER049
     C                     Z-ADD44        W0ERNB           ***************                    CER049
     C                     MOVEL'MEM5003' W0MSGD                                              CER049
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           P@RTCD    IFEQ *BLANKS                                                       CER049
     C                     MOVEL'Y'       CER049                                              CER049
     C                     ENDIF                                                              CER049
     C*
     C/COPY WNCPYSRC,CG4010CP14
     C*
      *
      *................................................................
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C           *LIKE     DEFN DEOSEQ    ##OSEQ
     C           *LIKE     DEFN DEPBIN    ##BNDC
     C           *LIKE     DEFN DEPBIN    S#PBIN
     C           *LIKE     DEFN DETBIN    S#TBIN
     C*
     C/COPY WNCPYSRC,CG4010CP23
     C*
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
      *
      **  Initialise Binds.
     C                     Z-ADD1         S#PBIN
     C                     Z-ADD1         S#TBIN
     C                     Z-ADD1         ##BNDC
      *
      ** Initialise XML increment                                         CCG015
      *                                                                   CCG015
     C                     EXSR INIXML                                    CCG015
      *
     C           EXINZ     TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C*
     C/COPY WNCPYSRC,CG4010CP15
     C*
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BYOUT                                          *
      * Function    :  IRS Buy-Out Details                            *
      *                                                               *
      * Called by   :  SR/D11IRS                                      *
      * Calls       :                                                 *
      *****************************************************************
     C           BYOUT     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BYOUT '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BYOUT ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Buy-Out Deal Date
     C                     MOVELBODD      ##D,1
      *
      ** Buy-Out Value Date
     C                     MOVELBOVD      ##D,2
      *
      ** Buy-Out Amount
     C                     MOVELBOAM      ##D,3
     C           BAPR      IFEQ 'P'
     C                     MOVELUCUCY     ##CCY
     C                     ELSE
     C                     MOVELTCUCY     ##CCY
     C                     END
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,3
      *
      ** Buy-Out Pay/Receive Indicator
     C                     MOVELBAPR      ##D,4
     C*
     C           CEU014    IFEQ 'Y'
     C*
     C* If the Buyout Pay/Receive indicator is 'P'ayment, use
     C*  Payment Settlement currency, else use Receipt Settlement ccy.
     C           BAPR      IFEQ 'P'
     C                     MOVE UCUCY     ##CCY2
     C                     MOVE PSCY      ##CCY
     C                     ELSE
     C                     MOVE TCUCY     ##CCY2
     C                     MOVE RSCY      ##CCY
     C                     ENDIF
     C*
     C*
     C* If Settlement currency is not blank, convert Up Buyout amount
     C*  to Settlement currency.
     C*
     C           ##CCY     IFNE *BLANKS
     C                     MOVE ##CCY2    W#FRCY
     C                     MOVE ##CCY     W#TOCY
     C                     Z-ADDBOAM      W#FRAM           Buy-Out Amount
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
     C*
     C* Buy Out amount in Settlement currency
     C                     MOVELW#TAMT    ##D,5
     C                     MOVE A6NBDP    ##D,5
     C                     ENDIF
     C*
     C*
     C* If the Event currency is 'In' or 'Euro' currency, convert the
     C*  Buyout amount to Equivalent currency.
     C*
     C                     MOVE *BLANKS   EQCY
     C                     MOVE ##CCY2    ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Event currency is 'In', the Equivalent currency is
     C*  Euros.
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    EQCY
     C                     ENDIF
     C*
     C* If the Event currency is in 'Euro', the Equivalent 'In'
     C*  currency is retrieved from Customer file.
     C           ##CCY2    IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    EQCY
     C                     ENDIF
     C           EQCY      IFNE *BLANKS
     C                     MOVE EQCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE ##CCY2    W#FRCY
     C                     MOVE EQCY      W#TOCY
     C                     Z-ADDBOAM      W#FRAM           Buy-Out amount
     C                     EXSR D@EURO
     C*
     C* Buyout amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,6
     C                     MOVE A6NBDP    ##D,6
     C*
     C* Equivalent currency and description
     C                     MOVELEQCY      ##D,7
     C                     MOVELA6CYNM    ##D,8
     C                     ENDIF
     C*
     C                     ENDIF
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  UPFEE                                          *
      * Function    :  IRS Up-Front Fee Details                       *
      *                                                               *
      * Called by   :  SR/D11IRS                                      *
      * Calls       :                                                 *
      *****************************************************************
     C           UPFEE     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'UPFEE '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\UPFEE ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                    CCG015
      *
      **  Set up Binds from passed in values.
     C                     Z-ADDS#PBIN    ##PBIN
     C                     Z-ADDS#TBIN    ##TBIN
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Up-Front Fee Value Date
     C                     MOVELUPVD      ##D,1
      *
      ** Up-Front Fee Amount
     C                     MOVELUPFE      ##D,2
     C           UPPR      IFEQ 'P'
     C                     MOVELUCUCY     ##CCY
     C                     ELSE
     C                     MOVELTCUCY     ##CCY
     C                     END
     C                     EXSR SRDCDT
     C                     MOVE A6NBDP    ##D,2
      *
      ** Up-Front Fee Pay/Receive Indicator
     C                     MOVELUPPR      ##D,3
     C*
     C           *LIKE     DEFN ##CCY     ##CCY2
     C           CEU014    IFEQ 'Y'
     C*
     C* If the Up-Front Fee Pay/Receive indicator is 'P'ayment, use
     C*  Payment Settlement currency, else use Receipt Settlement ccy.
     C           UPPR      IFEQ 'P'
     C                     MOVE UCUCY     ##CCY2
     C                     MOVE PSCY      ##CCY
     C                     ELSE
     C                     MOVE TCUCY     ##CCY2
     C                     MOVE RSCY      ##CCY
     C                     ENDIF
     C*
     C* If Settlement currency is not blank, convert Up Front fee to
     C*  Settlement currency.
     C           ##CCY     IFNE *BLANKS
     C                     MOVE ##CCY2    W#FRCY
     C                     MOVE ##CCY     W#TOCY
     C                     Z-ADDUPFE      W#FRAM           Up Front Fee
     C                     EXSR SRDCDT
     C                     EXSR D@EURO
     C*
     C* Up Front fee in Settlement currency
     C                     MOVELW#TAMT    ##D,4
     C                     MOVE A6NBDP    ##D,4
     C                     ENDIF
     C*
     C*
     C* If the Event currency is 'In' or 'Euro' currency, convert the
     C*  Up Front fee amount to Equivalent currency.
     C*
     C                     MOVE *BLANKS   EQCY
     C                     MOVE ##CCY2    ##CCY
     C                     EXSR SRDCDT
     C*
     C* If the Event currency is 'In', the Equivalent currency is
     C*  Euros.
     C           A6INCY    IFEQ 'Y'
     C                     MOVE BKEURO    EQCY
     C                     ENDIF
     C*
     C* If the Event currency is in 'Euro', the Equivalent 'In'
     C*  currency is retrieved from Customer file.
     C           ##CCY2    IFEQ BKEURO
     C                     EXSR INCUST
     C                     MOVE BBDINC    EQCY
     C                     ENDIF
     C           EQCY      IFNE *BLANKS
     C                     MOVE EQCY      ##CCY
     C                     EXSR SRDCDT
     C                     MOVE ##CCY2    W#FRCY
     C                     MOVE EQCY      W#TOCY
     C                     Z-ADDUPFE      W#FRAM           Up Front Fee
     C                     EXSR D@EURO
     C*
     C* Upfront Fee amount in Equivalent currency
     C                     MOVELW#TAMT    ##D,5
     C                     MOVE A6NBDP    ##D,5
     C*
     C* Equivalent currency and description
     C                     MOVELEQCY      ##D,6
     C                     MOVELA6CYNM    ##D,7
     C                     ENDIF
     C*
     C                     ENDIF
     C*
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                    CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  #LDTFR                                         *
      * Function    :  Determine Closest Frequency for Schedule       *
      *                                                               *
      * Called by   :  SR/D@IPYO                                      *
      *                SR/D@IPYT                                      *
      *                SR/D@RCHO                                      *
      *                SR/D@RCHT                                      *
      * Calls       :  *NONE                                          *
      *****************************************************************
     C           #LDTFR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'#LDTFR'  @STK,Q
      *
      *................................................................
      *
      ** Determine the number of days from the next date to the "next
      **   next" date requested.
      *
     C           W0NNDT    SUB  W0NXDT    W0ZDAY
      *
      ** Find the closest frequency code.
      *
     C           W0ZDAY    IFLE 61
     C                     MOVEL'M'       W0FREQ  1
     C                     ELSE
     C           W0ZDAY    IFLT 137
     C                     MOVEL'Q'       W0FREQ
     C                     ELSE
     C           W0ZDAY    IFLT 274
     C                     MOVEL'X'       W0FREQ
     C                     ELSE
     C                     MOVEL'Y'       W0FREQ
     C                     END
     C                     END
     C                     END
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  S/R #LDNDT - Determine next rate change/payment date.        *
      *                                                               *
      *****************************************************************
     C           #LDNDT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'#LDNDT'  @STK,Q
      *................................................................
      *
     C           IRSDTL    KLIST
     C                     KFLD           W0DLNO  60
     C                     KFLD           W0OTIN  1
     C                     KFLD           W0RCIP  1
     C                     KFLD           W0PRDT  50
      *
     C           IRSDTP    KLIST
     C                     KFLD           W0DLNO
     C                     KFLD           W0OTIN
     C                     KFLD           W0RCIP
      *
     C                     Z-ADDDLNO      W0DLNO
     C                     Z-ADDW0ZDAY    W0PRDT
     C           IRSDTL    SETGTDLDTSCD0
     C           IRSDTP    READEDLDTSCD0                 99
     C           *IN99     IFEQ '0'
     C                     Z-ADDPRDT      W0ZDAY
     C                     ELSE
     C                     Z-ADDMDAT      W0ZDAY
     C                     END
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      *  S/R #LDNCF - Determine next cash flow date.                  *
      *                                                               *
      *****************************************************************
     C           #LDNCF    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'#LDNCF'  @STK,Q
      *................................................................
      *
     C           IRSCFL    KLIST
     C                     KFLD           W0DLNO
     C                     KFLD           W0OTIN
     C                     KFLD           W0PRDT
      *
     C           IRSCFP    KLIST
     C                     KFLD           W0DLNO
     C                     KFLD           W0OTIN
      *
     C                     Z-ADDDLNO      W0DLNO
     C                     Z-ADDW0ZDAY    W0PRDT
     C           IRSCFL    SETGTDLCFSCD0
     C           IRSCFP    READEDLCFSCD0                 99
     C           *IN99     IFEQ '0'
     C                     Z-ADDPRDT      W0ZDAY
     C                     ELSE
     C                     Z-ADDMDAT      W0ZDAY
     C                     END
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
     C/EJECT
      *****************************************************************
      *                                                               *
      * Subroutine  :  D@EURO                                         *
      * Function    :  Convert from Euro to 'In' currency             *
      *                vice versa                                     *
      *                                                               *
      * Called by   :  D@FRX, D@LAD, D@NAB, D@NAS, UPFEE, BYOUT       *
      * Calls       :  EU0200                                         *
      *                                                               *
      *****************************************************************
     C           D@EURO    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'D@EURO'  @STK,Q
      *................................................................
      *
     C*
     C                     Z-ADD0         W#OUTA 150       Outright Amount
     C                     Z-ADD0         W#INTA 183       Interim Amount
     C           *LIKE     DEFN PUAM      W#TAMT           Adjust length
     C           *LIKE     DEFN P@FRAM    W#FRAM
     C           *LIKE     DEFN P@FRCY    W#FRCY
     C           *LIKE     DEFN P@TOCY    W#TOCY
     C                     CALL 'EU0200'
     C                     PARM *BLANKS   ##RTCD           Return Code
     C                     PARM W#FRAM    P@FRAM 183       FROM Ccy Amount
     C                     PARM W#FRCY    P@FRCY  3        FROM Currency
     C                     PARM W#TOCY    P@TOCY  3        TO Currency
     C           W#OUTA    PARM W#OUTA    P@OUTA 150       Outright Amount
     C           W#INTA    PARM W#INTA    P@INTA 183       Interim Amount
     C                     PARM           P@EXRT 159       Exchange Rate
     C                     PARM           P@MDIN  1        Mult/Div Ind
     C           ##RTCD    IFNE *BLANKS
     C                     MOVE *BLANKS   W#FRTC  6
     C                     MOVELP@FRCY    W#FRTC
     C                     MOVE P@TOCY    W#FRTC
     C                     MOVELW#FRTC    W0KEY
     C                     MOVEL'EU0200  'W0FILE           ***************
     C                     MOVE ##RTCD    W0KEY            * DB ERROR 32 *
     C                     Z-ADD32        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     ELSE
     C*
     C* Adjust the converted amount to the length of Deal amount
     C                     Z-ADDW#OUTA    W#TAMT
     C                     ENDIF
     C*
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  INCUST                                         *
      * Function    :  Retrieve 'In' currency details of customer     *
      *                                                               *
      * Called by   :  D@FRX, D@LAD, D@NAB, D@NAS, UPFEE, BYOUT       *
      **Calls*******:**AOCUSTR0                                       *   CSW036
      * Calls       :  AOCUSTR1                                       *   CSW036
      *****************************************************************
     C           INCUST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'INCUST'  @STK,Q
      *
      *................................................................
      *
      ** Get Customer Details
      *
     C                     MOVELCNUM      ##KEY1
     C*********************CALL 'AOCUSTR0'                                CSW036
     C                     CALL 'AOCUSTR1'                                CSW036
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C***********SDCUST    PARM SDCUST    DSSDY                           CSW036
     C           SDCUST    PARM SDCUST    DSLDY                           CSW036
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE           ***************
     C                     MOVELCNUM      W0KEY            * DB ERROR 33 *
     C                     Z-ADD33        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *................................................................
      *
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C********************************************************************
      /SPACE 5                                                                                CER049
      *****************************************************************                       CER049
      *  Subroutine  :  LNSTAX                                        *                       CER049
      *  Function    :  Stamp Tax information                         *                       CER049
      *                                                               *                       CER049
      *  Called by   :                                                *                       CER049
      *  Calls       :                                                *                       CER049
      *****************************************************************                       CER049
     C           LNSTAX    BEGSR                                                              CER049
      *                                                                                       CER049
      ** Set up subroutine stack name                                                         CER049
      *                                                                                       CER049
     C                     ADD  1         Q                                                   CER049
     C                     MOVEL'LNSTAX'  @STK,Q                                              CER049
      *                                                                                       CER049
      *................................................................                       CER049
      *                                                                                       CER049
      ** Retrieve subroutine specific data.                                                   CER049
      *                                                                                       CER049
     C           1         OCUR ##SRDT                                                        CER049
     C                     MOVEL##SPAT    S#PATH                                              CER049
      *                                                                                       CER049
      ** Set up Path.                                                                         CER049
      *                                                                                       CER049
     C                     MOVEL'\LNSTAX' ##PNAM                                              CER049
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER049
     C                     EXSR PSHGRS                                                        CER049
      *                                                                                       CER049
      ** Set up Binds from passed in values.                                                  CER049
      *                                                                                       CER049
     C                     Z-ADDS#PBIN    ##PBIN                                              CER049
     C                     Z-ADDS#TBIN    ##TBIN                                              CER049
      *                                                                                       CER049
      ** Retrieve RDE information for RDEs in group set                                       CER049
      *                                                                                       CER049
     C                     MOVEL@STK,Q    ##GRPS                                              CER049
     C                     Z-ADD1         ##RDEN                                              CER049
     C                     EXSR SRRRDE                                                        CER049
      *                                                                                       CER049
      ** Set Deal number                                                                      CER049
      *                                                                                       CER049
     C                     MOVE DLNO      K1DLNO  6                                           CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C           K1DLNO    CHAINDLDLDCL3             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELF1TAX     ##D,1                                               CER049
      *                                                                                       CER049
      ** Stamp Principal Tax Flag                                                             CER049
      *                                                                                       CER049
     C                     MOVELF1PRIN    ##D,2                                               CER049
      *                                                                                       CER049
      ** Start Date for Principal Tax                                                         CER049
      *                                                                                       CER049
     C                     MOVELF1PDTE    ##D,3                                               CER049
      *                                                                                       CER049
      ** Average Balance Flag                                                                 CER049
      *                                                                                       CER049
     C                     MOVELF1AVBL    ##D,4                                               CER049
      *                                                                                       CER049
      ** Start Date for Average Balance                                                       CER049
      *                                                                                       CER049
     C                     MOVELF1ADTE    ##D,5                                               CER049
      *                                                                                       CER049
      ** Interest Tax Flag                                                                    CER049
      *                                                                                       CER049
     C                     MOVELF1SINT    ##D,6                                               CER049
      *                                                                                       CER049
      ** Start Date for Interest Tax                                                          CER049
      *                                                                                       CER049
     C                     MOVELF1IDTE    ##D,7                                               CER049
      *                                                                                       CER049
      ** Debit Account Reference                                                              CER049
      *                                                                                       CER049
     C           F1DCST    CAT  F1DCCY    WDRAC1  9                                           CER049
     C                     MOVELWDRAC1    WDRAC2 19                                           CER049
     C                     MOVE F1DACD    WDRAC2                                              CER049
     C                     MOVELWDRAC2    WDRAC3 21                                           CER049
     C                     MOVE F1DASC    WDRAC3                                              CER049
     C           WDRAC3    CAT  F1DBRC    WDRACC 24                                           CER049
      *                                                                                       CER049
     C                     MOVELWDRACC    ##D,8                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELF1STAB    ##D,9                                               CER049
     C                     MOVELF1DCCY    ##CCY                                               CER049
     C                     EXSR SRDCDT                                                        CER049
     C                     MOVE A6NBDP    ##D,9                                               CER049
      *                                                                                       CER049
      ** Stamp Tax on Interest                                                                CER049
      *                                                                                       CER049
     C                     MOVELF1STAI    ##D,10                                              CER049
     C                     MOVE A6NBDP    ##D,10                                              CER049
      *                                                                                       CER049
      ** Stamp Tax on Average This Month                                                      CER049
      *                                                                                       CER049
     C                     MOVELF1TAXE    ##D,11                                              CER049
     C                     MOVE A6NBDP    ##D,11                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Accumulate RDE's and associated data and output to                                   CER049
      ** PF/CGUDTAPD.                                                                         CER049
      *                                                                                       CER049
     C                     EXSR SRADTA                                                        CER049
     C                     EXSR SRODTA                                                        CER049
      *                                                                                       CER049
      *................................................................                       CER049
      *                                                                                       CER049
     C           EXSTX     TAG                                                                CER049
      *                                                                                       CER049
      ** Unwind subroutine stack name                                                         CER049
      *                                                                                       CER049
     C                     EXSR POPGRS                                                        CER049
     C                     MOVEA*BLANKS   @STK,Q                                              CER049
     C                     SUB  1         Q                                                   CER049
      *                                                                                       CER049
     C                     ENDSR                                                              CER049
     C*****************************************************************                       CER049
      /SPACE 5                                                                              BUG11112
      *****************************************************************                     BUG11112
      * Subroutine  :  SRFRCD                                         *                     BUG11112
      * Function    :  Floating Rate CD Issued Details (Deal Date     *                     BUG11112
      *                Conf)                                          *                     BUG11112
      *                                                               *                     BUG11112
      * Called by   :  D07LAD                                         *                     BUG11112
      * Calls       :                                                 *                     BUG11112
      *****************************************************************                     BUG11112
     C           SRFRCD    BEGSR                                                            BUG11112
      *                                                                                     BUG11112
      **  Set up subroutine stack name                                                      BUG11112
      *                                                                                     BUG11112
     C                     ADD  1         Q                                                 BUG11112
     C                     MOVEL'FRCD  '  @STK,Q                                            BUG11112
      *                                                                                     BUG11112
      **  Retrieve subroutine specific data.                                                BUG11112
      *                                                                                     BUG11112
     C           1         OCUR ##SRDT                                                      BUG11112
     C                     MOVEL##SPAT    S#PATH                                            BUG11112
      *                                                                                     BUG11112
      **  Set up Path.                                                                      BUG11112
      *                                                                                     BUG11112
     C                     MOVEL'\FRCD  ' ##PNAM                                            BUG11112
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                            BUG11112
     C                     EXSR PSHGRS                                                      BUG11112
      *                                                                                     BUG11112
      **  Retrieve RDE information for RDEs in group set                                    BUG11112
      *                                                                                     BUG11112
     C                     MOVEL@STK,Q    ##GRPS                                            BUG11112
     C                     Z-ADD1         ##RDEN                                            BUG11112
     C                     EXSR SRRRDE                                                      BUG11112
      *                                                                                     BUG11112
      **  Rate Change Date                                                                  BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKRCDT    ##D,1                                             BUG11112
      *                                                                                     BUG11112
      **  Rate Change Frequency                                                             BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKRCFR    ##D,2                                             BUG11112
      *                                                                                     BUG11112
      **  Rate Change Days                                                                  BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKRCDM    ##D,3                                             BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate Flag                                                              BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKSTRF    ##D,4                                             BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate                                                                   BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKSTRT    ##D,5                                             BUG11112
      *                                                                                     BUG11112
      **  Accrued Interest as of Last Int Paymnt/Change Date                                BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKAILC    ##D,6                                             BUG11112
     C                     MOVE A6NBDP    ##D,6                                             BUG11112
      *                                                                                     BUG11112
      **  Accrued COF as of Last Int Paymnt/Change Date                                     BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKACDA    ##D,7                                             BUG11112
     C                     MOVE A6NBDP    ##D,7                                             BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate on Value Date Flag                                                BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKSTVF    ##D,8                                             BUG11112
      *                                                                                     BUG11112
      **  Fixed Base Rate Applied on Value Date Flag                                        BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKBSVF    ##D,9                                             BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Days                                                                     BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKFXDM    ##D,10                                            BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Date                                                                     BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKINFD    ##D,11                                            BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Date Processed Flag                                                      BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKINFF    ##D,12                                            BUG11112
      *                                                                                     BUG11112
      **  Fixed Base Rate                                                                   BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKBSRF    ##D,13                                            BUG11112
      *                                                                                     BUG11112
      **  Forward Yield Curve                                                               BUG11112
      *                                                                                     BUG11112
     C                     MOVELXKFYLD    ##D,14                                            BUG11112
      *                                                                                     BUG11112
      ** Base Rate                                                                          BUG11112
     C                     MOVELCCY       ##CYCD                                            BUG11112
     C                     MOVELBRTT      ##BSRC                                            BUG11112
     C                     MOVEL##BSRC    ##D,15                                            BUG11112
      *                                                                                     BUG11112
      ** Base Rate Name                                                                     BUG11112
     C                     CALL 'AOBSRTR0'                                                  BUG11112
     C                     PARM *BLANKS   ##RTCD                                            BUG11112
     C                     PARM '*KEY   ' ##OPTN                                            BUG11112
     C                     PARM           ##CYCD                                            BUG11112
     C                     PARM           ##BSRC                                            BUG11112
     C           SDBSRT    PARM SDBSRT    DSSDY                                             BUG11112
      *                                                                                     BUG11112
      ** DATABASE ERROR                                                                     BUG11112
      *                                                                                     BUG11112
     C           ##RTCD    IFNE *BLANK                                                      BUG11112
     C                     MOVEL'SDBSRTPD'W0FILE           ***************                  BUG11112
     C                     MOVEL##BSRC    W0KEY            * DB ERROR 41 *                  BUG11112
     C                     Z-ADD41        W0ERNB           ***************                  BUG11112
     C                     MOVEL'MEM5004' W0MSGD                                            BUG11112
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG11112
     C                     EXSR SRERR                                                       BUG11112
     C                     END                                                              BUG11112
      *                                                                                     BUG11112
     C                     MOVELBABSRN    ##D,16                                            BUG11112
      *                                                                                     BUG11112
      ** Spread Rate                                                                        BUG11112
     C                     MOVEL*BLANKS   R#DATA                                            BUG11112
     C                     MOVELRTSP      R#DATA                                            BUG11112
     C                     MOVELR#DATA    ##D,17                                            BUG11112
     C                     MOVEL*BLANKS   R#DATA                                            BUG11112
      *                                                                                     BUG11112
      ** Interest Calculation Basis                                                         BUG11112
     C                     MOVELICBS      ##D,18                                            BUG11112
      *                                                                                     BUG11112
      **  Accumulate RDE's and associated data and output to                                BUG11112
      **  PF/CGUDTAPD.                                                                      BUG11112
     C                     EXSR SRADTA                                                      BUG11112
     C                     EXSR SRODTA                                                      BUG11112
      *                                                                                     BUG11112
     C           EXFRCD    TAG                                                              BUG11112
      *                                                                                     BUG11112
      **  Unwind subroutine stack name                                                      BUG11112
      *                                                                                     BUG11112
     C                     EXSR POPGRS                                                      BUG11112
     C                     MOVEA*BLANKS   @STK,Q                                            BUG11112
     C                     SUB  1         Q                                                 BUG11112
      *                                                                                     BUG11112
     C                     ENDSR                                                            BUG11112
      *****************************************************************                     BUG11112
     C/EJECT
      *****************************************************************                       CSW208
      * Subroutine  :  SRFEE                                          *                       CSW208
      * Function    :  Retrieve fee details                           *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  D07LAD, DL@FEE                                 *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C           SRFEE     BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'SRFEE '  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C           WRPT      IFEQ 'Y'                                                           CSW208
      *                                                                                       CSW208
     C           WFNPYD    IFEQ WFPEND                                                        CSW208
     C                     MOVEL'N'       WRPT                                                CSW208
     C                     Z-ADD*ZEROS    WFPEND                                              CSW208
     C                     ELSE                                                               CSW208
      *                                                                                       CSW208
      ** Calculate next payment date                                                          CSW208
      *                                                                                       CSW208
     C                     Z-ADDDFPEND    WFNPYD                                              CSW208
     C           DFFREQ    IFNE *BLANKS                                                       CSW208
     C                     MOVELDFFREQ    W#FREQ                                              CSW208
     C                     Z-ADDWFNPYD    W#DAYN                                              CSW208
     C                     Z-ADDDFDYIM    W#MDAY                                              CSW208
     C                     MOVELBJLCCY    W#CCY                                               CSW208
     C                     EXSR SRSDAT                                                        CSW208
     C           PRTCD     IFEQ *BLANKS                                                       CSW208
     C           PDAYNO    ANDLEDFPEND                                                        CSW208
     C                     Z-ADDPDAYNO    WFNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Use DL fees history file                                                             CSW208
      *                                                                                       CSW208
     C           WRPT      IFEQ 'N'                                                           CSW208
     C           WFEEH     ANDEQ'Y'                                                           CSW208
      *                                                                                       CSW208
     C           WFFLG     IFEQ 'N'                                                           CSW208
     C           DLNO      SETLLDLFHSTL0                                                      CSW208
     C                     ENDIF                                                              CSW208
     C           DLNO      READEDLFHSTL0                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     IFEQ *OFF                                                          CSW208
     C                     MOVEL'Y'       WFFLG                                               CSW208
     C                     EXSR FEEHST                                                        CSW208
     C                     ELSE                                                               CSW208
     C                     MOVEL'N'       WFEEH                                               CSW208
     C                     MOVEL'N'       WFFLG                                               CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      ** Use DL fees live file                                                                CSW208
      *                                                                                       CSW208
     C           WRPT      IFEQ 'N'                                                           CSW208
     C           WFEEH     ANDEQ'N'                                                           CSW208
      *                                                                                       CSW208
     C           WFFLG     IFEQ 'N'                                                           CSW208
     C           DLNO      SETLLDLFEEDLB                                                      CSW208
     C                     ENDIF                                                              CSW208
     C           DLNO      READEDLFEEDLB                 99                                   CSW208
      *                                                                                       CSW208
     C           *IN99     IFEQ *OFF                                                          CSW208
     C                     MOVEL'Y'       WFFLG                                               CSW208
     C                     EXSR FEELST                                                        CSW208
     C           DFPYON    IFEQ 'N'                                                           CSW208
     C                     MOVEL'Y'       WRPT                                                CSW208
     C                     Z-ADDWFPEND    MFPDAT                                              CSW208
     C                     Z-ADDWFNPYD    DFNPYD                                              CSW208
     C                     ENDIF                                                              CSW208
     C                     ELSE                                                               CSW208
     C                     MOVEL'N'       WFFLG                                               CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  SRSDAT                                         *                       CSW208
      * Function    :  Calculate next payment date from a frequency   *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  ZFREQB                                         *                       CSW208
      *****************************************************************                       CSW208
     C           SRSDAT    BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'SRSDAT'  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                     CALL 'ZFREQB'                                                      CSW208
     C                     PARM *BLANKS   PRTCD                                               CSW208
     C                     PARM W#FREQ    PFREQ   1                                           CSW208
     C                     PARM W#DAYN    PDAYNO  50                                          CSW208
     C                     PARM W#MDAY    PMDAY   20                                          CSW208
     C                     PARM W#CCY     PCCY    3                                           CSW208
     C                     PARM *BLANKS   PLOC    3                                         AR702741
      *                                                                                       CSW208
     C           PRTCD     IFNE *BLANKS                                                       CSW208
     C                     MOVEL'ZFREQB  'W0FILE                                              CSW208
     C                     MOVELW#DAYN    W0KEY            ***************                    CSW208
     C                     Z-ADD38        W0ERNB           * DB ERROR 38 *                    CSW208
     C                     MOVEL'MEM5004' W0MSGD           ***************                    CSW208
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW208
     C                     EXSR SRERR                                                         CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  FEEHST                                         *                       CSW208
      * Function    :  Move historic fee settlement details           *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C           FEEHST    BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'FEEHST'  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                     MOVELHISCCY    ##RSCY                                              CSW208
     C                     MOVELHIFCCY    ##CCY                                               CSW208
     C                     Z-ADDHIRSTM    RSTM                                                CSW208
     C                     MOVELHIOSDB    ROBR                                                CSW208
     C                     MOVELHIRONS    RONS                                                CSW208
     C                     MOVELHIRIBN    RIBN                                                CSW208
     C                     MOVELHISCCY    ##PSCY                                              CSW208
     C                     Z-ADDHIPSTM    PSTM                                                CSW208
     C                     MOVELHIOMDB    POBR                                                CSW208
     C                     MOVELHIPONS    PONS                                                CSW208
     C                     MOVELHIRVNO    RVNO                                                CSW208
     C                     MOVELHIRCRN    RCRN                                                CSW208
     C                     MOVELHIAWBN    AWBN                                                CSW208
     C                     MOVELHIBENN    BENN                                                CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  FEELST                                         *                       CSW208
      * Function    :  Move live fee settlement details               *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C           FEELST    BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'FEELST'  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                     MOVELDFSCCY    ##RSCY                                              CSW208
     C                     MOVELDFFCCY    ##CCY                                               CSW208
     C                     Z-ADDDFRSTM    RSTM                                                CSW208
     C                     MOVELDFOSDB    ROBR                                                CSW208
     C                     MOVELDFRONS    RONS                                                CSW208
     C                     MOVELDFRIBN    RIBN                                                CSW208
     C                     MOVELDFSCCY    ##PSCY                                              CSW208
     C                     Z-ADDDFPSTM    PSTM                                                CSW208
     C                     MOVELDFOMDB    POBR                                                CSW208
     C                     MOVELDFPONS    PONS                                                CSW208
     C                     MOVELDFRVNO    RVNO                                                CSW208
     C                     MOVELDFRCRN    RCRN                                                CSW208
     C                     MOVELDFAWBN    AWBN                                                CSW208
     C                     MOVELDFBENN    BENN                                                CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  DL@FEE                                         *                       CSW208
      * Function    :  Dealing fee                                    *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  D07LAD                                         *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C           DL@FEE    BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'DL_FEE'  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      **  Retrieve subroutine specific data                                                   CSW208
      *                                                                                       CSW208
     C           1         OCUR ##SRDT                                                        CSW208
     C                     MOVEL##SPAT    S#PATH                                              CSW208
      *                                                                                       CSW208
      **  Set up path                                                                         CSW208
      *                                                                                       CSW208
     C                     MOVEL'\DL_FEE' ##PNAM                                              CSW208
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CSW208
      *                                                                                       CSW208
      **  Store Path                                                                          CSW208
     C           2         OCUR ##SRDT                                                        CSW208
     C                     MOVELS#PATH    ##SPAT                                              CSW208
      *                                                                                       CSW208
      **  Set up binds from passed in values                                                  CSW208
      *                                                                                       CSW208
     C                     Z-ADDS#PBIN    ##PBIN                                              CSW208
     C                     Z-ADDS#TBIN    ##TBIN                                              CSW208
      *                                                                                       CSW208
     C           WFFLG     DOWEQ'Y'                                                           CSW208
     C                     EXSR PSHGRS                                                        CSW208
     C                     Z-ADD##TBIN    S#PBIN                                              CSW208
     C                     ADD  1         ##BNDC                                              CSW208
     C                     Z-ADD##BNDC    S#TBIN                                              CSW208
     C                     EXSR DL@FED                                                        CSW208
     C                     EXSR D@RECS                                                        CSW208
     C                     EXSR D@PAYS                                                        CSW208
     C           2         OCUR ##SRDT                                                        CSW208
     C                     MOVEL##SPAT    S#PATH                                              CSW208
     C                     Z-ADD##PBIN    S#PBIN                                              CSW208
     C                     Z-ADD##TBIN    S#TBIN                                              CSW208
     C                     EXSR SRFEE                                                         CSW208
     C                     ENDDO                                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     EXSR POPGRS                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  DL@FED                                         *                       CSW208
      * Function    :  Dealing fee details                            *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  DL@FEE                                         *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C           DL@FED    BEGSR                                                              CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                     ADD  1         Q                                                   CSW208
     C                     MOVEL'DL_FED'  @STK,Q                                              CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      **  Retrieve subroutine specific data                                                   CSW208
      *                                                                                       CSW208
     C           3         OCUR ##SRDT                                                        CSW208
     C                     MOVEL##SPAT    S#PATH                                              CSW208
      *                                                                                       CSW208
      **  Set up path                                                                         CSW208
      *                                                                                       CSW208
     C                     MOVEL'\DL_FED' ##PNAM                                              CSW208
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CSW208
     C                     EXSR PSHGRS                                                        CSW208
      *                                                                                       CSW208
      **  Set up binds from passed in values                                                  CSW208
      *                                                                                       CSW208
     C                     Z-ADDS#PBIN    ##PBIN                                              CSW208
     C                     Z-ADDS#TBIN    ##TBIN                                              CSW208
      *                                                                                       CSW208
      **  Retrieve RDE information for RDEs in group set                                      CSW208
      *                                                                                       CSW208
     C                     MOVEL@STK,Q    ##GRPS                                              CSW208
     C                     Z-ADD1         ##RDEN                                              CSW208
     C                     EXSR SRRRDE                                                        CSW208
      *                                                                                       CSW208
      **  Extract RDE's                                                                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  - RDE - Fee sequence number                                                         CSW208
      **  - RDE - Fee code                                                                    CSW208
      **  - RDE - Fee currency                                                                CSW208
      *                                                                                       CSW208
     C           WFEEH     IFEQ 'Y'                                                           CSW208
     C                     MOVELHIFSEQ    ##D,1                                               CSW208
     C                     MOVELHIFCOD    ##D,2                                               CSW208
     C                     MOVELHIFCCY    ##D,3                                               CSW208
     C                     MOVELHIFCCY    ##CCY                                               CSW208
     C                     ELSE                                                               CSW208
     C                     MOVELDFFSEQ    ##D,1                                               CSW208
     C                     MOVELDFFCOD    ##D,2                                               CSW208
     C                     MOVELDFFCCY    ##D,3                                               CSW208
     C                     MOVELDFFCCY    ##CCY                                               CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
      **  - RDE - Fee currency details                                                        CSW208
      *                                                                                       CSW208
     C                     EXSR SRDCDT                                                        CSW208
     C                     MOVELA6CYNM    ##D,4                                               CSW208
     C                     Z-ADDA6ERLC    WRATE                                               CSW208
     C                     MOVELA6MDIN    WMDI1                                               CSW208
      *                                                                                       CSW208
      **  - RDE - Fee amount                                                                  CSW208
      *                                                                                       CSW208
     C           WFEEH     IFEQ 'Y'                                                           CSW208
     C                     MOVELHIAMTS    ##D,5                                               CSW208
     C                     ELSE                                                               CSW208
     C                     MOVELDFFAMT    ##D,5                                               CSW208
     C                     ENDIF                                                              CSW208
     C                     MOVE A6NBDP    ##D,5                                               CSW208
      *                                                                                       CSW208
      **  - RDE - Payment date                                                                CSW208
      *                                                                                       CSW208
     C                     SELEC                                                              CSW208
     C           DFPYON    WHEQ *BLANKS                                                       CSW208
     C           DFPYON    OREQ 'S'                                                           CSW208
     C                     MOVELDFPSTD    ##D,6                                               CSW208
     C           DFPYON    WHEQ 'E'                                                           CSW208
     C                     MOVELDFPEND    ##D,6                                               CSW208
     C           DFPYON    WHEQ 'N'                                                           CSW208
     C                     MOVELWFNPYD    ##D,6                                               CSW208
     C                     ENDSL                                                              CSW208
      *                                                                                       CSW208
      **  - RDE - Base currency details                                                       CSW208
      *                                                                                       CSW208
     C                     MOVELBJCYCD    ##CCY                                               CSW208
     C                     EXSR SRDCDT                                                        CSW208
     C                     MOVELA6CYNM    ##D,7                                               CSW208
      *                                                                                       CSW208
      **  - RDE - Fee amount equivalent in base currency                                      CSW208
      *                                                                                       CSW208
     C                     SELEC                                                              CSW208
      *                                                                                       CSW208
     C           WMDI1     WHEQ 'M'                                                           CSW208
     C           WFEEH     IFEQ 'Y'                                                           CSW208
     C           HIAMTS    MULT WRATE     W#AMTS                                              CSW208
     C                     ELSE                                                               CSW208
     C           DFAMTS    MULT WRATE     W#AMTS                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     OTHER                                                              CSW208
     C           WFEEH     IFEQ 'Y'                                                           CSW208
     C           HIAMTS    DIV  WRATE     W#AMTS                                              CSW208
     C                     ELSE                                                               CSW208
     C           DFAMTS    DIV  WRATE     W#AMTS                                              CSW208
     C                     ENDIF                                                              CSW208
      *                                                                                       CSW208
     C                     ENDSL                                                              CSW208
     C                     MOVELW#AMTS    ##D,8                                               CSW208
     C                     MOVE A6NBDP    ##D,8                                               CSW208
      *                                                                                       CSW208
      **  Accumulate RDE's and associated data and output to                                  CSW208
      **  PF/CGUDTAPD                                                                         CSW208
     C                     EXSR SRADTA                                                        CSW208
     C                     EXSR SRODTA                                                        CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                     EXSR POPGRS                                                        CSW208
     C                     MOVEA*BLANKS   @STK,Q                                              CSW208
     C                     SUB  1         Q                                                   CSW208
      *                                                                                       CSW208
     C                     ENDSR                                                              CSW208
     C********************************************************************
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
     C/SPACE 5                                                            CCG015
     C/COPY CGCPYSRC,CGNWEX                                               CCG015
** ##GRP/##RDE
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
BROKER0001 BROKER
BROKER0002 BROKER NAM
BROKER0003 BROKER TWN
CUST  0001 CUSTOMER
CUST  0002 CUST_NAME
CUST  0003 CUST_ADR1
CUST  0004 CUST_ADR2
CUST  0005 CUST_ADR3
CUST  0006 CUST_ADR4
CUST  0007 CUST_TOWN
R_DEPM0001 DEALNUMBER
R_DEPM0002 DEPOTM_REF
R_DEPM0003 SEC_SHTNAM
R_DEPM0004 SEC_REP
R_DEPM0005 DP_MAT_DAT Date
R_DEPM0006 NOMINAL    AmountL                                                                 245715
R_DEPM0007 SEC_NOMCCY
R_DEPM0008 DP_SIOI
R_DEPM0009 DP_FRST
R_CERT0001 DP_CERT1
R_CERT0002 DP_CERT2
R_CERT0003 DP_CERTUN
R_CERT0004 DP_CRT
R_CERT0005 DP_DREF
D_BCEQ0001 BCEEVAM    AmountL
D_BCEQ0002 BASE CCY
D_BASE0001 DEALNUMBER
D_BASE0002 DEAL DATE  Date
D_BASE0003 VALUE DATE Date
D_BCEQ0001 BCEEVAM    AmountL
D_BCEQ0002 BASE CCY
D_BCEQ0003 BASE CCYDS
D_BCEQ0004 PREC_METIN
D_BYSL0001 BUYER NAM
D_BYSL0002 SELLER NAM
D_CFC 0001 CURRENCY
D_CFC 0002 PRINCIPAL  AmountL
D_CFC 0003 FLOOR RAT  Rate  L7
D_CFC 0004 CEILG RAT  Rate  L7
D_CFC 0005 BASERATTYP
D_CFC 0006 BASERATNAM
D_CFC 0007 SPREAD     Rate  L7
D_CFC 0008 AV RATE
D_CFC 0009 BUY/SELL
D_CFC 0010 CCY_DESC
D_CFC 0011 PREC_METIN
D_CFC 0012 CCY_DESC_
D_DEPR0001 DEPOTM_REF
D_EIR 0001 EFFINTRATE Rate  L7
D_EIR 0002 STR EF
D_EIRO0001 OUR EFFRAT Rate  L7
D_EIRO0002 OUR STR EF
D_EIRT0001 THR EFFRAT Rate  L7
D_EIRT0002 THR STR EF
D_FLUF0001 FIRSTLAST
D_FLUF0002 UPFRONT
D_FRA 0001 CURRENCY
D_FRA 0002 PRINCIPAL  AmountL
D_FRA 0003 CONTPERIOD AmountL
D_FRA 0004 RATEFIXDTE Date
D_FRA 0005 BASERATTYP
D_FRA 0006 BASERATNAM
D_FRA 0007 CONTRATE   Rate  L7
D_FRA 0008 INT CALBAS
D_FRA 0009 BUY/SELL
D_FRA 0010 CCY_DESC
D_FRA 0011 PREC_METIN
D_FRX 0001 PURCH CCY
D_FRX 0002 PURCH AMNT AmountL
D_FRX 0003 EXCH RATE  Xrate L8
D_FRX 0004 SALE CCY
D_FRX 0005 SALE AMNT  AmountL
D_FRX 0006 SALE CCYDS
D_FRX 0007 PREC_METIN
D_FRX 0008 PURCH CCYD
D_FRX 0009 NETPURCHAS
D_FRX 0010 NETSALE
D_FRX 0011 PAMT_SC    AmountL
D_FRX 0012 SLAMT_SC   AmountL
D_FRX 0013 PAMT_EQCY  AmountL
D_FRX 0014 P_EQV_CCY
D_FRX 0015 P_EQV_CCYD
D_FRX 0016 SLAMT_EQCY AmountL
D_FRX 0017 S_EQV_CCY
D_FRX 0018 S_EQV_CCYD
D_INLD0001 CURRENCY
D_INLD0002 PRINCIPAL  AmountL
D_INLD0003 INT RATE   Rate  L7
D_INLD0004 NET INTRST AmountL
D_INLD0005 NET TOTAL  AmountL
D_INLD0006 TOTINTOVR
D_INLD0007 LOAN/DEPOS
D_INLD0008 CCY_DESC
D_INLD0009 PREC_METIN
D_IPY 0001 NXT IPDATE Date
D_IPY 0002 INT FREQ
D_IPY 0003 INT DAY
D_IPYO0001 OUR NIDATE Date
D_IPYO0002 OUR IPFREQ
D_IPYO0003 OUR IPDAY
D_IPYO0004 OUR INPM
D_IPYT0001 THR NIDATE Date
D_IPYT0002 THR IPFREQ
D_IPYT0003 THR IPDAY
D_IPYT0004 THR INPM
D_IRSO0001 OUR CCY
D_IRSO0002 OUR PRIN   AmountL
D_IRSO0003 OUR BASTYP
D_IRSO0004 OUR BASNAM
D_IRSO0005 OUR FIXRAT Rate  L7
D_IRSO0006 OUR SPREAD Rate  L7
D_IRSO0007 OUR_CALC_B
D_IRSO0008 OUR CCYDSC
D_IRSO0009 PREC_METIN
D_IRST0001 THR CCY
D_IRST0002 THR PRIN   AmountL
D_IRST0003 THR BASTYP
D_IRST0004 THR BASNAM
D_IRST0005 THR FIXRAT Rate  L7
D_IRST0006 THR SPREAD Rate  L7
D_IRST0007 THR_CALC_B
D_IRST0008 THR CCYDSC
D_IRST0009 PREC_METIN
D_ISSD0001 ISSUER
D_ISSD0002 ISSUER NAM
D_ISSD0003 ISSUER TWN
D_ISSD0004 N.A. REF
D_LAD 0001 CURRENCY
D_LAD 0002 PRINCIPAL  AmountL
D_LAD 0003 INT RATE   Rate  L7
D_LAD 0004 GRS INTRST AmountL
D_LAD 0005 NET INTRST AmountL
D_LAD 0006 TAX        AmountL
D_LAD 0007 TAXI
D_LAD 0008 NET TOTAL  AmountL
D_LAD 0009 TOTINTOVR
D_LAD 0010 LOAN/DEPOS
D_LAD 0011 CCY_DESC
D_LAD 0012 PREC_METIN
D_LAD 0013 INTPAY_SEP
D_LAD 0014 LST IPDATE Date
D_LAD 0015 CONFNARR
D_LAD 0016 C.D. REF
D_LAD 0017 N_TOT_SC   AmountL
D_LAD 0018 N_TOT_EQCY AmountL
D_LAD 0019 EQUIV_CCY
D_LAD 0020 EQUIV_CCYD
LNSTAX0001 ZSTAXFLG                                                                           CER049
LNSTAX0002 ZTAXPRFLG                                                                          CER049
LNSTAX0003 ZTAXPRDTE DATE                                                                     CER049
LNSTAX0004 ZTAXAVFLG                                                                          CER049
LNSTAX0005 ZTAXAVDTE DATE                                                                     CER049
LNSTAX0006 ZTAXINFLG                                                                          CER049
LNSTAX0007 ZTAXINDTE DATE                                                                     CER049
LNSTAX0008 ACCOUNTG                                                                           CER049
LNSTAX0009 Z_TAX_AMT AMOUNTL                                                                  CER049
LNSTAX0010 ZTAXINAMT AMOUNTL                                                                  CER049
LNSTAX0011 ZTAXAVAMT AMOUNTL                                                                  CER049
R_LAD 0001 REP_TRTP
R_LAD 0002 REP_MAT_PROC
R_LAD 0003 SETTLEMOD
R_LAD 0004 REP_PYF_V1
R_LAD 0005 REP_PYF_V2
R_LAD 0006 REP_PYT_V1
R_LAD 0007 REP_PYT_V2
R_LAD 0008 REP_FACOV1
R_LAD 0009 REP_FACOV2
R_LAD 0010 REP_PYF_M1
R_LAD 0011 REP_PYF_M2
R_LAD 0012 REP_PYT_M1
R_LAD 0013 REP_PYT_M2
R_LAD 0014 REP_FACOM1
R_LAD 0015 REP_FACOM2
R_LAD 0016 REP_SPEC
D_NAB 0001 CURRENCY
D_NAB 0002 FACE VALUE AmountL
D_NAB 0003 ISS/DSC RT Rate  L7
D_NAB 0004 YIELD RATE Rate  L7
D_NAB 0005 NET INTRST AmountL
D_NAB 0006 NET TOTAL  AmountL
D_NAB 0007 PURCH PRIC AmountL
D_NAB 0008 CCY_DESC
D_NAB 0009 PREC_METIN
D_NAB 0010 N_TOT_SC   AmountL
D_NAB 0011 PU_PR_SCCY AmountL
D_NAB 0012 N_TOT_EQCY AmountL
D_NAB 0013 PU_PR_EQCY AmountL
D_NAB 0014 EQUIV_CCY
D_NAB 0015 EQUIV_CCYD
D_NAS 0001 CURRENCY
D_NAS 0002 FACE VALUE AmountL
D_NAS 0003 ISS/DSC RT Rate  L7
D_NAS 0004 YIELD RATE Rate  L7
D_NAS 0005 SALE PRICE AmountL
D_NAS 0006 CCY_DESC
D_NAS 0007 PREC_METIN
D_NAS 0008 SL_PR_SCCY AmountL
D_NAS 0009 SL_PR_EQCY AmountL
D_NAS 0010 EQUIV_CCY
D_NAS 0011 EQUIV_CCYD
D_ONTN0001 OUR NAME
D_ONTN0002 THR NAME
D_OPTD0001 OPT TODATE Date
D_OPTN0001 OPTDEALNUM
D_OTH10001 CANC/AMEND
D_OTH10002 FEDERAL
D_OTH10003 AUTO-TRAN
D_OTH10004 DEAL TYPE
D_OTH10005 DEALSUBTYP
D_OTH10006 BLOCK_FLAG                                                                         CDL016
D_OTH10007 FIX_BSRT                                                                           CDL019
D_PARS0001 PARCEL SIZ
D_PAYS0001 S_PAYOURA1
D_PAYS0002 S_PAYOURA2
D_PAYS0003 S_PAYOURNN
D_PAYS0004 S_PAYOURNT
D_PAYS0005 S_PAYOURXG
D_PAYS0006 S_PAYOURXR
D_PAYS0007 S_PAYTHRA1
D_PAYS0008 S_PAYTHRA2
D_PAYS0009 S_PAYTHRNN
D_PAYS0010 S_PAYTHRNT
D_PAYS0011 S_PAYZFAL1
D_PAYS0012 S_PAYZFAL2
D_PAYS0013 S_PAYZFAON
D_PAYS0014 S_PAYZFAOT
D_PAYS0015 S_SPEC_INS
D_PAYS0016 P_SCCY
D_PAYS0017 P_SCCYD
D_RCH 0001 NXT RCDATE Date
D_RCH 0002 RC FREQ
D_RCH 0003 RC DAY
D_RCHO0001 OUR NRDATE Date
D_RCHO0002 OUR RCFREQ
D_RCHO0003 OUR RCDAY
D_RCHT0001 THR NRDATE Date
D_RCHT0002 THR RCFREQ
D_RCHT0003 THR RCDAY
D_RECS0001 S_RECOURA1
D_RECS0002 S_RECOURA2
D_RECS0003 S_RECOURNN
D_RECS0004 S_RECOURNT
D_RECS0005 S_RECOURXG
D_RECS0006 S_RECOURXR
D_RECS0007 S_RECTHRA1
D_RECS0008 S_RECTHRA2
D_RECS0009 S_RECTHRNN
D_RECS0010 S_RECTHRNT
D_RECS0011 R_SCCY
D_RECS0012 R_SCCYD
D_ROLD0001 ROLLDEAL
D_ROLD0002 ROLLCAPCHG AmountL
D_ROLD0003 ROLLCAPIND
MATURD0001 MATUR DATE Date
NOTICD0001 NOTICEDAYS
BYOUT 0001 BO_DDAT    Date
BYOUT 0002 BO_VDAT    Date
BYOUT 0003 BO_AMNT    AmountL
BYOUT 0004 BO_PYRC
BYOUT 0005 BO_AM_SCCY AmountL
BYOUT 0006 BO_AM_EQCY AmountL
BYOUT 0007 EQUIV_CCY
BYOUT 0008 EQUIV_CCYD
UPFEE 0001 UF_VDAT    Date
UPFEE 0002 UF_AMNT    AmountL
UPFEE 0003 UF_PYRC
UPFEE 0004 UF_AM_SCCY AmountL
UPFEE 0005 UF_AM_EQCY AmountL
UPFEE 0006 EQUIV_CCY
UPFEE 0007 EQUIV_CCYD
FRCD  0001 RT CHG DAT Date                                                                  BUG11112
FRCD  0002 RT CHG FRQ                                                                       BUG11112
FRCD  0003 RT CHG DAY                                                                       BUG11112
FRCD  0004 SH RATE FL                                                                       BUG11112
FRCD  0005 SH RATE    Rate  L7                                                              BUG11112
FRCD  0006 ACC INTRST AmountL                                                               BUG11112
FRCD  0007 ACC COF    AmountL                                                               BUG11112
FRCD  0008 SH RATE VA Rate  L7                                                              BUG11112
FRCD  0009 FX RATE VA Rate  L7                                                              BUG11112
FRCD  0010 RT FIX DAY                                                                       BUG11112
FRCD  0011 RT FIX DATEDate                                                                  BUG11112
FRCD  0012 RT FIX PRFL                                                                      BUG11112
FRCD  0013 FIX BASE RTRate  L7                                                              BUG11112
FRCD  0014 FWD YLD CUR                                                                      BUG11112
FRCD  0015 BASERTCOD                                                                        BUG11112
FRCD  0016 BASERTNAM                                                                        BUG11112
FRCD  0017 SPREADRAT  Rate  L7                                                              BUG11112
FRCD  0018 CALCBASIS                                                                        BUG11112
DL_FED0001 DL_FEESDNO                                                                         CSW208
DL_FED0002 DL_FEEFCOD                                                                         CSW208
DL_FED0003 DL_FEEFCCY                                                                         CSW208
DL_FED0004 DL_FEEFCYD                                                                         CSW208
DL_FED0005 DL_FEEFAMT AmountL                                                                 CSW208
DL_FED0006 DL_FEEDTE  Date                                                                    CSW208
DL_FED0007 DL_FEEECYD                                                                         CSW208
DL_FED0008 DL_FEEEAMT AmountL                                                                 CSW208
** Loan Deal Types
IPTICLLNDLILPL
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** ##TXT  **      TEXT FOR REPORT FILE
YOURSELVES
