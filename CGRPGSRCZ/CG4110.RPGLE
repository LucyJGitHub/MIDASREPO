     H DEBUG
     H CCSID(*GRAPH:*SRC)                                                                   MD056543
     F*****************************************************************
/*S*D ***RPGBASE*******************************************************                     MD056543
/*STD *  RPGBASEBND                                                   *                     MD056543
/*EXI *  TEXT('Midas CG Dealing end of day confirmations')            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4110 - Dealing End of Day Confirmations                    *
     F*                               - Principal change advices      *
     F*                               - Rate change advices           *
     F*                               - Rate fix advices              *
     F*                               - Settlement advices            *
     F*                               - Interest advices              *
     F*                               - Maturity advices              *
     F*                                                               *
     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*  (phase(s))                                                   *
     F*                                                               *
     F*  Called By: mmCnnnn - (program name)                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD057008           Date 27Oct20               *
      *  Prev Amend No. MD056543           Date 15Sep20               *
      *                 260405             Date 04Apr20               *
      *                 CER050             Date 16Jun19               *
      *                 MD053295           Date 13Apr19               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 MD033854           Date 26Mar15               *
      *                 MD033892           Date 11Jun15               *
      *                 CGL165             Date 17Feb15               *
      *                 MD031353           Date 13Feb15               *
      *                 MD031366           Date 13Feb15               *
      *                 MD031144           Date 13Feb15               *
      *                 MD031125           Date 19Nov14               *
      *                 MD026788           Date 18Nov14               *
      *                 MD027745B          Date 25Nov14               *
      *                 MD030644           Date 25Nov14               *
      *                 MD029242           Date 25Nov14               *
      *                 CER070             Date 19Aug14               *
      *                 CDL096I02          Date 05Nov14               *
      *                 CDL096             Date 29Sep14               *
      *                 CER069             Date 03Jul14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD027745A          Date 20Aug14               *
      *                 MD027745           Date 19Aug14               *
      *                 MD019890           Date 07Apr13               *
      *                 AR1097426          Date 26Mar13               *
      *                 AR1012947          Date 26Dec12               *
      *                 AR1029141          Date 28Jan13               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR995867           Date 30Jun12               *
      *                 AR890271           Date 09Jan12               *
      *                 AR871662           Date 23Dec11               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 AR761591           Date 24May11               *
      *                 AR745799           Date 18May11               *
      *                 AR702741           Date 02Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26575           Date 04Nov09               *
      *                 BUG26332           Date 07Oct09               *
      *                 BUG24860           Date 13Jul09               *
      *                 BUG23948B          Date 16Jun09               *
      *                 BUG24190           Date 04Jun09               *
      *                 BUG23799A          Date 22May09               *
      *                 BUG24029           Date 20May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG23948           Date 09May09               *
      *                 BUG23880           Date 01May09               *
      *                 BUG23812           Date 24Apr09               *
      *                 BUG23515B          Date 18Apr09               *
      *                 BUG23515           Date 31Mar09               *
      *                 BUG23572           Date 27Mar09               *
      *                 BUG23165           Date 03Mar09               *
      *                 BUG22741           Date 20Feb09               *
      *                 BUG22911           Date 17Feb09               *
      *                 BUG22529           Date 11Feb09               *
      *                 BUG22580           Date 02Feb09               *
      *                 CER048A            Date 19May08               *
      *                 CER038A            Date 19May08               *
      *                 CER034A            Date 19May08               *
      *                 CER016A            Date 19May08               *
      *                 CER048             Date 19May08               *
      *                 CER038             Date 19May08               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CSW208             Date 15Apr08               *
      *                 BUG17139           Date 19Mar08               *
      *                 246141             Date 26Mar07               *
      *                 244570             Date 19Dec06               *
      *                 243959             Date 07Dec06               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 BUG11112           Date 07Jun06               *
      *                 BUG1111            Date 07Jun06               *
      *                 CDL013             Date 07Jun06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CDL019             Date 10Nov05               *
      *                 CDL018             Date 10Nov05               *
      *                 CDL017             Date 10Nov05               *
      *                 CDL016             Date 10Nov05               *
      *                 CSD027A            Date 05May06               *
      *                 BUG11111           Date 04Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9603            Date 13Dec05               *
      *                 235126             Date 26Sep05               *
      *                 235426             Date 12Aug05               *
      *                 234602             Date 01Jul05               *
      *                 234407             Date 04Jul05               *
      *                 235143             Date 26Jul05               *
      *                 234865             Date 11Jul05               *
      *                 233277             Date 28Apr05               *
      *                 232543             Date 01Apr05               *
      *                 CGL031             Date 05Jul04               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL038             Date 10May05               *
      *                 BUG7628            Date 24Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG7326            Date 31May05               *
      *                 CSD025             Date 11Jan05               *
      *                 BUG5758            Date 03Feb05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 04Jan01               *
      *                 151837             Date 26Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 16Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 150163             Date 14Dec98               *
      *                 145001             Date 19Oct98               *
      *                 CEU015             Date 19Jun98               *
     F*                 138000             DATE 30JUN98               *
     F*                 CEU014             DATE 24JUN98               *
      *                 CEU003             Date 07Jan98               *
      *                 119240             Date 12Jun97               *
     F*                 116840             Date 30May97               *
     F*                 117163             Date 23Apr97               *
     F*                 CSW011             Date 19Mar97               *
     F*                 110874             Date 25Nov96               *
     F*                 CSW005             Date 01Aug96               *
     F*                 089776             Date 17Apr96               *
     F*                 089760             Date 16Apr96               *
     F*                 089649             DATE 16APR96               *
     F*                 095473             DATE 02JAN96               *
     F*                 S01408             DATE 04AUG95               *
     F*                 088485             DATE 25MAY95               *
     F*                 088501             DATE 24MAY95               *
     F*                 088494             DATE 23MAY95               *
     F*                 088492             DATE 19MAY95               *
     F*                 087117             DATE 05MAY95               *
     F*                 087053             DATE 04MAY95               *
     F*                 087000             DATE 03MAY95               *
     F*                 086962             DATE 03MAY95               *
     F*                 086918             DATE 02MAY95               *
     F*                 086864             DATE 01MAY95               *
     F*                 086797             DATE 27APR95               *
     F*                 086780             DATE 27APR95               *
     F*                 CIR001             DATE 13JUL95               *
     F*                 086158             DATE 24MAR95               *
     F*                 082060             DATE 24JAN95               *
     F*                 081961             DATE 12JAN95               *
     F*                 S01408             DATE 20FEB95               *
     F*                 S01522             DATE 22NOV94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD057008 - CGC2050 00007 fails during COB                    *
      *  MD056543 - EDWH SSRS Reports cannot be run.                  *
      *           - Translate graphic fields of CGCORRPD and CGCDSHPD *
      *             to readable unicode equivalent.                   *
      *  260405 - BRT Participation Date of Birth field is missing.   *
      *           Upgrade fix 235425. Recompile over changes in file  *
      *           SDCBRTPD.                                           *
      *         - Applied for MD055446.                               *
      *  CER050 - Annualised Percentage Rate                          *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  MD033854 -  Confirmation shows old Base Rate name after Deal *
      *              amendment BC. Review MD030644.                   *
      *  MD033892  - Secondary/Third Tax amounts calculated for the   *
      *              first taxable deal are carried over to the next  *
      *              deals with zero total interest calculated. The   *
      *              result is that the NetInterestInDealCurrency,    *
      *              NetInterestInTaxCurrency and NetInterest (-give) *
      *              are incorrectly extracted to the advices.        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD031353 - CM Interest advice of non-taxable call deposit    *
      *             000129 has wrong/strange gross interest           *
      *           - make sure to get the current base rate and spread *
      *             rate of the deal                                  *
      *  MD031366 - CM Interest Advice for a capitalized taxable call *
      *             deposit contains wrong interest/new principal.    *
      *           - Deal amendment amount for capitalise interest is  *
      *             zero so use the total interest in the file.       *
      *  MD031144 - Do not compute tax for deposits with negative     *
      *             interest                                          *
      *  MD031125 - MM TD Maturity confirmation interest and tax      *
      *             fields are zeros                                  *
      *  MD026788 - Always use the Deal Customer for European Tax     *
      *             checking when system value UseDealCustforEuTax    *
      *             is 'Y'.                                           *
      *           - Applied for MD031062.                             *
      *  MD027745B - Incorrect Net Interest Amount and Tax Amount of  *
      *              interest advice/confirmation.                    *
      *            - Use the interest calculated for the current      *
      *              period in calculating the tax amount.            *
      *            - Ensure correct total interest passed for calcu-  *
      *              lation of tax.                                   *
      *  MD030644 - Dealing confirmations/Retail interest advices     *
      *             missing core fields on Correspondence             *
      *           - include the missing fields in the extract         *
      *  MD029242 - System should generate Dealing CM correspondences *
      *             also for the Customers with SWIFT-Id (suppressed  *
      *             by CER038)                                        *
      *           - Created new system value to condition the         *
      *             suppression of correspondence if customer has     *
      *             Swift ID                                          *
      *  CER070 - BuBa Reporting / BAIS V.1.16.0 (Recompile)          *
      *  CDL096I02 - Fix on Next Interest Payment Date                *
      *  CDL096 - Business Day Conventions on MM deals                *
      *  CER069 - German Tax Enhancement                              *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *  MD027745A - Incorrect Net Interest Amount and Tax Amount of  *
      *              interest advice/confirmation.                    *
      *            - Use the interest calculated for the current      *
      *              period in calculating the tax amount.            *
      *  MD027745 - Taxable Deposit Maturity confirmation shows wrong *
      *             net interest due amount and wrong tax amount.     *
      *           - Incorrect details are accessed from PF/SDCSINLD.  *
      *  MD019890 - Wrong details of the Confirmation generated after *
      *             COB                                               *
      *  AR1097426 - No Correspondence generated after COB            *
      *  AR1012947 - Add BC amendment to extract details. Corrected   *
      *              actual interest rate for BC and SC amendment.    *
      *              (Child: AR1012948)                               *
      *  AR1029141 - No MT300 generated after COB if transaction type *
      *              is OP                                            *
      *            - Applied for AR1081701                            *
      *  AR996895 - Incorrect accrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  AR995867 - Error on CM - DLInterestAdvTimeDepositTaken       *
      *             (Child: AR995868)                                 *
      *  AR890271 - No details extracted for Stamp Tax                *
      *  AR871662  - Rate Change Advice in DL did not show the new    *
      *              values when DEAM was made.                       *
      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
      *  CRE073 - Portuguese Feature - Interest Rate Rounding         *
      *  AR761591 - Parameter mismatched on call to ZATXCLJA program  *
      *  AR745799 - CGC2050 00007 fails in COB since SDGELRPD BKEURO  *
      *             is blank. For GF, do not use EU0200 in converting *
      *             Tax amount to different currency since EU0200     *
      *             requires BKEURO as non-blank when called.         *
      *             (Child: Artf745800)                               *
      *  AR702741 - Include location as parameter in ZFREQB to        *
      *             determine the next settlement date                *
      *             (Child: AR702742)                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26575 - CGC2050 00007. Pattern fix after bug26438.        *
      *  BUG26332 - COB error on CGC2050 00007 ; parameter mismatch   *
      *  BUG24860 - COB error div 0 CGC2050 00001                     *
      *  BUG23948B - Decimal places not populates in tax Curr field   *
      *              when deal is in Japanese Yen                     *
      *  BUG24190 - Incorrect computation of Portion of Threshold used*
      *  BUG23799A - Local Tax Customer scenario not correct          *
      *  BUG24029 - COB Error RE3662 Database Error                   *
      *  CER054 - German Features - Church Tax                        *
      *  BUG23948 - Problems with Single Tax advice on retest         *
      *  BUG23880 - Deals as non-Taxable - Confo is incorrect         *
      *  BUG23812 - Problem with confo - German Withholding Tax       *
      *  BUG23515B - Dealing Confirmations missing for new fields     *
      *  BUG23515 - Dealing Confirmations missing for new fields      *
      *  BUG23572 - CHIPSABA Not Accept '0' on screen, so that populat*
      *             with blanks when '0' values in database(Recompile)*
      *  BUG23165 - Net interest amount calculated is incorrect       *
      *  BUG22741 - Populate Telex Number, when STTX Address is blank *
      *             in SDCUSTPD (Recompile)                           *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  BUG22529 - Global Additional Customer Details (Recompile)    *
      *  BUG22580 - Fields incorrectly labeled and lengths            *
      *           (Recompile)                                         *
      *  CER048A - German Features - Taxes                            *
      *  CER038A - Additional fields added to Correspondence          *
      *            (upg German Feat)                                  *
      *  CER034A - LF046 German Features - New Fields and Enquiries   *
      *           (Recompile)                                         *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *           to Midas Plus (Recompile)                           *
      *  CER048 - German Features - Taxes                             *
      *  CER038 - Additional fields added to Correspondence           *
      *           (upg German Feat)                                   *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  CSW208 - SWIFT 2008 Changes                                  *
      *  BUG17139 - CGC2050 Fallover                                  *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
     F*  244570 - Do not generate confirmation when CNRQ is 'o','O',  *
     F*          't' or 'T' (CIR003).                                 *
      *  243959 - CGC2050 failed. DBERR at 954 in CG3604. CG3604 ends *
      *           in DBERR 003, DBFILE='Referenc', DBKEY=':XCCY_IRS'. *
      *           Skip SR/SRGENR (go to EXMAIN) when CNRQ is equal to *
      *           'T', 't', 'O' or 'o'.                               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG11112 - Correspondence Manager changes for CDL033         *
      *             enhancement.                                      *
      *  CDL013 - Tiered Withholding Tax                              *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL019 - Allow Base Rate Changes on Fixed Term Loan/Deposit. *
      *           Print text 'Variable Rates will be Applied to the   *
      *           Deal' when Fix Base Rate field FSFBRT = 'Y'.        *
      *  CDL018 - Multiple Settlement Accounts for Fixed Deposits.    *
      *  CDL017 - New confirmation for Early Maturity deal            *
      *           amendment.                                          *
      *  CDL016 - Automatic Rollover of Fixed Term Loan/Deposit.      *
      *           Print text '** EAR-MARKED **' in the correspondence *
      *           where a deal is blocked (FSBLKA = 'Y').             *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  BUG11111 - Decimal data error due to unexpanded account code *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9603 - Changes in CGPACKE caused some programs not to     *
      *            compile.                                           *
      *  235126 - Difference between a deal's enquiry & its           *
      *           confirmation.                                       *
      *  235426 - Review Tax calculation.                             *
      *  234602 - Consider the effective date when calculating EU Tax *
      *  234407 - Error in Rollover when the settlement is on Nostro  *
      *  235143 - Add a condition for the SRDTAX. Tax indicator is    *
      *           not enough.                                         *
      *  234865 - No local tax on fiduciary. Only EU Tax must be      *
      *           calculated.                                         *
      *           EU Tax must be available in local ccy.              *
      *  233277 - Output to SDCSINPD should be done in DL0280         *
      *  232543 - Fix to CGL031                                       *
      *  CGL031 - Taxation on Savings Income                          *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  BUG7628- UDC using broker from previous confo generated.     *
      *           Fix is to make sure that the correct broker is      *
      *           used for each UDC confo generated. Applied 216803.  *
      *         - CGC2050 seq 00007 fails. Applied 230324.            *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG7326 - General ledger account incomplete in element       *
      *            <SaleReceiveOurXGeneralLedger> and <SalePayOur     *
      *            XGeneralLedger>. This is due to field ##OGA        *
      *            still 20-char long and not expanded to 24 chars    *
      *            (missed out by CGL029). Also note length of RDEs   *
      *            S_RECOURXG and S_PAYOURXG was increased from 20    *
      *            to 24.                                             *
      *  CSD025 - Customer De-Activation                              *
      *  BUG5758- System is generating MT362 everyday for OIS deals.  *
      *         - MT362 should only be generated during settlement or *
      *           interest payment date. Applied 221860.              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  CCG015 - Correspondence Manager - Phase 1.                   *
      *  151837 - PRNC_EQCY and G_INT_EQCY never updated.             *
      *  CSD006 - Use DSSDY for call to AOBSRTR0.                     *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  150163 - EMU fix - Settlement instructions for confirmations *
     F*           incorrect.  Wrong currency is passed to formatting  *
     F*           programs. Should pass settlement ccy if defined,    *
     F*           otherwise, transaction currency.                    *
     F*  145001 - CEU015 fix: No need to convert RBDA as it is        *
     F*           already expressed in deal currency.                 *
     F*  CEU015 - EMU Enhanced Money Market Deal Rollover.            *
     F*  138000 - EMU settlement amounts are incorrect.               *
     F*  CEU014 - EMU User Defined Correspondence changes             *
     F*  CEU003 - EMU DL/LE Settlement Currency Conversion            *
     F*           Added new RDEs to group sets:                       *
     F*           D_DAPC (d13LAD), D_FRAS (d19FRA), D_LADS (d20LAD),  *
     F*           D_IRXO (d21IRS), D_IRXT (d21IRS), D_CFCS (d22CFC),  *
     F*           D_LAD  (d23LAD), D_FRX  (d24OMA), D_RECS, D_PAYS.   *
      *  119240 - Include Currency Financial Centre.                  *
     F*  116840 - C.D. Reference not available on all                 *
     F*           occurences of D_LAD                                 *
     F*  117163 - HOOK CG4010SPPS renamed CG4110SPPS.                 *
     F*  CSW011 - Generate FRA MT34n messages only.                   *
     F*  110874 - Incorrect start and end dates on settlement         *
     F*           confirmation for backvalued IRSs; Dates for past    *
     F*           is shown instead of current period.                 *
     F*  CSW005 - MG34n and MG36n message generation                  *
     F*  089776 - Add 'Account officer' details                       *
     F*  089760 - Add 'PRINCIPAL' to group set D_DARC (d14LAD)        *
     F*  089649 - Add 'Conf. Narrative' to group set D_LAD/D_DAPC/    *
     F*           D_DARC/D_LADS                                       *
     F*  095473 - Bank/non-bank on customer details                   *
     F*  S01408 - Addition of hook CG4010FFP1                         *
     F*           Addition of hook CG4010EEP1                         *
     F*           Addition of hook CG4010EEP2                         *
     F*           Addition of hook CG4010IIP1                         *
     F*           Addition of hook CG4010CCP2                         *
     F*           Addition of hook CG4010CCP3                         *
     F*           Addition of hook CG4010CCP4                         *
     F*           Addition of hook CG4010CCP5                         *
     F*           Addition of hook CG4010CCP6                         *
     F*           Addition of hook CG4010CCP7                         *
     F*           Addition of hook CG4010CCP8                         *
     F*           Addition of hook CG4010CCP9                         *
     F*           Addition of hook CG4010CP10                         *
     F*           Addition of hook CG4010CP11                         *
     F*           Addition of hook CG4010CP12                         *
     F*           Addition of hook CG4010CP13                         *
     F*           Addition of hook CG4010CP14                         *
     F*           Addition of hook CG4010CP15                         *
     F*           Addition of hook CG4010CP16                         *
     F*           Addition of hook CG4010CP17                         *
     F*           Addition of hook CG4010CP18                         *
     F*           Addition of hook CG4010CP19                         *
     F*  088485 - Use correct branch for settlement methods 04, 05    *
     F*           and... set up interest capitalization indicator     *
     F*           for amendment type 'CI'                             *
     F*  088501 - Output tax and net amount if zero                   *
     F*  088494 - Correct calculation of period dates                 *
     F*  088492 - Suppress internal funding maturity confirmations    *
     F*  087117 - Settlements '/' line processing,Account with bank   *
     F*           not being setup.                                    *
     F*  087053 - Correct auto transmission processing.               *
     F*  087000 - Extend X-S processing to cater for sett. method 04  *
     F*  086962 - Add 'Start or Last Interest date' to group set D_LAD*
     F*  086918 - Add customer town RDE to Group set CUST.            *
     F*  086864 - Add interest paid seperately and Special Instructions
     F*  086797 - If BROKER = TELX/PHON/MAIL put telex/telephone/mail *
     F*           into BROKER NAME.                                   *
     F*  086780 - Add currencies descriptions.                        *
     F*  CIR001 - Interest Rate Calendars.                            *
     F*  086158 - Add Extended settlements processing.                *
     F*  082060 - Redefine Binary fields as Decimal (9,0 Packed)      *
     F*  081961 - User Defined Correspondence - Additions             *
     F*  S01408 - Addition of core hook CG4110FFPG                    *
     F*           Addition of core hook CG4110CCPG                    *
     F*           Addition of core hook CG4110CCP1                    *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  01   -    Deal read from DEALSDB                             *
     F*  02   -    Deal read from DEALSDC                             *
     F*  03   -    Deal read from DEALSDD                             *
     F*  04   -    Deal read from DEALSDE                             *
     F*  05   -    Deal read from DEALSDG                             *
     F*  06   -    Deal amendment read from DEAMSDI                   *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     FDLCCGDL0  IF   E           K DISK    USROPN                                             CDL006
      ** Deal Charges/Commissions  - Extended file - Rtv idx                                  CDL006
     F*                                                                                       S01408
     F/COPY WNCPYSRC,CG4110FFPG                                                               S01408
      *                                                                                       CER038
      ** Correspondent file by customer number                                                CER038
      *                                                                                       CER038
     FCGCORRL4  IF   E           K DISK    USROPN                                             CER038
     F*                                                                                       S01408
     FDEALS     IF   E           K DISK
     F                                     INFSR(SRFILE)
     FDEAMS     IF   E           K DISK
     F                                     INFSR(SRFILE)
     FSDBRTDL1  IF   E           K DISK
     F                                     INFSR(SRFILE)
     FSDCBRTL1  IF   E           K DISK
     F                                     INFSR(SRFILE)
     FDLFSACL0  IF   E           K DISK                                                       CDL018
     F                                     INFSR(SRFILE)                                      CDL018
      *                                                                                       CDL018
     F***SDCSINL6IF  E           K        DISK                                         CGL031 232543
     F**********                                    KINFSR SRFILE                      CGL031 232543
     FSDJACCLB  IF   E           K DISK                                                       232543
     F                                     INFSR(SRFILE)                                      232543
     F***SDCSINPDO   E                    DISK                                         232543 233277
     F**********                                    KINFSR SRFILE                      232543 233277
     FDLDTSCPD  IF   E           K DISK                                                       CIR001
     F                                     INFSR(SRFILE)                                      CIR001
     FDLCFSCPD  IF   E           K DISK                                                       CIR001
      *                                                                                       CDL013
     FSDSTAAL1  IF   E           K DISK    USROPN                                             CDL013
      ** WHT ICD extension file                                                               CDL013
      *                                                                                     BUG23515
      **  Midas SD Customer Income                                                          BUG23515
      *                                                                                     BUG23515
     FSDCSINLE  IF   E           K DISK    USROPN                                           BUG23515
      *                                                                                     BUG23515
      ** Midas SD Cust Details by Country of TAX                                           BUG23799A
      *                                                                                    BUG23799A
     FSDACTXL1  IF   E           K DISK                                                    BUG23799A
      *                                                                                    BUG23799A
     F/COPY WNCPYSRC,CG4110F001
     F                                     INFSR(SRFILE)                                      CIR001
     FDLFHSTL0  IF   E           K DISK                                                       CSW208
     F                                     INFSR(SRFILE)                                      CSW208
     FDLFEEDLB  IF   E           K DISK                                                       CSW208
     F                                     INFSR(SRFILE)                                      CSW208
     F/COPY WNCPYSRC,CG4110FFP1                                                               S01408
     F*                                                                                       S01408
      *                                                                                       CER049
      ** Midas DL Stamp Tax Extension File                                                    CER049
      *                                                                                       CER049
     FDLDLDCL3  IF   E           K DISK                                                       CER049
      *                                                                                       CER049
     FDLAPRHI0  IF   E           K DISK                                                       CER050
      *                                                                                       CER050
     F/SPACE 5
     D*COPY*CGCPYSRC,CGPACKE                                                                MD056543
     D*COPY*CGCPYSRC,SRERRE                                                                 MD056543
     D/COPY CGCPYSRC,CGPACKEILE                                                             MD056543
     D/COPY CGCPYSRC,SRERRDLE                                                               MD056543
     D**  Number Arrays
     D*##NUMA***       S              1    DIM(29)                                          MD056543
     D*
     D* ##GRP = Group/RDE Number               ##RDE = RDE + Attributes
     D*
     D********************##GRP   1 150 10   ##RDEA 22                                        086780
     D********************##GRP   1 171 10   ##RDEA 22                                  086780086864
     D********************##GRP   1 173 10   ##RDEA 22                                  086864086918
     D********************##GRP   1 174 10   ##RDEA 22                                  086918086962
     D*                                                                                       S01408
     D/COPY WNCPYSRC,CG4110EEP2                                                               S01408
     D*                                                                                       S01408
     D********************##GRP   1 175 10   ##RDEA 22                                        CIR001
     D********************##GRP   1 216 10   ##RDEA 22                                  CIR001089649
     D********************##GRP   1 217 10   ##RDEA 22                                  089649089760
     D********************##GRP   1 218 10   ##RDEA 22                                  089760089649
     D********************##GRP   1 221 10   ##RDEA 22                                  089760116840
     D********************##GRP   1 222 10   ##RDEA 22                                  116840119240
     D***********         ##GRP   1 223 10   ##RDEA 22                                  119240CEU003
     D***********         ##GRP   1 238 10   ##RDEA 22                                 CEU003CEU0145
     D***********         ##GRP   1 273 10   ##RDEA 22                                 CEU014CEU0156
     D***********         ##GRP   1 275 10   ##RDEA 22                                 CEU015CDL0067
     D**********          ##GRP   1 281 10   ##RDEA 22                                 CDL006 151837
     D**********          ##GRP   1 283 10   ##RDEA 22                                 151837 234865
     D********************##GRP   1 286 10   ##RDEA 22                                 234865 CDL016
     D********************##GRP   1 287 10   ##RDEA 22                                 CDL016 CDL017
     D********************##GRP   1 293 10   ##RDEA 22                                 CDL017 CDL018
     D********************##GRP   1 393 10   ##RDEA 22                                 CDL018 CDL019
     D********************##GRP   1 394 10   ##RDEA 22                               CDL019 BUG11112
     D**********          ##GRP   1 409 10   ##RDEA 22                               BUG11112 CSW208
     D**********          ##GRP   1 417 10   ##RDEA 22                                 CSW208 CER054
     D**********          ##GRP   1 453 10   ##RDEA 22                                 CER054 CRE073
     D**********          ##GRP   1 461 10   ##RDEA 22                                 CRE073 CER049
     D**********          ##GRP   1 472 10   ##RDEA 22                               CER049 AR995867
     D**********          ##GRP   1 473 10   ##RDEA 22                               AR995867 CDL094
     D**********          ##GRP   1 485 10   ##RDEA 22                               CDL094 MD030644
     D**********          ##GRP   1 494 10   ##RDEA 22                               MD030644 CER050
     D ##GRP           S             10    DIM(495) CTDATA PERRCD(1)                          CER050
     D ##RDEA          S             22    DIM(495) ALT(##GRP)                                CER050
     D*                                                                                       S01408
     D/COPY WNCPYSRC,CG4110EEP1                                                               S01408
     D*                                                                                       S01408
     D*
     D**  Array of Currencies accessed by program
     D ##CY            S              3    DIM(100)
     D*
     D**  Arrays of Deal Type (DTYP) and the associated print item sub-type.
     D***********         ##DT    1  41  2   ##PS   10                                        CDL006
     D**********          ##DT    1  47  2   ##PS   10                               CDL006 BUG11112
     D ##DT            S              2    DIM(48) CTDATA PERRCD(1)                         BUG11112
     D ##PS            S             10    DIM(48) ALT(##DT)                                BUG11112
     D*
     D**  Loan Deal Types.
     D***********         #LN     7   7  2                                                    CDL006
     D #LN             S              2    DIM(10) CTDATA PERRCD(10)                          CDL006
      *                                                                                       CDL006
      ** Arrays used to retrieve percentage of current range for                              CDL006
      ** Deal Principal Amount                                                                CDL006
      *                                                                                       CDL006
     D*
     D**  Copyright array.
     D*
     D*********** DS                                                                         082060
     D***********                         B   1   20##OSEQ                                   082060
     D****Convert Ouput Sequence between Numeric and Binary                                  082060
     D*
     D                 DS
     D  ##GRPX                 1     10
     D  ##GRPS                 1      6
     D  ##RDEN                 7     10  0
     D**  Look-up string for RDE definition Array
     D*
     D ##SDS           DS
     D**********                              15120 ##S                                      BUG9603
     D  ##S                    1   5632                                                      BUG9603
     D                                     DIM(22)                                          MD056543
     D**  Packed data string.
     D*
     D                 DS
     D  ##W                    1     20
     D                                     DIM(20)
     D  ##WNUM                 1     20  0
     D**  Number Field
     D*
     D                 DS
     D  ##ITMA                 1      8
     D  ##ITEM                 1      8  0
     D** Used to convert item reference from character to numeric
     D*
     D                 DS
     D  #DLNO                  1      6
     D  #VDAT                  7     11
     D  #DASN                 12     14
     D  #DVD                   1     14
     D** Deal Amendment Key
     D*
     D*---------------------------------------------------------------------
     D* Named constants
     D*
     D W#PTPC          C                   CONST('DEAL_PRCHG')
     D W#PTRC          C                   CONST('DEAL_RTCHG')
     D W#PTEM          C                   CONST('DEAL_MACHG')                                CDL017
     D W#PTRF          C                   CONST('DEAL_RTFIX')
     D W#PTIN          C                   CONST('DEAL_INTER')
     D W#PTMA          C                   CONST('DEAL_MATUR')
     D W#PTBO          C                   CONST('DEAL_BYOUT')                                CIR001
     D W#PHON          C                   CONST('Telephone')                                 086797
     D W#DLSW          C                   CONST('DLFSWIFTConf')                              CSW208
     D C#BASE          C                   CONST('BasCcyTaxRoundDown')                        CDL081
     D C#NBAS          C                   CONST('NBasCcyTaxRoundDown')                       CDL081
     D #SUPRS          C                   CONST('SupCorr4CustwSwiftID')                    MD029242
     D WUSEDL          C                   CONST('UseDealCustforEuTax')                     MD026788
     D*                                                                                       S01408
     D/COPY WNCPYSRC,CG4110IIP1                                                               S01408
      *                                                                                       CER038
      ** External DS for nostro details                                                       CER038
      *                                                                                       CER038
     D SDNOST        E DS                  EXTNAME(SDNOSTPD)                                  CER038
      *                                                                                       CER038
      ** External DS for Counterparty nostro details                                          CER038
      *                                                                                       CER038
     D SDCNST        E DS                  EXTNAME(SDCNSTPD)
     D*                                                                                       S01408
     D*---------------------------------------------------------------------
     D ##UDCR        E DS                  EXTNAME(CGUDCRPD)
      ** External DS for incomplete reference
      *
     D SDBANK        E DS                  EXTNAME(SDBANKPD)
      **  External DS for Bank details
      *
     D SDGELR        E DS                  EXTNAME(SDGELRPD)
     D  QQACC4       E                     EXTFLD(QQACCD)                                     CER038
      **  External DS for General Ledger details
      *
     D SDMMOD        E DS                  EXTNAME(SDMMODPD)
      **  External DS for Module details
      *
     D SDDEAL        E DS                  EXTNAME(SDDEALPD)
     D  QQACC1       E                     EXTFLD(QQACCD)                                     CER038
      **  External DS for Dealing Module details
      *
     D SDTRAD        E DS                  EXTNAME(SDTRADPD)
     D  QQACC2       E                     EXTFLD(QQACCD)                                     CER038
      **  External DS for Trading Module details
      *
     D SDRETL        E DS                  EXTNAME(SDRETLPD)
     D  QQACC3       E                     EXTFLD(QQACCD)                                     CER038
      **  External DS for Retail details
      *
     D SDMGME        E DS                  EXTNAME(SDMGMEPD)
      **  External DS for Message Management details
      *
     D SDBRCH        E DS                  EXTNAME(SDBRCHPD)
      **  External DS for branch details
      *
     D SDBROK        E DS                  EXTNAME(SDBROKPD)
      **  External DS for broker details
      *
     D SDCUST        E DS                  EXTNAME(SDCUSTPD)
     D  QQDFA1       E                     EXTFLD(QQDFAC)                                     CGL029
      **  External DS for customer details
      *
     D SDBSRT        E DS                  EXTNAME(SDBSRTPD)
      **  External DS for base rate details
      *
     D SDCURR        E DS                  OCCURS(101) EXTNAME(SDCURRPD)
      **  External DS for currency details
      *
     D SDACUS        E DS                  EXTNAME(SDACUSPD)
      **  External DS for Additional Customer Details                                         232543
      *                                                                                       232543
     D SDNAHO        E DS                  EXTNAME(SDNAHOPD)                                  232543
      **  External DS for Non-Account Holders Details                                         232543
      *                                                                                       232543
     D SDLOCN        E DS                  EXTNAME(SDLOCNPD)                                  234602
      ** External DS for Location Code                                                        234602
      *                                                                                       234602
     D SDCTTX        E DS                  EXTNAME(SDCTTXPD)                                  234602
      ** External DS for Country of Tax Codes                                                 234602
      *                                                                                       234602
     D SCSARD        E DS                  EXTNAME(SCSARDPD)                                  CCG015
      ** MIDAS Switchable Features Accessed Via Access Program                                CCG015
      *                                                                                       CCG015
     D DSFDY         E DS                  EXTNAME(DSFDY)
      **  First DS for access programs, short data structure
      *
     D DSSDY         E DS                  EXTNAME(DSSDY)
      **  Second DS for access programs, long data structure
      *                                                                                     BUG24029
     D DSLDY         E DS                  EXTNAME(DSLDY)                                   BUG24029
      **  Second DS for access programs, long data structure                                BUG24029
      *
     D DSPARM        E DS                  EXTNAME(DTRIEPH)
     D  DTDLNO       E                     EXTFLD(DLNO)
     D  DTVDAT       E                     EXTFLD(VDAT)
     D  DTDASN       E                     EXTFLD(DASN)
     D  DTCHTP       E                     EXTFLD(CHTP)
      **  External DS for parameters based on PF/DTRIXDD
      *
     D W0FMT         E DS                  EXTNAME(CGUDTAPD)
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     D***##SRDT*     DS                         20                                            CSW208
     D ##SRDT          DS                  OCCURS(80)                                         CSW208
      **  DS to store subroutine specific data.
      **  - Saved Path
      **  - Previous bind                                                                     CSW208
      **  - This bind                                                                         CSW208
     D  ##SPAT                 1     70
     D  ##PBIN                71     75P 0                                                    CSW208
     D  ##TBIN                76     80P 0                                                    CSW208
     D               E DS                  EXTNAME(DLCCGDPD)                                  CDL006
      *                                                                                       CDL006
      ** Data-structure used to set up arrays ZRA and ZPE from                                CDL006
      ** FID Deposit Commission/Charges type details file                                     CDL006
      ** DLCCGDPD, to locate the highest range for Principal amount.                          CDL006
      *                                                                                       CDL006
     D  ZRA                   31    142P 0                                                    CDL006
     D                                     DIM(14) ASCEND                                     CDL006
     D  ZPE                  143    202P 0                                                    CDL006
     D                                     DIM(15)                                            CDL006
      *                                                                                     BUG22911
     D SDTXPA        E DS                  EXTNAME(SDTXPAPD)                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
     D*COPY*CGCPYSRC,CGPACKI                                                                MD056543
     D/COPY CGCPYSRC,CGPACKIILE                                                             MD056543
      *
     D CPYR            DS
      **  Data Structure for Compilation - Copyright Insertion
     D  ##CPY                  1     80
     D                                     DIM(1) CTDATA PERRCD(1)
      *                                                                                       086158
      ** Parameters for call to CG4985.                                                       086158
     D P1PARM          DS           768                                                       086158
      * Pay - Settlement method                                                               086158
     D  P1PSTM                 1      2  0                                                    086158
      * Pay - Our Nostro                                                                      086158
     D**********                              3  14 P1PONS                             086158 CGL029
     D  P1POQQ                 3     14                                                       CGL029
      * Pay - Intermidiary bank no                                                            086158
     D  P1PIBN                15     25                                                       086158
      * Pay - Intermidiary account no                                                         086158
     D  P1PIBA                26     60                                                       086158
      * Pay - Ordering bank No                                                                086158
     D**********                             61  690P1POBN                             086158 CSD027
     D  P1POBN                61     69                                                       CSD027
      * Pay - Ordering customer no                                                            086158
     D**********                             70  780P1POCN                             086158 CSD027
     D  P1POCN                70     78                                                       CSD027
      * Receiver Correspondent no                                                             086158
     D  P1RCRN                79     89                                                       086158
      * Receiver Correspondent a/c line                                                       086158
     D  P1RCRA                90    124                                                       086158
      * Receiver Number                                                                       086158
     D  P1RVNO               125    135                                                       086158
      * A/C with bank no                                                                      086158
     D  P1AWBN               136    146                                                       086158
      * A/C with bank a/c line                                                                086158
     D  P1AWBA               147    181                                                       086158
      * Beneficiary number                                                                    086158
     D  P1BENN               182    192                                                       086158
      * Beneficiary account line                                                              086158
     D  P1BENA               193    227                                                       086158
      * Details of pay 1                                                                      086158
     D  P1DTP1               228    262                                                       086158
      * Details of pay 2                                                                      086158
     D  P1DTP2               263    297                                                       086158
      * Details of pay 3                                                                      086158
     D  P1DTP3               298    332                                                       086158
      * Details of pay 4                                                                      086158
     D  P1DTP4               333    367                                                       086158
      * Details of Charges                                                                    086158
     D  P1DCHG               368    370                                                       086158
      * Bank to bank info - 1                                                                 086158
     D  P1BTB1               371    405                                                       086158
      * Bank to bank info - 2                                                                 086158
     D  P1BTB2               406    440                                                       086158
      * Bank to bank info - 3                                                                 086158
     D  P1BTB3               441    475                                                       086158
      * Bank to bank info - 4                                                                 086158
     D  P1BTB4               476    510                                                       086158
      * Bank to bank info - 5                                                                 086158
     D  P1BTB5               511    545                                                       086158
      * Bank to bank info - 6                                                                 086158
     D  P1BTB6               546    580                                                       086158
      * Currency                                                                              086158
     D  P1CCY                581    583                                                       086158
      *                                                                                       087000
      ** 087000 - include additional details to allow determination                           087000
      ** of prime retail account for settlement method 04.                                    087000
     D  P1CNUM               584    589                                                       087000
     D  P1ACCD               590    599                                                       CGL029
     D  P1BRCH               600    602                                                       CGL029
     D  P1PONS               603    620                                                       CGL029
     D**********                            590 593 P1ACCD                             087000 CGL029
     D**********                            594 596 P1BRCH                             087000 CGL029
      *                                                                                       086158
      ** Parameters for call to CG4985.                                                       086158
      **                                                                                      086158
     D P3PARM          DS           256                                                       086158
      * Output Sequence                                                                       086158
     D  P1OSEQ                 1      9  0                                                    086158
      * UDC item number                                                                       086158
     D  P1ITEM                10     17  0                                                    086158
      * This bind level                                                                       086158
     D  P1TBIN                18     25  0                                                    086158
      * Previous bind level                                                                   086158
     D  P1PBIN                26     33  0                                                    086158
      *                                                                                       086158
      **  Parameters for call to CG4975.                                                      086158
      **                                                                                      086158
     D P6PARM          DS           256                                                       086158
      * Receipt - Settlement method                                                           086158
     D  P1RSTM                 1      2  0                                                    086158
      * Receipt - Our Nostro                                                                  086158
     D**********                              3  14 P1RONS                             086158 CGL029
     D  P1ROQQ                 3     14                                                       CGL029
      * Receipt - Intermidiary bank no                                                        086158
     D  P1RIBN                15     25                                                       086158
      * Receipt - Intermidiary account no                                                     086158
     D  P1RIBA                26     60                                                       086158
      * Receipt - Ordering bank No                                                            086158
     D**********                             61  690P1ROBN                             086158 CSD027
     D  P1ROBN                61     69                                                       CSD027
      * Receipt - Ordering customer no                                                        086158
     D**********                             70  780P1ROCN                             086158 CSD027
     D  P1ROCN                70     78                                                       CSD027
      * Branch                                                                                086158
     D  R1BRCH                79     81                                                       086158
      * Currency                                                                              086158
     D  R1CCY                 82     84                                                       086158
      *                                                                                       087000
      ** 087000 - include additional details to allow determination                           087000
      ** of prime retail account for settlement method 04.                                    087000
     D  R1CNUM                85     90                                                       087000
     D  R1ACCD                91    100                                                       CGL029
     D  P1RONS               101    118                                                       CGL029
     D**********                             91  94 R1ACCD                             087000 CGL029
      *                                                                                       234865
     D ##ADS           DS          5120                                                       234865
      *                                                                                       086158
      ** Parameters for call to CG4975.                                                       086158
      **                                                                                      086158
     D P5PARM          DS           256                                                       086158
      * Output Sequence                                                                       086158
     D  R1OSEQ                 1      9  0                                                    086158
      * UDC item number                                                                       086158
     D  R1ITEM                10     17  0                                                    086158
      * This bind level                                                                       086158
     D  R1TBIN                18     25  0                                                    086158
      * Previous bind level                                                                   086158
     D  R1PBIN                26     33  0                                                    086158
     D P7PARM          DS           256                                                       089776
      * Account Officer                                                                       089776
     D  P1ACOF                 1      2                                                       089776
      *                                                                                       232543
     D                 DS                                                                     232543
     D**********                              1   40P@ACCT                           232543 BUG11111
     D  P@ASEQ                 5      6  0                                                    232543
     D**********                              7  120P@CNUM                            232543 CSD027A
     D  P@CNUM                 7     12                                                      CSD027A
     D  P@STYP                13     14  0                                                    232543
     D  P@ACCT                15     24  0                                                  BUG11111
      *                                                                                       232543
     D WPARML          C                   CONST('LECalcBasis6LeapYear')                    MD035545
     D*COPY*CGCPYSRC,SRERRI                                                                 MD056543
      *
     D/COPY WNCPYSRC,CG4110I001
     D*COPY*ZSRSRC,ZINTDYZ1                                                          CDL006 MD056543
     D*COPY*ZSRSRC,ZDATE9Z2                                                          CDL006 MD056543
     D*COPY*ZSRSRC,ZDAT10Z1                                                          CDL006 MD056543
     D/COPY ZSRSRC,ZINTDYZ1LE                                                               MD056543
     D/COPY ZSRSRC,ZDATE9Z2LE                                                               MD056543
     D/COPY ZSRSRC,ZDAT10Z1LE                                                               MD056543
      *                                                                                       CSW208
      ** DS for AOSVALR0                                                                      CSW208
      *                                                                                       CSW208
     D SVAL1           DS           200                                                       CSW208
     D  SVAL11                 1      1                                                       CSW208
     I*COPY*ZSRSRC,ZPOWERZ1                                                          CDL006 MD056543
     I*COPY*ZSRSRC,ZDATE9Z1                                                          CDL006 MD056543
     I/COPY ZSRSRC,ZPOWERZ1IL                                                               MD056543
     I/COPY ZSRSRC,ZDATE9Z1LE                                                               MD056543
     IDEALSDBF      01
     IDEALSDCF      02
     IDEALSDDF      03
     IDEALSDEF      04
     I              SCUS                        CNUM
     IDEALSDGF      05
     IDEAMSDIF      06
     I              VDAT                        DAVDAT
     I              DTYP                        DADTYP
     I              DLST                        DADLST
     I              BRTT                        DABRTT
     I              RTSP                        DARTSP
     I              CCY                         DACCY
     I              CNUM                        DACNUM
     I              FCGC                        FCGCAM                                        CDL006
     I              FCGD                        FCGDAM                                        CDL006
     I              FCGA                        FCGAAM                                        CDL006
     I              FCGT                        FCGTAM                                        CDL006
     I              CNSP                        DACNSP                                        CRE073
     I              CNSG                        DACNSG                                        CRE073
     I              RDMT                        DARDMT                                        CRE073
     I              RDFD                        DARDFD                                        CRE073
     I              BRTE                        DABRTE                                     AR1012947
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C     *ENTRY        PLIST
     C                   PARM                    W0RTN             7
     C                   PARM                    W0CMT             3
     C                   PARM                    ##COPD            1
     C                   PARM                    ##AUTO            1
     C                   PARM                    ##INTA           13 0
     C                   PARM                    DSPARM
     C                   PARM                    FRAIRS            1                          CSW005
     C                   PARM                    NOOIS             1                         BUG5758
     C/COPY WNCPYSRC,CGH00024
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q                 5 0
     C                   MOVEL     'MAIN'        @STK(Q)
      *
      *................................................................
      *
      **  Initial processing - Once Only
     C     ##INIT        IFEQ      *BLANK
     C                   EXSR      SRINIT
     C                   MOVE      'Y'           ##INIT            1
     C                   ENDIF
      *
      **  Initialisation processing
     C                   EXSR      SRINZ
      *
      **  Main processing
     C                   EXSR      SRMAIN
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
      **  Terminate program
     C                   RETURN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRMAIN        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRMAIN'      @STK(Q)
      *
      *................................................................
      *                                                                                       CDL018
      ** Reset amendment type indicator                                                       CDL018
      ** Maturity confirmation                                                                CDL018
     C                   MOVE      *OFF          *IN07                                        CDL018
      ** Interest advice                                                                      CDL018
     C                   MOVE      *OFF          *IN08
      *
      ** Access Deal
      *
     C                   EXSR      SRDEAL
      *
      ** Access Deal Amendment
      ** (if deal amendment advice)
      *
     C     CNRQ          IFEQ      'C'
     C                   EXSR      SRDEAM
     C                   END
      *
      **  Generate reference number by writing to PF/CGUDCRPD
      **  If no confirmation to be produced, then bypass
      *
     C     *LIKE         DEFINE    DTYP          ##DTYP
     C                   MOVEL     DTYP          ##DTYP
     C                   MOVE      'N'           ##COPD
     C                   MOVEL     'N'           ##SPPS                                       087053
     C/COPY WNCPYSRC,CG4110C001
     C                   EXSR      SRAUTO                                                     087053
     C     ##SPPS        CABEQ     'Y'           EXMAIN                                       087053
      *                                                                                       243959
      ** Skip further processing if record is for IRS X-ccy Value Date/                       243959
      ** Maturity Date Exchange confirmation so as to avoid DBERR 954.                        243959
      *                                                                                       243959
     C     CNRQ          IFEQ      'T'                                                        243959
     C     CNRQ          OREQ      't'                                                        243959
     C     CNRQ          OREQ      'O'                                                        243959
     C     CNRQ          OREQ      'o'                                                        243959
     C                   GOTO      EXMAIN                                                     243959
     C                   ENDIF                                                                243959
      *                                                                                       243959
     C                   EXSR      SRGENR
     C/COPY WNCPYSRC,CG4110C002
     C     ##COPD        CABEQ     'N'           EXMAIN
     C/COPY WNCPYSRC,CG4110C008
      *
      ** Extract deal amendment advices
      ** (from PF/DAINDDL)
      *
     C     CNRQ          IFEQ      'C'
     C                   EXSR      SRXDEA
     C                   ELSE
      *
      ** Extract FRA/IRS rate fix, rate change, interest, settlement advices
      **   or buy-out confirmation (from PF/DLINDDM)                                          CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP2                                                               S01408
     C*                                                                                       S01408
      *
     C     CNRQ          IFEQ      'B'
     C     CNRQ          OREQ      'D'
     C     CNRQ          OREQ      'E'
     C     CNRQ          OREQ      'F'
     C     CNRQ          OREQ      'G'
     C     CNRQ          OREQ      'H'
     C     CNRQ          OREQ      'J'
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     CNRQ          ANDEQ     'K'                                                        CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP3                                                               S01408
     C*                                                                                       S01408
     C                   EXSR      SRXFIR
     C                   ELSE
      *
      ** Extract loan & deposit interest advices
      ** (from PF/DLINDDM)
      *
     C     CNRQ          IFEQ      'I'
     C                   EXSR      SRXLDI
     C                   ELSE
      *
      ** Extract FX option/loan/deposit maturity advices
      ** (from PF/DLINDDM)
      *
     C     CNRQ          IFEQ      'M'
     C                   MOVE      *ON           *IN07                                        CDL018
     C                   EXSR      SRXFLM
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C009
      *
      *................................................................
      *
     C     EXMAIN        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXDEA                                         *
      * Function    :  Extract deal amendment advices                 *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRXDEA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRXDEA'      @STK(Q)
      *
      *................................................................
      *
      ** EXTRACT - LOAN & DEPOSIT PRINCIPAL CHANGE ADVICES
      *
     C     AMTP          IFEQ      'PI'
     C     AMTP          OREQ      'PD'
     C     CDL006        IFEQ      'N'                                                        CDL006
     C     DTYP          ANDNE     'FL'                                                       CDL006
     C     DTYP          ANDNE     'DP'                                                       CDL006
     C     DTYP          ANDNE     'FT'                                                       CDL006
     C     DTYP          ANDNE     'DT'                                                       CDL006
     C     DTYP          ANDNE     'LT'                                                       CDL006
     C     CDL006        OREQ      'Y'                                                        CDL006
     C     DTYP          ANDEQ     'DT'                                                       CDL006
     C     CDL006        OREQ      'Y'                                                        CDL006
     C     DTYP          ANDEQ     'LT'                                                       CDL006
     C     CDL033        OREQ      'Y'                                                      BUG11112
     C     DTYP          ANDEQ     'CF'                                                     BUG11112
     C                   EXSR      D13LAD
     C                   ENDIF                                                                CDL006
     C                   ELSE
      *
      ** EXTRACT - LOAN & DEPOSIT RATE CHANGE ADVICES
      *
     C     AMTP          IFEQ      'SC'
     C     AMTP          OREQ      'BC'                                                    AR1012947
     C                   EXSR      D14LAD
     C                   ELSE
      *
      ** EXTRACT - LOAN & DEPOSIT INTEREST ADVICES
      *
     C     AMTP          IFEQ      'SI'
     C     AMTP          OREQ      'CI'
     C                   EXSR      D20LAD
     C                   ELSE
      *                                                                                       CDL017
      ** EXTRACT - Fixed Term L/D Early Maturity Advice                                       CDL017
      *                                                                                       CDL017
     C     AMTP          IFEQ      'EM'                                                       CDL017
     C                   EXSR      D25LAD                                                     CDL017
     C                   END                                                                  CDL017
      *                                                                                       CDL017
     C                   END
     C                   END
     C                   END
      *
      *................................................................
      *
     C     EXXDEA        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXFIR                                         *
      * Function    :  Extract FRA/IRS rate fix, rate change,         *
      *                interest, settlement advices                   *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRXFIR        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRXFIR'      @STK(Q)
      *
      *................................................................
      *
      ** EXTRACT - RATE CHANGE ADVICES
      *
     C     CNRQ          IFEQ      'B'                                          * rate change adv
      *
     C     DTYP          IFEQ      'RP'
     C     DTYP          OREQ      'RF'
     C     DTYP          OREQ      'RR'
     C                   EXSR      D15CFC                                       *Cap/Floor/Collar
     C                   END
      *
     C                   ELSE
      *
      ** EXTRACT - RATE FIX ADVICES
      *
     C     CNRQ          IFEQ      'D'                                          * our rate fixed
     C     CNRQ          OREQ      'F'                                          * thr rate fixed
     C     CNRQ          OREQ      'H'                                          * our/thr rte fxd
      *
     C     DTYP          IFEQ      'FR'
     C                   EXSR      D16FRA                                       * FRA
     C                   ELSE
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
     C                   EXSR      D17IRS                                       * IRS
     C                   ELSE
     C     DTYP          IFEQ      'RP'
     C     DTYP          OREQ      'RF'
     C     DTYP          OREQ      'RR'
     C                   EXSR      D18CFC                                       *Cap/Floor/Collar
     C                   END
     C                   END
     C                   END
      *                                                                                     BUG11112
     C     DTYP          IFEQ      'CF'                                                     BUG11112
     C     DTYP          OREQ      'TD'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'TI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IP'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IT'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'CI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     CNRQ          IFEQ      'D'                                                      BUG11112
     C     CDL033        ANDEQ     'Y'                                                      BUG11112
     C                   EXSR      D26LAD                                                   BUG11112
     C                   ENDIF                                                              BUG11112
     C                   ENDIF                                                              BUG11112
      *
     C                   ELSE
      *
      ** EXTRACT - SETTLEMENT/INTEREST ADVICES
      *
     C     CNRQ          IFEQ      'E'                                          * our pay
     C     CNRQ          OREQ      'G'                                          * thr pay
     C     CNRQ          OREQ      'J'                                          * pay/rec in dif
      *                                                                cys.
     C     DTYP          IFEQ      'FR'
     C                   EXSR      D19FRA                                       * FRA
     C                   ELSE
     C     DTYP          IFEQ      'RS'
     C     DTYP          OREQ      'RX'
     C                   EXSR      D21IRS                                       * IRS
     C                   ELSE
     C     DTYP          IFEQ      'RP'
     C     DTYP          OREQ      'RF'
     C     DTYP          OREQ      'RR'
     C                   EXSR      D22CFC                                       *Cap/Floor/Collar
     C                   END
     C                   END
     C                   END
      *
     C                   ELSE                                                                 CIR001
      *                                                                                       CIR001
      ** EXTRACT - BUY-OUT CONFIRMATION                                                       CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     CNRQ          ANDEQ     'K'                                          * buy-out con CIR001
      *                                                                                       CIR001
     C                   EXSR      D11IRS                                       * IRS         CIR001
      *                                                                                       CIR001
     C                   END                                                                  CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP4                                                               S01408
     C*                                                                                       S01408
     C                   END
     C                   END
     C                   END
      *
      *................................................................
      *
     C     EXXFIR        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXLDI                                         *
      * Function    :  Extract loan & deposit interest advices        *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRXLDI        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRXLDI'      @STK(Q)
      *
      *................................................................
      *
      ** EXTRACT - LOAN & DEPOSIT INTEREST ADVICES
      *
     C     DTYP          IFEQ      'IP'
     C     DTYP          OREQ      'TI'
     C     DTYP          OREQ      'CL'
     C     DTYP          OREQ      'LN'
     C     DTYP          OREQ      'DL'
     C     DTYP          OREQ      'IT'
     C     DTYP          OREQ      'TD'
     C     DTYP          OREQ      'CD'
     C     DTYP          OREQ      'CI'
     C     DTYP          OREQ      'FT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'CF'                                                     BUG11112
     C     CDL033        ANDEQ     'Y'                                                      BUG11112
     C                   EXSR      D20LAD
     C                   END
      *
      *................................................................
      *
     C     EXXLDI        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRXFLM                                         *
      * Function    :  Extract FX option/loan/deposit maturity advices*
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRXFLM        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRXFLM'      @STK(Q)
      *
      *................................................................
      *
      ** EXTRACT - LOAN & DEPOSIT MATURITY ADVICES
      *
     C     DTYP          IFEQ      'IP'
     C     DTYP          OREQ      'TI'
     C     DTYP          OREQ      'CL'
     C     DTYP          OREQ      'LN'
     C     DTYP          OREQ      'DL'
     C     DTYP          OREQ      'IT'
     C     DTYP          OREQ      'TD'
     C     DTYP          OREQ      'CD'
     C     DTYP          OREQ      'CI'
     C     DTYP          OREQ      'FT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     CDL006        ANDEQ     'Y'                                                        CDL006
     C     DTYP          OREQ      'CF'                                                     BUG11112
     C     CDL033        ANDEQ     'Y'                                                      BUG11112
     C                   EXSR      D23LAD
     C                   ELSE
      *
      ** EXTRACT - FX OPTION MATURITY ADVICES
      *
     C     DTYP          IFEQ      'OP'
     C                   EXSR      D24OMA
     C                   END
     C                   END
      *
      *................................................................
      *
     C     EXXFLM        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************                       CIR001
      * Subroutine  :  D11IRS                                         *                       CIR001
      * Function    :  Extract - IRS Deals                            *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D11IRS        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'd11IRS'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\d11IRS'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Store Path                                                                          CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     S#PATH        ##SPAT                                       CIR001
      *                                                                                       CIR001
      ** Branch Details                                                                       CIR001
     C                   EXSR      BRANCH                                                     CIR001
      *                                                                                       CIR001
      ** Broker Details                                                                       CIR001
     C                   EXSR      BROKER                                                     CIR001
      *                                                                                       CIR001
      ** Base Deal Details                                                                    CIR001
     C                   EXSR      D@BASE                                                     CIR001
      *                                                                                       CIR001
      ** Maturity Date                                                                        CIR001
     C                   EXSR      MATURD                                                     CIR001
      *                                                                                       CIR001
      ** Up-Front Fees                                                                        CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C                   EXSR      UPFEE                                                      CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Buy-Outs                                                                             CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C                   EXSR      BYOUT                                                      CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** IRS Our Details                                                                      CIR001
     C                   EXSR      D@IRSO                                                     CIR001
      *                                                                                       CIR001
      ** IRS Their Details                                                                    CIR001
     C                   EXSR      D@IRST                                                     CIR001
      *                                                                                       CIR001
      ** Our Name/Their Name                                                                  CIR001
     C                   EXSR      D@ONTN                                                     CIR001
      *                                                                                       CIR001
      ** Our Effective Interest Rate                                                          CIR001
     C                   EXSR      D@EIRO                                                     CIR001
      *                                                                                       CIR001
      ** Their Effective Interest Rate                                                        CIR001
     C                   EXSR      D@EIRT                                                     CIR001
      *                                                                                       CIR001
      ** Our Interest Payment Details                                                         CIR001
     C                   EXSR      D@IPYO                                                     CIR001
      *                                                                                       CIR001
      ** Their Interest Payment Details                                                       CIR001
     C                   EXSR      D@IPYT                                                     CIR001
      *                                                                                       CIR001
      ** Our Rate Change Details                                                              CIR001
     C     UBRTT         IFNE      *ZERO                                                      CIR001
     C                   EXSR      D@RCHO                                                     CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Rate Change Details                                                            CIR001
     C     TBRTT         IFNE      *ZERO                                                      CIR001
     C                   EXSR      D@RCHT                                                     CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Receive Settlement Ins                                                               CIR001
     C                   MOVEL     TCUCY         ##CCY                                        CIR001
     C                   MOVEL     RSETM         RSTM                           *Settlemt typ CIR001
     C                   MOVEL     URACC         RONS                           *Our nostro/  CIR001
     C                   MOVEL     CPPBK         RIBN                           *Their nostro CIR001
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      RSCY          ##RSCY            3                          CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS                                                     CIR001
      *                                                                                       CIR001
      ** Extended Settlement Receipts                                                         CIR001
     C                   EXSR      EX@REC                                                     CIR001
      *                                                                                       CIR001
      ** Payment Settlement Ins                                                               CIR001
     C                   MOVEL     UCUCY         ##CCY                                        CIR001
     C                   MOVEL     PSETM         PSTM                           *Settlemt typ CIR001
     C                   MOVEL     UPACC         PONS                           *Our nostro/  CIR001
     C                   MOVEL     *BLANK        RVNO                                         CIR001
     C                   MOVEL     CPRBK         AWBN                           *Their nostro CIR001
     C                   MOVEL     FACO          BENN                           *For account  CIR001
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##PSCY            3                          CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS                                                     CIR001
      *                                                                                       CIR001
      ** Extended Settlement Payments                                                         CIR001
     C                   EXSR      EX@PAY                                                     CIR001
      *                                                                                       CIR001
      ** Customer Details                                                                     CIR001
     C                   EXSR      CUST                                                       CIR001
      *                                                                                       CIR001
      ** Other Deal Details                                                                   CIR001
     C                   EXSR      D@OTH1                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP5                                                               S01408
     C*                                                                                       S01408
      *****************************************************************
      * Subroutine  :  D13LAD                                         *
      * Function    :  Loan & Deposit Principal Change Advices        *
      *                                                               *
      * Called by   :  SRXDEA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D13LAD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D13LAD'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d13LAD'     ##PNAM            7
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = deal amendment value date
      *
     C                   Z-ADD     DAVDAT        EVDAT
      *
      ** Determine the 'current' principal and interest for the deal
      ** as at the event date (deal amendment value date)
      *
     C                   EXSR      SRDCPI
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *                                                                                     AR995867
      ** Maturity Date                                                                      AR995867
      *                                                                                     AR995867
     C                   EXSR      MATURD                                                   AR995867
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Notice Days
     C                   EXSR      NOTICD
      *
      ** Deal Amendment - Principal Change Details
     C                   EXSR      D@DAPC
      *                                                                                       CDL006
      ** Fiduciary Details                                                                    CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     CDL006        IFEQ      'Y'                                                        CDL006
     C                   EXSR      FIDUC                                                      CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *
      ** Receive Settlement Ins required if:
      ** principal decrease of loan
      ** principal increase of deposit
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?
      *
     C     *IN99         IFEQ      '1'
     C     AMTP          ANDEQ     'PD'
     C     *IN99         OREQ      '0'
     C     AMTP          ANDEQ     'PI'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
     C                   END
      *
      ** Payment Settlement Ins required if:
      ** principal increase of loan
      ** principal decrease of deposit
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    *  loan?
      *
     C     *IN99         IFEQ      '1'
     C     AMTP          ANDEQ     'PI'
     C     *IN99         OREQ      '0'
     C     AMTP          ANDEQ     'PD'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
     C                   END
     C/COPY WNCPYSRC,CG4110C016
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
     C     IMET          IFEQ      '01'                                                       CER038
     C     IMET          OREQ      '08'                                                       CER038
     C     IMET          OREQ      '14'                                                       CER038
      *                                                                                       CER038
      ** Extract Alternative Interest settlements                                             CER038
      *                                                                                       CER038
     C                   EXSR      CGINPS                                                     CER038
      *                                                                                       CER038
     C                   ENDIF
     C                   ENDIF
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details (DEAM)
     C                   EXSR      D@OTH2
      *                                                                                       CDL094
      ** Retrieve Receive Details for CDL094                                                  CDL094
     C     CDL094        IFEQ      'Y'                                                        CDL094
     C                   MOVEL(P)  CCY           @NSKYB                                       CDL094
     C                   EXSR      RTVRCV                                                     CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CER049
      ** Stamp Tax Detail                                                                     CER049
      ** Only extract for Princ Increase and loan type of deals.                              CER049
      *                                                                                       CER049
     C     CER049        IFEQ      'Y'                                                        CER049
     C     AMTP          ANDEQ     'PI'                                                       CER049
      *                                                                                       CER049
     C     DTYP          IFEQ      'IP'                                                       CER049
     C     DTYP          OREQ      'TI'                                                       CER049
     C     DTYP          OREQ      'CL'                                                       CER049
     C     DTYP          OREQ      'DL'                                                       CER049
     C                   EXSR      LNSTAX                                                     CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C/COPY WNCPYSRC,CG4110C035
      *
      *................................................................
      *
     C     EX3LAD        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D14LAD                                         *
      * Function    :  Loan & Deposit Rate Change Advices             *
      *                                                               *
      * Called by   :  SRXDEA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D14LAD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D14LAD'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d14LAD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = deal amendment value date
      *
     C                   Z-ADD     DAVDAT        EVDAT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Notice Days
     C                   EXSR      NOTICD
      *
      ** Deal Amendment - Rate Change Details
     C                   EXSR      D@DARC
     C/COPY WNCPYSRC,CG4110C054
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
     C     IMET          IFEQ      '01'                                                       CER038
     C     IMET          OREQ      '08'                                                       CER038
     C     IMET          OREQ      '14'                                                       CER038
      *                                                                                       CER038
      ** Extract Alternative Interest settlements                                             CER038
      *                                                                                       CER038
     C                   EXSR      CGINPS                                                     CER038
      *                                                                                       CER038
     C                   ENDIF
     C                   ENDIF
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details (DEAM)
     C                   EXSR      D@OTH2
      *                                                                                     BUG11112
      **  Floating Rate CD Issued Details                                                   BUG11112
      *                                                                                     BUG11112
     C     DTYP          IFEQ      'CF'                                                     BUG11112
     C     DTYP          OREQ      'TD'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'TI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IT'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IP'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'CI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     CDL033        IFEQ      'Y'                                                      BUG11112
     C                   EXSR      SRFRCD                                                   BUG11112
     C                   ENDIF                                                              BUG11112
     C                   ENDIF                                                              BUG11112
     C/COPY WNCPYSRC,CG4110C059
      *
      *................................................................
      *
     C     EX4LAD        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C/COPY WNCPYSRC,CG4110C010
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D15CFC                                         *
      * Function    :  Cap/Floor/Collar Rate Change Advices           *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D15CFC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D15CFC'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d15CFC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = event date from DLINDDM = rate change date
      *
     C                   Z-ADD     EVDAT         EVDAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR CAP/FLOOR/COLLAR
      *
     C                   EXSR      SRDOOT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Rate Reset Details
     C                   EXSR      D@RRDT
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C017
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH            3                          CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF
      *................................................................
      *
     C     EX5CFC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D16FRA                                         *
      * Function    :  F.R.A. Rate Fix Advices                        *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D16FRA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D16FRA'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d16FRA'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event Date = next rate change date = value date
      *
     C                   Z-ADD     VDAT          EVDAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR FRA
      *
     C                   EXSR      SRDOOT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Rate Reset Details
     C                   EXSR      D@RRDT
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C018
      *                                                                                       CER038
      ** If FGE091 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF
      *................................................................
      *
     C     EX6FRA        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D17IRS                                         *
      * Function    :  I.R.S. Rate Fix Advices                        *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D17IRS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D17IRS'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d17IRS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event Date = our or their next rate change date
      **              or value date of deal if first rate fixing
      *
     C     CNRQ          IFEQ      'D'
     C                   Z-ADD     UNICD         EVDAT
     C                   ELSE
     C                   Z-ADD     TNICD         EVDAT
     C                   END
     C     EVDAT         IFEQ      *ZERO
     C     VDAT          ORGE      BJRDNB
     C                   Z-ADD     VDAT          EVDAT
     C                   END
      *                                                                                      BUG5758
      ** Check if confo needs to be generated for OIS transactions                           BUG5758
      *                                                                                      BUG5758
     C     UICFR         IFEQ      'O'                                                       BUG5758
     C     TICFR         OREQ      'O'                                                       BUG5758
     C                   MOVE      ' '           ULSETT            1                         BUG5758
     C     BJRDNB        IFNE      UNIPD                                                     BUG5758
     C     BJRDNB        ANDNE     TNIPD                                                     BUG5758
     C     BJRDNB        ANDNE     MDAT                                                      BUG5758
     C                   MOVE      'N'           ULSETT                                      BUG5758
     C                   ENDIF                                                               BUG5758
      *                                                                                      BUG5758
      ** Interest Rate Change Advice ('D') is not required if OUR                            BUG5758
      ** side of the deal is an OIS and neither side is settling.                            BUG5758
      *                                                                                      BUG5758
     C     UICFR         IFEQ      'O'                                                       BUG5758
     C     ULSETT        ANDEQ     'N'                                                       BUG5758
     C     CNRQ          ANDEQ     'D'                                                       BUG5758
     C                   MOVE      'Y'           NOOIS                                       BUG5758
     C                   ENDIF                                                               BUG5758
      *                                                                                      BUG5758
      ** Interest Rate Change Advice ('F') is not required if THEIR                          BUG5758
      ** side of the deal is an OIS and neither side is settling.                            BUG5758
      *                                                                                      BUG5758
     C     TICFR         IFEQ      'O'                                                       BUG5758
     C     ULSETT        ANDEQ     'N'                                                       BUG5758
     C     CNRQ          ANDEQ     'F'                                                       BUG5758
     C                   MOVE      'Y'           NOOIS                                       BUG5758
     C                   ENDIF                                                               BUG5758
     C                   ENDIF                                                               BUG5758
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Rate Reset Details
     C                   EXSR      D@RRDT
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C019
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *................................................................
      *
     C     EX7IRS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D18CFC                                         *
      * Function    :  Cap/Floor/Collar/Rate Fix Advices              *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D18CFC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D18CFC'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d18CFC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event Date = our or their next rate change date
      **              or value date of deal if first rate fixing
      *
     C     CNRQ          IFEQ      'D'
     C                   Z-ADD     UNICD         EVDAT
     C                   ELSE
     C                   Z-ADD     TNICD         EVDAT
     C                   END
     C     EVDAT         IFEQ      *ZERO
     C     VDAT          ORGE      BJRDNB
     C                   Z-ADD     VDAT          EVDAT
     C                   END
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR CAP/FLOOR/COLLAR
      *
     C                   EXSR      SRDOOT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Rate Reset Details
     C                   EXSR      D@RRDT
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C020
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *................................................................
      *
     C     EX8CFC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D19FRA                                         *
      * Function    :  F.R.A. Settlement Advices                      *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D19FRA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D19FRA'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d19FRA'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = value date of deal
      *
     C                   Z-ADD     VDAT          EVDAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR FRA
      *
     C                   EXSR      SRDOOT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Broker Details
     C                   EXSR      BROKER
      *
      ** Base Deal Details
     C                   EXSR      D@BASE
      *
      ** Maturity Date
     C                   EXSR      MATURD
      *
      ** FRA Deal Details
     C                   EXSR      D@FRA
      *
      ** FRA Settlement Details
     C                   EXSR      D@FRAS
      *
      ** Receive Settlement Ins
     C     CNRQ          IFEQ      'G'                                          * receipt
     C                   MOVEL     UCUCY         ##CCY
     C                   MOVEL     RSETM         RSTM                           *Settlemt type
     C                   MOVEL     URACC         RONS                           *Our nostro/ A/C
     C                   MOVEL     CPPBK         RIBN                           *Their nostro
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
     C                   END
      *
      ** Payment Settlement Ins
     C     CNRQ          IFEQ      'E'                                          * payment
     C                   MOVEL     UCUCY         ##CCY
     C                   MOVEL     PSETM         PSTM                           *Settlemt type
     C                   MOVEL     UPACC         PONS                           *Our nostro/ A/C
     C                   MOVEL     *BLANK        RVNO
     C                   MOVEL     CPRBK         AWBN                           *Their nostro
     C                   MOVEL     FACO          BENN                           *For account of
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
     C                   END
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Buyer's Name & Seller's Name
     C                   EXSR      D@BYSL
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C021
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *................................................................
      *
     C     EX9FRA        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D20LAD                                         *
      * Function    :  Loan & Deposit Interest Advices                *
      *                                                               *
      * Called by   :  SRXLDI                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D20LAD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D20LAD'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d20LAD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date =
      ** next interest payment date if deal originating advice
      ** deal amendment value date if deal amendment originating advice
      *
     C     CNRQ          IFEQ      'I'
     C                   Z-ADD     NIDT          EVDAT
      * If CDL096 is On and Amount Convention is 'A', update Event                            CDL096
      * Date to be the Interest Base Date (which contains the                                 CDL096
      * correct date that interest should be calculated up to)                                CDL096
     C     CDL096        IFEQ      'Y'                                                        CDL096
     C     IPFR          ANDNE     ' '                                                        CDL096
     C     AMTC          ANDEQ     'A '                                                       CDL096
     C                   Z-ADD     IBDT          EVDAT                                        CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                       CDL096
     C                   ELSE
     C                   Z-ADD     DAVDAT        EVDAT
     C                   END
      *
      ** Determine the 'current' principal and interest for the deal
      ** as at the event date (interest payment date)
      *
     C                   EXSR      SRDCPI
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      * If generating an interest advice, CDL096 is On and Amount                          CDL096I02
      * convention is 'A', move Interest Payment Date back to event                        CDL096I02
      * date as this is output as the Value Date of the Interest Payment                   CDL096I02
     C     CNRQ          IFEQ      'I'                                                     CDL096I02
     C     CDL096        ANDEQ     'Y'                                                     CDL096I02
     C     IPFR          ANDNE     ' '                                                     CDL096I02
     C     AMTC          ANDEQ     'A '                                                    CDL096I02
     C                   Z-ADD     NIDT          EVDAT                                     CDL096I02
     C                   ENDIF                                                             CDL096I02
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      * If generating an interest advice, CDL096 is On and Amount                          CDL096I02
      * convention is 'A', move Interest Base Date back to event                           CDL096I02
      * date as this is output as the End Date of the Interest Period                      CDL096I02
     C     CNRQ          IFEQ      'I'                                                     CDL096I02
     C     CDL096        ANDEQ     'Y'                                                     CDL096I02
     C     IPFR          ANDNE     ' '                                                     CDL096I02
     C     AMTC          ANDEQ     'A '                                                    CDL096I02
     C                   Z-ADD     IBDT          EVDAT                                     CDL096I02
     C                   ENDIF                                                             CDL096I02
      ** Loan & Deposit Settlement Details
     C                   EXSR      D@LADS
      *                                                                                       CER048
      ** Secondary Tax Detail                                                                 CER048
      *                                                                                       CER048
     C     CER048        IFEQ      'Y'                                                        CER048
     C     WSTAT         ANDNE     'E'                                                      BUG24860
     C     WSTAT         ANDNE     ' '                                                      MD057008
     C                   EXSR      CGSTAX                                                     CER054
      *                                                                                       CER054
      ** Third Tax Detail                                                                     CER054
      *                                                                                       CER054
     C     CER054        IFEQ      'Y'                                                        CER054
     C                   EXSR      CGTTAX                                                     CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER049
      ** Stamp Tax Detail                                                                     CER049
      ** Only extract for loan type of deals.                                                 CER049
      *                                                                                       CER049
     C     CER049        IFEQ      'Y'                                                        CER049
      *                                                                                       CER049
     C     DTYP          IFEQ      'IP'                                                       CER049
     C     DTYP          OREQ      'TI'                                                       CER049
     C     DTYP          OREQ      'CL'                                                       CER049
     C     DTYP          OREQ      'DL'                                                       CER049
     C                   EXSR      LNSTAX                                                     CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
      *                                                                                       CDL006
      ** Fiduciary Details                                                                    CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     CDL006        IFEQ      'Y'                                                        CDL006
     C                   EXSR      FIDUC                                                      CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                     BUG11112
      **  Floating Rate CD Issued Details                                                   BUG11112
      *                                                                                     BUG11112
     C     DTYP          IFEQ      'CF'                                                     BUG11112
     C     DTYP          OREQ      'TD'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'TI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IT'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'IP'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     DTYP          OREQ      'CI'                                                     BUG11112
     C     XKRCDT        ANDGT     0                                                        BUG11112
     C     CDL033        IFEQ      'Y'                                                      BUG11112
     C                   EXSR      SRFRCD                                                   BUG11112
     C                   ENDIF                                                              BUG11112
     C                   ENDIF                                                              BUG11112
      *
      ** Loan & Deposit Capitalization Details required if:
      ** deal originating advice and deal is capitalizing interest
      ** deal amendment originating advice and amendment type is 'CI'
     C     CNRQ          IFEQ      'I'
     C     INTC          ANDEQ     'Y'
     C     CNRQ          OREQ      'C'
     C     AMTP          ANDEQ     'CI'
     C                   EXSR      D@LADC
     C                   ELSE
      *
      ** Receive Settlement Ins required if interest due for loan
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?
     C     *IN99         IFEQ      '1'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
      *                                                                                       CDL018
      ** Multiple Settlement Account - RECEIPT                                                CDL018
     C     FSRMAC        IFEQ      'Y'                                                        CDL018
     C     CDL018        ANDEQ     'Y'                                                        CDL018
      *                                                                                       CDL018
     C     DLNO          CHAIN     DLFSACL0                           99                      CDL018
     C     *IN99         IFEQ      '1'                                                        CDL018
     C                   MOVEL     'DLFSACPD'    W0FILE                         **************CDL018
     C                   MOVEL     DLNO          W0KEY                          * DB ERROR 37 CDL018
     C                   Z-ADD     37            W0ERNB                         **************CDL018
     C                   MOVEL     'MEM5004'     W0MSGD                                       CDL018
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL018
     C                   EXSR      SRERR                                                      CDL018
     C                   END                                                                  CDL018
      *                                                                                       CDL018
     C                   EXSR      D@RMAC                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   END
      *
      ** Payment Settlement Ins required if interest due for deposit
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?
     C     *IN99         IFEQ      '0'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
      *                                                                                       CDL018
      ** Multiple Settlement Account - PAYMENT                                                CDL018
     C     FSPMAC        IFEQ      'Y'
     C     CDL018        ANDEQ     'Y'
      *                                                                                       CDL018
     C     DLNO          CHAIN     DLFSACL0                           99                      CDL018
     C     *IN99         IFEQ      '1'                                                        CDL018
     C                   MOVEL     'DLFSACPD'    W0FILE                         **************CDL018
     C                   MOVEL     DLNO          W0KEY                          * DB ERROR 38 CDL018
     C                   Z-ADD     38            W0ERNB                         **************CDL018
     C                   MOVEL     'MEM5004'     W0MSGD                                       CDL018
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL018
     C                   EXSR      SRERR                                                      CDL018
     C                   END                                                                  CDL018
      *                                                                                       CDL018
     C                   EXSR      D@PMAC                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   END                                                                  CDL018
     C                   END
      *
     C/COPY WNCPYSRC,CG4110C055
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
     C     IMET          IFEQ      '01'                                                       CER038
     C     IMET          OREQ      '08'                                                       CER038
     C     IMET          OREQ      '14'                                                       CER038
      *                                                                                       CER038
      ** Extract Alternative Interest settlements                                             CER038
      *                                                                                       CER038
     C                   EXSR      CGINPS                                                     CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
     C                   ENDIF                                                                CER038
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                      089776
      ** Counterparty Account Officer Details                                                089776
     C                   EXSR      ACOF                                                      089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *                                                                                       CDL094
      ** Retrieve Receive Details for CDL094                                                  CDL094
     C     CDL094        IFEQ      'Y'                                                        CDL094
     C                   MOVEL(P)  CCY           @NSKYB                                       CDL094
     C                   EXSR      RTVRCV                                                     CDL094
     C                   ENDIF                                                                CDL094
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCPG                                                               S01408
      *                                                                                      CER038A
      ** If CER038 is installed                                                              CER038A
      *                                                                                      CER038A
     C     CER038        IFEQ      'Y'                                                       CER038A
      *                                                                                      CER038A
      ** Open Correspondent file                                                             CER038A
      *                                                                                      CER038A
     C                   OPEN      CGCORRL4                                                  CER038A
      *                                                                                      CER038A
      ** Extract new Fields                                                                  CER038A
      *                                                                                      CER038A
     C                   MOVE      ORBR          WBRNCH                                      CER038A
     C                   EXSR      CGBRCH                                                    CER038A
      *                                                                                      CER038A
      ** Close Correspondent file                                                            CER038A
      *                                                                                      CER038A
     C                   CLOSE     CGCORRL4                                                  CER038A
      *                                                                                      CER038A
     C                   ENDIF                                                               CER038A
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110C037
     C*
      *
      *................................................................
      *
     C     EX0LAD        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D21IRS                                         *
      * Function    :  I.R.S. Interest Advices                        *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D21IRS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D21IRS'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d21IRS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = event date from DLINDDM = interest payment date
      *
     C                   Z-ADD     EVDAT         EVDAT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** IRS Our Settlement Details
     C     PIAMT         IFNE      *ZERO                                        * payment
     C                   EXSR      D@IRXO
     C                   END
      *
      ** IRS Their Settlement Details
     C     RIAMT         IFNE      *ZERO                                        * receipt
     C                   EXSR      D@IRXT
     C                   END
      *
      ** Payable by us/them/us and them
     C                   EXSR      D@PAY@
      *
      ** Receive Settlement Ins
     C     CNRQ          IFEQ      'G'                                          * receipt
     C     CNRQ          OREQ      'J'                                          * pay & rec (xcy)
     C                   MOVEL     TCUCY         ##CCY
     C                   MOVEL     RSETM         RSTM                           *Settlemt type
     C                   MOVEL     URACC         RONS                           *Our nostro/ A/C
     C                   MOVEL     CPPBK         RIBN                           *Their nostro
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      RSCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
     C                   END
      *
      ** Payment Settlement Ins
     C     CNRQ          IFEQ      'E'                                          * payment
     C     CNRQ          OREQ      'J'                                          * pay & rec (xcy)
     C                   MOVEL     UCUCY         ##CCY
     C                   MOVEL     PSETM         PSTM                           *Settlemt type
     C                   MOVEL     UPACC         PONS                           *Our nostro/ A/C
     C                   MOVEL     *BLANK        RVNO
     C                   MOVEL     CPRBK         AWBN                           *Their nostro
     C                   MOVEL     FACO          BENN                           *For account of
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
     C                   END
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C022
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *................................................................
      *
     C     EX1IRS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D22CFC                                         *
      * Function    :  Cap/Floor/Collar Interest Advices              *
      *                                                               *
      * Called by   :  SRXFIR                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D22CFC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D22CFC'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d22CFC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = event date from DLINDDM = interest payment date
      *
     C                   Z-ADD     EVDAT         EVDAT
      *
      ** DETERMINE OUR/THEIR INDICATOR FOR CAP/FLOOR/COLLAR
      *
     C                   EXSR      SRDOOT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Event Details
     C                   EXSR      D@BASM
      *
      ** Cap/Floor/Collar Details
     C                   EXSR      D@CFC
      *
      ** Cap/Floor/Collar Settlement Details
     C                   EXSR      D@CFCS
      *
      ** Receive Settlement Ins
     C     CNRQ          IFEQ      'G'                                          * receipt
     C                   MOVEL     TCUCY         ##CCY
     C                   MOVEL     RSETM         RSTM                           *Settlemt type
     C                   MOVEL     URACC         RONS                           *Our nostro/ A/C
     C                   MOVEL     CPPBK         RIBN                           *Their nostro
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      RSCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
     C                   END
      *
      ** Payment Settlement Ins
     C     CNRQ          IFEQ      'E'                                          * payment
     C                   MOVEL     UCUCY         ##CCY
     C                   MOVEL     PSETM         PSTM                           *Settlemt type
     C                   MOVEL     UPACC         PONS                           *Our nostro/ A/C
     C                   MOVEL     *BLANK        RVNO
     C                   MOVEL     CPRBK         AWBN                           *Their nostro
     C                   MOVEL     FACO          BENN                           *For account of
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
     C                   END
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *
     C/COPY WNCPYSRC,CG4110C023
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *................................................................
      *
     C     EX2CFC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D23LAD                                         *
      * Function    :  Loan & Deposit Maturity Advices                *
      *                                                               *
      * Called by   :  SRXFLM                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D23LAD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D23LAD'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d23LAD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = maturity date
      *
     C                   Z-ADD     MDAT          EVDAT
      *
      ** Determine the 'current' principal and interest for the deal
      ** as at the event date (maturity date)
      *
     C                   EXSR      SRDCPI
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Details
     C                   EXSR      D@BASE
      *
      ** Maturity Date
     C                   EXSR      MATURD
      *
      ** Loan & Deposit Details
     C                   EXSR      D@LAD
     C                   EXSR      D@LADE                                                   AR745799
      *                                                                                       CER050
     C     CER050        IFEQ      'Y'                                                        CER050
     C                   EXSR      D@APR                                                      CER050
     C                   ENDIF                                                                CER050
      *                                                                                       CER048
      ** Secondary Tax Detail                                                                 CER048
      *                                                                                       CER048
     C     CER048        IFEQ      'Y'                                                        CER048
     C     WSTAT         ANDNE     'E'                                                      BUG24860
     C     WSTAT         ANDNE     ' '                                                      MD057008
     C                   EXSR      CGSTAX                                                     CER048
      *                                                                                       CER054
      ** Third Tax Detail                                                                     CER054
      *                                                                                       CER054
     C     CER054        IFEQ      'Y'                                                        CER054
     C                   EXSR      CGTTAX                                                     CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER048
      ** Stamp Tax Detail                                                                     CER049
      ** Only extract for loan type of deals.                                                 CER049
      *                                                                                       CER049
     C     CER049        IFEQ      'Y'                                                        CER049
      *                                                                                       CER049
     C     DTYP          IFEQ      'IP'                                                       CER049
     C     DTYP          OREQ      'TI'                                                       CER049
     C     DTYP          OREQ      'CL'                                                       CER049
     C     DTYP          OREQ      'DL'                                                       CER049
     C                   EXSR      LNSTAX                                                     CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C**********           EXSR D@LADE                                               151837 AR745799
      *                                                                                       CDL006
      ** Fiduciary Details                                                                    CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     CDL006        IFEQ      'Y'                                                        CDL006
     C                   EXSR      FIDUC                                                      CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                     BUG11112
      **  Floating Rate CD Issued Details                                                   BUG11112
      *                                                                                     BUG11112
     C     DTYP          IFEQ      'CF'                                                     BUG11112
     C     DTYP          OREQ      'TD'                                                     BUG11112
     C     DTYP          OREQ      'TI'                                                     BUG11112
     C     DTYP          OREQ      'IT'                                                     BUG11112
     C     DTYP          OREQ      'IP'                                                     BUG11112
     C     DTYP          OREQ      'CI'                                                     BUG11112
     C     CDL033        IFEQ      'Y'                                                      BUG11112
     C                   EXSR      SRFRCD                                                   BUG11112
     C                   ENDIF                                                              BUG11112
     C                   ENDIF                                                              BUG11112
      *
      ** Rollover Details
     C     RBDN          IFNE      0
     C                   EXSR      D@ROLL
     C                   END
      *
      ** Receive Settlement Ins required if maturity of loan
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?
     C     *IN99         IFEQ      '1'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
      *                                                                                       CDL018
      ** Multiple Settlement Account - RECEIPT                                                CDL018
     C     FSRMAC        IFEQ      'Y'                                                        CDL018
     C     CDL018        ANDEQ     'Y'                                                        CDL018
      *                                                                                       CDL018
     C     DLNO          CHAIN     DLFSACL0                           99                      CDL018
     C     *IN99         IFEQ      '1'                                                        CDL018
     C                   MOVEL     'DLFSACPD'    W0FILE                         **************CDL018
     C                   MOVEL     DLNO          W0KEY                          * DB ERROR 39 CDL018
     C                   Z-ADD     39            W0ERNB                         **************CDL018
     C                   MOVEL     'MEM5004'     W0MSGD                                       CDL018
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL018
     C                   EXSR      SRERR                                                      CDL018
     C                   END                                                                  CDL018
      *                                                                                       CDL018
     C                   EXSR      D@RMAC                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   END
      *
      ** Payment Settlement Ins required if maturity of deposit
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?
     C     *IN99         IFEQ      '0'
     C                   MOVEL     CCY           ##CCY
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      STCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
      *                                                                                       CDL018
      ** Multiple Settlement Account - PAYMENT                                                CDL018
     C     FSPMAC        IFEQ      'Y'                                                        CDL018
     C     CDL018        ANDEQ     'Y'                                                        CDL018
      *                                                                                       CDL018
     C     DLNO          CHAIN     DLFSACL0                           99                      CDL018
     C     *IN99         IFEQ      '1'                                                        CDL018
     C                   MOVEL     'DLFSACPD'    W0FILE                         **************CDL018
     C                   MOVEL     DLNO          W0KEY                          * DB ERROR 40 CDL018
     C                   Z-ADD     40            W0ERNB                         **************CDL018
     C                   MOVEL     'MEM5004'     W0MSGD                                       CDL018
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL018
     C                   EXSR      SRERR                                                      CDL018
     C                   END                                                                  CDL018
      *                                                                                       CDL018
     C                   EXSR      D@PMAC                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   END
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** First & Last/Up Front Interest
     C                   EXSR      D@FLUF
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
      *                                                                                       CDL094
      ** Retrieve Receive Details for CDL094                                                  CDL094
     C     CDL094        IFEQ      'Y'                                                        CDL094
     C                   MOVEL(P)  CCY           @NSKYB                                       CDL094
     C                   EXSR      RTVRCV                                                     CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CSW208
      ** Fee Details                                                                          CSW208
     C     CSW208        IFEQ      'Y'                                                        CSW208
     C     DLSWCF        ANDEQ     'Y'                                                        CSW208
     C                   MOVEL     'Y'           WFEEH             1                          CSW208
     C                   MOVEL     'N'           WFFLG             1                          CSW208
     C                   MOVEL     'N'           WRPT              1                          CSW208
     C                   Z-ADD     *ZEROS        WFPEND            5 0                        CSW208
     C                   EXSR      SRFEE                                                      CSW208
     C     WFFLG         IFEQ      'Y'                                                        CSW208
     C                   EXSR      DL@FEE                                                     CSW208
     C                   ENDIF                                                                CSW208
     C                   ENDIF                                                                CSW208
      *
     C/COPY WNCPYSRC,CG4110C024
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
     C     IMET          IFEQ      '01'                                                       CER038
     C     IMET          OREQ      '08'                                                       CER038
     C     IMET          OREQ      '14'                                                       CER038
      *                                                                                       CER038
      ** Extract Alternative Interest settlements                                             CER038
      *                                                                                       CER038
     C                   EXSR      CGINPS                                                     CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
     C                   ENDIF
      *................................................................
      *
     C     EX3LA1        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D24OMA                                         *
      * Function    :  Option Maturity Advices                        *
      *                                                               *
      * Called by   :  SRXFLM                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     D24OMA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D24OMA'      @STK(Q)
      *
      *................................................................
      *
      **  Set up Path.
     C                   MOVEL     '\d24OMA'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Store Path
     C     1             OCCUR     ##SRDT
     C                   MOVEL     S#PATH        ##SPAT
      *
      ** Event date = option to date
      *
     C                   Z-ADD     OTDT          EVDAT
      *
      ** Branch Details
     C                   EXSR      BRANCH
      *
      ** Base Deal Details
     C                   EXSR      D@BASE
      *
      ** Option To Date
     C                   EXSR      D@OPTD
      *
      ** FX Deal Details
     C                   EXSR      D@FRX
      *
      ** Receive Settlement Ins
     C                   MOVEL     PUCY          ##CCY
      *                                                                                       CEU003
      ** Set the Receipt Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      RSCY          ##RSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@RECS
      *                                                                                       086158
      ** Extended Settlement Receipts                                                         086158
     C                   EXSR      EX@REC                                                     086158
      *
      ** Payment Settlement Ins
     C                   MOVEL     SLCY          ##CCY
      *                                                                                       CEU003
      ** Set the Payment Settlement Currency                                                  CEU003
      *                                                                                       CEU003
     C                   MOVE      PSCY          ##PSCY                                       CEU003
      *                                                                                       CEU003
     C                   EXSR      D@PAYS
      *                                                                                       086158
      ** Extended Settlement Payments                                                         086158
     C                   EXSR      EX@PAY                                                     086158
      *
      ** Customer Details
     C                   EXSR      CUST
      *                                                                                       089776
      ** Counterparty Account Officer Details                                                 089776
     C                   EXSR      ACOF                                                       089776
      *
      ** Other Deal Details
     C                   EXSR      D@OTH1
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCPG                                                               S01408
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     CER038        IFEQ      'Y'                                                        CER038
      *                                                                                       CER038
      ** Open Correspondent file                                                              CER038
      *                                                                                       CER038
     C                   OPEN      CGCORRL4                                                   CER038
      *                                                                                       CER038
      ** Extract new Fields                                                                   CER038
      *                                                                                       CER038
     C                   MOVE      ORBR          WBRNCH                                       CER038
     C                   EXSR      CGBRCH                                                     CER038
      *                                                                                       CER038
      ** Extract new Fields from deals extension file                                         CER038
      *                                                                                       CER038
     C                   EXSR      CGDLAD                                                     CER038
      *                                                                                       CER038
      ** Close Correspondent file                                                             CER038
      *                                                                                       CER038
     C                   CLOSE     CGCORRL4                                                   CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110C038
     C*
      *
      *................................................................
      *
     C     EX4OMA        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                      CG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C*                                                                                       CDL017
      *****************************************************************                       CDL017
      * Subroutine  :  D25LAD                                         *                       CDL017
      * Function    :  Fixed Term L/D Early Maturity Deal Amendment   *                       CDL017
      *                Confirmation.                                  *                       CDL017
      * Called by   :  SRXDEA                                         *                       CDL017
      * Calls       :                                                 *                       CDL017
      *****************************************************************                       CDL017
     C     D25LAD        BEGSR                                                                CDL017
      *                                                                                       CDL017
      **  Set up subroutine stack name                                                        CDL017
     C                   ADD       1             Q                                            CDL017
     C                   MOVEL     'D25LAD'      @STK(Q)                                      CDL017
      *                                                                                       CDL017
      *................................................................                       CDL017
      *                                                                                       CDL017
      **  Set up Path.                                                                        CDL017
     C                   MOVEL     '\d25LAD'     ##PNAM            7                          CDL017
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL017
     C                   EXSR      PSHGRS                                                     CDL017
      *                                                                                       CDL017
      **  Store Path                                                                          CDL017
     C     1             OCCUR     ##SRDT                                                     CDL017
     C                   MOVEL     S#PATH        ##SPAT                                       CDL017
      *                                                                                       CDL017
      ** Event date = deal amendment value date                                               CDL017
      *                                                                                       CDL017
     C                   Z-ADD     DAVDAT        EVDAT                                        CDL017
      *                                                                                       CDL017
      ** Determine the 'current' principal and interest for the deal                          CDL017
      ** as at the event date (deal amendment value date)                                     CDL017
      *                                                                                       CDL017
     C                   EXSR      SRDCPI                                                     CDL017
      *                                                                                       CDL017
      ** Loan/Deposit deal details (includes actual principal and                             CDL017
      ** interest calculated from SRDCPI above).                                              CDL017
     C                   EXSR      D@LAD                                                      CDL017
      *                                                                                       CDL017
      ** Branch Details                                                                       CDL017
     C                   EXSR      BRANCH                                                     CDL017
      *                                                                                       CDL017
      ** Base Deal Event Details                                                              CDL017
     C                   EXSR      D@BASM                                                     CDL017
      *                                                                                       CDL017
      ** Early Maturity details                                                               CDL017
     C                   EXSR      EM@DAT                                                     CDL017
      *                                                                                       CDL017
      ** Receive Settlement Ins required if maturity of loan                                  CDL017
     C                   Z-ADD     1             #1                                           CDL017
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?       CDL017
     C     *IN99         IFEQ      '1'                                                        CDL017
     C                   MOVEL     CCY           ##CCY                                        CDL017
      *                                                                                       CDL017
      ** Set the Receipt Settlement Currency                                                  CDL017
      *                                                                                       CDL017
     C                   MOVE      STCY          ##RSCY                                       CDL017
      *                                                                                       CDL017
     C                   EXSR      D@RECS                                                     CDL017
      *                                                                                       CDL017
      ** Extended Settlement Receipts                                                         CDL017
     C                   EXSR      EX@REC                                                     CDL017
     C                   END                                                                  CDL017
      *                                                                                       CDL017
      ** Payment Settlement Ins required if maturity of deposit                               CDL017
     C                   Z-ADD     1             #1                                           CDL017
     C     ##DTYP        LOOKUP    #LN(#1)                                99    * loan?       CDL017
     C     *IN99         IFEQ      '0'                                                        CDL017
     C                   MOVEL     CCY           ##CCY                                        CDL017
      *                                                                                       CDL017
      ** Set the Payment Settlement Currency                                                  CDL017
      *                                                                                       CDL017
     C                   MOVE      STCY          ##PSCY                                       CDL017
      *                                                                                       CDL017
     C                   EXSR      D@PAYS                                                     CDL017
      *                                                                                       CDL017
      ** Extended Settlement Payments                                                         CDL017
     C                   EXSR      EX@PAY                                                     CDL017
     C                   END                                                                  CDL017
      *                                                                                       CDL017
      ** Customer Details                                                                     CDL017
     C                   EXSR      CUST                                                       CDL017
      *                                                                                       CDL017
      ** Counterparty Account Officer Details                                                 CDL017
     C                   EXSR      ACOF                                                       CDL017
      *                                                                                       CDL017
      ** Other Deal Details (DEAM)                                                            CDL017
     C                   EXSR      D@OTH2                                                     CDL017
      *                                                                                       CDL094
      ** Retrieve Receive Details for CDL094                                                  CDL094
     C     CDL094        IFEQ      'Y'                                                        CDL094
     C                   MOVEL(P)  CCY           @NSKYB                                       CDL094
     C                   EXSR      RTVRCV                                                     CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CDL017
      *................................................................                       CDL017
      *                                                                                       CDL017
     C     EX5LAD        TAG                                                                  CDL017
      *                                                                                       CDL017
      **  Unwind subroutine stack name                                                        CDL017
     C                   EXSR      POPGRS                                                     CDL017
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL017
     C                   SUB       1             Q                                            CDL017
      *                                                                                       CDL017
     C                   ENDSR                                                                CDL017
     C*****************************************************************                       CDL017
     C/SPACE 5                                                                                CDL017
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP1                                                               S01408
     C/COPY CGCPYSRC,CGBRCH                                                                   CER038
     C/COPY CGCPYSRC,CGDLAD                                                                   CER038
     C/COPY CGCPYSRC,CGINPS                                                                   CER038
     C*                                                                                       S01408
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     BRANCH        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'BRANCH'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\BRANCH'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Get Branch Details
      *
     C     BRCA          IFNE      ##BRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                   CALL      'AOBRCHR1'                                                 CGL029
     C                   PARM      '*MSG    '    ##RTCD
     C                   PARM      '*KEY    '    ##OPTN
     C                   PARM      BRCA          ##BRCD            3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C     SDBRCH        PARM      SDBRCH        DSSDY                                        CGL029
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDBRCHPD'    W0FILE
     C                   MOVEL     BRCA          W0KEY                          ***************
     C                   Z-ADD     1             W0ERNB                         * DB ERROR 01 *
     C                   MOVEL     'MEM5004'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      ** Get Customer Details for Branch Internal Customer
      *
     C                   CALL      'AOCUSTR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM      A8BICN        ##KEY1           10            From AOBRCHR0
     C                   PARM      *BLANKS       ##KYST            7
     C     SDCUST        PARM      SDCUST        DSSDY
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDCUSTPD'    W0FILE
     C                   MOVEL     A8BICN        W0KEY                          ***************
     C                   Z-ADD     2             W0ERNB                         * DB ERROR 02 *
     C                   MOVEL     'MEM5004'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      ** Store Booking Branch, Branch Internal Customer Number and Name
      *
     C     *LIKE         DEFINE    BRCA          BBBRCA
     C                   MOVEL     BRCA          BBBRCA
     C     *LIKE         DEFINE    BBCUST        BBBICN
     C                   MOVEL     BBCUST        BBBICN
     C     *LIKE         DEFINE    BBCRNM        BICRNM
     C                   MOVEL     BBCRNM        BICRNM
      *
      ** Store : Sender's (i.e. Branch)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      ** (All used in message routing)
      *
     C                   MOVEL     A8BTID        ##SCSD
     C                   MOVEL     BBSTAD        ##SSTD
     C                   MOVEL     BBTXA1        ##STXA
     C/COPY WNCPYSRC,CG4110C039
     C                   END
      *
      ** Branch
     C                   MOVEL     A8BRCD        ##D(1)
      *
      ** Branch Name
     C                   MOVEL     A8BRNM        ##D(2)
     C/COPY WNCPYSRC,CG4110C040
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXBRCH        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BROKER                                         *
      * Function    :  Broker details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     BROKER        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'BROKER'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\BROKER'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Get Broker Details
      *
     C     BRKC          IFNE      ##BROK
      *
     C     BRKC          IFNE      'TELX'
     C     BRKC          ANDNE     'PHON'
     C     BRKC          ANDNE     'MAIL'
     C     BRKC          ANDNE     'SWAP'
     C                   CALL      'AOBROKR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM      BRKC          ##BROK            4
     C     SDBROK        PARM      SDBROK        DSFDY
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDBROKPD'    W0FILE                         ***************
     C                   MOVEL     BRKC          W0KEY                          * DB ERROR 03 *
     C                   Z-ADD     3             W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C                   ELSE
      *                                                                                      BUG7628
     C                   MOVE      BRKC          ##BROK                                      BUG7628
      *                                                                                      BUG7628
     C                   MOVEL     BRKC          A9BROK
     C                   MOVEL     *BLANK        A9BKNM
     C                   MOVEL     *BLANK        A9BRTN
     C                   END
     C                   END
      *
      ** Broker
     C                   MOVEL     A9BROK        ##D(1)
      *
      ** Broker Name
     C                   SELECT                                                               086797
     C     A9BROK        WHENEQ    'TELX'                                                     086797
     C                   MOVEL     'Telex'       ##D(2)                                       086797
     C     A9BROK        WHENEQ    'PHON'                                                     086797
     C                   MOVEL     W#PHON        ##D(2)                                       086797
     C     A9BROK        WHENEQ    'MAIL'                                                     086797
     C                   MOVEL     'Mail'        ##D(2)                                       086797
     C                   OTHER                                                                086797
     C                   MOVEL     A9BKNM        ##D(2)
     C                   ENDSL                                                                086797
      *
      ** Broker Town
     C                   MOVEL     A9BRTN        ##D(3)
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXBROK        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CUST                                           *
      * Function    :  Customer Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     CUST          BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'CUST  '      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\CUST  '     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Get Customer Details
      *
     C                   MOVEL     CNUM          ##KEY1
     C                   CALL      'AOCUSTR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM                    ##KEY1
     C                   PARM      *BLANKS       ##KYST
     C     SDCUST        PARM      SDCUST        DSSDY
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDCUSTPD'    W0FILE                         ***************
     C                   MOVEL     CNUM          W0KEY                          * DB ERROR 04 *
     C                   Z-ADD     4             W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *                                                                                       081961
      ** Store Customer Name                                                                  081961
      *                                                                                       081961
     C     *LIKE         DEFINE    BBCRNM        CPCRNM                                       081961
     C                   MOVEL     BBCRNM        CPCRNM                                       081961
      ***********                                                                             081961
      ***Store*Customer Number and Name                                                       081961
      ***********                                                                             081961
     C************LIKE     DEFN BBCUST    CPCUST                                              081961
     C***********          MOVELBBCUST    CPCUST                                              081961
     C************LIKE     DEFN BBCRNM    CPCRNM                                              081961
     C***********          MOVELBBCRNM    CPCRNM                                              081961
      *
      ** Store : Destination Customer's (i.e. Counterparty)
      **             SWIFT TID Address,
      **             STTX Address
      **             Telex Address
      **             Default Network for MTnnn messages
      ** (All used in message routing)
      *
     C                   MOVEL     BBCSID        ##DCSD
     C                   MOVEL     BBSTAD        ##DSTD
     C                   MOVEL     BBTXA1        ##DTXA
     C                   MOVEL     BBDNW3        ##DDNW                         *MT300 messages
      *
      ** Determine Message Routing
      *
     C                   CALL      'CG99DTMR'                           99      *
     C                   PARM                    ##SCSD           12            *Send. SWIFT Add
     C                   PARM                    ##SSTD           12            *Send. STTX  Add
     C                   PARM                    ##STXA           10            *Send. Telex Add
     C                   PARM                    ##DCSD           12            *Dest. SWIFT Add
     C                   PARM                    ##DSTD           12            *Dest. STTX  Add
     C                   PARM                    ##DTXA           10            *Dest. Telex Add
     C                   PARM                    ##DDNW            6            *Dest. Deflt Netw
     C                   PARM      BGMSDL        ##MSDL            1            *Midas/SWIFT D/Lk
     C                   PARM      BGMTMI        ##MTMI            1            *Midas/Telex Link
     C                   PARM      BLSWPY        ##SWPY            1 0          *SWIFT conf prty
     C                   PARM      BLTXPY        ##TXPY            1 0          *TELEX conf prty
     C                   PARM      *BLANK        ##NETW            6            *Network
     C                   PARM      *BLANK        ##RTCD            7
      *
     C     *IN99         IFEQ      '1'
     C     ##RTCD        ORNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'CG99DTMR'    W0FILE                         ***************
     C                   MOVEL     ##RTCD        W0KEY                          * DB ERROR 05 *
     C                   Z-ADD     5             W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      ** Customer
     C                   MOVEL     BBCUST        ##D(1)
      *
      ** Customer Name
     C                   MOVEL     BBCRNM        ##D(2)
      *
      ** Customer Address Line 1
     C                   MOVEL     BBCNA1        ##D(3)
      *
      ** Customer Address Line 2
     C                   MOVEL     BBCNA2        ##D(4)
      *
      ** Customer Address Line 3
     C                   MOVEL     BBCNA3        ##D(5)
      *
      ** Customer Address Line 4
     C                   MOVEL     BBCNA4        ##D(6)
      *                                                                                       086918
      ** Customer Town                                                                        086918
     C                   MOVEL     BBCRTN        ##D(7)                                       086918
      *                                                                                       095473
      ** /Copy for bank indicator extract                                                     095473
     C/COPY WNCPYSRC,CG4110CUST                                                               095473
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXCUST        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5                                                                                089776
      *****************************************************************                       089776
      * Subroutine  :  ACOF                                           *                       089776
      * Function    :  Account Officer Details                        *                       089776
      *                                                               *                       089776
      * Called by   :                                                 *                       089776
      * Calls       :                                                 *                       089776
      *****************************************************************                       089776
     C     ACOF          BEGSR                                                                089776
      *                                                                                       089776
      **  Set up subroutine stack name                                                        089776
     C                   ADD       1             Q                                            089776
     C                   MOVEL     'ACOF  '      @STK(Q)                                      089776
      *                                                                                       089776
      *................................................................                       089776
      *                                                                                       089776
      **  Retrieve subroutine specific data.                                                  089776
     C     1             OCCUR     ##SRDT                                                     089776
     C                   MOVEL     ##SPAT        S#PATH                                       089776
      *                                                                                       089776
      **  Set up data.                                                                        089776
     C                   CLEAR                   P7PARM                                       089776
     C                   MOVEL     BBACOC        P1ACOF                                       089776
      *                                                                                       089776
     C                   CLEAR                   P4PARM                                       089776
     C                   MOVEL     S#PATH        P4PARM                                       089776
      *                                                                                       089776
     C                   CLEAR                   P5PARM                                       089776
     C                   Z-ADD     ##OSEQ        R1OSEQ                                       089776
     C                   Z-ADD     ##ITEM        R1ITEM                                       089776
     C                   Z-ADD     DETBIN        R1TBIN                                       089776
     C                   Z-ADD     DEPBIN        R1PBIN                                       089776
      *                                                                                       089776
     C                   CALL      'CG4976'                                                   089776
     C                   PARM      *BLANKS       W0RTN             7                          089776
     C                   PARM                    P7PARM                                       089776
     C                   PARM                    P4PARM          140            Path          089776
     C                   PARM                    W0CMT             3                          089776
     C                   PARM                    P5PARM                                       089776
     C                   PARM                    ##REFR                         Reference Nam CCG015
     C                   PARM                    P@ICR                          Increment No  CCG015
     C                   PARM      'N'           ##MAST                         Call Master P CCG015
      *                                                                                       089776
      **  Reset Sequence number.                                                              089776
     C                   Z-ADD     R1OSEQ        ##OSEQ                                       089776
     C                   Z-ADD     R1TBIN        DETBIN                                       089776
     C                   Z-ADD     R1PBIN        DEPBIN                                       089776
      *                                                                                       089776
      *                                                                                       089776
      *                                                                                       089776
      *................................................................                       089776
      *                                                                                       089776
     C     EXACOF        TAG                                                                  089776
      *                                                                                       089776
      **  Unwind subroutine stack name                                                        089776
     C                   MOVEA     *BLANKS       @STK(Q)                                      089776
     C                   SUB       1             Q                                            089776
      *                                                                                       089776
     C                   ENDSR                                                                089776
     C*****************************************************************                       089776
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BASE                                         *
      * Function    :  Base deal details                              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@BASE        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_BASE'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_BASE'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Deal Number
     C                   MOVEL     DLNO          ##D(1)
      *
      ** Deal Date
     C                   MOVEL     DDAT          ##D(2)
      *
      ** Value Date
     C                   MOVEL     VDAT          ##D(3)
     C/COPY WNCPYSRC,CG4110C036
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXBASE        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BASM                                         *
      * Function    :  Base Deal Event Details                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@BASM        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_BASM'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_BASM'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Deal Number
     C                   MOVEL     DLNO          ##D(1)
      *
      ** Deal Date
     C**********           MOVELBJRDNB    ##D,2                                             AR995867
     C                   MOVEL     DDAT          ##D(2)                                     AR995867
      *
      ** Event Date
     C                   MOVEL     EVDAT         ##D(3)
     C/COPY WNCPYSRC,CG4110C057
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXBASM        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@BYSL                                         *
      * Function    :  Buyer's Name & Seller's Name                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@BYSL        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_BYSL'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_BYSL'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Buyer's Name & Seller's Name
      *
     C     BYSL          IFEQ      'B'
     C                   MOVEL     BICRNM        ##D(1)
     C                   MOVEL     CPCRNM        ##D(2)
     C                   ELSE
     C                   MOVEL     CPCRNM        ##D(1)
     C                   MOVEL     BICRNM        ##D(2)
     C                   END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXBYSL        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@CFC                                          *
      * Function    :  Cap/Floor/Collar details                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@CFC         BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_CFC '      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_CFC '     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Currency
     C                   MOVEL     UCUCY         ##D(1)
      *
      ** Principal
     C                   MOVEL     UPAMT         ##D(2)
     C                   MOVEL     UCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C066
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** Floor Rate
     C     FLRAT         IFNE      *ZERO
     C                   MOVEL     FLRAT         ##D(3)
     C                   END
      *
      ** Ceiling Rate
     C     CLRAT         IFNE      *ZERO
     C     CLRAT         ANDLT     9999.99999
     C                   MOVEL     CLRAT         ##D(4)
     C                   END
      *
      ** Base Rate Type
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     UCUCY         ##CYCD
     C                   MOVEL     UBRTT         ##BSRC
     C                   ELSE
     C                   MOVEL     TCUCY         ##CYCD
     C                   MOVEL     TBRTT         ##BSRC
     C                   END
      *
     C                   MOVEL     ##BSRC        ##D(5)
      *
      ** Base Rate Name
     C                   CALL      'AOBSRTR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM                    ##CYCD            3
     C                   PARM                    ##BSRC            2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                               CSD006
     C     SDBSRT        PARM      SDBSRT        DSSDY                                        CSD006
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDBSRTPD'    W0FILE                         ***************
     C                   MOVEL     ##BSRC        W0KEY                          * DB ERROR 06 *
     C                   Z-ADD     6             W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
     C                   MOVEL     BABSRN        ##D(6)
      *
      ** Spread
     C                   MOVEL     *BLANKS       R#DATA
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     URTSP         R#DATA
     C     USPIN         IFEQ      'S'
     C                   MOVE      '-'           ##SIGN
     C                   END
     C                   ELSE
     C                   MOVEL     TRTSP         R#DATA
     C     TSPIN         IFEQ      'S'
     C                   MOVE      '-'           ##SIGN
     C                   END
     C                   END
     C                   MOVEL     R#DATA        ##D(7)
     C                   MOVEL     *BLANKS       R#DATA
      *
      ** Average Rate
     C                   TESTB     '3'           UDSTI                    99    *
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'Y'           ##D(8)
     C                   ELSE
     C                   MOVEL     'N'           ##D(8)
     C                   END
      *
      ** Buy/Sell Indicator
      *
     C                   MOVEL     BYSL          ##D(9)
      *                                                                                       119240
      **  Currency Description  (multi-language for Financial Centre)                         119240
     C                   MOVEL     UCUCY         ##D(12)                                      119240
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXCFC         TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@CFCS                                         *
      * Function    :  Cap/Floor/Collar Settlement Details            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@CFCS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_CFCS'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_CFCS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Next interest payment date.
     C                   MOVEL     EVDAT         ##D(1)
      *
      ** Last interest payment date.
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     USLIP         ##D(2)
     C                   ELSE
     C                   MOVEL     TSLIP         ##D(2)
     C                   END
      *
      ** Gross interest
     C     PIAMT         IFNE      *ZEROS
     C     PIAMT         ADD       TAXPY         ##W150
     C                   ELSE
     C                   Z-ADD     RIAMT         ##W150
     C                   ENDIF
     C                   MOVEL     ##W150        ##D(3)
     C                   MOVEL     UCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C067
     C                   MOVE      A6NBDP        ##D(3)
      *
      ** Net interest
     C     PIAMT         IFNE      *ZEROS
     C                   Z-ADD     PIAMT         ##W150
     C                   ELSE
     C                   Z-ADD     RIAMT         ##W150
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C068
     C                   MOVEL     ##W150        ##D(4)
     C/COPY WNCPYSRC,CG4110C069
     C                   MOVE      A6NBDP        ##D(4)
      *
      ** Tax
     C     TAXPY         IFNE      *ZEROS
     C                   MOVEL     TAXPY         ##D(5)
     C                   MOVE      A6NBDP        ##D(5)
     C/COPY WNCPYSRC,CG4110C109
     C                   ENDIF
      *
      ** Tax Indicator
     C                   MOVEL     TAXI          ##D(6)
      *
      ** Payable by us.
     C     PIAMT         IFNE      *ZEROS
     C                   MOVEL     'Y'           ##D(7)
     C                   ELSE
     C/COPY WNCPYSRC,CG4110C070
     C                   MOVEL     'N'           ##D(7)
     C                   ENDIF
      ** Payable by them.
     C     RIAMT         IFNE      *ZEROS
     C                   MOVEL     'Y'           ##D(8)
     C                   ELSE
     C                   MOVEL     'N'           ##D(8)
     C                   ENDIF
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(9)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(10)                                      086780
      *                                                                                       CEU003
      ** Net interest In Settlement Currency; calculate using D@EURO.                         CEU003
      *                                                                                       CEU003
     C     PSCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE ##W150    P@FRAM                                        CEU003138000
     C                   Z-ADD     ##W150        P@FRAM                                       138000
     C                   MOVE      UCUCY         P@FRCY                                       CEU003
     C                   MOVE      PSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(11)                                      CEU003
     C                   MOVEL     PSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(11)                                      CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Net Interest to Equivalent currency.                                                 CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY              3                          CEU014
     C                   MOVE      UCUCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     UCUCY         IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      UCUCY         P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     ##W150        P@FRAM                         Net Interest  CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Net interest amount in Equivalent currency                                            CEU014
     C                   MOVEL     ##OUTA        ##D(12)                                      CEU014
     C                   MOVE      A6NBDP        ##D(12)                                      CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(13)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(14)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXCFCS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@DAPC                                         *
      * Function    :  Deal Amendment Principal Change Details        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@DAPC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_DAPC'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_DAPC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Currency
     C                   MOVEL     CCY           ##D(1)
      *
      ** Principal at start of day.
     C                   MOVEL     ##PCPL        ##D(2)
     C                   MOVEL     CCY           ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C071
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** Amount of increase/decrease.
     C                   MOVEL     DAAM          ##D(3)
     C                   MOVE      A6NBDP        ##D(3)
     C/COPY WNCPYSRC,CG4110C072
      *
      ** Principal (at end of day).
     C     AMTP          IFEQ      'PI'
     C     ##PCPL        ADD       DAAM          ##W150
     C                   ELSE
     C     ##PCPL        SUB       DAAM          ##W150
     C                   END
     C                   MOVEL     ##W150        ##D(4)
     C/COPY WNCPYSRC,CG4110C073
     C                   MOVE      A6NBDP        ##D(4)
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(5)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(6)                                       086780
      *                                                                                       089649
      ** Conf. narrative                                                                      089649
     C                   MOVEL     CNNA          ##D(7)                                       089649
      *                                                                                       CEU003
      ** Amount of increase/decrease in Settlement Currency;                                  CEU003
      **    calulate using D@EURO.                                                            CEU003
      *                                                                                       CEU003
     C     STCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE DAAM      P@FRAM                                        CEU003138000
     C                   Z-ADD     DAAM          P@FRAM                                       138000
     C                   MOVE      CCY           P@FRCY                                       CEU003
     C                   MOVE      STCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(8)                                       CEU003
     C                   MOVEL     STCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(8)                                       CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Amount of increase/decrease to Equivalent currency.                                  CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      CCY           ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     CCY           IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      CCY           P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     DAAM          P@FRAM                         Incr/decr amn CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Amount of increase/decrease in Equivalent currency                                    CEU014
     C                   MOVEL     ##OUTA        ##D(9)                                       CEU014
     C                   MOVE      A6NBDP        ##D(9)                                       CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(10)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(11)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C/COPY WNCPYSRC,CG4110C056
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXDAPC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@DARC                                         *
      * Function    :  Deal Amendment Rate Change Details             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@DARC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_DARC'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_DARC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Currency
     C                   MOVEL     CCY           ##D(1)
      *
      ** Interest rate
      ** Correct interest retrieval for SC and BC amendment                                AR1012947
      *                                                                                    AR1012947
     C/COPY WNCPYSRC,CG4110C011
     C**********           MOVELDARTSP    ##D,2                                            AR1012947
     C     *LIKE         DEFINE    INTR          DAINTR                                    AR1012947
     C     AMTP          IFEQ      'SC'                                                    AR1012947
     C     DABRTE        IFEQ      0                                                       AR1012947
     C                   Z-ADD     BRTE          DABRTE                                    AR1012947
     C                   ENDIF                                                             AR1012947
     C                   ENDIF                                                             AR1012947
      *                                                                                    AR1012947
     C     AMTP          IFEQ      'BC'                                                    AR1012947
     C     DARTSP        IFEQ      0                                                       AR1012947
     C                   Z-ADD     RTSP          DARTSP                                    AR1012947
     C                   ENDIF                                                             AR1012947
     C                   ENDIF                                                             AR1012947
     C     DABRTE        ADD       DARTSP        DAINTR                                    AR1012947
     C                   MOVEL     DAINTR        ##D(2)                                    AR1012947
     C/COPY WNCPYSRC,CG4110C012
      *                                                                                       086780
     C                   MOVEL     CCY           ##CCY                                        086780
     C                   EXSR      SRDCDT                                                     086780
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(3)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(4)                                       086780
      *                                                                                       089649
      ** Conf. narrative                                                                      089649
     C                   MOVEL     CNNA          ##D(5)                                       089649
      *                                                                                       089760
      ** Principal amount                                                                     089760
     C                   EXSR      SRDCPI                                                     089760
     C                   MOVEL     ##PCPL        ##D(6)                                       089760
     C                   MOVEL     CCY           ##CCY                                        089760
     C                   EXSR      SRDCDT                                                     089760
     C/COPY WNCPYSRC,CG4110C074
     C                   MOVE      A6NBDP        ##D(6)                                       089760
     C/COPY WNCPYSRC,CG4110C050
      *                                                                                       CRE073
      ** Interest Rate Rounding                                                               CRE073
      *                                                                                       CRE073
     C     CRE073        IFEQ      'Y'                                                        CRE073
     C**********           MOVELCNSP      ##D,7                                      CRE073 AR871662
     C**********           MOVELRDMT      ##D,8                                      CRE073 AR871662
     C**********           MOVELRDFD      ##D,9                                      CRE073 AR871662
     C                   MOVEL     DACNSP        ##D(7)                                     AR871662
     C                   MOVEL     DARDMT        ##D(8)                                     AR871662
     C                   MOVEL     DARDFD        ##D(9)                                     AR871662
     C                   MOVEL     CRE073        ##D(10)                                      CRE073
     C                   ENDIF                                                                CRE073
      *                                                                                     MD030644
      ** Base Rate Name                                                                     MD030644
      *                                                                                     MD030644
     C                   MOVEL     CCY           ##CYCD                                     MD030644
     C********** BRTT      IFEQ 0                                                  MD030644 MD033854
     C     DABRTT        IFEQ      0                                                        MD030644
     C                   MOVEL     *BLANKS       ##D(11)                                    MD030644
     C                   ELSE                                                               MD030644
     C**********           MOVELBRTT      ##BSRC                                   MD030644 MD033854
     C                   MOVEL     DABRTT        ##BSRC                                     MD030644
     C                   CALL      'AOBSRTR0'                                               MD030644
     C                   PARM      *BLANKS       ##RTCD                                     MD030644
     C                   PARM      '*KEY   '     ##OPTN                                     MD030644
     C                   PARM                    ##CYCD                                     MD030644
     C                   PARM                    ##BSRC                                     MD030644
     C     SDBSRT        PARM      SDBSRT        DSSDY                                      MD030644
      *                                                                                     MD030644
      ** DATABASE ERROR                                                                     MD030644
      *                                                                                     MD030644
     C     ##RTCD        IFNE      *BLANK                                                   MD030644
     C                   MOVEL     'SDBSRTPD'    W0FILE                                     MD030644
     C                   MOVEL     ##BSRC        W0KEY                                      MD030644
     C                   Z-ADD     60            W0ERNB                                     MD030644
     C                   MOVEL     'MEM5004'     W0MSGD                                     MD030644
     C                   MOVEL     'MIDAS  '     W0MSGF                                     MD030644
     C                   EXSR      SRERR                                                    MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
     C                   MOVEL     BABSRN        ##D(11)                                    MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
      ** Spread Rate                                                                        MD030644
      *                                                                                     MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
     C                   MOVEL     RTSP          R#DATA                                     MD030644
     C                   MOVEL     R#DATA        ##D(12)                                    MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
      *                                                                                     MD030644
      ** Interest Calculation Basis                                                         MD030644
      *                                                                                     MD030644
     C                   MOVEL     ICBS          ##D(13)                                    MD030644
      *                                                                                       CER050
     C     CER050        IFEQ      'Y'                                                        CER050
     C                   EXSR      ZI@APR                                                     CER050
     C                   ENDIF                                                                CER050
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXDARC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FLUF                                         *
      * Function    :  First & Last/Up Front Interest                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@FLUF        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_FLUF'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_FLUF'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** First & Last Day Interest
     C                   MOVEL     JFLID         ##D(1)
      *
      ** Front-Up Interest
     C                   MOVEL     FUID          ##D(2)
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXFLUF        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FRA                                          *
      * Function    :  FRA Details                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@FRA         BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_FRA '      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_FRA '     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Currency
     C                   MOVEL     UCUCY         ##D(1)
      *
      ** Principal
     C                   MOVEL     UPAMT         ##D(2)
     C                   MOVEL     UCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C075
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** Contract Period
     C     MDAT          SUB       VDAT          ##W050
     C                   MOVEL     ##W050        ##D(3)
     C                   MOVE      '0'           ##D(3)
      *
      ** Rate Fix Date
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     UINFD         ##D(4)
     C                   ELSE
     C                   MOVEL     TINFD         ##D(4)
     C                   END
      *
      ** Base Rate Type
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     UCUCY         ##CYCD
     C                   MOVEL     UBRTT         ##BSRC
     C                   ELSE
     C                   MOVEL     TCUCY         ##CYCD
     C                   MOVEL     TBRTT         ##BSRC
     C                   END
      *
     C                   MOVEL     ##BSRC        ##D(5)
      *
      ** Base Rate Name
     C                   CALL      'AOBSRTR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM                    ##CYCD
     C                   PARM                    ##BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                                               CSD006
     C     SDBSRT        PARM      SDBSRT        DSSDY                                        CSD006
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDBSRTPD'    W0FILE                         ***************
     C                   MOVEL     ##BSRC        W0KEY                          * DB ERROR 07 *
     C                   Z-ADD     7             W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
     C                   MOVEL     BABSRN        ##D(6)
      *
      ** Contract Rate
     C     OURTHR        IFEQ      'OUR'
     C                   MOVEL     TRTSP         ##D(7)                         * thr rate fixed
     C                   ELSE
     C                   MOVEL     URTSP         ##D(7)                         * our rate fixed
     C                   END
      *
      ** Interest Calculation Basis
     C                   MOVEL     UICBS         ##D(8)
      *
      ** Buy/Sell Indicator
      *
     C                   MOVEL     BYSL          ##D(9)
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(10)                                      086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(11)                                      086780
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXFRA         TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FRAS                                         *
      * Function    :  FRA Settlement Details                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@FRAS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_FRAS'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_FRAS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Settlement rate.
     C     BYSL          IFEQ      'B'
     C                   MOVEL     TFIR          ##D(1)
     C                   ELSE
     C                   MOVEL     UFIR          ##D(1)
     C                   ENDIF
      *
      ** Settlement amount.
     C     CNRQ          IFEQ      'G'
     C                   MOVEL     RIAMT         ##D(2)
     C                   ELSE
     C                   MOVEL     PIAMT         ##D(2)
     C                   ENDIF
      *
     C                   MOVEL     UCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C076
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** Pay by us
     C     CNRQ          IFEQ      'E'                                          * payment
     C                   MOVEL     'Y'           ##D(3)
     C                   ELSE
     C                   MOVEL     'N'           ##D(3)
     C                   ENDIF
      *
      ** Pay by them
     C     CNRQ          IFEQ      'G'                                          * receipt
     C                   MOVEL     'Y'           ##D(4)
     C                   ELSE
     C                   MOVEL     'N'           ##D(4)
     C                   ENDIF
      *                                                                                       CEU003
      ** Settlement amount in Settlement Currency; calculate using D@EURO.                    CEU003
      *                                                                                       CEU003
     C     PSCY          IFNE      *BLANKS                                                    CEU003
     C     CNRQ          IFEQ      'G'                                                        CEU003
     C**********           MOVE RIAMT     P@FRAM                                        CEU003138000
     C                   Z-ADD     RIAMT         P@FRAM                                       138000
     C                   ELSE                                                                 CEU003
     C**********           MOVE PIAMT     P@FRAM                                        CEU003138000
     C                   Z-ADD     PIAMT         P@FRAM                                       138000
     C                   ENDIF                                                                CEU003
     C                   MOVE      UCUCY         P@FRCY                                       CEU003
     C                   MOVE      PSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(5)                                       CEU003
     C                   MOVEL     PSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(5)                                       CEU003
     C                   ENDIF                                                                CEU003
      *                                                                                       CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Interest to Equivalent currency.                                                     CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      UCUCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     UCUCY         IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      UCUCY         P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C     CNRQ          IFEQ      'G'                                                        CEU014
     C                   Z-ADD     RIAMT         P@FRAM                         Interest      CEU014
     C                   ELSE                                                                 CEU014
     C                   Z-ADD     PIAMT         P@FRAM                         Interest      CEU014
     C                   ENDIF                                                                CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Interest amount in Equivalent currency                                                CEU014
     C                   MOVEL     ##OUTA        ##D(6)                                       CEU014
     C                   MOVE      A6NBDP        ##D(6)                                       CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(7)                                       CEU014
     C                   MOVEL     A6CYNM        ##D(8)                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXFRAS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@FRX                                          *
      * Function    :  FX deal details                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@FRX         BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_FRX '      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_FRX '     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Purchase Currency
     C                   MOVEL     PUCY          ##D(1)
      *
      ** Purchase Amount
     C                   MOVEL     PUAM          ##D(2)
     C                   MOVEL     PUCY          ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C077
     C                   MOVE      A6NBDP        ##D(2)
     C     *LIKE         DEFINE    A6CYNM        W#CYNM                                       086780
     C                   MOVE      *BLANKS       W#CYNM                                       086780
     C                   MOVEL     A6CYNM        W#CYNM                                       086780
      *
      ** Exchange Rate
     C/COPY WNCPYSRC,CG4110C078
     C                   MOVEL     EXRT          ##D(3)
     C/COPY WNCPYSRC,CG4110C079
      *
      ** Sale Currency
     C                   MOVEL     SLCY          ##D(4)
      *
      ** Sale Amount
     C                   MOVEL     SLAM          ##D(5)
     C                   MOVEL     SLCY          ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C080
     C                   MOVE      A6NBDP        ##D(5)
     C/COPY WNCPYSRC,CG4110C081
      *                                                                                       086780
      ** Sale Currency Description                                                            086780
     C                   MOVEL     A6CYNM        ##D(6)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(7)                                       086780
      *                                                                                       086780
      ** Purchase Currency Description                                                        086780
     C                   MOVEL     W#CYNM        ##D(8)                                       086780
      *                                                                                       CEU003
      ** Purchase Amount in Settlement Currency; calculate using D@EURO                       CEU003
      *                                                                                       CEU003
     C     RSCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE PUAM      P@FRAM                                        CEU003138000
     C                   Z-ADD     PUAM          P@FRAM                                       138000
     C                   MOVE      PUCY          P@FRCY                                       CEU003
     C                   MOVE      RSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(9)                                       CEU003
     C                   MOVEL     RSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(9)                                       CEU003
     C                   ENDIF                                                                CEU003
      *                                                                                       CEU003
      ** Sale Amount in Settlement Currency; calulate using D@EURO.                           CEU003
      *                                                                                       CEU003
     C     PSCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE SLAM      P@FRAM                                        CEU003138000
     C                   Z-ADD     SLAM          P@FRAM                                       138000
     C                   MOVE      SLCY          P@FRCY                                       CEU003
     C                   MOVE      PSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(10)                                      CEU003
     C                   MOVEL     PSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(10)                                      CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* Convert Purchase amount to Equivalent currency amount if the                          CEU014
     C*  Purchase currency is 'In' or 'Euro' currency.                                        CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       PEQCY             3                          CEU014
     C                   MOVE      PUCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Purchase currency is 'In', the Equivalent currency is in                       CEU014
     C*  'Euro' and the amount is converted to Euros.                                         CEU014
     C*                                                                                       CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        PEQCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Purchase currency is 'Euro', the Equivalent currency is                        CEU014
     C*  retrieved from Customer file.  The Equivalent currency is the                        CEU014
     C*  'In' currency designated on the Customer file.                                       CEU014
     C*                                                                                       CEU014
     C     PUCY          IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        PEQCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C     PEQCY         IFNE      *BLANKS                                                    CEU014
     C                   MOVE      PEQCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      PUCY          P@FRCY                                       CEU014
     C                   MOVE      PEQCY         P@TOCY                                       CEU014
     C                   Z-ADD     PUAM          P@FRAM                                       CEU014
     C                   EXSR      D@EURO                                                     CEU014
      *                                                                                       CEU014
      ** Purchase Amount in Equivalent currency                                               CEU014
     C                   MOVEL     ##OUTA        ##D(11)                                      CEU014
     C                   MOVE      A6NBDP        ##D(11)                                      CEU014
      *                                                                                       CEU014
      ** Equivalent currency and Description                                                  CEU014
     C                   MOVEL     PEQCY         ##D(12)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(13)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C*                                                                                       CEU014
     C* Convert Sale amount to Equivalent currency amount if the                              CEU014
     C*  Sale currency is 'In' or 'Euro' currency.                                            CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       SEQCY             3                          CEU014
     C                   MOVE      SLCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Sale currency is 'In', the Equivalent currency is in                           CEU014
     C*  'Euro' and the amount is converted to Euros.                                         CEU014
     C*                                                                                       CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        SEQCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Sale currency is 'Euro', the Equivalent currency is                            CEU014
     C*  retrieved from Customer file.  The Equivalent currency is the                        CEU014
     C*  'In' currency designated on the Customer file.                                       CEU014
     C*                                                                                       CEU014
     C     SLCY          IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        SEQCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C     SEQCY         IFNE      *BLANKS                                                    CEU014
     C                   MOVE      SEQCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      SLCY          P@FRCY                                       CEU014
     C                   MOVE      SEQCY         P@TOCY                                       CEU014
     C                   Z-ADD     SLAM          P@FRAM                                       CEU014
     C                   EXSR      D@EURO                                                     CEU014
      *                                                                                       CEU014
      ** Sale Amount in Equivalent currency                                                   CEU014
     C                   MOVEL     ##OUTA        ##D(14)                                      CEU014
     C                   MOVE      A6NBDP        ##D(14)                                      CEU014
      *                                                                                       CEU014
      ** Equivalent currency and Description                                                  CEU014
     C                   MOVEL     SEQCY         ##D(15)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(16)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXFRX         TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IRXO                                         *
      * Function    :  IRS Our Settlement Details                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@IRXO        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_IRXO'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_IRXO'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Our next interest payment date.
     C*                                                                                       S01408
      *                                                                                       CIR001
      ** For up-front interest:                                                               CIR001
      **   - if this is the first period, set the start date to the                           CIR001
      **     value date and the end date to the next payment date;                            CIR001
      **   - for all other periods, set the start date to the next                            CIR001
      **     payment date and get the end date from the schedules.                            CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     UINPM         ANDEQ     'D'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     UINPM         ANDEQ     'Y'                                                        CIR001
      *                                                                                       CIR001
     C                   TESTB     '1'           ACEI                 31                      CIR001
     C     *IN31         IFEQ      '1'                                                        CIR001
     C     VDAT          ANDGE     BJRDNB                                                     110874
     C                   MOVEL     UNIPD         ##D(1)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'U'           W0OTIN                                       CIR001
     C                   MOVEL     'P'           W0RCIP                                       CIR001
     C                   Z-ADD     UNIPD         W0ZDAY                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   MOVEL     W0ZDAY        ##D(1)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C/COPY WNCPYSRC,CG4110CCP6                                                               S01408
     C*                                                                                       S01408
     C     UNIPD         IFNE      *ZEROS
     C                   MOVEL     UNIPD         ##D(1)
     C                   ELSE
     C     UNICD         IFNE      *ZEROS
     C                   MOVEL     UNICD         ##D(1)
     C                   ELSE
     C                   MOVEL     MDAT          ##D(1)
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CIR001
     C                   ENDIF                                                                CIR001
      *                                                                                       CIR001
      ** For up-front interest:                                                               CIR001
      **   - if this is the first period, set the start date to the                           CIR001
      **     value date and the end date to the next payment date;                            CIR001
      **   - for all other periods, set the start date to the next                            CIR001
      **     payment date and get the end date from the schedules.                            CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     UINPM         ANDEQ     'D'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     UINPM         ANDEQ     'Y'                                                        CIR001
      *                                                                                       CIR001
     C                   TESTB     '1'           ACEI                 31                      CIR001
     C     *IN31         IFEQ      '1'                                                        CIR001
     C     VDAT          ANDGE     BJRDNB                                                     110874
     C                   MOVEL     VDAT          ##D(2)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     UNIPD         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP7                                                               S01408
     C*                                                                                       S01408
      *
      ** Our last interest payment date.
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP8                                                               S01408
     C*                                                                                       S01408
     C                   MOVEL     USLIP         ##D(2)
     C                   ENDIF                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CCP9                                                               S01408
     C*                                                                                       S01408
      *
      ** Our Currency
     C                   MOVEL     UCUCY         ##D(3)
      *
      ** Our Principal
     C                   MOVEL     UPAMT         ##D(4)
     C                   MOVEL     UCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C082
     C                   MOVE      A6NBDP        ##D(4)
      *
      ** Our gross interest payable
     C     PIAMT         ADD       TAXPY         ##W150
     C                   MOVEL     ##W150        ##D(5)
     C/COPY WNCPYSRC,CG4110C083
     C                   MOVE      A6NBDP        ##D(5)
      *
      ** Our net interest payable
     C                   MOVEL     PIAMT         ##D(6)
     C/COPY WNCPYSRC,CG4110C084
     C                   MOVE      A6NBDP        ##D(6)
      *
      ** Our tax payable.
     C***********TAXPY     IFNE *ZEROS                                    088501
     C                   MOVEL     TAXPY         ##D(7)
     C/COPY WNCPYSRC,CG4110C085
     C                   MOVE      A6NBDP        ##D(7)
     C***********          ENDIF                                          088501
      *
      ** Our net payment.
     C     DTYP          IFEQ      'RS'
     C     PIAMT         ANDGT     RIAMT
     C     RIAMT         ANDNE     *ZERO
     C     PIAMT         SUB       RIAMT         ##W150
     C                   MOVEL     ##W150        ##D(8)
     C                   MOVE      A6NBDP        ##D(8)
     C                   ELSE                                                                 088501
     C                   Z-ADD     *ZERO         ##W150                                       088501
     C                   MOVEL     ##W150        ##D(8)                                       088501
     C                   MOVE      A6NBDP        ##D(8)                                       088501
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C086
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(9)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(10)                                      086780
      *                                                                                       CEU003
      ** Our net payment in Settlement Currency; calculate using D@EURO.                      CEU003
      *                                                                                       CEU003
     C     PSCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE ##W150    P@FRAM                                        CEU003138000
     C                   Z-ADD     ##W150        P@FRAM                                       138000
     C                   MOVE      UCUCY         P@FRCY                                       CEU003
     C                   MOVE      PSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(11)                                      CEU003
     C                   MOVEL     PSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(11)                                      CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Our Net payment to Equivalent currency.                                              CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      UCUCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     UCUCY         IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      UCUCY         P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     ##W150        P@FRAM                         Our Net Payme CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Our Net Payment amount in Equivalent currency                                         CEU014
     C                   MOVEL     ##OUTA        ##D(12)                                      CEU014
     C                   MOVE      A6NBDP        ##D(12)                                      CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(13)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(14)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXIRXO        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@IRXT                                         *
      * Function    :  IRS Their Settlement Details                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@IRXT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_IRXT'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_IRXT'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Their next interest payment date.
     C*                                                                                       S01408
      *                                                                                       CIR001
      ** For up-front interest:                                                               CIR001
      **   - if this is the first period, set the start date to the                           CIR001
      **     value date and the end date to the next payment date;                            CIR001
      **   - for all other periods, set the start date to the next                            CIR001
      **     payment date and get the end date from the schedules.                            CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     TINPM         ANDEQ     'D'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     TINPM         ANDEQ     'Y'                                                        CIR001
      *                                                                                       CIR001
     C                   TESTB     '1'           ACEI                 31                      CIR001
     C     *IN31         IFEQ      '1'                                                        CIR001
     C     VDAT          ANDGE     BJRDNB                                                     110874
     C                   MOVEL     TNIPD         ##D(1)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'T'           W0OTIN                                       CIR001
     C                   MOVEL     'P'           W0RCIP                                       CIR001
     C                   Z-ADD     TNIPD         W0ZDAY                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   MOVEL     W0ZDAY        ##D(1)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   ELSE                                                                 CIR001
      *                                                                                       CIR001
     C/COPY WNCPYSRC,CG4110CP10                                                               S01408
     C*                                                                                       S01408
     C     TNIPD         IFNE      *ZEROS
     C                   MOVEL     TNIPD         ##D(1)
     C                   ELSE
     C     TNICD         IFNE      *ZEROS
     C                   MOVEL     TNICD         ##D(1)
     C                   ELSE
     C                   MOVEL     MDAT          ##D(1)
     C                   ENDIF
     C                   ENDIF
      *                                                                                       CIR001
     C                   ENDIF                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP11                                                               S01408
     C*                                                                                       S01408
      *
      ** Their last interest payment date.
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP12                                                               S01408
     C*                                                                                       S01408
      *                                                                                       CIR001
      ** For up-front interest:                                                               CIR001
      **   - if this is the first period, set the start date to the                           CIR001
      **     value date and the end date to the next payment date;                            CIR001
      **   - for all other periods, set the start date to the next                            CIR001
      **     payment date and get the end date from the schedules.                            CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     TINPM         ANDEQ     'D'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     TINPM         ANDEQ     'Y'                                                        CIR001
      *                                                                                       CIR001
     C                   TESTB     '1'           ACEI                 31                      CIR001
     C     *IN31         IFEQ      '1'                                                        CIR001
     C     VDAT          ANDGE     BJRDNB                                                     110874
     C                   MOVEL     VDAT          ##D(2)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TNIPD         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TSLIP         ##D(2)
     C                   ENDIF                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP13                                                               S01408
     C*                                                                                       S01408
      *
      ** Their Currency
     C                   MOVEL     TCUCY         ##D(3)
      *
      ** Their Principal
     C                   MOVEL     TPAMT         ##D(4)
     C                   MOVEL     TCUCY         ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C087
     C                   MOVE      A6NBDP        ##D(4)
      *
      ** Their gross interest payable.
     C                   MOVEL     RIAMT         ##D(5)
     C/COPY WNCPYSRC,CG4110C088
     C                   MOVE      A6NBDP        ##D(5)
     C/COPY WNCPYSRC,CG4110C110
      *
      ** Their net payment.
     C     DTYP          IFEQ      'RS'
     C     RIAMT         ANDGT     PIAMT
     C     PIAMT         ANDNE     *ZERO
     C     RIAMT         SUB       PIAMT         ##W150
     C                   MOVEL     ##W150        ##D(6)
     C                   MOVE      A6NBDP        ##D(6)
     C                   ELSE                                                                 088501
     C                   Z-ADD     *ZERO         ##W150                                       088501
     C                   MOVEL     ##W150        ##D(6)                                       088501
     C                   MOVE      A6NBDP        ##D(6)                                       088501
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C089
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(7)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(8)                                       086780
      *                                                                                       CEU003
      ** Their net payment in Settlement Currency; calculate using D@EURO.                    CEU003
      *                                                                                       CEU003
     C     RSCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE ##W150    P@FRAM                                        CEU003138000
     C                   Z-ADD     ##W150        P@FRAM                                       138000
     C                   MOVE      TCUCY         P@FRCY                                       CEU003
     C                   MOVE      RSCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(9)                                       CEU003
     C                   MOVEL     RSCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(9)                                       CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Their Net payment to Equivalent currency.                                            CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      TCUCY         ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     TCUCY         IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      TCUCY         P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     ##W150        P@FRAM                         Their Net Pay CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Their Net Payment amount in Equivalent currency                                       CEU014
     C                   MOVEL     ##OUTA        ##D(10)                                      CEU014
     C                   MOVE      A6NBDP        ##D(10)                                      CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(11)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(12)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXIRXT        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@LAD                                          *
      * Function    :  Loan & Deposit Details                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@LAD         BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_LAD '      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_LAD '     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Currency
     C                   MOVEL     CCY           ##D(1)
      *
      ** Principal
      ** (as calculated)
     C                   MOVEL     ##PCPL        ##D(2)
     C                   MOVEL     CCY           ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C090
     C                   MOVE      A6NBDP        ##D(2)
     C                   MOVE      A6NBDP        FRDEC             1 0                        234865
     C                   Z-ADD     A6SPRT        FRSPT            13 8                        234865
     C                   MOVE      A6MDIN        FRMDI             1                          234865
      *
      ** Interest Rate
      ** (as calculated)
     C                   MOVEL     ##INTR        ##D(3)
      *
      ** Gross Interest
      ** (as calculated)
     C                   MOVEL     ##INTA        ##D(4)
     C/COPY WNCPYSRC,CG4110C091
     C                   MOVE      A6NBDP        ##D(4)
     C/COPY WNCPYSRC,CG4110C041
      *                                                                                       CDL013
      ** If CDL013 is installed and *IN04 is ON, calculate WHT amount                         CDL013
     C     CDL013        IFEQ      '1'                                                        CDL013
     C     TAXI          ANDNE     '0'                                                        CDL013
      *                                                                                       CDL013
     C                   MOVE      *BLANKS       WSTAT                                      MD057008
      ** Proceed with WHT calculation only for deal types IT, CD or TD                        CDL013
     C     DTYP          IFEQ      'IT'                                                       CDL013
     C     DTYP          OREQ      'CD'                                                       CDL013
     C     DTYP          OREQ      'TD'                                                       CDL013
      *                                                                                       CDL013
     C                   MOVE      *ON           *IN82                                        CDL013
      *                                                                                       CDL013
      ** Set WHT rate                                                                         CDL013
     C                   SELECT                                                               CDL013
     C     TAXI          WHENEQ    '1'                                                        CDL013
     C                   Z-ADD     ETXR1         WRATE             5 2                        CDL013
     C     TAXI          WHENEQ    '2'                                                        CDL013
     C                   Z-ADD     ETXR2         WRATE                                        CDL013
     C     TAXI          WHENEQ    '3'                                                        CDL013
     C                   Z-ADD     ETXR3         WRATE                                        CDL013
     C     TAXI          WHENEQ    '4'                                                        CDL013
     C                   Z-ADD     ETXR4         WRATE                                        CDL013
     C     TAXI          WHENEQ    '5'                                                        CDL013
     C                   Z-ADD     ETXR5         WRATE                                        CDL013
     C     TAXI          WHENEQ    '6'                                                        CDL013
     C                   Z-ADD     ETXR6         WRATE                                        CDL013
     C     TAXI          WHENEQ    '7'                                                        CDL013
     C                   Z-ADD     ETXR7         WRATE                                        CDL013
     C     TAXI          WHENEQ    '8'                                                        CDL013
     C                   Z-ADD     ETXR8         WRATE                                        CDL013
     C     TAXI          WHENEQ    '9'                                                        CDL013
     C                   Z-ADD     ETXR9         WRATE                                        CDL013
     C                   ENDSL                                                                CDL013
      *                                                                                       CDL013
      ** If WHT rate is 0, set Tax amount to 0                                                CDL013
     C     WRATE         IFEQ      0                                                          CDL013
     C                   Z-ADD     0             ##TAXA                                       CDL013
      *                                                                                       CDL013
      ** Otherwise, calculate WHT                                                             CDL013
     C                   ELSE                                                                 CDL013
      *                                                                                       CDL013
      ** If Deal Ccy = Base Ccy, calculate WHT rounded down                                   CDL013
      ** and CDL081 is off                                                                    CDL081
      *                                                                                       CDL081
     C     CCY           IFEQ      BJCYCD                                                     CDL013
     C     CDL081        ANDEQ     'N'                                                        CDL013
      *                                                                                       CDL013
      ** Set work adjustment field according to decimal places.                               CDL013
     C     A6NBDP        COMP      2                                    8889                  CDL013
     C     *IN88         IFEQ      *OFF                                                       CDL013
     C     *IN89         ANDEQ     *OFF                                                       CDL013
     C                   SETON                                        8889                    CDL013
     C                   ENDIF                                                                CDL013
     C     *IN88         IFEQ      *OFF                                                       CDL013
     C     *IN89         ANDEQ     *OFF                                                       CDL013
     C                   Z-ADD     1             WADJ              4 0                        CDL013
     C                   ENDIF                                                                CDL013
     C     *IN88         IFEQ      *ON                                                        CDL013
     C     *IN89         ANDEQ     *OFF                                                       CDL013
     C                   Z-ADD     10            WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
     C     *IN88         IFEQ      *OFF                                                       CDL013
     C     *IN89         ANDEQ     *ON                                                        CDL013
     C                   Z-ADD     100           WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
     C     *IN88         IFEQ      *ON                                                        CDL013
     C     *IN89         ANDEQ     *ON                                                        CDL013
     C                   Z-ADD     1000          WADJ                                         CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CDL013
      ** Round down Interest Amount.                                                          CDL013
     C     TOTI          DIV       WADJ          WTOTAL           15 0                        CDL013
     C                   MULT      WADJ          WTOTAL                                       CDL013
      *                                                                                       CDL013
      ** Calculate WHT                                                                        CDL013
     C     WTOTAL        MULT      WRATE         ##TAXA                                       CDL013
     C                   DIV       100           ##TAXA                                       CDL013
      *                                                                                       CDL013
      ** Round down WHT                                                                       CDL013
     C                   DIV       WADJ          ##TAXA                                       CDL013
     C                   MULT      WADJ          ##TAXA                                       CDL013
      *                                                                                       CDL013
      ** If Deal Ccy NOT Base Ccy, calculate half-adjusted WHT                                CDL013
     C                   ELSE                                                                 CDL013
     C     TOTI          MULT      WRATE         ##TAXA                                       CDL013
      *                                                                                       CDL081
      ** Check if tax amount is to be rounded down                                            CDL081
      *                                                                                       CDL081
     C     CCY           IFEQ      BJCYCD                                                     CDL081
     C     CDL081        ANDEQ     'Y'                                                        CDL081
     C     W#BSRD        ANDEQ     'Y'                                                        CDL081
     C     CCY           ORNE      BJCYCD                                                     CDL081
     C     CDL081        ANDEQ     'Y'                                                        CDL081
     C     W#NBRD        ANDEQ     'Y'                                                        CDL081
     C                   DIV       100           ##TAXA                                       CDL081
     C                   ELSE                                                                 CDL013
     C                   DIV(H)    100           ##TAXA                                       CDL081
     C                   ENDIF                                                                CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CDL013
      ** If CDL013 NOT installed, perform original tax calculation                            CDL013
     C                   ELSE
      *
      ** DETERMINE TAX AMOUNT
     C     *LIKE         DEFINE    ##INTA        ##TAXA
     C                   Z-ADD     *ZERO         ##TAXA
     C                   Z-ADD     *ZERO         WNTAMT                                       232543
     C                   Z-ADD     *ZERO         WSTAX                                      MD033892
     C                   Z-ADD     *ZERO         WNSTAX                                     BUG23165
     C                   Z-ADD     *ZERO         WTTAX                                      MD033892
     C                   Z-ADD     *ZERO         WNTTAX                                       CER054
     C                   Z-ADD     *ZERO         @@TOTI                                     BUG23812
     C                   Z-ADD     *ZEROS        ACPTHU                                     BUG23812
     C                   MOVE      *BLANK        WSTAT                                        235126
     C/COPY WNCPYSRC,CG4110C025
     C     DTYP          IFEQ      'IT'
     C     DTYP          OREQ      'CD'
     C     DTYP          OREQ      'TD'
     C                   EXSR      SRDTAX
     C                   ENDIF
      *                                                                                       235126
     C     CDL006        IFEQ      'Y'                                                        235126
     C     DTYP          IFEQ      'DT'                                                       235126
     C     DTYP          OREQ      'FT'                                                       235126
     C                   EXSR      SRETAX                                                     235126
     C                   ENDIF                                                                235126
     C                   ENDIF                                                                235126
      *                                                                                       235126
     C********** TAXI      IFEQ 'Y'                                                    234865 235126
     C********** CGL031    OREQ 'Y'                                                    235143 235126
     C**********           EXSR SRDTAX                                                 234865 235126
     C**********           Z-ADD@@TAXA    ##TAXA                                       235143 235126
     C**********           END                                                         234865 235126
     C**********           END                                                         234865 235126
     C*****************************************************************                234865 235126
     C**For*the*fiduciary;*only*the*EU*tax*must*be*applied;*not*the*local Swuiss Tax   234865 235126
     C*****************************************************************                234865 235126
     C********** DTYP      OREQ 'DT'                                                   CGL031 234865
     C********** DTYP      IFEQ 'DT'                                                   234865 235126
     C********** CDL006    ANDEQ'Y'                                                    CGL031 235126
     C********** CGL031    ANDEQ'Y'                                                    CGL031 232543
     C********** DTYP      OREQ 'LT'                                                   CGL031 235126
     C********** CDL006    ANDEQ'Y'                                                    CGL031 235126
     C********** CGL031    ANDEQ'Y'                                                    CGL031 232543
     C********** DTYP      OREQ 'FT'                                                   CGL031 235126
     C********** CDL006    ANDEQ'Y'                                                    CGL031 235126
     C********** CGL031    ANDEQ'Y'                                                    CGL031 232543
     C********** TAXI      IFEQ 'Y'                                                           235126
     C********** CGL031    OREQ 'Y'                                                    232543 235126
     C**********           MOVE 'Y'       TAXFLG  1                                    CGL031 235126
     C********** TAXI      IFEQ 'N'                                                    235426 235126
     C**********           Z-ADD*ZEROS    ##TAXA                                       234865 235126
     C**********           ENDIF                                                       235426 235126
     C**********           EXSR SRDTAX                                                        234865
     C**********           EXSR SRETAX                                                 234865 235126
     C********** ##TAXA    ADD  WNTAMT    ##TAXA                                       232543 234865
     C**********           Z-ADD@@TAXA    ##TAXA                                       234865 235126
     C**********           MOVE 'N'       TAXFLG                                       CGL031 235126
     C/COPY WNCPYSRC,CG4110C045
     C**********           END                                                                235126
     C/COPY WNCPYSRC,CG4110C047
     C**********           END                                                                235126
      *                                                                                       CDL013
     C                   ENDIF                                                                CDL013
     C/COPY WNCPYSRC,CG4110C042
      *
      ** Net Interest
     C     *LIKE         DEFINE    ##INTA        ##NETA
     C     ##INTA        SUB       ##TAXA        ##NETA
     C     ##NETA        SUB       WNSTAX        ##NETA                                     BUG23165
     C     ##NETA        SUB       WNTTAX        ##NETA                                       CER054
     C                   MOVEL     ##NETA        ##D(5)
     C/COPY WNCPYSRC,CG4110C092
     C                   MOVE      A6NBDP        ##D(5)
      *
      ** Tax
     C                   MOVEL     ##TAXA        ##D(6)
     C/COPY WNCPYSRC,CG4110C093
     C                   MOVE      A6NBDP        ##D(6)
      *
      ** Tax Indicator
     C/COPY WNCPYSRC,CG4110C026
     C                   MOVEL     TAXI          ##D(7)
     C/COPY WNCPYSRC,CG4110C027
      *
      ** Net total (principal + net interest if interest not up-front, else
      **            principal - net interest)
      *
     C     *LIKE         DEFINE    ##PCPL        ##NETT
     C     FUID          IFNE      'Y'
     C     ##PCPL        ADD       ##NETA        ##NETT
     C                   ELSE
     C     ##PCPL        SUB       ##NETA        ##NETT
     C                   END
     C                   MOVEL     ##NETT        ##D(8)
     C/COPY WNCPYSRC,CG4110C094
     C                   MOVE      A6NBDP        ##D(8)
      *
      ** Total Interest Override
     C                   TESTB     '2'           DNSI                     99    *
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'Y'           ##D(9)
     C                   ELSE
     C                   MOVEL     'N'           ##D(9)
     C                   END
      *
      ** Loan/Deposit Indicator
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    *
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'L'           ##D(10)
     C                   ELSE
     C                   MOVEL     'D'           ##D(10)
     C                   END
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(11)                                      086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(12)                                      086780
      *                                                                                       086864
      ** Interest paid seperately                                                             086864
     C                   MOVEL     IPDS          ##D(13)                                      086864
      *                                                                                       086962
      ** Start or last interest date.                                                         086962
     C                   MOVEL     SLID          ##D(14)                                      086962
      *                                                                                       089649
      ** Conf. narrative                                                                      089649
     C                   MOVEL     CNNA          ##D(15)                                      089649
      *
      ** C. D. reference                                                                      116840
     C                   MOVEL     RNNA          ##D(16)                                      116840
      *                                                                                       116840
      ** Net Total in Settlement Currency; calculate using D@EURO.                            CEU003
      *                                                                                       CEU003
     C     STCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE ##NETT    P@FRAM                                        CEU003138000
     C                   Z-ADD     ##NETT        P@FRAM                                       138000
     C                   MOVE      CCY           P@FRCY                                       CEU003
     C                   MOVE      STCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(17)                                      CEU003
     C                   MOVEL     STCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(17)                                      CEU003
     C                   ENDIF                                                                CEU003
      *                                                                                       CEU003
      *                                                                                       CEU003
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Net Total amount to Equivalent currency.                                             CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      CCY           ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     CCY           IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      CCY           P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     ##NETT        P@FRAM                         Net Total amn CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Net Total amount in Equivalent currency                                               CEU014
     C                   MOVEL     ##OUTA        ##D(18)                                      CEU014
     C                   MOVE      A6NBDP        ##D(18)                                      CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(19)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(20)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C/COPY WNCPYSRC,CG4110C051
     C*                                                                                       CEU014
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   MOVEL     ##SDS         ##ADS
      *                                                                                       234865
      **  Retrieve RDE information for RDEs in group set                                      234865
      *                                                                                       234865
     C                   Z-ADD     21            ##RDEN                                       234865
     C                   EXSR      SRRRDE                                                     234865
      *                                                                                       234865
      ** Local Currency                                                                       234865
      *                                                                                       234865
     C                   MOVEL     BJCYCD        ##D(1)                                       234865
      *                                                                                       234865
     C                   MOVEL     BJCYCD        ##CCY                                        234865
     C                   EXSR      SRDCDT                                                     234865
      *                                                                                       234865
      ** Currency Description                                                                 234865
     C                   MOVEL     FRSPT         ##D(2)                                       234865
     C                   MOVE      8             ##D(2)                                       234865
      *                                                                                       234865
      ** Local Tax                                                                            235126
      *                                                                                       235126
     C     CCY           IFEQ      BJCYCD                                                     235126
     C                   MOVEL     ##TAXA        ##D(3)                                       235126
     C                   MOVE      FRDEC         ##D(3)                                       235126
     C                   ELSE                                                                 235126
      *                                                                                       235126
     C                   Z-ADD     FRSPT         ZRATE1           13 8                        235126
     C                   MOVE      FRMDI         ZMDI1             1                          235126
     C                   MOVE      FRDEC         ZCDPI                                        235126
      *                                                                                       235126
     C                   MOVE      BJCYCD        PCCY                                         235126
     C                   EXSR      SRCURR                                                     235126
     C                   Z-ADD     A6SPRT        ZRATE2           13 8                        235126
     C                   MOVE      A6MDIN        ZMDI2             1                          235126
     C                   MOVE      A6NBDP        ZCDPO                                        235126
      *                                                                                       235126
     C                   EXSR      ZXRATE                                                     235126
      *                                                                                       235126
     C                   Z-ADD     ##TAXA        ZAMTCI                                       235126
     C                   Z-ADD     ZRATEX        ZEXCH                                        235126
     C                   MOVE      ZMDIX         ZMD                                          235126
      *                                                                                       235126
     C                   EXSR      ZCONVN                                                     235126
     C                   MOVEL     ZAMTCO        ##D(3)                                       235126
     C                   MOVE      A6NBDP        ##D(3)                                       235126
     C                   ENDIF                                                                235126
      *                                                                                       235126
     C**********           Z-ADD##TAXA    ZAMTCI                                       234865 235126
     C**********           Z-ADDFRSPT     ZEXCH                                        234865 235126
     C**********           MOVE FRMDI     ZMD                                          234865 235126
     C**********           Z-ADDFRDEC     ZCDPI                                        234865 235126
     C**********           Z-ADDA6NBDP    ZCDPO                                        234865 235126
     C**********           EXSR ZCONVN                                                 234865 235126
     C**********           MOVELZAMTCO    ##D,3                                        234865 235126
     C**********           MOVE A6NBDP    ##D,3                                        234865 235126
      *                                                                                       234865
      ** Resident/ Non-Resident Flag                                                        BUG23880
      *                                                                                     BUG23880
     C                   MOVEL     RESID         ##D(4)                                     BUG23880
      *                                                                                       CRE073
      ** Interest Rate Rounding                                                               CRE073
      *                                                                                       CRE073
     C     CRE073        IFEQ      'Y'                                                        CRE073
     C                   MOVEL     CNSP          ##D(5)                                       CRE073
     C                   MOVEL     RDMT          ##D(6)                                       CRE073
     C                   MOVEL     RDFD          ##D(7)                                       CRE073
     C                   MOVEL     CRE073        ##D(8)                                       CRE073
     C                   ENDIF                                                                CRE073
      *                                                                                     MD030644
      ** Base Rate Name                                                                     MD030644
      *                                                                                     MD030644
     C                   MOVEL     CCY           ##CYCD                                     MD030644
     C     BRTT          IFEQ      0                                                        MD030644
     C                   MOVEL     *BLANKS       ##D(9)                                     MD030644
     C                   ELSE                                                               MD030644
     C                   MOVEL     BRTT          ##BSRC                                     MD030644
     C                   CALL      'AOBSRTR0'                                               MD030644
     C                   PARM      *BLANKS       ##RTCD                                     MD030644
     C                   PARM      '*KEY   '     ##OPTN                                     MD030644
     C                   PARM                    ##CYCD                                     MD030644
     C                   PARM                    ##BSRC                                     MD030644
     C     SDBSRT        PARM      SDBSRT        DSSDY                                      MD030644
      *                                                                                     MD030644
      ** DATABASE ERROR                                                                     MD030644
      *                                                                                     MD030644
     C     ##RTCD        IFNE      *BLANK                                                   MD030644
     C                   MOVEL     'SDBSRTPD'    W0FILE                                     MD030644
     C                   MOVEL     ##BSRC        W0KEY                                      MD030644
     C                   Z-ADD     61            W0ERNB                                     MD030644
     C                   MOVEL     'MEM5004'     W0MSGD                                     MD030644
     C                   MOVEL     'MIDAS  '     W0MSGF                                     MD030644
     C                   EXSR      SRERR                                                    MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
     C                   MOVEL     BABSRN        ##D(9)                                     MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
      ** Spread Rate                                                                        MD030644
      *                                                                                     MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
     C                   MOVEL     RTSP          R#DATA                                     MD030644
     C                   MOVEL     R#DATA        ##D(10)                                    MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
      *                                                                                     MD030644
      ** Interest Calculation Basis                                                         MD030644
      *                                                                                     MD030644
     C                   MOVEL     ICBS          ##D(11)                                    MD030644
      *                                                                                       234865
      **  Accumulate RDE's and associated data and output to                                  234865
      **  PF/CGUDTAPD.                                                                        234865
     C                   EXSR      SRADTA                                                     234865
     C     ##SDS         CAT       ##ADS:0       ##SDS                                        234865
      *                                                                                       234865
      **  Initialise Write Format Parameter.                                                  234865
     C                   CLEAR                   W0FMT                                        234865
      *                                                                                       234865
      **  Set up Control Information.                                                         234865
     C                   Z-ADD     ##ITEM        DEITEM                                       234865
     C                   ADD       1             ##OSEQ                                       234865
     C                   Z-ADD     ##OSEQ        DEOSEQ                                       234865
     C                   Z-ADD     1             DEPBIN                                       234865
     C                   Z-ADD     1             DETBIN                                       234865
     C                   MOVE      'FR'          DEFSLI                                       234865
     C                   MOVE      *BLANKS       W0PATH                                       234865
     C                   MOVEL     S#PATH        W0PATH                                       234865
      *                                                                                       234865
      **  Append Data from pack routine.                                                      234865
     C     W0FMT         CAT       ##SDS:0       W0FMT                                        234865
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXLAD         TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C/SPACE 5
      *****************************************************************                       151837
      * Subroutine  :  D@LADE                                         *                       151837
      * Function    :  Loan & Deposit Extended Details.               *                       151837
      *                                                               *                       151837
      * Called by   :                                                 *                       151837
      * Calls       :                                                 *                       151837
      *****************************************************************                       151837
     C     D@LADE        BEGSR                                                                151837
      *                                                                                       151837
      **  Set up subroutine stack name                                                        151837
     C                   ADD       1             Q                                            151837
     C                   MOVEL     'D_LADE'      @STK(Q)                                      151837
      *                                                                                       151837
      *................................................................                       151837
      *                                                                                       151837
      **  Retrieve subroutine specific data.                                                  151837
     C     1             OCCUR     ##SRDT                                                     151837
     C                   MOVEL     ##SPAT        S#PATH                                       151837
      *                                                                                       151837
      **  Set up Path.                                                                        151837
     C                   MOVEL     '\D_LADE'     ##PNAM                                       151837
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       151837
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       151837
      **  Retrieve RDE information for RDEs in group set                                      151837
      *                                                                                       151837
     C                   MOVEL     @STK(Q)       ##GRPS                                       151837
     C                   Z-ADD     1             ##RDEN                                       151837
     C                   EXSR      SRRRDE                                                     151837
      *                                                                                       151837
      * Principal in equivalent ccy.                                                          151837
     C                   Z-ADD     ##PCPL        P@FRAM                                       151837
     C     P@TOCY        IFNE      *BLANKS                                                   BUG7628
     C                   EXSR      D@EURO                                                     151837
     C                   ELSE                                                                BUG7628
     C                   Z-ADD     P@FRAM        ##OUTA                                      BUG7628
     C                   ENDIF                                                               BUG7628
     C*                                                                                       151837
     C* Principal in equivalent ccy.                                                          151837
     C                   MOVEL     ##OUTA        ##D(01)                                      151837
     C                   MOVEL     CCY           ##CCY                                     BUG23799A
     C                   EXSR      SRDCDT                                                  BUG23799A
     C                   MOVE      A6NBDP        ##D(01)                                      151837
      *                                                                                       151837
      * Gross Interrest in equivalent ccy.                                                    151837
     C                   Z-ADD     ##INTA        P@FRAM                                       151837
     C     P@TOCY        IFNE      *BLANKS                                                   BUG7628
     C                   EXSR      D@EURO                                                     151837
     C                   ELSE                                                                BUG7628
     C                   Z-ADD     P@FRAM        ##OUTA                                      BUG7628
     C                   ENDIF                                                               BUG7628
     C*                                                                                       151837
      * Gross Interrest in equivalent ccy.                                                    151837
     C                   MOVEL     ##OUTA        ##D(02)                                      151837
     C                   MOVE      A6NBDP        ##D(02)                                      151837
      *                                                                                    BUG23799A
      ** Customer Tax Status                                                               BUG23799A
      *                                                                                    BUG23799A
     C                   MOVEL     WSTAT         ##D(03)                                   BUG23799A
      *                                                                                     BUG23515
      ** CGL031 Status                                                                      BUG23515
      *                                                                                     BUG23515
     C**********           MOVELCGL031    ##D,03                                  BUG23515 BUG23799A
     C                   MOVEL     CGL031        ##D(04)                                   BUG23799A
      *                                                                                     BUG23515
      **  Accumulate RDE's and associated data and output to                                  151837
      **  PF/CGUDTAPD.                                                                        151837
     C                   EXSR      SRADTA                                                     151837
     C                   EXSR      SRODTA                                                     151837
      *                                                                                       151837
      *................................................................                       151837
      *                                                                                       151837
     C     EXLADE        TAG                                                                  151837
      *                                                                                       151837
      **  Unwind subroutine stack name                                                        151837
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      151837
     C                   SUB       1             Q                                            151837
      *                                                                                       151837
     C                   ENDSR                                                                151837
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@LADC                                         *
      * Function    :  Loan & Deposit Capitalization Details          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@LADC        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_LADC'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_LADC'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Interest capitalization indicator.
     C                   MOVEL     INTC          ##D(1)
     C     CNRQ          IFEQ      'C'                                                        088485
     C     AMTP          ANDEQ     'CI'                                                       088485
     C                   MOVEL     'Y'           ##D(1)                                       088485
     C                   ENDIF                                                                088485
      *
      ** Interest capitalized.
     C                   MOVEL     ##INTA        ##D(2)
     C                   MOVEL     CCY           ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C095
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** New principal.
     C     ##PCPL        ADD       ##INTA        ##W150
     C                   MOVEL     ##W150        ##D(3)
     C/COPY WNCPYSRC,CG4110C096
     C                   MOVE      A6NBDP        ##D(3)
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXLADC        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@LADS                                         *
      * Function    :  Loan & Deposit Settlement Details              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@LADS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_LADS'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_LADS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Next Interest Payment date = event date
     C                   MOVEL     EVDAT         ##D(1)
      *
      ** Last Interest Payment date
     C                   MOVEL     SLID          ##D(2)
      *
      ** Currency
     C                   MOVEL     CCY           ##D(3)
      *
      ** Principal
      ** (as calculated)
     C                   MOVEL     ##PCPL        ##D(4)
     C                   MOVEL     CCY           ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C097
     C                   MOVE      A6NBDP        ##D(4)
      *
      ** Interest Rate
      ** (as calculated)
     C                   MOVEL     ##INTR        ##D(5)
      *
      ** Gross Interest
      ** (as calculated)
     C                   MOVEL     ##INTA        ##D(6)
     C/COPY WNCPYSRC,CG4110C098
     C                   MOVE      A6NBDP        ##D(6)
      *
      ** DETERMINE TAX AMOUNT
     C                   Z-ADD     *ZERO         ##TAXA
     C                   Z-ADD     *ZERO         WNTAMT                                       235126
     C                   Z-ADD     *ZERO         WSTAX                                      MD033892
     C                   Z-ADD     *ZERO         WNSTAX                                     MD033892
     C                   Z-ADD     *ZERO         WTTAX                                      MD033892
     C                   Z-ADD     *ZERO         WNTTAX                                     MD033892
     C                   MOVE      *BLANK        WSTAT                                        235126
     C/COPY WNCPYSRC,CG4110C028
     C     DTYP          IFEQ      'IT'
     C     DTYP          OREQ      'CD'
     C     DTYP          OREQ      'TD'
     C                   EXSR      SRDTAX
     C                   ENDIF
      *                                                                                       235126
     C     CDL006        IFEQ      'Y'                                                        235126
     C     DTYP          IFEQ      'DT'                                                       235126
     C     DTYP          OREQ      'FT'                                                       235126
     C                   EXSR      SRETAX                                                     235126
     C                   ENDIF                                                                235126
     C                   ENDIF                                                                235126
      *                                                                                       235126
     C********** TAXI      IFEQ 'Y'                                                           235126
     C**********           EXSR SRDTAX                                                        235126
     C/COPY WNCPYSRC,CG4110C046
     C**********           END                                                                235126
     C/COPY WNCPYSRC,CG4110C048
     C**********           END                                                                235126
     C/COPY WNCPYSRC,CG4110C063
      *
      ** Net Interest
     C     ##INTA        SUB       ##TAXA        ##NETA
      *                                                                                    MD027745B
     C     CER048        IFEQ      'Y'                                                     MD027745B
     C     ##NETA        SUB       WNSTAX        ##NETA                                    MD027745B
     C                   ENDIF                                                             MD027745B
      *                                                                                    MD027745B
     C     CER054        IFEQ      'Y'                                                     MD027745B
     C     ##NETA        SUB       WNTTAX        ##NETA                                    MD027745B
     C                   ENDIF                                                             MD027745B
     C                   MOVEL     ##NETA        ##D(7)
     C/COPY WNCPYSRC,CG4110C099
     C                   MOVE      A6NBDP        ##D(7)
      *
      ** Tax
     C                   MOVEL     ##TAXA        ##D(8)
     C/COPY WNCPYSRC,CG4110C100
     C                   MOVE      A6NBDP        ##D(8)
      *
      ** Tax Indicator
     C/COPY WNCPYSRC,CG4110C029
     C                   MOVEL     TAXI          ##D(9)
     C/COPY WNCPYSRC,CG4110C030
      *
      ** Loan/Deposit Indicator
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    #LN(#1)                                99    *
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'L'           ##D(10)
     C                   ELSE
     C                   MOVEL     'D'           ##D(10)
     C                   END
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(11)                                      086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(12)                                      086780
      *                                                                                       089649
      ** Conf. narrative                                                                      089649
     C                   MOVEL     CNNA          ##D(13)                                      089649
      *                                                                                       CEU003
      ** Net Interest in Settlement Currency; calculate using D@EURO                          CEU003
      *                                                                                       CEU003
     C     STCY          IFNE      *BLANKS                                                    CEU003
     C**********           MOVE ##NETA    P@FRAM                                        CEU003138000
     C                   Z-ADD     ##NETA        P@FRAM                                       138000
     C                   MOVE      CCY           P@FRCY                                       CEU003
     C                   MOVE      STCY          P@TOCY                                       CEU003
     C                   EXSR      D@EURO                                                     CEU003
     C                   MOVEL     ##OUTA        ##D(14)                                      CEU003
     C                   MOVEL     STCY          ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVE      A6NBDP        ##D(14)                                      CEU003
     C                   ENDIF                                                                CEU003
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert                             CEU014
     C*  Net Interest amount to Equivalent currency.                                          CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      CCY           ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     CCY           IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      CCY           P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     ##NETA        P@FRAM                         Net Interest  CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Net Interest amount in Equivalent currency                                            CEU014
     C                   MOVEL     ##OUTA        ##D(15)                                      CEU014
     C                   MOVE      A6NBDP        ##D(15)                                      CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(16)                                      CEU014
     C                   MOVEL     A6CYNM        ##D(17)                                      CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *                                                                                      CER048A
      ** Local Currency                                                                      CER048A
      *                                                                                      CER048A
     C                   MOVEL     BJCYCD        ##D(18)                                     CER048A
      *                                                                                      CER048A
     C                   MOVEL     BJCYCD        ##CCY                                       CER048A
     C                   EXSR      SRDCDT                                                    CER048A
      *                                                                                      CER048A
      ** Currency Rate                                                                       CER048A
      *                                                                                      CER048A
     C                   MOVEL     A6SPRT        ##D(19)                                     CER048A
     C                   MOVE      8             ##D(19)                                     CER048A
      *                                                                                      CER048A
      ** Local Tax                                                                           CER048A
      *                                                                                      CER048A
     C     CCY           IFEQ      BJCYCD                                                    CER048A
     C                   MOVEL     ##TAXA        ##D(20)                                     CER048A
     C                   MOVE      A6NBDP        ##D(20)                                     CER048A
     C                   ELSE                                                                CER048A
      *                                                                                      CER048A
     C                   Z-ADD     FRSPT         ZRATE1           13 8                       CER048A
     C                   MOVE      FRMDI         ZMDI1             1                         CER048A
     C                   MOVE      FRDEC         ZCDPI                                       CER048A
      *                                                                                      CER048A
     C                   MOVE      BJCYCD        PCCY                                        CER048A
     C                   EXSR      SRCURR                                                    CER048A
     C                   Z-ADD     A6SPRT        ZRATE2           13 8                       CER048A
     C                   MOVE      A6MDIN        ZMDI2             1                         CER048A
     C                   MOVE      A6NBDP        ZCDPO                                       CER048A
      *                                                                                      CER048A
     C                   EXSR      ZXRATE                                                    CER048A
      *                                                                                      CER048A
     C                   Z-ADD     ##TAXA        ZAMTCI                                      CER048A
     C                   Z-ADD     ZRATEX        ZEXCH                                       CER048A
     C                   MOVE      ZMDIX         ZMD                                         CER048A
      *                                                                                      CER048A
     C                   EXSR      ZCONVN                                                    CER048A
     C                   MOVEL     ZAMTCO        ##D(20)                                     CER048A
     C                   MOVE      A6NBDP        ##D(20)                                     CER048A
     C                   ENDIF                                                               CER048A
      *                                                                                     BUG23880
      **  Accumulate RDE's and associated data and output to                                BUG23880
      **  PF/CGUDTAPD.                                                                      BUG23880
      *                                                                                     BUG23880
     C                   EXSR      SRADTA                                                   BUG23880
     C                   MOVEL     ##SDS         ##ADS                                      BUG23880
      *                                                                                     BUG23880
      **  Retrieve RDE information for RDEs in group set                                    BUG23880
      *                                                                                     BUG23880
     C                   Z-ADD     21            ##RDEN                                     BUG23880
     C                   EXSR      SRRRDE                                                   BUG23880
      *                                                                                     BUG23880
      ** Resident/ Non-Resident Flag                                                        BUG23880
      *                                                                                     BUG23880
     C                   MOVEL     RESID         ##D(1)                                     BUG23880
      *                                                                                    BUG23799A
      ** Customer Tax Status                                                               BUG23799A
      *                                                                                    BUG23799A
     C                   MOVEL     WSTAT         ##D(2)                                    BUG23799A
      *                                                                                     AR995867
      ** Interest Payment Frequency                                                         AR995867
      *                                                                                     AR995867
     C                   MOVEL     IPFR          ##D(3)                                     AR995867
      *                                                                                     AR995867
      ** Base Rate Name                                                                     MD030644
      *                                                                                     MD030644
     C                   MOVEL     CCY           ##CYCD                                     MD030644
     C     BRTT          IFEQ      0                                                        MD030644
     C                   MOVEL     *BLANKS       ##D(4)                                     MD030644
     C                   ELSE                                                               MD030644
     C                   MOVEL     BRTT          ##BSRC                                     MD030644
     C                   CALL      'AOBSRTR0'                                               MD030644
     C                   PARM      *BLANKS       ##RTCD                                     MD030644
     C                   PARM      '*KEY   '     ##OPTN                                     MD030644
     C                   PARM                    ##CYCD                                     MD030644
     C                   PARM                    ##BSRC                                     MD030644
     C     SDBSRT        PARM      SDBSRT        DSSDY                                      MD030644
      *                                                                                     MD030644
      ** DATABASE ERROR                                                                     MD030644
      *                                                                                     MD030644
     C     ##RTCD        IFNE      *BLANK                                                   MD030644
     C                   MOVEL     'SDBSRTPD'    W0FILE                                     MD030644
     C                   MOVEL     ##BSRC        W0KEY                                      MD030644
     C                   Z-ADD     62            W0ERNB                                     MD030644
     C                   MOVEL     'MEM5004'     W0MSGD                                     MD030644
     C                   MOVEL     'MIDAS  '     W0MSGF                                     MD030644
     C                   EXSR      SRERR                                                    MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
     C                   MOVEL     BABSRN        ##D(4)                                     MD030644
     C                   ENDIF                                                              MD030644
      *                                                                                     MD030644
      ** Spread Rate                                                                        MD030644
      *                                                                                     MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
     C                   MOVEL     RTSP          R#DATA                                     MD030644
     C                   MOVEL     R#DATA        ##D(5)                                     MD030644
     C                   MOVEL     *BLANKS       R#DATA                                     MD030644
      *                                                                                     MD030644
      ** Interest Calculation Basis                                                         MD030644
      *                                                                                     MD030644
     C                   MOVEL     ICBS          ##D(6)                                     MD030644
      *                                                                                      CER048A
     C/COPY WNCPYSRC,CG4110C052
      *                                                                                       CER050
     C     CER050        IFEQ      'Y'                                                        CER050
     C                   EXSR      ZI@APR                                                     CER050
     C                   ENDIF                                                                CER050
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXLADS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OPTD                                         *
      * Function    :  Option To Date                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@OPTD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_OPTD'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_OPTD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Option To Date
     C                   MOVEL     OTDT          ##D(1)
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXOPTD        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OTH1                                         *
      * Function    :  Other Deal Details                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@OTH1        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_OTH1'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_OTH1'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Cancel/Amend
      *
     C     DTCHTP        IFEQ      'R'
     C     DTCHTP        OREQ      'A'
     C                   MOVEL     DTCHTP        ##D(1)
     C                   END
      *
      ** Federal funds
     C                   EXSR      SRDFED
     C                   MOVEL     ##FEDL        ##D(2)                         FROM SR/SRDFED
      *
      ** Auto-transmission
     C                   EXSR      SRDAUT
     C                   MOVEL     ##AUTO        ##D(3)                         FROM SR/SRDAUT
      *
      ** Deal Type
     C                   MOVEL     DTYP          ##D(4)
      *
      ** Deal Sub Type
     C                   MOVEL     DLST          ##D(5)
     C/COPY WNCPYSRC,CG4110C033
      *                                                                                       CDL016
      ** Blocked Flag                                                                         CDL016
     C                   MOVEL     FSBLKA        ##D(6)                                       CDL016
      *                                                                                       CDL016
      ** Fix Base Rate flag                                                                   CDL019
     C                   MOVEL     FSFBRT        ##D(7)                                       CDL019
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXOTH1        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@OTH2                                         *
      * Function    :  Other Deal Details                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@OTH2        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_OTH2'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_OTH2'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Cancel/Amend
      *
     C     DTCHTP        IFEQ      'R'
     C     DTCHTP        OREQ      'A'
     C                   MOVEL     DTCHTP        ##D(1)
     C                   END
      *
      ** Federal funds
     C                   EXSR      SRDFED
     C                   MOVEL     ##FEDL        ##D(2)                         FROM SR/SRDFED
      *
      ** Auto-transmission
     C                   EXSR      SRDAUT
     C                   MOVEL     ##AUTO        ##D(3)                         FROM SR/SRDAUT
      *
      ** Deal Type
     C                   MOVEL     DTYP          ##D(4)
      *
      ** Deal Sub Type
     C                   MOVEL     DLST          ##D(5)
      *
      ** Deal Amendment Type
     C                   MOVEL     AMTP          ##D(6)
     C/COPY WNCPYSRC,CG4110C034
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXOTH2        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************                       CDL094
     C/SPACE 5                                                                                CDL094
      *****************************************************************                       CDL094
      * Subroutine  :  RTVRCV                                         *                       CDL094
      * Function    :  Retrieve Receive Details for CDL094            *                       CDL094
      * Called by   :                                                 *                       CDL094
      * Calls       :                                                 *                       CDL094
      *                                                               *                       CDL094
      *****************************************************************                       CDL094
     C     RTVRCV        BEGSR                                                                CDL094
      *                                                                                       CDL094
      **  Set up subroutine stack name                                                        CDL094
     C                   ADD       1             Q                                            CDL094
     C                   MOVEL     'RTVRCV'      @STK(Q)                                      CDL094
      *                                                                                       CDL094
      *................................................................                       CDL094
      *                                                                                       CDL094
      **  Retrieve subroutine specific data.                                                  CDL094
     C     1             OCCUR     ##SRDT                                                     CDL094
     C                   MOVEL     ##SPAT        S#PATH                                       CDL094
      *                                                                                       CDL094
      **  Set up Path.                                                                        CDL094
     C                   MOVEL     '\RTVRCV'     ##PNAM                                       CDL094
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL094
     C                   EXSR      PSHGRS                                                     CDL094
      *                                                                                       CDL094
      **  Retrieve RDE information for RDEs in group set                                      CDL094
      *                                                                                       CDL094
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL094
     C                   Z-ADD     1             ##RDEN                                       CDL094
     C                   EXSR      SRRRDE                                                     CDL094
      *                                                                                       CDL094
      ** Retrieve Receive Details (Bank to Bank information, Intermediary,                    CDL094
      ** Beneficiary, Delivery Agent, Account lines)                                          CDL094
     C                   MOVEL(P)  RBTB1         ##D(1)                                       CDL094
     C                   MOVEL(P)  RBTB2         ##D(2)                                       CDL094
     C                   MOVEL(P)  RBTB3         ##D(3)                                       CDL094
     C                   MOVEL(P)  RBTB4         ##D(4)                                       CDL094
     C                   MOVEL(P)  RBTB5         ##D(5)                                       CDL094
     C                   MOVEL(P)  RBTB6         ##D(6)                                       CDL094
      *                                                                                       CDL094
     C     RSTM          IFEQ      08                                                         CDL094
      *                                                                                       CDL094
      ** Call AONOSTR1 to retrieve receive details                                            CDL094
     C                   CALL      'AONOSTR1'                                                 CDL094
     C                   PARM      '*MSG   '     ##RTCD                                       CDL094
     C                   PARM      '*KEY   '     ##OPTN                                       CDL094
     C                   PARM      *BLANKS       @NSKYA            6                          CDL094
     C                   PARM                    @NSKYB            3                          CDL094
     C                   PARM      *BLANKS       @NSKYC           10                          CDL094
     C                   PARM      *BLANKS       @NSKYD            2                          CDL094
     C                   PARM      RONS          @NSKYE            2                          CDL094
     C                   PARM      *BLANKS       @KEYF             3                          CDL094
     C                   PARM      *BLANKS       @KEYG            10                          CDL094
     C                   PARM      *BLANKS       @KEYH             1                          CDL094
     C     SDNOST        PARM      SDNOST        DSSDY                                        CDL094
     C     ##RTCD        IFEQ      *BLANK                                                     CDL094
     C                   MOVEL(P)  A7RF56        ##D(7)                                       CDL094
     C                   MOVEL(P)  A7RA56        ##D(8)                                       CDL094
     C                   MOVEL(P)  A7RF57        ##D(9)                                       CDL094
     C                   MOVEL(P)  A7RA57        ##D(10)                                      CDL094
     C                   MOVEL(P)  A7RF58        ##D(11)                                      CDL094
     C                   MOVEL(P)  A7RA58        ##D(12)                                      CDL094
     C                   ENDIF                                                                CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CDL094
      **  Accumulate RDE's and associated data and output to                                  CDL094
      **  PF/CGUDTAPD.                                                                        CDL094
     C                   EXSR      SRADTA                                                     CDL094
     C                   EXSR      SRODTA                                                     CDL094
      *                                                                                       CDL094
      *................................................................                       CDL094
      *                                                                                       CDL094
     C     EXRCV         TAG                                                                  CDL094
      *                                                                                       CDL094
      **  Unwind subroutine stack name                                                        CDL094
     C                   EXSR      POPGRS                                                     CDL094
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL094
     C                   SUB       1             Q                                            CDL094
      *                                                                                       CDL094
     C                   ENDSR                                                                CDL094
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@PAY@                                         *
      * Function    :  Payable by us/payable by them/payable by us+them
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@PAY@        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_PAY?'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_PAY?'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Payable by us.
     C                   MOVEL     'N'           ##D(1)
     C     PIAMT         IFGT      *ZEROS
     C     DTYP          IFEQ      'RS'
     C     PIAMT         ANDGE     RIAMT
     C     DTYP          OREQ      'RX'
     C     RIAMT         ANDEQ     *ZEROS
     C                   MOVEL     'Y'           ##D(1)
     C                   ENDIF
     C                   ENDIF
      *
      ** Payable by them.
     C                   MOVEL     'N'           ##D(2)
     C     RIAMT         IFGT      *ZEROS
     C     DTYP          IFEQ      'RS'
     C     RIAMT         ANDGT     PIAMT
     C     DTYP          OREQ      'RX'
     C     PIAMT         ANDEQ     *ZEROS
     C                   MOVEL     'Y'           ##D(2)
     C                   ENDIF
     C                   ENDIF
      *
      ** Payable by us and them.
     C                   MOVEL     'N'           ##D(3)
     C     DTYP          IFEQ      'RX'
     C     PIAMT         ANDGT     *ZEROS
     C     RIAMT         ANDGT     *ZEROS
     C                   MOVEL     'Y'           ##D(3)
     C                   ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXPAY@        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@PAYS                                         *
      * Function    :  Payment Settlement Instructions                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@PAYS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_PAYS'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     WFFLG         IFNE      'Y'                                                        CSW208
     C     1             OCCUR     ##SRDT
     C                   ELSE                                                                 CSW208
     C     5             OCCUR     ##SRDT                                                     CSW208
     C                   ENDIF                                                                CSW208
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_PAYS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CSW208
      **  Set up binds from passed in values if fee details exist                             CSW208
      *                                                                                       CSW208
     C     WFFLG         IFEQ      'Y'                                                        CSW208
     C                   Z-ADD     S#PBIN        ##PBIN                                       CSW208
     C                   Z-ADD     S#TBIN        ##TBIN                                       CSW208
     C                   ENDIF                                                                CSW208
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** DETERMINE SETTLEMENT INSTRUCTION FIELDS
      *
     C                   MOVEL     'P'           ##PYRC                         *Pay/Receive
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     ##PSCY        ANDNE     *BLANKS                                                    150163
     C                   MOVEL     ##PSCY        ##CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     ##CCY         ##CCY                          *Settlemt currncy
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C                   MOVEL     'N'           ##ROLL                         *Rollover
      *
     C                   MOVEL     PSTM          ##SETP                         *Settlemt type
     C                   MOVEL     POBR          ##STBR                         *Settlemt branch
     C                   MOVEL     PONS          ##OURN                         *Our nostro/ A/C
     C     RVNO          IFNE      *BLANK                                       * RECEIVING MT100
     C     RCRN          IFNE      *BLANK                                       * RECEIVER CORRES
     C                   MOVEL     RCRN          ##THRN                         *Their nostro
     C                   ELSE
     C                   MOVEL     *HIVAL        ##THRN                         *Their nostro
     C                   END                                                     = OUR NOSTRO
     C                   ELSE
     C                   MOVEL     AWBN          ##THRN                         *Their nostro
     C                   END
     C                   MOVEL     BENN          ##FACO                         *For account of
     C                   EXSR      SRDSET
      *
      **  Payment - Our A/C - Line 1
     C                   MOVEL     ##OAC1        ##D(1)
      *
      **  Payment - Our A/C - Line 2
     C                   MOVEL     ##OAC2        ##D(2)
      *
      **  Payment - Our Nostro Name
     C                   MOVEL     ##ONN         ##D(3)
      *
      **  Payment - Our Nostro Town
     C                   MOVEL     ##ONT         ##D(4)
      *
      **  Payment - Our A/C (Gen.Led.)
     C                   MOVEL     ##OGA         ##D(5)
      *
      **  Payment - Our A/C (Retail)
     C                   MOVEL     ##ORA         ##D(6)
      *
      **  Payment - Their A/C - Line 1
     C                   MOVEL     ##TAC1        ##D(7)
      *
      **  Payment - Their A/C - Line 2
     C                   MOVEL     ##TAC2        ##D(8)
      *
      **  Payment - Their Nostro Name
     C                   MOVEL     ##TNN         ##D(9)
      *
      **  Payment - Their Nostro Town
     C                   MOVEL     ##TNT         ##D(10)
      *
      **  Payment - For A/C Of - Line 1
     C                   MOVEL     ##FAL1        ##D(11)
      *
      **  Payment - For A/C Of - Line 2
     C                   MOVEL     ##FAL2        ##D(12)
      *
      **  Payment - For A/C Of Name
     C                   MOVEL     ##FAN         ##D(13)
      *
      **  Payment - For A/C Of Town
     C                   MOVEL     ##FAT         ##D(14)
      *                                                                                       086864
      **  Special Instructions                                                                086864
     C                   MOVEL     SPI           ##D(15)                                      086864
      *                                                                                       CEU014
     C     ##PSCY        IFNE      *BLANKS                                                    CEU014
      *                                                                                       CEU003
      ** Payment Settlement Currency                                                          CEU003
     C                   MOVEL     ##PSCY        ##D(16)                                      CEU003
      *                                                                                       CEU003
      ** Payment Settlement Currency Description                                              CEU003
     C                   MOVEL     ##PSCY        ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVEL     A6CYNM        ##D(17)                                      CEU003
     C                   ENDIF                                                                CEU014
     C/COPY WNCPYSRC,CG4110C060
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXPAYS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************                       086158
     C/SPACE 5                                                                                086158
      *****************************************************************                       086158
      * Subroutine  :  EX@PAY                                         *                       086158
      * Function    :  Other payment settlement instructions          *                       086158
      *                                                               *                       086158
      * Called by   :                                                 *                       086158
      * Calls       :                                                 *                       086158
      *****************************************************************                       086158
     C     EX@PAY        BEGSR                                                                086158
      *                                                                                       086158
      **  Set up subroutine stack name                                                        086158
     C                   ADD       1             Q                                            086158
     C                   MOVEL     'EX@PAY'      @STK(Q)                                      086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
      **  Retrieve subroutine specific data.                                                  086158
     C     1             OCCUR     ##SRDT                                                     086158
     C                   MOVEL     ##SPAT        S#PATH                                       086158
      *                                                                                       086158
      **  Set up Path.                                                                        086158
     C                   MOVEL     '\ex_pay'     ##PNAM                                       086158
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       086158
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       086158
      **  Set up data.                                                                        086158
     C                   EXSR      MOVDTA                                                     086158
      *                                                                                       086158
     C                   CALL      'CG4985'                                                   086158
     C                   PARM      *BLANKS       W0RTN             7                          086158
     C                   PARM                    P1PARM                                       086158
     C                   PARM                    P2PARM          140            Path          086158
     C                   PARM                    W0CMT             3                          086158
     C                   PARM                    P3PARM                                       086158
     C                   PARM                    ##REFR                         Reference Nam CCG015
     C                   PARM                    P@ICR                          Increment No  CCG015
     C                   PARM      'N'           ##MAST                         Call Master P CCG015
      *                                                                                       086158
      **  Reset Sequence number.                                                              086158
     C                   Z-ADD     P1OSEQ        ##OSEQ                                       086158
     C                   Z-ADD     P1TBIN        DETBIN                                       086158
     C                   Z-ADD     P1PBIN        DEPBIN                                       086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C     EXXPAY        TAG                                                                  086158
      *                                                                                       086158
      **  Unwind subroutine stack name                                                        086158
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      086158
     C                   SUB       1             Q                                            086158
      *                                                                                       086158
     C                   ENDSR                                                                086158
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RECS                                         *
      * Function    :  Receive Settlement Instructions                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@RECS        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_RECS'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     WFFLG         IFNE      'Y'                                                        CSW208
     C     1             OCCUR     ##SRDT
     C                   ELSE                                                                 CSW208
     C     4             OCCUR     ##SRDT                                                     CSW208
     C                   ENDIF                                                                CSW208
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_RECS'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CSW208
      **  Set up binds from passed in values if fee details exist                             CSW208
      *                                                                                       CSW208
     C     WFFLG         IFEQ      'Y'                                                        CSW208
     C                   Z-ADD     S#PBIN        ##PBIN                                       CSW208
     C                   Z-ADD     S#TBIN        ##TBIN                                       CSW208
     C                   ENDIF                                                                CSW208
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** DETERMINE SETTLEMENT INSTRUCTION FIELDS
      *
     C                   MOVEL     'R'           ##PYRC                         *Pay/Receive
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     ##RSCY        ANDNE     *BLANKS                                                    150163
     C                   MOVEL     ##RSCY        ##CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     ##CCY         ##CCY                          *Settlemt currncy
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C                   MOVEL     'N'           ##ROLL                         *Rollover
      *
     C                   MOVEL     RSTM          ##SETP                         *Settlemt type
     C                   MOVEL     ROBR          ##STBR                         *Settlemt branch
     C                   MOVEL     RONS          ##OURN                         *Our nostro/ A/C
     C                   MOVEL     RIBN          ##THRN                         *Their nostro
     C                   MOVEL     *BLANK        ##FACO                         *For account of
     C                   EXSR      SRDSET
      *
      **  Receive - Our A/C - Line 1
     C                   MOVEL     ##OAC1        ##D(1)
      *
      **  Receive - Our A/C - Line 2
     C                   MOVEL     ##OAC2        ##D(2)
      *
      **  Receive - Our Nostro Name
     C                   MOVEL     ##ONN         ##D(3)
      *
      **  Receive - Our Nostro Town
     C                   MOVEL     ##ONT         ##D(4)
      *
      **  Receive - Our A/C (Gen.Led.)
     C                   MOVEL     ##OGA         ##D(5)
      *
      **  Receive - Our A/C (Retail)
     C                   MOVEL     ##ORA         ##D(6)
      *
      **  Receive - Their A/C - Line 1
     C                   MOVEL     ##TAC1        ##D(7)
      *
      **  Receive - Their A/C - Line 2
     C                   MOVEL     ##TAC2        ##D(8)
      *
      **  Receive - Their Nostro Name
     C                   MOVEL     ##TNN         ##D(9)
      *
      **  Receive - Their Nostro Town
     C                   MOVEL     ##TNT         ##D(10)
      *                                                                                       CEU014
     C     ##RSCY        IFNE      *BLANKS                                                    CEU014
      *                                                                                       CEU003
      ** Receipt Settlement Currency                                                          CEU003
     C                   MOVEL     ##RSCY        ##D(11)                                      CEU003
      *                                                                                       CEU003
      ** Receipt Settlement Currency Description                                              CEU003
     C                   MOVEL     ##RSCY        ##CCY                                        CEU003
     C                   EXSR      SRDCDT                                                     CEU003
     C                   MOVEL     A6CYNM        ##D(12)                                      CEU003
     C                   ENDIF                                                                CEU014
     C/COPY WNCPYSRC,CG4110C061
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXRECS        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************                       086158
     C/SPACE 5                                                                                086158
      *****************************************************************                       086158
      * Subroutine  :  EX@REC                                         *                       086158
      * Function    :  Other receipt settlement instructions          *                       086158
      *                                                               *                       086158
      * Called by   :                                                 *                       086158
      * Calls       :                                                 *                       086158
      *****************************************************************                       086158
     C     EX@REC        BEGSR                                                                086158
      *                                                                                       086158
      **  Set up subroutine stack name                                                        086158
     C                   ADD       1             Q                                            086158
     C                   MOVEL     'EX@REC'      @STK(Q)                                      086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
      **  Retrieve subroutine specific data.                                                  086158
     C     1             OCCUR     ##SRDT                                                     086158
     C                   MOVEL     ##SPAT        S#PATH                                       086158
      *                                                                                       086158
      **  Set up Path.                                                                        086158
     C                   MOVEL     '\ex_rec'     ##PNAM                                       086158
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       086158
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       086158
      **  Set up data.                                                                        086158
     C                   EXSR      MOVDTB                                                     086158
      *                                                                                       086158
     C                   CALL      'CG4975'                                                   086158
     C                   PARM      *BLANKS       W0RTN             7                          086158
     C                   PARM                    P6PARM                                       086158
     C                   PARM                    P4PARM          140            Path          086158
     C                   PARM                    W0CMT             3                          086158
     C                   PARM                    P5PARM                                       086158
     C                   PARM                    ##REFR                         Reference Nam CCG015
     C                   PARM                    P@ICR                          Increment No  CCG015
     C                   PARM      'N'           ##MAST                         Call Master P CCG015
      *                                                                                       086158
      **  Reset Sequence number.                                                              086158
     C                   Z-ADD     R1OSEQ        ##OSEQ                                       086158
     C                   Z-ADD     R1TBIN        DETBIN                                       086158
     C                   Z-ADD     R1PBIN        DEPBIN                                       086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C     EXXREC        TAG                                                                  086158
      *                                                                                       086158
      **  Unwind subroutine stack name                                                        086158
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      086158
     C                   SUB       1             Q                                            086158
      *                                                                                       086158
     C                   ENDSR                                                                086158
     C*****************************************************************
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  D@RMAC                                         *                       CDL018
      * Function    :  Extract RECEIPT Multiple Settlement Account    *                       CDL018
      * Called by   :  D07LAD                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     D@RMAC        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'D_RMAC'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Save current path                                                                   CDL018
     C                   MOVEL     *BLANK        SVSPAT           70                          CDL018
     C                   MOVEL     S#PATH        SVSPAT                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\D_RMAC'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Store Path                                                                          CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     S#PATH        ##SPAT                                       CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C*                    MOVEL@STK,Q    ##GRPS                                              CDL018
     C*                    Z-ADD1         ##RDEN                                              CDL018
     C*                    EXSR SRRRDE                                                        CDL018
      *                                                                                       CDL018
      ** Receipt - More A/C indicator                                                         CDL018
     C                   EXSR      D@RMDT                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 1 Details                                                          CDL018
     C     RAC01         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC01                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 2 Details                                                          CDL018
     C     RAC02         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC02                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 3 Details                                                          CDL018
     C     RAC03         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC03                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 4 Details                                                          CDL018
     C     RAC04         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC04                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 5 Details                                                          CDL018
     C     RAC05         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC05                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 6 Details                                                          CDL018
     C     RAC06         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC06                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 7 Details                                                          CDL018
     C     RAC07         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC07                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 8 Details                                                          CDL018
     C     RAC08         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC08                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 9 Details                                                          CDL018
     C     RAC09         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC09                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 10 Details                                                         CDL018
     C     RAC10         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC10                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 11 Details                                                         CDL018
     C     RAC11         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC11                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Receipt - Account 12 Details                                                         CDL018
     C     RAC12         IFNE      *BLANK                                                     CDL018
     C                   EXSR      R@AC12                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EXRMAC        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Restore saved path                                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     SVSPAT        ##SPAT                                       CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  D@RMDT                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Main Details          *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     D@RMDT        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'd_RMDT'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\d_RMDT'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - More A/C indicator                                                         CDL018
     C                   MOVEL     FSRMAC        ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Unallocated A/C                                                            CDL018
     C                   MOVEL     RUAC          ##D(2)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EXRMDT        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC01                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 01 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC01        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC01'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC01'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 1                                                                  CDL018
     C                   MOVEL     RAC01         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 1                                                          CDL018
     C                   MOVEL     RAL01         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 1                                                               CDL018
     C                   MOVEL     RPC01         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 1                                                                   CDL018
     C                   MOVEL     RAL01         ##ALOC            1                          CDL018
     C                   Z-ADD     RPC01         ##PCTG            6 0                        CDL018
     C                   Z-ADD     RAM01         ##AMNT           13 0                        CDL018
     C                   Z-ADD     IPR01         ##INPR           13 0                        CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM01                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM01         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC01        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC02                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 02 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC02        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC02'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC02'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 2                                                                  CDL018
     C                   MOVEL     RAC02         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 2                                                          CDL018
     C                   MOVEL     RAL02         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 2                                                               CDL018
     C                   MOVEL     RPC02         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 2                                                                   CDL018
     C                   MOVEL     RAL02         ##ALOC                                       CDL018
     C                   Z-ADD     RPC02         ##PCTG                                       CDL018
     C                   Z-ADD     RAM02         ##AMNT                                       CDL018
     C                   Z-ADD     IPR02         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM02                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM02         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC02        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC03                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 03 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC03        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC03'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC03'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 3                                                                  CDL018
     C                   MOVEL     RAC03         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 3                                                          CDL018
     C                   MOVEL     RAL03         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 3                                                               CDL018
     C                   MOVEL     RPC03         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 3                                                                   CDL018
     C                   MOVEL     RAL03         ##ALOC                                       CDL018
     C                   Z-ADD     RPC03         ##PCTG                                       CDL018
     C                   Z-ADD     RAM03         ##AMNT                                       CDL018
     C                   Z-ADD     IPR03         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM03                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM03         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC03        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC04                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 04 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC04        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC04'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC04'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 4                                                                  CDL018
     C                   MOVEL     RAC04         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 4                                                          CDL018
     C                   MOVEL     RAL04         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 4                                                               CDL018
     C                   MOVEL     RPC04         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 4                                                                   CDL018
     C                   MOVEL     RAL04         ##ALOC                                       CDL018
     C                   Z-ADD     RPC04         ##PCTG                                       CDL018
     C                   Z-ADD     RAM04         ##AMNT                                       CDL018
     C                   Z-ADD     IPR04         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM04                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM04         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC04        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC05                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 05 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC05        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC05'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC05'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 5                                                                  CDL018
     C                   MOVEL     RAC05         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 5                                                          CDL018
     C                   MOVEL     RAL05         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 5                                                               CDL018
     C                   MOVEL     RPC05         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 5                                                                   CDL018
     C                   MOVEL     RAL05         ##ALOC                                       CDL018
     C                   Z-ADD     RPC05         ##PCTG                                       CDL018
     C                   Z-ADD     RAM05         ##AMNT                                       CDL018
     C                   Z-ADD     IPR05         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM05                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM05         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC05        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC06                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 06 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC06        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC06'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC06'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 6                                                                  CDL018
     C                   MOVEL     RAC06         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 6                                                          CDL018
     C                   MOVEL     RAL06         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 6                                                               CDL018
     C                   MOVEL     RPC06         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 6                                                                   CDL018
     C                   MOVEL     RAL06         ##ALOC                                       CDL018
     C                   Z-ADD     RPC06         ##PCTG                                       CDL018
     C                   Z-ADD     RAM06         ##AMNT                                       CDL018
     C                   Z-ADD     IPR06         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM06                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM06         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC06        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC07                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 07 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC07        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC07'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC07'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 7                                                                  CDL018
     C                   MOVEL     RAC07         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 7                                                          CDL018
     C                   MOVEL     RAL07         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 7                                                               CDL018
     C                   MOVEL     RPC07         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 7                                                                   CDL018
     C                   MOVEL     RAL07         ##ALOC                                       CDL018
     C                   Z-ADD     RPC07         ##PCTG                                       CDL018
     C                   Z-ADD     RAM07         ##AMNT                                       CDL018
     C                   Z-ADD     IPR07         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM07                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM07         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC07        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC08                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 08 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC08        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC08'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC08'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 8                                                                  CDL018
     C                   MOVEL     RAC08         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 8                                                          CDL018
     C                   MOVEL     RAL08         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 8                                                               CDL018
     C                   MOVEL     RPC08         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 8                                                                   CDL018
     C                   MOVEL     RAL08         ##ALOC                                       CDL018
     C                   Z-ADD     RPC08         ##PCTG                                       CDL018
     C                   Z-ADD     RAM08         ##AMNT                                       CDL018
     C                   Z-ADD     IPR08         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM08                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM08         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC08        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC09                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 09 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC09        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC09'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC09'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 9                                                                  CDL018
     C                   MOVEL     RAC09         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 9                                                          CDL018
     C                   MOVEL     RAL09         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 9                                                               CDL018
     C                   MOVEL     RPC09         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 9                                                                   CDL018
     C                   MOVEL     RAL09         ##ALOC                                       CDL018
     C                   Z-ADD     RPC09         ##PCTG                                       CDL018
     C                   Z-ADD     RAM09         ##AMNT                                       CDL018
     C                   Z-ADD     IPR09         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM09                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM09         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC09        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC10                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 10 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC10        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC10'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC10'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 10                                                                 CDL018
     C                   MOVEL     RAC10         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 10                                                         CDL018
     C                   MOVEL     RAL10         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 10                                                              CDL018
     C                   MOVEL     RPC10         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 10                                                                  CDL018
     C                   MOVEL     RAL10         ##ALOC                                       CDL018
     C                   Z-ADD     RPC10         ##PCTG                                       CDL018
     C                   Z-ADD     RAM10         ##AMNT                                       CDL018
     C                   Z-ADD     IPR10         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM10                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM10         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC10        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC11                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 11 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC11        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC11'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC11'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 11                                                                 CDL018
     C                   MOVEL     RAC11         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 11                                                         CDL018
     C                   MOVEL     RAL11         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 11                                                              CDL018
     C                   MOVEL     RPC11         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 11                                                                  CDL018
     C                   MOVEL     RAL11         ##ALOC                                       CDL018
     C                   Z-ADD     RPC11         ##PCTG                                       CDL018
     C                   Z-ADD     RAM11         ##AMNT                                       CDL018
     C                   Z-ADD     IPR11         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM11                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM11         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC11        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  R@AC12                                         *                       CDL018
      * Function    :  Extract RECEIVE Mult A/C Account 12 Details    *                       CDL018
      * Called by   :  D@RMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     R@AC12        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'RMAC12'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\RMAC12'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Receipt - Account 12                                                                 CDL018
     C                   MOVEL     RAC12         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Allocation Type 12                                                         CDL018
     C                   MOVEL     RAL12         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Percentage 12                                                              CDL018
     C                   MOVEL     RPC12         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Receipt - Amount 12                                                                  CDL018
     C                   MOVEL     RAL12         ##ALOC                                       CDL018
     C                   Z-ADD     RPC12         ##PCTG                                       CDL018
     C                   Z-ADD     RAM12         ##AMNT                                       CDL018
     C                   Z-ADD     IPR12         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        RAM12                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     RAM12         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     ERAC12        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  D@PMAC                                         *                       CDL018
      * Function    :  Extract PAYMENT Multiple Settlement Account    *                       CDL018
      * Called by   :  D07LAD                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     D@PMAC        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'D_PMAC'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Save current path                                                                   CDL018
     C                   MOVEL     S#PATH        SVSPAT                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\D_PMAC'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Store Path                                                                          CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     S#PATH        ##SPAT                                       CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C*                    MOVEL@STK,Q    ##GRPS                                              CDL018
     C*                    Z-ADD1         ##RDEN                                              CDL018
     C*                    EXSR SRRRDE                                                        CDL018
      *                                                                                       CDL018
      ** Payment - More A/C indicator                                                         CDL018
     C                   EXSR      D@PMDT                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 1 Details                                                          CDL018
     C     PAC01         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC01                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 2 Details                                                          CDL018
     C     PAC02         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC02                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 3 Details                                                          CDL018
     C     PAC03         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC03                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 4 Details                                                          CDL018
     C     PAC04         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC04                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 5 Details                                                          CDL018
     C     PAC05         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC05                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 6 Details                                                          CDL018
     C     PAC06         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC06                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 7 Details                                                          CDL018
     C     PAC07         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC07                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 8 Details                                                          CDL018
     C     PAC08         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC08                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 9 Details                                                          CDL018
     C     PAC09         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC09                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 10 Details                                                         CDL018
     C     PAC10         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC10                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 11 Details                                                         CDL018
     C     PAC11         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC11                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      ** Payment - Account 12 Details                                                         CDL018
     C     PAC12         IFNE      *BLANK                                                     CDL018
     C                   EXSR      P@AC12                                                     CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EXPMAC        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Restore saved path                                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     SVSPAT        ##SPAT                                       CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  D@PMDT                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Main Details          *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     D@PMDT        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'd_PMDT'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\d_PMDT'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - More A/C indicator                                                         CDL018
     C                   MOVEL     FSPMAC        ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Unallocated A/C                                                            CDL018
     C                   MOVEL     PUAC          ##D(2)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EXPMDT        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC01                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 01 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC01        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC01'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC01'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 1                                                                  CDL018
     C                   MOVEL     PAC01         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 1                                                          CDL018
     C                   MOVEL     PAL01         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 1                                                               CDL018
     C                   MOVEL     PPC01         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 1                                                                   CDL018
     C                   MOVEL     PAL01         ##ALOC                                       CDL018
     C                   Z-ADD     PPC01         ##PCTG                                       CDL018
     C                   Z-ADD     PAM01         ##AMNT                                       CDL018
     C                   Z-ADD     IPR01         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM01                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM01         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC01        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC02                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 02 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC02        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC02'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC02'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 2                                                                  CDL018
     C                   MOVEL     PAC02         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 2                                                          CDL018
     C                   MOVEL     PAL02         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 2                                                               CDL018
     C                   MOVEL     PPC02         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 2                                                                   CDL018
     C                   MOVEL     PAL02         ##ALOC                                       CDL018
     C                   Z-ADD     PPC02         ##PCTG                                       CDL018
     C                   Z-ADD     PAM02         ##AMNT                                       CDL018
     C                   Z-ADD     IPR02         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM02                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM02         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC02        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC03                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 03 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC03        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC03'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC03'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 3                                                                  CDL018
     C                   MOVEL     PAC03         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 3                                                          CDL018
     C                   MOVEL     PAL03         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 3                                                               CDL018
     C                   MOVEL     PPC03         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 3                                                                   CDL018
     C                   MOVEL     PAL03         ##ALOC                                       CDL018
     C                   Z-ADD     PPC03         ##PCTG                                       CDL018
     C                   Z-ADD     PAM03         ##AMNT                                       CDL018
     C                   Z-ADD     IPR03         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM03                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM03         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC03        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC04                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 04 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC04        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC04'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC04'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 4                                                                  CDL018
     C                   MOVEL     PAC04         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 4                                                          CDL018
     C                   MOVEL     PAL04         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 4                                                               CDL018
     C                   MOVEL     PPC04         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 4                                                                   CDL018
     C                   MOVEL     PAL04         ##ALOC                                       CDL018
     C                   Z-ADD     PPC04         ##PCTG                                       CDL018
     C                   Z-ADD     PAM04         ##AMNT                                       CDL018
     C                   Z-ADD     IPR04         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM04                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM04         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC04        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC05                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 05 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC05        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC05'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC05'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 5                                                                  CDL018
     C                   MOVEL     PAC05         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 5                                                          CDL018
     C                   MOVEL     PAL05         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 5                                                               CDL018
     C                   MOVEL     PPC05         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 5                                                                   CDL018
     C                   MOVEL     PAL05         ##ALOC                                       CDL018
     C                   Z-ADD     PPC05         ##PCTG                                       CDL018
     C                   Z-ADD     PAM05         ##AMNT                                       CDL018
     C                   Z-ADD     IPR05         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM05                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM05         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC05        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC06                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 06 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC06        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC06'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC06'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 6                                                                  CDL018
     C                   MOVEL     PAC06         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 6                                                          CDL018
     C                   MOVEL     PAL06         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 6                                                               CDL018
     C                   MOVEL     PPC06         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 6                                                                   CDL018
     C                   MOVEL     PAL06         ##ALOC                                       CDL018
     C                   Z-ADD     PPC06         ##PCTG                                       CDL018
     C                   Z-ADD     PAM06         ##AMNT                                       CDL018
     C                   Z-ADD     IPR06         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM06                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM06         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC06        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC07                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 07 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC07        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC07'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC07'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 7                                                                  CDL018
     C                   MOVEL     PAC07         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 7                                                          CDL018
     C                   MOVEL     PAL07         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 7                                                               CDL018
     C                   MOVEL     PPC07         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 7                                                                   CDL018
     C                   MOVEL     PAL07         ##ALOC                                       CDL018
     C                   Z-ADD     PPC07         ##PCTG                                       CDL018
     C                   Z-ADD     PAM07         ##AMNT                                       CDL018
     C                   Z-ADD     IPR07         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM07                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM07         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC07        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC08                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 08 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC08        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC08'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC08'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 8                                                                  CDL018
     C                   MOVEL     PAC08         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 8                                                          CDL018
     C                   MOVEL     PAL08         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 8                                                               CDL018
     C                   MOVEL     PPC08         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 8                                                                   CDL018
     C                   MOVEL     PAL08         ##ALOC                                       CDL018
     C                   Z-ADD     PPC08         ##PCTG                                       CDL018
     C                   Z-ADD     PAM08         ##AMNT                                       CDL018
     C                   Z-ADD     IPR08         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM08                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM08         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC08        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC09                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 09 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC09        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC09'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC09'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 9                                                                  CDL018
     C                   MOVEL     PAC09         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 9                                                          CDL018
     C                   MOVEL     PAL09         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 9                                                               CDL018
     C                   MOVEL     PPC09         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 9                                                                   CDL018
     C                   MOVEL     PAL09         ##ALOC                                       CDL018
     C                   Z-ADD     PPC09         ##PCTG                                       CDL018
     C                   Z-ADD     PAM09         ##AMNT                                       CDL018
     C                   Z-ADD     IPR09         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM09                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM09         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC09        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC10                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 10 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC10        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC10'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC10'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 10                                                                 CDL018
     C                   MOVEL     PAC10         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 10                                                         CDL018
     C                   MOVEL     PAL10         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 10                                                              CDL018
     C                   MOVEL     PPC10         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 10                                                                  CDL018
     C                   MOVEL     PAL10         ##ALOC                                       CDL018
     C                   Z-ADD     PPC10         ##PCTG                                       CDL018
     C                   Z-ADD     PAM10         ##AMNT                                       CDL018
     C                   Z-ADD     IPR10         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM10                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM10         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC10        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC11                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 11 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC11        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC11'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC11'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 11                                                                 CDL018
     C                   MOVEL     PAC11         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 11                                                         CDL018
     C                   MOVEL     PAL11         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 11                                                              CDL018
     C                   MOVEL     PPC11         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 11                                                                  CDL018
     C                   MOVEL     PAL11         ##ALOC                                       CDL018
     C                   Z-ADD     PPC11         ##PCTG                                       CDL018
     C                   Z-ADD     PAM11         ##AMNT                                       CDL018
     C                   Z-ADD     IPR11         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM11                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM11         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC11        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  P@AC12                                         *                       CDL018
      * Function    :  Extract PAYMENT Mult A/C Account 12 Details    *                       CDL018
      * Called by   :  D@PMAC                                         *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     P@AC12        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Set up subroutine stack name                                                        CDL018
     C                   ADD       1             Q                                            CDL018
     C                   MOVEL     'PMAC12'      @STK(Q)                                      CDL018
      *                                                                                       CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
      **  Retrieve subroutine specific data.                                                  CDL018
     C     1             OCCUR     ##SRDT                                                     CDL018
     C                   MOVEL     ##SPAT        S#PATH                                       CDL018
      *                                                                                       CDL018
      **  Set up Path.                                                                        CDL018
     C                   MOVEL     '\PMAC12'     ##PNAM                                       CDL018
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL018
     C                   EXSR      PSHGRS                                                     CDL018
      *                                                                                       CDL018
      **  Retrieve RDE information for RDEs in group set                                      CDL018
      *                                                                                       CDL018
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL018
     C                   Z-ADD     1             ##RDEN                                       CDL018
     C                   EXSR      SRRRDE                                                     CDL018
      *                                                                                       CDL018
      ** Payment - Account 12                                                                 CDL018
     C                   MOVEL     PAC12         ##D(1)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Allocation Type 12                                                         CDL018
     C                   MOVEL     PAL12         ##D(2)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Percentage 12                                                              CDL018
     C                   MOVEL     PPC12         ##D(3)                                       CDL018
      *                                                                                       CDL018
      ** Payment - Amount 12                                                                  CDL018
     C                   MOVEL     PAL12         ##ALOC                                       CDL018
     C                   Z-ADD     PPC12         ##PCTG                                       CDL018
     C                   Z-ADD     PAM12         ##AMNT                                       CDL018
     C                   Z-ADD     IPR12         ##INPR                                       CDL018
     C                   EXSR      SRCAMT                                                     CDL018
     C                   Z-ADD     ##AMTA        PAM12                                        CDL018
      *                                                                                       CDL018
      ** Extract amount with the correct decimal place                                        CDL018
     C                   MOVEL     PAM12         ##D(4)                                       CDL018
     C                   MOVEL     CCY           ##CCY                                        CDL018
     C                   EXSR      SRDCDT                                                     CDL018
     C                   MOVE      A6NBDP        ##D(4)                                       CDL018
      *                                                                                       CDL018
      **  Accumulate RDE's and associated data and output to                                  CDL018
      **  PF/CGUDTAPD.                                                                        CDL018
     C                   EXSR      SRADTA                                                     CDL018
     C                   EXSR      SRODTA                                                     CDL018
      *................................................................                       CDL018
      *                                                                                       CDL018
     C     EPAC12        TAG                                                                  CDL018
      *                                                                                       CDL018
      **  Unwind subroutine stack name                                                        CDL018
     C                   EXSR      POPGRS                                                     CDL018
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL018
     C                   SUB       1             Q                                            CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5                                                                                CDL018
      *****************************************************************                       CDL018
      * Subroutine  :  SRCAMT                                         *                       CDL018
      * Function    :  Calculate Amount based on Allocation type      *                       CDL018
      *                and Percentage entered.                        *                       CDL018
      * Called by   :  D@RMAC / D@PMAC                                *                       CDL018
      *                                                               *                       CDL018
      * Calls       :  SRERR                                          *                       CDL018
      *****************************************************************                       CDL018
     C     SRCAMT        BEGSR                                                                CDL018
      *                                                                                       CDL018
      **  Initialise work fields                                                              CDL018
     C                   Z-ADD     0             ##AMTA           13 0                        CDL018
     C                   Z-ADD     0             ##AMTB           19 3                        CDL018
     C                   Z-ADD     0             ##TOTE           13 0                        CDL018
      *                                                                                       CDL018
      **  Process details according to amount allocation                                      CDL018
     C                   SELECT                                                               CDL018
      *----------------------------------------------------------------*                      CDL018
      **  Process interest allocation                                                         CDL018
      *----------------------------------------------------------------*                      CDL018
     C     ##ALOC        WHENEQ    'I'                                                        CDL018
      *                                                                                       CDL018
      **  Amount allocation                                                                   CDL018
     C     ##AMNT        IFNE      0                                                          CDL018
      *                                                                                       CDL018
      **  If maturity confirmation, report remaining interest                                 CDL018
      **  otherwise calculate as a percentage of total interest.                              CDL018
     C     *IN07         IFEQ      *ON                                                        CDL018
     C     ##AMNT        SUB       ##INPR        ##AMTA                                       CDL018
     C                   ELSE                                                                 CDL018
     C     ##AMNT        DIV(H)    TOTI          #1PCTG           12 6                        CDL018
     C     #1PCTG        DIV(H)    100           ##PCTG                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      **    Percentage allocation                                                             CDL018
     C     ##PCTG        IFNE      0                                                          CDL018
     C     ##INTA        MULT(H)   ##PCTG        ##AMTB                                       CDL018
     C     ##AMTB        DIV(H)    100           ##AMTA                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      *----------------------------------------------------------------*                      CDL018
      **  Principal allocation - Maturity confirmation only                                   CDL018
      *----------------------------------------------------------------*                      CDL018
     C     ##ALOC        WHENEQ    'P'                                                        CDL018
     C     *IN07         ANDEQ     *ON                                                        CDL018
      *                                                                                       CDL018
      **    If amount allocation then report amount                                           CDL018
      **    otherwise calculate as a percentage allocation                                    CDL018
     C     ##AMNT        IFNE      0                                                          CDL018
     C                   Z-ADD     ##AMNT        ##AMTA                                       CDL018
     C                   ELSE                                                                 CDL018
     C     PCPL          MULT(H)   ##PCTG        ##AMTB                                       CDL018
     C     ##AMTB        DIV(H)    100           ##AMTA                                       CDL018
     C                   ENDIF                                                                CDL018
      *----------------------------------------------------------------*                      CDL018
      **  Interest & Principal Allocation                                                     CDL018
      *----------------------------------------------------------------*                      CDL018
     C     ##ALOC        WHENEQ    'B'                                                        CDL018
      *                                                                                       CDL018
      **    Amount allocation                                                                 CDL018
     C     ##AMNT        IFNE      0                                                          CDL018
      *                                                                                       CDL018
      **    If maturity confirmation then report any remaining                                CDL018
      **    amount otherwise calculate as a percentage allocation.                            CDL018
     C     *IN07         IFEQ      *ON                                                        CDL018
     C     ##AMNT        SUB       ##INPR        ##AMTA                                       CDL018
     C                   ELSE                                                                 CDL018
     C     PCPL          ADD       TOTI          ##TOTL           15 0                        CDL018
     C     ##AMNT        DIV(H)    ##TOTL        #1PCTG                                       CDL018
     C     #1PCTG        DIV(H)    100           ##PCTG                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
      **    Percentage allocation                                                             CDL018
     C     ##PCTG        IFNE      0                                                          CDL018
     C     PCPL          ADD       TOTI          ##TOTL                                       CDL018
     C     ##TOTL        MULT      ##PCTG        ##AMTB                                       CDL018
     C     ##AMTB        DIV(H)    100           ##AMTA                                       CDL018
     C                   ENDIF                                                                CDL018
      *                                                                                       CDL018
     C                   ENDSL                                                                CDL018
      *                                                                                       CDL018
      **    Accumulate total amount reported                                                  CDL018
     C                   ADD       ##AMTA        ##TOTE                                       CDL018
      *                                                                                       CDL018
     C                   ENDSR                                                                CDL018
      *****************************************************************                       CDL018
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@ROLL                                         *
      * Function    :  Rollover Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@ROLL        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_ROLL'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_ROLL'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Rollover by deal number.
     C                   MOVEL     RBDN          ##D(1)
      *
      ** Determine amount due at maturity of this deal
      *
     C     IPDS          IFEQ      'Y'
     C                   Z-ADD     PCPL          ##W150
     C                   ELSE
     C     PCPL          ADD       TOTI          ##W150
     C                   END
      *
      ** Calculate the Rollover Capital Change
      *
      ****If*Enhanced*MM*Deal*Rollover*is*switched*on*                                 CEU015 145001
      ****and*Rollover*To/From*Currency*is*not*blank*                                  CEU015 145001
      ****then*convert*Rolled*Over*Deal*Amount*to*deal*currency:*                      CEU015 145001
      ***********                                                                      CEU015 145001
     C***********CEU015    IFEQ 'Y'                                                    CEU015 145001
     C***********RTFC      ANDNE*BLANKS                                                CEU015 145001
     C************LIKE     DEFN RBDA      W#RDBA                                       CEU015 145001
     C***********          Z-ADDRBDA      W#RDBA                                       CEU015 145001
     C***********          CALL 'EU0200'                                               CEU015 145001
     C***********          PARM *BLANKS   P@RTCD  7 Return Code                        CEU015 145001
     C***********          PARM W#RDBA    P@FRAM 183FROM Ccy Amount                    CEU015 145001
     C***********          PARM RTFC      P@FRCY  3 FROM Currency                      CEU015 145001
     C***********          PARM CCY       P@TOCY  3 TO Currency                        CEU015 145001
     C***********          PARM           P@OUTA 150Outright Amount                    CEU015 145001
     C***********          PARM           P@INTA 183Interim Amount                     CEU015 145001
     C***********          PARM           P@EXRT 159Exchange Rate                      CEU015 145001
     C***********          PARM           P@MDIN  1 Mult/Div Ind.                      CEU015 145001
      ***********                                                                      CEU015 145001
      ****Database*error*handling:********************************                     CEU015 145001
      ***********                                                                      CEU015 145001
     C***********P@RTCD    IFEQ '*ERROR*'                                              CEU015 145001
     C***********          MOVEL'EU0200  'W0FILE                                       CEU015 145001
     C***********          MOVEL'*CALL   'W0KEY     ***************                    CEU015 145001
     C***********          Z-ADD32        W0ERNB    * DB ERROR 32 *                    CEU015 145001
     C***********          MOVEL'MEM5003' W0MSGD    ***************                    CEU015 145001
     C***********          MOVEL'MIDAS  ' W0MSGF                                       CEU015 145001
     C***********          EXSR SRERR                                                  CEU015 145001
      ***********                                                                      CEU015 145001
      ***Otherwise,*save*Rolled*Over*Deal*Amount*in*deal*ccy*as*W#R                    CEU015 145001
      ***********                                                                      CEU015 145001
     C***********          ELSE                                                        CEU015 145001
     C***********          MOVE P@OUTA    W#RDBA                                       CEU015 145001
     C***********          SUB  W#RDBA    ##W150                                       CEU015 145001
     C***********          ENDIF                                                       CEU015 145001
      *                                                                                CEU015 145001
     C***********          ELSE                                                        CEU015 145001
     C                   SUB       RBDA          ##W150
     C***********          ENDIF                                                       CEU015 145001
      *                                                                                       CEU015
     C     ##W150        IFLT      0
     C                   Z-SUB     ##W150        ##W150
     C                   MOVE      'IN'          ##INDE            2
     C                   ELSE
     C                   MOVE      'DE'          ##INDE
     C                   END
      *
     C                   MOVEL     ##W150        ##D(2)
     C                   MOVEL     CCY           ##CCY
     C                   EXSR      SRDCDT
     C/COPY WNCPYSRC,CG4110C101
     C                   MOVE      A6NBDP        ##D(2)
      *
      ** Rollover Capital Indicator
     C                   MOVEL     ##INDE        ##D(3)
      *                                                                                       CEU015
      ** Rolled over equivalent amount                                                        CEU015
      *                                                                                       CEU015
     C     CEU015        IFEQ      'Y'                                                        CEU015
     C     RTFC          ANDNE     *BLANKS                                                    CEU015
     C***********          MOVELW#RDBA    ##D,4                                        CEU015 145001
     C                   MOVEL     RBDA          ##D(4)                                       145001
     C                   MOVEL     CCY           ##CCY                                        CEU015
     C                   EXSR      SRDCDT                                                     CEU015
     C/COPY WNCPYSRC,CG4110C102
     C                   MOVE      A6NBDP        ##D(4)                                       CEU015
     C                   ENDIF                                                                CEU015
      *                                                                                       CEU015
      ** Rolled over equivalent currency                                                      CEU015
      *                                                                                       CEU015
     C     CEU015        IFEQ      'Y'                                                        CEU015
     C     RTFC          ANDNE     *BLANKS                                                    CEU015
     C                   MOVEL     CCY           ##D(5)                                       CEU015
     C                   ENDIF                                                                CEU015
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXROLL        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  D@RRDT                                         *
      * Function    :  Rate Reset Details                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     D@RRDT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'D_RRDT'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\D_RRDT'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Next interest rate change date.
     C                   MOVEL     EVDAT         ##D(1)
      *
      ** Following interest rate change date
      *
      * Set up the 4 parameters for the call to CG99FREQ
      * to calculate the following interest rate change date.
      *
     C                   MOVEL     *BLANK        ##FREQ
      * FRA
     C     DTYP          IFEQ      'FR'
     C                   Z-ADD     MDAT          ##RDNB
     C                   ELSE
      *
      * IRS/ CAP/FLOOR/COLLAR
      *
      * our rate
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'B'
     C     OURTHR        ANDEQ     'OUR'
      *
     C***********EVDAT     IFNE UNICD                                                         088494
     C     EVDAT         IFNE      VDAT                                                       088494
     C                   MOVEL     UICFR         ##FREQ
     C                   Z-ADD     UICFD         ##MDAY
     C                   MOVEL     UCUCY         ##CCY
     C                   ELSE
     C                   Z-ADD     UNICD         ##RDNB
     C                   END
      * their rate
     C                   ELSE
      *
     C***********EVDAT     IFNE TNICD                                                         088494
     C     EVDAT         IFNE      VDAT                                                       088494
     C                   MOVEL     TICFR         ##FREQ
     C                   Z-ADD     TICFD         ##MDAY
     C                   MOVEL     TCUCY         ##CCY
     C                   ELSE
     C                   Z-ADD     TNICD         ##RDNB
     C                   END
      *
     C                   END
      *
     C                   END
      *
      *  Calculate following date after event date (if required)
      ** If rate change schedule is being used, do use maturity date                          CIR001
      **   as end date.                                                                       CIR001
      *                                                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     ##FREQ        ANDEQ     'Z'                                                        CIR001
      *                                                                                       CIR001
     C     CNRQ          IFEQ      'D'                                                        CIR001
     C                   MOVEL     'U'           W0OTIN                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'T'           W0OTIN                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   MOVEL     'R'           W0RCIP                                       CIR001
     C                   Z-ADD     EVDAT         W0ZDAY                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   Z-ADD     W0ZDAY        ##RDNB                                       CIR001
     C                   MOVEL     ##RDNB        ##D(2)                                       CIR001
      *                                                                                       CIR001
     C                   ELSE                                                                 CIR001
      *
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP14                                                               S01408
     C*                                                                                       S01408
     C     ##FREQ        IFNE      *BLANK
     C                   CALL      'CG99FREQ'                           99      *
     C                   PARM      *BLANK        ##RTCD            7
     C                   PARM      '*NEWDATE'    ##ACT             8
     C                   PARM                    ##FREQ           10
     C                   PARM      EVDAT         ##RDNB            5 0
     C                   PARM                    ##MDAY            2 0
     C                   PARM                    ##CCY             3
     C                   PARM      *BLANK        ##LOC             3
     C                   PARM      *BLANK        ##EXT           256
      *
     C     *IN99         IFEQ      '1'
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'CG99FREQ'    W0FILE                         ***************
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 08 *
     C                   Z-ADD     8             W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C                   END
      *
      * Following date is earlier of next calculated date and maturity date
      *
     C     ##RDNB        IFLT      MDAT
     C     ##RDNB        ANDNE     *ZERO
     C                   MOVEL     ##RDNB        ##D(2)
     C                   ELSE
     C                   MOVEL     MDAT          ##D(2)
     C                   END
      *                                                                                       CIR001
     C                   ENDIF                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP15                                                               S01408
     C*                                                                                       S01408
      *
      ** Currency,base rate type
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'B'
     C     OURTHR        ANDEQ     'OUR'
     C                   MOVEL     UCUCY         ##D(3)
     C                   MOVEL     UBRTT         ##D(4)
     C                   ELSE
     C                   MOVEL     TCUCY         ##D(3)
     C                   MOVEL     TBRTT         ##D(4)
     C                   ENDIF
      *
      ** Base Rate Name
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'B'
     C     OURTHR        ANDEQ     'OUR'
     C                   MOVEL     UCUCY         ##CYCD
     C                   MOVEL     UBRTT         ##BSRC
     C                   ELSE
     C                   MOVEL     TCUCY         ##CYCD
     C                   MOVEL     TBRTT         ##BSRC
     C                   ENDIF
      *
     C                   CALL      'AOBSRTR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*KEY   '     ##OPTN
     C                   PARM                    ##CYCD
     C                   PARM                    ##BSRC
     C********** SDBSRT    PARM SDBSRT    DSFDY                                               CSD006
     C     SDBSRT        PARM      SDBSRT        DSSDY                                        CSD006
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDBSRTPD'    W0FILE                         ***************
     C                   MOVEL     ##BSRC        W0KEY                          * DB ERROR 09 *
     C                   Z-ADD     9             W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
     C                   MOVEL     BABSRN        ##D(5)
      *
      ** Interest rate
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'B'
     C     OURTHR        ANDEQ     'OUR'
     C                   MOVEL     UFIR          ##D(6)
     C                   ELSE
     C                   MOVEL     TFIR          ##D(6)
     C                   ENDIF
      *
      ** Ours/theirs
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'B'
     C     OURTHR        ANDEQ     'OUR'
     C                   MOVEL     'O'           ##D(7)
     C                   ELSE
     C                   MOVEL     'T'           ##D(7)
     C                   ENDIF
      *                                                                                       086780
      ** Obtain currency description,precious metal indicator.                                086780
     C     CNRQ          IFEQ      'D'                                                        086780
     C     CNRQ          OREQ      'B'                                                        086780
     C     OURTHR        ANDEQ     'OUR'                                                      086780
     C                   MOVEL     UCUCY         ##CCY                                        086780
     C                   EXSR      SRDCDT                                                     086780
     C                   ELSE                                                                 086780
     C                   MOVEL     TCUCY         ##CCY                                        086780
     C                   EXSR      SRDCDT                                                     086780
     C                   ENDIF                                                                086780
      *                                                                                       086780
      ** Currency Description                                                                 086780
     C                   MOVEL     A6CYNM        ##D(8)                                       086780
      *                                                                                       086780
      ** Precious Metal Indicator                                                             086780
     C                   MOVEL     A6PMRT        ##D(9)                                       086780
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXRRDT        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************                       CIR001
      * Subroutine  :  D@IRSO                                         *                       CIR001
      * Function    :  IRS Our Details                                *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@IRSO        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_IRSO'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_IRSO'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Our Currency                                                                         CIR001
     C                   MOVEL     UCUCY         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Our Principal                                                                        CIR001
     C                   MOVEL     UPAMT         ##D(2)                                       CIR001
     C                   MOVEL     UCUCY         ##CCY                                        CIR001
     C                   EXSR      SRDCDT                                                     CIR001
     C/COPY WNCPYSRC,CG4110C103                                                               CIR001
     C                   MOVE      A6NBDP        ##D(2)                                       CIR001
      *                                                                                       CIR001
      ** Our Base Rate Type                                                                   CIR001
     C     UBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     UBRTT         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Base Rate Name                                                                   CIR001
     C     UBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     UBRTT         ##BSRC                                       CIR001
     C                   CALL      'AOBSRTR0'                                                 CIR001
     C                   PARM      *BLANKS       ##RTCD                                       CIR001
     C                   PARM      '*KEY   '     ##OPTN                                       CIR001
     C                   PARM      UCUCY         ##CYCD                                       CIR001
     C                   PARM                    ##BSRC                                       CIR001
     C********** SDBSRT    PARM SDBSRT    DSFDY                                         CIR001CSD006
     C     SDBSRT        PARM      SDBSRT        DSSDY                                        CSD006
      *                                                                                       CIR001
      ** DATABASE ERROR                                                                       CIR001
      *                                                                                       CIR001
     C     ##RTCD        IFNE      *BLANK                                                     CIR001
     C                   MOVEL     'SDBSRTPD'    W0FILE                         **************CIR001
     C                   MOVEL     ##BSRC        W0KEY                          * DB ERROR 08 CIR001
     C                   Z-ADD     8             W0ERNB                         **************CIR001
     C                   MOVEL     'MEM5004'     W0MSGD                                       CIR001
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CIR001
     C                   EXSR      SRERR                                                      CIR001
     C                   END                                                                  CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     *BLANK        BABSRN                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   MOVEL     BABSRN        ##D(4)                                       CIR001
      *                                                                                       CIR001
      ** Our Fixed Rate                                                                       CIR001
     C     UBRTT         IFEQ      *ZERO                                                      CIR001
     C                   MOVEL     UEINR         ##D(5)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Spread                                                                           CIR001
     C                   MOVEL     *BLANKS       R#DATA                                       CIR001
     C     UBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     URTSP         R#DATA                                       CIR001
     C     USPIN         IFEQ      'S'                                                        CIR001
     C                   MOVE      '-'           ##SIGN                                       CIR001
     C                   END                                                                  CIR001
     C                   END                                                                  CIR001
     C                   MOVEL     R#DATA        ##D(6)                                       CIR001
     C                   MOVEL     *BLANKS       R#DATA                                       CIR001
      *                                                                                       CIR001
      **  Our Calculation Basis                                                               CIR001
     C                   MOVEL     UICBS         ##D(7)                                       CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXIRSO        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@IRST                                         *                       CIR001
      * Function    :  IRS Their Details                              *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@IRST        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_IRST'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_IRST'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Their Currency                                                                       CIR001
     C                   MOVEL     TCUCY         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Their Principal                                                                      CIR001
     C                   MOVEL     TPAMT         ##D(2)                                       CIR001
     C                   MOVEL     TCUCY         ##CCY                                        CIR001
     C                   EXSR      SRDCDT                                                     CIR001
     C/COPY WNCPYSRC,CG4110C104
     C                   MOVE      A6NBDP        ##D(2)                                       CIR001
      *                                                                                       CIR001
      ** Their Base Rate Type                                                                 CIR001
     C     TBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TBRTT         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Base Rate Name                                                                 CIR001
     C     TBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TBRTT         ##BSRC                                       CIR001
     C                   CALL      'AOBSRTR0'                                                 CIR001
     C                   PARM      *BLANKS       ##RTCD                                       CIR001
     C                   PARM      '*KEY   '     ##OPTN                                       CIR001
     C                   PARM      TCUCY         ##CYCD                                       CIR001
     C                   PARM                    ##BSRC                                       CIR001
     C********** SDBSRT    PARM SDBSRT    DSFDY                                         CIR001CSD006
     C     SDBSRT        PARM      SDBSRT        DSSDY                                        CSD006
      *                                                                                       CIR001
      ** DATABASE ERROR                                                                       CIR001
      *                                                                                       CIR001
     C     ##RTCD        IFNE      *BLANK                                                     CIR001
     C                   MOVEL     'SDBSRTPD'    W0FILE                         **************CIR001
     C                   MOVEL     ##BSRC        W0KEY                          * DB ERROR 09 CIR001
     C                   Z-ADD     9             W0ERNB                         **************CIR001
     C                   MOVEL     'MEM5004'     W0MSGD                                       CIR001
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CIR001
     C                   EXSR      SRERR                                                      CIR001
     C                   END                                                                  CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     *BLANK        BABSRN                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   MOVEL     BABSRN        ##D(4)                                       CIR001
      *                                                                                       CIR001
      ** Their Fixed Rate                                                                     CIR001
     C     TBRTT         IFEQ      *ZERO                                                      CIR001
     C                   MOVEL     TEINR         ##D(5)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Spread                                                                         CIR001
     C                   MOVEL     *BLANKS       R#DATA                                       CIR001
     C     TBRTT         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TRTSP         R#DATA                                       CIR001
     C     TSPIN         IFEQ      'S'                                                        CIR001
     C                   MOVE      '-'           ##SIGN                                       CIR001
     C                   END                                                                  CIR001
     C                   END                                                                  CIR001
     C                   MOVEL     R#DATA        ##D(6)                                       CIR001
     C                   MOVEL     *BLANKS       R#DATA                                       CIR001
      *                                                                                       CIR001
      **  Their Calculation Basis                                                             CIR001
     C                   MOVEL     TICBS         ##D(7)                                       CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXIRST        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@ONTN                                         *                       CIR001
      * Function    :  Our Name & Their Name                          *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@ONTN        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_ONTN'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_ONTN'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Our Name                                                                             CIR001
     C                   MOVEL     BICRNM        ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Their Name                                                                           CIR001
     C                   MOVEL     CPCRNM        ##D(2)                                       CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXONTN        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@EIRO                                         *                       CIR001
      * Function    :  Our Effective Interest Rate                    *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@EIRO        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_EIRO'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_EIRO'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Our Effective Interest Rate                                                          CIR001
     C                   MOVEL     UEINR         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Our Short Term Rate Effective                                                        CIR001
     C                   TESTB     '0'           UDNSI                    99    *             CIR001
     C     *IN99         IFEQ      '1'                                                        CIR001
     C                   MOVEL     'Y'           ##D(2)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'N'           ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXEIRO        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@EIRT                                         *                       CIR001
      * Function    :  Their Effective Interest Rate                  *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@EIRT        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_EIRT'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_EIRT'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Their Effective Interest Rate                                                        CIR001
     C                   MOVEL     TEINR         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Their Short Term Rate Effective                                                      CIR001
     C                   TESTB     '0'           TDNSI                    99    *             CIR001
     C     *IN99         IFEQ      '1'                                                        CIR001
     C                   MOVEL     'Y'           ##D(2)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'N'           ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXEIRT        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@IPYO                                         *                       CIR001
      * Function    :  Our Interest Payment Details                   *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@IPYO        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_IPYO'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_IPYO'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Our Next Interest Payment Date                                                       CIR001
     C     UNIPD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     UNIPD         ##D(1)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     MDAT          ##D(1)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Interest Payment Frequency                                                       CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     UIPFR         ANDEQ     'Z'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     UIPFR         ANDEQ     'C'                                                        CIR001
     C*                                                                                       CIR001
     C                   MOVEL     'U'           W0OTIN                                       CIR001
     C                   Z-ADD     UNIPD         W0ZDAY                                       CIR001
     C*                                                                                       CIR001
     C     UIPFR         IFEQ      'Z'                                                        CIR001
     C                   MOVEL     'P'           W0RCIP                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   ELSE                                                                 CIR001
     C                   EXSR      #LDNCF                                                     CIR001
     C                   END                                                                  CIR001
     C*                                                                                       CIR001
     C                   Z-ADD     UNIPD         W0NXDT            5 0                        CIR001
     C                   Z-ADD     W0ZDAY        W0NNDT            5 0                        CIR001
     C*                                                                                       CIR001
     C                   EXSR      #LDTFR                                                     CIR001
     C                   MOVEL     W0FREQ        ##D(2)                                       CIR001
     C*                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     UIPFR         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Interest Payment Day                                                             CIR001
     C     UIPFD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     UIPFD         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Interest Processing Method                                                       CIR001
      ** -- If interest payment frequency is "C" for cash flow, set                           CIR001
      **    the interest processing method to "F".                                            CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
      *                                                                                       CIR001
     C     UIPFR         IFEQ      'C'                                                        CIR001
     C                   MOVEL     'F'           ##D(4)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     UINPM         ##D(4)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXIPYO        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@IPYT                                         *                       CIR001
      * Function    :  Their Interest Payment Details                 *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@IPYT        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_IPYT'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_IPYT'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Their Next Interest Payment Date                                                     CIR001
     C     TNIPD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TNIPD         ##D(1)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     MDAT          ##D(1)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Interest Payment Frequency                                                     CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     TIPFR         ANDEQ     'Z'                                                        CIR001
     C     CIR001        OREQ      'Y'                                                        CIR001
     C     TIPFR         ANDEQ     'C'                                                        CIR001
     C*                                                                                       CIR001
     C                   MOVEL     'T'           W0OTIN                                       CIR001
     C                   Z-ADD     TNIPD         W0ZDAY                                       CIR001
     C*                                                                                       CIR001
     C     TIPFR         IFEQ      'Z'                                                        CIR001
     C                   MOVEL     'P'           W0RCIP                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   ELSE                                                                 CIR001
     C                   EXSR      #LDNCF                                                     CIR001
     C                   END                                                                  CIR001
     C*                                                                                       CIR001
     C                   Z-ADD     TNIPD         W0NXDT                                       CIR001
     C                   Z-ADD     W0ZDAY        W0NNDT                                       CIR001
     C*                                                                                       CIR001
     C                   EXSR      #LDTFR                                                     CIR001
     C                   MOVEL     W0FREQ        ##D(2)                                       CIR001
     C*                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TIPFR         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Interest Payment Day                                                           CIR001
     C     TIPFD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TIPFD         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Interest Processing Method                                                     CIR001
      ** -- If interest payment frequency is "C" for cash flow, set                           CIR001
      **    the interest processing method to "F".                                            CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
      *                                                                                       CIR001
     C     TIPFR         IFEQ      'C'                                                        CIR001
     C                   MOVEL     'F'           ##D(4)                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TINPM         ##D(4)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXIPYT        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@RCHO                                         *                       CIR001
      * Function    :  Our Rate Change Details                        *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@RCHO        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_RCHO'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_RCHO'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Our Next Rate Change Date                                                            CIR001
     C                   MOVEL     UNICD         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Our Rate Change Frequency                                                            CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     UICFR         ANDEQ     'Z'                                                        CIR001
     C*                                                                                       CIR001
     C                   MOVEL     'U'           W0OTIN                                       CIR001
     C                   MOVEL     'R'           W0RCIP                                       CIR001
     C                   Z-ADD     UNICD         W0ZDAY                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C                   Z-ADD     UNICD         W0NXDT                                       CIR001
     C                   Z-ADD     W0ZDAY        W0NNDT                                       CIR001
     C*                                                                                       CIR001
     C                   EXSR      #LDTFR                                                     CIR001
     C                   MOVEL     W0FREQ        ##D(2)                                       CIR001
     C*                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     UICFR         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Our Rate Change Day                                                                  CIR001
     C     UICFD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     UICFD         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXRCHO        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  D@RCHT                                         *                       CIR001
      * Function    :  Their Rate Change Details                      *                       CIR001
      *                                                               *                       CIR001
      * Called by   :                                                 *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     D@RCHT        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'D_RCHT'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\D_RCHT'     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Their Next Rate Change Date                                                          CIR001
     C                   MOVEL     TNICD         ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Their Rate Change Frequency                                                          CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     TICFR         ANDEQ     'Z'                                                        CIR001
     C*                                                                                       CIR001
     C                   MOVEL     'T'           W0OTIN                                       CIR001
     C                   MOVEL     'R'           W0RCIP                                       CIR001
     C                   Z-ADD     TNICD         W0ZDAY                                       CIR001
     C                   EXSR      #LDTND                                                     CIR001
     C*                                                                                       CIR001
     C                   Z-ADD     TNICD         W0NXDT                                       CIR001
     C                   Z-ADD     W0ZDAY        W0NNDT                                       CIR001
     C*                                                                                       CIR001
     C                   EXSR      #LDTFR                                                     CIR001
     C                   MOVEL     W0FREQ        ##D(2)                                       CIR001
     C*                                                                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TICFR         ##D(2)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      ** Their Rate Change Day                                                                CIR001
     C     TICFD         IFNE      *ZERO                                                      CIR001
     C                   MOVEL     TICFD         ##D(3)                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     EXRCHT        TAG                                                                  CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
      /SPACE 5                                                                                CDL006
      *****************************************************************                       CDL006
      * Subroutine  :  FIDUC                                          *                       CDL006
      * Function    :  Fiduciary Details (Deal Date conf.)            *                       CDL006
      *                                                               *                       CDL006
      * Called by   :                                                 *                       CDL006
      * Calls       :                                                 *                       CDL006
      *****************************************************************                       CDL006
     C     FIDUC         BEGSR                                                                CDL006
      *                                                                                       CDL006
      **  Set up subroutine stack name                                                        CDL006
      *                                                                                       CDL006
     C                   ADD       1             Q                                            CDL006
     C                   MOVEL     'FIDUC'       @STK(Q)                                      CDL006
      *                                                                                       CDL006
      **  Retrieve subroutine specific data.                                                  CDL006
      *                                                                                       CDL006
     C     1             OCCUR     ##SRDT                                                     CDL006
     C                   MOVEL     ##SPAT        S#PATH                                       CDL006
      *                                                                                       CDL006
      **  Set up Path.                                                                        CDL006
      *                                                                                       CDL006
     C                   MOVEL     '\ZU_FID'     ##PNAM                                       CDL006
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL006
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CDL006
      **  Retrieve RDE information for RDEs in group set                                      CDL006
      *                                                                                       CDL006
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL006
     C                   Z-ADD     1             ##RDEN                                       CDL006
     C                   EXSR      SRRRDE                                                     CDL006
      *                                                                                       CDL006
      **  Initialise FT, DT and LT output fields.                                             CDL006
      *                                                                                       CDL006
     C                   Z-ADD     *ZEROS        WAMT1            13 0                        CDL006
     C                   Z-ADD     *ZEROS        WCHRGE           13 0                        CDL006
     C                   Z-ADD     *ZEROS        WCOMMI           13 0                        CDL006
     C                   Z-ADD     *ZEROS        WCORAT            7 4                        CDL006
     C                   Z-ADD     *ZEROS        WNAMTM           13 0                        CDL006
     C                   Z-ADD     *ZEROS        WNAMTV           13 0                        CDL006
      *                                                                                       CDL006
      ** Format Fiduciary Deposits flag                                                       CDL006
      *                                                                                       CDL006
     C                   MOVEL     *BLANKS       WFIDEP            1                          CDL006
     C     DTYP          IFEQ      'FL'                                                       CDL006
     C     DTYP          OREQ      'DP'                                                       CDL006
     C                   MOVEL     'Y'           WFIDEP                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      ** Save deal currency's number of decimal places                                        CDL006
      *                                                                                       CDL006
     C                   Z-ADD     A6NBDP        WNBDP             1 0                        CDL006
      *                                                                                       CDL006
      **  Format fiduciary commission/charges if deal type is                                 CDL006
      **  DT or LT.                                                                           CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C     BNCOTK        IFEQ      'Y'                                                        CDL006
     C     FCMC          IFNE      *BLANKS                                                    CDL006
     C     DTYP          ANDEQ     'DT'                                                       CDL006
     C     FCMC          ORNE      *BLANKS                                                    CDL006
     C     DTYP          ANDEQ     'LT'                                                       CDL006
      *                                                                                       CDL006
      ** If Commission tables in Base currency, access to Charge                              CDL006
      ** Types record with base currency.                                                     CDL006
      *                                                                                       CDL006
     C                   MOVE      CCY           KCYCD                                        CDL006
     C     BNCTBC        IFEQ      'Y'                                                        CDL006
     C                   MOVE      BJCYCD        KCYCD                                        CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C     KDLCCG        CHAIN     DLCCGDL0                           60                      CDL006
      *                                                                                       CDL006
      ** If no live record found field defaults to blank.                                     CDL006
      *                                                                                       CDL006
     C     *IN60         IFEQ      '1'                                                        CDL006
     C     FDRECI        ORNE      'D'                                                        CDL006
     C                   Z-ADD     *ZEROS        WCORAT                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C     *IN60         IFEQ      '0'                                                        CDL006
     C     FDRECI        ANDEQ     'D'                                                        CDL006
      *                                                                                       CDL006
      ** If Commission tables in Base currency, convert the range                             CDL006
      ** limits amounts from Base currency to Deal currency.                                  CDL006
      *                                                                                       CDL006
     C     BNCTBC        IFEQ      'Y'                                                        CDL006
     C     CCY           ANDNE     BJCYCD                                                     CDL006
     C                   EXSR      SRRLA                                                      CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ##PCPL        WKAMT1           15 0                        CDL006
      *                                                                                       CDL006
     C     ZRA(1)        IFEQ      *ZEROS                                                     CDL006
     C                   MOVEA     ZPE(1)        WCORAT                                       CDL006
     C                   ELSE                                                                 CDL006
     C                   Z-ADD     1             FI                2 0                        CDL006
      *                                                                                       CDL006
     C     WKAMT1        LOOKUP    ZRA(FI)                            53  53                  CDL006
     C     *IN53         IFEQ      '0'                                                        CDL006
     C     WKAMT1        LOOKUP    ZRA(FI)                              53                    CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   MOVEA     ZPE(FI)       WCORAT                                       CDL006
     C                   ENDIF                                                                CDL006
     C                   DIV       100           WCORAT                                       CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      ** Maturity Advices                                                                     CDL006
      *                                                                                       CDL006
     C     CNRQ          IFEQ      'M'                                                        CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
      *                                                                                       CDL006
      ** If commission due on the deal.                                                       CDL006
      *                                                                                       CDL006
     C     BNCOTK        IFEQ      'Y'                                                        CDL006
     C     FCMC          ANDNE     *BLANKS                                                    CDL006
      *                                                                                       CDL006
      ** Initialize Commission on commission used to                                          CDL006
      ** calculate Net amount to be settled.                                                  CDL006
      *                                                                                       CDL006
     C                   Z-ADD     0             WUCOAM                                       CDL006
      *                                                                                       CDL006
      **  Calculate Commission amount due.                                                    CDL006
      *                                                                                       CDL006
      **      UPAMT                                                                           CDL006
      ** (------------) x (MDAT - IACD) x (% current range) + FACTC                           CDL006
      **  Days of year                                                                        CDL006
      *                                                                                       CDL006
      **  If Call Deposit.                                                                    CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
     C                   Z-ADD     IACD          WUDBEG                                       CDL006
     C                   Z-ADD     MDAT          WUDEND                                       CDL006
     C                   EXSR      SRCOMM                                                     CDL006
     C     *LIKE         DEFINE    PCPL          WORKTD                                       CDL006
     C     WUACSC        ADD       FACTC         WORKTD                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      ** If Fixed Term deposit.                                                               CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
     C                   Z-ADD     FCMA          WORKTD                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      **  Calculate Commission amount due : FCMA   - FCPRD .                                  CDL006
      *                                                                                       CDL006
     C     *LIKE         DEFINE    PCPL          WORKD                                        CDL006
     C     WORKTD        SUB       FCPRD         WORKD                                        CDL006
     C                   Z-ADD     WORKD         WUCOAM                                       CDL006
     C                   Z-ADD     WORKD         WCOMMI                                       CDL006
      *                                                                                       CDL006
      **  Calculate Net Settlement Amount.                                                    CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ##NETT        WKAMT1                                       CDL006
     C                   SUB       WCOMMI        WKAMT1                                       CDL006
     C                   Z-ADD     WKAMT1        WNAMTV                                       CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      ** Interest Advices                                                                     CDL006
      *                                                                                       CDL006
     C     CNRQ          IFEQ      'I'                                                        CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
     C     DTYP          OREQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
      *                                                                                       CDL006
      ** If commission due on the deal.                                                       CDL006
      *                                                                                       CDL006
     C     BNCOTK        IFEQ      'Y'                                                        CDL006
     C     FCMC          ANDNE     *BLANKS                                                    CDL006
      *                                                                                       CDL006
      ** Initialize Commission on commission used to                                          CDL006
      ** calculate Net amount to be settled.                                                  CDL006
      *                                                                                       CDL006
     C     *LIKE         DEFINE    FCMA          WUCOAM                                       CDL006
     C                   Z-ADD     0             WUCOAM                                       CDL006
      *                                                                                       CDL006
      ** Calculate commission amount due.                                                     CDL006
      *                                                                                       CDL006
      ** If Call Deposit :                                                                    CDL006
      *                                                                                       CDL006
      **     UPAMT                                                                            CDL006
      ** (------------) x (NIDT-IACD) x (% current range) + FACTC                             CDL006
      **  Days of year                                    - FCPRD                             CDL006
      *                                                                                       CDL006
      ** If Fixed Term deposit :                                                              CDL006
      *                                                                                       CDL006
      **     FCMA                                                                             CDL006
      ** (-----------) x (NIDT-IACD) + FACTC - FCPRD                                          CDL006
      **  MDAT - VDAT                                                                         CDL006
      *                                                                                       CDL006
     C                   Z-ADD     IACD          WUDBEG                                       CDL006
     C                   Z-ADD     NIDT          WUDEND                                       CDL006
     C                   EXSR      SRCOMM                                                     CDL006
     C     WUACSC        ADD       FACTC         WORKTD                                       CDL006
     C     WORKTD        SUB       FACPD         WORKD                                        CDL006
     C                   Z-ADD     WORKD         WUCOAM                                       CDL006
     C                   Z-ADD     WORKD         WCOMMI                                       CDL006
     C                   Z-ADD     IACD          WUDBEG                                       CDL006
      *                                                                                       CDL006
      **  Calculate Net Settlement Amount.                                                    CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ##PCPL        WKAMT1                                       CDL006
     C                   ADD       ##NETA        WKAMT1                                       CDL006
     C                   SUB       WCOMMI        WKAMT1                                       CDL006
     C                   Z-ADD     WKAMT1        WNAMTV                                       CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      **  Deal Amendment Advices.                                                             CDL006
      *                                                                                       CDL006
     C     CNRQ          IFEQ      'C'                                                        CDL006
     C     DTYP          ANDEQ     'DT'                                                       CDL006
     C     CNRQ          OREQ      'C'                                                        CDL006
     C     DTYP          ANDEQ     'LT'                                                       CDL006
      *                                                                                       CDL006
     C     AMTP          IFEQ      'PI'                                                       CDL006
     C                   Z-ADD     ##W150        WNAMTV                                       CDL006
     C     BNCHTK        IFEQ      'Y'                                                        CDL006
     C                   Z-ADD     FCGAAM        WCHRGE                                       CDL006
     C                   ADD       FCGAAM        WNAMTV                                       CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C     AMTP          IFEQ      'PD'                                                       CDL006
     C                   Z-ADD     ##W150        WNAMTV                                       CDL006
     C     BNCHTK        IFEQ      'Y'                                                        CDL006
     C                   Z-ADD     FCGAAM        WCHRGE                                       CDL006
     C                   SUB       FCGAAM        WNAMTV                                       CDL006
     C                   ENDIF                                                                CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
     C     CGL031        IFEQ      'Y'
     C                   SUB       ##TAXA        WNAMTM
     C                   ENDIF
      *                                                                                       CDL006
      **  Net amount - Value date 1                                                           CDL006
      *                                                                                       CDL006
     C     CGL031        IFEQ      'Y'                                                        234865
     C                   ADD       ##TAXA        WNAMTV                                       234865
     C                   ENDIF                                                                234865
      *                                                                                       234865
     C                   MOVEL     WNAMTV        ##D(1)                                       CDL006
     C                   MOVE      WNBDP         ##D(1)                                       CDL006
      *                                                                                       CDL006
      **  Charge amount                                                                       CDL006
      *                                                                                       CDL006
     C                   MOVEL     WCHRGE        ##D(2)                                       CDL006
     C                   MOVE      WNBDP         ##D(2)                                       CDL006
      *                                                                                       CDL006
      **  Commission amount                                                                   CDL006
      *                                                                                       CDL006
     C                   MOVEL     WCOMMI        ##D(3)                                       CDL006
     C                   MOVE      WNBDP         ##D(3)                                       CDL006
      *                                                                                       CDL006
      **  Commission Rate                                                                     CDL006
      *                                                                                       CDL006
     C                   MOVEL     WCORAT        ##D(4)                                       CDL006
     C                   MOVE      WNBDP         ##D(4)                                       CDL006
      *                                                                                       CDL006
      **  Net amount                                                                          CDL006
      *                                                                                       CDL006
     C                   MOVEL     WNAMTM        ##D(5)                                       CDL006
     C                   MOVE      WNBDP         ##D(5)                                       CDL006
      *                                                                                       CDL006
      **  Fiduciary Deposits Flag                                                             CDL006
      *                                                                                       CDL006
     C                   MOVEL     WFIDEP        ##D(6)                                       CDL006
      *                                                                                       CDL006
      **  Accumulate RDE's and associated data and output to                                  CDL006
      **  PF/CGUDTAPD.                                                                        CDL006
      *                                                                                       CDL006
     C                   EXSR      SRADTA                                                     CDL006
     C                   EXSR      SRODTA                                                     CDL006
      *                                                                                       CDL006
      **  Unwind subroutine stack name                                                        CDL006
      *                                                                                       CDL006
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL006
     C                   SUB       1             Q                                            CDL006
      *                                                                                       CDL006
     C                   ENDSR                                                                CDL006
      *****************************************************************                       CDL006
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  BYOUT                                          *                       CIR001
      * Function    :  IRS Buy-Out Details                            *                       CIR001
      *                                                               *                       CIR001
      * Called by   :  SR/D11IRS                                      *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     BYOUT         BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'BYOUT '      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\BYOUT '     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Buy-Out Deal Date                                                                    CIR001
     C                   MOVEL     BODD          ##D(1)                                       CIR001
      *                                                                                       CIR001
      ** Buy-Out Value Date                                                                   CIR001
     C                   MOVEL     BOVD          ##D(2)                                       CIR001
      *                                                                                       CIR001
      ** Buy-Out Amount                                                                       CIR001
     C                   MOVEL     BOAM          ##D(3)                                       CIR001
     C     BAPR          IFEQ      'P'                                                        CIR001
     C                   MOVEL     UCUCY         ##CCY                                        CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TCUCY         ##CCY                                        CIR001
     C                   END                                                                  CIR001
     C                   EXSR      SRDCDT                                                     CIR001
     C/COPY WNCPYSRC,CG4110C105
     C                   MOVE      A6NBDP        ##D(3)                                       CIR001
      *                                                                                       CIR001
      ** Buy-Out Pay/Receive Indicator                                                        CIR001
     C                   MOVEL     BAPR          ##D(4)                                       CIR001
     C*                                                                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Buyout Pay/Receive indicator is 'P'ayment, use                                 CEU014
     C*  Payment Settlement currency, else use Receipt Settlement ccy.                        CEU014
     C     BAPR          IFEQ      'P'                                                        CEU014
     C                   MOVE      UCUCY         ##CCY2                                       CEU014
     C                   MOVE      PSCY          ##CCY                                        CEU014
     C                   ELSE                                                                 CEU014
     C                   MOVE      TCUCY         ##CCY2                                       CEU014
     C                   MOVE      RSCY          ##CCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C*                                                                                       CEU014
     C* If Settlement currency is not blank, convert Buyout amount                            CEU014
     C*  to Settlement currency.                                                              CEU014
     C*                                                                                       CEU014
     C     ##CCY         IFNE      *BLANKS                                                    CEU014
     C                   MOVE      ##CCY2        P@FRCY                                       CEU014
     C                   MOVE      ##CCY         P@TOCY                                       CEU014
     C                   Z-ADD     BOAM          P@FRAM                         Buy-Out Amoun CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Buy Out amount in Settlement currency                                                 CEU014
     C                   MOVEL     ##OUTA        ##D(5)                                       CEU014
     C                   MOVE      A6NBDP        ##D(5)                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert the                         CEU014
     C*  Buyout amount to Equivalent currency.                                                CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      ##CCY2        ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     ##CCY2        IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      ##CCY2        P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     BOAM          P@FRAM                         Buy-Out amoun CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Buyout amount in Equivalent currency                                                  CEU014
     C                   MOVEL     ##OUTA        ##D(6)                                       CEU014
     C                   MOVE      A6NBDP        ##D(6)                                       CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(7)                                       CEU014
     C                   MOVEL     A6CYNM        ##D(8)                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  UPFEE                                          *                       CIR001
      * Function    :  IRS Up-Front Fee Details                       *                       CIR001
      *                                                               *                       CIR001
      * Called by   :  SR/D11IRS                                      *                       CIR001
      * Calls       :                                                 *                       CIR001
      *****************************************************************                       CIR001
     C     UPFEE         BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     'UPFEE '      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Retrieve subroutine specific data.                                                  CIR001
     C     1             OCCUR     ##SRDT                                                     CIR001
     C                   MOVEL     ##SPAT        S#PATH                                       CIR001
      *                                                                                       CIR001
      **  Set up Path.                                                                        CIR001
     C                   MOVEL     '\UPFEE '     ##PNAM                                       CIR001
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CIR001
     C                   EXSR      PSHGRS                                                     CCG015
      *                                                                                       CIR001
      **  Retrieve RDE information for RDEs in group set                                      CIR001
      *                                                                                       CIR001
     C                   MOVEL     @STK(Q)       ##GRPS                                       CIR001
     C                   Z-ADD     1             ##RDEN                                       CIR001
     C                   EXSR      SRRRDE                                                     CIR001
      *                                                                                       CIR001
      ** Up-Front Fee Value Date                                                              CIR001
     C                   MOVEL     UPVD          ##D(1)                                       CIR005
      *                                                                                       CIR001
      ** Up-Front Fee Amount                                                                  CIR001
     C                   MOVEL     UPFE          ##D(2)                                       CIR001
     C     UPPR          IFEQ      'P'                                                        CIR001
     C                   MOVEL     UCUCY         ##CCY                                        CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     TCUCY         ##CCY                                        CIR001
     C                   END                                                                  CIR001
     C                   EXSR      SRDCDT                                                     CIR001
     C/COPY WNCPYSRC,CG4110C106
     C                   MOVE      A6NBDP        ##D(2)                                       CIR001
      *                                                                                       CIR001
      ** Up-Front Fee Pay/Receive Indicator                                                   CIR001
     C                   MOVEL     UPPR          ##D(3)                                       CIR001
     C*                                                                                       CEU014
     C     *LIKE         DEFINE    ##CCY         ##CCY2                                       CEU014
     C     CEU014        IFEQ      'Y'                                                        CEU014
     C*                                                                                       CEU014
     C* If the Up-Front Fee Pay/Receive indicator is 'P'ayment, use                           CEU014
     C*  Payment Settlement currency, else use Receipt Settlement ccy.                        CEU014
     C     UPPR          IFEQ      'P'                                                        CEU014
     C                   MOVE      UCUCY         ##CCY2                                       CEU014
     C                   MOVE      PSCY          ##CCY                                        CEU014
     C                   ELSE                                                                 CEU014
     C                   MOVE      TCUCY         ##CCY2                                       CEU014
     C                   MOVE      RSCY          ##CCY                                        CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If Settlement currency is not blank, convert Up Front fee to                          CEU014
     C*  Settlement currency.                                                                 CEU014
     C     ##CCY         IFNE      *BLANKS                                                    CEU014
     C                   MOVE      ##CCY2        P@FRCY                                       CEU014
     C                   MOVE      ##CCY         P@TOCY                                       CEU014
     C                   Z-ADD     UPFE          P@FRAM                         Up Front Fee  CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Up Front fee in Settlement currency                                                   CEU014
     C                   MOVEL     ##OUTA        ##D(4)                                       CEU014
     C                   MOVE      A6NBDP        ##D(4)                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In' or 'Euro' currency, convert the                         CEU014
     C*  Up Front fee amount to Equivalent currency.                                          CEU014
     C*                                                                                       CEU014
     C                   MOVE      *BLANKS       EQCY                                         CEU014
     C                   MOVE      ##CCY2        ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C*                                                                                       CEU014
     C* If the Event currency is 'In', the Equivalent currency is                             CEU014
     C*  Euros.                                                                               CEU014
     C     A6INCY        IFEQ      'Y'                                                        CEU014
     C                   MOVE      BKEURO        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C* If the Event currency is in 'Euro', the Equivalent 'In'                               CEU014
     C*  currency is retrieved from Customer file.                                            CEU014
     C     ##CCY2        IFEQ      BKEURO                                                     CEU014
     C                   EXSR      INCUST                                                     CEU014
     C                   MOVE      BBDINC        EQCY                                         CEU014
     C                   ENDIF                                                                CEU014
     C     EQCY          IFNE      *BLANKS                                                    CEU014
     C                   MOVE      EQCY          ##CCY                                        CEU014
     C                   EXSR      SRDCDT                                                     CEU014
     C                   MOVE      ##CCY2        P@FRCY                                       CEU014
     C                   MOVE      EQCY          P@TOCY                                       CEU014
     C                   Z-ADD     UPFE          P@FRAM                         Up Front Fee  CEU014
     C                   EXSR      D@EURO                                                     CEU014
     C*                                                                                       CEU014
     C* Upfront Fee amount in Equivalent currency                                             CEU014
     C                   MOVEL     ##OUTA        ##D(5)                                       CEU014
     C                   MOVE      A6NBDP        ##D(5)                                       CEU014
     C*                                                                                       CEU014
     C* Equivalent currency and description                                                   CEU014
     C                   MOVEL     EQCY          ##D(6)                                       CEU014
     C                   MOVEL     A6CYNM        ##D(7)                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
     C                   ENDIF                                                                CEU014
     C*                                                                                       CEU014
      *                                                                                       CIR001
      **  Accumulate RDE's and associated data and output to                                  CIR001
      **  PF/CGUDTAPD.                                                                        CIR001
     C                   EXSR      SRADTA                                                     CIR001
     C                   EXSR      SRODTA                                                     CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  #LDTFR                                         *                       CIR001
      * Function    :  Determine Closest Frequency for Schedule       *                       CIR001
      *                                                               *                       CIR001
      * Called by   :  SR/D@IPYO                                      *                       CIR001
      *                SR/D@IPYT                                      *                       CIR001
      *                SR/D@RCHO                                      *                       CIR001
      *                SR/D@RCHT                                      *                       CIR001
      * Calls       :  *NONE                                          *                       CIR001
      *****************************************************************                       CIR001
     C     #LDTFR        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     '#LDTFR'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      ** Determine the number of days from the next date to the "next                         CIR001
      **   next" date requested.                                                              CIR001
      *                                                                                       CIR001
     C     W0NNDT        SUB       W0NXDT        W0ZDAY                                       CIR001
      *                                                                                       CIR001
      ** Find the closest frequency code.                                                     CIR001
      *                                                                                       CIR001
     C     W0ZDAY        IFLE      61                                                         CIR001
     C                   MOVEL     'M'           W0FREQ            1                          CIR001
     C                   ELSE                                                                 CIR001
     C     W0ZDAY        IFLT      137                                                        CIR001
     C                   MOVEL     'Q'           W0FREQ                                       CIR001
     C                   ELSE                                                                 CIR001
     C     W0ZDAY        IFLT      274                                                        CIR001
     C                   MOVEL     'X'           W0FREQ                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'Y'           W0FREQ                                       CIR001
     C                   END                                                                  CIR001
     C                   END                                                                  CIR001
     C                   END                                                                  CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
      * Subroutine  :  #LDTND                                         *                       CIR001
      * Function    :  Determine Next Date from the Schedules.        *                       CIR001
      *                                                               *                       CIR001
      * Called by   :  SR/D@IPYO                                      *                       CIR001
      *                SR/D@IPYT                                      *                       CIR001
      *                SR/D@RCHO                                      *                       CIR001
      *                SR/D@RCHT                                      *                       CIR001
      * Calls       :  *NONE                                          *                       CIR001
      *****************************************************************                       CIR001
     C     #LDTND        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     '#LDTND'      @STK(Q)                                      CIR001
      *                                                                                       CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      *                                                                                       CIR001
     C                   Z-ADD     DLNO          W0DLNO                                       CIR001
     C                   Z-ADD     W0ZDAY        W0PRDT                                       CIR001
     C     KDTSL         SETGT     DLDTSCPD                                                   CIR001
     C                   READ      DLDTSCPD                               99    *             CIR001
     C     *IN99         IFEQ      '0'                                                        CIR001
     C     DLNO          ANDEQ     W0DLNO                                                     CIR001
     C     OTIN          ANDEQ     W0OTIN                                                     CIR001
     C     RCIP          ANDEQ     W0RCIP                                                     CIR001
     C                   Z-ADD     PRDT          W0ZDAY                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   Z-ADD     MDAT          W0ZDAY                                       CIR001
     C                   END                                                                  CIR001
     C                   Z-ADD     W0DLNO        DLNO                                         CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
     C*****************************************************************                       CIR001
     C/SPACE 5                                                                                CIR001
      *****************************************************************                       CIR001
     C/EJECT                                                                                  CIR001
      *****************************************************************                       CIR001
      *                                                               *                       CIR001
      *  S/R #LDNCF - Determine next cash flow date.                  *                       CIR001
      *                                                               *                       CIR001
      *****************************************************************                       CIR001
     C     #LDNCF        BEGSR                                                                CIR001
      *                                                                                       CIR001
      **  Set up subroutine stack name                                                        CIR001
     C                   ADD       1             Q                                            CIR001
     C                   MOVEL     '#LDNCF'      @STK(Q)                                      CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
     C     IRSCFL        KLIST                                                                CIR001
     C                   KFLD                    W0DLNO                                       CIR001
     C                   KFLD                    W0OTIN                                       CIR001
     C                   KFLD                    W0PRDT                                       CIR001
      *                                                                                       CIR001
     C                   Z-ADD     DLNO          W0DLNO                                       CIR001
     C                   Z-ADD     W0ZDAY        W0PRDT                                       CIR001
     C     IRSCFL        SETGT     DLCFSCD0                                                   CIR001
     C                   READ      DLCFSCD0                               99                  CIR001
     C     *IN99         IFEQ      '0'                                                        CIR001
     C     DLNO          ANDEQ     W0DLNO                                                     CIR001
     C     OTIN          ANDEQ     W0OTIN                                                     CIR001
     C                   Z-ADD     PRDT          W0ZDAY                                       CIR001
     C                   ELSE                                                                 CIR001
     C                   Z-ADD     MDAT          W0ZDAY                                       CIR001
     C                   END                                                                  CIR001
     C                   Z-ADD     W0DLNO        DLNO                                         CIR001
      *................................................................                       CIR001
      *                                                                                       CIR001
      **  Unwind subroutine stack name                                                        CIR001
     C                   MOVEA     *BLANKS       @STK(Q)                                      CIR001
     C                   SUB       1             Q                                            CIR001
      *                                                                                       CIR001
     C                   ENDSR                                                                CIR001
      *****************************************************************                       CIR001
     C/EJECT                                                                                  CIR001
      *****************************************************************
      * Subroutine  :  MATURD                                         *
      * Function    :  Maturity Date                                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     MATURD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'MATURD'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\MATURD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Maturity Date
     C                   MOVEL     MDAT          ##D(1)
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXMATU        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  NOTICD                                         *
      * Function    :  Notice Days                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     NOTICD        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'NOTICD'      @STK(Q)
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C     1             OCCUR     ##SRDT
     C                   MOVEL     ##SPAT        S#PATH
      *
      **  Set up Path.
     C                   MOVEL     '\NOTICD'     ##PNAM
     C     S#PATH        CAT       ##PNAM:0      S#PATH
     C                   EXSR      PSHGRS                                                     CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                   MOVEL     @STK(Q)       ##GRPS
     C                   Z-ADD     1             ##RDEN
     C                   EXSR      SRRRDE
      *
      ** Notice days
     C     NOTD          IFEQ      -999
     C                   MOVEL     '-999'        ##D(1)
     C                   ELSE
     C                   MOVEL     NOTD          ##D(1)
     C                   END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                   EXSR      SRADTA
     C                   EXSR      SRODTA
      *
      *................................................................
      *
     C     EXNOTI        TAG
      *
      **  Unwind subroutine stack name
     C                   EXSR      POPGRS                                                     CCG015
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
      /EJECT                                                                                  CDL006
      *****************************************************************                       CDL006
      *                                                               *                       CDL006
      *  SRCOMM - subroutine to calculate accrued commission due      *                       CDL006
      *           to work date since interest accrual control date.   *                       CDL006
      *                                                               *                       CDL006
      *  Called by:                                                   *                       CDL006
      *                                                               *                       CDL006
      *  Calls: GLINTC, ZINTDY                                        *                       CDL006
      *                                                               *                       CDL006
      *  Input     : - WUDBEG (5 0) : start date of period.           *                       CDL006
      *              - WUDEND (5 0) : end date of period.             *                       CDL006
      *                                                               *                       CDL006
      *  Output    : - WUACSC       : commission amount.              *                       CDL006
      *                                                               *                       CDL006
      *****************************************************************                       CDL006
      *                                                                                       CDL006
     C     SRCOMM        BEGSR                                                                CDL006
      *                                                                                       CDL006
      ** Work fields definition.                                                              CDL006
      *                                                                                       CDL006
     C     *LIKE         DEFINE    PCPL          WUACSC                                       CDL006
     C     *LIKE         DEFINE    IACD          WUDBEG                                       CDL006
     C     *LIKE         DEFINE    IACD          WUDEND                                       CDL006
     C     *LIKE         DEFINE    ZZINDY        WFULPD                                       CDL006
     C     *LIKE         DEFINE    ZZINDY        WPARPD                                       CDL006
      *                                                                                       CDL006
      ** Initialize accrued commission amount.                                                CDL006
      *                                                                                       CDL006
     C                   Z-ADD     0             WUACSC                                       CDL006
      *                                                                                       CDL006
      ** If Call Deposits.                                                                    CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'DT'                                                       CDL006
     C     DTYP          OREQ      'LT'                                                       CDL006
      *                                                                                       CDL006
      ** Commission amount calculation :                                                      CDL006
      *                                                                                       CDL006
      **   Principal                                                                          CDL006
      ** (------------) x (WUDEND - WUDBEG) x (% current range)                               CDL006
      **  Days of year                                                                        CDL006
      *                                                                                       CDL006
      ** Retrieve percentage of current range.                                                CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ##PCPL        ZIAMT                                        CDL006
     C                   Z-ADD     1             I                 2 0                        CDL006
     C     ZIAMT         LOOKUP    ZRA(I)                             53  53                  CDL006
     C     *IN53         IFEQ      '0'                                                        CDL006
     C     ZIAMT         LOOKUP    ZRA(I)                               53                    CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ICBS          ZICALC                                       CDL006
     C                   Z-ADD     WUDBEG        ZIBEG                                        CDL006
     C                   Z-ADD     WUDEND        ZIEND                                        CDL006
     C                   MOVE      ZPE(I)        WUPERC            7 4                        CDL006
     C                   Z-ADD     WUPERC        ZIRATE                                       CDL006
     C                   EXSR      GLINTC                                                     CDL006
     C                   Z-ADD     ZINTR         WUACSC                                       CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      **  If Fixed Term deposit.                                                              CDL006
      *                                                                                       CDL006
     C     DTYP          IFEQ      'FT'                                                       CDL006
      *                                                                                       CDL006
      **     FCMA                                                                             CDL006
      ** (-----------)  x  (WUDEND - WUDBEG)                                                  CDL006
      **  MDAT - VDAT                                                                         CDL006
      *                                                                                       CDL006
      ** To determine number of days between Value date and                                   CDL006
      ** Maturity date.                                                                       CDL006
      *                                                                                       CDL006
     C                   Z-ADD     VDAT          ZZBEG                                        CDL006
     C                   Z-ADD     MDAT          ZZEND                                        CDL006
     C                   EXSR      ZINTDY                                                     CDL006
     C                   Z-ADD     ZZINDY        WFULPD                                       CDL006
      *                                                                                       CDL006
      ** To determine number of days between Interest Accrual                                 CDL006
      ** control date and Next interest date.                                                 CDL006
      *                                                                                       CDL006
     C                   Z-ADD     WUDBEG        ZZBEG                                        CDL006
     C                   Z-ADD     WUDEND        ZZEND                                        CDL006
     C                   EXSR      ZINTDY                                                     CDL006
     C                   Z-ADD     ZZINDY        WPARPD                                       CDL006
      *                                                                                       CDL006
     C     WFULPD        IFNE      0                                                          CDL006
     C     FCMA          MULT      WPARPD        WU18@0           18 0                        CDL006
     C     WU18@0        DIV       WFULPD        WUACSC                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   ENDSR                                                                CDL006
      *                                                                                       CDL006
      *****************************************************************                       CDL006
      /EJECT                                                                                  CDL006
      *****************************************************************                       CDL006
     C/SPACE 5
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP16                                                               S01408
     C*                                                                                       S01408
      *****************************************************************
      * Subroutine  :  SRDCPI                                         *
      * Function    :  Determine the 'current' principal and interest *
      *                for the deal as at the event date              *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDCPI        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDCPI'      @STK(Q)
      *
      *................................................................
      *
     C     AITC          ADD       AIAN          ##AITC
     C                   ADD       AIAP          ##AITC
      *
     C                   CALL      'CG99DCPI'                           99      *
     C                   PARM      DLNO          ##DLNO            6 0
     C                   PARM      EVDAT         ##VDAT            5 0
     C                   PARM      DTDASN        ##DASN            3 0
     C                   PARM      NIDT          ##NIDT            5 0
     C                   PARM      IACD          ##IACD            5 0
     C                   PARM                    ##AITC           13 0
     C                   PARM      IPRD          ##IPRD           13 0
     C                   PARM      ICTD          ##ICTD           13 0
     C                   PARM      BRTT          ##BRTT            2 0
     C                   PARM      BRTE          ##BRTE           11 7
     C                   PARM      RTSP          ##RTSP           11 7
     C                   PARM      INTR          ##INTR           11 7
     C                   PARM      ICBS          ##ICBS            1 0
     C                   PARM      PCPL          ##PCPL           15 0          * Principal
     C                   PARM      *ZEROS        ##INTA           13 0          * Interest
     C                   PARM      *BLANK        ##RTCD            7            * Return Code
      *
     C     *IN99         IFEQ      '1'
     C     ##RTCD        ORNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'CG99DCPI'    W0FILE                         ***************
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 10 *
     C                   Z-ADD     10            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      *................................................................
      *
     C     EXDCPI        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*
     C*****************************************************************                       087053
     C/SPACE 5                                                                                087053
      *****************************************************************                       087053
      * Subroutine  :  SRAUTO                                         *                       087053
      * Function    :  Auto transmission processing                   *                       087053
      *                                                               *                       087053
      * Called by   :                                                 *                       087053
      * Calls       :                                                 *                       087053
      *****************************************************************                       087053
     C     SRAUTO        BEGSR                                                                087053
      *                                                                                       087053
      **  Set up subroutine stack name                                                        087053
     C                   ADD       1             Q                                            087053
     C                   MOVEL     'SRAUTO'      @STK(Q)                                      087053
      *                                                                                       087053
      *................................................................                       087053
      *                                                                                       087053
      ** Get Branch Details                                                                   087053
      *                                                                                       087053
     C     BRCA          IFNE      ##BRCD                                                     087053
     C**********           CALL 'AOBRCHR0'                                087053              CGL029
     C                   CALL      'AOBRCHR1'                                                 CGL029
     C                   PARM      '*MSG    '    ##RTCD                                       087053
     C                   PARM      '*KEY    '    ##OPTN                                       087053
     C                   PARM      BRCA          ##BRCD            3                          087053
     C********** SDBRCH    PARM SDBRCH    DSFDY                           087053              CGL029
     C     SDBRCH        PARM      SDBRCH        DSSDY                                        CGL029
      *                                                                                       087053
      ** DATABASE ERROR                                                                       087053
      *                                                                                       087053
     C     ##RTCD        IFNE      *BLANK                                                     087053
     C                   MOVEL     'SDBRCHPD'    W0FILE                                       087053
     C                   MOVEL     BRCA          W0KEY                          **************087053
     C                   Z-ADD     27            W0ERNB                         * DB ERROR 27 087053
     C                   MOVEL     'MEM5004'     W0MSGD                         **************087053
     C                   MOVEL     'MIDAS  '     W0MSGF                                       087053
     C                   EXSR      SRERR                                                      087053
     C                   END                                                                  087053
      *                                                                                       087053
      ** Get Customer Details for Branch Internal Customer                                    087053
      *                                                                                       087053
     C                   CALL      'AOCUSTR0'                                                 087053
     C                   PARM      *BLANKS       ##RTCD                                       087053
     C                   PARM      '*KEY   '     ##OPTN                                       087053
     C                   PARM      A8BICN        ##KEY1           10                          870533
     C                   PARM      *BLANKS       ##KYST            7                          087053
     C     SDCUST        PARM      SDCUST        DSSDY                                        087053
      *                                                                                       087053
      ** DATABASE ERROR                                                                       087053
      *                                                                                       087053
     C     ##RTCD        IFNE      *BLANK                                                     087053
     C                   MOVEL     'SDCUSTPD'    W0FILE                                       087053
     C                   MOVEL     A8BICN        W0KEY                          **************087053
     C                   Z-ADD     28            W0ERNB                         * DB ERROR 28 087053
     C                   MOVEL     'MEM5004'     W0MSGD                         **************087053
     C                   MOVEL     'MIDAS  '     W0MSGF                                       087053
     C                   EXSR      SRERR                                                      087053
     C                   END                                                                  087053
      *                                                                                       087053
      ** Store Booking Branch, Branch Internal Customer Number and Name                       087053
      *                                                                                       087053
     C                   MOVEL     BRCA          BBBRCA                                       087053
     C                   MOVEL     BBCUST        BBBICN                                       087053
     C                   MOVEL     BBCRNM        BICRNM                                       087053
      *                                                                                       087053
      ** Store : Sender's (i.e. Branch)                                                       087053
      **             SWIFT TID Address,                                                       087053
      **             STTX Address                                                             087053
      **             Telex Address                                                            087053
      ** (All used in message routing)                                                        087053
      *                                                                                       087053
     C                   MOVEL     A8BTID        ##SCSD                                       087053
     C                   MOVEL     BBSTAD        ##SSTD                                       087053
     C                   MOVEL     BBTXA1        ##STXA                                       087053
     C/COPY WNCPYSRC,CG4110C043
     C                   END                                                                  087053
      *                                                                                       087053
      ** Get Customer Details                                                                 087053
      *                                                                                       087053
     C                   MOVEL     CNUM          ##KEY1                                       087053
     C                   CALL      'AOCUSTR0'                                                 087053
     C                   PARM      *BLANKS       ##RTCD                                       087053
     C                   PARM      '*KEY   '     ##OPTN                                       087053
     C                   PARM                    ##KEY1                                       087053
     C                   PARM      *BLANKS       ##KYST                                       087053
     C     SDCUST        PARM      SDCUST        DSSDY                                        087053
      *                                                                                       087053
      ** DATABASE ERROR                                                                       087053
      *                                                                                       087053
     C     ##RTCD        IFNE      *BLANK                                                     087053
     C                   MOVEL     'SDCUSTPD'    W0FILE                         **************087053
     C                   MOVEL     CNUM          W0KEY                          * DB ERROR 29 087053
     C                   Z-ADD     29            W0ERNB                         **************087053
     C                   MOVEL     'MEM5004'     W0MSGD                                       087053
     C                   MOVEL     'MIDAS  '     W0MSGF                                       087053
     C                   EXSR      SRERR                                                      087053
     C                   END                                                                  087053
      *                                                                                       087053
      ** Store Customer Name                                                                  087053
      *                                                                                       087053
     C                   MOVEL     BBCRNM        CPCRNM                                       087053
      *                                                                                       087053
      ** Store : Destination Customer's (i.e. Counterparty)                                   087053
      **             SWIFT TID Address,                                                       087053
      **             STTX Address                                                             087053
      **             Telex Address                                                            087053
      **             Default Network for MTnnn messages                                       087053
      ** (All used in message routing)                                                        087053
      *                                                                                       087053
     C                   MOVEL     BBCSID        ##DCSD                                       087053
     C                   MOVEL     BBSTAD        ##DSTD                                       087053
     C                   MOVEL     BBTXA1        ##DTXA                                       087053
     C                   MOVEL     BBDNW3        ##DDNW                         *MT300 messag 087053
      *                                                                                       087053
      ** Determine Message Routing                                                            087053
      *                                                                                       087053
     C                   CALL      'CG99DTMR'                           99      *             087053
     C                   PARM                    ##SCSD           12            *Send. SWIFT  087053
     C                   PARM                    ##SSTD           12            *Send. STTX   087053
     C                   PARM                    ##STXA           10            *Send. Telex  087053
     C                   PARM                    ##DCSD           12            *Dest. SWIFT  087053
     C                   PARM                    ##DSTD           12            *Dest. STTX   087053
     C                   PARM                    ##DTXA           10            *Dest. Telex  087053
     C                   PARM                    ##DDNW            6            *Dest. Deflt  087053
     C                   PARM      BGMSDL        ##MSDL            1            *Midas/SWIFT  087053
     C                   PARM      BGMTMI        ##MTMI            1            *Midas/Telex  087053
     C                   PARM      BLSWPY        ##SWPY            1 0          *SWIFT conf p 087053
     C                   PARM      BLTXPY        ##TXPY            1 0          *TELEX conf p 087053
     C                   PARM      *BLANK        ##NETW            6            *Network      087053
     C                   PARM      *BLANK        ##RTCD            7                          087053
      *                                                                                       087053
     C     *IN99         IFEQ      '1'                                                        087053
     C     ##RTCD        ORNE      *BLANK                                                     087053
      *                                                                                       087053
      ** DATABASE ERROR                                                                       087053
      *                                                                                       087053
     C                   MOVEL     'CG99DTMR'    W0FILE                         **************087053
     C                   MOVEL     ##RTCD        W0KEY                          * DB ERROR 30 087053
     C                   Z-ADD     30            W0ERNB                         **************087053
     C                   MOVEL     'MEM5003'     W0MSGD                                       087053
     C                   MOVEL     'MIDAS  '     W0MSGF                                       087053
     C                   EXSR      SRERR                                                      087053
     C                   END                                                                  087053
      *                                                                                       087053
     C                   EXSR      SRDAUT                                                     087053
     C/COPY WNCPYSRC,CG4110C003
     C                   MOVEL     'N'           ##SPPS            1                          087053
     C                   MOVEL     ##AUTO        DRATRM                                       087053
      *                                                                                       087053
      /COPY WNCPYSRC,CG4110SPPS                                                               117163
      *                                                                                       CER038
      ** if auto transmission                                                                 CER038
      *                                                                                       CER038
     C     ##AUTO        IFEQ      'Y'                                                        CER038
     C     CER038        ANDEQ     'Y'                                                        CER038
     C     SUPCON        ANDEQ     'Y'                                                      MD029242
      *                                                                                       CER038
      ** set suppress indicator                                                               CER038
      *                                                                                       CER038
     C                   MOVE      'Y'           ##SPPS                                       CER038
      *                                                                                       CER038
     C                   ENDIF
      *C*PY*WN*PY*RC*CG4010SPPS                                                         087053117163
      *                                                                                       087053
      *................................................................                       087053
      *                                                                                       087053
     C     EXAUTO        TAG                                                                  087053
      *                                                                                       087053
      **  Unwind subroutine stack name                                                        087053
     C                   MOVEA     *BLANKS       @STK(Q)                                      087053
     C                   SUB       1             Q                                            087053
      *                                                                                       087053
     C                   ENDSR                                                                087053
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDOOT                                         *
      * Function    :  Determine OUR/THEIR Indicator                  *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDOOT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDOOT'      @STK(Q)
      *
      *................................................................
      *
     C                   MOVEL     *BLANK        OURTHR            3
      *
      ** FRA
     C     DTYP          IFEQ      'FR'
     C     BYSL          ANDEQ     'S'
     C                   MOVEL     'OUR'         OURTHR
     C                   END
      *
      ** CAP/FLOOR/COLLAR
     C     DTYP          IFEQ      'RP'
     C     BYSL          ANDEQ     'S'
     C     DTYP          OREQ      'RF'
     C     BYSL          ANDEQ     'B'
     C     DTYP          OREQ      'RR'
     C     BYSL          ANDEQ     'S'
     C                   MOVEL     'OUR'         OURTHR
     C                   END
      *
      *................................................................
      *
     C     EXDOOT        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDAUT                                         *
      * Function    :  Determine if Auto-Transmission of Confirmation *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDAUT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDAUT'      @STK(Q)
      *
      *................................................................
      *
     C                   MOVEL     'N'           ##AUTO            1
     C/COPY WNCPYSRC,CG4110C065
     C                   MOVE      'N'           FRAIRS                                       CSW005
     C/COPY WNCPYSRC,CG4110C013
     C     CSW005        IFEQ      'Y'                                                        CSW005
     C     DTYP          IFEQ      'FR'                                                       CSW005
     C     DTYP          OREQ      'RS'                                                       CSW005
     C     DTYP          OREQ      'RX'                                                       CSW005
     C                   MOVE      'Y'           FRAIRS                                       CSW005
     C                   ENDIF                                                                CSW005
     C                   ENDIF                                                                CSW005
     C*                                                                                       CSW011
     C     CSW011        IFEQ      'Y'                                                        CSW011
     C     CSW005        ANDNE     'Y'                                                        CSW011
     C     DTYP          ANDEQ     'FR'                                                       CSW011
     C                   MOVE      'Y'           FRAIRS                                       CSW011
     C                   ENDIF                                                                CSW011
      *
     C     BGSWDL        IFEQ      'Y'                                          * SWIFT/DEALING
     C     BGMTDL        OREQ      'Y'                                          * MIDAS/TELEX/DL
      *
     C     *IN02         IFEQ      '1'                                          * LOAN/DEPOSIT &
      *                                                                                       CSW005
     C     CSW005        OREQ      'Y'                                          *  CSW005 on  CSW005
     C     *IN05         ANDEQ     *ON                                          * FRA/IRS     CSW005
     C     DTYP          ANDEQ     'FR'                                         *  Fwd Rate A CSW005
      *                                                                                       CSW005
     C     CSW005        OREQ      'Y'                                          *  CSW005 on  CSW005
     C     *IN05         ANDEQ     *ON                                          * FRA/IRS     CSW005
     C     DTYP          ANDEQ     'RS'                                         *  Single Ccy CSW005
      *                                                                                       CSW005
     C     CSW005        OREQ      'Y'                                          *  CSW005 on  CSW005
     C     *IN05         ANDEQ     *ON                                          * FRA/IRS     CSW005
     C     DTYP          ANDEQ     'RX'                                         *  Cross Ccy  CSW005
      *                                                                                       CSW011
     C     CSW011        OREQ      'Y'                                          *  CSW011 on  CSW011
     C     CSW005        ANDNE     'Y'                                          *  CSW005 OFF CSW011
     C     *IN05         ANDEQ     *ON                                          * FRA/IRS     CSW011
     C     DTYP          ANDEQ     'FR'                                         *  FRA        CSW011
      *
      ** FX deals confirmation                                                             AR1029141
      *                                                                                    AR1029141
     C     *IN01         OREQ      '1'                                                     AR1029141
     C     DTYP          ANDEQ     'OP'                                                    AR1029141
      *                                                                                    AR1029141
     C     ##NETW        IFNE      'PAPER '                                     * NETWORK
     C     ##NETW        OREQ      'PAPER '                                     * NETWORK
     C     ENFFCR        ANDNE     'Y'                                          * FREE FMT CFS RQ
     C                   MOVEL     'Y'           ##AUTO
     C                   END
      *
     C                   END
     C                   END
     C/COPY WNCPYSRC,CG4110C004
     C*
      *
      *................................................................
      *
     C     EXDAUT        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDFED                                         *
      * Function    :  Determine if Federal Funds                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDFED        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDFED'      @STK(Q)
      *
      *................................................................
      *
     C                   MOVEL     'N'           ##FEDL            1
      *
      * CHECK APPROPRIATE BIT OF DEAL STATIC INDICATORS
      *
     C   01              TESTB     '2'           DSTI                     99    * PUCY = USD
     C   01
     CANN99              TESTB     '3'           DSTI                     99    * SLCY = USD
     C   02              TESTB     '2'           DSTI                     99    * DEPOSIT
     C   02
     CANN99              TESTB     '3'           DSTI                     99    * LOAN
     C   03              TESTB     '3'           DSTI                     99    * NAB
     C   04              TESTB     '3'           DSTI                     99    * NAS
     C   05              TESTB     '2'           UDSTI                    99    * FRA/IRS
     C   05
     CANN99              TESTB     '2'           TDSTI                    99    * FRA/IRS
      *
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'Y'           ##FEDL
     C                   END
      *
      *................................................................
      *
     C     EXDFED        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDTAX                                         *
      * Function    :  Determine tax amount.                          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDTAX        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDTAX'      @STK(Q)
      *
      *................................................................
      *                                                                                       235126
     C/COPY WNCPYSRC,CGH00025
     C     TAXI          IFEQ      'Y'                                                        235126
      *
      ** IF BASIC RATE TAX
      *
     C     S01383        IFEQ      'Y'
      *
     C/COPY WNCPYSRC,CG4110C031
      ** CALL DEPOSITS
      *
     C     DTYP          IFEQ      'CD'
     C     MDAT          ANDEQ     0
     C*
     C     VDAT          IFGE      BJRDNB
     C     NOTD          IFEQ      0
     C     *LIKE         DEFINE    MDAT          ##WMDT
     C     VDAT          ADD       1             ##WMDT
     C                   ELSE
     C     NOTD          ADD       VDAT          ##WMDT
     C                   END
     C                   END
     C*
     C     VDAT          IFLT      BJRDNB
     C     NOTD          IFEQ      0
     C     BJRDNB        ADD       1             ##WMDT
     C                   ELSE
     C     NOTD          ADD       BJRDNB        ##WMDT
     C                   END
     C                   END
      *
      ** ELSE, FIXED TERM DEPOSITS
      *
     C                   ELSE
     C                   Z-ADD     MDAT          ##WMDT
     C                   END
      *
      * USE RELEVANT RATE ACCORDING TO TAX EFFECTIVE DATE
      *
     C     ##WMDT        IFGE      DEFF
     C                   Z-ADD     BRTR          BNHKTR
     C                   END
     C*
     C     ##WMDT        IFLT      DEFF
     C                   Z-ADD     PBRTR         BNHKTR
     C                   END
      *
      ** GET CUSTOMER BRT DETAILS
      *
     C     CNUM          CHAIN     SDCBRTL1                           99
     C     *IN99         IFEQ      '1'
     C     XRECI         ORNE      'D'
     C                   MOVEL     'SDCBRTPD'    W0FILE                         ***************
     C                   MOVEL     CNUM          W0KEY                          * DB ERROR 11 *
     C                   Z-ADD     11            W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      ** FULLY LIABLE
      *
     C     TAXIND        IFEQ      'L'
     C     ##INTA        MULT      BNHKTR        ##WTAX           15 5
     C     ##WTAX        DIV       100           ##TAXA
     C                   END
      *
      ** HALF LIABLE
      *
     C     TAXIND        IFEQ      'P'
     C     BNHKTR        MULT      0.5           ##WTXR           15 5
     C     ##INTA        MULT      ##WTXR        ##WTAX           15 5
     C     ##WTAX        DIV       100           ##TAXA
     C                   END
     C/COPY WNCPYSRC,CG4110C032
     C*
     C                   ELSE
      *****************************************************************                CGL031 232543
      ***EU*Tax*extraction*********************************************                CGL031 232543
      *****************************************************************                CGL031 232543
     C********** CGL031    IFEQ 'Y'                                                    CGL031 232543
     C********** TAXFLG    ANDEQ'Y'                                                    CGL031 232543
      *****************************************************************                CGL031 232543
      ***Extract*tax*amount*and*net*interest*amount*when*CGL031********                CGL031 232543
      ***feature*is*on*************************************************                CGL031 232543
      *****************************************************************                CGL031 232543
     C**********           MOVE 'D'       KMODI                                        CGL031 232543
     C********** KSCIN     CHAINSDCSINL6             98                                CGL031 232543
     C********** *IN98     DOWEQ*OFF                                                   CGL031 232543
     C********** TSSTAT    IFEQ 'T'                                                    CGL031 232543
     C**********           ADD  TSTXSR    ##TAXA                                       CGL031 232543
     C**********           ENDIF                                                       CGL031 232543
     C********** KSCIN     READESDCSINL6                 98                            CGL031 232543
     C**********           ENDDO                                                       CGL031 232543
      *****************************************************************                CGL031 232543
     C**********           ELSE                                                        CGL031 232543
      *
      ** IF HONG KONG INTEREST TAX
      *
     C     BNHKTR        IFNE      *ZERO
      *
      ** ROUND DOWN INTEREST TAX AMOUNT IF RDFC = Y
      *
     C     JRDFC         IFEQ      'Y'
     C     ##INTA        MULT      BNHKTR        ##TAXA
     C                   DIV       100           ##TAXA
     C                   ELSE
     C     ##INTA        MULT      BNHKTR        ##TAXA
     C                   DIV(H)    100           ##TAXA
     C                   END
      *
     C                   END
     C**********           ENDIF                                                       CGL031 232543
     C                   END
      *                                                                                       235126
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C064                                                               232543
      *                                                                                       232543
      ** EU Tax extraction                                                                    232543
      *                                                                                       232543
     C     CGL031        IFEQ      'Y'                                                        232543
      *                                                                                       235126
     C     DTYP          IFEQ      'CD'                                                       235126
     C     DTYP          OREQ      'TD'                                                       235126
     C********** TAXFLG    ANDEQ'Y'                                                    232543 235126
      *                                                                                       232543
      ** Calculate WKMDAT                                                                     232543
      *                                                                                       232543
     C     DTYP          IFEQ      'CD'                                                       232543
     C     MDAT          ANDEQ     0                                                          232543
     C*                                                                                       232543
     C     VDAT          IFGE      BJRDNB                                                     232543
     C     NOTD          IFEQ      0                                                          232543
     C     *LIKE         DEFINE    MDAT          WKMDAT                                       232543
     C     VDAT          ADD       1             WKMDAT                                       232543
     C                   ELSE                                                                 232543
     C     NOTD          ADD       VDAT          WKMDAT                                       232543
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
     C*                                                                                       232543
     C     VDAT          IFLT      BJRDNB                                                     232543
     C     NOTD          IFEQ      0                                                          232543
     C     BJRDNB        ADD       1             WKMDAT                                       232543
     C                   ELSE                                                                 232543
     C     NOTD          ADD       BJRDNB        WKMDAT                                       232543
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
      ** ELSE, FIXED TERM DEPOSITS                                                            232543
      *                                                                                       232543
     C                   ELSE                                                                 232543
     C     CNRQ          IFEQ      'I'                                                     MD027745A
     C                   Z-ADD     NIDT          WKMDAT                                    MD027745A
     C                   Z-ADD     ##INTA        @@TOTI                                    MD027745B
     C                   ELSE                                                              MD027745A
     C     DAVDAT        IFNE      0                                                       MD027745B
     C     AMTP          IFEQ      'CI'                                                     MD031366
     C                   Z-ADD     ##INTA        @@TOTI                                     MD031366
     C                   Z-ADD     DAVDAT        WKMDAT                                     MD031366
     C                   ELSE                                                               MD031366
     C                   Z-ADD     DAVDAT        WKMDAT                                    MD027745B
     C                   Z-ADD     DAAM          @@TOTI                                    MD027745B
     C                   ENDIF                                                              MD031366
     C                   ELSE                                                              MD027745B
     C     CNRQ          IFEQ      'M'                                                      MD031125
     C                   Z-ADD     ##INTA        @@TOTI                                     MD031125
     C                   ENDIF                                                              MD031125
     C                   Z-ADD     MDAT          WKMDAT                                       232543
     C                   ENDIF                                                             MD027745B
     C                   ENDIF                                                             MD027745A
     C                   ENDIF                                                                232543
      *                                                                                       232543
      ** Retrieve Settlement Account                                                          232543
      *                                                                                       232543
     C                   MOVEL     'ZAGETSET'    WRLE1            10                          232543
     C                   MOVE      'AC'          WRLE1                                        232543
      *                                                                                       232543
     C                   MOVE      CCY           P@ACCY                                       232543
     C**********           MOVE BRCA      P@BRCA                                       232543 235126
     C     IPDS          IFEQ      'Y'                                                        232543
     C                   MOVE      IMET          P@STYP                                       232543
     C                   MOVEL     INSA          P@SACT                                       235126
     C                   MOVE      INSA          P@BRCA                                       235126
     C**********           MOVE INSA      P@SACT                                       232543 235126
     C                   ELSE                                                                 232543
     C                   Z-ADD     PSTM          P@STYP                                       232543
     C                   MOVE      PONS          P@SACT                                       232543
     C                   MOVE      POBR          P@BRCA                                       235126
     C                   ENDIF                                                                232543
     C                   MOVE      CNUM          P@CNUM                                       232543
      *                                                                                       235126
     C     P@STYP        IFEQ      04                                                         232543
     C     WDLCUS        ANDNE     'Y'                                                        235126
     C     P@STYP        OREQ      05                                                       MD026788
     C     WDLCUS        ANDNE     'Y'                                                        235126
     C     P@STYP        OREQ      14                                                       MD026788
     C     WDLCUS        ANDNE     'Y'                                                        235126
     C********** P@STYP    IFNE 00                                                     234407 235126
     C********** P@STYP    ANDNE01                                                     234407 235126
     C********** P@STYP    ANDNE02                                                     234407 235126
     C********** P@STYP    ANDNE08                                                     234407 235126
     C********** P@STYP    ANDNE12                                                     234407 235126
      *                                                                                       234407
     C                   CALL      WRLE1                                                      232543
      *                                                                                       232543
      ** Output Parameters                                                                    232543
      *                                                                                       232543
     C                   PARM      *BLANKS       P@RETC           10                          232543
     C                   PARM      *ZEROS        P@ACCT                                       232543
     C                   PARM      *ZEROS        P@ASEQ                                       232543
     C                   PARM      'N'           P@MEIN            1                          232543
     C                   PARM      'N'           P@PRIN            1                          232543
      *                                                                                       232543
      ** Input/Output Parameters                                                              232543
      *                                                                                       232543
     C                   PARM                    P@BRCA            3                          232543
     C**********           PARM *ZEROS    P@CNUM                                       232543 235126
     C                   PARM                    P@CNUM                                       235126
     C                   PARM                    P@ACCY            3                          232543
      *                                                                                       232543
      ** Input Parameters                                                                     232543
      *                                                                                       232543
     C                   PARM                    P@STYP                                       232543
     C**********           PARM           P@SACT 12                                  232543 BUG11111
     C                   PARM                    P@SACT           18                        BUG11111
      *                                                                                       235126
     C     P@RETC        IFNE      *BLANKS                                                    235126
     C     *LOCK         IN        LDA                                                        235126
     C                   MOVEL     P@SACT        DBKEY                                        235126
     C                   Z-ADD     101           DBASE                                        235126
     C                   OUT       LDA                                                        235126
     C                   EXSR      *PSSR                                                      235126
     C                   ENDIF                                                                235126
      *                                                                                       232543
     C                   ELSE                                                                 234407
      *                                                                                       234407
     C                   MOVEL     BRCA          P@BRCA                                       234407
     C                   MOVEL     CNUM          P@CNUM                                       234407
     C                   MOVEL     CCY           P@ACCY                                       235126
      *                                                                                       235126
     C                   ENDIF                                                                234407
      *                                                                                       234407
     C                   MOVE      P@CNUM        WCNUM             6                          232543
     C                   MOVE      DLNO          WDLNO             6                          232543
      *                                                                                       235126
     C                   EXSR      SRCHKD                                                     235126
      *                                                                                       235126
     C                   Z-ADD     WKMDAT        @@ENDD                                       232543
      *                                                                                       232543
      ** Extract tax amount and net interest amount when CGL031                               232543
      ** feature is on                                                                        232543
      *                                                                                       232543
     C                   MOVE      ' '           WTXPI             1                          232543
     C                   MOVE      ' '           WTXJA             1                          232543
      *                                                                                    MD027745A
      ** If interest advice is to be produced, use the calculated interest                 MD027745A
      ** within the interest period in calculating the tax amount.                         MD027745A
      *                                                                                    MD027745A
     C     CNRQ          IFEQ      'I'                                                     MD027745A
     C                   Z-ADD     NIDT          WKMDAT                                    MD027745A
     C                   Z-ADD     ##INTA        @@TOTI                                    MD027745A
     C                   ELSE                                                              MD027745A
     C     DAVDAT        IFNE      0                                                       MD027745A
     C     AMTP          IFEQ      'CI'                                                     MD031366
     C                   Z-ADD     ##INTA        @@TOTI                                     MD031366
     C                   Z-ADD     DAVDAT        WKMDAT                                     MD031366
     C                   ELSE                                                               MD031366
     C                   Z-ADD     DAVDAT        WKMDAT                                    MD027745B
     C                   Z-ADD     DAAM          @@TOTI                                    MD027745B
     C                   ENDIF                                                              MD031366
     C                   ELSE                                                              MD027745B
     C     CNRQ          IFEQ      'M'                                                      MD031125
     C                   Z-ADD     ##INTA        @@TOTI                                     MD031125
     C                   ENDIF                                                              MD031125
     C                   Z-ADD     MDAT          WKMDAT                                    MD027745B
     C                   ENDIF                                                             MD027745B
     C                   ENDIF                                                             MD027745A
      *                                                                                    MD027745A
     C********** WELGTX    IFNE 'G'                                               BUG23515 MD027745A
      *                                                                                     MD031144
      ** Do not compute tax for deposits with negative interest                             MD031144
      *                                                                                     MD031144
     C                   Z-ADD     0             NTOTI            15 0                      MD031144
     C     INTR          COMP      0                                    28                  MD031144
      *                                                                                     MD031144
     C     *IN28         IFEQ      '1'                                                      MD031144
     C     @@TOTI        ANDLT     0                                                        MD031144
     C                   Z-ADD     @@TOTI        NTOTI                                      MD031144
     C                   Z-ADD     0             @@TOTI                                     MD031144
     C                   ENDIF                                                              MD031144
      *                                                                                     MD031144
     C                   CALL      'ZATXCLPI'                                                 232543
      *                                                                                       232543
      ** input                                                                                232543
      *                                                                                       232543
     C                   PARM      'D'           @@MODI            1                          232543
     C**********           PARM WDLNO     @@TRRF 18                                   232543 CER048A
     C                   PARM      WDLNO         @@TRRF           24                         CER048A
     C                   PARM      BRCA          @@BRCA            3                          232543
     C                   PARM      WCNUM         @@CUST            6                          232543
     C                   PARM      SLID          @@STRD            5 0                        232543
     C                   PARM                    @@ENDD            5 0                        232543
     C**********           PARM TOTI      @@TOTI 150                                   232543 235126
     C                   PARM                    @@TOTI           15 0                        235126
     C                   PARM      *ZERO         @@TAXR            6 4                        232543
     C                   PARM      CCY           @@OCYR            3                          232543
     C**********           PARM           PINTH   1                                  CER048 BUG22911
     C**********           PARM TAXI      PINTH   1                                BUG22911 BUG23515
     C                   PARM                    PINTH             1                        BUG23515
      *                                                                                       232543
      ** output                                                                               232543
      *                                                                                       232543
     C                   PARM                    @@IAED           15 0                        232543
     C                   PARM                    @@TAXA           15 0                        232543
     C                   PARM                    @@TOTO           15 0                        232543
     C                   PARM                    @@TXCY            3                          232543
     C                   PARM                    @@CTAX            2                          232543
     C                   PARM                    @@TXBS            2                          232543
     C**********           PARM           @@WTAC  40                                  232543 CER048A
     C                   PARM                    @@WTAC           10 0                       CER048A
     C                   PARM                    @@COLC            2                          232543
     C                   PARM                    @@STAT            5                          232543
     C                   PARM                    @@TRTE            1                          232543
     C                   PARM                    @@TXR1            6 4                        232543
      **********                                                                     CER048 BUG22911
     C**********           PARM           PSTXB   20                                 CER048 BUG22911
     C**********           PARM           PSTAC  100                                 CER048 BUG22911
     C**********           PARM           PSTTR   64                                 CER048 BUG22911
     C**********           PARM           PSTTP   1                                  CER048 BUG22911
     C**********           PARM           PSTXA  150                                 CER048 BUG22911
      **********                                                                     CER048 BUG22911
     C                   PARM                    @@KEY            10                          232543
     C                   PARM                    @@FIL1           10                          232543
     C                   PARM                    @@RTRN            7                          232543
     C     SDTXPA        PARM      SDTXPA        DSSDY                                      BUG22911
      *                                                                                       232543
      ** Restore @@TOTI value to capture it in the confirmation                             MD031144
      *                                                                                     MD031144
     C     *IN28         IFEQ      '1'                                                      MD031144
     C     NTOTI         ANDLT     0                                                        MD031144
     C                   Z-ADD     NTOTI         @@TOTI                                     MD031144
     C                   MOVEL     'NOTAX'       @@RTRN                                     MD031144
     C                   ENDIF                                                              MD031144
      *                                                                                     MD031144
     C                   MOVEL     @@OCYR        OCCY                                      BUG23515B
     C                   MOVEL     @@TXCY        TCCY                                      BUG23515B
      *                                                                                    BUG23515B
     C                   SELECT                                                               232543
      *                                                                                       232543
     C     @@RTRN        WHENEQ    'ERROR'                                                    232543
      *                                                                                       232543
     C                   MOVEL     @@FIL1        W0FILE                                       232543
     C                   MOVEL     @@KEY         W0KEY                                        232543
     C                   Z-ADD     40            W0ERNB                                       232543
     C                   MOVEL     'MEM5004'     W0MSGD                                       232543
     C                   MOVEL     'MIDAS  '     W0MSGF                                       232543
     C                   EXSR      SRERR                                                      232543
      *                                                                                       232543
      ** Print the total interest amount on the confirmation                                  232543
      *                                                                                       232543
     C     @@RTRN        WHENNE    'JOINT'                                                    232543
     C     @@TOTO        IFNE      *ZERO                                                      232543
     C     @@STAT        IFEQ      'TAXAB'                                                    232543
     C     @@STAT        OREQ      'DISCL'                                                    232543
     C     @@STAT        OREQ      'SELF '                                                    232543
     C                   MOVE      'Y'           WTXPI                                        232543
     C                   Z-ADD     @@TAXA        WNTAMT           13 0                        232543
     C**********           EXSR SRCSIN                                                 232543 233277
     C                   MOVEL     PSTXA         WNSTAX                                     BUG23165
     C                   MOVEL     PTTXA         WNTTAX                                       CER054
     C                   MOVEL     PPORT         ACPTHU                                     BUG23515
      *                                                                                     BUG23515
     C********** WELGTX    IFEQ 'L'                                               BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C********** WSGINT    IFNE @@TOTI                                            BUG23515 BUG23515B
     C**********           SUB  WSGINT    @@TOTI                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C**********           ADD  WSTXSR    WNTAMT                                  BUG23515 BUG23515B
     C**********           ADD  WSSTDO    WSTXA                                   BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C     @@RTRN        WHENEQ    'JOINT'                                                    232543
     C                   MOVE      ' '           WTXPI                                        232543
     C                   EXSR      SRCALJ                                                     232543
     C                   ENDSL                                                                232543
      *****************************************************************                234602 235126
      ***Consider*the*effective*date*on*the*calculation*of*Tax*********                234602 235126
      *****************************************************************                234602 235126
     C**********           EXSR SRCHKD                                                 234602 235126
      *                                                                                       232543
     C**********           ENDIF                                                    235126 MD027745A
      *                                                                                       235126
     C                   SELECT                                                            BUG23799A
     C     @@STAT        WHENEQ    'SELF'                                                  BUG23799A
     C                   MOVE      'S'           WSTAT                                     BUG23799A
     C     @@STAT        WHENEQ    'DISCL'                                                 BUG23799A
     C                   MOVE      'D'           WSTAT                                     BUG23799A
     C     @@STAT        WHENEQ    'NOTAP'                                                 BUG23799A
     C                   MOVE      'E'           WSTAT                                     BUG23799A
     C                   OTHER                                                             BUG23799A
     C                   MOVE      'T'           WSTAT                                     BUG23799A
      *                                                                                       CER069
     C     CER069        IFEQ      'Y'                                                        CER069
     C                   MOVEL     CNUM          WCNUM                                        CER069
      *                                                                                       CER069
     C     KCTTX         CHAIN     SDACTXL1                           91                      CER069
     C     *IN91         IFEQ      *OFF                                                       CER069
     C     AXETXS        ANDEQ     'Y'                                                        CER069
     C                   MOVEL     AXETXS        WSTAT                                        CER069
     C                   ENDIF                                                                CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C                   ENDSL                                                                CER069
      *                                                                                    BUG23799A
      ** Evaluate Customer Tax Status                                                      BUG23799A
      *                                                                                    BUG23799A
     C     @@STAT        IFEQ      *BLANK                                                  BUG23799A
      *                                                                                    BUG23799A
      ** Retrieve Customer by Country of Tax                                               BUG23799A
      *                                                                                    BUG23799A
     C                   MOVEL     CNUM          WCNUM                                     BUG23799A
      *                                                                                    BUG23799A
     C     KCTTX         CHAIN     SDACTXL1                           91                   BUG23799A
      *                                                                                    BUG23799A
     C     *IN91         IFEQ      *OFF                                                    BUG23799A
     C                   MOVEL     AXETXS        WSTAT                                     BUG23799A
     C                   ENDIF                                                             BUG23799A
     C                   ENDIF                                                             BUG23799A
      *                                                                                    BUG23799A
     C                   ADD       WNTAMT        ##TAXA                                       235126
     C                   ENDIF                                                              BUG23515
     C                   ENDIF                                                                235126
      *
      ** If Tax value at Account level is 'A', this means the EU Tax                          CER069
      ** indicator at Customer level should be used to determine whether                      CER069
      ** the account is taxable.                                                              CER069
      *                                                                                       CER069
     C     TAXI          IFEQ      'A'                                                        CER069
      *                                                                                       CER069
     C                   MOVEL     CNUM          WCNUM                                        CER069
     C     KCTTX         CHAIN     SDACTXL1                           91                      CER069
     C     *IN91         IFEQ      '0'                                                        CER069
      *                                                                                       CER069
     C     AXETXS        IFEQ      'S'                                                        CER069
     C     AXETXS        OREQ      'D'                                                        CER069
     C     AXETXS        OREQ      'E'                                                        CER069
     C                   MOVE      'N'           TAXI                                         CER069
     C                   ELSE                                                                 CER069
     C                   MOVE      AXETXS        TAXI                                         CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C                   ENDIF                                                                CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C     EXDTAX        TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************                       232543
     C/SPACE 5                                                                                234865
      *****************************************************************                       234865
      * Subroutine  :  SRETAX                                         *                       234865
      * Function    :  Determine EU Tax Amount                        *                       234865
      *                                                               *                       234865
      * Called by   :                                                 *                       234865
      * Calls       :                                                 *                       234865
      *****************************************************************                       234865
     C     SRETAX        BEGSR                                                                234865
      *                                                                                       234865
      **  Set up subroutine stack name                                                        234865
     C                   ADD       1             Q                                            234865
     C                   MOVEL     'SRETAX'      @STK(Q)                                      234865
      *                                                                                       234865
      *................................................................                       234865
      *                                                                                       234865
      ** EU Tax extraction                                                                    234865
      *                                                                                       234865
     C     CGL031        IFEQ      'Y'                                                        234865
      *                                                                                       234865
     C                   Z-ADD     MDAT          WKMDAT                                       234865
      *                                                                                       234865
      ** Retrieve Settlement Account                                                          234865
      *                                                                                       234865
     C                   MOVEL     'ZAGETSET'    WRLE1            10                          234865
     C                   MOVE      'AC'          WRLE1                                        234865
      *                                                                                       234865
     C                   MOVE      CCY           P@ACCY                                       234865
     C**********           MOVE BRCA      P@BRCA                                       234865 235126
     C     IPDS          IFEQ      'Y'                                                        234865
     C                   MOVE      IMET          P@STYP                                       234865
     C                   MOVEL     INSA          P@SACT                                       235126
     C                   MOVE      INSA          P@BRCA                                       235126
     C**********           MOVE INSA      P@SACT                                       234865 235126
     C                   ELSE                                                                 234865
     C                   Z-ADD     PSTM          P@STYP                                       234865
     C                   MOVE      PONS          P@SACT                                       234865
     C                   MOVE      POBR          P@BRCA                                       235126
     C                   ENDIF                                                                234865
     C                   MOVE      CNUM          P@CNUM                                       235126
      *                                                                                       235126
     C     P@STYP        IFEQ      04                                                         235126
     C     WDLCUS        ANDNE     'Y'                                                      MD026788
     C     P@STYP        OREQ      05                                                         235126
     C     WDLCUS        ANDNE     'Y'                                                      MD026788
     C     P@STYP        OREQ      14                                                         235126
     C     WDLCUS        ANDNE     'Y'                                                      MD026788
      *                                                                                       234865
     C                   CALL      WRLE1                                                      234865
      *                                                                                       234865
      ** Output Parameters                                                                    234865
      *                                                                                       234865
     C                   PARM      *BLANKS       P@RETC           10                          234865
     C                   PARM      *ZEROS        P@ACCT                                       234865
     C                   PARM      *ZEROS        P@ASEQ                                       234865
     C                   PARM      'N'           P@MEIN            1                          234865
     C                   PARM      'N'           P@PRIN            1                          234865
      *                                                                                       234865
      ** Input/Output Parameters                                                              234865
      *                                                                                       234865
     C                   PARM                    P@BRCA            3                          234865
     C**********           PARM *ZEROS    P@CNUM                                       234865 235126
     C                   PARM                    P@CNUM                                       235126
     C                   PARM                    P@ACCY            3                          234865
      *                                                                                       234865
      ** Input Parameters                                                                     234865
      *                                                                                       234865
     C                   PARM                    P@STYP                                       234865
     C**********           PARM           P@SACT 12                                  234865 BUG11111
     C                   PARM                    P@SACT                                     BUG11111
      *                                                                                       235126
     C     P@RETC        IFNE      *BLANKS                                                    235126
     C     *LOCK         IN        LDA                                                        235126
     C                   MOVEL     P@SACT        DBKEY                                        235126
     C                   Z-ADD     101           DBASE                                        235126
     C                   OUT       LDA                                                        235126
     C                   EXSR      *PSSR                                                      235126
     C                   ENDIF                                                                235126
      *                                                                                       235126
     C                   ELSE                                                                 235126
      *                                                                                       235126
     C                   MOVEL     BRCA          P@BRCA                                       235126
     C                   MOVEL     CNUM          P@CNUM                                       235126
     C                   MOVEL     CCY           P@ACCY                                       235126
      *                                                                                       235126
     C                   ENDIF                                                                235126
      *                                                                                       234865
     C                   MOVE      P@CNUM        WCNUM             6                          234865
     C                   MOVE      DLNO          WDLNO             6                          234865
      *                                                                                       235126
     C                   EXSR      SRCHKD                                                     235126
      *                                                                                       235126
     C                   Z-ADD     WKMDAT        @@ENDD                                       234865
      *                                                                                       234865
      ** Extract tax amount and net interest amount when CGL031                               234865
      ** feature is on                                                                        234865
      *                                                                                       234865
     C     WELGTX        IFNE      'G'                                                     BUG23515B
      *                                                                                     MD031144
      ** Do not compute tax for deposits with negative interest                             MD031144
      *                                                                                     MD031144
     C                   Z-ADD     0             NTOTI            15 0                      MD031144
     C     INTR          COMP      0                                    28                  MD031144
      *                                                                                     MD031144
     C     *IN28         IFEQ      '1'                                                      MD031144
     C     @@TOTI        ANDLT     0                                                        MD031144
     C                   Z-ADD     @@TOTI        NTOTI                                      MD031144
     C                   Z-ADD     0             @@TOTI                                     MD031144
     C                   ENDIF                                                              MD031144
      *                                                                                     MD031144
     C                   CALL      'ZATXCLPI'                                                 234865
      *                                                                                       234865
      ** input                                                                                234865
      *                                                                                       234865
     C                   PARM      'D'           @@MODI            1                          234865
     C**********           PARM WDLNO     @@TRRF 18                                   234865 CER048A
     C                   PARM      WDLNO         @@TRRF           24                         CER048A
     C                   PARM      BRCA          @@BRCA            3                          234865
     C                   PARM      WCNUM         @@CUST            6                          234865
     C                   PARM      SLID          @@STRD            5 0                        234865
     C                   PARM                    @@ENDD            5 0                        234865
     C**********           PARM TOTI      @@TOTI 150                                   234865 235126
     C                   PARM                    @@TOTI           15 0                        235126
     C                   PARM      *ZERO         @@TAXR            6 4                        234865
     C                   PARM      CCY           @@OCYR            3                          234865
     C**********           PARM           PINTH                                      CER048 BUG22911
     C**********           PARM TAXI      PINTH                                   BUG22911 BUG23515B
     C                   PARM                    PINTH                                     BUG23515B
      *                                                                                       234865
      ** output                                                                               234865
      *                                                                                       234865
     C                   PARM                    @@IAED           15 0                        234865
     C                   PARM                    @@TAXA           15 0                        234865
     C                   PARM                    @@TOTO           15 0                        234865
     C                   PARM                    @@TXCY            3                          234865
     C                   PARM                    @@CTAX            2                          234865
     C                   PARM                    @@TXBS            2                          234865
     C**********           PARM           @@WTAC  40                                  234865 CER048A
     C                   PARM                    @@WTAC           10 0                       CER048A
     C                   PARM                    @@COLC            2                          234865
     C                   PARM                    @@STAT            5                          234865
     C                   PARM                    @@TRTE            1                          234865
     C                   PARM                    @@TXR1            6 4                        234865
      **********                                                                     CER048 BUG22911
     C**********           PARM           PSTXB                                      CER048 BUG22911
     C**********           PARM           PSTAC                                      CER048 BUG22911
     C**********           PARM           PSTTR                                      CER048 BUG22911
     C**********           PARM           PSTTP                                      CER048 BUG22911
     C**********           PARM           PSTXA                                      CER048 BUG22911
      **********                                                                     CER048 BUG22911
     C                   PARM                    @@KEY            10                          234865
     C                   PARM                    @@FIL1           10                          234865
     C                   PARM                    @@RTRN            7                          234865
     C     SDTXPA        PARM      SDTXPA        DSSDY                                      BUG22911
      *                                                                                       234865
      ** Restore @@TOTI value to capture it in the confirmation                             MD031144
      *                                                                                     MD031144
     C     *IN28         IFEQ      '1'                                                      MD031144
     C     NTOTI         ANDLT     0                                                        MD031144
     C                   Z-ADD     NTOTI         @@TOTI                                     MD031144
     C                   MOVEL     'NOTAX'       @@RTRN                                     MD031144
     C                   ENDIF                                                              MD031144
      *                                                                                     MD031144
     C                   MOVEL     @@OCYR        OCCY                                      BUG23515B
     C                   MOVEL     @@TXCY        TCCY                                      BUG23515B
      *                                                                                    BUG23515B
     C                   SELECT                                                               234865
      *                                                                                       234865
     C     @@RTRN        WHENEQ    'ERROR'                                                    234865
      *                                                                                       234865
     C                   MOVEL     @@FIL1        W0FILE                                       234865
     C                   MOVEL     @@KEY         W0KEY                                        234865
     C                   Z-ADD     40            W0ERNB                                       234865
     C                   MOVEL     'MEM5004'     W0MSGD                                       234865
     C                   MOVEL     'MIDAS  '     W0MSGF                                       234865
     C                   EXSR      SRERR                                                      234865
      *                                                                                       234865
      ** Print the total interest amount on the confirmation                                  234865
      *                                                                                       234865
     C     @@RTRN        WHENNE    'JOINT'                                                    234865
     C     @@TOTO        IFNE      *ZERO                                                      234865
     C     @@STAT        IFEQ      'TAXAB'                                                    234865
     C     @@STAT        OREQ      'DISCL'                                                    234865
     C     @@STAT        OREQ      'SELF '                                                    234865
     C                   Z-ADD     @@TAXA        WNTAMT           13 0                        234865
      *                                                                                       CER048
     C                   MOVEL     PSTXA         WNSTAX           15 0                        CER048
     C                   MOVEL     PTTXA         WNTTAX           15 0                        CER054
     C                   MOVEL     PPORT         ACPTHU                                     BUG23812
      *
     C                   ENDIF                                                                234865
     C                   ENDIF                                                                234865
      *                                                                                       234865
     C     @@RTRN        WHENEQ    'JOINT'                                                    234865
     C                   EXSR      SRCALJ                                                     234865
     C                   ENDSL                                                                234865
      *****************************************************************                234865 235126
      ***Consider*the*effective*date*on*the*calculation*of*Tax*********                234865 235126
      *****************************************************************                234865 235126
     C**********           EXSR SRCHKD                                                 234865 235126
      *                                                                                       234865
     C                   MOVE      *BLANK        WSTAT             1                          234865
      *                                                                                       234865
     C                   SELECT                                                               234865
     C     @@STAT        WHENEQ    'SELF'                                                     234865
     C                   MOVE      'S'           WSTAT                                        234865
     C     @@STAT        WHENEQ    'DISCL'                                                    234865
     C                   MOVE      'D'           WSTAT                                        234865
     C     @@STAT        WHENEQ    'NOTAP'                                                    234865
     C                   MOVE      'E'           WSTAT                                        234865
     C                   OTHER                                                                234865
     C                   MOVE      'T'           WSTAT                                        234865
      *                                                                                       CER069
     C     CER069        IFEQ      'Y'                                                        CER069
     C                   MOVEL     CNUM          WCNUM                                        CER069
      *                                                                                       CER069
     C     KCTTX         CHAIN     SDACTXL1                           91                      CER069
     C     *IN91         IFEQ      *OFF                                                       CER069
     C     AXETXS        ANDEQ     'Y'                                                        CER069
     C                   MOVEL     AXETXS        WSTAT                                        CER069
     C                   ENDIF                                                                CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C                   ENDSL                                                                234865
      *                                                                                       234865
      ** Evaluate Customer Tax Status                                                      BUG23799A
      *                                                                                    BUG23799A
     C     @@STAT        IFEQ      *BLANK                                                  BUG23799A
      *                                                                                    BUG23799A
      ** Retrieve Customer by Country of Tax                                               BUG23799A
      *                                                                                    BUG23799A
     C                   MOVEL     CNUM          WCNUM             6                       BUG23799A
     C     KCTTX         KLIST                                                             BUG23799A
     C                   KFLD                    WCNUM                                     BUG23799A
     C                   KFLD                    DVCNCD                                    BUG23799A
      *                                                                                    BUG23799A
     C     KCTTX         CHAIN     SDACTXL1                           91                   BUG23799A
      *                                                                                    BUG23799A
     C     *IN91         IFEQ      *OFF                                                    BUG23799A
     C                   MOVEL     AXETXS        WSTAT                                     BUG23799A
     C                   ENDIF                                                             BUG23799A
     C                   ENDIF                                                             BUG23799A
      *                                                                                    BUG23799A
     C                   ADD       WNTAMT        ##TAXA                                    BUG23799A
     C                   ENDIF                                                                235126
     C                   ENDIF                                                             BUG23515B
      *                                                                                       234865
      *................................................................                       234865
      *                                                                                       234865
      *                                                                                       CER069
      ** If Tax value at Account level is 'A', this means the EU Tax                          CER069
      ** indicator at Customer level should be used to determine whether                      CER069
      ** the account is taxable.                                                              CER069
      *                                                                                       CER069
     C     TAXI          IFEQ      'A'                                                        CER069
      *                                                                                       CER069
     C                   MOVEL     CNUM          WCNUM                                        CER069
     C     KCTTX         CHAIN     SDACTXL1                           91                      CER069
     C     *IN91         IFEQ      '0'                                                        CER069
      *                                                                                       CER069
     C     AXETXS        IFEQ      'S'                                                        CER069
     C     AXETXS        OREQ      'D'                                                        CER069
     C     AXETXS        OREQ      'E'                                                        CER069
     C                   MOVE      'N'           TAXI                                         CER069
     C                   ELSE                                                                 CER069
     C                   MOVE      AXETXS        TAXI                                         CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C                   ENDIF                                                                CER069
     C                   ENDIF                                                                CER069
     C     EXETAX        TAG                                                                  CER069
      *                                                                                       234865
      **  Unwind subroutine stack name                                                        234865
     C                   MOVEA     *BLANKS       @STK(Q)                                      234865
     C                   SUB       1             Q                                            234865
      *                                                                                       234865
     C                   ENDSR                                                                234865
     C*****************************************************************                       234865
      /EJECT                                                                                  232543
      *****************************************************************                       232543
      *                                                               *                       232543
      *  SRCALJ - Calculate EU Tax Amount for Joint Account Members   *                       232543
      *                                                               *                       232543
      *****************************************************************                       232543
     C     SRCALJ        BEGSR                                                                232543
      *                                                                                       232543
     C     WCNUM         SETLL     SDJACCLB                                                   232543
     C     WCNUM         READE     SDJACCLB                               21                  232543
      *                                                                                       232543
     C                   Z-ADD     *ZEROS        WTAXA                                        232543
      *                                                                                       CER048
     C**********           Z-ADD0         WSTXA  150                                CER048 BUG23515B
     C                   Z-ADD     *ZEROS        WTTAX            15 0                        CER054
     C                   Z-ADD     0             WSTAX            15 0                     BUG23515B
      *                                                                                       232543
     C     *IN21         DOWEQ     *OFF                                                       232543
      *                                                                                       232543
     C                   EXSR      SRCZJA                                                     232543
      *                                                                                       232543
     C     @@TOTO        IFNE      *ZERO                                                      232543
     C     @@STAT        IFEQ      'TAXAB'                                                    232543
     C     @@STAT        OREQ      'DISCL'                                                    232543
     C     @@STAT        OREQ      'SELF '                                                    232543
     C                   MOVE      'Y'           WTXJA                                        232543
     C                   ADD       @@TAXA        WTAXA            15 0                        232543
     C**********           EXSR SRCSIN                                                 232543 233277
      *                                                                                       CER048
     C     WSTAX         ADD       PSTXA         WSTAX            15 0                        CER048
     C     WTTAX         ADD       PTTXA         WTTAX                                        CER054
     C     ACPTHU        ADD       PPORT         ACPTHU                                     BUG23812
      *
     C********** WELGTX    IFEQ 'L'                                               BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C********** WSGINT    IFNE @@TOTI                                            BUG23515 BUG23515B
     C**********           ADD  WSGINT    @@TOTI                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C**********           ADD  WSTXSR    WTAXA                                   BUG23515 BUG23515B
     C**********           ADD  WSSTDO    WSTXA                                   BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C     @@RTRN        IFEQ      'ERROR'                                                    232543
     C                   MOVE      @@FILE        DBFILE                                       232543
     C                   MOVE      @@KEY         DBKEY                                        232543
     C                   MOVE      *ON           *IN15                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   MOVE      *ON           *INU8                                        232543
     C                   MOVE      *ON           *INLR                                        232543
     C                   EXSR      *PSSR                                                      232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C     @@RTRN        IFEQ      'NOTAX'                                                    232543
     C     @@RTRN        OREQ      'TAXAB'                                                    232543
     C     WCNUM         READE     SDJACCLB                               21                  232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C     @@RTRN        IFEQ      'LAST '                                                    232543
     C                   MOVE      *ON           *IN21                                        232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C                   ENDDO                                                                232543
      *                                                                                       232543
     C                   ADD       WTAXA         WNTAMT                                       232543
      *                                                                                       232543
     C                   MOVEL     WSTAX         WNSTAX           15 0                        CER048
     C                   MOVEL     WTTAX         WNTTAX           15 0                        CER054
      *                                                                                       CER048
     C                   ENDSR                                                                232543
      *****************************************************************                       232543
      /EJECT                                                                                  232543
      *****************************************************************                       232543
      *                                                               *                       232543
      *  SRCZJA - Calls European W/Tax Calculation for Joint Accounts *                       232543
      *                                                               *                       232543
      *****************************************************************                       232543
     C     SRCZJA        BEGSR                                                                232543
      *                                                                                       232543
     C********** WELGTX    IFEQ 'L'                                               BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C********** WSGINT    IFNE @@TOTI                                            BUG23515 BUG23515B
     C**********           SUB  WSGINT    @@TOTI                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C                   CALL      'ZATXCLJA'                                                 232543
     C                   PARM      'D'           @@MODI                                       232543
     C                   PARM      WDLNO         @@TRRF                                       232543
     C                   PARM      BRCA          @@BRCA                                       232543
     C                   PARM      WCNUM         @@JANO            6                          232543
     C                   PARM      JCCUST        @@CUST                                       232543
     C                   PARM      JCNAHO        @@NARF           10                          232543
     C                   PARM      JCINVP        @@INVP           10                          232543
     C                   PARM      JCPAHT        @@PAHT            1                        AR761591
     C                   PARM      SLID          @@STRD                                       232543
     C                   PARM                    @@ENDD                                       232543
     C**********           PARM TOTI      @@TOTI                                       232543 235126
     C                   PARM                    @@TOTI                                       235126
     C                   PARM      *ZERO         @@TAXR                                       232543
     C                   PARM      CCY           @@OCYR                                       232543
     C**********           PARM           PINTH                                      CER048 BUG22911
     C                   PARM      TAXI          PINTH                                      BUG22911
      *                                                                                       232543
      ** Output parameters                                                                    232543
      *                                                                                       232543
     C                   PARM                    @@IAED                                       232543
     C                   PARM                    @@TAXA                                       232543
     C                   PARM                    @@TOTO                                       232543
     C                   PARM                    @@TXCY                                       232543
     C                   PARM                    @@CTAX                                       232543
     C                   PARM                    @@TXBS                                       232543
     C                   PARM                    @@WTAC                                       232543
     C                   PARM                    @@COLC                                       232543
     C                   PARM                    @@STAT                                       232543
     C                   PARM                    @@TRTE                                       232543
     C                   PARM                    @@TXR1                                       232543
     C                   PARM                    @@JAMG            1                          232543
      **********                                                                     CER048 BUG22911
     C**********           PARM           PSTXB                                      CER048 BUG22911
     C**********           PARM           PSTAC                                      CER048 BUG22911
     C**********           PARM           PSTTR                                      CER048 BUG22911
     C**********           PARM           PSTTP                                      CER048 BUG22911
     C**********           PARM           PSTXA                                      CER048 BUG22911
      **********                                                                     CER048 BUG22911
     C                   PARM                    @@KEY                                        232543
     C**********           PARM           @@FILE                                      232543 CER048A
     C                   PARM                    @@FIL1                                      CER048A
     C                   PARM                    @@RTRN                                       232543
     C     SDTXPA        PARM      SDTXPA        DSSDY                                        232543
      *                                                                                     BUG26332
     C                   ENDSR                                                                232543
      *****************************************************************                       232543
      /EJECT                                                                                  234602
      *****************************************************************                       234602
      *                                                               *                       234602
      *  SRCHKD - Check and recalculate tax if necessary according    *                       234602
      *           to the effective date                               *                       234602
      *                                                               *                       234602
      *****************************************************************                       234602
     C     SRCHKD        BEGSR                                                                234602
      *                                                                                       234602
      ** Access the Country of Tax using the branch's location code                           234602
      *                                                                                       234602
     C                   CALL      'AOLOCNR0'                                                 234602
     C                   PARM      *BLANKS       PRTCD                                        234602
     C                   PARM      '*KEY   '     POPTN                                        234602
     C                   PARM      A8LCCD        PLOCN             3                          234602
     C     SDLOCN        PARM      SDLOCN        DSFDY                                        234602
      *                                                                                       234602
     C     PRTCD         IFNE      *BLANKS                                                    234602
     C     *LOCK         IN        LDA                                                        234602
     C                   MOVEL     A8LCCD        DBKEY                                        234602
     C                   MOVEL     'SDLOCNPD'    DBFILE                                       234602
     C                   MOVEL     '64'          DBASE                                        234602
     C                   OUT       LDA                                                        234602
     C                   EXSR      *PSSR                                                      234602
     C                   ENDIF                                                                234602
      *                                                                                       234602
      ** Retreive the country of residence of the customer                                    234602
      *                                                                                       234602
     C                   CALL      'AOCUSTR0'                                                 234602
     C                   PARM      *BLANKS       PRTCD                                        234602
     C                   PARM      '*KEY   '     POPTN                                        234602
     C                   PARM      WCNUM         PCNUM            10                          234602
     C                   PARM                    PKEYS             7                          234602
     C     SDCUST        PARM      SDCUST        DSSDY                                        234602
      *                                                                                       234602
     C     PRTCD         IFNE      *BLANKS                                                    234602
     C     *LOCK         IN        LDA                                                        234602
     C                   MOVEL     WCNUM         DBKEY                                        234602
     C                   MOVEL     'SDCUSTPD'    DBFILE                                       234602
     C                   MOVEL     '65'          DBASE                                        234602
     C                   OUT       LDA                                                        234602
     C                   EXSR      *PSSR                                                      234602
     C                   ENDIF                                                                234602
      *                                                                                       234602
      ** Retrieve effective date                                                              234602
      *                                                                                       234602
     C                   CALL      'AOCTTXR0'                                                 234602
     C                   PARM      *BLANKS       PRTCD                                        234602
     C                   PARM      '*KEY   '     POPTN                                        234602
     C                   PARM      DVCNCD        PCTRT             2                          234602
     C                   PARM      BBCOLC        PCTRR             2                          234602
     C     SDCTTX        PARM      SDCTTX        DSFDY                                        234602
      *                                                                                       234602
      ** If no record is found, access with country of tax only                               234602
      *                                                                                       234602
     C     PRTCD         IFEQ      '*NRF   '                                                  235126
     C********** PRTCD     IFNE *BLANKS                                                234602 235126
     C                   CALL      'AOCTTXR0'                                                 234602
     C                   PARM      *BLANKS       PRTCD                                        234602
     C                   PARM      '*KEY   '     POPTN                                        234602
     C                   PARM      DVCNCD        PCTRT                                        234602
     C                   PARM      *BLANKS       PCTRR                                        234602
     C     SDCTTX        PARM      SDCTTX        DSFDY                                        234602
      *                                                                                       234602
     C     PRTCD         IFNE      *BLANKS                                                    234602
     C     *LOCK         IN        LDA                                                        234602
     C     DVCNCD        CAT       BBCOLC        DBKEY                                        234602
     C                   MOVEL     'SDCTTXPD'    DBFILE                                       234602
     C                   MOVEL     '66'          DBASE                                        234602
     C                   OUT       LDA                                                        234602
     C                   EXSR      *PSSR                                                      234602
     C                   ENDIF                                                                234602
     C                   ENDIF                                                                234602
      *                                                                                     BUG23515
     C                   MOVEL     *BLANKS       OCCY                                       BUG23515
     C                   MOVEL     *BLANKS       TCCY                                       BUG23515
      *                                                                                     BUG23515
      ** Set Flag EU, Local or German                                                       BUG23515
      *                                                                                     BUG23515
     C     BBCOLC        IFNE      EWCTRT                                                   BUG23515
     C                   MOVE      'E'           WELGTX            1                        BUG23515
      *                                                                                     BUG23880
      ** Non Resident                                                                       BUG23880
      *                                                                                     BUG23880
     C                   MOVE      'N'           RESID             1                        BUG23880
      *                                                                                     BUG23880
     C                   MOVE      ' '           PINTH                                      BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C     CER048        IFEQ      'Y'                                                      BUG23515
     C     BBCOLC        IFEQ      EWCTRT                                                   BUG23515
     C     EWTHMD        ANDEQ     'Y'                                                      BUG23515
     C                   MOVE      'G'           WELGTX                                     BUG23515
     C                   ELSE                                                               BUG23515
     C                   MOVE      'L'           WELGTX                                     BUG23515
     C                   MOVE      TAXI          PINTH                                      BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   MOVE      'G'           WELGTX                                     BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23880
      ** Resident                                                                           BUG23880
      *                                                                                     BUG23880
     C                   MOVE      'Y'           RESID             1                        BUG23515
      *                                                                                     BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23515
      ** Retrive record from Customer income file                                           BUG23515
      *                                                                                     BUG23515
     C     CER048        IFEQ      'Y'                                                      BUG23515
     C********** WELGTX    ANDNE'E'                                               BUG23515 BUG23515B
     C     WELGTX        ANDEQ     'G'                                                     BUG23515B
      *                                                                                     BUG23515
     C                   RESET                   WSGINT                                     BUG23515
     C                   RESET                   WSTXSR                                     BUG23515
     C                   RESET                   WSSTDO                                     BUG23515
     C                   RESET                   WSPTHU                                    BUG23515B
     C                   MOVE      *BLANKS       WLOOP             1                        BUG23515
      *                                                                                     BUG23515
     C                   MOVE      'D'           TSMODI                                     BUG23515
     C                   MOVE      DLNO          TSDLLN                                     BUG23515
     C                   Z-ADD     VDAT          TSRDNB                                     MD027745
      *                                                                                     BUG23515
     C                   OPEN      SDCSINLE                                                 BUG23515
      *                                                                                     BUG23515
     C********** WKEY2     SETLLSDCSINLE                                           BUG23515 MD027745
     C     WKEY1         SETGT     SDCSINLE                                                 MD027745
     C     WKEY2         READE     SDCSINLE                               88                BUG23515
      *                                                                                     BUG23515
     C     *IN88         DOWEQ     *OFF                                                     BUG23515
      *                                                                                     BUG23515
     C                   MOVE      'Y'           WLOOP                                      BUG23515
     C                   ADD       TSGINT        WSGINT           15 0                      BUG23515
     C                   ADD       TSTXSR        WSTXSR           15 0                      BUG23515
     C                   ADD       TSSTDO        WSSTDO           15 0                      BUG23515
     C                   ADD       TSPTHU        WSPTHU           15 0                      BUG23515
     C**********           Z-ADDTSEDAT    VDAT                                    BUG23515 BUG23515B
      *                                                                                     BUG23515
     C     WKEY2         READE     SDCSINLE                               88                BUG23515
      *                                                                                     BUG23515
     C                   ENDDO                                                              BUG23515
      *                                                                                     BUG23515
     C                   MOVEL     TSOCCY        OCCY              3                        BUG23515
     C                   MOVEL     TSTXCY        TCCY              3                        BUG23515
      *                                                                                     BUG23515
     C                   CLOSE     SDCSINLE                                                 BUG23515
      *                                                                                     BUG23515
     C********** WELGTX    IFEQ 'G'                                               BUG23515 BUG23515B
     C     WLOOP         IFEQ      'Y'                                                      BUG23515
     C***********          Z-ADDWSTXSR    WSTXS1 150                              BUG23515 BUG23515B
     C***********          Z-ADDWSSTDO    WSTXA  150                              BUG23515 BUG23515B
     C                   Z-ADD     WSTXSR        WNTAMT                                    BUG23515B
     C                   Z-ADD     WSSTDO        WNSTAX                                    BUG23515B
     C                   Z-ADD     WSGINT        @@TOTI                                     BUG23515
     C                   Z-ADD     WSPTHU        ACPTHU           15 0                      BUG23515
     C                   ENDIF                                                              BUG23515
     C**********           ENDIF                                                  BUG23515 BUG23515B
      *                                                                                     BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                       234602
      ** Calculate Tax according to the effective date                                        234602
      *                                                                                       234602
     C     WELGTX        IFNE      'G'                                                      BUG23515
      *                                                                                     BUG23515
     C     EWTRT1        IFEQ      '1'                                                        234602
     C     VDAT          ANDLT     EWEDT1                                                     234602
     C********** WKMDAT    ANDGTEWEDT1                                                 234602 235126
     C     WKMDAT        SUB       VDAT          WINTP             5 0                        234602
     C     WKMDAT        SUB       EWEDT1        WEFFP             5 0                        234602
     C     TOTI          MULT(H)   WEFFP         @@TOTI                                       235126
     C                   DIV(H)    WINTP         @@TOTI                                       235126
      *                                                                                       235126
     C     WKMDAT        IFLT      EWEDT1                                                     235126
     C                   Z-ADD     *ZERO         @@TOTI                                       235126
     C                   ENDIF                                                                235126
      *                                                                                       235126
     C                   ELSE                                                                 235126
     C                   Z-ADD     TOTI          @@TOTI                                       235126
      *                                                                                     BUG23515
     C********** WELGTX    IFEQ 'L'                                               BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C********** WSGINT    IFNE @@TOTI                                            BUG23515 BUG23515B
     C********** WSGINT    SUB  @@TOTI    @@TOTI                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
      **********                                                                  BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
     C                   ENDIF                                                                235126
     C                   ENDIF                                                              BUG23515
      *****************************************************************                234602 235126
     C********** WNTAMT    MULT WEFFP     WEFAMT 160                                   234602 235126
     C********** WEFAMT    DIV  WINTP     WNTAMT                                       234602 235126
     C**********           ENDIF                                                       234602 235126
      *                                                                                       234602
     C                   ENDSR                                                                234602
      *****************************************************************                       234602
      /EJECT                                                                                  232543
      *****************************************************************                       232543
      *                                                               *                       232543
      *  SRCSIN - Write record to Customer Income file                *                       232543
      *                                                               *                       232543
      *****************************************************************                       232543
     C********** SRCSIN    BEGSR                                                       232543 233277
      **********                                                                       232543 233277
      ***Write*to Customer Income file only if status is TAXAB, DISCL or               232543 233277
      ***SELF***                                                                       232543 233277
      **********                                                                       232543 233277
     C********** @@STAT    IFNE 'TAXAB'                                                232543 233277
     C********** @@STAT    ANDNE'DISCL'                                                232543 233277
     C********** @@STAT    ANDNE'SELF '                                                232543 233277
     C**********           GOTO ENCSIN                                                 232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADDBJRDNB    TSRDNB                                       232543 233277
     C**********           Z-ADDSLID      TSEDAT                                       232543 233277
      **********                                                                       232543 233277
     C**********           MOVE @@CTAX    TSCTRT                                       232543 233277
     C**********           MOVE @@BRCA    TSBRCA                                       232543 233277
     C**********           MOVE @@CUST    TSCUST                                       232543 233277
      **********                                                                       232543 233277
     C********** WTXJA     IFEQ 'Y'                                                    232543 233277
     C**********           MOVE @@JANO    TSJOIN                                       232543 233277
     C**********           MOVE @@NARF    TSNAHO                                       232543 233277
     C**********           MOVE @@INVP    TSINVP                                       232543 233277
     C**********           ELSE                                                        232543 233277
     C**********           Z-ADD*ZERO     TSJOIN                                       232543 233277
     C**********           MOVE *BLANKS   TSNAHO                                       232543 233277
     C**********           MOVE *BLANKS   TSINVP                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
      ***Customer Status                                                               232543 233277
      **********                                                                       232543 233277
     C**********           SELEC                                                       232543 233277
     C********** @@STAT    WHEQ 'DISCL'                                                232543 233277
     C**********           MOVE 'D'       TSSTAT                                       232543 233277
     C********** @@STAT    WHEQ 'SELF '                                                232543 233277
     C**********           MOVE 'S'       TSSTAT                                       232543 233277
     C********** @@STAT    WHEQ 'TAXAB'                                                232543 233277
     C**********           MOVE 'T'       TSSTAT                                       232543 233277
     C**********           ENDSL                                                       232543 233277
      **********                                                                       232543 233277
      ***Retrieve Customer Details                                                     232543 233277
      **********                                                                       232543 233277
     C**********           EXSR SRCUST                                                 232543 233277
      **********                                                                       232543 233277
     C********** @@CUST    IFNE *BLANKS                                                232543 233277
     C**********           MOVE E5CNA1    TSFAMN                                       232543 233277
     C**********           MOVE E5CNA2    TSFIRN                                       232543 233277
     C********** E5CNA3    CAT  E5CNA4    TSSTRT                                       232543 233277
     C**********           MOVE E5ZIPC    TSZIPC                                       232543 233277
     C**********           MOVE E5CITY    TSCITY                                       232543 233277
     C**********           MOVE E5TINO    TSRTIN                                       232543 233277
     C**********           MOVE E5DBTH    TSDBTH                                       232543 233277
     C**********           MOVE E5BTHT    TSTBTH                                       232543 233277
     C**********           MOVE E5BTHC    TSCBTH                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
     C********** @@NARF    IFNE *BLANKS                                                232543 233277
     C**********           MOVE NHIDE1    TSFAMN                                       232543 233277
     C**********           MOVE NHIDE2    TSFIRN                                       232543 233277
     C********** NHIDE3    CAT  NHIDE4    TSSTRT                                       232543 233277
     C**********           MOVE NHZIPC    TSZIPC                                       232543 233277
     C**********           MOVE NHCITY    TSCITY                                       232543 233277
     C**********           MOVE NHTINO    TSRTIN                                       232543 233277
     C**********           MOVE NHDBTH    TSDBTH                                       232543 233277
     C**********           MOVE NHBTHT    TSTBTH                                       232543 233277
     C**********           MOVE NHBTHC    TSCBTH                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
     C**********           MOVE @@COLC    TSRCTR                                       232543 233277
     C**********           MOVE @@TXBS    TSTXBS                                       232543 233277
     C**********           MOVE @@WTAC    TSWTAC                                       232543 233277
      **********                                                                       232543 233277
      ***Original Currency Details                                                     232543 233277
      **********                                                                       232543 233277
     C**********           MOVE CCY       TSOCCY                                       232543 233277
     C**********           MOVE CCY       PCCY                                         232543 233277
     C**********           EXSR SRCURR                                                 232543 233277
     C********** A6MDIN    IFEQ 'D'                                                    232543 233277
     C**********           Z-ADDA6SPRT    TSOCSR                                       232543 233277
     C**********           ELSE                                                        232543 233277
     C********** 1         DIV  A6SPRT    TSOCSR                                       232543 233277
     C**********           ENDIF                                                       232543 233277
     C**********           MOVE 'D'       TSOCMD                                       232543 233277
     C**********           Z-ADDA6NBDP    TSOCDP                                       232543 233277
      **********                                                                       232543 233277
      ***Settlement Details                                                            232543 233277
      **********                                                                       232543 233277
     C**********           MOVE TSOCCY    TSSCCY                                       232543 233277
     C**********           MOVE TSOCSR    TSSCSR                                       232543 233277
     C**********           MOVE TSOCMD    TSSCMD                                       232543 233277
     C**********           MOVE TSOCDP    TSSCDP                                       232543 233277
      **********                                                                       232543 233277
      ***Tax*Details                                                                   232543 233277
      **********                                                                       232543 233277
     C**********           MOVE @@TXCY    TSTXCY                                       232543 233277
     C**********           MOVE @@TXCY    PCCY                                         232543 233277
     C**********           EXSR SRCURR                                                 232543 233277
     C********** A6MDIN    IFEQ 'D'                                                    232543 233277
     C**********           Z-ADDA6SPRT    TSTCSR                                       232543 233277
     C**********           ELSE                                                        232543 233277
     C********** 1         DIV  A6SPRT    TSTCSR                                       232543 233277
     C**********           ENDIF                                                       232543 233277
     C**********           MOVE 'D'       TSTCMD                                       232543 233277
     C**********           Z-ADDA6NBDP    TSTCDP                                       232543 233277
      **********                                                                       232543 233277
      ***Exchange Rate                                                                 232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADD1         TSXROS                                       232543 233277
     C**********           Z-ADDTSOCSR    ZRATE1 138                                   232543 233277
     C**********           MOVE TSOCMD    ZMDI1   1                                    232543 233277
     C**********           Z-ADDTSTCSR    ZRATE2 138                                   232543 233277
     C**********           MOVE TSTCMD    ZMDI2   1                                    232543 233277
     C**********           EXSR ZXRATE                                                 232543 233277
     C**********           Z-ADDZRATEX    TSXRST                                       232543 233277
     C**********           MOVE 'D'       TSOSMD                                       232543 233277
     C**********           MOVE ZMDIX     TSSTMD                                       232543 233277
      **********                                                                       232543 233277
     C**********           MOVE 'D'       TSMODI                                       232543 233277
     C**********           MOVEL'Deposit 'WWRK1  12                                    232543 233277
     C**********           MOVE 'No. '    WWRK1                                        232543 233277
     C********** WWRK1     CAT  WDLNO     WWRK2  18                                    232543 233277
     C**********           MOVE WWRK2     TSINST                                       232543 233277
     C**********           MOVELDTYP      TSTRTP                                       232543 233277
     C**********           MOVELDLST      TSTRST                                       232543 233277
     C**********           Z-ADDDLNO      TSDLLN                                       232543 233277
     C**********           Z-ADD*ZERO     TSACOD                                       232543 233277
     C**********           Z-ADD*ZERO     TSACSQ                                       232543 233277
     C**********           Z-ADDPCPL      TSPAMT                                       232543 233277
     C**********           Z-ADD@@TOTO    TSGINT                                       232543 233277
     C********** @@TRTE    IFEQ '2'                                                    232543 233277
     C**********           Z-ADD@@TXR1    TSTXRT                                       232543 233277
     C**********           ENDIF                                                       232543 233277
     C**********           Z-ADD@@TAXA    TSTXSR                                       232543 233277
     C********** TSGINT    SUB  TSTXSR    TSNINT                                       232543 233277
     C**********           Z-ADDTSPAMT    TSPAMS                                       232543 233277
     C**********           Z-ADDTSGINT    TSGINS                                       232543 233277
     C**********           Z-ADDTSTXSR    TSTXSS                                       232543 233277
     C**********           Z-ADDTSNINT    TSNINS                                       232543 233277
      **********                                                                       232543 233277
      ***Principal Amount in Tax Currency                                              232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADDPCPL      TSPAMC                                       232543 233277
     C********** TSOCCY    IFNE TSTXCY                                                 232543 233277
     C**********           Z-ADDPCPL      ZAMTCI                                       232543 233277
     C**********           Z-ADDTSXRST    ZEXCH                                        232543 233277
     C**********           MOVE TSSTMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDTSTCDP    ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSPAMC                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
      ***Gross*Interest Amount in Tax Currency                                         232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADD@@TOTO    TSGINC                                       232543 233277
     C********** TSOCCY    IFNE TSTXCY                                                 232543 233277
     C**********           Z-ADD@@TOTO    ZAMTCI                                       232543 233277
     C**********           Z-ADDTSXRST    ZEXCH                                        232543 233277
     C**********           MOVE TSSTMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDTSTCDP    ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSGINC                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
      ***Tax*Deducted at Source in Tax Currency                                        232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADD@@TAXA    TSTXSC                                       232543 233277
     C********** TSOCCY    IFNE TSTXCY                                                 232543 233277
     C**********           Z-ADD@@TAXA    ZAMTCI                                       232543 233277
     C**********           Z-ADDTSXRST    ZEXCH                                        232543 233277
     C**********           MOVE TSSTMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDTSTCDP    ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSTXSC                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
     C********** TSGINC    SUB  TSTXSC    TSNINC                                       232543 233277
      **********                                                                       232543 233277
      ***Principal Amount in Base Currency                                             232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADDPCPL      TSPAMB                                       232543 233277
     C********** TSOCCY    IFNE BJCYCD                                                 232543 233277
     C**********           Z-ADDPCPL      ZAMTCI                                       232543 233277
     C**********           Z-ADDTSOCSR    ZEXCH                                        232543 233277
     C**********           MOVE TSOCMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDZCDPI     ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSPAMB                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
      ***Gross*Interest Amount in Base Currency                                        232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADD@@TOTO    TSGINB                                       232543 233277
     C********** TSOCCY    IFNE BJCYCD                                                 232543 233277
     C**********           Z-ADD@@TOTO    ZAMTCI                                       232543 233277
     C**********           Z-ADDTSOCSR    ZEXCH                                        232543 233277
     C**********           MOVE TSOCMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDZCDPI     ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSGINB                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
      ***Tax*Deducted at Source in Base Currency                                       232543 233277
      **********                                                                       232543 233277
     C**********           Z-ADD@@TAXA    TSTXSB                                       232543 233277
     C********** TSOCCY    IFNE BJCYCD                                                 232543 233277
     C**********           Z-ADD@@TAXA    ZAMTCI                                       232543 233277
     C**********           Z-ADDTSOCSR    ZEXCH                                        232543 233277
     C**********           MOVE TSOCMD    ZMD                                          232543 233277
     C**********           Z-ADDTSOCDP    ZCDPI                                        232543 233277
     C**********           Z-ADDZCDPI     ZCDPO                                        232543 233277
     C**********           EXSR ZCONVN                                                 232543 233277
     C**********           Z-ADDZAMTCO    TSTXSB                                       232543 233277
     C**********           ENDIF                                                       232543 233277
      **********                                                                       232543 233277
     C********** TSGINB    SUB  TSTXSB    TSNINB                                       232543 233277
     C**********           MOVE 'N'       TSINPR                                       232543 233277
      **********                                                                       232543 233277
     C**********           WRITESDCSIND0                                               232543 233277
      **********                                                                       232543 233277
     C********** ENCSIN    ENDSR                                                       232543 233277
      *****************************************************************                       232543
      /EJECT                                                                                  232543
      *****************************************************************                       232543
      *                                                               *                       232543
      *  SRCUST - Retrieve Customer Details                           *                       232543
      *                                                               *                       232543
      *****************************************************************                       232543
     C     SRCUST        BEGSR                                                                232543
      *                                                                                       232543
     C     @@CUST        IFNE      *BLANKS                                                    232543
     C                   CALL      'AOACUSR0'                                                 232543
     C                   PARM      *BLANKS       PRTCD                                        232543
     C                   PARM      '*KEY   '     POPTN                                        232543
     C                   PARM      @@CUST        P@CUST            6                          232543
     C********** SDACUS    PARM SDACUS    DSSDY                                        232543 CER050
     C     SDACUS        PARM      SDACUS        DSLDY                                        CER050
      *                                                                                       232543
     C     PRTCD         IFNE      *BLANKS                                                    232543
     C                   MOVEL     'SDACUSPD'    DBFILE                                       232543
     C                   MOVEL     @@CUST        DBKEY                                        232543
     C                   MOVEL     '065'         DBASE                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   MOVE      *ON           *INU8                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   EXSR      *PSSR                                                      232543
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C     @@NARF        IFNE      *BLANKS                                                    232543
     C                   CALL      'AONAHOR0'                                                 232543
     C                   PARM      *BLANKS       PRTCD                                        232543
     C                   PARM      '*KEY   '     POPTN                                        232543
     C                   PARM      @@NARF        PNAHO            10                          232543
     C********** SDNAHO    PARM SDNAHO    DSSDY                                      232543 BUG24029
     C     SDNAHO        PARM      SDNAHO        DSLDY                                      BUG24029
      *                                                                                       232543
     C     PRTCD         IFNE      *BLANKS                                                    232543
     C                   MOVEL     'SDNAHOPD'    DBFILE                                       232543
     C                   MOVEL     @@NARF        DBKEY                                        232543
     C                   MOVEL     '066'         DBASE                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   MOVE      *ON           *INU8                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   EXSR      *PSSR                                                      232543
     C                   ENDIF                                                                232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C                   ENDSR                                                                232543
      *****************************************************************                       232543
      /EJECT                                                                                  232543
      *****************************************************************                       232543
      *                                                               *                       232543
      *  SRCURR - Retrieve Currency Details                           *                       232543
      *                                                               *                       232543
      *****************************************************************                       232543
     C     SRCURR        BEGSR                                                                232543
      *                                                                                       232543
     C                   CALL      'AOCURRR0'                                                 232543
     C                   PARM      *BLANKS       PRTCD                                        232543
     C                   PARM      '*KEY   '     POPTN                                        232543
     C                   PARM                    PCCY              3                          232543
     C     SDCURR        PARM      SDCURR        DSSDY                                        232543
      *                                                                                       232543
     C     PRTCD         IFNE      *BLANKS                                                    232543
     C                   MOVEL     'SDCURRPD'    DBFILE                                       232543
     C                   MOVEL     PCCY          DBKEY                                        232543
     C                   MOVEL     '067'         DBASE                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   MOVE      *ON           *INU8                                        232543
     C                   MOVE      *ON           *INU7                                        232543
     C                   EXSR      *PSSR                                                      232543
     C                   ENDIF                                                                232543
      *                                                                                       232543
     C                   ENDSR                                                                232543
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDSET                                         *
      * Function    :  Determine Settlement Instruction Fields        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDSET        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDSET'      @STK(Q)
      *
      *................................................................
      *
     C                   CALL      'CG99DSET'                           99      *
      *
     C** In
      *
     C                   PARM                    ##PYRC            1            *Pay/Receive
     C                   PARM                    ##CCY             3            *Settlemt currncy
     C                   PARM                    ##ROLL            1            *Rollover
     C                   PARM                    ##SETP            2            *Settlemt type
     C                   PARM                    ##STBR            3            *Settlemt branch
     C**********           PARM           ##OURN 12        *Our nostro/ A/C                   CGL029
     C                   PARM                    ##OURN           18                          CGL029
     C                   PARM                    ##THRN           10            *Their nostro
     C                   PARM                    ##FACO           10            *For account of
     C                   PARM      BBBRCA        ##BKBR            3            *Booking  branch
     C                   PARM      BBBICN        ##BKBB            6            *Booking  br BICN
     C*********************PARM CPCUST    ##CNTP  6        *Customer      081961
     C                   PARM      ##CUST        ##CNTP            6            *Customer     081961
     C                   PARM      BNACCD        ##CSAC           10                          CGL029
     C                   PARM      BMACCD        ##CADC           10                          CGL029
     C                   PARM      BKACCD        ##COMS           10                          CGL029
     C                   PARM      BLACCD        ##DEFA           10                          CGL029
     C**********           PARM BNACCD    ##CSAC  4        *Compen.Susp. A/C                  CGL029
     C**********           PARM BMACCD    ##CADC  4        *Current A/C dflt                  CGL029
     C**********           PARM BKACCD    ##COMS  4        *Computer Sus A/C                  CGL029
     C**********           PARM BLACCD    ##DEFA  4        *Tradng Dflt A/C                   CGL029
     C                   PARM      BJLCCY        ##LOCY            3            *Local Currency
     C                   PARM      BLONOC        ##ONOC            1            *Ourselves/Nostro
      *
      ** Out
      *
     C                   PARM      *BLANKS       ##OAC1            3            *Our Line 1
     C                   PARM      *BLANKS       ##OAC2            3            *Our Line 2
     C                   PARM      *BLANKS       ##ONN            30            *Our Nostro Name
     C                   PARM      *BLANKS       ##ONT            20            *Our Nostro Town
     C*********************PARM *BLANKS   ##OGA  20        *Our GL A/C                       BUG7326
     C                   PARM      *BLANKS       ##OGA            24            *Our GL A/C  BUG7326
     C                   PARM      *BLANKS       ##ORA            20            *Our RE a/C
     C                   PARM      *BLANKS       ##TAC1            3            *Thr Line 1
     C                   PARM      *BLANKS       ##TAC2            3            *Thr Line 2
     C                   PARM      *BLANKS       ##TNN            30            *Thr Nostro Name
     C                   PARM      *BLANKS       ##TNT            20            *Thr Nostro Town
     C                   PARM      *BLANKS       ##FAL1            3            *FACO Line 1
     C                   PARM      *BLANKS       ##FAL2            3            *FACO Line 2
     C                   PARM      *BLANKS       ##FAN            30            *FACO Name
     C                   PARM      *BLANKS       ##FAT            20            *FACO Town
     C                   PARM      *BLANKS       ##RTCD            7            *Return Code
     C/COPY WNCPYSRC,CG4110C062
      *
     C     *IN99         IFEQ      '1'
     C     ##RTCD        ORNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'CG99DSET'    W0FILE                         ***************
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 12 *
     C                   Z-ADD     12            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDEAL                                         *
      * Function    :  Access Deal                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDEAL        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDEAL'      @STK(Q)
      *
      *................................................................
      *
     C                   MOVEA     '00000'       *IN(01)
     C     DTDLNO        CHAIN     DEALS                              99
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP19                                                               S01408
     C*                                                                                       S01408
      *
      ** IF DEAL NOT FOUND, OR INVALID FORMAT ACCESSED
      *
     C     *IN99         IFEQ      '1'
     C     *IN01         ORNE      '1'
     C     *IN02         ANDNE     '1'
     C     *IN03         ANDNE     '1'
     C     *IN04         ANDNE     '1'
     C     *IN05         ANDNE     '1'
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'DEALS   '    W0FILE                         ***************
     C                   MOVEL     DLNO          W0KEY                          * DB ERROR 13 *
     C                   Z-ADD     13            W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
     C/COPY WNCPYSRC,CG4110C058
      *---------------------------------------------------------------*
      *
     C     EXDEAL        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
     C*
     C                   ENDSR
     C********************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDEAM                                         *
      * Function    :  Access Deal Amendment                          *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDEAM        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDEAM'      @STK(Q)
      *
      *................................................................
      *
     C     DEAMSK        KLIST
     C                   KFLD                    DTDLNO
     C                   KFLD                    DTVDAT
     C                   KFLD                    DTDASN
     C*
     C                   MOVEA     '0'           *IN(06)
     C     DEAMSK        CHAIN     DEAMS                              99
      *
      ** IF DEAL NOT FOUND, OR INVALID FORMAT ACCESSED
      *
     C     *IN99         IFEQ      '1'
     C     *IN06         ORNE      '1'
      *
      ** DATABASE ERROR
      *
     C                   MOVE      DTDLNO        #DLNO
     C                   MOVE      DTVDAT        #VDAT
     C                   MOVE      DTDASN        #DASN
      *
     C                   MOVEL     'DEAMS   '    W0FILE                         ***************
     C                   MOVEL     #DVD          W0KEY                          * DB ERROR 14 *
     C                   Z-ADD     14            W0ERNB                         ***************
     C                   MOVEL     'MEM5004'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
     C/COPY WNCPYSRC,CGH00010
     C     EXDEAM        TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************                       086158
     C/SPACE 5                                                                                086158
      *****************************************************************                       086158
      * Subroutine  :  MOVDTA                                         *                       086158
      * Function    :  Set up parameters for call to CG4985.          *                       086158
      *                                                               *                       086158
      * Called by   :                                                 *                       086158
      * Calls       :                                                 *                       086158
      *****************************************************************                       086158
     C     MOVDTA        BEGSR                                                                086158
      *                                                                                       086158
      **  Set up subroutine stack name                                                        086158
     C                   ADD       1             Q                                            086158
     C                   MOVEL     'MOVDTA'      @STK(Q)                                      086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C                   CLEAR                   P1PARM                                       086158
     C                   Z-ADD     PSTM          P1PSTM                                       086158
     C                   MOVEL     PONS          P1PONS                                       086158
     C                   MOVEL     PIBN          P1PIBN                                       086158
     C                   MOVEL     PIBA          P1PIBA                                       086158
     C**********           Z-ADDPOBN      P1POBN                                       086158 CSD027
     C**********           Z-ADDPOCN      P1POCN                                       086158 CSD027
     C                   MOVE(P)   POBN          P1POBN                                       CSD027
     C                   MOVE(P)   POCN          P1POCN                                       CSD027
     C                   MOVEL     RCRN          P1RCRN                                       086158
     C                   MOVEL     RCRA          P1RCRA                                       086158
     C                   MOVEL     RVNO          P1RVNO                                       086158
     C                   MOVEL     AWBN          P1AWBN                                       086158
     C                   MOVEL     AWBA          P1AWBA                                       087117
     C                   MOVEL     BENN          P1BENN                                       086158
     C                   MOVEL     BENA          P1BENA                                       086158
     C                   MOVEL     DTP1          P1DTP1                                       086158
     C                   MOVEL     DTP2          P1DTP2                                       086158
     C                   MOVEL     DTP3          P1DTP3                                       086158
     C                   MOVEL     DTP4          P1DTP4                                       086158
     C                   MOVEL     DCHG          P1DCHG                                       086158
     C                   MOVEL     BTB1          P1BTB1                                       086158
     C                   MOVEL     BTB2          P1BTB2                                       086158
     C                   MOVEL     BTB3          P1BTB3                                       086158
     C                   MOVEL     BTB4          P1BTB4                                       086158
     C                   MOVEL     BTB5          P1BTB5                                       086158
     C                   MOVEL     BTB6          P1BTB6                                       086158
      *                                                                                       086158
     C                   SELECT                                                               086158
     C     *IN02         WHENEQ    *ON                                                        086158
     C     *IN03         OREQ      *ON                                                        086158
     C     *IN04         OREQ      *ON                                                        086158
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     STCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     STCY          P1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     CCY           P1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C     *IN01         WHENEQ    *ON                                                        086158
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     PSCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     PSCY          P1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     PUCY          P1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C     *IN05         WHENEQ    *ON                                                        086158
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     PSCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     PSCY          P1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     UCUCY         P1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C                   ENDSL                                                                086158
      *                                                                                       086158
     C                   CLEAR                   P2PARM                                       086158
     C                   MOVEL     S#PATH        P2PARM                                       086158
      *                                                                                       086158
     C                   CLEAR                   P3PARM                                       086158
     C                   Z-ADD     ##OSEQ        P1OSEQ                                       086158
     C                   Z-ADD     ##ITEM        P1ITEM                                       086158
     C                   Z-ADD     DETBIN        P1TBIN                                       086158
     C                   Z-ADD     DEPBIN        P1PBIN                                       086158
      *                                                                                       087000
      ** 087000 - set up details for primary retail account                                   087000
     C******************** MOVELBRCA      P1BRCH                                        087000088485
     C     CNRQ          IFEQ      'C'                                                        088485
     C                   MOVEL     OSBR          P1BRCH                                       088485
     C                   ELSE                                                                 088485
     C                   MOVEL     POBR          P1BRCH                                       088485
     C                   ENDIF                                                                088485
     C                   MOVEL     CNUM          P1CNUM                                       087000
     C                   MOVEL     BMACCD        P1ACCD                                       087000
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C     EXVDTA        TAG                                                                  086158
      *                                                                                       086158
      **  Unwind subroutine stack name                                                        086158
     C                   MOVEA     *BLANKS       @STK(Q)                                      086158
     C                   SUB       1             Q                                            086158
      *                                                                                       086158
     C                   ENDSR                                                                086158
     C*****************************************************************                       086158
     C/SPACE 5                                                                                086158
      *****************************************************************                       086158
      * Subroutine  :  MOVDTB                                         *                       086158
      * Function    :  Set up parameters for call to CG4975.          *                       086158
      *                                                               *                       086158
      * Called by   :                                                 *                       086158
      * Calls       :                                                 *                       086158
      *****************************************************************                       086158
     C     MOVDTB        BEGSR                                                                086158
      *                                                                                       086158
      **  Set up subroutine stack name                                                        086158
     C                   ADD       1             Q                                            086158
     C                   MOVEL     'MOVDTB'      @STK(Q)                                      086158
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C                   CLEAR                   P6PARM                                       086158
     C                   Z-ADD     RSTM          P1RSTM                                       086158
     C                   MOVEL     RONS          P1RONS                                       086158
     C                   MOVEL     RIBN          P1RIBN                                       086158
     C                   MOVEL     RIBA          P1RIBA                                       086158
     C**********           Z-ADDROBN      P1ROBN                                       086158 CSD027
     C**********           Z-ADDROCN      P1ROCN                                       086158 CSD027
     C                   MOVE(P)   ROBN          P1ROBN
     C                   MOVE(P)   ROCN          P1ROCN
     C******************** MOVELBRCA      R1BRCH                                        086158088485
     C     CNRQ          IFEQ      'C'                                                        088485
     C                   MOVEL     OSBR          R1BRCH                                       088485
     C                   ELSE                                                                 088485
     C                   MOVEL     ROBR          R1BRCH                                       088485
     C                   ENDIF                                                                088485
      *
     C**  If EMU CEU003 is installed, use settlement currency if                              150163
     C**  defined.                                                                            150163
     C*                                                                                       150163
     C                   SELECT                                                               086153
     C     *IN02         WHENEQ    *ON                                                        086153
     C     *IN03         OREQ      *ON                                                        086153
     C     *IN04         OREQ      *ON                                                        086153
     C*                                                                                       086153
     C     CEU003        IFEQ      'Y'                                                        150163
     C     STCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     STCY          R1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     CCY           R1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C     *IN01         WHENEQ    *ON                                                        086158
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     RSCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     RSCY          R1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     SLCY          R1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C     *IN05         WHENEQ    *ON                                                        086158
     C*                                                                                       150163
     C     CEU003        IFEQ      'Y'                                                        150163
     C     RSCY          ANDNE     *BLANKS                                                    150163
     C                   MOVEL     RSCY          R1CCY                                        150163
     C                   ELSE                                                                 150163
     C                   MOVEL     TCUCY         R1CCY                                        086158
     C                   ENDIF                                                                150163
     C*                                                                                       150163
     C                   ENDSL                                                                086158
      *                                                                                       086158
     C                   CLEAR                   P4PARM                                       086158
     C                   MOVEL     S#PATH        P4PARM                                       086158
      *                                                                                       086158
     C                   CLEAR                   P5PARM                                       086158
     C                   Z-ADD     ##OSEQ        R1OSEQ                                       086158
     C                   Z-ADD     ##ITEM        R1ITEM                                       086158
     C                   Z-ADD     DETBIN        R1TBIN                                       086158
     C                   Z-ADD     DEPBIN        R1PBIN                                       086158
      *                                                                                       087000
      ** 087000 - set up details for primary retail account                                   087000
     C                   MOVEL     CNUM          R1CNUM                                       087000
     C                   MOVEL     BMACCD        R1ACCD                                       087000
      *                                                                                       086158
      *................................................................                       086158
      *                                                                                       086158
     C     EXVDTB        TAG                                                                  086158
      *                                                                                       086158
      **  Unwind subroutine stack name                                                        086158
     C                   MOVEA     *BLANKS       @STK(Q)                                      086158
     C                   SUB       1             Q                                            086158
      *                                                                                       086158
     C                   ENDSR                                                                086158
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C     SRGENR        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRGENR'      @STK(Q)
      *
      *................................................................
      *                                                                                       088492
      ** Exit if Internal Funding Loan or Deposit                                             088492
      *                                                                                       088492
     C     ##DTYP        IFEQ      'ID'                                                       088492
     C     ##DTYP        OREQ      'IL'                                                       088492
     C                   MOVEL     'N'           ##COPD                                       088492
     C                   GOTO      EXGENR                                                     088492
     C                   ENDIF                                                                088492
      *
     C     CNRQ          IFEQ      'T'                                                        244570
     C     CNRQ          OREQ      't'                                                        244570
     C     CNRQ          OREQ      'O'                                                        244570
     C     CNRQ          OREQ      'o'                                                        244570
     C                   MOVEL     'N'           ##COPD                                       244570
     C                   GOTO      EXGENR                                                     244570
     C                   ENDIF                                                                244570
      *                                                                                       244570
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                   MOVEL     BRCA          DRBRCA
     C                   MOVEL     ORBR          DRORBR
     C                   MOVEL     'DL'          DRMODI
     C                   MOVEL     DLNO          DRMTRN
     C                   MOVEL     *BLANK        DRMACT
      *
      ** Print Type
      *
     C/COPY WNCPYSRC,CG4110C014
     C     CNRQ          IFEQ      'C'
     C     AMTP          ANDEQ     'PI'
     C     CNRQ          OREQ      'C'
     C     AMTP          ANDEQ     'PD'
     C                   MOVEL     W#PTPC        DRPTYP                         * Principal Chg
     C                   ELSE
     C     CNRQ          IFEQ      'C'
     C     AMTP          ANDEQ     'SI'
     C     CNRQ          OREQ      'C'
     C     AMTP          ANDEQ     'CI'
     C                   MOVEL     W#PTIN        DRPTYP                         * Interest
     C                   ELSE
     C     CNRQ          IFEQ      'C'
     C     AMTP          ANDEQ     'SC'                                                     BUG17139
     C     CNRQ          OREQ      'C'                                                      BUG17139
     C     AMTP          ANDEQ     'BC'
     C     CNRQ          OREQ      'B'
     C                   MOVEL     W#PTRC        DRPTYP                         * Rate Chg
     C                   ELSE                                                                 CDL017
     C     CNRQ          IFEQ      'C'                                                        CDL017
     C     AMTP          ANDEQ     'EM'                                                       CDL017
     C                   MOVEL     W#PTEM        DRPTYP                         * Early Matur CDL017
     C                   ELSE
     C     CNRQ          IFEQ      'D'
     C     CNRQ          OREQ      'F'
     C     CNRQ          OREQ      'H'
     C                   MOVEL     W#PTRF        DRPTYP                         * Rate Fix
     C                   ELSE
     C     CNRQ          IFEQ      'E'
     C     CNRQ          OREQ      'G'
     C     CNRQ          OREQ      'I'
     C     CNRQ          OREQ      'J'
     C                   MOVEL     W#PTIN        DRPTYP                         * Interest
     C                   ELSE
     C     CNRQ          IFEQ      'M'
     C                   MOVEL     W#PTMA        DRPTYP                         * Maturity
     C                   ELSE                                                                 CIR001
     C     CIR001        IFEQ      'Y'                                                        CIR001
     C     CNRQ          ANDEQ     'K'                                                        CIR001
     C                   MOVEL     W#PTBO        DRPTYP                         * Buy-Out     CIR001
     C                   ENDIF                                                                CIR001
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP17                                                               S01408
     C*                                                                                       S01408
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF                                                                CDL017
     C/COPY WNCPYSRC,CG4110C015
      *
      ** Print Sub Type
      *
     C                   Z-ADD     1             #1
     C     ##DTYP        LOOKUP    ##DT(#1)                               99    *
     C                   MOVEL     ##PS(#1)      DRPSTP                         *
     C/COPY WNCPYSRC,CG4110C005
      *
     C***********          MOVEL'N'       DRATRM                                              087053
      *
     C                   MOVEL     CNUM          ##CUST
      *
     C                   CALL      'CG9010'
     C                   PARM                    ##RTCD            7
     C                   PARM      '*GEN'        ##MODE           10
     C                   PARM      W0CMT         ##CMT             3
     C                   PARM                    ##CUST            6
     C                   PARM                    ##UDCR
     C                   PARM                    ##ITMA            8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C     ##RTCD        IFEQ      *BLANK
      *
     C                   MOVE      'Y'           ##COPD
      *                                                                                       CCG015
      ** Pass reference as PRINTTYPE:SUBTYPE.                                                 CCG015
      *                                                                                       CCG015
     C     DRPTYP        CAT(P)    ':':0         COLON            11                          CCG015
     C     COLON         CAT(P)    DRPSTP:0      ##REFR                                       CCG015
      *                                                                                       CCG015
     C                   EXSR      WRAPRF                                                     CCG015
      *
     C                   ELSE
      *
     C     ##RTCD        IFNE      'CGD1270'
     C                   MOVEL     'CG9010  '    W0FILE
     C                   MOVEL     ##RTCD        W0KEY                          ***************
     C                   Z-ADD     15            W0ERNB                         * DB ERROR 15 *
     C                   MOVEL     'CGD1286'     W0MSGD                         ***************
     C                   MOVEL     'CGUSRMSG'    W0MSGF
     C                   EXSR      SRERR
     C                   ENDIF
     C                   ENDIF
      *
      *................................................................
      *
     C     EXGENR        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C     SRRRDE        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRRRDE'      @STK(Q)
      *
      *................................................................
      *
      **  Reset
     C                   MOVEL     *BLANK        ##R
     C                   MOVEL     *BLANK        ##D
     C                   MOVEL     *BLANK        ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                   Z-ADD     0             #1
     C     *IN99         DOUEQ     '0'
     C     #1            OREQ      20
     C                   Z-ADD     1             #2
     C     ##GRPX        LOOKUP    ##GRP(#2)                              99    *
     C     *IN99         IFEQ      '1'
     C                   ADD       1             #1
     C                   MOVEL     ##RDEA(#2)    ##R(#1)
     C                   ADD       1             ##RDEN
     C                   ENDIF
     C                   ENDDO
      *
      *................................................................
      *
     C     EXRRDE        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C     SRADTA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRADTA'      @STK(Q)
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                   EXSR      SRRFMN
      *
      **  Pack RDEs and associated data into data string
     C                   CLEAR                   ##SDS
      *                                                                                       CCG015
      ** Set-up Action Code parameter W0ACT                                                   CCG015
      *                                                                                       CCG015
     C     CCG015        IFEQ      'Y'                                                        CCG015
     C                   MOVE      '*NEWARR '    W0ACT                                        CCG015
     C                   MOVEL     S#PATH        W0SPAT                                       CCG015
     C                   ELSE                                                                 CCG015
     C                   MOVE      '*PACK   '    W0ACT                                        CCG015
     C                   MOVEL     *BLANKS       W0SPAT                                       CCG015
     C                   ENDIF                                                                CCG015
      *                                                                                       CCG015
     C                   CALL      'CG3999'
     C                   PARM      *BLANK        ##RTCD
     C*********************PARM '*PACK   'W0ACT                                               CCG015
     C                   PARM                    W0ACT                                        CCG015
     C                   PARM                    ##R
     C                   PARM                    ##D
     C                   PARM                    ##S
     C                   PARM                    W0SPAT           70                          CCG015
     C                   PARM                    ##RN                                         CCG015
     C                   PARM                    ##DN                                         CCG015
     C                   PARM                    ##FM                                         CCG015
      *
      **  Database error
     C     ##RTCD        IFNE      *BLANK
      *
     C                   MOVEL     'CG3999  '    W0FILE                         ***************
     C                   MOVEL     ##RTCD        W0KEY                          * DB ERROR 16 *
     C                   Z-ADD     16            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   ENDIF
      *                                                                                       CCG015
      ** Write a XML record for RDE.                                                          CCG015
      *                                                                                       CCG015
     C                   EXSR      WRTRDE                                                     CCG015
      *
      **  Initialise Write Format Parameter.
     C                   CLEAR                   W0FMT
      *
      **  Set up Control Information.
     C                   Z-ADD     ##ITEM        DEITEM
     C                   ADD       1             ##OSEQ
     C                   Z-ADD     ##OSEQ        DEOSEQ
     C                   Z-ADD     1             DEPBIN
     C                   Z-ADD     1             DETBIN
     C                   MOVE      'FR'          DEFSLI
     C                   MOVE      *BLANKS       W0PATH
     C                   MOVEL     S#PATH        W0PATH
      *
      **  Append Data from pack routine.
     C     W0FMT         CAT       ##SDS:0       W0FMT
      *
      *................................................................
      *
     C     EXADTA        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
      /SPACE 5                                                                                CDL006
      *****************************************************************                       CDL006
      * Subroutine  :  SRRLA                                          *                       CDL006
      * Function    :  Subroutine to convert range limits amount held *                       CDL006
      *                on FID charges/comm. file, from base currency  *                       CDL006
      *                to deal currency, if Commission tables in base *                       CDL006
      *                currency.                                      *                       CDL006
      *                                                               *                       CDL006
      * Called by   :  FIDUC                                          *                       CDL006
      * Calls       :                                                 *                       CDL006
      *****************************************************************                       CDL006
     C     SRRLA         BEGSR                                                                CDL006
      *                                                                                       CDL006
      **  Set up subroutine stack name                                                        CDL006
      *                                                                                       CDL006
     C                   ADD       1             Q                                            CDL006
     C                   MOVEL     'SRRLA'       @STK(Q)                                      CDL006
      *                                                                                       CDL006
     C                   Z-ADD     A6SPRT        ZEXCH                                        CDL006
      *                                                                                       CDL006
     C     A6MDIN        IFEQ      'D'                                                        CDL006
     C                   MOVE      'D'           ZMD                                          CDL006
     C                   ELSE                                                                 CDL006
     C                   MOVE      'M'           ZMD                                          CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C                   Z-ADD     A6NBDP        ZCDPO                                        CDL006
      *                                                                                       CDL006
      ** Get base currency details                                                            CDL006
      *                                                                                       CDL006
     C                   MOVEL     BJCYCD        ##CCY                                        CDL006
     C                   EXSR      SRDCDT                                                     CDL006
      *                                                                                       CDL006
     C                   Z-ADD     A6NBDP        ZCDPI                                        CDL006
      *                                                                                       CDL006
      ** Process all array entries.                                                           CDL006
      *                                                                                       CDL006
     C                   Z-ADD     0             I                 2 0                        CDL006
      *                                                                                       CDL006
     C     1             DO        14            I                                            CDL006
     C                   Z-ADD     ZRA(I)        ZAMTCI                                       CDL006
      *                                                                                       CDL006
      ** Convert range limit amount from Base currency to Deal currency                       CDL006
      *                                                                                       CDL006
     C                   EXSR      ZCONVN                                                     CDL006
      *                                                                                       CDL006
     C                   Z-ADD     ZAMTCO        ZRA(I)                                       CDL006
     C/COPY WNCPYSRC,CG4110C107                                                               CDL006
      *                                                                                       CDL006
     C                   ENDDO                                                                CDL006
      *                                                                                       CDL006
      **  Unwind subroutine stack name                                                        CDL006
      *                                                                                       CDL006
     C                   MOVEA     *BLANKS       @STK(Q)                                      CDL006
     C                   SUB       1             Q                                            CDL006
      *                                                                                       CDL006
     C                   ENDSR                                                                CDL006
      *****************************************************************                       CDL006
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C     SRRFMN        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRRFMN'      @STK(Q)
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                   Z-ADD     0             #1
     C     #1            DOUEQ     20
     C                   ADD       1             #1
     C                   MOVEL     ##R(#1)       R#DEFN
     C                   MOVEL     ##D(#1)       R#DATA
      *
      ** If data present and RDE is edited
      *
     C     R#DATA        IFNE      *BLANK
     C     ##RDEC        ANDNE     *BLANK
      *
      * Reformat Amount
     C                   Z-ADD     1             #2
     C     *BLANK        LOOKUP    ##NUMA(#2)                             99    *
     C                   Z-ADD     20            #3
     C                   Z-ADD     0             ##WNUM
     C     #2            DOWGT     1
     C     #2            ANDLE     20
     C     #3            ANDGT     1
     C                   SUB       1             #2
     C                   MOVEL     ##NUMA(#2)    ##W(#3)
     C                   SUB       1             #3
     C                   ENDDO
      *
      * Sign the amount
     C     ##SIGN        IFEQ      '-'
     C                   Z-SUB     ##WNUM        ##NUMB
     C                   ELSE
     C                   Z-ADD     ##WNUM        ##NUMB
     C                   END
      *
      * Default Edit Type
     C     ##EDTT        IFEQ      *BLANK
     C                   MOVEL     ##RDET        ##EDTT
     C                   END
      *
      * Default Decimal Places
     C     ##DCPA        IFEQ      *BLANK
     C                   MOVEL     ##RDED        ##DCPA
     C                   END
      * New RDE data
     C                   MOVEL     R#DATA        ##D(#1)
     C                   ENDIF
     C                   ENDDO
      *
      *................................................................
      *
     C     EXRFMN        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C     SRODTA        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRODTA'      @STK(Q)
      *
      *................................................................
      *
      ** Run CG9020 only if switchable feature CCG015 is *OFF.                                CCG015
      *                                                                                       CCG015
     C     CCG015        IFEQ      'N'                                                        CCG015
      *                                                                                       CCG015
      **  Output PF/CGUDTAPD Record.
     C                   CALL      'CG9020'
     C                   PARM      *BLANK        ##RTCD
     C                   PARM      '*WRITE  '    W0ACT
     C                   PARM                    W0PATH          256
     C                   PARM                    W0FMT
     C                   PARM      *BLANK        W0TITL            7
     C                   PARM      *BLANK        W0ULIN            7
     C                   PARM                    W0CMT
      *
      **  Database error
     C     ##RTCD        IFNE      *BLANK
      *
     C                   MOVEL     'CG9020  '    W0FILE                         ***************
     C                   MOVEL     ##RTCD        W0KEY                          * DB ERROR 17 *
     C                   Z-ADD     17            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   ENDIF
      *
     C                   ENDIF                                                                CCG015
      *................................................................
      *
     C     EXODTA        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDCDT                                         *
      * Function    :  Determine Currency Details                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C     SRDCDT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRDCDT'      @STK(Q)
      *
      *................................................................
      *
      **  Access array of Currency Details already loaded
     C                   Z-ADD     1             C                 3 0
     C     ##CCY         LOOKUP    ##CY(C)                                99
      *
      **  If no match is found determine the next free space in the
      **  loaded currency array.
     C     *IN99         IFEQ      *OFF
     C                   Z-ADD     1             C
     C     *BLANK        LOOKUP    ##CY(C)                                99
      *
      **  If no space is left, set the Currency Data data structure to
      **  the 101st occurrence so that when the new details are
      **  retrieved no existing details are overwritten.
     C     *IN99         IFEQ      *OFF
     C     101           OCCUR     SDCURR
      *
      **  If a space is found, set up the new currency into the array
      **  and position the Currency Data data structure on the
      **  occurrence matching the array index.
     C                   ELSE
     C                   MOVE      ##CCY         ##CY(C)
     C     C             OCCUR     SDCURR
     C                   ENDIF
      *
      **  Retrieve the currency details.
     C                   CALL      'AOCURRR0'
     C                   PARM      *BLANKS       ##RTCD                         B:Return Cd
     C                   PARM      '*KEY'        ##OPTN                         I:Option
     C                   PARM      ##CCY         ##CCYP            3            I:Currency Code
     C     SDCURR        PARM      *BLANK        DSSDY                          O:Format
      *
      **  Database Error
     C     ##RTCD        IFNE      *BLANK
     C                   MOVEL     'SDCURRPD'    W0FILE
     C                   MOVEL     ##CCY         W0KEY                          ***************
     C                   Z-ADD     18            W0ERNB                         * DB ERROR 18 *
     C                   MOVEL     'MEM5004'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   ENDIF
     C/COPY WNCPYSRC,CG4110C006
      *
      **  If the currency has been retrieved earlier, position the
      **  Currency Data data structure on the relevant occurrence.
     C                   ELSE
     C     C             OCCUR     SDCURR
     C/COPY WNCPYSRC,CG4110C108
     C                   ENDIF
     C*
     C     EXDCDT        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
     C*****************************************************************                       CEU003
     C/SPACE 5                                                                                CEU003
      *****************************************************************                       CEU003
      * Subroutine  :  D@EURO                                         *                       CEU003
      * Function    :  EURO Currency Conversion:                      *                       CEU003
      * Converts amount P@FRAM in ccy CCY to amount ##OUTA in ccy STCY*                       CEU003
      * Called by   :  D@DAPC                                         *                       CEU003
      *                D@FRAS                                         *                       CEU003
      *                D@LADS                                         *                       CEU003
      *                D@IRXO                                         *                       CEU003
      *                D@IRXT                                         *                       CEU003
      *                D@CFCS                                         *                       CEU003
      *                D@LAD                                          *                       CEU003
      *                D@FRX                                          *                       CEU003
      *                                                               *                       CEU003
      * Calls       :  EU0200                                         *                       CEU003
      *                SRERR                                          *                       CEU003
      *****************************************************************                       CEU003
     C     D@EURO        BEGSR                                                                CEU003
      *                                                                                       CEU003
     C                   Z-ADD     0             ##OUTA           13 0                        CEU003
     C                   CALL      'EU0200'                                                   CEU003
     C                   PARM      *BLANKS       P@RTCD            7            Return Code   CEU003
     C                   PARM                    P@FRAM           18 3          FROM Ccy Amou CEU003
     C                   PARM                    P@FRCY            3            FROM Currency CEU003
     C                   PARM                    P@TOCY            3            TO Currency   CEU003
     C                   PARM                    P@OUTA           15 0          Outright Amou CEU003
     C                   PARM                    P@INTA           18 3          Interim Amoun CEU003
     C                   PARM                    P@EXRT           15 9          Exchange Rate CEU003
     C                   PARM                    P@MDIN            1            Mult/Div Ind. CEU003
      *                                                                                       CEU003
      ** Database error handling:                                                             CEU003
      *                                                                                       CEU003
     C     P@RTCD        IFEQ      '*ERROR*'                                                  CEU003
     C                   MOVEL     'EU0200  '    W0FILE                                       CEU003
     C                   MOVEL     '*CALL   '    W0KEY                          **************CEU003
     C                   Z-ADD     31            W0ERNB                         * DB ERROR 31 CEU003
     C                   MOVEL     'MEM5003'     W0MSGD                         **************CEU003
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CEU003
     C                   EXSR      SRERR                                                      CEU003
      *                                                                                       CEU003
      ** Otherwise, store amount in settlement currency as ##OUTA                             CEU003
      *                                                                                       CEU003
     C                   ELSE                                                                 CEU003
     C                   MOVE      P@OUTA        ##OUTA                                       CEU003
     C                   ENDIF                                                                CEU003
      *                                                                                       CEU003
     C                   ENDSR                                                                CEU003
      *****************************************************************                       CEU003
     C/SPACE 5                                                                                CDL017
      *****************************************************************                       CDL017
      * Subroutine  :  EM@DAT                                         *                       CDL017
      * Function    :  Extract Early Maturity details                 *                       CDL017
      * Called by   :  D25LAD                                         *                       CDL017
      *                                                               *                       CDL017
      * Calls       :  SRERR                                          *                       CDL017
      *****************************************************************                       CDL017
     C     EM@DAT        BEGSR                                                                CDL017
      *                                                                                       CDL017
      **  Set up subroutine stack name                                                        CDL017
     C                   ADD       1             Q                                            CDL017
     C                   MOVEL     'D_EMDT'      @STK(Q)                                      CDL017
      *                                                                                       CDL017
      *................................................................                       CDL017
      *                                                                                       CDL017
      **  Retrieve subroutine specific data.                                                  CDL017
     C     1             OCCUR     ##SRDT                                                     CDL017
     C                   MOVEL     ##SPAT        S#PATH                                       CDL017
      *                                                                                       CDL017
      **  Set up Path.                                                                        CDL017
     C                   MOVEL     '\D_EMDT'     ##PNAM                                       CDL017
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CDL017
     C                   EXSR      PSHGRS                                                     CDL017
      *                                                                                       CDL017
      **  Retrieve RDE information for RDEs in group set                                      CDL017
      *                                                                                       CDL017
     C                   MOVEL     @STK(Q)       ##GRPS                                       CDL017
     C                   Z-ADD     1             ##RDEN                                       CDL017
     C                   EXSR      SRRRDE                                                     CDL017
      *                                                                                       CDL017
      ** Early Maturity Date                                                                  CDL017
     C                   MOVEL     EMDAT         ##D(1)                                       CDL017
      *                                                                                       CDL017
      ** Early Maturity Penalty Pay/Receive                                                   CDL017
     C                   MOVEL     PENLTY        ##D(2)                                       CDL017
      *                                                                                       CDL017
      ** Early Maturity Base Rate                                                             CDL017
     C                   MOVEL     BRTE          ##D(3)                                       CDL017
      *                                                                                       CDL017
      ** Early Maturity Input User                                                            CDL017
     C                   MOVEL     INPUSR        ##D(4)                                       CDL017
      *                                                                                       CDL017
      ** Early Maturity Authorising User                                                      CDL017
     C                   MOVEL     AUTUSR        ##D(5)                                       CDL017
      *                                                                                       CDL017
      ** Early Maturity Penalty Fee (this is the entered                                      CDL017
      ** deal amendment amount)                                                               CDL017
     C                   MOVEL     DAAM          ##D(6)                                       CDL017
     C                   MOVEL     CCY           ##CCY                                        CDL017
     C                   EXSR      SRDCDT                                                     CDL017
     C                   MOVE      A6NBDP        ##D(6)                                       CDL017
      *                                                                                       CDL017
      **  Accumulate RDE's and associated data and output to                                  CDL017
      **  PF/CGUDTAPD.                                                                        CDL017
     C                   EXSR      SRADTA                                                     CDL017
     C                   EXSR      SRODTA                                                     CDL017
      *                                                                                       CDL017
      *................................................................                       CDL017
      *                                                                                       CDL017
     C     EXMDAT        TAG                                                               AR1097426
      *                                                                                    AR1097426
      **  Unwind subroutine stack name                                                     AR1097426
     C                   EXSR      POPGRS                                                  AR1097426
     C                   MOVEA     *BLANKS       @STK(Q)                                   AR1097426
     C                   SUB       1             Q                                         AR1097426
      *                                                                                       CDL017
     C                   ENDSR                                                                CDL017
      *****************************************************************                       CDL017
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing                             *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C     SRINIT        BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRINIT'      @STK(Q)
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                   CALL      'AOBANKR0'
     C                   PARM      *BLANKS       ##RTCD            7
     C                   PARM      '*FIRST  '    ##OPTN            7
     C     SDBANK        PARM      SDBANK        DSFDY
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AOBANKR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     19            W0ERNB                         * DB ERROR 19 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C*
     C     BJDFIN        COMP      'M'                                    98    MMDDYY, 98 ON
     C*
     C**   DETERMINE NUMBER OF DECIMAL PLACES - BASE CURRENCY
     C*
     C                   MOVEL     BJCYCD        ##CCY
     C                   EXSR      SRDCDT
     C                   Z-ADD     A6NBDP        BASCDP            1 0
      *
      ** CALL ACCESS PROGRAM FOR GENERAL LEDGER DETAILS
      *
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                   CALL      'AOGELRR1'                                                 CGL029
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C     SDGELR        PARM      SDGELR        DSSDY                                        CGL029
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AOGELRR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     20            W0ERNB                         * DB ERROR 20 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
      *
      ** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS
      *
     C                   CALL      'AOMMODR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C     SDMMOD        PARM      SDMMOD        DSFDY
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AOMMODR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     21            W0ERNB                         * DB ERROR 21 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C*
     C** CALL ACCESS PROGRAM FOR DEALING DATA DETAILS
     C*
     C**********           CALL 'AODEALR0'                                                    CGL029
     C                   CALL      'AODEALR1'                                                 CGL029
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C********** SDDEAL    PARM SDDEAL    DSFDY                                               CGL029
     C     SDDEAL        PARM      SDDEAL        DSSDY                                        CGL029
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AODEALR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     22            W0ERNB                         * DB ERROR 22 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C*
     C** CALL ACCESS PROGRAM FOR TRADING DATA DETAILS
     C*
     C                   CALL      'AOTRADR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C     SDTRAD        PARM      SDTRAD        DSFDY
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AOTRADR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     23            W0ERNB                         * DB ERROR 23 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C*
     C** CALL ACCESS PROGRAM FOR RETAIL DETAILS
     C*
     C     BGRTBN        IFEQ      'Y'
     C     BGIOAC        OREQ      'Y'
     C                   CALL      'AORETLR0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C     SDRETL        PARM      SDRETL        DSFDY
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AORETLR0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     24            W0ERNB                         * DB ERROR 24 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C                   END
     C*
     C** CALL ACCESS PROGRAM FOR MESSAGE DETAILS
     C*
     C     BGSWDL        IFEQ      'Y'
     C                   CALL      'AOMGMER0'
     C                   PARM      *BLANKS       ##RTCD
     C                   PARM      '*FIRST  '    ##OPTN
     C     SDMGME        PARM      SDMGME        DSFDY
     C*
     C     ##RTCD        IFNE      *BLANK
      *
      ** DATABASE ERROR
      *
     C                   MOVEL     'AOMGMER0'    W0FILE
     C                   MOVEL     '*CALL'       W0KEY                          ***************
     C                   Z-ADD     25            W0ERNB                         * DB ERROR 25 *
     C                   MOVEL     'MEM5003'     W0MSGD                         ***************
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C                   END
     C/COPY WNCPYSRC,CG4110C044
      *                                                                                       CDL013
      ** Check if CDL013 is installed                                                         CDL013
     C                   CALL      'AOSARDR0'                                                 CDL013
     C                   PARM      *BLANKS       @RTCD             7                          CDL013
     C                   PARM      '*VERIFY'     @OPTN             7                          CDL013
     C                   PARM      'CDL013'      @SARD             6                          CDL013
     C                   PARM                    DSFDY                                        CDL013
      *                                                                                       CDL013
      ** If CDL013 NOT installed, set CAR indicator to '0'                                    CDL013
     C     @RTCD         IFNE      *BLANKS                                                    CDL013
     C                   MOVE      '0'           CDL013            1                          CDL013
      *                                                                                       CDL013
      ** If CDL013 installed                                                                  CDL013
     C                   ELSE                                                                 CDL013
      *                                                                                       CDL013
      ** Set CAR indicator to '1', set Tax Indicator ON and                                   CDL013
      ** declare work field to access WHT ICD extension file.                                 CDL013
     C                   MOVE      '1'           CDL013                                       CDL013
     C                   MOVE      *ON           *IN86                                        CDL013
     C                   MOVEL(P)  'RETAIL'      WTYPE            10                          CDL013
      *                                                                                       CDL013
      ** Open & access WHT ICD extension file to retrieve WHT rate                            CDL013
     C                   OPEN      SDSTAAL1                                                   CDL013
     C     WTYPE         CHAIN     SDSTAAL1                           60                      CDL013
      *                                                                                       CDL013
      ** If CHAIN failed                                                                      CDL013
     C     *IN60         IFEQ      '1'                                                        CDL013
     C                   MOVEL     'SDSTAAL1'    W0FILE                         **************CDL013
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 41 CDL013
     C                   Z-ADD     41            W0ERNB                         **************CDL013
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL013
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL013
     C                   EXSR      SRERR                                                      CDL013
     C                   ENDIF                                                                CDL013
      *                                                                                       CDL013
     C                   ENDIF
     C*
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C*
     C                   CALL      'AOSARDR0'
     C                   PARM      '       '     ##RTCD
     C                   PARM      '*VERIFY'     ##OPTN
     C                   PARM      'S01383'      ##SARD            6
      *
      ** DATABASE ERROR
      *
     C     ##RTCD        IFNE      *BLANK
     C     ##RTCD        ANDNE     '*NRF   '
     C                   MOVEL     'SCSARDPD'    W0FILE                         ***************
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 26 *
     C                   Z-ADD     26            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C*
     C     ##RTCD        IFEQ      *BLANK
     C                   MOVEL     'Y'           S01383            1
     C                   END
     C*
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA
     C*
     C     S01383        IFEQ      'Y'
     C                   MOVE      'D'           KRECI             1
     C     KRECI         CHAIN     SDBRTDD0                           99
     C     *IN99         IFEQ      '1'
     C                   MOVEL     'SDBRTDPD'    W0FILE                         ***************
     C                   MOVEL     'D    '       W0KEY                          * DB ERROR 27 *
     C                   Z-ADD     27            W0ERNB                         ***************
     C                   MOVEL     'MEM5003'     W0MSGD
     C                   MOVEL     'MIDAS  '     W0MSGF
     C                   EXSR      SRERR
     C                   END
     C                   END
      *                                                                                       CIR001
     C/COPY WNCPYSRC,CG4110C049
      ** Access SAR details file to determine if CIR001 is installed.                         CIR001
      *                                                                                       CIR001
     C                   CALL      'AOSARDR0'                                                 CIR001
     C                   PARM      '       '     ##RTCD                                       CIR001
     C                   PARM      '*VERIFY'     ##OPTN                                       CIR001
     C                   PARM      'CIR001'      ##SARD                                       CIR001
      *                                                                                       CIR001
      ** DATABASE ERROR                                                                       CIR001
      *                                                                                       CIR001
     C     ##RTCD        IFNE      *BLANK                                                     CIR001
     C     ##RTCD        ANDNE     '*NRF   '                                                  CIR001
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CIR001
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 28 CIR001
     C                   Z-ADD     28            W0ERNB                         **************CIR001
     C                   MOVEL     'MEM5003'     W0MSGD                                       CIR001
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CIR001
     C                   EXSR      SRERR                                                      CIR001
     C                   END                                                                  CIR001
     C*                                                                                       CIR001
     C     ##RTCD        IFEQ      *BLANK                                                     CIR001
     C                   MOVEL     'Y'           CIR001            1                          CIR001
     C                   ELSE                                                                 CIR001
     C                   MOVEL     'N'           CIR001                                       CIR001
     C                   END                                                                  CIR001
      *                                                                                       CSW005
      ** Access SAR details file to determine if CSW005 is installed.                         CSW005
      *                                                                                       CSW005
     C                   CALL      'AOSARDR0'                                                 CSW005
     C                   PARM      '       '     ##RTCD                                       CSW005
     C                   PARM      '*VERIFY'     ##OPTN                                       CSW005
     C                   PARM      'CSW005'      ##SARD                                       CSW005
      *                                                                                       CSW005
      ** DATABASE ERROR                                                                       CSW005
      *                                                                                       CSW005
     C     ##RTCD        IFNE      *BLANK                                                     CSW005
     C     ##RTCD        ANDNE     '*NRF   '                                                  CSW005
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CSW005
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 29 CSW005
     C                   Z-ADD     29            W0ERNB                         **************CSW005
     C                   MOVEL     'MEM5003'     W0MSGD                                       CSW005
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CSW005
     C                   EXSR      SRERR                                                      CSW005
     C                   ENDIF                                                                CSW005
     C*                                                                                       CSW005
     C     ##RTCD        IFEQ      *BLANK                                                     CSW005
     C                   MOVEL     'Y'           CSW005            1                          CSW005
     C                   ELSE                                                                 CSW005
     C                   MOVEL     'N'           CSW005                                       CSW005
     C                   END                                                                  CSW005
      *                                                                                       CSW011
      ** Access SAR details file to determine if CSW011 is installed.                         CSW011
      *                                                                                       CSW011
     C                   CALL      'AOSARDR0'                                                 CSW011
     C                   PARM      '       '     ##RTCD                                       CSW011
     C                   PARM      '*VERIFY'     ##OPTN                                       CSW011
     C                   PARM      'CSW011'      ##SARD                                       CSW011
      *                                                                                       CSW011
      ** DATABASE ERROR                                                                       CSW011
      *                                                                                       CSW011
     C     ##RTCD        IFNE      *BLANK                                                     CSW011
     C     ##RTCD        ANDNE     '*NRF   '                                                  CSW011
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CSW011
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 30 CSW011
     C                   Z-ADD     30            W0ERNB                         **************CSW011
     C                   MOVEL     'MEM5003'     W0MSGD                                       CSW011
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CSW011
     C                   EXSR      SRERR                                                      CSW011
     C                   ENDIF                                                                CSW011
     C*                                                                                       CSW011
     C     ##RTCD        IFEQ      *BLANK                                                     CSW011
     C                   MOVEL     'Y'           CSW011            1                          CSW011
     C                   ELSE                                                                 CSW011
     C                   MOVEL     'N'           CSW011                                       CSW011
     C                   END                                                                  CSW011
      *                                                                                       CEU014
      ** Access SAR details file to determine if CEU014 is installed.                         CEU014
      *                                                                                       CEU014
     C                   CALL      'AOSARDR0'                                                 CEU014
     C                   PARM      '       '     ##RTCD                                       CEU014
     C                   PARM      '*VERIFY'     ##OPTN                                       CEU014
     C                   PARM      'CEU014'      ##SARD                                       CEU014
      *                                                                                       CEU014
     C     ##RTCD        IFEQ      *BLANK                                                     CEU014
     C                   MOVEL     'Y'           CEU014            1                          CEU014
     C                   ELSE                                                                 CEU014
     C                   MOVEL     'N'           CEU014                                       CEU014
     C                   END                                                                  CEU014
     C*                                                                                       CEU015
     C** Access Switchable Features file to determine if CEU015 is on.                        CEU015
     C*                                                                                       CEU015
     C                   CALL      'AOSARDR0'                                                 CEU014
     C                   PARM      '       '     ##RTCD                                       CEU014
     C                   PARM      '*VERIFY'     ##OPTN                                       CEU014
     C                   PARM      'CEU015'      ##SARD                                       CEU014
      *                                                                                       CEU015
      ** Database error:                                                                      CEU015
      *                                                                                       CEU015
     C     ##RTCD        IFNE      *BLANK                                                     CEU015
     C     ##RTCD        ANDNE     '*NRF   '                                                  CEU015
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CEU015
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 31 CEU015
     C                   Z-ADD     33            W0ERNB                         **************CEU015
     C                   MOVEL     'MEM5003'     W0MSGD                                       CEU015
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CEU015
     C                   EXSR      SRERR                                                      CEU015
     C                   ENDIF                                                                CEU015
     C*                                                                                       CEU015
     C     ##RTCD        IFEQ      *BLANK                                                     CEU015
     C                   MOVEL     'Y'           CEU015            1                          CEU015
     C                   ENDIF                                                                CEU015
     C*                                                                                       CEU015
     C*                                                                                       150163
     C**  Check if CEU003 is installed                                                        150163
     C*                                                                                       150163
     C                   CALL      'AOSARDR0'                                                 150163
     C                   PARM      *BLANKS       @RTCD             7                          150163
     C                   PARM      '*VERIFY'     @OPTN             7                          150163
     C                   PARM      'CEU003'      @SARD             6                          150163
     C*                                                                                       150163
     C     @RTCD         IFEQ      *BLANK                                                     150163
     C                   MOVE      'Y'           CEU003            1                          150163
     C                   ELSE                                                                 150163
     C                   MOVE      'N'           CEU003                                       150163
     C                   ENDIF                                                                150163
      *                                                                                       CDL006
      ** Access Switchable Features file to determine if CDL006 is on.                        CDL006
      *                                                                                       CDL006
     C                   CALL      'AOSARDR0'                                                 CDL006
     C                   PARM      '       '     ##RTCD                                       CDL006
     C                   PARM      '*VERIFY'     ##OPTN                                       CDL006
     C                   PARM      'CDL006'      ##SARD                                       CDL006
      *                                                                                       CDL006
      ** Database error:                                                                      CDL006
      *                                                                                       CDL006
     C     ##RTCD        IFNE      *BLANK                                                     CDL006
     C     ##RTCD        ANDNE     '*NRF   '                                                  CDL006
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CDL006
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 34 CDL006
     C                   Z-ADD     34            W0ERNB                         **************CDL006
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL006
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL006
     C                   EXSR      SRERR                                                      CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
     C     ##RTCD        IFEQ      *BLANK                                                     CDL006
     C                   MOVEL     'Y'           CDL006            1                          CDL006
     C                   ELSE                                                                 CDL006
     C                   MOVEL     'N'           CDL006                                       CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CDL006
      ** If CDL006 is installed and DLCCGTL0 not opened, open the file                        CDL006
      *                                                                                       CDL006
     C     CDL006        IFEQ      'Y'                                                        CDL006
     C     WOPEN         ANDNE     'Y'                                                        CDL006
     C                   OPEN      DLCCGDL0                                                   CDL006
     C                   MOVE      'Y'           WOPEN             1                          CDL006
     C                   ENDIF                                                                CDL006
      *                                                                                       CCG015
      ** Access SAR details file to determine if CCG015 is installed.                         CCG015
      *                                                                                       CCG015
     C                   CALL      'AOSARDR0'                                                 CCG015
     C                   PARM      *BLANKS       PRTCD             7                          CCG015
     C                   PARM      '*VERIFY'     POPTN             7                          CCG015
     C                   PARM      'CCG015'      PSARD             6                          CCG015
     C     SCSARD        PARM      SCSARD        DSSDY                                        CCG015
      *                                                                                       CCG015
      ** Database Error                                                                       CCG015
      *                                                                                       CCG015
     C     PRTCD         IFNE      *BLANK                                                     CCG015
     C     PRTCD         ANDNE     '*NRF   '                                                  CCG015
     C                   MOVEL     'SCSARDPD'    W0FILE                         ************  CCG015
     C                   MOVEL     '*CALL'       W0KEY                          * DBERR 35 *  CCG015
     C                   Z-ADD     35            W0ERNB                         ************  CCG015
     C                   MOVEL     'MEM5003'     W0MSGD                                       CCG015
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CCG015
     C                   EXSR      SRERR                                                      CCG015
     C                   END                                                                  CCG015
      *                                                                                       CCG015
     C                   MOVEL     'N'           CCG015            1                          CCG015
     C     PRTCD         IFEQ      *BLANK                                                     CCG015
     C                   MOVEL     'Y'           CCG015                                       CCG015
     C                   ENDIF                                                                CCG015
      *                                                                                       CDL016
      ** Access SAR details file to determine if CDL016 (Automatic                            CDL016
      ** Rollover of Fixed Term Loan/Deposit) is switched on.                                 CDL016
      *                                                                                       CDL016
     C                   CALL      'AOSARDR0'                                                 CDL016
     C                   PARM      *BLANKS       PRTCD                                        CDL016
     C                   PARM      '*VERIFY'     POPTN                                        CDL016
     C                   PARM      'CDL016'      PSARD                                        CDL016
     C     SCSARD        PARM      SCSARD        DSSDY                                        CDL016
      *                                                                                       CDL016
      ** Database Error                                                                       CDL016
      *                                                                                       CDL016
     C     PRTCD         IFNE      *BLANK                                                     CDL016
     C     PRTCD         ANDNE     '*NRF   '                                                  CDL016
     C                   MOVEL     'SCSARDPD'    W0FILE                         ************  CDL016
     C                   MOVEL     '*CALL'       W0KEY                          * DBERR 36 *  CDL016
     C                   Z-ADD     36            W0ERNB                         ************  CDL016
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL016
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL016
     C                   EXSR      SRERR                                                      CDL016
     C                   END                                                                  CDL016
      *                                                                                       CDL016
     C                   MOVEL     'N'           CDL016            1                          CDL016
     C     PRTCD         IFEQ      *BLANK                                                     CDL016
     C                   MOVEL     'Y'           CDL016                                       CDL016
     C                   ENDIF                                                                CDL016
      *                                                                                       CDL016
      ** Access SAR details file to determine if CDL018 is installed.                         CDL018
      *                                                                                       CDL018
     C                   CALL      'AOSARDR0'                                                 CDL018
     C                   PARM      *BLANKS       PRTCD             7                          CDL018
     C                   PARM      '*VERIFY'     POPTN             7                          CDL018
     C                   PARM      'CDL018'      PSARD             6                          CDL018
     C     SCSARD        PARM      SCSARD        DSSDY                                        CDL018
      *                                                                                       CDL018
      ** Database Error                                                                       CDL018
      *                                                                                       CDL018
     C     PRTCD         IFNE      *BLANK                                                     CDL018
     C     PRTCD         ANDNE     '*NRF   '                                                  CDL018
     C                   MOVEL     'SCSARDPD'    W0FILE                         ************  CDL018
     C                   MOVEL     '*CALL'       W0KEY                          * DBERR 37 *  CDL018
     C                   Z-ADD     37            W0ERNB                         ************  CDL018
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL018
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL018
     C                   EXSR      SRERR                                                      CDL018
     C                   END                                                                  CDL018
      *                                                                                       CDL018
     C                   MOVEL     'N'           CDL018            1                          CDL018
     C     PRTCD         IFEQ      *BLANK                                                     CDL018
     C                   MOVEL     'Y'           CDL018                                       CDL018
     C                   ENDIF                                                                CDL018
      ** Access SAR details file to determine if CDL019 (Allow Base                           CDL019
      ** Rate Changes on Fixed Term Loan/Deposit) is switched on.                             CDL019
      *                                                                                       CDL019
     C                   CALL      'AOSARDR0'                                                 CDL019
     C                   PARM      *BLANKS       PRTCD                                        CDL019
     C                   PARM      '*VERIFY'     POPTN                                        CDL019
     C                   PARM      'CDL019'      PSARD                                        CDL019
     C     SCSARD        PARM      SCSARD        DSSDY                                        CDL019
      *                                                                                       CDL019
      ** Database Error                                                                       CDL019
      *                                                                                       CDL019
     C     PRTCD         IFNE      *BLANK                                                     CDL019
     C     PRTCD         ANDNE     '*NRF   '                                                  CDL019
     C                   MOVEL     'SCSARDPD'    W0FILE                         ************  CDL019
     C                   MOVEL     '*CALL'       W0KEY                          * DBERR 38 *  CDL019
     C                   Z-ADD     38            W0ERNB                         ************  CDL019
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL019
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL019
     C                   EXSR      SRERR                                                      CDL019
     C                   END                                                                  CDL019
      *                                                                                       CDL019
     C                   MOVEL     'N'           CDL019            1                          CDL019
     C     PRTCD         IFEQ      *BLANK                                                     CDL019
     C                   MOVEL     'Y'           CDL019                                       CDL019
     C                   ENDIF                                                                CDL019
      *                                                                                       CGL031
      ** Access SAR details file to determine if CGL031 is installed.                         CGL031
      *                                                                                       CGL031
     C                   CALL      'AOSARDR0'                                                 CGL031
     C                   PARM      *BLANKS       PRTCD             7                          CGL031
     C                   PARM      '*VERIFY'     POPTN             7                          CGL031
     C                   PARM      'CGL031'      PSARD             6                          CGL031
     C     SCSARD        PARM      SCSARD        DSSDY                                        CGL031
      *                                                                                       CGL031
      ** Database Error                                                                       CGL031
      *                                                                                       CGL031
     C     PRTCD         IFNE      *BLANK                                                     CGL031
     C     PRTCD         ANDNE     '*NRF   '                                                  CGL031
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CGL031
     C                   MOVEL     '*CALL'       W0KEY                                        CGL031
     C                   Z-ADD     36            W0ERNB                                       CGL031
     C                   MOVEL     'MEM5003'     W0MSGD                                       CGL031
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CGL031
     C                   EXSR      SRERR                                                      CGL031
     C                   END                                                                  CGL031
      *                                                                                       CGL031
     C                   MOVEL     'N'           CGL031            1                          CGL031
     C     PRTCD         IFEQ      *BLANK                                                     CGL031
     C                   MOVEL     'Y'           CGL031                                       CGL031
     C                   ENDIF                                                                CGL031
      *                                                                                     MD026788
      ** Access System Values                                                               MD026788
      *                                                                                     MD026788
     C     CGL031        IFEQ      'Y'                                                      MD026788
     C                   CALL      'AOSVALR0'                                               MD026788
     C                   PARM      *BLANKS       P@RTCD            7                        MD026788
     C                   PARM      WUSEDL        P@OP01           20                        MD026788
     C                   PARM                    P@VL01          200                        MD026788
     C                   PARM      *BLANK        P@OP02           20                        MD026788
     C                   PARM                    P@VL02          200                        MD026788
     C                   PARM      *BLANK        P@OP03           20                        MD026788
     C                   PARM                    P@VL03          200                        MD026788
     C                   PARM      *BLANK        P@OP04           20                        MD026788
     C                   PARM                    P@VL04          200                        MD026788
     C                   PARM      *BLANK        P@OP05           20                        MD026788
     C                   PARM                    P@VL05          200                        MD026788
     C                   PARM      *BLANK        P@OP06           20                        MD026788
     C                   PARM                    P@VL06          200                        MD026788
     C                   PARM      *BLANK        P@OP07           20                        MD026788
     C                   PARM                    P@VL07          200                        MD026788
     C                   PARM      *BLANK        P@OP08           20                        MD026788
     C                   PARM                    P@VL08          200                        MD026788
     C                   PARM      *BLANK        P@OP09           20                        MD026788
     C                   PARM                    P@VL09          200                        MD026788
     C                   PARM      *BLANK        P@OP10           20                        MD026788
     C                   PARM                    P@VL10          200                        MD026788
      *                                                                                     MD026788
     C     P@RTCD        IFNE      *BLANKS                                                  MD026788
     C     *LOCK         IN        LDA                                                      MD026788
     C                   MOVEL     'SDSVALPD'    DBFILE                         ************MD026788
     C                   MOVEL     '*CALL'       DBKEY                          * DBERROR115MD026788
     C                   MOVEL     '115'         DBASE                          ************MD026788
     C                   OUT       LDA                                                      MD026788
     C                   EXSR      *PSSR                                                    MD026788
     C                   ENDIF                                                              MD026788
      *                                                                                     MD026788
     C                   MOVEL     P@VL01        WDLCUS            1                        MD026788
     C                   ENDIF                                                              MD026788
      *                                                                                       CDL006
      *                                                                                     BUG11112
      ** Access SAR details file to determine if CDL033 is installed.                       BUG11112
      *                                                                                     BUG11112
     C                   CALL      'AOSARDR0'                                               BUG11112
     C                   PARM      '       '     ##RTCD                                     BUG11112
     C                   PARM      '*VERIFY'     ##OPTN                                     BUG11112
     C                   PARM      'CDL033'      ##SARD                                     BUG11112
      *                                                                                     BUG11112
      ** Database Error                                                                     BUG11112
      *                                                                                     BUG11112
     C     ##RTCD        IFNE      *BLANK                                                   BUG11112
     C     ##RTCD        ANDNE     '*NRF   '                                                BUG11112
     C                   MOVEL     'SCSARDPD'    W0FILE                                     BUG11112
     C                   MOVEL     '*CALL'       W0KEY                                      BUG11112
     C                   Z-ADD     37            W0ERNB                                     BUG11112
     C                   MOVEL     'MEM5003'     W0MSGD                                     BUG11112
     C                   MOVEL     'MIDAS  '     W0MSGF                                     BUG11112
     C                   EXSR      SRERR                                                    BUG11112
     C                   END                                                                BUG11112
      *                                                                                     BUG11112
     C     ##RTCD        IFEQ      *BLANK                                                   BUG11112
     C                   MOVEL     'Y'           CDL033            1                        BUG11112
     C                   ELSE                                                               BUG11112
     C                   MOVEL     'N'           CDL033                                     BUG11112
     C                   END                                                                BUG11112
     C/COPY WNCPYSRC,CGH00026                                                               BUG11112
      ** Key in accessing LF/DLCCGDL0                                                         CDL006
      *                                                                                       CDL006
     C     KDLCCG        KLIST                                                                CDL006
     C                   KFLD                    KCYCD             3                          CDL006
     C                   KFLD                    FCMC                                         CDL006
      *                                                                                       CDL006
      * SETLL                                                                                 CIR001
     C     KDTSL         KLIST                                                                CIR001
     C                   KFLD                    W0DLNO            6 0                        CIR001
     C                   KFLD                    W0OTIN            1                          CIR001
     C                   KFLD                    W0RCIP            1                          CIR001
     C                   KFLD                    W0PRDT            5 0                        CIR001
      *                                                                                       CGL031
     C     KSCIN         KLIST                                                                CGL031
     C                   KFLD                    BJRDNB                                       CGL031
     C                   KFLD                    KMODI             1                          CGL031
     C                   KFLD                    DLNO                                         CGL031
      *                                                                                       CIR001
     C     *LIKE         DEFINE    PRDT          W0ZDAY                                       CIR001
      *                                                                                       CSW208
      ** Check if SWIFT 2008 is switched on                                                   CSW208
      ** - If SWIFT 2008 is switched on, check current setup for                              CSW208
      ** system value DLFSWIFTConf                                                            CSW208
      *                                                                                       CSW208
     C                   MOVEL     'N'           CSW208            1                          CSW208
     C                   MOVEL     'N'           DLSWCF            1                          CSW208
     C                   CALL      'SWIF2008'                                                 CSW208
     C                   PARM      *BLANKS       PRTCD                                        CSW208
      *                                                                                       CSW208
     C     PRTCD         IFEQ      'CSW2008'                                                  CSW208
     C                   MOVEL     'Y'           CSW208                                       CSW208
     C                   CALL      'AOSVALR0'                                                 CSW208
     C                   PARM                    P@RTCD            7                          CSW208
     C                   PARM      W#DLSW        P@OP01           20                          CSW208
     C     SVAL1         PARM                    P@VL01          200                          CSW208
     C                   PARM      *BLANK        P@OP02           20                          CSW208
     C                   PARM                    P@VL02          200                          CSW208
     C                   PARM      *BLANK        P@OP03           20                          CSW208
     C                   PARM                    P@VL03          200                          CSW208
     C                   PARM      *BLANK        P@OP04           20                          CSW208
     C                   PARM                    P@VL04          200                          CSW208
     C                   PARM      *BLANK        P@OP05           20                          CSW208
     C                   PARM                    P@VL05          200                          CSW208
     C                   PARM      *BLANK        P@OP06           20                          CSW208
     C                   PARM                    P@VL06          200                          CSW208
     C                   PARM      *BLANK        P@OP07           20                          CSW208
     C                   PARM                    P@VL07          200                          CSW208
     C                   PARM      *BLANK        P@OP08           20                          CSW208
     C                   PARM                    P@VL08          200                          CSW208
     C                   PARM      *BLANK        P@OP09           20                          CSW208
     C                   PARM                    P@VL09          200                          CSW208
     C                   PARM      *BLANK        P@OP10           20                          CSW208
     C                   PARM                    P@VL10          200                          CSW208
      *                                                                                       CSW208
     C     P@RTCD        IFNE      *BLANKS                                                    CSW208
     C     P@RTCD        ANDNE     '*NRF   '                                                  CSW208
     C                   MOVEL     'SDSVALPD'    W0FILE                         **************CSW208
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 36 CSW208
     C                   Z-ADD     36            W0ERNB                         **************CSW208
     C                   MOVEL     'MEM5003'     W0MSGD                                       CSW208
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CSW208
     C                   EXSR      SRERR                                                      CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C     P@RTCD        IFEQ      *BLANKS                                                    CSW208
     C     SVAL11        ANDEQ     'Y'                                                        CSW208
     C                   MOVEL     SVAL11        DLSWCF                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      ** Check if CAS009 is switched on                                                       CSW208
      *                                                                                       CSW208
     C                   MOVEL     'N'           CAS009            1                          CSW208
     C                   CALL      'AOSARDR0'                                                 CSW208
     C                   PARM      *BLANKS       @RTCD             7                          CSW208
     C                   PARM      '*VERIFY'     @OPTN             7                          CSW208
     C                   PARM      'CAS009'      @SARD             6                          CSW208
     C     SCSARD        PARM      SCSARD        DSSDY                                        CSW208
      *                                                                                       CSW208
     C     P@RTCD        IFNE      *BLANKS                                                    CSW208
     C     P@RTCD        ANDNE     '*NRF   '                                                  CSW208
     C                   MOVEL     'SCSARDPD'    W0FILE                         **************CSW208
     C                   MOVEL     '*CALL'       W0KEY                          * DB ERROR 37 CSW208
     C                   Z-ADD     37            W0ERNB                         **************CSW208
     C                   MOVEL     'MEM5003'     W0MSGD                                       CSW208
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CSW208
     C                   EXSR      SRERR                                                      CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C     P@RTCD        IFEQ      *BLANKS                                                    CSW208
     C                   MOVEL     'Y'           CAS009                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      ** Define work fields                                                                   CSW208
      *                                                                                       CSW208
     C     *LIKE         DEFINE    DEPBIN        ##BNDC                                       CSW208
     C     *LIKE         DEFINE    DEPBIN        S#PBIN                                       CSW208
     C     *LIKE         DEFINE    DETBIN        S#TBIN                                       CSW208
     C     *LIKE         DEFINE    WFPEND        MFPDAT                                       CSW208
     C     *LIKE         DEFINE    DFNPYD        WFNPYD                                       CSW208
     C     *LIKE         DEFINE    A6ERLC        WRATE1                                       CSW208
     C     *LIKE         DEFINE    A6MDIN        WMDI1                                        CSW208
     C     *LIKE         DEFINE    HIAMTS        W#AMTS                                       CSW208
     C     *LIKE         DEFINE    PFREQ         W#FREQ                                       CSW208
     C     *LIKE         DEFINE    PDAYNO        W#DAYN                                       CSW208
     C     *LIKE         DEFINE    PMDAY         W#MDAY                                       CSW208
     C     *LIKE         DEFINE    PCCY          W#CCY                                        CSW208
      *                                                                                       CDL081
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                   MOVE      'N'           CDL081            1                          CDL081
     C                   CALL      'AOSARDR0'                                                 CDL081
     C                   PARM      *BLANKS       PRTCD                                        CDL081
     C                   PARM      '*VERIFY'     POPTN                                        CDL081
     C                   PARM      'CDL081'      PSARD                                        CDL081
     C     SCSARD        PARM      SCSARD        DSFDY                                        CDL081
      *                                                                                       CDL081
     C     PRTCD         IFNE      *BLANKS                                                    CDL081
     C     PRTCD         ANDNE     '*NRF   '                                                  CDL081
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CDL081
     C                   Z-ADD     45            W0ERNB                                       CDL081
     C                   MOVEL     'CDL081'      W0KEY                                        CDL081
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL081
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL081
     C                   EXSR      SRERR                                                      CDL081
     C                   END                                                                  CDL081
      *                                                                                       CDL081
     C     PRTCD         IFEQ      *BLANKS                                                    CDL081
     C                   MOVE      'Y'           CDL081                                       CDL081
     C                   ENDIF                                                                CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C     CDL081        IFEQ      'Y'                                                        CDL081
     C                   CALL      'AOSVALR0'                                                 CDL081
     C                   PARM      *BLANKS       PRTCD                                        CDL081
     C                   PARM      C#BASE        SVALK1           20                          CDL081
     C                   PARM                    SVAL1           200                          CDL081
     C                   PARM      C#NBAS        SVALK2           20                          CDL081
     C                   PARM                    SVAL2           200                          CDL081
     C                   PARM      *BLANK        SVALK3           20                          CDL081
     C                   PARM                    SVAL3           200                          CDL081
     C                   PARM      *BLANK        SVALK4           20                          CDL081
     C                   PARM                    SVAL4           200                          CDL081
     C                   PARM      *BLANK        SVALK5           20                          CDL081
     C                   PARM                    SVAL5           200                          CDL081
     C                   PARM      *BLANK        SVALK6           20                          CDL081
     C                   PARM                    SVAL6           200                          CDL081
     C                   PARM      *BLANK        SVALK7           20                          CDL081
     C                   PARM                    SVAL7           200                          CDL081
     C                   PARM      *BLANK        SVALK8           20                          CDL081
     C                   PARM                    SVAL8           200                          CDL081
     C                   PARM      *BLANK        SVALK9           20                          CDL081
     C                   PARM                    SVAL9           200                          CDL081
     C                   PARM      *BLANK        SVALK0           20                          CDL081
     C                   PARM                    SVAL10          200                          CDL081
      *                                                                                       CDL081
     C     PRTCD         IFNE      *BLANKS                                                    CDL081
     C     SVAL1         IFEQ      '*NRF'                                                     CDL081
     C                   MOVEL     SVALK1        W0KEY                                        CDL081
     C                   ENDIF                                                                CDL081
     C     SVAL2         IFEQ      '*NRF'                                                     CDL081
     C                   MOVEL     SVALK2        W0KEY                                        CDL081
     C                   ENDIF                                                                CDL081
     C                   Z-ADD     46            W0ERNB                                       CDL081
     C                   MOVE      'SDSVALPD'    W0FILE                                       CDL081
     C                   MOVEL     'MEM5003'     W0MSGD                                       CDL081
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL081
     C                   EXSR      SRERR                                                      CDL081
     C                   ENDIF                                                                CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                   MOVEL     SVAL1         W#BSRD            1                          CDL081
     C                   MOVEL     SVAL2         W#NBRD            1                          CDL081
     C                   ENDIF                                                                CDL081
     C*                                                                                       S01408
     C/COPY WNCPYSRC,CG4110CP18                                                               S01408
      *                                                                                       CER038
     C                   MOVE      'N'           CER038            1                          CER038
      *                                                                                       CER038
      ** Test if CER038 is installed                                                          CER038
      *                                                                                       CER038
     C                   CALL      'AOSARDR0'                                                 CER038
     C                   PARM      *BLANKS       @RTCD             7                          CER038
     C                   PARM      '*VERIFY'     @OPTN             7                          CER038
     C                   PARM      'CER038'      @SARD             6                          CER038
     C                   PARM                    DSFDY                                        CER038
      *                                                                                       CER038
      ** If CER038 is installed                                                               CER038
      *                                                                                       CER038
     C     @RTCD         IFEQ      *BLANKS                                                    CER038
     C                   MOVE      'Y'           CER038            1                          CER038
     C                   ELSE                                                                 CER038
     C                   MOVE      'N'           CER038                                       CER038
     C                   ENDIF                                                                CER038
      *                                                                                       CER038
     C                   MOVE      'N'           CER043            1                          CER038
      *                                                                                       CER038
      ** Test if CER043 is installed                                                          CER038
      *                                                                                       CER038
     C                   CALL      'AOSARDR0'                                                 CER038
     C                   PARM      *BLANKS       @RTCD             7                          CER038
     C                   PARM      '*VERIFY'     @OPTN             7                          CER038
     C                   PARM      'CER043'      @SARD             6                          CER038
     C                   PARM                    DSFDY                                        CER038
      *                                                                                       CER038
      ** If CER043 is installed                                                               CER038
      *                                                                                       CER038
     C     @RTCD         IFEQ      *BLANKS                                                    CER038
      *                                                                                       CER038
     C                   MOVE      'Y'           CER043            1                          CER038
      *                                                                                       CER038
     C                   ELSE                                                                 CER038
     C                   MOVE      'N'           CER043                                       CER038
      *                                                                                       CER038
     C                   ENDIF                                                                CER038
      *                                                                                       CER048
      ** Test if CER048 is installed                                                          CER048
      *                                                                                       CER048
     C                   CALL      'AOSARDR0'                                                 CER048
     C                   PARM      *BLANKS       @RTCD             7                          CER048
     C                   PARM      '*VERIFY'     @OPTN             7                          CER048
     C                   PARM      'CER048'      @SARD             6                          CER048
     C                   PARM                    DSFDY                                        CER048
      *                                                                                       CER048
     C     @RTCD         IFNE      *BLANKS                                                    CER048
     C     @RTCD         ANDNE     '*NRF    '                                                 CER048
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CER048
     C                   MOVEL     'CER048'      W0KEY                                        CER048
     C                   Z-ADD     38            W0ERNB                                       CER048
     C                   MOVEL     'MEM5004'     W0MSGD                                       CER048
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CER048
     C                   EXSR      SRERR                                                      CER048
     C                   ENDIF                                                                CER048
      *                                                                                       CER048
      ** If CER048 is installed                                                               CER048
      *                                                                                       CER048
     C     @RTCD         IFEQ      *BLANKS                                                    CER048
     C                   MOVE      'Y'           CER048            1                          CER048
      *                                                                                       CER048
     C                   ELSE                                                                 CER048
     C                   MOVE      'N'           CER048                                       CER048
     C                   ENDIF                                                                CER048
      *                                                                                       CER054
      ** Test if CER054 is installed                                                          CER054
      *                                                                                       CER054
     C                   CALL      'AOSARDR0'                                                 CER054
     C                   PARM      *BLANKS       @RTCD             7                          CER054
     C                   PARM      '*VERIFY'     @OPTN             7                          CER054
     C                   PARM      'CER054'      @SARD             6                          CER054
     C                   PARM                    DSFDY                                        CER054
      *                                                                                       CER054
     C     @RTCD         IFNE      *BLANKS                                                    CER054
     C     @RTCD         ANDNE     '*NRF    '                                                 CER054
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CER054
     C                   MOVEL     'CER054'      W0KEY                                        CER054
     C                   Z-ADD     39            W0ERNB                                       CER054
     C                   MOVEL     'MEM5004'     W0MSGD                                       CER054
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CER054
     C                   EXSR      SRERR                                                      CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER054
     C     @RTCD         IFEQ      *BLANKS                                                    CER054
     C                   MOVE      'Y'           CER054            1                          CER054
      *                                                                                       CER054
     C                   ELSE                                                                 CER054
     C                   MOVE      'N'           CER054                                       CER054
     C                   ENDIF                                                                CER054
      *                                                                                       CER049
      ** Test if CER049 is installed                                                          CER049
      *                                                                                       CER049
     C                   CALL      'AOSARDR0'                                                 CER049
     C                   PARM      *BLANKS       @RTCD                                        CER049
     C                   PARM      '*VERIFY'     @OPTN                                        CER049
     C                   PARM      'CER049'      @SARD                                        CER049
     C                   PARM                    DSFDY                                        CER049
      *                                                                                       CER049
     C     @RTCD         IFNE      *BLANKS                                                    CER049
     C     @RTCD         ANDNE     '*NRF    '                                                 CER049
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CER049
     C                   MOVEL     'CER049'      W0KEY                                        CER049
     C                   Z-ADD     42            W0ERNB                                       CER049
     C                   MOVEL     'MEM5004'     W0MSGD                                       CER049
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CER049
     C                   EXSR      SRERR                                                      CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CER049
     C     @RTCD         IFEQ      *BLANKS                                                    CER049
     C                   MOVE      'Y'           CER049            1                          CER049
      *                                                                                       CER049
     C                   ELSE                                                                 CER049
     C                   MOVE      'N'           CER049                                       CER049
     C                   ENDIF                                                                CER049
      *                                                                                       CRE073
      ** Check if CRE073 is ON                                                                CRE073
      *                                                                                       CRE073
     C                   CALL      'AOSARDR0'                                                 CRE073
     C                   PARM      *BLANKS       @RTCD                                        CRE073
     C                   PARM      '*VERIFY'     @OPTN                                        CRE073
     C                   PARM      'CRE073'      @SARD                                        CRE073
     C                   PARM                    DSFDY                                        CRE073
      *                                                                                       CRE073
     C     @RTCD         IFNE      *BLANKS                                                    CRE073
     C     @RTCD         ANDNE     '*NRF    '                                                 CRE073
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CRE073
     C                   MOVEL     'CER073'      W0KEY                                        CRE073
     C                   Z-ADD     50            W0ERNB                                       CRE073
     C                   MOVEL     'MEM5004'     W0MSGD                                       CRE073
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CRE073
     C                   EXSR      SRERR                                                      CRE073
     C                   ENDIF                                                                CRE073
      *                                                                                       CRE073
     C     @RTCD         IFEQ      *BLANKS                                                    CRE073
     C                   MOVE      'Y'           CRE073            1                          CRE073
     C                   ELSE                                                                 CRE073
     C                   MOVE      'N'           CRE073                                       CRE073
     C                   ENDIF                                                                CRE073
      *                                                                                       CER069
      ** Check if CER069 is ON                                                                CER069
      *                                                                                       CER069
     C                   CALL      'AOSARDR0'                                                 CER069
     C                   PARM      *BLANKS       @RTCD                                        CER069
     C                   PARM      '*VERIFY'     @OPTN                                        CER069
     C                   PARM      'CER069'      @SARD                                        CER069
     C                   PARM                    DSFDY                                        CER069
      *                                                                                       CER069
     C     @RTCD         IFNE      *BLANKS                                                    CER069
     C     @RTCD         ANDNE     '*NRF    '                                                 CER069
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CER069
     C                   MOVEL     'CER069'      W0KEY                                        CER069
     C                   Z-ADD     51            W0ERNB                                       CER069
     C                   MOVEL     'MEM5004'     W0MSGD                                       CER069
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CER069
     C                   EXSR      SRERR                                                      CER069
     C                   ENDIF                                                                CER069
      *                                                                                       CER069
     C     @RTCD         IFEQ      *BLANKS                                                    CER069
     C                   MOVE      'Y'           CER069            1                          CER069
     C                   ELSE                                                                 CER069
     C                   MOVE      'N'           CER069                                       CER069
     C                   ENDIF                                                                CER069
      *                                                                                     BUG23515
      ** Key List For SDCSINLE                                                              BUG23515
      *                                                                                     BUG23515
     C     WKEY2         KLIST                                                              BUG23515
     C                   KFLD                    TSMODI                                     BUG23515
     C                   KFLD                    TSDLLN                                     BUG23515
      *                                                                                     BUG23515
     C     WKEY1         KLIST                                                              BUG23515
     C                   KFLD                    TSMODI                                     BUG23515
     C                   KFLD                    TSDLLN                                     BUG23515
     C                   KFLD                    TSRDNB                                     BUG23515
      *                                                                                       CDL094
      ** Check if CDL094 is ON                                                                CDL094
      *                                                                                       CDL094
     C                   CALL      'AOSARDR0'                                                 CDL094
     C                   PARM      *BLANKS       @RTCD                                        CDL094
     C                   PARM      '*VERIFY'     @OPTN                                        CDL094
     C                   PARM      'CDL094'      @SARD                                        CDL094
     C                   PARM                    DSFDY                                        CDL094
      *                                                                                       CDL094
     C     @RTCD         IFNE      *BLANKS                                                    CDL094
     C     @RTCD         ANDNE     '*NRF    '                                                 CDL094
     C                   MOVEL     'SCSARDPD'    W0FILE                                       CDL094
     C                   MOVEL     'CDL094'      W0KEY                                        CDL094
     C                   Z-ADD     51            W0ERNB                                       CDL094
     C                   MOVEL     'MEM5004'     W0MSGD                                       CDL094
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CDL094
     C                   EXSR      SRERR                                                      CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CDL094
     C     @RTCD         IFEQ      *BLANKS                                                    CDL094
     C                   MOVE      'Y'           CDL094            1                          CDL094
     C                   ELSE                                                                 CDL094
     C                   MOVE      'N'           CDL094                                       CDL094
     C                   ENDIF                                                                CDL094
      *                                                                                       CDL096
      ** Check if CDL096 - Business Day Conventions for MM Deals - is switched on             CDL096
     C                   CALL      'AOSARDR0'                                                 CDL096
     C                   PARM      *BLANKS       @RTCD                                        CDL096
     C                   PARM      '*VERIFY'     @OPTN                                        CDL096
     C                   PARM      'CDL096'      @SARD                                        CDL096
     C                   PARM                    DSFDY                                        CDL096
      *                                                                                       CDL096
     C     @RTCD         IFEQ      *BLANKS                                                    CDL096
     C                   MOVE      'Y'           CDL096            1                          CDL096
     C                   ELSE                                                                 CDL096
     C                   MOVE      'N'           CDL096                                       CDL096
     C                   ENDIF                                                                CDL096
      *                                                                                     MD029242
      ** If CER038 is switched on, check if Suppress Correspondence for                     MD029242
      ** Customer with Swift ID is 'Y/N'                                                    MD029242
      *                                                                                     MD029242
     C     CER038        IFEQ      'Y'                                                      MD029242
     C                   MOVEL     *BLANKS       SUPCON            1                        MD029242
     C                   CALL      'AOSVALR0'                                               MD029242
     C                   PARM                    P@RTCD                                     MD029242
     C                   PARM      #SUPRS        P@OP01                                     MD029242
     C     SVAL1         PARM                    P@VL01                                     MD029242
     C                   PARM      *BLANK        P@OP02                                     MD029242
     C                   PARM                    P@VL02                                     MD029242
     C                   PARM      *BLANK        P@OP03                                     MD029242
     C                   PARM                    P@VL03                                     MD029242
     C                   PARM      *BLANK        P@OP04                                     MD029242
     C                   PARM                    P@VL04                                     MD029242
     C                   PARM      *BLANK        P@OP05                                     MD029242
     C                   PARM                    P@VL05                                     MD029242
     C                   PARM      *BLANK        P@OP06                                     MD029242
     C                   PARM                    P@VL06                                     MD029242
     C                   PARM      *BLANK        P@OP07                                     MD029242
     C                   PARM                    P@VL07                                     MD029242
     C                   PARM      *BLANK        P@OP08                                     MD029242
     C                   PARM                    P@VL08                                     MD029242
     C                   PARM      *BLANK        P@OP09                                     MD029242
     C                   PARM                    P@VL09                                     MD029242
     C                   PARM      *BLANK        P@OP10                                     MD029242
     C                   PARM                    P@VL10                                     MD029242
      *                                                                                     MD029242
     C     P@RTCD        IFNE      *BLANKS                                                  MD029242
     C     P@RTCD        ANDNE     '*NRF   '                                                MD029242
     C                   MOVEL     'SDSVALPD'    W0FILE                         ************MD029242
     C                   MOVEL     '*CALL'       W0KEY                          * DBERROR50 MD029242
     C                   Z-ADD     50            W0ERNB                         ************MD029242
     C                   MOVEL     'MEM5003'     W0MSGD                                     MD029242
     C                   MOVEL     'MIDAS  '     W0MSGF                                     MD029242
     C                   EXSR      SRERR                                                    MD029242
     C                   ENDIF                                                              MD029242
      *                                                                                     MD029242
     C     P@RTCD        IFEQ      *BLANKS                                                  MD029242
     C                   MOVEL     SVAL11        SUPCON                                     MD029242
     C                   ENDIF                                                              MD029242
      *                                                                                     MD029242
     C                   ENDIF                                                              MD029242
      *                                                                                       CER050
      ** Access SAR details file to determine if CER050 is installed.                         CER050
      *                                                                                       CER050
     C                   CALL      'AOSARDR0'                                                 CER050
     C                   PARM      '       '     ##RTCD                                       CER050
     C                   PARM      '*VERIFY'     ##OPTN                                       CER050
     C                   PARM      'CER050'      ##SARD                                       CER050
      *                                                                                       CER050
     C     ##RTCD        IFEQ      *BLANK                                                     CER050
     C                   MOVEL     'Y'           CER050            1                          CER050
     C                   ELSE                                                                 CER050
     C                   MOVEL     'N'           CER050                                       CER050
     C                   ENDIF                                                                CER050
     C*                                                                                       S01408
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                   MOVEL     WPARML        P@OP01                                     MD035545
     C                   CALL      'AOSVALR0'                                               MD035545
     C                   PARM      *BLANKS       W0RTCD            7                        MD035545
     C                   PARM                    P@OP01           20                        MD035545
     C                   PARM                    P@VL01          200                        MD035545
     C                   PARM                    P@OP02           20                        MD035545
     C                   PARM                    P@VL02          200                        MD035545
     C                   PARM                    P@OP03           20                        MD035545
     C                   PARM                    P@VL03          200                        MD035545
     C                   PARM                    P@OP04           20                        MD035545
     C                   PARM                    P@VL04          200                        MD035545
     C                   PARM                    P@OP05           20                        MD035545
     C                   PARM                    P@VL05          200                        MD035545
     C                   PARM                    P@OP06           20                        MD035545
     C                   PARM                    P@VL06          200                        MD035545
     C                   PARM                    P@OP07           20                        MD035545
     C                   PARM                    P@VL07          200                        MD035545
     C                   PARM                    P@OP08           20                        MD035545
     C                   PARM                    P@VL08          200                        MD035545
     C                   PARM                    P@OP09           20                        MD035545
     C                   PARM                    P@VL09          200                        MD035545
     C                   PARM                    P@OP10           20                        MD035545
     C                   PARM                    P@VL10          200                        MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C     W0RTCD        IFNE      '       '                                                MD035545
     C                   MOVE      'N'           WCALC6                                     MD035545
     C                   ELSE                                                               MD035545
     C                   MOVEL     P@VL01        WCALC6                                     MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                   ENDIF                                                              MD035545
      *
      *................................................................
      *
     C     EXINIT        TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
     C*
     C                   ENDSR
     C/COPY WNCPYSRC,CG4110C053
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C     SRINZ         BEGSR
      *
      **  Set up subroutine stack name
     C                   ADD       1             Q
     C                   MOVEL     'SRINZ '      @STK(Q)
      *
      *................................................................
      *
      **  Initialise work fields
     C                   Z-ADD     *ZEROS        ##W050            5 0
     C                   Z-ADD     *ZEROS        ##W150           15 0
     C                   Z-ADD     *ZEROS        #1                6 0
     C                   Z-ADD     *ZEROS        #2                6 0
     C                   Z-ADD     *ZEROS        #3                6 0
     C                   MOVE      *BLANKS       S#PATH          256
     C     *LIKE         DEFINE    DEOSEQ        ##OSEQ                                       082060
     C/COPY WNCPYSRC,CG4110C007
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                   Z-ADD     *ZEROS        ##OSEQ
      *                                                                                       CCG015
      ** Initialise XML increment                                                             CCG015
      *                                                                                       CCG015
     C                   EXSR      INIXML                                                     CCG015
      *
      *................................................................
      *
     C     EXINZ         TAG
      *
      **  Unwind subroutine stack name
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *
     C                   ENDSR
      *****************************************************************
     C/SPACE 5                                                                                CEU014
      *****************************************************************                       CEU014
      * Subroutine  :  INCUST                                         *                       CEU014
      * Function    :  Retrieve 'In' currency details of customer     *                       CEU014
      *                                                               *                       CEU014
      * Called by   :  D@CFCS, D@DAPC, D@FRAS, D@FRX, D@IRXO,         *                       CEU014
      *                D@IRXT, D@LAD, D@LADS, BYOUT, UPFEE            *                       CEU014
      * Calls       :  AOCUSTR0                                       *                       CEU014
      *****************************************************************                       CEU014
     C     INCUST        BEGSR                                                                CEU014
      *                                                                                       CEU014
      **  Set up subroutine stack name                                                        CEU014
     C                   ADD       1             Q                                            CEU014
     C                   MOVEL     'INCUST'      @STK(Q)                                      CEU014
      *                                                                                       CEU014
      *................................................................                       CEU014
      *                                                                                       CEU014
      ** Get Customer Details                                                                 CEU014
      *                                                                                       CEU014
     C                   MOVEL     CNUM          ##KEY1                                       CEU014
     C                   CALL      'AOCUSTR0'                                                 CEU014
     C                   PARM      *BLANKS       ##RTCD                                       CEU014
     C                   PARM      '*KEY   '     ##OPTN                                       CEU014
     C                   PARM                    ##KEY1                                       CEU014
     C                   PARM      *BLANKS       ##KYST                                       CEU014
     C     SDCUST        PARM      SDCUST        DSSDY                                        CEU014
      *                                                                                       CEU014
      ** DATABASE ERROR                                                                       CEU014
      *                                                                                       CEU014
     C     ##RTCD        IFNE      *BLANK                                                     CEU014
     C                   MOVEL     'SDCUSTPD'    W0FILE                         **************CEU014
     C                   MOVEL     CNUM          W0KEY                          * DB ERROR 32 CEU014
     C                   Z-ADD     32            W0ERNB                         **************CEU014
     C                   MOVEL     'MEM5004'     W0MSGD                                       CEU014
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CEU014
     C                   EXSR      SRERR                                                      CEU014
     C                   END                                                                  CEU014
      *                                                                                       CEU014
      *................................................................                       CEU014
      *                                                                                       CEU014
      *                                                                                       CEU014
      **  Unwind subroutine stack name                                                        CEU014
     C                   MOVEA     *BLANKS       @STK(Q)                                      CEU014
     C                   SUB       1             Q                                            CEU014
      *                                                                                       CEU014
     C                   ENDSR                                                                CEU014
     C*****************************************************************                       CEU014
      /SPACE 5                                                                              BUG11112
      *****************************************************************                     BUG11112
      * Subroutine  :  SRFRCD                                         *                     BUG11112
      * Function    :  Floating Rate CD Issued Details (Deal Date     *                     BUG11112
      *                Conf)                                          *                     BUG11112
      *                                                               *                     BUG11112
      * Called by   :  D13LAD, D14LAD, D20LAD, D23LAD                 *                     BUG11112
      * Calls       :                                                 *                     BUG11112
      *****************************************************************                     BUG11112
     C     SRFRCD        BEGSR                                                              BUG11112
      *                                                                                     BUG11112
      **  Set up subroutine stack name                                                      BUG11112
      *                                                                                     BUG11112
     C                   ADD       1             Q                                          BUG11112
     C                   MOVEL     'FRCD  '      @STK(Q)                                    BUG11112
      *                                                                                     BUG11112
      **  Retrieve subroutine specific data.                                                BUG11112
      *                                                                                     BUG11112
     C     1             OCCUR     ##SRDT                                                   BUG11112
     C                   MOVEL     ##SPAT        S#PATH                                     BUG11112
      *                                                                                     BUG11112
      **  Set up Path.                                                                      BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     '\FRCD  '     ##PNAM                                     BUG11112
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                     BUG11112
     C                   EXSR      PSHGRS                                                   BUG11112
      *                                                                                     BUG11112
      **  Retrieve RDE information for RDEs in group set                                    BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     @STK(Q)       ##GRPS                                     BUG11112
     C                   Z-ADD     1             ##RDEN                                     BUG11112
     C                   EXSR      SRRRDE                                                   BUG11112
      *                                                                                     BUG11112
      **  Rate Change Date                                                                  BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKRCDT        ##D(1)                                     BUG11112
      *                                                                                     BUG11112
      **  Rate Change Frequency                                                             BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKRCFR        ##D(2)                                     BUG11112
      *                                                                                     BUG11112
      **  Rate Change Days                                                                  BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKRCDM        ##D(3)                                     BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate Flag                                                              BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKSTRF        ##D(4)                                     BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate                                                                   BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKSTRT        ##D(5)                                     BUG11112
      *                                                                                     BUG11112
      **  Accrued Interest as of Last Int Paymnt/Change Date                                BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKAILC        ##D(6)                                     BUG11112
     C                   MOVE      A6NBDP        ##D(6)                                     BUG11112
      *                                                                                     BUG11112
      **  Accrued COF as of Last Int Paymnt/Change Date                                     BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKACDA        ##D(7)                                     BUG11112
     C                   MOVE      A6NBDP        ##D(7)                                     BUG11112
      *                                                                                     BUG11112
      **  Short Term Rate on Value Date Flag                                                BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKSTVF        ##D(8)                                     BUG11112
      *                                                                                     BUG11112
      **  Fixed Base Rate Applied on Value Date Flag                                        BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKBSVF        ##D(9)                                     BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Days                                                                     BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKFXDM        ##D(10)                                    BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Date                                                                     BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKINFD        ##D(11)                                    BUG11112
      *                                                                                     BUG11112
      **  Rate Fix Date Processed Flag                                                      BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKINFF        ##D(12)                                    BUG11112
      *                                                                                     BUG11112
      **  Fixed Base Rate                                                                   BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     UFIR          ##D(13)                                    BUG11112
      *                                                                                     BUG11112
      **  Forward Yield Curve                                                               BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     XKFYLD        ##D(14)                                    BUG11112
      *                                                                                     BUG11112
      **  Currency                                                                          BUG11112
      *                                                                                     BUG11112
     C                   MOVEL     CCY           ##D(15)                                    BUG11112
      *                                                                                     BUG11112
      **  Accumulate RDE's and associated data and output to                                BUG11112
      **  PF/CGUDTAPD.                                                                      BUG11112
     C                   EXSR      SRADTA                                                   BUG11112
     C                   EXSR      SRODTA                                                   BUG11112
      *                                                                                     BUG11112
     C     EXFRCD        TAG                                                                BUG11112
      *                                                                                     BUG11112
      **  Unwind subroutine stack name                                                      BUG11112
      *                                                                                     BUG11112
     C                   EXSR      POPGRS                                                   BUG11112
     C                   MOVEA     *BLANKS       @STK(Q)                                    BUG11112
     C                   SUB       1             Q                                          BUG11112
      *                                                                                     BUG11112
     C                   ENDSR                                                              BUG11112
      *****************************************************************                     BUG11112
      /SPACE 5                                                                              BUG11112
      *****************************************************************                     BUG11112
      * Subroutine  :  D26LAD                                         *                     BUG11112
      * Function    :  Floating Rate CD Issued Details Rate Fix       *                     BUG11112
      *                Advise                                         *                     BUG11112
      *                                                               *                     BUG11112
      * Called by   :  SRXFIR                                         *                     BUG11112
      * Calls       :  SRFRCD, PSHGRS, BRANCH, D@BASM, CUST, ACOF,    *                     BUG11112
      *                D@OTH1, & POPGRS                               *                     BUG11112
      *****************************************************************                     BUG11112
     C     D26LAD        BEGSR                                                              BUG11112
      *                                                                                     BUG11112
      **  Set up subroutine stack name                                                      BUG11112
     C                   ADD       1             Q                                          BUG11112
     C                   MOVEL     'D26LAD'      @STK(Q)                                    BUG11112
      *                                                                                     BUG11112
      *................................................................                     BUG11112
      *                                                                                     BUG11112
      **  Set up Path.                                                                      BUG11112
     C                   MOVEL     '\d26LAD'     ##PNAM                                     BUG11112
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                     BUG11112
     C                   EXSR      PSHGRS                                                   BUG11112
      *                                                                                     BUG11112
      **  Store Path                                                                        BUG11112
     C     1             OCCUR     ##SRDT                                                   BUG11112
     C                   MOVEL     S#PATH        ##SPAT                                     BUG11112
      *                                                                                     BUG11112
      ** Branch Details                                                                     BUG11112
     C                   EXSR      BRANCH                                                   BUG11112
      *                                                                                     BUG11112
      ** Base Deal Event Details                                                            BUG11112
     C                   EXSR      D@BASM                                                   BUG11112
      *                                                                                     BUG11112
      ** Floating Rate Details                                                              BUG11112
     C                   EXSR      SRFRCD                                                   BUG11112
      *                                                                                     BUG11112
      ** Customer Details                                                                   BUG11112
     C                   EXSR      CUST                                                     BUG11112
      *                                                                                     BUG11112
      ** Counterparty Account Officer Details                                               BUG11112
     C                   EXSR      ACOF                                                     BUG11112
      *                                                                                     BUG11112
      ** Other Deal Details                                                                 BUG11112
     C                   EXSR      D@OTH1                                                   BUG11112
      *................................................................                     BUG11112
      *                                                                                     BUG11112
     C     EX6LAD        TAG                                                                BUG11112
      *                                                                                     BUG11112
      **  Unwind subroutine stack name                                                      BUG11112
     C                   EXSR      POPGRS                                                   BUG11112
     C                   MOVEA     *BLANKS       @STK(Q)                                    BUG11112
     C                   SUB       1             Q                                          BUG11112
      *                                                                                     BUG11112
     C                   ENDSR                                                              BUG11112
      *****************************************************************                       CER048
      * Subroutine  :  CGSTAX                                         *                       CER048
      * Function    :  Secondary Tax Details                          *                       CER048
      *                                                               *                       CER048
      * Called by   :  D23LAD                                         *                       CER048
      * Calls       :                                                 *                       CER048
      *                                                               *                       CER048
      *****************************************************************                       CER048
     C     CGSTAX        BEGSR                                                                CER048
      *                                                                                       CER048
      ** Set up subroutine stack name                                                         CER048
      *                                                                                       CER048
     C                   ADD       1             Q                                            CER048
     C                   MOVEL     'CGSTAX'      @STK(Q)                                      CER048
      *                                                                                       CER048
      ** Retrieve subroutine specific data.                                                   CER048
      *                                                                                       CER048
     C     1             OCCUR     ##SRDT                                                     CER048
     C                   MOVEL     ##SPAT        S#PATH                                       CER048
      *                                                                                       CER048
      ** Set up Path.                                                                         CER048
      *                                                                                       CER048
     C                   MOVEL     '\CGSTAX'     ##PNAM                                       CER048
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CER048
     C                   EXSR      PSHGRS                                                     CER048
      *                                                                                       CER048
      ** Retrieve RDE information for RDEs in group set                                       CER048
      *                                                                                       CER048
     C                   MOVEL     @STK(Q)       ##GRPS                                       CER048
     C                   Z-ADD     1             ##RDEN                                       CER048
     C                   EXSR      SRRRDE                                                     CER048
      *                                                                                       CER048
      ** Secondary Tax Amount                                                                 CER048
      *                                                                                       CER048
     C********** WELGTX    IFNE 'G'                                               BUG23515 BUG23515B
     C********** WSTXS1    ADD  WNSTAX    WNSTAX                                  BUG23515 BUG23515B
     C                   MOVEL     WNSTAX        ##D(1)                                       CER048
     C**********           ELSE                                                   BUG23515 BUG23515B
     C**********           MOVELWSTXS1    ##D,1                                   BUG23515 BUG23515B
     C**********           ENDIF                                                  BUG23515 BUG23515B
     C                   MOVEL     CCY           ##CCY                                        CER048
     C                   EXSR      SRDCDT                                                     CER048
     C                   MOVE      A6NBDP        ##D(1)                                       CER048
      *                                                                                       CER048
      ** Secondary Tax Basket                                                                 CER048
      *                                                                                       CER048
     C                   MOVEL     PSTXB         ##D(2)                                       CER048
      *                                                                                       CER048
      ** Secondary Tax Account Code                                                           CER048
      *                                                                                       CER048
     C                   MOVEL     PSTAC         ##D(3)                                       CER048
      *                                                                                       CER048
      ** Secondary Tax Rate                                                                   CER048
      *                                                                                       CER048
     C                   MOVEL     PSTTR         ##D(4)                                       CER048
      *                                                                                     BUG23515
      ** German Taxes                                                                       BUG23515
      *                                                                                     BUG23515
     C                   MOVEL     CER048        ##D(5)                                     BUG23515
      *                                                                                     BUG23515
      ** Threshold Method                                                                   BUG23515
      *                                                                                     BUG23515
     C                   MOVEL     EWTHMD        ##D(6)                                     BUG23515
      *                                                                                     BUG23515
      ** Set up Gross Interest in Deal Currency                                             BUG23515
      *                                                                                     BUG23515
     C                   MOVEL     @@TOTI        ##D(7)                                     BUG23515
     C                   MOVEL     OCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(7)                                     BUG23515
      *                                                                                    BUG23515B
     C     OCCY          IFNE      TCCY                                                    BUG23515B
      *                                                                                    BUG23515B
      ** Derive the Excahnge Rate                                                           BUG23948
      *                                                                                     BUG23948
     C**********           MOVE OCCY      ZCCY                                   BUG23515B BUG23948B
     C                   MOVE      OCCY          ##CCY                                     BUG23515B
     C                   EXSR      SRDCDT                                                  BUG23515B
      *                                                                                    BUG23515B
     C**********           CALL 'AOCURRR0'                                       BUG23515B BUG23948B
     C**********           PARM *BLANKS   PRTCD                                  BUG23515B BUG23948B
     C**********           PARM '*KEY   ' POPTN                                  BUG23515B BUG23948B
     C**********           PARM           ZCCY    3                              BUG23515B BUG23948B
     C********** SDCURR    PARM SDCURR    DSSDY                                  BUG23515B BUG23948B
      *                                                                                    BUG23515B
     C**********           Z-ADDA6SPRT    ZCRSRT                                  BUG23515B BUG23948
     C**********           MOVE A6MDIN    ZCRSMD                                  BUG23515B BUG23948
     C**********           Z-ADDA6NBDP    ZCDPF                                   BUG23515B BUG23948
     C     OCCY          IFNE      *BLANKS                                                  BUG26575
     C     A6MDIN        IFEQ      'D'                                                      BUG23948
     C                   Z-ADD     A6SPRT        ZRATE1                                     BUG23948
     C                   ELSE                                                               BUG23948
     C     A6SPRT        SUB       A6TCMP        WSPRT            13 8                      BUG23948
     C     1             DIV(H)    WSPRT         ZRATE1                                     BUG23948
     C                   ENDIF                                                              BUG23948
     C                   ENDIF                                                              BUG26575
      *                                                                                     BUG23948
     C                   MOVE      'D'           ZMDI1                                     BUG23515B
     C                   Z-ADD     A6NBDP        ZCDPI                                     BUG23515B
      *                                                                                    BUG23515B
     C**********           MOVE TCCY      ZCCY                                   BUG23515B BUG23948B
     C                   MOVE      TCCY          ##CCY                                     BUG23948B
     C                   EXSR      SRDCDT                                                  BUG23948B
      *                                                                                    BUG23515B
     C**********           CALL 'AOCURRR0'                                       BUG23515B BUG23948B
     C**********           PARM *BLANKS   PRTCD                                  BUG23515B BUG23948B
     C**********           PARM '*KEY   ' POPTN                                  BUG23515B BUG23948B
     C**********           PARM           ZCCY    3                              BUG23515B BUG23948B
     C********** SDCURR    PARM SDCURR    DSSDY                                  BUG23515B BUG23948B
      *                                                                                    BUG23515B
     C**********           Z-ADDA6NBDP    ZCDPT                                   BUG23515B BUG23948
     C     TCCY          IFNE      *BLANKS                                                  BUG26575
     C     A6MDIN        IFEQ      'D'                                                      BUG23948
     C                   Z-ADD     A6SPRT        ZRATE2                                     BUG23948
     C                   ELSE                                                               BUG23948
     C     A6SPRT        SUB       A6TCMP        WSPRT                                      BUG23948
     C     1             DIV(H)    WSPRT         ZRATE2                                     BUG23948
     C                   ENDIF                                                              BUG23948
     C                   ENDIF                                                              BUG26575
      *                                                                                     BUG23948
     C                   MOVE      'D'           ZMDI2                                      BUG23948
     C                   Z-ADD     A6NBDP        ZCDPO                                      BUG23948
      *                                                                                     BUG23948
     C     ZRATE2        IFNE      0                                                        BUG26575
     C                   EXSR      ZXRATE                                                   BUG23948
     C                   ENDIF                                                              BUG26575
      *                                                                                     BUG23948
     C                   Z-ADD     ZRATEX        ZCRSRT                                     BUG23948
      *                                                                                     BUG23948
     C                   MOVE      ZMDI1         ZCRSMD                                     BUG23948
     C                   Z-ADD     ZCDPI         ZCDPF                                      BUG23948
     C                   Z-ADD     ZCDPO         ZCDPT                                      BUG23948
     C                   ENDIF                                                             BUG23515B
      *                                                                                     BUG23515
      ** Set up Gross Interest in Tax Currency                                              BUG23515
      *                                                                                     BUG23515
     C     OCCY          IFEQ      TCCY                                                     BUG23515
     C                   MOVEL     @@TOTI        ##D(8)                                     BUG23515
     C                   MOVE      A6NBDP        ##D(8)                                     BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   Z-ADD     0             ZAMTT                                      BUG23515
     C                   Z-ADD     @@TOTI        ZAMTF                                      BUG23515
     C**********           Z-ADDTSXRST    ZCRSRT                                  BUG23515 BUG23515B
     C**********           MOVE TSSTMD    ZCRSMD                                  BUG23515 BUG23515B
     C**********           Z-ADDTSOCDP    ZCDPF                                   BUG23515 BUG23515B
     C**********           Z-ADDTSTCDP    ZCDPT                                   BUG23515 BUG23515B
     C                   EXSR      ZCCYXR                                                   BUG23515
     C                   MOVEL     ZAMTT         ##D(8)                                     BUG23515
     C                   MOVEL     TCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(8)                                     BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23948
      ** Store Previous Value for Deal - Tax Ccy Conv                                       BUG23948
      *                                                                                     BUG23948
     C                   Z-ADD     ZCRSRT        WCRSRT           13 8                      BUG23948
     C                   MOVE      ZCRSMD        WCRSMD            1                        BUG23948
     C                   Z-ADD     ZCDPF         WCDPF             1 0                      BUG23948
     C                   Z-ADD     ZCDPT         WCDPT             1 0                      BUG23948
      *                                                                                     BUG23948
      ** Set up Taxable Interest in Deal Currency based on Tax Ind.                         BUG23948
      *                                                                                     BUG23948
     C                   MOVE      *BLANKS       WCONV             1                        BUG23948
     C                   MOVE      *ZEROS        FCPTHU           15 0                      BUG24190
      *                                                                                     BUG23948
     C     TAXI          IFEQ      'N'                                                      BUG23948
     C**********           MOVE *ZEROS    ACPTHU                                   BUG23948 BUG24190
     C                   MOVE      *ZEROS        FCPTHU                                     BUG24190
     C                   ELSE                                                               BUG23948
      *                                                                                     BUG23948
     C     TAXI          IFEQ      'Y'                                                      BUG23948
     C**********           MOVE @@TOTI    ACPTHU                                   BUG23948 BUG24190
     C                   MOVE      @@TOTI        FCPTHU                                     BUG24190
     C                   ELSE                                                               BUG23948
      *                                                                                     BUG23948
     C********** ACPTHU    IFGE *ZEROS                                             BUG23948 BUG24190
     C**********           MOVE *ZEROS    ACPTHU                                   BUG23948 BUG24190
     C**********           ELSE                                                    BUG23948 BUG24190
     C**********           Z-SUBACPTHU    ACPTHU                                   BUG23948 BUG24190
     C                   MOVE      'Y'           WCONV                                      BUG23948
     C     OCCY          IFEQ      BJCYCD                                                   BUG24190
     C     @@TOTI        SUB       ACPTHU        FCPTHU                                     BUG24190
     C                   ENDIF                                                              BUG23948
      *                                                                                     BUG23948
     C                   ENDIF                                                              BUG23948
      *                                                                                     BUG23948
     C                   ENDIF                                                              BUG23948
      *                                                                                     BUG23948
      ** If fetched from Gross Interest no Conv req else convert to Deal Currency           BUG23948
      *                                                                                     BUG23948
     C     WCONV         IFEQ      'Y'                                                      BUG23948
     C     OCCY          ANDNE     BJCYCD                                                   BUG23948
      *                                                                                     BUG23948
     C**********           MOVE BJCYCD    ZCCY                                   BUG23515B BUG23948B
     C                   MOVE      BJCYCD        ##CCY                                     BUG23948B
     C                   EXSR      SRDCDT                                                  BUG23948B
      *                                                                                     BUG23948
     C**********           CALL 'AOCURRR0'                                       BUG23515B BUG23948B
     C**********           PARM *BLANKS   PRTCD                                  BUG23515B BUG23948B
     C**********           PARM '*KEY   ' POPTN                                  BUG23515B BUG23948B
     C**********           PARM           ZCCY    3                              BUG23515B BUG23948B
     C********** SDCURR    PARM SDCURR    DSSDY                                  BUG23515B BUG23948B
      *                                                                                     BUG23948
     C     A6MDIN        IFEQ      'D'                                                      BUG23948
     C                   Z-ADD     A6SPRT        ZRATE1                                     BUG23948
     C                   ELSE                                                               BUG23948
     C     A6SPRT        SUB       A6TCMP        WSPRT                                      BUG23948
     C     1             DIV(H)    WSPRT         ZRATE1                                     BUG23948
     C                   ENDIF                                                              BUG23948
      *                                                                                     BUG23948
     C                   MOVE      'D'           ZMDI1                                      BUG23948
     C                   Z-ADD     A6NBDP        ZCDPI                                      BUG23948
      *                                                                                     BUG23948
     C**********           MOVE OCCY      ZCCY                                   BUG23515B BUG23948B
     C                   MOVE      OCCY          ##CCY                                     BUG23948B
     C                   EXSR      SRDCDT                                                  BUG23948B
      *                                                                                     BUG23948
     C**********           CALL 'AOCURRR0'                                       BUG23515B BUG23948B
     C**********           PARM *BLANKS   PRTCD                                  BUG23515B BUG23948B
     C**********           PARM '*KEY   ' POPTN                                  BUG23515B BUG23948B
     C**********           PARM           ZCCY    3                              BUG23515B BUG23948B
     C********** SDCURR    PARM SDCURR    DSSDY                                  BUG23515B BUG23948B
      *                                                                                     BUG23948
      ** Get Rate for conversion from Base - Deal Ccy                                       BUG23948
      *                                                                                     BUG23948
     C     OCCY          IFNE      *BLANKS                                                  BUG26575
     C     A6MDIN        IFEQ      'D'                                                      BUG23948
     C                   Z-ADD     A6SPRT        ZRATE2                                     BUG23948
     C                   ELSE                                                               BUG23948
     C     A6SPRT        SUB       A6TCMP        WSPRT                                      BUG23948
     C     1             DIV(H)    WSPRT         ZRATE2                                     BUG23948
     C                   ENDIF                                                              BUG23948
     C                   ENDIF                                                              BUG26575
      *                                                                                     BUG23948
     C                   MOVE      'D'           ZMDI2                                      BUG23948
     C                   Z-ADD     A6NBDP        ZCDPO                                      BUG23948
      *                                                                                     BUG23948
     C     ZRATE2        IFNE      0                                                        BUG26575
     C                   EXSR      ZXRATE                                                   BUG23948
     C                   ENDIF                                                              BUG26575
      *                                                                                     BUG23948
     C                   Z-ADD     ZRATEX        ZCRSRT                                     BUG23948
     C                   MOVE      ZMDI1         ZCRSMD                                     BUG23948
     C                   Z-ADD     ZCDPI         ZCDPF                                      BUG23948
     C                   Z-ADD     ZCDPO         ZCDPT                                      BUG23948
      *                                                                                     BUG23948
      ** Convert to Taxable Interest into Deal Ccy                                          BUG23948
      *                                                                                     BUG23948
     C                   Z-ADD     0             ZAMTT                                      BUG23948
     C                   Z-ADD     ACPTHU        ZAMTF                                      BUG23948
     C                   EXSR      ZCCYXR                                                   BUG23948
     C                   MOVEL     ZAMTT         ACPTHU                                     BUG23948
      *                                                                                     BUG24190
     C     @@TOTI        SUB       ACPTHU        FCPTHU                                     BUG24190
      *                                                                                     BUG23948
     C                   ENDIF                                                              BUG23948
      *                                                                                     BUG23515
      ** Set up Taxable Interest in Deal Currency                                           BUG23515
      *                                                                                     BUG23515
     C**********           MOVELACPTHU    ##D,9                                    BUG23515 BUG24190
     C                   MOVEL     FCPTHU        ##D(9)                                     BUG24190
     C**********           MOVELTCCY      ##CCY                                    BUG23515 BUG23948
     C                   MOVEL     OCCY          ##CCY                                      BUG23948
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(9)                                     BUG23515
      *                                                                                     BUG23948
      ** Use the Previous Retained Value to Conv from Deal to Tax Ccy                       BUG23948
      *                                                                                     BUG23948
     C                   Z-ADD     WCRSRT        ZCRSRT                                     BUG23948
     C                   MOVE      WCRSMD        ZCRSMD                                     BUG23948
     C                   Z-ADD     WCDPF         ZCDPF                                      BUG23948
     C                   Z-ADD     WCDPT         ZCDPT                                      BUG23948
      *                                                                                     BUG23515
      ** Set up Taxable Interest in Tax Currency                                            BUG23515
      *                                                                                     BUG23515
     C     OCCY          IFEQ      TCCY                                                     BUG23515
     C**********           MOVELACPTHU    ##D,10                                   BUG23515 BUG24190
     C                   MOVEL     FCPTHU        ##D(10)                                    BUG24190
     C                   MOVE      A6NBDP        ##D(10)                                    BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   Z-ADD     0             ZAMTT                                      BUG23515
     C**********           Z-ADDACPTHU    ZAMTF                                    BUG23515 BUG24190
     C                   Z-ADD     FCPTHU        ZAMTF                                      BUG24190
     C**********           Z-ADDTSXRST    ZCRSRT                                  BUG23515 BUG23515B
     C**********           MOVE TSSTMD    ZCRSMD                                  BUG23515 BUG23515B
     C**********           Z-ADDTSOCDP    ZCDPF                                   BUG23515 BUG23515B
     C**********           Z-ADDTSTCDP    ZCDPT                                   BUG23515 BUG23515B
     C                   EXSR      ZCCYXR                                                   BUG23515
     C                   MOVEL     ZAMTT         ##D(10)                                    BUG23515
     C                   MOVEL     TCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(10)                                    BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23515
      **  Set up Withholding Tax in Deal Currency                                           BUG23515
      *                                                                                     BUG23515
     C**********           MOVELWSTXSR    ##D,11                                  BUG23515 BUG23515B
     C                   MOVEL     WNTAMT        ##D(11)                                   BUG23515B
     C                   MOVEL     OCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(11)                                    BUG23515
      *                                                                                     BUG23515
      **  Set up Withholding Tax in Base Currency                                           BUG23515
      *                                                                                     BUG23515
     C     OCCY          IFEQ      TCCY                                                     BUG23515
     C**********           MOVELWSTXSR    ##D,12                                  BUG23515 BUG23515B
     C                   MOVEL     WNTAMT        ##D(12)                                   BUG23515B
     C                   MOVE      A6NBDP        ##D(12)                                    BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   Z-ADD     0             ZAMTT                                      BUG23515
     C**********           Z-ADDWSTXSR    ZAMTF                                   BUG23515 BUG23515B
     C                   Z-ADD     WNTAMT        ZAMTF                                      BUG23515
     C**********           Z-ADDTSXRST    ZCRSRT                                  BUG23515 BUG23515B
     C**********           MOVE TSSTMD    ZCRSMD                                  BUG23515 BUG23515B
     C**********           Z-ADDTSOCDP    ZCDPF                                   BUG23515 BUG23515B
     C**********           Z-ADDTSTCDP    ZCDPT                                   BUG23515 BUG23515B
     C                   EXSR      ZCCYXR                                                   BUG23515
     C                   MOVEL     ZAMTT         ##D(12)                                    BUG23515
     C                   MOVEL     TCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(12)                                    BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23515
      ** Set up Secondary Tax in Deal Currency                                              BUG23515
      *                                                                                     BUG23515
     C**********           MOVELWSSTDO    ##D,13                                  BUG23515 BUG23515B
     C                   MOVEL     WNSTAX        ##D(13)                                   BUG23515B
     C                   MOVEL     OCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(13)                                    BUG23515
      *                                                                                     BUG23515
      ** Set up Secondary Tax in Base Currency                                              BUG23515
      *                                                                                     BUG23515
     C     OCCY          IFEQ      TCCY                                                     BUG23515
     C**********           MOVELWSSTDO    ##D,14                                  BUG23515 BUG23515B
     C                   MOVEL     WNSTAX        ##D(14)                                   BUG23515B
     C                   MOVE      A6NBDP        ##D(14)                                    BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   Z-ADD     0             ZAMTT                                      BUG23515
     C**********           Z-ADDWSSTDO    ZAMTF                                   BUG23515 BUG23515B
     C                   Z-ADD     WNSTAX        ZAMTF                                      BUG23515
     C**********           Z-ADDTSXRST    ZCRSRT                                  BUG23515 BUG23515B
     C**********           MOVE TSSTMD    ZCRSMD                                  BUG23515 BUG23515B
     C**********           Z-ADDTSOCDP    ZCDPF                                   BUG23515 BUG23515B
     C**********           Z-ADDTSTCDP    ZCDPT                                   BUG23515 BUG23515B
     C                   EXSR      ZCCYXR                                                   BUG23515
     C                   MOVEL     ZAMTT         ##D(14)                                    BUG23515
     C                   MOVEL     TCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(14)                                    BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                     BUG23515
     C********** @@TOTI    SUB  WSTXSR    ACNINT 150                              BUG23515 BUG23515B
     C**********           SUB  WSSTDO    ACNINT                                  BUG23515 BUG23515B
     C     @@TOTI        SUB       WNTAMT        ACNINT           15 0                     BUG23515B
     C                   SUB       WNSTAX        ACNINT                                    BUG23515B
      *                                                                                     BUG23515
      ** Set up Net Interest in Deal Currency                                               BUG23515
      *                                                                                     BUG23515
     C                   MOVEL     ACNINT        ##D(15)                                    BUG23515
     C                   MOVEL     OCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(15)                                    BUG23515
      *                                                                                     BUG23515
      **  Set up Net Interest in Base Currency                                              BUG23515
      *                                                                                     BUG23515
     C     OCCY          IFEQ      TCCY                                                     BUG23515
     C**********           MOVELTSNINC    ##D,16                                  BUG23515 MD027745B
     C                   MOVEL     ACNINT        ##D(16)                                   MD027745B
     C                   MOVE      A6NBDP        ##D(16)                                    BUG23515
      *                                                                                     BUG23515
     C                   ELSE                                                               BUG23515
      *                                                                                     BUG23515
     C                   Z-ADD     0             ZAMTT                                      BUG23515
     C                   Z-ADD     ACNINT        ZAMTF                                      BUG23515
     C**********           Z-ADDTSXRST    ZCRSRT                                  BUG23515 BUG23515B
     C**********           MOVE TSSTMD    ZCRSMD                                  BUG23515 BUG23515B
     C**********           Z-ADDTSOCDP    ZCDPF                                   BUG23515 BUG23515B
     C**********           Z-ADDTSTCDP    ZCDPT                                   BUG23515 BUG23515B
     C                   EXSR      ZCCYXR                                                   BUG23515
     C                   MOVEL     ZAMTT         ##D(16)                                    BUG23515
     C                   MOVEL     TCCY          ##CCY                                      BUG23515
     C                   EXSR      SRDCDT                                                   BUG23515
     C                   MOVE      A6NBDP        ##D(16)                                    BUG23515
     C                   ENDIF                                                              BUG23515
      *                                                                                       CER048
      **  Accumulate RDE's and associated data and output to                                  CER048
      **  PF/CGUDTAPD.                                                                        CER048
     C                   EXSR      SRADTA                                                     CER048
     C                   EXSR      SRODTA                                                     CER048
      *                                                                                       CER048
     C     EXCGST        TAG                                                                  CER048
      *                                                                                       CER048
      **  Unwind subroutine stack name                                                        CER048
     C                   EXSR      POPGRS                                                     CER048
     C                   MOVEA     *BLANKS       @STK(Q)                                      CER048
     C                   SUB       1             Q                                            CER048
      *                                                                                       CER048
     C                   ENDSR                                                                CER048
      *********************************************************************                   CER048
     C/SPACE 5                                                                                CER054
      *****************************************************************                       CER054
      * Subroutine  :  CGTTAX                                         *                       CER054
      * Function    :  Third Tax Details                              *                       CER054
      *                                                               *                       CER054
      * Called by   :  D07LAD                                         *                       CER054
      * Calls       :                                                 *                       CER054
      *                                                               *                       CER054
      *****************************************************************                       CER054
     C     CGTTAX        BEGSR                                                                CER054
      *                                                                                       CER054
      ** Set up subroutine stack name                                                         CER054
      *                                                                                       CER054
     C                   ADD       1             Q                                            CER054
     C                   MOVEL     'CGTTAX'      @STK(Q)                                      CER054
      *                                                                                       CER054
      **  Retrieve subroutine specific data.                                                  CER054
      *                                                                                       CER054
     C     1             OCCUR     ##SRDT                                                     CER054
     C                   MOVEL     ##SPAT        S#PATH                                       CER054
      *                                                                                       CER054
      ** Set up Path.                                                                         CER054
      *                                                                                       CER054
     C                   MOVEL     '\CGTTAX'     ##PNAM                                       CER054
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CER054
     C                   EXSR      PSHGRS                                                     CER054
      *                                                                                       CER054
      ** Retrieve RDE information for RDEs in group set                                       CER054
      *                                                                                       CER054
     C                   MOVEL     @STK(Q)       ##GRPS                                       CER054
     C                   Z-ADD     1             ##RDEN                                       CER054
     C                   EXSR      SRRRDE                                                     CER054
      *                                                                                       CER054
      *                                                                                       CER054
     C                   MOVEL     WNTTAX        ##D(1)                                       CER054
     C                   MOVE      A6NBDP        ##D(1)                                       CER054
      *                                                                                       CER054
     C     @@TXCY        IFNE      CCY                                                        CER054
     C     @@TXCY        ANDNE     *BLANKS                                                    CER054
     C**********           Z-ADDWNTTAX    P@FRAM                                     CER054 AR745799
     C**********           MOVE CCY       P@FRCY                                     CER054 AR745799
     C**********           MOVE @@TXCY    P@TOCY                                     CER054 AR745799
     C**********           EXSR D@EURO                                               CER054 AR745799
     C**********           MOVEL##OUTA    ##D,2                                      CER054 AR745799
      *                                                                                     AR745799
      ** Get FROM currency details                                                          AR745799
      *                                                                                     AR745799
     C                   MOVE      CCY           PCCY                                       AR745799
     C                   EXSR      SRCURR                                                   AR745799
     C                   Z-ADD     A6SPRT        ZRATE1                                     AR745799
     C                   MOVE      A6MDIN        ZMDI1                                      AR745799
     C                   MOVE      A6NBDP        ZCDPI                                      AR745799
      *                                                                                     AR745799
      ** Get TO currency details                                                            AR745799
      *                                                                                     AR745799
     C                   MOVE      @@TXCY        PCCY                                       AR745799
     C                   EXSR      SRCURR                                                   AR745799
     C                   Z-ADD     A6SPRT        ZRATE2                                     AR745799
     C                   MOVE      A6MDIN        ZMDI2                                      AR745799
     C                   MOVE      A6NBDP        ZCDPO                                      AR745799
      *                                                                                     AR745799
      ** Compute for the Exchange Rate and TO Amount                                        AR745799
      *                                                                                     AR745799
     C                   EXSR      ZXRATE                                                   AR745799
     C                   Z-ADD     WNTTAX        ZAMTCI                                     AR745799
     C                   Z-ADD     ZRATEX        ZEXCH                                      AR745799
     C                   MOVE      ZMDIX         ZMD                                        AR745799
      *                                                                                     AR745799
     C                   EXSR      ZCONVN                                                   AR745799
     C                   MOVEL     ZAMTCO        ##D(2)                                     AR745799
     C                   ELSE                                                               AR745799
     C                   MOVEL     WNTTAX        ##D(2)                                     AR745799
     C                   ENDIF                                                              AR745799
      *                                                                                       CER054
     C                   MOVE      @@TXCY        ##D(2)                                       CER054
      *                                                                                       CER054
     C                   MOVEL     PTTTR         ##D(3)                                       CER054
     C                   MOVEL     PTTXB         ##D(4)                                       CER054
     C                   MOVEL     PTTAC         ##D(5)                                       CER054
     C                   MOVEL     PSTCD         ##D(6)                                       CER054
     C                   MOVEL     PRLAF         ##D(7)                                       CER054
      *                                                                                       CER054
      **  Unwind subroutine stack name                                                        CER054
     C                   EXSR      POPGRS                                                     CER054
     C                   MOVEA     *BLANKS       @STK(Q)                                      CER054
     C                   SUB       1             Q                                            CER054
      *                                                                                       CER054
     C                   ENDSR                                                                CER054
      *****************************************************************                       CER054
      /SPACE 5                                                                                CER049
      *****************************************************************                       CER049
      *  Subroutine  :  LNSTAX                                        *                       CER049
      *  Function    :  Stamp Tax Details                             *                       CER049
      *                                                               *                       CER049
      *  Called by   :  D07LAD                                        *                       CER049
      *  Calls       :                                                *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
     C     LNSTAX        BEGSR                                                                CER049
      *                                                                                       CER049
      ** Set up subroutine stack name                                                         CER049
      *                                                                                       CER049
     C                   ADD       1             Q                                            CER049
     C                   MOVEL     'LNSTAX'      @STK(Q)                                      CER049
      *                                                                                       CER049
      **  Retrieve subroutine specific data.                                                  CER049
      *                                                                                       CER049
     C     1             OCCUR     ##SRDT                                                     CER049
     C                   MOVEL     ##SPAT        S#PATH                                       CER049
      *                                                                                       CER049
      ** Set up Path.                                                                         CER049
      *                                                                                       CER049
     C                   MOVEL     '\LNSTAX'     ##PNAM                                       CER049
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CER049
     C                   EXSR      PSHGRS                                                     CER049
      *                                                                                       CER049
      ** Retrieve RDE information for RDEs in group set                                       CER049
      *                                                                                       CER049
     C                   MOVEL     @STK(Q)       ##GRPS                                       CER049
     C                   Z-ADD     1             ##RDEN                                       CER049
     C                   EXSR      SRRRDE                                                     CER049
      *                                                                                       CER049
      **  Set Deal number                                                                     CER049
      *                                                                                       CER049
     C                   MOVE      DLNO          K1DLNO            6                          CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C     K1DLNO        CHAIN     DLDLDCL3                           98                      CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C     *IN98         IFEQ      *OFF                                                       CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                   MOVEL     F1TAX         ##D(1)                                       CER049
      *                                                                                       CER049
      ** Stamp Principal Tax Flag                                                             CER049
      *                                                                                       CER049
     C                   MOVEL     F1PRIN        ##D(2)                                       CER049
      *                                                                                       CER049
      ** Start Date for Principal Tax                                                         CER049
      *                                                                                       CER049
     C                   MOVEL     F1PDTE        ##D(3)                                       CER049
      *                                                                                       CER049
      ** Average Balance Flag                                                                 CER049
      *                                                                                       CER049
     C                   MOVEL     F1AVBL        ##D(4)                                       CER049
      *                                                                                       CER049
      ** Start Date for Average Balance                                                       CER049
      *                                                                                       CER049
     C**********           MOVELF1AVBL    ##D,5                                      CER049 MD039115
     C                   MOVEL     F1ADTE        ##D(5)                                     MD039115
      *                                                                                       CER049
      ** Interest Tax Flag                                                                    CER049
      *                                                                                       CER049
     C                   MOVEL     F1SINT        ##D(6)                                       CER049
      *                                                                                       CER049
      ** Start Date for Interest Tax                                                          CER049
      *                                                                                       CER049
     C                   MOVEL     F1IDTE        ##D(7)                                       CER049
      *                                                                                       CER049
      ** Debit Account Reference                                                              CER049
      *                                                                                       CER049
     C     F1DCST        CAT       F1DCCY        WDRAC1            9                          CER049
     C                   MOVEL     WDRAC1        WDRAC2           19                          CER049
     C                   MOVE      F1DACD        WDRAC2                                       CER049
     C                   MOVEL     WDRAC2        WDRAC3           21                          CER049
     C                   MOVE      F1DASC        WDRAC3                                       CER049
     C     WDRAC3        CAT       F1DBRC        WDRACC           24                          CER049
      *                                                                                       CER049
     C                   MOVEL     WDRACC        ##D(8)                                       CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                   MOVEL     F1STAB        ##D(9)                                       CER049
     C                   MOVEL     F1DCCY        ##CCY                                        CER049
     C                   EXSR      SRDCDT                                                     CER049
     C                   MOVE      A6NBDP        ##D(9)                                       CER049
      *                                                                                       CER049
      ** Stamp Tax on Interest                                                                CER049
      *                                                                                       CER049
     C                   MOVEL     F1STAI        ##D(10)                                      CER049
     C                   MOVE      A6NBDP        ##D(10)                                      CER049
      *                                                                                       CER049
      ** Stamp Tax on Average This Month                                                      CER049
      *                                                                                       CER049
     C                   MOVEL     F1TAXE        ##D(11)                                      CER049
     C                   MOVE      A6NBDP        ##D(11)                                      CER049
      *                                                                                       CER049
     C                   ENDIF                                                                CER049
      *                                                                                     AR890271
      **  Accumulate RDE's and associated data and output to                                AR890271
      **  PF/CGUDTAPD                                                                       AR890271
     C                   EXSR      SRADTA                                                   AR890271
     C                   EXSR      SRODTA                                                   AR890271
      *                                                                                     AR890271
      *................................................................                     AR890271
      *                                                                                       CER049
      **  Unwind subroutine stack name                                                        CER049
      *                                                                                       CER049
     C                   EXSR      POPGRS                                                     CER049
     C                   MOVEA     *BLANKS       @STK(Q)                                      CER049
     C                   SUB       1             Q                                            CER049
      *                                                                                       CER049
     C                   ENDSR                                                                CER049
      *****************************************************************                       CER049
     C*COPY*ZSRSRC,ZCCYXR                                                          BUG23515 MD056543
     C/COPY ZSRSRC,ZCCYXR_ILE                                                               MD056543
     C/SPACE 5
      *****************************************************************                       CSW208
      * Subroutine  :  SRFEE                                          *                       CSW208
      * Function    :  Retrieve fee details                           *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  D23LAD, DL@FEE                                 *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C     SRFEE         BEGSR                                                                CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'SRFEE '      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C     WRPT          IFEQ      'Y'                                                        CSW208
      *                                                                                       CSW208
     C     WFNPYD        IFEQ      WFPEND                                                     CSW208
     C                   MOVEL     'N'           WRPT                                         CSW208
     C                   Z-ADD     *ZEROS        WFPEND                                       CSW208
     C                   ELSE                                                                 CSW208
      *                                                                                       CSW208
      ** Calculate next payment date                                                          CSW208
      *                                                                                       CSW208
     C                   Z-ADD     DFPEND        WFNPYD                                       CSW208
     C     DFFREQ        IFNE      *BLANKS                                                    CSW208
     C                   MOVEL     DFFREQ        W#FREQ                                       CSW208
     C                   Z-ADD     WFNPYD        W#DAYN                                       CSW208
     C                   Z-ADD     DFDYIM        W#MDAY                                       CSW208
     C                   MOVEL     BJLCCY        W#CCY                                        CSW208
     C                   EXSR      SRSDAT                                                     CSW208
     C     PRTCD         IFEQ      *BLANKS                                                    CSW208
     C     PDAYNO        ANDLE     DFPEND                                                     CSW208
     C                   Z-ADD     PDAYNO        WFNPYD                                       CSW208
     C                   ENDIF                                                                CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      ** Use DL fees history file                                                             CSW208
      *                                                                                       CSW208
     C     WRPT          IFEQ      'N'                                                        CSW208
     C     WFEEH         ANDEQ     'Y'                                                        CSW208
      *                                                                                       CSW208
     C     WFFLG         IFEQ      'N'                                                        CSW208
     C     DLNO          SETLL     DLFHSTL0                                                   CSW208
     C                   ENDIF                                                                CSW208
     C     DLNO          READE     DLFHSTL0                               99                  CSW208
      *                                                                                       CSW208
     C     *IN99         IFEQ      *OFF                                                       CSW208
     C                   MOVEL     'Y'           WFFLG                                        CSW208
     C                   EXSR      FEEHST                                                     CSW208
     C                   ELSE                                                                 CSW208
     C                   MOVEL     'N'           WFEEH                                        CSW208
     C                   MOVEL     'N'           WFFLG                                        CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      ** Use DL fees live file                                                                CSW208
      *                                                                                       CSW208
     C     WRPT          IFEQ      'N'                                                        CSW208
     C     WFEEH         ANDEQ     'N'                                                        CSW208
      *                                                                                       CSW208
     C     WFFLG         IFEQ      'N'                                                        CSW208
     C     DLNO          SETLL     DLFEEDLB                                                   CSW208
     C                   ENDIF                                                                CSW208
     C     DLNO          READE     DLFEEDLB                               99                  CSW208
      *                                                                                       CSW208
     C     *IN99         IFEQ      *OFF                                                       CSW208
     C                   MOVEL     'Y'           WFFLG                                        CSW208
     C                   EXSR      FEELST                                                     CSW208
     C     DFPYON        IFEQ      'N'                                                        CSW208
     C                   MOVEL     'Y'           WRPT                                         CSW208
     C                   Z-ADD     WFPEND        MFPDAT                                       CSW208
     C                   Z-ADD     WFNPYD        DFNPYD                                       CSW208
     C                   ENDIF                                                                CSW208
     C                   ELSE                                                                 CSW208
     C                   MOVEL     'N'           WFFLG                                        CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   MOVEA     *BLANKS       @STK(Q)                                      CSW208
     C                   SUB       1             Q                                            CSW208
      *                                                                                       CSW208
     C                   ENDSR                                                                CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  SRSDAT                                         *                       CSW208
      * Function    :  Calculate next payment date from a frequency   *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  ZFREQB                                         *                       CSW208
      *****************************************************************                       CSW208
     C     SRSDAT        BEGSR                                                                CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'SRSDAT'      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                   CALL      'ZFREQB'                                                   CSW208
     C                   PARM      *BLANKS       PRTCD                                        CSW208
     C                   PARM      W#FREQ        PFREQ             1                          CSW208
     C                   PARM      W#DAYN        PDAYNO            5 0                        CSW208
     C                   PARM      W#MDAY        PMDAY             2 0                        CSW208
     C                   PARM      W#CCY         PCCY              3                          CSW208
     C                   PARM      *BLANKS       PLOC              3                          CSW208
      *                                                                                       CSW208
     C     PRTCD         IFNE      *BLANKS                                                    CSW208
     C                   MOVEL     'ZFREQB  '    W0FILE                                       CSW208
     C                   MOVEL     W#DAYN        W0KEY                          **************CSW208
     C                   Z-ADD     38            W0ERNB                         * DB ERROR 38 CSW208
     C                   MOVEL     'MEM5004'     W0MSGD                         **************CSW208
     C                   MOVEL     'MIDAS  '     W0MSGF                                       CSW208
     C                   EXSR      SRERR                                                      CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   MOVEA     *BLANKS       @STK(Q)                                      CSW208
     C                   SUB       1             Q                                            CSW208
      *                                                                                       CSW208
     C                   ENDSR                                                                CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  FEEHST                                         *                       CSW208
      * Function    :  Move historic fee settlement details           *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C     FEEHST        BEGSR                                                                CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'FEEHST'      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                   MOVEL     HISCCY        ##RSCY                                       CSW208
     C                   MOVEL     HIFCCY        ##CCY                                        CSW208
     C                   Z-ADD     HIRSTM        RSTM                                         CSW208
     C                   MOVEL     HIOSDB        ROBR                                         CSW208
     C                   MOVEL     HIRONS        RONS                                         CSW208
     C                   MOVEL     HIRIBN        RIBN                                         CSW208
     C                   MOVEL     HISCCY        ##PSCY                                       CSW208
     C                   Z-ADD     HIPSTM        PSTM                                         CSW208
     C                   MOVEL     HIOMDB        POBR                                         CSW208
     C                   MOVEL     HIPONS        PONS                                         CSW208
     C                   MOVEL     HIRVNO        RVNO                                         CSW208
     C                   MOVEL     HIRCRN        RCRN                                         CSW208
     C                   MOVEL     HIAWBN        AWBN                                         CSW208
     C                   MOVEL     HIBENN        BENN                                         CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   MOVEA     *BLANKS       @STK(Q)                                      CSW208
     C                   SUB       1             Q                                            CSW208
      *                                                                                       CSW208
     C                   ENDSR                                                                CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  FEELST                                         *                       CSW208
      * Function    :  Move live fee settlement details               *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  SRFEE                                          *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C     FEELST        BEGSR                                                                CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'FEELST'      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
     C                   MOVEL     DFSCCY        ##RSCY                                       CSW208
     C                   MOVEL     DFFCCY        ##CCY                                        CSW208
     C                   Z-ADD     DFRSTM        RSTM                                         CSW208
     C                   MOVEL     DFOSDB        ROBR                                         CSW208
     C                   MOVEL     DFRONS        RONS                                         CSW208
     C                   MOVEL     DFRIBN        RIBN                                         CSW208
     C                   MOVEL     DFSCCY        ##PSCY                                       CSW208
     C                   Z-ADD     DFPSTM        PSTM                                         CSW208
     C                   MOVEL     DFOMDB        POBR                                         CSW208
     C                   MOVEL     DFPONS        PONS                                         CSW208
     C                   MOVEL     DFRVNO        RVNO                                         CSW208
     C                   MOVEL     DFRCRN        RCRN                                         CSW208
     C                   MOVEL     DFAWBN        AWBN                                         CSW208
     C                   MOVEL     DFBENN        BENN                                         CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   MOVEA     *BLANKS       @STK(Q)                                      CSW208
     C                   SUB       1             Q                                            CSW208
      *                                                                                       CSW208
     C                   ENDSR                                                                CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  DL@FEE                                         *                       CSW208
      * Function    :  Dealing fee                                    *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  D23LAD                                         *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C     DL@FEE        BEGSR                                                                CSW208
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'DL_FEE'      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      **  Retrieve subroutine specific data                                                   CSW208
      *                                                                                       CSW208
     C     1             OCCUR     ##SRDT                                                     CSW208
     C                   MOVEL     ##SPAT        S#PATH                                       CSW208
      *                                                                                       CSW208
      **  Set up path                                                                         CSW208
      *                                                                                       CSW208
     C                   MOVEL     '\DL_FEE'     ##PNAM                                       CSW208
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CSW208
      *                                                                                       CSW208
      **  Store Path                                                                          CSW208
     C     2             OCCUR     ##SRDT                                                     CSW208
     C                   MOVEL     S#PATH        ##SPAT                                       CSW208
      *                                                                                       CSW208
      **  Set up binds from passed in values                                                  CSW208
      *                                                                                       CSW208
     C                   Z-ADD     S#PBIN        ##PBIN                                       CSW208
     C                   Z-ADD     S#TBIN        ##TBIN                                       CSW208
      *                                                                                       CSW208
     C     WFFLG         DOWEQ     'Y'                                                        CSW208
     C                   EXSR      PSHGRS                                                     CSW208
     C                   Z-ADD     ##TBIN        S#PBIN                                       CSW208
     C                   ADD       1             ##BNDC                                       CSW208
     C                   Z-ADD     ##BNDC        S#TBIN                                       CSW208
     C                   EXSR      DL@FED                                                     CSW208
     C                   EXSR      D@RECS                                                     CSW208
     C                   EXSR      D@PAYS                                                     CSW208
     C     2             OCCUR     ##SRDT                                                     CSW208
     C                   MOVEL     ##SPAT        S#PATH                                       CSW208
     C                   Z-ADD     ##PBIN        S#PBIN                                       CSW208
     C                   Z-ADD     ##TBIN        S#TBIN                                       CSW208
     C                   EXSR      SRFEE                                                      CSW208
     C                   ENDDO                                                                CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   EXSR      POPGRS
     C                   MOVEA     *BLANKS       @STK(Q)
     C                   SUB       1             Q
      *                                                                                       CSW208
     C                   ENDSR
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CSW208
      * Subroutine  :  DL@FED                                         *                       CSW208
      * Function    :  Dealing fee details                            *                       CSW208
      *                                                               *                       CSW208
      * Called by   :  DL@FEE                                         *                       CSW208
      * Calls       :  *NONE                                          *                       CSW208
      *****************************************************************                       CSW208
     C     DL@FED        BEGSR
      *                                                                                       CSW208
      **  Set up subroutine stack name                                                        CSW208
     C                   ADD       1             Q                                            CSW208
     C                   MOVEL     'DL_FED'      @STK(Q)                                      CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      **  Retrieve subroutine specific data                                                   CSW208
      *                                                                                       CSW208
     C     3             OCCUR     ##SRDT                                                     CSW208
     C                   MOVEL     ##SPAT        S#PATH                                       CSW208
      *                                                                                       CSW208
      **  Set up path                                                                         CSW208
      *                                                                                       CSW208
     C                   MOVEL     '\DL_FED'     ##PNAM                                       CSW208
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CSW208
     C                   EXSR      PSHGRS                                                     CSW208
      *                                                                                       CSW208
      **  Set up binds from passed in values                                                  CSW208
      *                                                                                       CSW208
     C                   Z-ADD     S#PBIN        ##PBIN                                       CSW208
     C                   Z-ADD     S#TBIN        ##TBIN                                       CSW208
      *                                                                                       CSW208
      **  Retrieve RDE information for RDEs in group set                                      CSW208
      *                                                                                       CSW208
     C                   MOVEL     @STK(Q)       ##GRPS                                       CSW208
     C                   Z-ADD     1             ##RDEN                                       CSW208
     C                   EXSR      SRRRDE                                                     CSW208
      *                                                                                       CSW208
      **  Extract RDE's                                                                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  - RDE - Fee sequence number                                                         CSW208
      **  - RDE - Fee code                                                                    CSW208
      **  - RDE - Fee currency                                                                CSW208
      *                                                                                       CSW208
     C     WFEEH         IFEQ      'Y'                                                        CSW208
     C                   MOVEL     HIFSEQ        ##D(1)                                       CSW208
     C                   MOVEL     HIFCOD        ##D(2)                                       CSW208
     C                   MOVEL     HIFCCY        ##D(3)                                       CSW208
     C                   MOVEL     HIFCCY        ##CCY                                        CSW208
     C                   ELSE                                                                 CSW208
     C                   MOVEL     DFFSEQ        ##D(1)                                       CSW208
     C                   MOVEL     DFFCOD        ##D(2)                                       CSW208
     C                   MOVEL     DFFCCY        ##D(3)                                       CSW208
     C                   MOVEL     DFFCCY        ##CCY                                        CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
      **  - RDE - Fee currency details                                                        CSW208
      *                                                                                       CSW208
     C                   EXSR      SRDCDT                                                     CSW208
     C                   MOVEL     A6CYNM        ##D(4)                                       CSW208
     C                   Z-ADD     A6ERLC        WRATE1                                       CSW208
     C                   MOVEL     A6MDIN        WMDI1                                        CSW208
      *                                                                                       CSW208
      **  - RDE - Fee amount                                                                  CSW208
      *                                                                                       CSW208
     C     WFEEH         IFEQ      'Y'                                                        CSW208
     C                   MOVEL     HIAMTS        ##D(5)                                       CSW208
     C                   ELSE                                                                 CSW208
     C                   MOVEL     DFFAMT        ##D(5)                                       CSW208
     C                   ENDIF                                                                CSW208
     C                   MOVE      A6NBDP        ##D(5)                                       CSW208
      *                                                                                       CSW208
      **  - RDE - Payment date                                                                CSW208
      *                                                                                       CSW208
     C                   SELECT                                                               CSW208
     C     DFPYON        WHENEQ    *BLANKS                                                    CSW208
     C     DFPYON        OREQ      'S'                                                        CSW208
     C                   MOVEL     DFPSTD        ##D(6)                                       CSW208
     C     DFPYON        WHENEQ    'E'                                                        CSW208
     C                   MOVEL     DFPEND        ##D(6)                                       CSW208
     C     DFPYON        WHENEQ    'N'                                                        CSW208
     C                   MOVEL     WFNPYD        ##D(6)                                       CSW208
     C                   ENDSL                                                                CSW208
      *                                                                                       CSW208
      **  - RDE - Base currency details                                                       CSW208
      *                                                                                       CSW208
     C                   MOVEL     BJCYCD        ##CCY                                        CSW208
     C                   EXSR      SRDCDT                                                     CSW208
     C                   MOVEL     A6CYNM        ##D(7)                                       CSW208
      *                                                                                       CSW208
      **  - RDE - Fee amount equivalent in base currency                                      CSW208
      *                                                                                       CSW208
     C                   SELECT                                                               CSW208
      *                                                                                       CSW208
     C     WMDI1         WHENEQ    'M'                                                        CSW208
     C     WFEEH         IFEQ      'Y'                                                        CSW208
     C     HIAMTS        MULT      WRATE1        W#AMTS                                       CSW208
     C                   ELSE                                                                 CSW208
     C     DFAMTS        MULT      WRATE1        W#AMTS                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   OTHER                                                                CSW208
     C     WFEEH         IFEQ      'Y'                                                        CSW208
     C     HIAMTS        DIV       WRATE1        W#AMTS                                       CSW208
     C                   ELSE                                                                 CSW208
     C     DFAMTS        DIV       WRATE1        W#AMTS                                       CSW208
     C                   ENDIF                                                                CSW208
      *                                                                                       CSW208
     C                   ENDSL                                                                CSW208
     C                   MOVEL     W#AMTS        ##D(8)                                       CSW208
     C                   MOVE      A6NBDP        ##D(8)                                       CSW208
      *                                                                                       CSW208
      **  Accumulate RDE's and associated data and output to                                  CSW208
      **  PF/CGUDTAPD                                                                         CSW208
     C                   EXSR      SRADTA                                                     CSW208
     C                   EXSR      SRODTA                                                     CSW208
      *                                                                                       CSW208
      *................................................................                       CSW208
      *                                                                                       CSW208
      *                                                                                       CSW208
      **  Unwind subroutine stack name                                                        CSW208
     C                   EXSR      POPGRS                                                     CSW208
     C                   MOVEA     *BLANKS       @STK(Q)                                      CSW208
     C                   SUB       1             Q                                            CSW208
      *                                                                                       CSW208
     C                   ENDSR                                                                CSW208
     C*****************************************************************                       CSW208
     C/SPACE 5                                                                                CSW208
      *****************************************************************                       CER050
      * Subroutine  :  D@APR                                          *                       CER050
      * Function    :  APR details.                                   *                       CER050
      *                                                               *                       CER050
      * Called by   :                                                 *                       CER050
      * Calls       :                                                 *                       CER050
      *****************************************************************                       CER050
     C     D@APR         BEGSR                                                                CER050
      *                                                                                       CER050
      **  Set up subroutine stack name                                                        CER050
     C                   ADD       1             Q                                            CER050
     C                   MOVEL     'D_APR '      @STK(Q)                                      CER050
      *                                                                                       CER050
      *................................................................                       CER050
      *                                                                                       CER050
      **  Retrieve subroutine specific data.                                                  CER050
     C     1             OCCUR     ##SRDT                                                     CER050
     C                   MOVEL     ##SPAT        S#PATH                                       CER050
      *                                                                                       CER050
      **  Set up Path.                                                                        CER050
     C                   MOVEL     '\D_APR '     ##PNAM                                       CER050
     C     S#PATH        CAT       ##PNAM:0      S#PATH                                       CER050
     C                   EXSR      PSHGRS                                                     CER050
      *                                                                                       CER050
      **  Retrieve RDE information for RDEs in group set                                      CER050
      *                                                                                       CER050
     C                   MOVEL     @STK(Q)       ##GRPS                                       CER050
     C                   Z-ADD     1             ##RDEN                                       CER050
     C                   EXSR      SRRRDE                                                     CER050
      *                                                                                       CER050
      * Run this process only if Do not print APR is set to Blank                             CER050
      *                                                                                       CER050
     C     APRC          IFEQ      'Y'                                                        CER050
     C     DLNO          CHAIN     DLAPRHI0                           89                      CER050
      *    APR rate.                                                                          CER050
     C                   MOVEL     IAPRR         ##D(1)                                       CER050
      *   Decimal places hard coded for Spain AS /COPY CG4010C051.                            CER050
     C                   ENDIF                                                                CER050
      *                                                                                       CER050
      **  Accumulate RDE's and associated data and output to                                  CER050
      **  PF/CGUDTAPD.                                                                        CER050
     C                   EXSR      SRADTA                                                     CER050
     C                   EXSR      SRODTA                                                     CER050
      *                                                                                       CER050
      *................................................................                       CER050
      *                                                                                       CER050
     C     EXAPR         TAG                                                                  CER050
      *                                                                                       CER050
      **  Unwind subroutine stack name                                                        CER050
     C                   EXSR      POPGRS                                                     CER050
     C                   MOVEA     *BLANKS       @STK(Q)                                      CER050
     C                   SUB       1             Q                                            CER050
      *                                                                                       CER050
     C                   ENDSR                                                                CER050
      *****************************************************************                       CER050
      * Subroutine  :  ZI@APR                                         *                       CER050
      * Function    :  APR details.                                   *                       CER050
      *                                                               *                       CER050
      * Called by   :                                                 *                       CER050
      * Calls       :                                                 *                       CER050
      *****************************************************************                       CER050
     C     ZI@APR        BEGSR                                                                CER050
      *                                                                                       CER050
      * Run this process only if Do not print APR is set to Blank                             CER050
      *                                                                                       CER050
     C     APRC          IFEQ      'Y'                                                        CER050
     C     DLNO          CHAIN     DLAPRHI0                           89                      CER050
      *                                                                                       CER050
      * LOOK FOR THE FIRST ELEMENT IN BLANK IN SERIE                                          CER050
     C                   Z-ADD     1             R1                2 0                        CER050
     C     ##R(R1)       DOUEQ     *BLANKS                                                    CER050
     C     R1            OREQ      20                                                         CER050
     C                   ADD       1             R1                                           CER050
     C                   ENDDO                                                                CER050
     C*                                                                                       CER050
     C                   CLEAR                   R#DATA                                       CER050
     C                   CLEAR                   R#DEFN                                       CER050
     C                   CLEAR                   #@RDE                                        CER050
     C                   MOVEL     'ZI_AAPR '    #@RDE            10                          CER050
     C     ##RDE         CAT       #@RDE:1       ##RDE                                        CER050
     C                   MOVEL     IAPRR         R#DATA                                       CER050
     C                   MOVEL     IAPRR         ##DATA                                       CER050
     C                   MOVEL     'Rate  '      ##RDEC                                       CER050
     C                   MOVEL     'L'           ##RDET                                       CER050
     C                   MOVEL     '2'           ##DCPA                                       CER050
     C                   MOVEL     R#DATA        ##D(R1)                                      CER050
     C                   MOVEL     R#DEFN        ##R(R1)                                      CER050
      *                                                                                       CER050
     C                   END                                                                  CER050
      *                                                                                       CER050
     C                   ENDSR                                                                CER050
      *****************************************************************                       CER050
     C*COPY*CGCPYSRC,SRERRPSSR                                                       CER050 MD056543
     C/COPY CGCPYSRC,SRERRPSSRL                                                             MD056543
     C/SPACE 5
     C*COPY*CGCPYSRC,SRERRC                                                                 MD056543
     C/COPY CGCPYSRC,SRERRCLE                                                               MD056543
     C/SPACE 5                                                            CDL006
     C*COPY*ZSRSRC,GLINTCZ1                                                          CDL006 MD056543
     C/COPY ZSRSRC,GLINTCZ1LE                                                               MD056543
     C/SPACE 5                                                            CDL006
     C*COPY*ZSRSRC,ZINTDYZ2                                                          CDL006 MD056543
     C/COPY ZSRSRC,ZINTDYZ2LE                                                               MD056543
     C/SPACE 5                                                            CDL006
     C*COPY*ZSRSRC,ZCONVNZ1                                                          CDL006 MD056543
     C/COPY ZSRSRC,ZCONVNZ1LE                                                               MD056543
     C/SPACE 5                                                            CDL006
     C*COPY*ZSRSRC,ZDATE9Z3                                                          CDL006 MD056543
     C/COPY ZSRSRC,ZDATE9Z3LE                                                               MD056543
     C/SPACE 5                                                            CDL006
     C*COPY*ZSRSRC,ZDAT10Z2                                                          CDL006 MD056543
     C/COPY ZSRSRC,ZDAT10Z2LE                                                               MD056543
     C/SPACE 5                                                            CCG015
     C*COPY*CGCPYSRC,CGNWEX                                                          CCG015 MD056543
     C/COPY CGCPYSRC,CGNWEXCILE                                                             MD056543
     C/EJECT                                                                                  235126
     C*COPY*ZSRSRC,ZXRATEZ1                                                          235126 MD056543
     C/COPY ZSRSRC,ZXRATEZ1LE                                                               MD056543
     C***/SPACE 5                                                                      232543 233277
     C***/COPY ZSRSRC,ZXRATEZ1                                                         232543 233277
     O/SPACE 5
      *                                                                                     AR890271
      ** Changed 'DATE' and 'AMOUNT' format to 'Date' and 'Amount' respectively             AR890271
      ** Also adjusted the placing of format codes to their correct position                AR890271
      ** Changed RDE from ACCOUNTG to ACCOUNT                                               AR890271
      *                                                                                     AR890271
** ##GRP/##RDEA
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
BROKER0001 BROKER
BROKER0002 BROKER NAM
BROKER0003 BROKER TWN
CUST  0001 CUSTOMER
CUST  0002 CUST_NAME
CUST  0003 CUST_ADR1
CUST  0004 CUST_ADR2
CUST  0005 CUST_ADR3
CUST  0006 CUST_ADR4
CUST  0007 CUST_TOWN                                                      086918
D_BASE0001 DEALNUMBER
D_BASE0002 DEAL DATE  Date
D_BASE0003 VALUE DATE Date
     X/COPY WNCPYSRC,CG4110X001
D_BASM0001 DEALNUMBER
D_BASM0002 DEAL DATE  Date
D_BASM0003 EVENT_DATE Date
     X/COPY WNCPYSRC,CG4110X002
D_BYSL0001 BUYER NAM
D_BYSL0002 SELLER NAM
D_CFC 0001 CURRENCY
D_CFC 0002 PRINCIPAL  AmountL
D_CFC 0003 FLOOR RAT  Rate  L7
D_CFC 0004 CEILG RAT  Rate  L7
D_CFC 0005 BASERATTYP
D_CFC 0006 BASERATNAM
D_CFC 0007 SPREAD     Rate  L7
D_CFC 0008 AV RATE
D_CFC 0009 BUY/SELL
D_CFC 0010 CCY_DESC                                                       086780
D_CFC 0011 PREC_METIN                                                     086780
D_CFC 0012 CCY_DESC_                                                      119240
D_CFCS0001 NXT IPDATE Date
D_CFCS0002 LST IPDATE Date
D_CFCS0003 GRS INTRST AmountL
D_CFCS0004 NET INTRST AmountL
D_CFCS0005 TAX        AmountL
D_CFCS0006 TAXI
D_CFCS0007 PAY BYUS
D_CFCS0008 PAY BYTHEM
D_CFCS0009 CCY_DESC                                                       CEU003
D_CFCS0010 PREC_METIN                                                     CEU003
D_CFCS0011 NI_SC      AmountL                                             CEU003
D_CFCS0012 NI_EQCY    AmountL                                             CEU014
D_CFCS0013 EQUIV_CCY                                                      CEU014
D_CFCS0014 EQUIV_CCYD                                                     CEU014
D_DAPC0001 CURRENCY
D_DAPC0002 PRINC STRT AmountL
D_DAPC0003 AMNT IN/DE AmountL
D_DAPC0004 PRINCIPAL  AmountL
D_DAPC0005 CCY_DESC                                                       086780
D_DAPC0006 PREC_METIN                                                     086780
D_DAPC0007 CONFNARR                                                       089649
D_DAPC0008 AMT_SC     AmountL                                             CEU003
D_DAPC0009 AMT_EQCY   AmountL                                             CEU014
D_DAPC0010 EQUIV_CCY                                                      CEU014
D_DAPC0011 EQUIV_CCYD                                                     CEU014
D_DARC0001 CURRENCY
D_DARC0002 INT RATE   Rate  L7
D_DARC0003 CCY_DESC                                                       086780
D_DARC0004 PREC_METIN                                                     086780
D_DARC0005 CONFNARR                                                       089649
D_DARC0006 PRINCIPAL  AmountL                                             089760
D_DARC0007 CONTSPR    Rate  L7                                                                CRE073
D_DARC0008 RNDMTD                                                                             CRE073
D_DARC0009 RNDFRCD                                                                            CRE073
D_DARC0010 CRE073F                                                                            CRE073
D_DARC0011 BASE RATE                                                                        MD030644
D_DARC0012 SPREADRATE Rate  L7                                                              MD030644
D_DARC0013 CALCBASIS                                                                        MD030644
D_FLUF0001 FIRSTLAST
D_FLUF0002 UPFRONT
D_FRA 0001 CURRENCY
D_FRA 0002 PRINCIPAL  AmountL
D_FRA 0003 CONTPERIOD AmountL
D_FRA 0004 RATEFIXDTE Date
D_FRA 0005 BASERATTYP
D_FRA 0006 BASERATNAM
D_FRA 0007 CONTRATE   Rate  L7
D_FRA 0008 INT CALBAS
D_FRA 0009 BUY/SELL
D_FRA 0010 CCY_DESC                                                       086780
D_FRA 0011 PREC_METIN                                                     086780
D_FRAS0001 SETTL RATE Rate  L7
D_FRAS0002 SETTL AMNT AmountL
D_FRAS0003 PAY BYUS
D_FRAS0004 PAY BYTHEM
D_FRAS0005 SAMT_SC    AmountL                                             CEU003
D_FRAS0006 SAMT_EQCY  AmountL                                             CEU014
D_FRAS0007 EQUIV_CCY                                                      CEU014
D_FRAS0008 EQUIV_CCYD                                                     CEU014
D_FRX 0001 PURCH CCY
D_FRX 0002 PURCH AMNT AmountL
D_FRX 0003 EXCH RATE  Xrate L8
D_FRX 0004 SALE CCY
D_FRX 0005 SALE AMNT  AmountL
D_FRX 0006 SALE CCYDS                                                     086780
D_FRX 0007 PREC_METIN                                                     086780
D_FRX 0008 PURCH CCYD                                                     086780
D_FRX 0009 PAMT_SC    AmountL                                             CEU003
D_FRX 0010 SLAMT_SC   AmountL                                             CEU003
D_FRX 0011 PAMT_EQCY  AmountL                                             CEU014
D_FRX 0012 P_EQV_CCY                                                      CEU014
D_FRX 0013 P_EQV_CCYD                                                     CEU014
D_FRX 0014 SLAMT_EQCY AmountL                                             CEU014
D_FRX 0015 S_EQV_CCY                                                      CEU014
D_FRX 0016 S_EQV_CCYD                                                     CEU014
D_IRXO0001 OUR NIDATE Date
D_IRXO0002 OUR LIDATE Date
D_IRXO0003 OUR CCY
D_IRXO0004 OUR PRIN   AmountL
D_IRXO0005 OUR GRSINT AmountL
D_IRXO0006 OUR NETINT AmountL
D_IRXO0007 OUR TAX    AmountL
D_IRXO0008 OUR NETPAY AmountL
D_IRXO0009 OUR CCYDSC                                                     086780
D_IRXO0010 PREC_METIN                                                     086780
D_IRXO0011 ONP_SC     AmountL                                             CEU003
D_IRXO0012 ONP_EQCY   AmountL                                             CEU014
D_IRXO0013 EQUIV_CCY                                                      CEU014
D_IRXO0014 EQUIV_CCYD                                                     CEU014
D_IRXT0001 THR NIDATE Date
D_IRXT0002 THR LIDATE Date
D_IRXT0003 THR CCY
D_IRXT0004 THR PRIN   AmountL
D_IRXT0005 THR GRSINT AmountL
D_IRXT0006 THR NETPAY AmountL
D_IRXT0007 THR CCYDSC                                                     086780
D_IRXT0008 PREC_METIN                                                     086780
D_IRXT0009 TNP_SC     AmountL                                             CEU003
D_IRXT0010 TNP_EQCY   AmountL                                             CEU014
D_IRXT0011 EQUIV_CCY                                                      CEU014
D_IRXT0012 EQUIV_CCYD                                                     CEU014
D_LAD 0001 CURRENCY
D_LAD 0002 PRINCIPAL  AmountL
D_LAD 0003 INT RATE   Rate  L7
D_LAD 0004 GRS INTRST AmountL
D_LAD 0005 NET INTRST AmountL
D_LAD 0006 TAX        AmountL
D_LAD 0007 TAXI
D_LAD 0008 NET TOTAL  AmountL
D_LAD 0009 TOTINTOVR
D_LAD 0010 LOAN/DEPOS
D_LAD 0011 CCY_DESC                                                       086780
D_LAD 0012 PREC_METIN                                                     086780
D_LAD 0013 INTPAY_SEP                                                     086864
D_LAD 0014 LST IPDATE Date                                                086962
D_LAD 0015 CONFNARR                                                       089649
D_LAD 0016 C.D. REF                                                       116840
D_LAD 0017 N_TOT_SC   AmountL                                             CEU003
D_LAD 0018 N_TOT_EQCY AmountL                                             CEU014
D_LAD 0019 EQUIV_CCY                                                      CEU014
D_LAD 0020 EQUIV_CCYD                                                     CEU014
D_LAD 0021 CCY_LOCAL                                                                          234865
D_LAD 0022 CCY_RAT_L  Rate  L7                                                                234865
D_LAD 0023 TAX_LOCAL  AmountL                                                                 234865
D_LAD 0024 RESIDENT                                                                         BUG23880
D_LAD 0025 CONTSPR    Rate  L7                                                                CRE073
D_LAD 0026 RNDMTD                                                                             CRE073
D_LAD 0027 RNDFRCD                                                                            CRE073
D_LAD 0028 CRE073F                                                                            CRE073
D_LAD 0029 BASE RATE                                                                        MD030644
D_LAD 0030 SPREADRATE Rate  L7                                                              MD030644
D_LAD 0031 CALCBASIS                                                                        MD030644
D_APR 0001 ZI_AAPR    Rate  L2                                                                CER050
D_LADC0001 INT CAP IN
D_LADC0002 INT CAP    AmountL
D_LADC0003 NEW PRIN   AmountL
D_LADE0001 PRNC_EQCY  AmountL                                             151837
D_LADE0002 G_INT_EQCY AmountL                                             151837
D_LADE0003 CUST_STAT                                                                       BUG23799A
D_LADE0004 CGL031                                                                 BUG23515 BUG23799A
D_LADS0001 NXT IPDATE Date
D_LADS0002 LST IPDATE Date
D_LADS0003 CURRENCY
D_LADS0004 PRINCIPAL  AmountL
D_LADS0005 INT RATE   Rate  L7
D_LADS0006 GRS INTRST Amount
D_LADS0007 NET INTRST Amount
D_LADS0008 TAX        Amount
D_LADS0009 TAXI
D_LADS0010 LOAN/DEPOS
D_LADS0011 CCY_DESC                                                       086780
D_LADS0012 PREC_METIN                                                     086780
D_LADS0013 CONFNARR                                                       089649
D_LADS0014 NI_SC      Amount                                              CEU003
D_LADS0015 NI_EQCY    AmountL                                             CEU014
D_LADS0016 EQUIV_CCY                                                      CEU014
D_LADS0017 EQUIV_CCYD                                                     CEU014
D_LADS0018 CCY_LOCAL                                                                         CER048A
D_LADS0019 CCY_RAT_L  Rate  L7                                                               CER048A
D_LADS0020 TAX_LOCAL  AmountL                                                                CER048A
D_LADS0021 RESIDENT                                                                         BUG23880
D_LADS0022 CUST_STAT                                                                       BUG23799A
D_LADS0023 OUR IPFREQ                                                                       AR995867
D_LADS0024 BASE RATE                                                                        MD030644
D_LADS0025 SPREADRATE Rate  L7                                                              MD030644
D_LADS0026 CALCBASIS                                                                        MD030644
D_OPTD0001 OPT TODATE Date
D_OTH10001 CANC/AMEND
D_OTH10002 FEDERAL
D_OTH10003 AUTO-TRAN
D_OTH10004 DEAL TYPE
D_OTH10005 DEALSUBTYP
D_OTH10006 BLOCK_FLAG                                                                         CDL016
D_OTH10007 FIX_BSRT                                                                           CDL019
D_OTH20001 CANC/AMEND
D_OTH20002 FEDERAL
D_OTH20003 AUTO-TRAN
D_OTH20004 DEAL TYPE
D_OTH20005 DEALSUBTYP
D_OTH20006 DEALAMDTYP
D_PAY?0001 PAY BYUS
D_PAY?0002 PAY BYTHEM
D_PAY?0003 PAY USTHEM
D_PAYS0001 S_PAYOURA1
D_PAYS0002 S_PAYOURA2
D_PAYS0003 S_PAYOURNN
D_PAYS0004 S_PAYOURNT
D_PAYS0005 S_PAYOURXG
D_PAYS0006 S_PAYOURXR
D_PAYS0007 S_PAYTHRA1
D_PAYS0008 S_PAYTHRA2
D_PAYS0009 S_PAYTHRNN
D_PAYS0010 S_PAYTHRNT
D_PAYS0011 S_PAYZFAL1
D_PAYS0012 S_PAYZFAL2
D_PAYS0013 S_PAYZFAON
D_PAYS0014 S_PAYZFAOT
D_PAYS0015 S_SPEC_INS                                                     086864
D_PAYS0016 P_SCCY                                                         CEU003
D_PAYS0017 P_SCCYD                                                        CEU003
D_RECS0001 S_RECOURA1
D_RECS0002 S_RECOURA2
D_RECS0003 S_RECOURNN
D_RECS0004 S_RECOURNT
D_RECS0005 S_RECOURXG
D_RECS0006 S_RECOURXR
D_RECS0007 S_RECTHRA1
D_RECS0008 S_RECTHRA2
D_RECS0009 S_RECTHRNN
D_RECS0010 S_RECTHRNT
D_RECS0011 R_SCCY                                                         CEU003
D_RECS0012 R_SCCYD                                                        CEU003
D_ROLL0001 ROLLBYDLNO
D_ROLL0002 ROLLCAPCHG AmountL
D_ROLL0003 ROLLCAPIND
D_ROLL0004 ROLLBYEQAM AmountL                                             CEU015
D_ROLL0005 ROLLBYEQCY                                                     CEU015
D_RRDT0001 NXT RCDATE Date
D_RRDT0002 FOL RCDATE Date
D_RRDT0003 CURRENCY
D_RRDT0004 BASERATTYP
D_RRDT0005 BASERATNAM
D_RRDT0006 INT RATE   Rate  L7
D_RRDT0007 OURS/THEIR
D_RRDT0008 CCY_DESC                                                       086780
D_RRDT0009 PREC_METIN                                                     086780
MATURD0001 MATUR DATE Date
NOTICD0001 NOTICEDAYS
D_IRSO0001 OUR CCY                                                        CIR001
D_IRSO0002 OUR PRIN   AmountL                                             CIR001
D_IRSO0003 OUR BASTYP                                                     CIR001
D_IRSO0004 OUR BASNAM                                                     CIR001
D_IRSO0005 OUR FIXRAT Rate  L7                                            CIR001
D_IRSO0006 OUR SPREAD Rate  L7                                            CIR001
D_IRSO0007 OUR_CALC_B                                                     CIR001
D_IRST0001 THR CCY                                                        CIR001
D_IRST0002 THR PRIN   AmountL                                             CIR001
D_IRST0003 THR BASTYP                                                     CIR001
D_IRST0004 THR BASNAM                                                     CIR001
D_IRST0005 THR FIXRAT Rate  L7                                            CIR001
D_IRST0006 THR SPREAD Rate  L7                                            CIR001
D_IRST0007 THR_CALC_B                                                     CIR001
D_ONTN0001 OUR NAME                                                       CIR001
D_ONTN0002 THR NAME                                                       CIR001
D_EIRO0001 OUR EFFRAT Rate  L7                                            CIR001
D_EIRO0002 OUR STR EF                                                     CIR001
D_EIRT0001 THR EFFRAT Rate  L7                                            CIR001
D_EIRT0002 THR STR EF                                                     CIR001
D_IPYO0001 OUR NIDATE Date                                                CIR001
D_IPYO0002 OUR IPFREQ                                                     CIR001
D_IPYO0003 OUR IPDAY                                                      CIR001
D_IPYO0004 OUR INPM                                                       CIR001
D_IPYT0001 THR NIDATE Date                                                CIR001
D_IPYT0002 THR IPFREQ                                                     CIR001
D_IPYT0003 THR IPDAY                                                      CIR001
D_IPYT0004 THR INPM                                                       CIR001
D_RCHO0001 OUR NRDATE Date                                                CIR001
D_RCHO0002 OUR RCFREQ                                                     CIR001
D_RCHO0003 OUR RCDAY                                                      CIR001
D_RCHT0001 THR NRDATE Date                                                CIR001
D_RCHT0002 THR RCFREQ                                                     CIR001
D_RCHT0003 THR RCDAY                                                      CIR001
BYOUT 0001 BO_DDAT    Date                                                CIR001
BYOUT 0002 BO_VDAT    Date                                                CIR001
BYOUT 0003 BO_AMNT    AmountL                                             CIR001
BYOUT 0004 BO_PYRC                                                        CIR001
BYOUT 0005 BO_AM_SCCY AmountL                                             CEU014
BYOUT 0006 BO_AM_EQCY AmountL                                             CEU014
BYOUT 0007 EQUIV_CCY                                                      CEU014
BYOUT 0008 EQUIV_CCYD                                                     CEU014
UPFEE 0001 UF_VDAT    Date                                                CIR001
UPFEE 0002 UF_AMNT    AmountL                                             CIR001
UPFEE 0003 UF_PYRC                                                        CIR001
UPFEE 0004 UF_AM_SCCY AmountL                                             CEU014
UPFEE 0005 UF_AM_EQCY AmountL                                             CEU014
UPFEE 0006 EQUIV_CCY                                                      CEU014
UPFEE 0007 EQUIV_CCYD                                                     CEU014
FIDUC 0001 ZFIDNE_AMV AmountL                                             CDL006
FIDUC 0002 CHARGE_AMT AmountL                                             CDL006
FIDUC 0003 COMMIS_AMT AmountL                                             CDL006
FIDUC 0004 ZFIDCO_RAT Rate  L7                                            CDL006
FIDUC 0005 NET_AMOUNT AmountL                                             CDL006
FIDUC 0006 ZFIDFI_DEP                                                     CDL006
D_EMDT0001 EM_DATE    Date                                                           CDL017 MD019890
D_EMDT0002 EM_PNLTYPR                                                                         CDL017
D_EMDT0003 EM_BRTE                                                                            CDL017
D_EMDT0004 EM_INPUSR                                                                          CDL017
D_EMDT0005 EM_AUTUSR                                                                          CDL017
D_EMDT0006 EM_PNLTYAM                                                                         CDL017
d_RMDT0001 MAC_RMACI                                                                          CDL018
d_RMDT0002 MAC_RUNAC                                                                          CDL018
RMAC010001 MAC_RACT1                                                                          CDL018
RMAC010002 MAC_RALL1                                                                          CDL018
RMAC010003 MAC_RPCT1  AmountL                                                                 CDL018
RMAC010004 MAC_RAMT1  AmountL                                                                 CDL018
RMAC020001 MAC_RACT2                                                                          CDL018
RMAC020002 MAC_RALL2                                                                          CDL018
RMAC020003 MAC_RPCT2  AmountL                                                                 CDL018
RMAC020004 MAC_RAMT2  AmountL                                                                 CDL018
RMAC030001 MAC_RACT3                                                                          CDL018
RMAC030002 MAC_RALL3                                                                          CDL018
RMAC030003 MAC_RPCT3  AmountL                                                                 CDL018
RMAC030004 MAC_RAMT3  AmountL                                                                 CDL018
RMAC040001 MAC_RACT4                                                                          CDL018
RMAC040002 MAC_RALL4                                                                          CDL018
RMAC040003 MAC_RPCT4  AmountL                                                                 CDL018
RMAC040004 MAC_RAMT4  AmountL                                                                 CDL018
RMAC050001 MAC_RACT5                                                                          CDL018
RMAC050002 MAC_RALL5                                                                          CDL018
RMAC050003 MAC_RPCT5  AmountL                                                                 CDL018
RMAC050004 MAC_RAMT5  AmountL                                                                 CDL018
RMAC060001 MAC_RACT6                                                                          CDL018
RMAC060002 MAC_RALL6                                                                          CDL018
RMAC060003 MAC_RPCT6  AmountL                                                                 CDL018
RMAC060004 MAC_RAMT6  AmountL                                                                 CDL018
RMAC070001 MAC_RACT7                                                                          CDL018
RMAC070002 MAC_RALL7                                                                          CDL018
RMAC070003 MAC_RPCT7  AmountL                                                                 CDL018
RMAC070004 MAC_RAMT7  AmountL                                                                 CDL018
RMAC080001 MAC_RACT8                                                                          CDL018
RMAC080002 MAC_RALL8                                                                          CDL018
RMAC080003 MAC_RPCT8  AmountL                                                                 CDL018
RMAC080004 MAC_RAMT8  AmountL                                                                 CDL018
RMAC090001 MAC_RACT9                                                                          CDL018
RMAC090002 MAC_RALL9                                                                          CDL018
RMAC090003 MAC_RPCT9  AmountL                                                                 CDL018
RMAC090004 MAC_RAMT9  AmountL                                                                 CDL018
RMAC100001 MAC_RACT10                                                                         CDL018
RMAC100002 MAC_RALL10                                                                         CDL018
RMAC100003 MAC_RPCT10 AmountL                                                                 CDL018
RMAC100004 MAC_RAMT10 AmountL                                                                 CDL018
RMAC110001 MAC_RACT11                                                                         CDL018
RMAC110002 MAC_RALL11                                                                         CDL018
RMAC110003 MAC_RPCT11 AmountL                                                                 CDL018
RMAC110004 MAC_RAMT11 AmountL                                                                 CDL018
RMAC120001 MAC_RACT12                                                                         CDL018
RMAC120002 MAC_RALL12                                                                         CDL018
RMAC120003 MAC_RPCT12 AmountL                                                                 CDL018
RMAC120004 MAC_RAMT12 AmountL                                                                 CDL018
d_PMDT0001 MAC_PMACI                                                                          CDL018
d_PMDT0002 MAC_PUNAC                                                                          CDL018
PMAC010001 MAC_PACT1                                                                          CDL018
PMAC010002 MAC_PALL1                                                                          CDL018
PMAC010003 MAC_PPCT1  AmountL                                                                 CDL018
PMAC010004 MAC_PAMT1  AmountL                                                                 CDL018
PMAC020001 MAC_PACT2                                                                          CDL018
PMAC020002 MAC_PALL2                                                                          CDL018
PMAC020003 MAC_PPCT2  AmountL                                                                 CDL018
PMAC020004 MAC_PAMT2  AmountL                                                                 CDL018
PMAC030001 MAC_PACT3                                                                          CDL018
PMAC030002 MAC_PALL3                                                                          CDL018
PMAC030003 MAC_PPCT3  AmountL                                                                 CDL018
PMAC030004 MAC_PAMT3  AmountL                                                                 CDL018
PMAC040001 MAC_PACT4                                                                          CDL018
PMAC040002 MAC_PALL4                                                                          CDL018
PMAC040003 MAC_PPCT4  AmountL                                                                 CDL018
PMAC040004 MAC_PAMT4  AmountL                                                                 CDL018
PMAC050001 MAC_PACT5                                                                          CDL018
PMAC050002 MAC_PALL5                                                                          CDL018
PMAC050003 MAC_PPCT5  AmountL                                                                 CDL018
PMAC050004 MAC_PAMT5  AmountL                                                                 CDL018
PMAC060001 MAC_PACT6                                                                          CDL018
PMAC060002 MAC_PALL6                                                                          CDL018
PMAC060003 MAC_PPCT6  AmountL                                                                 CDL018
PMAC060004 MAC_PAMT6  AmountL                                                                 CDL018
PMAC070001 MAC_PACT7                                                                          CDL018
PMAC070002 MAC_PALL7                                                                          CDL018
PMAC070003 MAC_PPCT7  AmountL                                                                 CDL018
PMAC070004 MAC_PAMT7  AmountL                                                                 CDL018
PMAC080001 MAC_PACT8                                                                          CDL018
PMAC080002 MAC_PALL8                                                                          CDL018
PMAC080003 MAC_PPCT8  AmountL                                                                 CDL018
PMAC080004 MAC_PAMT8  AmountL                                                                 CDL018
PMAC090001 MAC_PACT9                                                                          CDL018
PMAC090002 MAC_PALL9                                                                          CDL018
PMAC090003 MAC_PPCT9  AmountL                                                                 CDL018
PMAC090004 MAC_PAMT9  AmountL                                                                 CDL018
PMAC100001 MAC_PACT10                                                                         CDL018
PMAC100002 MAC_PALL10                                                                         CDL018
PMAC100003 MAC_PPCT10 AmountL                                                                 CDL018
PMAC100004 MAC_PAMT10 AmountL                                                                 CDL018
PMAC110001 MAC_PACT11                                                                         CDL018
PMAC110002 MAC_PALL11                                                                         CDL018
PMAC110003 MAC_PPCT11 AmountL                                                                 CDL018
PMAC110004 MAC_PAMT11 AmountL                                                                 CDL018
PMAC120001 MAC_PACT12                                                                         CDL018
PMAC120002 MAC_PALL12                                                                         CDL018
PMAC120003 MAC_PPCT12 AmountL                                                                 CDL018
PMAC120004 MAC_PAMT12 AmountL                                                                 CDL018
FRCD  0001 RT CHG DAT Date                                                                  BUG11112
FRCD  0002 RT CHG FRQ                                                                       BUG11112
FRCD  0003 RT CHG DAY                                                                       BUG11112
FRCD  0004 SH RATE FL                                                                       BUG11112
FRCD  0005 SH RATE    Rate  L7                                                              BUG11112
FRCD  0006 ACC INTRST AmountL                                                               BUG11112
FRCD  0007 ACC COF    AmountL                                                               BUG11112
FRCD  0008 SH RATE VA                                                                       BUG11112
FRCD  0009 FX RATE VA                                                                       BUG11112
FRCD  0010 RT FIX DAY                                                                       BUG11112
FRCD  0011 RT FIX DAT Date                                                                  BUG11112
FRCD  0012 RT FIX PRF                                                                       BUG11112
FRCD  0013 FIX BASE R Rate  L7                                                              BUG11112
FRCD  0014 FWD YLD CU                                                                       BUG11112
FRCD  0015 CURRENCY                                                                         BUG11112
DL_FED0001 DL_FEESDNO                                                                         CSW208
DL_FED0002 DL_FEEFCOD                                                                         CSW208
DL_FED0003 DL_FEEFCCY                                                                         CSW208
DL_FED0004 DL_FEEFCYD                                                                         CSW208
DL_FED0005 DL_FEEFAMT AmountL                                                                 CSW208
DL_FED0006 DL_FEEDTE  Date                                                                    CSW208
DL_FED0007 DL_FEEECYD                                                                         CSW208
DL_FED0008 DL_FEEEAMT AmountL                                                                 CSW208
CGSTAX0001 SEC_TAXA   AmountL                                                                 CER048
CGSTAX0002 SEC_TAXB                                                                           CER048
CGSTAX0003 SEC_TXAC                                                                           CER048
CGSTAX0004 SEC_TAXR   Rate  L4                                                                CER048
CGSTAX0005 CER048                                                                           BUG23515
CGSTAX0006 THRSH_METH                                                                       BUG23515
CGSTAX0007 ZZFGINTC   AmountL                                                               BUG23515
CGSTAX0008 ZZFGINTD   AmountL                                                               BUG23515
CGSTAX0009 ZZFTINTC   AmountL                                                               BUG23515
CGSTAX0010 ZZFTINTD   AmountL                                                               BUG23515
CGSTAX0011 ZZFWHTC    AmountL                                                               BUG23515
CGSTAX0012 ZZFWHTB    AmountL                                                               BUG23515
CGSTAX0013 ZZFSCNC    AmountL                                                               BUG23515
CGSTAX0014 ZZFSCNB    AmountL                                                               BUG23515
CGSTAX0015 ZZFNINTC   AmountL                                                               BUG23515
CGSTAX0016 ZZFNINTD   AmountL                                                               BUG23515
CGTTAX0001 ZZFCHTC    AmountL                                                                 CER054
CGTTAX0002 ZZFCHTB    AmountL                                                                 CER054
CGTTAX0003 ZZFCHRT    Rate  L5                                                                CER054
CGTTAX0004 THD_TAXB                                                                           CER054
CGTTAX0005 THD_TXAC                                                                           CER054
CGTTAX0006 THD_STAC                                                                           CER054
CGTTAX0007 THD_RELA                                                                           CER054
LNSTAX0001 ZSTAXFLG                                                                           CER049
LNSTAX0002 ZTAXPRFLG                                                                          CER049
LNSTAX0003 ZTAXPRDTE  Date                                                           CER049 AR890271
LNSTAX0004 ZTAXAVFLG                                                                          CER049
LNSTAX0005 ZTAXAVDTE  Date                                                           CER049 AR890271
LNSTAX0006 ZTAXINFLG                                                                          CER049
LNSTAX0007 ZTAXINDTE  Date                                                           CER049 AR890271
LNSTAX0008 ACCOUNT                                                                   CER049 AR890271
LNSTAX0009 Z_TAX_AMT  AmountL                                                        CER049 AR890271
LNSTAX0010 ZTAXINAMT  AmountL                                                        CER049 AR890271
LNSTAX0011 ZTAXAVAMT  AmountL                                                        CER049 AR890271
RTVRCV0001 RBTB1                                                                              CDL094
RTVRCV0002 RBTB2                                                                              CDL094
RTVRCV0003 RBTB3                                                                              CDL094
RTVRCV0004 RBTB4                                                                              CDL094
RTVRCV0005 RBTB5                                                                              CDL094
RTVRCV0006 RBTB6                                                                              CDL094
RTVRCV0007 A7RF56                                                                             CDL094
RTVRCV0008 A7RA56                                                                             CDL094
RTVRCV0009 A7RF57                                                                             CDL094
RTVRCV0010 A7RA57                                                                             CDL094
RTVRCV0011 A7RF58                                                                             CDL094
RTVRCV0012 A7RA58                                                                             CDL094
**  Table of Deal Type vs related Print Item Sub Type
BDBILL_PURCH
BRBILL_SOLD
DABNKACP_PRC
RABNKACP_SLD
BPBOND_PURCH
BSBOND_SOLD
CLCALL_LOAN
CDCALL_TAKE
RPCAP
CICD_ISSUED
RRCOLLAR
LNCOMM_LOAN
CXCROSS_CCY
DLDEMAN_LOAN
RFFLOOR
FRFRA
FPFX_PURCH
FSFX_SALE
DPIBANK_PLAC                                                              CDL006
FLIBANK_PLAC                                                              CDL006
IPIBANK_PLAC
LPIBANK_PLAC                                                              CDL006
DTIBANK_TAKE                                                              CDL006
FTIBANK_TAKE                                                              CDL006
ITIBANK_TAKE
LTIBANK_TAKE                                                              CDL006
IDINFUN_DEPO
ILINFUN_LOAN
PSINTERN_FX
PDINTERN_LD
PLINTERN_LD
OTOP_TDOWN
OPOPTION
C1PRIMCD_PRC
CSPRISEC_CD
PIPURCH_INT
SISALE_INT
RSSCCY_IRS
C2SECCD_PRC
SWSWAP
TBTBILL_PRCH
TSTBILL_SOLD
TITIME_PLACE
TDTIME_TAKE
TATRDACPT_PR
TRTRDACPT_SL
RXXCCY_IRS
CFFRCD_ISSUE                                                                                BUG11112
** Loan Deal Types
IPTICLLNDLILPLFLDPLP                                                      CDL006
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                       CDL006
0000001                                                                   CDL006
0000010                                                                   CDL006
0000100                                                                   CDL006
0001000                                                                   CDL006
0010000                                                                   CDL006
0100000                                                                   CDL006
1000000                                                                   CDL006
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN    CDL006
00366007310109601461                                                      CDL006
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR       CDL006
00000000310005900090001200015100181002120024300273003040033400365         CDL006
