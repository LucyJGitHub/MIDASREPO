     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Securities trade confirmations')              *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4210 - Securities Trade Confirmations                      *
     F*                                                               *
     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*  (phase(s))                                                   *
     F*                                                               *
     F*  Called By: mmCnnnn - (program name)                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD057247           Date 01Feb21               *
      *  Prev Amend No. 248698             Date 01Jun20               *
      *                 MD046248           Date 27Oct17               *
      *                 226449             Date 24Jun15               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CPK024             Date 13Dec05               *
      *                 BUG9603            Date 13Dec05               *
      *                 235557             Date 08Aug05               *
      *                 235291             Date 08Aug05               *
      *                 234770             Date 08Jul05               *
      *                 CGL031             Date 05Jul04               *
      *                 CSE071             Date 19Jul05               *
      *                 BUG7326            Date 01Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 226938             Date 01Sep03               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3122            Date 17Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 214731             Date 27May03               *
      *                 219242             Date 01Jul03               *
      *                 219241             Date 01Jul03               *
      *                 170783             Date 21Dec99               *
      *                 180056             Date 18Oct00               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      *                 180707             Date 25Jul00               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSE022             Date 29Mar01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 166911             Date 31Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 149212             Date 28Feb00               *
      *                 133423             Date 28Feb00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 130862             Date 18Oct98               *
     F*                 CEU014             Date 08Jun98               *
     F*                 089776             Date 17Jun96               *
     F*                 089693             DATE 16APR96               *
     F*                 092961             DATE 04OCT95               *
     F*                 089202             DATE 24MAY95               *
     F*                 089204             DATE 24MAY95               *
     F*                 087972             DATE 18MAY95               *
     F*                 087630             DATE 16MAY95               *
     F*                 087497             DATE 12MAY95               *
     F*                 087328             DATE 10MAY95               *
     F*                 087136             DATE 09MAY95               *
     F*                 086918             DATE 02MAY95               *
     F*                 086865             DATE 01MAY95               *
     F*                 S01522             DATE 05APR95               *
     F*                 084868             DATE 17MAR95               *
     F*                 086160             DATE 09MAR95               *
     F*                 082060             DATE 24JAN95               *
     F*                 081961             DATE 12JAN95               *
     F*                 S01522             DATE 22NOV94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD057247 - Multiple calls of UTCHOBJEX for several COB com-  *
      *             ponents - Securities module.                      *
      *           - Moved the call of AOSARDR0 from /copy ZLCDZ1.     *
      *  248698 - Rounding discrepancies on some SE reports. Applied  *
      *           fix 228682.                                         *
      *  228682 - Recompiled due to ZCNSDZ1 changes. Applied 176594.  *     
      *  MD046248 - Finastra Rebranding                               *
      *  226449 - Recompiled over changes made in /COPY ZDYYRZ3.      *
      *         - Applied for MD034387.                               *
      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
      *  CRE073 - Portuguese Feature - Interest Rate Rounding         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CPK024 - MidasPlus 1.2.2 Release packaging.                  *
      *  BUG9603 - Changes in CGPACKE caused some programs not to     *
      *            compile.                                           *
      *  235557 - Review extract of Tax in base ccy                   *
      *  235291 - Correct extract of EU tax.                          *
      *  234770 - Field EUTax is not extracted.                       *
      *  CGL031 - Taxation on Saving Income                           *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  BUG7326 - General ledger account incomplete in element       *
      *            <SaleReceiveOurXGeneralLedger> and <SalePayOur     *
      *            XGeneralLedger>. This is due to field ##OGA        *
      *            still 20-char long and not expanded to 24 chars    *
      *            (missed out by CGL029). Also note length of RDEs   *
      *            S_RECOURXG and S_PAYOURXG was increased from 20    *
      *            to 24.                                             *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  226938 - Databasse error if customer is closed               *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  214731 - Add Portfolio Reference and Investment Name in      *
      *           Securities modules extracts.                        *
      *  219242 - Not possible to create MT103+ payment msg from      *
      *           non-FT transaction (Recompile)                      *
      *  219241 - Defaulting of "Details of Charges" assign a         *
      *           system value (Recompile)                            *
      *  170783 - Recompiled over changed in ZLCDZ1.                  *
      *  180056 - Recompiled over changed in ZDYYRZ3.                 *
      *  CCG015 - Correspondence Manager Phase 1                      *
     F*  180707 - No Position Settlements generated. Recompile over   *
     F*           changes in /COPY ZNCDZ3.                            *
      *  CSE022 - Depository Definition Enhancement                   *
     F*  CSD006 - Recompiled over changed SDCURRPD.                   *
     F*  166911 - Extract Euroclear/Cedel code and Safe keeping       *
     F*           account in S_OURDACNO and S_THRDACNO respectively.  *
      *  CSE023 - Treaty Withholding Tax                              *
     F*  149212 - Error in 133423 - references loaded for wrong depos.*
     F*  133423 - Program did not output details of Depo references.  *
     F*  130862 - Recompiled over ZLCDZ1 & ZDAYSZ2 changes.           *
     F*  CEU014 - EMU User Defined Correspondence project.            *
     F*  089776 - Add 'Account officer' details                       *
     F*  089693 - Add 'ISIN/COMMON CODE' to group set T_SECD          *
     F*  092961 - Recompile over ZDAYSZ2 for 086491                   *
     F*           Wrong number of days calculated for day basis 1     *
     F*           when start or end day is last day of February.      *
     F*  089202 - Reallowance incorrectly calculated.                 *
     F*  089204 - Do not check RECI for authorisation                 *
     F*  087972 - Place Midas derived sec. desc always in line 3      *
     F*  087630 - Reallowance amount incorrectly calculated.          *
     F*  087497 - If last change type is authorisation, access        *
     F*           authorisation audit file to find whether trade has  *
     F*           been amended or cancelled.                          *
     F*  087328 - No data being output for T_TRDS due to erroneous    *
     F*           handling of group set greater than 20.              *
     F*  087136 - If charges are zero, move zeros as data.            *
     F*  086918 - Add customer town RDE to Group set CUST.            *
     F*  086865 - Add RDE totals for Customer commission and charge   *
     F*           amount 2 together with a total for charge amounts   *
     F*           3 to 7.                                             *
     F*  S01522 - Add /COPY FRO GROSS/NET CALCULATION                 *
     F*  084868 - Add new Trade Narrative RDE                         *
     F*  086160 - Reduce the size of group set T_TRDD, add new group  *
     F*           set T_TRDC.                                         *
     F*  082060 - Redefine Binary fields as Decimal (9,0 Packed)      *
     F*  081961 - User Defined Correspondence - Additions             *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     FSECTY   IF  E           K        DISK
     F                                              KINFSR SRFILE
     FINVTP   IF  E           K        DISK
     F                                              KINFSR SRFILE
     FSECGT   IF  E           K        DISK
     F                                              KINFSR SRFILE
     FTRADSDY1IF  E           K        DISK
     F                                              KINFSR SRFILE
     F***SDCSINL6IF  E           K        DISK                                         CGL031 234770
     F**********                                    KINFSRRSRFILEE                     CGL031 234770
     FTRAUT   IF  E           K        DISK                               087497
      *                                                                                       CER049
      ** Midas SE Stamp Tax Trades Extension File                                             CER049
      *                                                                                       CER049
     FTRADSQL0IF  E           K        DISK                                                   CER049
      *                                                                                       CER049
     F/COPY WNCPYSRC,CG4210F001
     F/SPACE 5
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E************        ##GRP   1  87 10   ##RDEA 22                    084868
     E************        ##GRP   1  88 10   ##RDEA 22              084868086918
     E************        ##GRP   1  89 10   ##RDEA 22              086918089693
     E/COPY WNCPYSRC,CG4210E001
     E************        ##GRP   1  90 10   ##RDEA 22              089693CEU014
     E***********         ##GRP   1  96 10   ##RDEA 22             CEU014 CSE023
     E***********         ##GRP   1  97 10   ##RDEA 22                                 CSE023 214731
     E**********          ##GRP   1  99 10   ##RDEA 22                                 214731 CGL031
     E***********         ##GRP   1 100 10   ##RDEA 22                                 CGL031 234770
     E***********         ##GRP   1 104 10   ##RDEA 22                                 234770 CRE073
     E**********          ##GRP   1 109 10   ##RDEA 22                                 CRE073 CER049
     E                    ##GRP   1 110 10   ##RDEA 22                                        CER049
     E/COPY WNCPYSRC,CG4210E002
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Arrays of Proc. Type (PROT) and the associated print item sub-type
     E                    ##PT    1   9  1   ##PS   10
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
     E                    ARR36      10  6                                133423
     E                    ARRSE      10  6                                133423
     E/COPY ZSRSRC,ZNCDZ1
     E/COPY ZSRSRC,ZSDESCZ1
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZDAYSZ1
     E/COPY ZSRSRC,ZPOWER8Z1                                              089202
     E/COPY ZSRSRC,ZPOWERZ1                                                                   234770
     I*
     I*********** DS                                                      082060
     I***********                         B   1   20##OSEQ                082060
     I****Convert Ouput Sequence between Numeric and Binary               082060
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9603
     I                                        15632 ##S                                      BUG9603
     I##ADS       DS                           5120                       087328
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I** Used to convert item reference from character to numeric
     I*
     I            DS
     I                                        1   6 ##NCIT
     I                                        1   3 NMCY
     I                                        4   6 SITP
     I            DS
     I                                        1   5 ##CCCC
     I                                        1   3 ##CCY
     I                                        4   5 ##CCD
     I**  For error reporting
     I*
     I*---------------------------------------------------------------------
     I* Named constants
     I*
     I              'TRADE     '          C         W#PTYP
     I*---------------------------------------------------------------------
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
      *
     ISDBANK    E DSSDBANKPD
      **  External DS for Bank details
      *
     ISDGELR    E DSSDGELRPD
      **  External DS for General Ledger details
      *
     ISDMMOD    E DSSDMMODPD
      **  External DS for Module details
      *
     ISDSTRD    E DSSDSTRDPD
      **  External DS for Securities Trading Module details
      *
     ISDTRAD    E DSSDTRADPD
      **  External DS for Trading Module details
     I              QQACCD                          QQACC1                                    CGL029
      *
     ISDDEAL    E DSSDDEALPD
      **  External DS for Dealing Module details
     I              QQACCD                          QQACC2                                    CGL029
      *
     ISDRETL    E DSSDRETLPD
      **  External DS for Retail details
     I              QQACCD                          QQACC3                                    CGL029
      *
     ISDMGME    E DSSDMGMEPD
      **  External DS for Message Management details
      *
     ISDBRCH    E DSSDBRCHPD
      **  External DS for branch details
      *
     ISDCUST    E DSSDCUSTPD
      **  External DS for customer details
     I              QQDFAC                          QQDFA1                                    CGL029
      *
     ISDSECS    E DSSDSECSPD
      **  External DS for securities trading customer details
     I              QQACCD                          QQACC4                                    CGL029
      *
     ISDCURR    E DSSDCURRPD                101
      **  External DS for currency details
      *                                                                                       CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
      ** External DS for SAR details                                                          CCG015
     I              LCD                             XXLCD                                     CCG015
      *
     IDSFDY     E DSDSFDY
      **  First DS for access programs, short data structure
      *
     IDSSDY     E DSDSSDY
      **  Second DS for access programs, long data structure
      *
     IDSLDY     E DSDSLDY                                                                     226938
     I*  Third DS for access programs, very long data strcture                                226938
      *                                                                                       226938
     IDSPARM    E DSTRADSD
     I              CHTP                            TDCHTP
      **  External DS for parameters based on PF/TRADSD
      *
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     ISDSTPD    E DSSDSTPDPD                                                                  CER049
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
      *                                                                   089776
      ** Parameters for call to CG4976.                                   089776
      **                                                                  089776
     IP5PARM      DS                            256                       089776
      * Output Sequence                                                   089776
     I                                        1   90R1OSEQ                089776
      * UDC item number                                                   089776
     I                                       10  170R1ITEM                089776
      * This bind level                                                   089776
     I                                       18  250R1TBIN                089776
      * Previous bind level                                               089776
     I                                       26  330R1PBIN                089776
     IP7PARM      DS                            256                       089776
      * Account Officer                                                   089776
     I                                        1   2 P1ACOF                089776
     I*                                                                   133423
     I*  DS TO FILL THE ARRAY ARR36 WHEN READING A RECORD                 133423
     I*                                                                   133423
     I                                        1   6 @DR1                  133423
     I************                           19  24 @DR2            133423149212
     I************                            7  12 @DR3            133423149212
     I************                           25  30 @DR4            133423149212
     I************                           31  36 @DR5            133423149212
     I************                           37  42 @DR6            133423149212
     I************                           43  48 @DR7            133423149212
     I************                           49  54 @DR8            133423149212
     I************                           55  60 @DR9            133423149212
     I************                           13  18 @DR10           133423149212
     I                                        7  12 @DR2                  149212
     I                                       13  18 @DR3                  149212
     I                                       19  24 @DR4                  149212
     I                                       25  30 @DR5                  149212
     I                                       31  36 @DR6                  149212
     I                                       37  42 @DR7                  149212
     I                                       43  48 @DR8                  149212
     I                                       49  54 @DR9                  149212
     I                                       55  60 @DR10                 149212
     I                                        1  60 ARR36                 133423
     I*                                                                   133423
     I            DS                                                      133423
     I*                                                                   133423
     I*  DS TO FILL THE ARRAY ARRSE WHEN READING A RECORD                 133423
     I*  FROM THE FILE SDSECSPD                                           133423
     I*                                                                   133423
     I                                        1   6 @DRF1                 133423
     I                                        7  12 @DRF2                 133423
     I                                       13  18 @DRF3                 133423
     I                                       19  24 @DRF4                 133423
     I                                       25  30 @DRF5                 133423
     I                                       31  36 @DRF6                 133423
     I                                       37  42 @DRF7                 133423
     I                                       43  48 @DRF8                 133423
     I                                       49  54 @DRF9                 133423
     I                                       55  60 @DRF0                 133423
     I                                        1  60 ARRSE                 133423
     I/COPY WNCPYSRC,CG4210I001
     I/COPY CGCPYSRC,SRERRI
     I/COPY ZSRSRC,ZNCDZ2
     I/COPY ZSRSRC,ZSDESCZ2
     C/SPACE 5
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           W0RTN
     C                     PARM           W0CMT   3
     C                     PARM           ##COPD  1
     C                     PARM           ##AUTO  1
     C                     PARM           DSPARM
     C           *LIKE     DEFN TDCHTP    S#CHTP
     C                     MOVELTDCHTP    S#CHTP
      *                                                                   S01522
      * ADD COPY FROM BLI FOR GROSS/NET CALCULATION                       S01522
      *                                                                   S01522
     C*COPY*CGCPYSRC,CG4210GNET****************************************                S01522 CPK024
     C/COPY WNCPYSRC,CG4210GNET                                                               CPK024
     C                     MOVELS#CHTP    TDCHTP
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
     C*  Initialise subscripts                                            133423
      *                                                                   133423
     C                     Z-ADD1         A       20                      133423
     C                     Z-ADD1         V       20                      133423
      *                                                                   133423
      **  Initial processing - Once Only
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      ** Initialisation processing
     C                     EXSR SRINZ
      *
      ** Main processing
     C                     EXSR SRMAIN
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
      ** Access Security (and investment type) details
      ** (Set event control date to trade value date for NCD calculations)
      *
     C                     Z-ADDTDVD      ECD     50
     C                     Z-ADDTDVD      ZECD    50
     C                     EXSR SRSECT
      *
      **  Generate reference number by writing to PF/CGUDCRPD
      **  If no confirmation to be produced, then bypass
      *
     C           *LIKE     DEFN PROT      ##PROT
     C                     MOVELPROT      ##PROT
     C                     MOVE 'N'       ##COPD
     C                     EXSR SRGENR
     C           ##COPD    CABEQ'N'       EXMAIN
      *
      ** Extract Trades
      *
     C                     EXSR T01TRD
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  T01TRD                                         *
      * Function    :  Extract Trades                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           T01TRD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL't01TRD'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\t01TRD' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ** Branch Details
     C                     EXSR BRANCH
      *
      ** Security Details
     C                     EXSR T@SECD
      *
      ** Trade Details
     C                     EXSR T@TRDD
      *                                                                   CEU014
      ** Trade Settlement Details - EMU                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C                     EXSR T@EMU                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   086160
      ** Trade Details - Charges                                          086160
     C                     EXSR T@TRDC                                    086160
      *
      ** Trade Settlement Details
     C                     EXSR T@TRDS
      *
      ** Customer Details
     C                     EXSR CUST
      *                                                                   089776
      ** Counterparty Account Officer Details                             089776
     C                     EXSR ACOF                                      089776
      *
      ** Other Trade Details
     C                     EXSR T@OTHT
      *
     C/COPY WNCPYSRC,CG4210C012
      *................................................................
      *
     C           EX1TRD    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/COPY WNCPYSRC,CG4210C013
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C           TDBA      IFNE ##BRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM TDBA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELTDBA      W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Get Customer Details for Branch Internal Customer
      *
     C*****                CALL 'AOCUSTR0'             99                                     226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM A8BICN    ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C******     SDCUST    PARM SDCUST    DSSDY                                               226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVELA8BICN    W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Store Booking Branch and Branch Internal Customer Number
      *
     C           *LIKE     DEFN TDBA      BBBRCA
     C                     MOVELTDBA      BBBRCA
     C           *LIKE     DEFN BBCUST    BBBICN
     C                     MOVELBBCUST    BBBICN
     C                     END
      *
      ** Branch
     C                     MOVELA8BRCD    ##D,1
      *
      ** Branch Name
     C                     MOVELA8BRNM    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CUST                                           *
      * Function    :  Customer Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CUST      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CUST  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CUST  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Customer Details of Counterparty
      *
     C                     MOVELTCNR      ##KEY1
     C*****                CALL 'AOCUSTR0'             99                                     226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C******     SDCUST    PARM SDCUST    DSSDY                                               226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE           ***************
     C                     MOVELTCNR      W0KEY            * DB ERROR 03 *
     C                     Z-ADD3         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Get Securities trading customer details
      *
     C                     CALL 'AOSECSR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BBCUST    ##CUST
     C           SDSECS    PARM SDSECS    DSSDY
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDSECSPD'W0FILE           ***************
     C                     MOVELBBCUST    W0KEY            * DB ERROR 04 *
     C                     Z-ADD4         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      ***********                                                         081961
      ***Store*Customer Number and Name                                   081961
      ***********                                                         081961
     C************LIKE     DEFN BBCUST    CPCUST                          081961
     C***********          MOVELBBCUST    CPCUST                          081961
      *
      ** Customer
     C                     MOVELBBCUST    ##D,1
      *
      ** Customer Name
     C                     MOVELBBCRNM    ##D,2
      *
      ** Customer Address Line 1
     C                     MOVELBBCNA1    ##D,3
      *
      ** Customer Address Line 2
     C                     MOVELBBCNA2    ##D,4
      *
      ** Customer Address Line 3
     C                     MOVELBBCNA3    ##D,5
      *
      ** Customer Address Line 4
     C                     MOVELBBCNA4    ##D,6
      *                                                                   086918
      ** Customer Town                                                    086918
     C                     MOVELBBCRTN    ##D,7                           086918
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCUST    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5                                                            089776
      *****************************************************************   089776
      * Subroutine  :  ACOF                                           *   089776
      * Function    :  Account Officer Details                        *   089776
      *                                                               *   089776
      * Called by   :                                                 *   089776
      * Calls       :                                                 *   089776
      *****************************************************************   089776
     C           ACOF      BEGSR                                          089776
      *                                                                   089776
      **  Set up subroutine stack name                                    089776
     C                     ADD  1         Q                               089776
     C                     MOVEL'ACOF  '  @STK,Q                          089776
      *                                                                   089776
      *................................................................   089776
      *                                                                   089776
      **  Retrieve subroutine specific data.                              089776
     C           1         OCUR ##SRDT                                    089776
     C                     MOVEL##SPAT    S#PATH                          089776
      *                                                                   089776
      **  Set up data.                                                    089776
     C                     CLEARP7PARM                                    089776
     C                     MOVELBBACOC    P1ACOF                          089776
      *                                                                   089776
     C                     CLEARP4PARM                                    089776
     C                     MOVELS#PATH    P4PARM                          089776
      *                                                                   089776
     C                     CLEARP5PARM                                    089776
     C                     Z-ADD##OSEQ    R1OSEQ                          089776
     C                     Z-ADD##ITEM    R1ITEM                          089776
     C                     Z-ADDDETBIN    R1TBIN                          089776
     C                     Z-ADDDEPBIN    R1PBIN                          089776
      *                                                                   089776
     C                     CALL 'CG4976'                                  089776
     C                     PARM *BLANKS   W0RTN   7                       089776
     C                     PARM           P7PARM                          089776
     C                     PARM           P4PARM140        Path           089776
     C                     PARM           W0CMT   3                       089776
     C                     PARM           P5PARM                          089776
     C                     PARM           ##REFR                                              CCG015
     C                     PARM           P@ICR                                               CCG015
     C                     PARM 'N'       ##MAST                                              CCG015
      *                                                                   089776
      **  Reset Sequence number.                                          089776
     C                     Z-ADDR1OSEQ    ##OSEQ                          089776
     C                     Z-ADDR1TBIN    DETBIN                          089776
     C                     Z-ADDR1PBIN    DEPBIN                          089776
      *                                                                   089776
      *                                                                   089776
      *                                                                   089776
      *................................................................   089776
      *                                                                   089776
     C           EXACOF    TAG                                            089776
      *                                                                   089776
      **  Unwind subroutine stack name                                    089776
     C                     MOVEA*BLANKS   @STK,Q                          089776
     C                     SUB  1         Q                               089776
      *                                                                   089776
     C                     ENDSR                                          089776
     C*****************************************************************   089776
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  T@OTHT                                         *
      * Function    :  Other trade Details                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           T@OTHT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'T_OTHT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\T_OTHT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Cancel/Amend.
      ** Test that bit 0 of message indicator is on.
     C                     TESTB'0'       TMSI           99*
     C           *IN99     IFEQ '1'
     C           TDCHTP    IFEQ 'A'
     C           TDCHTP    OREQ 'C'
     C                     MOVEL'A'       ##D,1
     C                     ELSE
     C           TDCHTP    IFEQ 'D'
     C                     MOVEL'C'       ##D,1
     C                     END
     C                     END
     C*                                                                   087497
     C*  If last change type is authorisation, access authorisation audit 087497
     C*  file to find whether trade has been amended or cancelled         087497
     C*                                                                   087497
     C           TDCHTP    IFEQ 'Y'                                       087497
     C           TDRF      SETGTTRAUTDF                                   087497
     C                     READPTRAUTDF                  99               087497
     C                     READPTRAUTDF                  99               087497
     C           TATYP     IFEQ 'AM'                                      087497
     C           TATYP     OREQ 'CH'                                      087497
     C                     MOVEL'A'       ##D,1                           087497
     C                     ELSE                                           087497
     C           TATYP     IFEQ 'DL'                                      087497
     C***********RECI      ANDEQ'C'                                 087497089204
     C***********TATYP     OREQ 'DL'                                087497089204
     C***********RECI      ANDEQ'*'                                 087497089204
     C                     MOVEL'C'       ##D,1                           087497
     C                     END                                            087497
     C                     END                                            087497
     C                     END                                            087497
     C                     END
      *
      ** Auto-transmission
     C                     EXSR SRDAUT
     C                     MOVEL##AUTO    ##D,2
      *
      ** Trade type
     C                     MOVELTDTP      ##D,3
      *
      ** Trade sub-type
     C                     MOVELTSUB      ##D,4
      *
      ** Trade incomplete indicator
     C                     MOVELTINC      ##D,5
      *
      ** Trade market indicator
     C                     MOVELTDMI      ##D,6
      *
      ** Trade capacity indicator
     C                     MOVELTCAP      ##D,7
      *
      ** Trade pay code
     C                     MOVELPCOD      ##D,8
      *
      ** AIBD/IPMA indicator
     C                     MOVELAIIP      ##D,9
      *
      ** Customer classification
     C                     MOVELBFCLAS    ##D,10
     C/COPY WNCPYSRC,CG4210C007
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOTHT    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  T@SECD                                         *
      * Function    :  Security Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           T@SECD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'T_SECD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\T_SECD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Security shortname
     C                     MOVELSESN      ##D,1
      *
      ** Processing type
     C                     MOVELPROT      ##D,2
      *
      ** Nominal currency
     C                     MOVELNMCY      ##D,3
      *
      ** Security investment type
     C                     MOVELSITP      ##D,4
      *
      ** Security descriptions
     C                     MOVE SFN1      ZSFN1
     C                     MOVE SFN2      ZSFN2
     C                     MOVE BVROSD    ZRSFD
     C                     EXSR ZSDESC
      *                                                                   087972
      * Place derived description always in line 3                        087972
      *                                                                   087972
     C                     SELEC                                          087972
     C           SFN1      WHNE *BLANKS                                   087972
     C           SFN2      ANDNE*BLANKS                                   087972
     C                     MOVELZFNM1     ##D,5
     C                     MOVELZFNM2     ##D,6
     C                     MOVELZFNM3     ##D,7
     C           SFN1      WHNE *BLANKS                                   087972
     C           SFN2      ANDEQ*BLANKS                                   087972
     C                     MOVELZFNM1     ##D,5                           087972
     C                     MOVELZFNM2     ##D,7                           087972
     C           SFN1      WHEQ *BLANKS                                   087972
     C           SFN2      ANDEQ*BLANKS                                   087972
     C                     MOVELZFNM1     ##D,7                           087972
     C                     ENDSL                                          087972
     C/COPY WNCPYSRC,CG4210C014
      *
      ** Next coupon date
     C                     MOVEL##NCD     ##D,8
      *
      ** Last coupon date
     C                     MOVEL##LCD     ##D,9
      *
      ** Coupon rate
     C                     MOVELCPNR      ##D,10
      *
      ** Security maturity date
     C                     MOVELMATY      ##D,11
      *
      ** Security initial date
     C                     MOVELITLD      ##D,12
      *
      ** Security issue date
     C                     MOVELISSD      ##D,13
      *                                                                   089693
      ** Security ISIN/COMMON Code                                        089693
     C                     MOVELISIN      ##D,14                          089693
      *                                                                                       214731
      ** Security Investment Name                                                             214731
     C                     MOVELINAM      ##D,15                                              214731
      *                                                                                       CRE073
      ** Interest Rate Rounding                                                               CRE073
      *                                                                                       CRE073
     C           CRE073    IFEQ 'Y'                                                           CRE073
     C           PROT      ANDEQ'3'                                                           CRE073
     C           CRE073    OREQ 'Y'                                                           CRE073
     C           PROT      ANDEQ'8'                                                           CRE073
      *                                                                                       CRE073
     C                     MOVELCNSP      ##D,16                                              CRE073
     C                     MOVELCNSG      ##D,17                                              CRE073
     C                     MOVELRDMT      ##D,18                                              CRE073
     C                     MOVELRDFD      ##D,19                                              CRE073
     C                     MOVELCRE073    ##D,20                                              CRE073
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
     C/COPY WNCPYSRC,CG4210C006
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXSECD    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  T@TRDD                                         *
      * Function    :  Trade Details                                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           T@TRDD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'T_TRDD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\T_TRDD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Run Date
     C                     MOVELBJRDNB    ##D,1
      *
      ** Trade Number
     C                     MOVELTDRF      ##D,2
      *
      ** Trade Date
     C                     MOVELTDDT      ##D,3
      *
      ** Value Date
     C                     MOVELTDVD      ##D,4
      *
      ** Trade nominal
     C/COPY WNCPYSRC,CG4210C002
     C                     MOVELNOML      ##D,5
     C                     MOVE NMDP      ##D,5
      *
      ** Price/Discount/Yield
     C                     MOVELTPDY      ##D,6
      *
      ***Broker*commission amount                                         086160
     C***********TBCA      IFNE *ZEROS                                    086160
     C***********          MOVELTBCA      ##D,7                           086160
     C***********          MOVE NOMCDP    ##D,7                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Customer commission amount                                       086160
     C***********TCCA      IFNE *ZEROS                                    086160
     C***********          MOVELTCCA      ##D,8                           086160
     C***********          MOVE NOMCDP    ##D,8                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 1                                    086160
     C***********TCA1      IFNE *ZEROS                                    086160
     C***********          MOVELTCC1      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,9                           086160
     C***********          MOVELTCA1      ##D,10                          086160
     C***********          MOVE NOMCDP    ##D,10                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 2                                    086160
     C***********TCA2      IFNE *ZEROS                                    086160
     C***********          MOVELTCC2      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,11                          086160
     C***********          MOVELTCA2      ##D,12                          086160
     C***********          MOVE NOMCDP    ##D,12                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 3                                    086160
     C***********TCA3      IFNE *ZEROS                                    086160
     C***********          MOVELTCC3      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,13                          086160
     C***********          MOVELTCA3      ##D,14                          086160
     C***********          MOVE NOMCDP    ##D,14                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 4                                    086160
     C***********TCA4      IFNE *ZEROS                                    086160
     C***********          MOVELTCC4      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,15                          086160
     C***********          MOVELTCA4      ##D,16                          086160
     C***********          MOVE NOMCDP    ##D,16                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 5                                    086160
     C***********TCA5      IFNE *ZEROS                                    086160
     C***********          MOVELTCC5      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,17                          086160
     C***********          MOVELTCA5      ##D,18                          086160
     C***********          MOVE NOMCDP    ##D,18                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Charge*narrative and amount 6                                    086160
     C***********TCA6      IFNE *ZEROS                                    086160
     C***********          MOVELTCC6      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,19                          086160
     C***********          MOVELTCA6      ##D,20                          086160
     C***********          MOVE NOMCDP    ##D,20                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ****Accumulate RDE's and associated data and output to              086160
      ****PF/CGUDTAPD.                                                    086160
     C***********          EXSR SRADTA                                    086160
     C***********          EXSR SRODTA                                    086160
      ***********                                                         086160
      ****Retrieve RDE information for RDEs in group set                  086160
      ***********                                                         086160
     C***********          MOVEL@STK,Q    ##GRPS                          086160
     C***********          Z-ADD21        ##RDEN                          086160
     C***********          EXSR SRRRDE                                    086160
      ***********                                                         086160
      ***Charge*narrative and amount 7                                    086160
     C***********TCA7      IFNE *ZEROS                                    086160
     C***********          MOVELTCC7      ##CCD                           086160
     C***********          EXSR SRCHCM                                    086160
     C***********          MOVELCHNR      ##D,1                           086160
     C***********          MOVELTCA7      ##D,2                           086160
     C***********          MOVE NOMCDP    ##D,2                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Realowance amount                                                086160
     C***********RALL      IFNE *ZEROS                                    086160
     C***********          MOVELRALL      ##D,3                           086160
     C***********          MOVE NOMCDP    ##D,3                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Tax*amount                                                       086160
     C***********TAXA      IFNE *ZEROS                                    086160
     C***********          MOVELTAXA      ##D,4                           086160
     C***********          MOVE NOMCDP    ##D,4                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Trade*consideration                                              086160
     C***********          MOVELTCSR      ##D,5                           086160
     C***********          MOVE NOMCDP    ##D,5                           086160
      ***********                                                         086160
      ***If*security is interest bearing                                  086160
      ***********                                                         086160
     C***********CD01      IFNE *ZEROS                                    086160
      ***********                                                         086160
      ***Accrued*indicator                                                086160
     C***********          MOVELACIN      ##D,6                           086160
      ***********                                                         086160
      **Calculate number of days accrued interest                         086160
     C***********ACIN      IFEQ 'C'                                       086160
     C***********          Z-ADD##LCD     ZSDATE           *last coupon dt086160
     C***********          Z-ADDTDVD      ZEDATE           *trade value dt086160
     C***********          ELSE                                           086160
     C***********          Z-ADDTDVD      ZSDATE           *trade value dt086160
     C***********          Z-ADD##NCD     ZEDATE           *next coupon dt086160
     C***********          ENDIF                                          086160
     C***********          EXSR ZDAYS                                     086160
     C***********          MOVELZDDAYS    ##D,7                           086160
     C***********          MOVE '0'       ##D,7                           086160
      ***********                                                         086160
      ***Purchased Interest amount.                                       086160
     C***********          MOVELITRA      ##D,8                           086160
     C***********          MOVE NOMCDP    ##D,8                           086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
     C***********DADJ      IFNE *ZEROS                                    086160
     C***********TINA      ORNE *ZEROS                                    086160
      ***********                                                         086160
      ***Trade*interest adjustment days                                   086160
     C***********          MOVELDADJ      ##D,9                           086160
     C***********          MOVE '0'       ##D,9                           086160
      ***********                                                         086160
      ***Interest adjustment amount                                       086160
     C***********          MOVELTINA      ##D,10                          086160
     C***********          MOVE NOMCDP    ##D,10                          086160
     C***********          ENDIF                                          086160
      ***********                                                         086160
      ***Countervalue                                                     086160
     C***********          MOVELTCTR      ##D,11                          086160
     C***********          MOVE NOMCDP    ##D,11                          086160
      ***********                                                         086160
      ***Exchange rate                                                    086160
     C***********          MOVELTDER      ##D,12                          086160
      ***********                                                         086160
      ***Settlement currency                                              086160
     C***********          MOVELSETC      ##D,13                          086160
      ***********                                                         086160
      ***Settlement amount                                                086160
      ***= outstanding value + value settled posted                       086160
      ***                    + value settled not posted                   086160
     C***********TOSV      ADD  TVSN      ##W150                          086160
     C***********          ADD  TVSP      ##W150                          086160
     C***********          MOVEL##W150    ##D,14                          086160
     C***********          MOVELSETC      ##CCY                           086160
     C***********          EXSR SRDCDT                                    086160
     C***********          MOVE A6NBDP    ##D,14                          086160
      *                                                                   086160
      ** Trade consideration                                              086160
     C                     MOVELTCSR      ##D,7                           086160
     C                     MOVE NOMCDP    ##D,7                           086160
      *                                                                   086160
      ** If security is interest bearing                                  086160
      *                                                                   086160
     C           CD01      IFNE *ZEROS                                    086160
      *                                                                   086160
      ** Accrued indicator                                                086160
     C                     MOVELACIN      ##D,8                           086160
      *                                                                   086160
      * Calculate number of days accrued interest                         086160
     C           ACIN      IFEQ 'C'                                       086160
     C                     Z-ADD##LCD     ZSDATE           *last coupon dt086160
     C                     Z-ADDTDVD      ZEDATE           *trade value dt086160
     C                     ELSE                                           086160
     C                     Z-ADDTDVD      ZSDATE           *trade value dt086160
     C                     Z-ADD##NCD     ZEDATE           *next coupon dt086160
     C                     ENDIF                                          086160
     C                     EXSR ZDAYS                                     086160
     C/COPY WNCPYSRC,CG4210C008
     C                     MOVELZDDAYS    ##D,9                           086160
     C/COPY WNCPYSRC,CG4210C009
     C                     MOVE '0'       ##D,9                           086160
      *                                                                   086160
      ** Purchased Interest amount.                                       086160
     C                     MOVELITRA      ##D,10                          086160
     C                     MOVE NOMCDP    ##D,10                          086160
     C                     ENDIF                                          086160
      *                                                                   086160
     C           DADJ      IFNE *ZEROS                                    086160
     C           TINA      ORNE *ZEROS                                    086160
      *                                                                   086160
      ** Trade interest adjustment days                                   086160
     C                     MOVELDADJ      ##D,11                          086160
     C                     MOVE '0'       ##D,11                          086160
      *                                                                   086160
      ** Interest adjustment amount                                       086160
     C                     MOVELTINA      ##D,12                          086160
     C                     MOVE NOMCDP    ##D,12                          086160
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Countervalue                                                     086160
     C                     MOVELTCTR      ##D,13                          086160
     C                     MOVE NOMCDP    ##D,13                          086160
      *                                                                   086160
      ** Exchange rate                                                    086160
     C                     MOVELTDER      ##D,14                          086160
      *                                                                   086160
      ** Settlement currency                                              086160
     C                     MOVELSETC      ##D,15                          086160
      *                                                                   086160
      ** Settlement amount                                                086160
      ** = outstanding value + value settled posted                       086160
      **                     + value settled not posted                   086160
     C           TOSV      ADD  TVSN      ##W150                          086160
     C                     ADD  TVSP      ##W150                          086160
     C                     MOVEL##W150    ##D,16                          086160
     C                     MOVELSETC      ##CCY                           086160
     C                     EXSR SRDCDT                                    086160
     C                     MOVE A6NBDP    ##D,16                          086160
     C                     MOVELA6NBDP    ##NBST                                              235291
     C/COPY WNCPYSRC,CG4210C015
      *                                                                   084868
      **  Trade Narrative                                                 084868
     C                     MOVELTDNR      ##D,17                          084868
      *                                                                                       214731
      **  Portfolio Reference                                                                 214731
     C                     MOVELPTFR      ##D,18                                              214731
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTRDD    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************   086160
     C/SPACE 5                                                            CEU014
      *****************************************************************   CEU014
      * Subroutine  :  T@EMU                                          *   CEU014
      * Function    :  Trade Details - EMU                            *   CEU014
      *                                                               *   CEU014
      * Called by   :  T01TRD                                         *   CEU014
      * Calls       :  T@EURO                                         *   CEU014
      *****************************************************************   CEU014
     C           T@EMU     BEGSR                                          CEU014
      *                                                                   CEU014
      **  Set up subroutine stack name                                    CEU014
     C                     ADD  1         Q                               CEU014
     C                     MOVEL'T_EMU '  @STK,Q                          CEU014
      *                                                                   CEU014
      *................................................................   CEU014
      *                                                                   CEU014
      **  Retrieve subroutine specific data.                              CEU014
     C           1         OCUR ##SRDT                                    CEU014
     C                     MOVEL##SPAT    S#PATH                          CEU014
      *                                                                   CEU014
      **  Set up Path.                                                    CEU014
     C                     MOVEL'\T_EMU ' ##PNAM                          CEU014
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU014
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU014
      **  Retrieve RDE information for RDEs in group set                  CEU014
      *                                                                   CEU014
     C                     MOVEL@STK,Q    ##GRPS                          CEU014
     C                     Z-ADD1         ##RDEN                          CEU014
     C                     EXSR SRRRDE                                    CEU014
     C*                                                                   CEU014
     C**  first determine the trade equivalent currency TEQCY             CEU014
     C*                                                                   CEU014
     C                     MOVE *BLANKS   TEQCY   3                       CEU014
     C                     MOVE NMCY      ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C           A6INCY    IFEQ 'Y'                                       CEU014
     C                     MOVE BKEURO    TEQCY                           CEU014
     C                     ENDIF                                          CEU014
     C           NMCY      IFEQ BKEURO                                    CEU014
     C                     MOVELTCNR      ##KEY1                          CEU014
     C*****                CALL 'AOCUSTR0'             99                              CEU014 226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD                          CEU014
     C                     PARM '*KEY   ' ##OPTN                          CEU014
     C                     PARM           ##KEY1                          CEU014
     C                     PARM *BLANKS   ##KYST                          CEU014
     C******     SDCUST    PARM SDCUST    DSSDY                                        CEU014 226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
     C*                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE                          CEU014
     C                     MOVELTCNR      W0KEY            ************   CEU014
     C                     Z-ADD25        W0ERNB           * DBERR 25 *   CEU014
     C                     MOVEL'MEM5004' W0MSGD           ************   CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C                     MOVE BBDINC    TEQCY                           CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C           TEQCY     IFNE *BLANKS                                   CEU014
     C*                                                                   CEU014
     C** Trade Countervalue in Trade Equivalent Currency                  CEU014
     C*                                                                   CEU014
     C                     MOVE TEQCY     ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADDTCTR      P@FRAM                          CEU014
     C                     MOVE NMCY      P@FRCY                          CEU014
     C                     MOVE TEQCY     P@TOCY                          CEU014
     C                     EXSR T@EURO                                    CEU014
     C                     MOVEL##OUTA    ##D,1                           CEU014
     C                     MOVE A6NBDP    ##D,1                           CEU014
     C*                                                                   CEU014
     C** Trade Equivalent Currency                                        CEU014
     C                     MOVELTEQCY     ##D,2                           CEU014
     C*                                                                   CEU014
     C** Trade Equivalent Currency Description                            CEU014
     C                     MOVELA6CYNM    ##D,3                           CEU014
     C*                                                                   CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C**  now determine the settlement equivalent currency SEQCY          CEU014
     C*                                                                   CEU014
     C                     MOVE *BLANKS   SEQCY   3                       CEU014
     C                     MOVE SETC      ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C           A6INCY    IFEQ 'Y'                                       CEU014
     C                     MOVE BKEURO    SEQCY                           CEU014
     C                     ENDIF                                          CEU014
     C           SETC      IFEQ BKEURO                                    CEU014
     C                     MOVELTCNR      ##KEY1                          CEU014
     C*****                CALL 'AOCUSTR0'             99                              CEU014 226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD                          CEU014
     C                     PARM '*KEY   ' ##OPTN                          CEU014
     C                     PARM           ##KEY1                          CEU014
     C                     PARM *BLANKS   ##KYST                           CEU014
     C******     SDCUST    PARM SDCUST    DSSDY                                        CEU014 226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
     C*                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE                          CEU014
     C                     MOVELTCNR      W0KEY            ************   CEU014
     C                     Z-ADD26        W0ERNB           * DBERR 26 *   CEU014
     C                     MOVEL'MEM5004' W0MSGD           ************   CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C                     MOVE BBDINC    SEQCY                           CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C           SEQCY     IFNE *BLANKS                                   CEU014
     C*                                                                   CEU014
     C** Settlement Amount in Settlement Equivalent Currency              CEU014
     C*                                                                   CEU014
     C                     MOVE SEQCY     ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADDTOSV      P@FRAM                          CEU014
     C                     ADD  TVSN      P@FRAM                          CEU014
     C                     ADD  TVSP      P@FRAM                          CEU014
     C                     MOVE SETC      P@FRCY                          CEU014
     C                     MOVE SEQCY     P@TOCY                          CEU014
     C                     EXSR T@EURO                                    CEU014
     C                     MOVEL##OUTA    ##D,4                           CEU014
     C                     MOVE A6NBDP    ##D,4                           CEU014
     C*                                                                   CEU014
     C** Settlement Equivalent Currency                                   CEU014
     C                     MOVELSEQCY     ##D,5                           CEU014
     C*                                                                   CEU014
     C** Settlement Equivalent Currency Description                       CEU014
     C                     MOVELA6CYNM    ##D,6                           CEU014
     C*                                                                   CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      **  Accumulate RDE's and associated data and output to              CEU014
      **  PF/CGUDTAPD.                                                    CEU014
     C                     EXSR SRADTA                                    CEU014
     C                     EXSR SRODTA                                    CEU014
      *                                                                   CEU014
      *................................................................   CEU014
      *                                                                   CEU014
     C           EXEMU     TAG                                            CEU014
      *                                                                   CEU014
      **  Unwind subroutine stack name                                    CEU014
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q                          CEU014
     C                     SUB  1         Q                               CEU014
      *                                                                   CEU014
     C                     ENDSR                                          CEU014
     C*****************************************************************   CEU014
     C/SPACE 5                                                            086160
      *****************************************************************   086160
      * Subroutine  :  T@TRDC                                         *   086160
      * Function    :  Trade Details - Charges                        *   086160
      *                                                               *   086160
      * Called by   :                                                 *   086160
      * Calls       :                                                 *   086160
      *****************************************************************   086160
     C           T@TRDC    BEGSR                                          086160
      *                                                                   086160
      **  Set up subroutine stack name                                    086160
     C                     ADD  1         Q                               086160
     C                     MOVEL'T_TRDC'  @STK,Q                          086160
      *                                                                   086160
      *................................................................   086160
      *                                                                   086160
      **  Retrieve subroutine specific data.                              086160
     C           1         OCUR ##SRDT                                    086160
     C                     MOVEL##SPAT    S#PATH                          086160
      *                                                                   086160
      **  Set up Path.                                                    086160
     C                     MOVEL'\T_TRDC' ##PNAM                          086160
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          086160
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   086160
      **  Retrieve RDE information for RDEs in group set                  086160
      *                                                                   086160
     C                     MOVEL@STK,Q    ##GRPS                          086160
     C                     Z-ADD1         ##RDEN                          086160
     C                     EXSR SRRRDE                                    086160
     C/COPY WNCPYSRC,CG4210C003
      *                                                                   086160
      ** Broker commission amount                                         086160
     C***********TBCA      IFNE *ZEROS                              086160087136
     C                     MOVELTBCA      ##D,1                           086160
     C                     MOVE NOMCDP    ##D,1                           086160
     C***********          ENDIF                                    086160087136
      *                                                                   086160
      ** Customer commission amount                                       086160
     C***********TCCA      IFNE *ZEROS                              086160087136
     C                     MOVELTCCA      ##D,2                           086160
     C                     MOVE NOMCDP    ##D,2                           086160
     C***********          ENDIF                                    086160087136
      *                                                                   086160
      ** Charge narrative and amount 1                                    086160
     C           TCA1      IFNE *ZEROS                                    086160
     C                     MOVELTCC1      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,3                           086160
     C                     MOVELTCA1      ##D,4                           086160
     C                     MOVE NOMCDP    ##D,4                           086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,3                           087136
     C                     MOVEL*ZEROS    ##D,4                           087136
     C                     MOVE NOMCDP    ##D,4                           087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 2                                    086160
     C           TCA2      IFNE *ZEROS                                    086160
     C                     MOVELTCC2      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,5                           086160
     C                     MOVELTCA2      ##D,6                           086160
     C                     MOVE NOMCDP    ##D,6                           086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,5                           087136
     C                     MOVEL*ZEROS    ##D,6                           087136
     C                     MOVE NOMCDP    ##D,6                           087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 3                                    086160
     C           TCA3      IFNE *ZEROS                                    086160
     C                     MOVELTCC3      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,7                           086160
     C                     MOVELTCA3      ##D,8                           086160
     C                     MOVE NOMCDP    ##D,8                           086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,7                           087136
     C                     MOVEL*ZEROS    ##D,8                           087136
     C                     MOVE NOMCDP    ##D,8                           087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 4                                    086160
     C           TCA4      IFNE *ZEROS                                    086160
     C                     MOVELTCC4      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,9                           086160
     C                     MOVELTCA4      ##D,10                          086160
     C                     MOVE NOMCDP    ##D,10                          086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,9                           087136
     C                     MOVEL*ZEROS    ##D,10                          087136
     C                     MOVE NOMCDP    ##D,10                          087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 5                                    086160
     C           TCA5      IFNE *ZEROS                                    086160
     C                     MOVELTCC5      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,11                          086160
     C                     MOVELTCA5      ##D,12                          086160
     C                     MOVE NOMCDP    ##D,12                          086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,11                          087136
     C                     MOVEL*ZEROS    ##D,12                          087136
     C                     MOVE NOMCDP    ##D,12                          087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 6                                    086160
     C           TCA6      IFNE *ZEROS                                    086160
     C                     MOVELTCC6      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,13                          086160
     C                     MOVELTCA6      ##D,14                          086160
     C                     MOVE NOMCDP    ##D,14                          086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,13                          087136
     C                     MOVEL*ZEROS    ##D,14                          087136
     C                     MOVE NOMCDP    ##D,14                          087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Charge narrative and amount 7                                    086160
     C           TCA7      IFNE *ZEROS                                    086160
     C                     MOVELTCC7      ##CCD                           086160
     C                     EXSR SRCHCM                                    086160
     C                     MOVELCHNR      ##D,15                          086160
     C                     MOVELTCA7      ##D,16                          086160
     C                     MOVE NOMCDP    ##D,16                          086160
     C                     ELSE                                           087136
     C                     MOVEL*BLANKS   ##D,15                          087136
     C                     MOVEL*ZEROS    ##D,16                          087136
     C                     MOVE NOMCDP    ##D,16                          087136
     C                     ENDIF                                          086160
      *                                                                   086160
      ** Realowance amount                                                086160
     C***********RALL      IFNE *ZEROS                              086160087136
     C***********          MOVELRALL      ##D,17                    086160087630
     C***********          MOVE NOMCDP    ##D,17                    086160087630
     C***********          ENDIF                                    086160087136
     C                     Z-ADDRALL      WDRAL1                          087630
     C***********          Z-ADD*ZEROS    ZRALL                    087630 089202
     C** Reallowance amount - If discount.                                087630
     C*                                                                   087630
     C           STBS      IFEQ 'D'                                       087630
     C           RALL      ANDNE0                                         087630
     C                     Z-ADDTDVD      ZSDATE                          087630
     C                     Z-ADDMATY      ZEDATE                          087630
     C                     EXSR ZDAYS                                     087630
     C                     Z-ADDZDDAYS    #DDAYS  50                      087630
     C                     EXSR ZDYYR                                     087630
      *                                                                   087630
     C           ZINTDD    IFNE 0                                         087630
     C           RALL      MULT #DDAYS    WPRICE 158                      087630
     C           WPRICE    DIV  ZINTDD    WDRALL 158H                     087630
      *                                                                   087630
     C           WDRALL    IFGE 0                                         087630
     C           1         SUB  WDRALL    WDRAL1 158                      087630
     C                     ELSE                                           087630
     C                     Z-SUBWDRALL    WDRALL                          087630
     C           1         SUB  WDRALL    WDRAL1                          087630
     C                     Z-SUBWDRAL1    WDRAL1                          087630
     C                     END                                            087630
     C                     ELSE                                           089202
     C                     Z-ADD*ZEROS    WDRAL1                          089202
     C                     END                                            087630
     C                     END                                            087630
      *                                                                   087630
     C***********          Z-ADD*ZEROS    ZRALL  150               087630 089202
     C***********          Z-ADD*ZEROS    ZRALL0 150               087630 089202
     C***********          Z-ADD*ZEROS    ZRALL1 151               087630 089202
     C***********          Z-ADD*ZEROS    ZRALL2 152               087630 089202
     C***********          Z-ADD*ZEROS    ZRALL3 153               087630 089202
      *                                                                   087630
      **  Calculate reallowance.                                          087630
     C                     Z-ADDNOMCDP    ZCDP                            089202
     C                     Z-ADDNOML      ZNOML                           089202
     C                     Z-ADDWDRAL1    ZPRC                            089202
     C                     EXSR ZCNSD                                     089202
     C                     MOVELZCONS     ##D,17                          089202
      *                                                                   087630
     C***********          SELEC                                   087630 089202
     C***********NOMCDP    WHEQ *ZERO                              087630 089202
     C***********NOML      MULT WDRAL1    ZRALL0    H              087630 089202
     C***********NOMCDP    WHEQ 1                                  087630 089202
     C***********NOML      MULT WDRAL1    ZRALL1    H              087630 089202
     C***********NOMCDP    WHEQ 2                                  087630 089202
     C***********NOML      MULT WDRAL1    ZRALL2    H              087630 089202
     C***********NOMCDP    WHEQ 3                                  087630 089202
     C***********NOML      MULT WDRAL1    ZRALL3    H              087630 089202
     C***********          ENDSL                                   087630 089202
      ***********                                                  087630 089202
      ***Price*basis*-*divide*by*100*******************************087630 089202
     C***********SPBS      IFEQ 'P'                                087630 089202
     C***********          SELEC                                   087630 089202
     C***********NOMCDP    WHEQ *ZERO                              087630 089202
     C***********          DIV  100       ZRALL0                   087630 089202
     C***********NOMCDP    WHEQ 1                                  087630 089202
     C***********          DIV  100       ZRALL1                   087630 089202
     C***********NOMCDP    WHEQ 2                                  087630 089202
     C***********          DIV  100       ZRALL2                   087630 089202
     C***********NOMCDP    WHEQ 3                                  087630 089202
     C***********          DIV  100       ZRALL3                   087630 089202
     C***********          ENDSL                                   087630 089202
     C***********          END                                     087630 089202
      ***********                                                  087630 089202
     C***********          SELEC                                   087630 089202
     C***********NOMCDP    WHEQ *ZERO                              087630 089202
     C***********          MOVE ZRALL0    ZRALL                    087630 089202
     C***********NOMCDP    WHEQ 1                                  087630 089202
     C***********          MOVE ZRALL1    ZRALL                    087630 089202
     C***********NOMCDP    WHEQ 2                                  087630 089202
     C***********          MOVE ZRALL2    ZRALL                    087630 089202
     C***********NOMCDP    WHEQ 3                                  087630 089202
     C***********          MOVE ZRALL3    ZRALL                    087630 089202
     C***********          ENDSL                                   087630 089202
      ***********                                                  087630 089202
     C***********          MOVELZRALL     ##D,17                   087630 089202
     C                     MOVE NOMCDP    ##D,17                          087630
      *                                                                   086160
      ** Tax amount                                                       086160
     C***********TAXA      IFNE *ZEROS                              086160087136
     C                     MOVELTAXA      ##D,18                          086160
     C                     MOVE NOMCDP    ##D,18                          086160
     C***********          ENDIF                                    086160087136
      *                                                                   CSE023
      ** If CSE023 if installed, write the withholding tax amount         CSE023
      *                                                                   CSE023
     C           CSE023    IFEQ 'Y'                                       CSE023
     C                     MOVELWHTX      ##D,19                          CSE023
     C                     MOVE NOMCDP    ##D,19                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CGL031
      ** Extract EU witholding tax amount in nominal currency                                 CGL031
      ** when CGL031 feature is on                                                            CGL031
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
      *                                                                                       CGL031
     C**********           Z-ADD*ZEROS    ##TAXA 130                                   CGL031 234770
      *****************************************************************                CGL031 234770
     C********** KSCIN     KLIST                                                       CGL031 234770
     C**********           KFLD           BJRDNB                                       CGL031 234770
     C**********           KFLD           KMODI   1                                    CGL031 234770
     C**********           KFLD           KTDRF   60                                   CGL031 234770
      *****************************************************************                CGL031 234770
     C**********           MOVE 'S'       KMODI                                        CGL031 234770
     C**********           MOVE TDRF      KTDRF                                        CGL031 234770
     C********** KSCIN     CHAINSDCSINL6             98                                CGL031 234770
     C********** *IN98     DOWEQ*OFF                                                   CGL031 234770
     C********** TSSTAT    IFEQ 'T'                                                    CGL031 234770
     C**********           ADD  TSTXSR    ##TAXA                                       CGL031 234770
     C**********           ENDIF                                                       CGL031 234770
     C********** KSCIN     READESDCSINL6                 98                            CGL031 234770
     C**********           ENDDO                                                       CGL031 234770
      *****************************************************************                CGL031 234770
     C**********           MOVEL##TAXA    ##D,20                                       CGL031 235291
     C                     MOVELEUTS      ##D,20                                              235291
     C**********           MOVE NOMCDP    ##D,20                                       CGL031 235291
     C                     MOVE ##NBST    ##D,20                                              235291
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     EXSR SRADTA                                                        234770
     C                     MOVEL##SDS     ##ADS                                               234770
      *                                                                                       234770
      **  Retrieve RDE information for RDEs in group set                                      234770
      *                                                                                       234770
     C                     Z-ADD21        ##RDEN                                              234770
     C                     EXSR SRRRDE                                                        234770
      *                                                                                       234770
     C                     MOVELBJLCCY    ##D,1                                               234770
      *                                                                                       234770
     C                     MOVELTBCR      ##D,2                                               234770
     C                     MOVE 8         ##D,2                                               234770
      *                                                                                       234770
     C                     MOVELBJLCCY    ##CCY                                               234770
     C                     EXSR SRDCDT                                                        234770
     C**********           Z-ADDTBCR      ZAMTCI                                       234770 235557
     C                     Z-ADDEUTS      ZAMTCI                                              235557
     C                     Z-ADDTBCR      ZEXCH                                               234770
     C                     MOVE NOMCDP    ZCDPI                                               234770
     C                     Z-ADDA6NBDP    ZCDPO                                               234770
     C                     EXSR ZCONVN                                                        234770
     C                     MOVELZAMTCO    ##D,3                                               234770
     C                     MOVE A6NBDP    ##D,3                                               234770
      *                                                                                       234770
      ** If CER049 is switched on, extract Stamp Tax details                                  CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
      *                                                                                       CER049
      **  Set Trade Reference key                                                             CER049
      *                                                                                       CER049
     C                     MOVELTDRF      K1TDRF  6                                           CER049
      *                                                                                       CER049
      ** Retrieve the Stamp Tax record for the Trade                                          CER049
      *                                                                                       CER049
     C           K1TDRF    CHAINTRADSQL0             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELTQTAX     ##D,4                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELTQSTAF    ##D,5                                               CER049
      *                                                                                       CER049
      ** Retrieve stamp tax currency for the correct decimal places                           CER049
      *                                                                                       CER049
     C                     CALL 'SD008141'                                                    CER049
     C                     PARM TQCDTE    U#DATE  50                                          CER049
     C                     PARM 'SECURITY'U#ORGN 10                                           CER049
     C                     PARM *BLANKS   ##TYPE  4                                           CER049
     C                     PARM           U#CTAX 138                                          CER049
     C                     PARM           U#MTAX 138                                          CER049
     C                     PARM           U#CCCY  3                                           CER049
     C                     PARM           U#MCCY  3                                           CER049
     C                     PARM           U#CSCC  2                                           CER049
     C                     PARM           U#MSCC  2                                           CER049
     C                     PARM           U#TXTY  1                                           CER049
     C                     PARM           SDSTPD                                              CER049
      *                                                                                       CER049
      ** If there is a default for the Module use this tax rate and ccy                       CER049
      ** otherwise use the ICD Control defaults.                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C                     MOVE U#MCCY    U#SCCY  3                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE U#CCCY    U#SCCY                                              CER049
     C                     ENDIF                                                              CER049
     C                     MOVELU#SCCY    ##CCY                                               CER049
     C                     EXSR SRDCDT                                                        CER049
     C                     MOVE A6NBDP    ##D,5                                               CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C/COPY WNCPYSRC,CG4210COM1                                           086865
      *                                                                   086160
      **  Accumulate RDE's and associated data and output to              086160
      **  PF/CGUDTAPD.                                                    086160
     C                     EXSR SRADTA                                    086160
     C           ##SDS     CAT  ##ADS:0   ##SDS                                               234770
      *                                                                                       234770
      **  Initialise Write Format Parameter.                                                  234770
     C                     CLEARW0FMT                                                         234770
      *                                                                                       234770
      **  Set up Control Information.                                                         234770
     C                     Z-ADD##ITEM    DEITEM                                              234770
     C                     ADD  1         ##OSEQ                                              234770
     C                     Z-ADD##OSEQ    DEOSEQ                                              234770
     C                     Z-ADD1         DEPBIN                                              234770
     C                     Z-ADD1         DETBIN                                              234770
     C                     MOVE 'FR'      DEFSLI                                              234770
     C                     MOVE *BLANKS   W0PATH                                              234770
     C                     MOVELS#PATH    W0PATH                                              234770
      *                                                                                       234770
      **  Append Data from pack routine.                                                      234770
     C           W0FMT     CAT  ##SDS:0   W0FMT                                               234770
     C                     EXSR SRODTA                                    086160
      *                                                                   086160
      *................................................................   086160
      *                                                                   086160
     C           EXTRDC    TAG                                            086160
      *                                                                   086160
      **  Unwind subroutine stack name                                    086160
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q                          086160
     C                     SUB  1         Q                               086160
      *                                                                   086160
     C                     ENDSR                                          086160
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  T@TRDS                                         *
      * Function    :  Trade Settlement Instructions                  *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           T@TRDS    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'T_TRDS'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\T_TRDS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** DETERMINE SETTLEMENT INSTRUCTION FIELDS
      *
     C           TDTP      IFEQ 'TP'
     C                     MOVEL'P'       ##PYRC
     C                     ELSE
     C                     MOVEL'R'       ##PYRC
     C                     ENDIF
     C                     MOVELSETC      ##CCY
     C                     MOVELSMTH      ##SETP
     C           TDTP      IFEQ 'TP'                        B1
     C                     MOVELPYFA      ##STBR
     C                     MOVELPYFM      ##OURN
     C                     MOVELPAYT      ##THRN
     C                     ELSE                            X1
     C                     MOVELPYTA      ##STBR
     C                     MOVELPAYT      ##OURN
     C                     MOVELPYFM      ##THRN
     C                     ENDIF                           E1
     C                     MOVELTDFA      ##FACO
     C                     MOVELTCNR      ##CNTP
      *
     C                     EXSR SRDSET
      *
      ** Our A/C - Line 1
     C                     MOVEL##OAC1    ##D,1
      *
      ** Our A/C - Line 2
     C                     MOVEL##OAC2    ##D,2
      *
      ** Our nostro name
     C                     MOVEL##ONN     ##D,3
      *
      ** Our nostro town
     C                     MOVEL##ONT     ##D,4
      *
      ** Our A/C (General ledger)
     C                     MOVEL##OGA     ##D,5
      *
      ** Our A/C Retail
     C                     MOVEL##ORA     ##D,6
      *
      ** Their A/C line 1
     C                     MOVEL##TAC1    ##D,7
      *
      ** Their A/C line 2
     C                     MOVEL##TAC2    ##D,8
      *
      ** Their nostro name
     C                     MOVEL##TNN     ##D,9
      *
      ** Their nostro town
     C                     MOVEL##TNT     ##D,10
      *
      ** For account of line 1
     C                     MOVEL##FAL1    ##D,11
      *
      ** For account of line 2
     C                     MOVEL##FAL2    ##D,12
      *
      ** For A/C of name
     C                     MOVEL##FAN     ##D,13
      *
      ** For A/C of town
     C                     MOVEL##FAT     ##D,14
      *
      ** Our Depot Name and Our Depot Town
      *
     C                     MOVEL*BLANK    ##KEY1
     C           TDTP      IFEQ 'TP'
     C********** DELT      ANDNE*ZEROS                                                        CSD027
     C           DELT      ANDNE*BLANKS                                                       CSD027
     C                     MOVELDELT      ##KEY1
     C                     ELSE
     C           TDTP      IFEQ 'TS'
     C********** DELF      ANDNE*ZEROS                                                        CSD027
     C           DELF      ANDNE*BLANKS                                                       CSD027
     C                     MOVELDELF      ##KEY1
     C                     END
     C                     END
      *
     C           ##KEY1    IFNE *BLANK
     C*****                CALL 'AOCUSTR0'             99                                     226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C******     SDCUST    PARM SDCUST    DSSDY                                               226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVEL##KEY1    W0KEY            ***************
     C                     Z-ADD5         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCRNM    ##D,15
     C                     MOVELBBCRTN    ##D,16
     C                     EXSR SESETL                                    133423
     C                     MOVELLIN30D    ##D,17                          133423
     C                     MOVELLIN33D    ##D,20                          133423
      *
     C                     END
      *                                                                   166911
      ** Extract Euroclear/Cedel code                                     166911
      *                                                                   166911
     C           S01401    IFEQ 'Y'                                       166911
     C           TDRF      CHAINTRADSDY1             99                   166911
     C           *IN99     IFEQ '0'                                       166911
     C                     MOVELT1EUCL    ##D,17                          166911
     C                     ENDIF                                          166911
     C                     ENDIF                                          166911
      *
     C/COPY WNCPYSRC,CG4210C010
      ** Their depot Name and Their Depot Town
      *
     C                     MOVEL*BLANK    ##KEY1
     C           TDTP      IFEQ 'TP'
     C********** DELF      ANDNE*ZEROS                                                        CSD027
     C           DELF      ANDNE*BLANKS                                                       CSD027
     C                     MOVELDELF      ##KEY1
     C                     ELSE
     C           TDTP      IFEQ 'TS'
     C********** DELT      ANDNE*ZEROS                                                        CSD027
     C           DELT      ANDNE*BLANKS                                                       CSD027
     C                     MOVELDELT      ##KEY1
     C                     END
     C                     END
      *
     C           ##KEY1    IFNE *BLANK
     C*****                CALL 'AOCUSTR0'             99                                     226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C******     SDCUST    PARM SDCUST    DSSDY                                               226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVEL##KEY1    W0KEY            ***************
     C                     Z-ADD6         W0ERNB           * DB ERROR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCRNM    ##D,18
     C                     MOVELBBCRTN    ##D,19
      *
     C                     END
      *                                                                   166911
      ** Extract Safe keeping Account Code                                166911
      *                                                                   166911
     C           S01401    IFEQ 'Y'                                       166911
     C           *IN99     ANDEQ'0'                                       166911
     C                     MOVELT1SAFA    ##D,20                          166911
     C                     ENDIF                                          166911
      *
      ****Accumulate RDE's and associated data and output to              087328
      ****PF/CGUDTAPD.                                                    087328
     C                     EXSR SRADTA
     C***********          EXSR SRODTA                                    087328
     C                     MOVEL##SDS     ##ADS                           087328
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C***********          MOVEL@STK,Q    ##GRPS                          087328
     C                     Z-ADD21        ##RDEN
     C                     EXSR SRRRDE
      *
      ** Their Depot For A/C Of Name and Town
      ** (either 'deliver from' or 'deliver to' according to trade type)
      *
     C           DFFA      IFNE *BLANKS
     C           DTFA      ORNE *BLANKS
      *
     C                     MOVEL*BLANK    ##KEY1
     C           DFFA      IFNE *BLANKS
     C                     MOVELDFFA      ##KEY1
     C                     ELSE
     C                     MOVELDTFA      ##KEY1
     C                     END
      *
     C*****                CALL 'AOCUSTR0'             99                                     226938
     C                     CALL 'AOCUSTR1'             99                                     226938
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1
     C                     PARM *BLANKS   ##KYST
     C******     SDCUST    PARM SDCUST    DSSDY                                               226938
     C           SDCUST    PARM SDCUST    DSLDY                                               226938
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           BBCLST    ANDNE'Y'                                                           226938
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVEL##KEY1    W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVELBBCRNM    ##D,1
     C                     MOVELBBCRTN    ##D,2
      *
     C                     END
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C           ##SDS     CAT  ##ADS:0   ##SDS                           087328
      *                                                                   087328
      **  Initialise Write Format Parameter.                              087328
     C                     CLEARW0FMT                                     087328
      *                                                                   087328
      **  Set up Control Information.                                     087328
     C                     Z-ADD##ITEM    DEITEM                          087328
     C                     ADD  1         ##OSEQ                          087328
     C                     Z-ADD##OSEQ    DEOSEQ                          087328
     C                     Z-ADD1         DEPBIN                          087328
     C                     Z-ADD1         DETBIN                          087328
     C                     MOVE 'FR'      DEFSLI                          087328
     C                     MOVE *BLANKS   W0PATH                          087328
     C                     MOVELS#PATH    W0PATH                          087328
      *                                                                   087328
      **  Append Data from pack routine.                                  087328
     C           W0FMT     CAT  ##SDS:0   W0FMT                           087328
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTRDS    TAG
      *
      **  Unwind subroutine stack name
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************   133423
     C/SPACE 5                                                            133423
      *****************************************************************   133423
      * Subroutine  :      SESETL                                     *   133423
      * Function    :      Get the Depot references.                  *   133423
      *                                                               *   133423
      * Called by   :      T@TRDS                                     *   133423
      *****************************************************************   133423
     C           SESETL    BEGSR                                          133423
      *                                                                   133423
     C                     MOVE *BLANKS   @DISC   1                       133423
      *                                                                   133423
     C*                                                                   133423
     C** CALL ACCESS PROGRAM FOR SECURITIES TRADING DATA DETAILS          133423
     C*                                                                   133423
     C                     CALL 'AOSTRDR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*FIRST  '##OPTN                          133423
     C           SDSTRD    PARM SDSTRD    DSFDY                           133423
     C*                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C                     MOVEL'AOSTRDR0'W0FILE                          133423
     C                     MOVEL'*CALL'   W0KEY            ***************133423
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *133423
     C                     MOVEL'MEM5003' W0MSGD           ***************133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
      *                                                                   133423
     C                     MOVE BVDR1     @DR1                            133423
     C                     MOVE BVDR2     @DR2                            133423
     C                     MOVE BVDR3     @DR3                            133423
     C                     MOVE BVDR4     @DR4                            133423
     C                     MOVE BVDR5     @DR5                            133423
     C                     MOVE BVDR6     @DR6                            133423
     C                     MOVE BVDR7     @DR7                            133423
     C                     MOVE BVDR8     @DR8                            133423
     C                     MOVE BVDR9     @DR9                            133423
     C                     MOVE BVDR10    @DR10                           133423
      *                                                                   133423
     C********** TCNR      IFNE *ZEROS                                                 133423 CSD027
     C           TCNR      IFNE *BLANKS                                                       CSD027
     C                     MOVE TCNR      ##CUS1  6                       133423
      *                                                                   133423
      ** Get the Classification.                                          133423
      *                                                                   133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 26 *133423
     C                     Z-ADD26        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
      *                                                                   133423
     C                     MOVE BFCLAS    @DISC                           133423
     C                     MOVE BFDRF1    @DRF1                           133423
     C                     MOVE BFDRF2    @DRF2                           133423
     C                     MOVE BFDRF3    @DRF3                           133423
     C                     MOVE BFDRF4    @DRF4                           133423
     C                     MOVE BFDRF5    @DRF5                           133423
     C                     MOVE BFDRF6    @DRF6                           133423
     C                     MOVE BFDRF7    @DRF7                           133423
     C                     MOVE BFDRF8    @DRF8                           133423
     C                     MOVE BFDRF9    @DRF9                           133423
     C                     MOVE BFDRF0    @DRF0                           133423
     C                     END                                            133423
      *                                                                   133423
     C           TDTP      IFEQ 'TP'                                      133423
      *                                                                   133423
     C*  DO NOT PROCESS NAMES AND TOWNS 2 AND 4, LITERAL 5 AND            133423
     C*  REFERENCE FOR DISCRETIONARY CUSTOMERS AND GREY MARKET TRADES     133423
     C*                                                                   133423
     C           @DISC     IFNE 'D'                                       133423
     C           @DISC     ANDNE'S'                                       133423
     C           TDMI      ANDNE'G'                                       133423
      *                                                                   133423
     C********** DELF      IFNE 0                                         133423       133423 CSD027
     C           DELF      IFNE *BLANKS                                                       CSD027
     C                     MOVE DELF      ##CUS1                          133423
      *                                                                   133423
      ** Get the Classification.                                          133423
      *                                                                   133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 27 *133423
     C                     Z-ADD27        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C                     MOVE BFCLAS    DEPTYP  1                       133423
     C                     ELSE                                           133423
     C                     MOVE ' '       DEPTYP                          133423
     C                     END                                            133423
     C*                                                                   133423
     C*  REFERENCE 2, Use Deliver From For A/C Of if entered              133423
     C*                                                                   133423
     C           DFFA      IFNE *BLANKS                                   133423
     C                     MOVELDFFA      ##CUS1                          133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 28 *133423
     C                     Z-ADD28        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C*                                                                   133423
     C                     ELSE                                           133423
     C*                                                                   133423
     C** REFERENCE 2, CHAIN TO THE SE FILE USING COUNTERPARTY NUMBER      133423
     C*                                                                   133423
     C********** TCNR      IFNE *ZEROS                                                 133423 CSD027
     C           TCNR      IFNE *BLANKS                                                       CSD027
     C                     MOVE TCNR      ##CUS1                          133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 29 *133423
     C                     Z-ADD29        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C                     END                                            133423
     C                     END                                            133423
     C*                                                                   133423
     C**If*the*Deliver*From*is*a*Euroclear,*Cedel,*or*Kassenverein*depot**133423              CSE022
     C* If the Deliver From is a Euroclear orCedel,                                           CSE022
     C* the depot reference is in a fixed position                        133423
     C*                                                                   133423
     C           DEPTYP    IFEQ 'E'                                       133423
     C                     Z-ADD1         A                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C           DEPTYP    IFEQ 'C'                                       133423
     C                     Z-ADD2         A                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C***********DEPTYP    IFEQ 'K'                                       133423              CSE022
     C***********          Z-ADD3         A                               133423              CSE022
     C***********          SETON                     29                   133423              CSE022
     C***********          ELSE                                           133423              CSE022
     C*                                                                   133423
     C*  USE THE DELIVER FROM FIELD TO CHECK THAT THERE IS AN EQUIVALENT  133423
     C*  DEPOT REF. ON TABTB36, IF SO AND DISCRETIONARY IND = M, MOVE THE 133423
     C*  CORRESPONDING DEPOT. REF. FROM CLINTSE TO OUPUT FIELD            133423
     C*                                                                   133423
     C** NOTE ** ON A TRADE PURCHASE DELIVER FROM THE COUNTERPARTY AND    133423
     C*          DELIVER TO THE USER                                      133423
     C*                                                                   133423
     C                     MOVE DELF      DELFA   6                       133423
     C                     Z-ADD1         A                               133423
     C           DELFA     LOKUPARR36,A                  29               133423
     C***********          END                                            133423              CSE022
     C                     END                                            133423
     C                     END                                            133423
      *                                                                                       CSE022
     C           CSE022    IFEQ 'N'                                                           CSE022
      *                                                                                       CSE022
     C           BFCLAS    IFEQ 'M'                                       133423
     C           *IN29     ANDEQ'1'                                       133423
     C           ARRSE,A   ANDNE*BLANKS                                   133423
     C           TDMI      ANDNE'G'                                       133423
     C                     MOVEAARRSE,A   LIN30D  6                       133423
     C                     END                                            133423
      *                                                                                       CSE022
     C                     ELSE                                                               CSE022
      *                                                                                       CSE022
     C                     MOVEL'SEDOR'   WPGM    9                                           CSE022
     C                     MOVE 'FRTV'    WPGM                                                CSE022
     C                     MOVELDELFA     PDEPOT                                              CSE022
     C                     MOVELTCNR      PCNUM                                               CSE022
      *                                                                                       CSE022
     C                     CALL WPGM                                                          CSE022
     C                     PARM *BLANKS   PRETCD 10                                           CSE022
     C                     PARM           PDEPOT  6                                           CSE022
     C                     PARM           PCNUM   6                                           CSE022
     C                     PARM *BLANKS   PSKALR 20                                           CSE022
      *                                                                                       CSE022
     C                     MOVELPSKALR    LIN30D                                              CSE022
      *                                                                                       CSE022
     C                     ENDIF                                                              CSE022
     C*                                                                   133423
     C*  CHAIN TO THE SE FILE USING THE DELIVER TO FIELD                  133423
     C*  THIS WILL FILL THE ELEMENTS OF ARRAY FOR LATER USE               133423
     C*                                                                   133423
     C********** DELT      IFNE *ZEROS                                                 133423 CSD027
     C           DELT      IFNE *BLANKS                                                       CSD027
     C                     MOVE DELT      ##CUS1                          133423
      *                                                                   133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 30 *133423
     C                     Z-ADD30        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
      *                                                                   133423
     C                     MOVE BFCLAS    @DISC                           133423
     C                     MOVE BFDRF1    @DRF1                           133423
     C                     MOVE BFDRF2    @DRF2                           133423
     C                     MOVE BFDRF3    @DRF3                           133423
     C                     MOVE BFDRF4    @DRF4                           133423
     C                     MOVE BFDRF5    @DRF5                           133423
     C                     MOVE BFDRF6    @DRF6                           133423
     C                     MOVE BFDRF7    @DRF7                           133423
     C                     MOVE BFDRF8    @DRF8                           133423
     C                     MOVE BFDRF9    @DRF9                           133423
     C                     MOVE BFDRF0    @DRF0                           133423
     C*                                                                   133423
     C                     END                                            133423
     C*                                                                   133423
     C**If*the*Deliver*From*is*a*Euroclear,*Cedel,*or*Kassenverein*depot* 133423              CSE022
     C* If the Deliver From is a Euroclear or Cedel,                                          CSE022
     C* the depot reference is in a fixed position                        133423
     C*                                                                   133423
     C           BFCLAS    IFEQ 'E'                                       133423
     C                     Z-ADD1         A                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C           BFCLAS    IFEQ 'C'                                       133423
     C                     Z-ADD2         A                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C***********BFCLAS    IFEQ 'K'                                       133423              CSE022
     C***********          Z-ADD3         A                               133423              CSE022
     C***********          SETON                     29                   133423              CSE022
     C***********          ELSE                                           133423              CSE022
     C*                                                                   133423
     C*  USE THE DELIVER TO   FIELD TO CHECK THAT THERE IS AN EQUIVALENT  133423
     C*  DEPOT REF. ON TABTB36, IF SO AND DISCRETIONARY IND = M, MOVE THE 133423
     C*  CORRESPONDING DEPOT. REF. FROM CLINTSE TO OUPUT FIELD            133423
     C*                                                                   133423
     C                     MOVE DELT      DELTA   6                       133423
     C                     Z-ADD1         A                               133423
     C           DELTA     LOKUPARR36,A                  29               133423
     C***********          END                                            133423              CSE022
     C                     END                                            133423
     C                     END                                            133423
      *                                                                                       CSE022
     C           CSE022    IFEQ 'N'                                                           CSE022
      *                                                                                       CSE022
     C           *IN29     IFEQ '1'                                       133423
     C           TDMI      ANDNE'G'                                       133423
     C                     MOVEAARRSE,A   LIN33D  6                       133423
     C                     END                                            133423
      *                                                                                       CSE022
     C                     ELSE                                                               CSE022
      *                                                                                       CSE022
     C                     MOVEL'SEDOR'   WPGM    9                                           CSE022
     C                     MOVE 'FRTV'    WPGM                                                CSE022
     C                     MOVELDELTA     PDEPOT                                              CSE022
     C                     MOVELTCNR      PCNUM                                               CSE022
      *                                                                                       CSE022
     C                     CALL WPGM                                                          CSE022
     C                     PARM *BLANKS   PRETCD 10                                           CSE022
     C                     PARM           PDEPOT  6                                           CSE022
     C                     PARM           PCNUM   6                                           CSE022
     C                     PARM *BLANKS   PSKALR 20                                           CSE022
      *                                                                                       CSE022
     C                     MOVELPSKALR    LIN33D                                              CSE022
      *                                                                                       CSE022
     C                     ENDIF                                                              CSE022
      *                                                                                       CSE022
     C                     END                                            133423
     C                     END                                            133423
     C*                                                                   133423
     C*  IF THE TRADE TYPE FIELD IS = TS, EXECUTE THE FOLLOWING PIECE OF  133423
     C*  CODE. ALL LITERALS THAT ARE OUTPUT ARE PLACED IN CORRESPONDING   133423
     C*  LINE NUMBER ASSOCIATED WITH THE PRINT OUTAND WHAT IS ON THE SPEC.133423
     C*                                                                   133423
     C           TDTP      IFEQ 'TS'                                      133423
     C*                                                                   133423
     C*  DO NOT PROCESS NAMES AND TOWNS 2 AND 4, LITERAL 5 AND            133423
     C*  REFERENCE FOR DISCRETIONARY CUSTOMERS OR GREY MARKET TRADES      133423
     C*                                                                   133423
     C           @DISC     IFNE 'D'                                       133423
     C           @DISC     ANDNE'S'                                       133423
     C           TDMI      ANDNE'G'                                       133423
      *                                                                   133423
     C********** DELT      IFNE 0                                                      133423 CSD027
     C           DELT      IFNE *BLANKS                                                       CSD027
     C                     MOVE DELT      ##CUS1                          133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 31 *133423
     C                     Z-ADD31        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C                     MOVE BFCLAS    DEPTYP  1                       133423
     C                     ELSE                                           133423
     C                     MOVE ' '       DEPTYP                          133423
     C                     END                                            133423
     C*                                                                   133423
     C*  REFERENCE 2, Use Deliver To For A/C Of if entered                133423
     C*                                                                   133423
     C           DTFA      IFNE *BLANKS                                   133423
     C                     MOVELDTFA      ##CUS1                          133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 32 *133423
     C                     Z-ADD32        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C*                                                                   133423
     C                     ELSE                                           133423
     C*                                                                   133423
     C*  REFERENCE 2, CHAIN TO THE SE FILE USING COUNTERPARTY NUMBER      133423
     C*                                                                   133423
     C********** TCNR      IFNE *ZEROS                                                 133423 CSD027
     C           TCNR      IFNE *BLANKS                                                       CSD027
     C                     MOVE TCNR      ##CUS1                          133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 33 *133423
     C                     Z-ADD33        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
     C                     END                                            133423
     C                     END                                            133423
     C**If*the*Deliver*To*is*a*Euroclear,*Cedel,*or*Kassenverein*depot4*  133423              CSE022
     C* If the Deliver To is a Euroclear or Cedel,                                            CSE022
     C* the depot reference is in a fixed position                        133423
     C*                                                                   133423
     C           DEPTYP    IFEQ 'E'                                       133423
     C                     Z-ADD1         V                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C           DEPTYP    IFEQ 'C'                                       133423
     C                     Z-ADD2         V                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C***********DEPTYP    IFEQ 'K'                                       133423              CSE022
     C***********          Z-ADD3         V                               133423              CSE022
     C***********          SETON                     29                   133423              CSE022
     C***********          ELSE                                           133423              CSE022
     C*                                                                   133423
     C*  USE THE DELIVER TO   FIELD TO CHECK THAT THERE IS AN EQUIVALENT  133423
     C*  DEPOT REF. ON TABTB36, IF SO AND DISCRETIONARY IND = M, MOVE THE 133423
     C*  CORRESPONDING DEPOT. REF. FROM CLINTSE TO OUPUT FIELD            133423
     C*                                                                   133423
     C                     MOVE DELT      DELTA   6                       133423
     C                     Z-ADD1         V                               133423
     C           DELTA     LOKUPARR36,V                  29               133423
     C***********          END                                            133423              CSE022
     C                     END                                            133423
     C                     END                                            133423
      *                                                                                       CSE022
     C           CSE022    IFEQ 'N'                                                           CSE022
      *                                                                                       CSE022
     C           BFCLAS    IFEQ 'M'                                       133423
     C           *IN29     ANDEQ'1'                                       133423
     C           TDMI      ANDNE'G'                                       133423
     C                     MOVEAARRSE,V   LIN30D  6                       133423
     C                     END                                            133423
      *                                                                                       CSE022
     C                     ELSE                                                               CSE022
      *                                                                                       CSE022
     C                     MOVEL'SEDOR'   WPGM    9                                           CSE022
     C                     MOVE 'FRTV'    WPGM                                                CSE022
     C                     MOVELDELTA     PDEPOT                                              CSE022
     C                     MOVELTCNR      PCNUM                                               CSE022
      *                                                                                       CSE022
     C                     CALL WPGM                                                          CSE022
     C                     PARM *BLANKS   PRETCD 10                                           CSE022
     C                     PARM           PDEPOT  6                                           CSE022
     C                     PARM           PCNUM   6                                           CSE022
     C                     PARM *BLANKS   PSKALR 20                                           CSE022
      *                                                                                       CSE022
     C                     MOVELPSKALR    LIN30D                                              CSE022
      *                                                                                       CSE022
     C                     ENDIF                                                              CSE022
      *                                                                                       CSE022
     C*                                                                   133423
     C*  CHAIN TO THE SE FILE USING THE DELIVER FROM FIELD                133423
     C*  THIS WILL FILL THE ELEMENTS OF ARRAY ARRSE FOR LATER USE         133423
     C*                                                                   133423
     C********** DELF      IFNE *ZEROS                                                 133423 CSD027
     C           DELF      IFNE *BLANKS                                                       CSD027
     C                     MOVE DELF      ##CUS1                          133423
      *                                                                   133423
     C                     CALL 'AOSECSR0'                                133423
     C                     PARM *BLANKS   ##RTCD                          133423
     C                     PARM '*KEY    '##OPTN                          133423
     C                     PARM           ##CUS1                          133423
     C           SDSECS    PARM SDSECS    DSSDY                           133423
      *                                                                   133423
      ** DATABASE ERROR                                                   133423
      *                                                                   133423
     C           ##RTCD    IFNE *BLANK                                    133423
     C                     MOVEL'SDSECSPD'W0FILE           ***************133423
     C                     MOVEL##CUS1    W0KEY            * DB ERROR 34 *133423
     C                     Z-ADD34        W0ERNB           ***************133423
     C                     MOVEL'MEM5004' W0MSGD                          133423
     C                     MOVEL'MIDAS  ' W0MSGF                          133423
     C                     EXSR SRERR                                     133423
     C                     END                                            133423
      *                                                                   133423
     C                     MOVE BFCLAS    @DISC                           133423
     C                     MOVE BFDRF1    @DRF1                           133423
     C                     MOVE BFDRF2    @DRF2                           133423
     C                     MOVE BFDRF3    @DRF3                           133423
     C                     MOVE BFDRF4    @DRF4                           133423
     C                     MOVE BFDRF5    @DRF5                           133423
     C                     MOVE BFDRF6    @DRF6                           133423
     C                     MOVE BFDRF7    @DRF7                           133423
     C                     MOVE BFDRF8    @DRF8                           133423
     C                     MOVE BFDRF9    @DRF9                           133423
     C                     MOVE BFDRF0    @DRF0                           133423
     C                     END                                            133423
     C*                                                                   133423
     C**If*the*Deliver*To*is*a*Euroclear,*Cedel,*or*Kassenverein*depot4** 133423              CSE022
     C* If the Deliver To is a Euroclear or Cedel,                                            CSE022
     C* the depot reference is in a fixed position                        133423
     C*                                                                   133423
     C           BFCLAS    IFEQ 'E'                                       133423
     C                     Z-ADD1         V                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C           BFCLAS    IFEQ 'C'                                       133423
     C                     Z-ADD2         V                               133423
     C                     SETON                     29                   133423
     C                     ELSE                                           133423
     C***********BFCLAS    IFEQ 'K'                                       133423              CSE022
     C***********          Z-ADD3         V                               133423              CSE022
     C***********          SETON                     29                   133423              CSE022
     C***********          ELSE                                           133423              CSE022
     C*                                                                   133423
     C* USE THE DELIVER FROM FIELD TO CHECK THAT THERE IS AN EQUIVALENT   133423
     C* DEPOT REF. ON TABTB36, IF SO AND DISCRETIONARY IND = M, MOVE THE  133423
     C* CORRESPONDING DEPOT. REF. FROM CLINTSE TO OUTPUT FIELD            133423
     C*                                                                   133423
     C                     MOVE DELF      DELFA                           133423
     C                     Z-ADD1         V                               133423
     C           DELFA     LOKUPARR36,V                  29               133423
     C***********          END                                            133423              CSE022
     C                     END                                            133423
     C                     END                                            133423
      *                                                                                       CSE022
     C           CSE022    IFEQ 'N'                                                           CSE022
      *                                                                                       CSE022
     C           *IN29     IFEQ '1'                                       133423
     C           TDMI      ANDNE'G'                                       133423
     C                     MOVEAARRSE,V   LIN33D                          133423
     C                     END                                            133423
      *                                                                                       CSE022
     C                     ELSE                                                               CSE022
      *                                                                                       CSE022
     C                     MOVEL'SEDOR'   WPGM    9                                           CSE022
     C                     MOVE 'FRTV'    WPGM                                                CSE022
     C                     MOVELDELFA     PDEPOT                                              CSE022
     C                     MOVELTCNR      PCNUM                                               CSE022
      *                                                                                       CSE022
     C                     CALL WPGM                                                          CSE022
     C                     PARM *BLANKS   PRETCD 10                                           CSE022
     C                     PARM           PDEPOT  6                                           CSE022
     C                     PARM           PCNUM   6                                           CSE022
     C                     PARM *BLANKS   PSKALR 20                                           CSE022
      *                                                                                       CSE022
     C                     MOVELPSKALR    LIN33D                                              CSE022
      *                                                                                       CSE022
     C                     ENDIF                                                              CSE022
      *                                                                                       CSE022
     C*                                                                   133423
     C                     END                                            133423
     C*                                                                   133423
     C                     END                             END OF 'TS'    133423
     C*                                                                   133423
     C                     ENDSR                                          133423
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDAUT                                         *
      * Function    :  Determine if Auto-Transmission of Confirmation *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDAUT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDAUT'  @STK,Q
      *
      *................................................................
      *
     C                     MOVEL'N'       ##AUTO  1
      *
      ***  If S.W.I.F.T. confirmation message generated = 'Y'
      ***  then auto transmission of confirmation
      *
     C           S01401    IFEQ 'Y'
     C           TDRF      CHAINTRADSDY1             99
     C           *IN99     IFEQ '0'
     C           T1GMEC    ANDEQ'Y'
     C                     MOVEL'Y'       ##AUTO
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXDAUT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDSET                                         *
      * Function    :  Determine Settlement Instruction Fields        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDSET    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDSET'  @STK,Q
      *
      *................................................................
      *
     C                     CALL 'CG99DSET'             99  *
      *
     C** In
      *
     C                     PARM           ##PYRC  1        *Pay/Receive
     C                     PARM           ##CCY   3        *Settlemt currncy
     C                     PARM           ##ROLL  1        *Rollover
     C                     PARM           ##SETP  2        *Settlemt type
     C                     PARM           ##STBR  3        *Settlemt branch
     C**********           PARM           ##OURN 12        *Our nostro/ A/C                   CGL029
     C                     PARM           ##OURN 18                                           CGL029
     C                     PARM           ##THRN  8        *Their nostro
     C                     PARM           ##FACO  8        *For account of
     C                     PARM BBBRCA    ##BKBR  3        *Booking  branch
     C                     PARM BBBICN    ##BKBB  6        *Booking  br BICN
     C*********************PARM CPCUST    ##CNTP  6        *Customer      081961
     C                     PARM ##CUST    ##CNTP  6        *Customer      081961
     C**********           PARM BNACCD    ##CSAC  4        *Compen.Susp. A/C                  CGL029
     C**********           PARM BMACCD    ##CADC  4        *Current A/C dflt                  CGL029
     C**********           PARM BKACCD    ##COMS  4        *Computer Sus A/C                  CGL029
     C*********************PARM BFACCD    ##DEFA  4        *Tradng Dflt A/081961
     C**********           PARM           ##DEFA  4        *Tradng Dflt A/081961              CGL029
     C                     PARM BNACCD    ##CSAC 10                                           CGL029
     C                     PARM BMACCD    ##CADC 10                                           CGL029
     C                     PARM BKACCD    ##COMS 10                                           CGL029
     C                     PARM           ##DEFA 10                                           CGL029
     C                     PARM BJLCCY    ##LOCY  3        *Local Currency
     C                     PARM BLONOC    ##ONOC  1        *Ourselves/Nostro
      *
      ** Out
      *
     C                     PARM *BLANKS   ##OAC1  3        *Our Line 1
     C                     PARM *BLANKS   ##OAC2  3        *Our Line 2
     C                     PARM *BLANKS   ##ONN  30        *Our Nostro Name
     C                     PARM *BLANKS   ##ONT  20        *Our Nostro Town
     C*********************PARM *BLANKS   ##OGA  20        *Our GL A/C                       BUG7326
     C                     PARM *BLANKS   ##OGA  24        *Our GL A/C                       BUG7326
     C                     PARM *BLANKS   ##ORA  20        *Our RE a/C
     C                     PARM *BLANKS   ##TAC1  3        *Thr Line 1
     C                     PARM *BLANKS   ##TAC2  3        *Thr Line 2
     C                     PARM *BLANKS   ##TNN  30        *Thr Nostro Name
     C                     PARM *BLANKS   ##TNT  20        *Thr Nostro Town
     C                     PARM *BLANKS   ##FAL1  3        *FACO Line 1
     C                     PARM *BLANKS   ##FAL2  3        *FACO Line 2
     C                     PARM *BLANKS   ##FAN  30        *FACO Name
     C                     PARM *BLANKS   ##FAT  20        *FACO Town
     C                     PARM *BLANKS   ##RTCD  7        *Return Code
     C/COPY WNCPYSRC,CG4210C016
      *
     C           *IN99     IFEQ '1'
     C           ##RTCD    ORNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'CG99DSET'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 08 *
     C                     Z-ADD8         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *................................................................
      *
     C           EXDSET    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/COPY WNCPYSRC,CG4210C017
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRSECT                                         *
      * Function    :  Access security details                        *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRSECT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRSECT'  @STK,Q
      *
      *................................................................
      *
      ** Access the security
      *
     C           TDSS      CHAINSECTYDF              99
      *
      ** DATABASE ERROR
      *
     C           *IN99     IFEQ '1'
     C                     MOVEL'SECTY   'W0FILE           ***************
     C                     MOVELTDSS      W0KEY            * DB ERROR 09 *
     C                     Z-ADD9         W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Determine nominal currency decimal places.
      *
     C                     MOVELNMCY      ##CCY
     C                     EXSR SRDCDT
     C                     Z-ADDA6NBDP    NOMCDP  10
      *
      **  If the security is interest bearing
      **  Determine the next and last coupon date
      **  (relative to the event control date)
      *
     C                     Z-ADD*ZERO     ##NCD   50
     C                     Z-ADD*ZERO     ##LCD   50
     C           CD01      IFGT 0
     C                     EXSR ZNCD
     C                     Z-ADDNCD       ##NCD            *next coupon date
     C                     EXSR ZLCD
     C                     Z-ADDZZLCD     ##LCD            *last coupon date
     C                     ENDIF
      *
      ** Access the investment type
      *
     C           INVTPK    KLIST
     C                     KFLD           NMCY
     C                     KFLD           SITP
     C           INVTPK    CHAININVTPDF              99
      *
      ** DATABASE ERROR
      *
     C           *IN99     IFEQ '1'
     C                     MOVEL'INVTP   'W0FILE           ***************
     C                     MOVEL##NCIT    W0KEY            * DB ERROR 10 *
     C                     Z-ADD10        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C/COPY WNCPYSRC,CG4210C011
      *................................................................
      *
     C           EXSECT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRCHCM                                         *
      * Function    :  Access charge & commission details             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRCHCM    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRCHCM'  @STK,Q
      *
      *................................................................
      *
     C                     MOVELNMCY      ##CCY
     C           SECGTK    KLIST
     C                     KFLD           ##CCY
     C                     KFLD           ##CCD
     C           SECGTK    CHAINSECGTDF              99
      *
      ** DATABASE ERROR
      *
     C           *IN99     IFEQ '1'
     C                     MOVEL'SECGT   'W0FILE           ***************
     C                     MOVEL##CCCC    W0KEY            * DB ERROR 11 *
     C                     Z-ADD11        W0ERNB           ***************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *................................................................
      *
     C           EXCHCM    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELTDBA      DRBRCA
     C                     MOVELORBR      DRORBR
     C                     MOVEL'SE'      DRMODI
     C                     MOVELTDRF      DRMTRN
     C                     MOVEL*BLANK    DRMACT
     C                     MOVELW#PTYP    DRPTYP           * print type
     C                     Z-ADD1         #1
     C           ##PROT    LOKUP##PT,#1                  99*
     C                     MOVEL##PS,#1   DRPSTP           * print s/type
     C                     MOVEL'N'       DRATRM
      *
     C                     MOVELTCNR      ##CUST
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *
     C                     MOVE 'Y'       ##COPD
      *                                                                                       CCG015
      ** Pass reference as printtype:subtype                                                  CCG015
      *                                                                                       CCG015
     C           DRPTYP    CAT  ':':0     COLON  11 P                                         CCG015
     C           COLON     CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD12        W0ERNB           * DB ERROR 12 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
      *                                                                                       CCG015
      ** Set-up Action Code parameter W0ACT                                                   CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 13 *
     C                     Z-ADD13        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
      ** Write a XML record for RDE                                                           CCG015
      *                                                                                       CCG015
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD1         DEPBIN
     C                     Z-ADD1         DETBIN
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *
      **  Output PF/CGUDTAPD Record.
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 14 *
     C                     Z-ADD14        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF                                                              CCG015
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRDCDT                                         *
      * Function    :  Determine Currency Details                     *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDCDT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRDCDT'  @STK,Q
      *
      *................................................................
      *
      **  Access array of Currency Details already loaded
     C                     Z-ADD1         C       30
     C           ##CCY     LOKUP##CY,C                   99
      *
      **  If no match is found determine the next free space in the
      **  loaded currency array.
     C           *IN99     IFEQ *OFF
     C                     Z-ADD1         C
     C           *BLANK    LOKUP##CY,C                   99
      *
      **  If no space is left, set the Currency Data data structure to
      **  the 101st occurrence so that when the new details are
      **  retrieved no existing details are overwritten.
     C           *IN99     IFEQ *OFF
     C           101       OCUR SDCURR
      *
      **  If a space is found, set up the new currency into the array
      **  and position the Currency Data data structure on the
      **  occurrence matching the array index.
     C                     ELSE
     C                     MOVE ##CCY     ##CY,C
     C           C         OCUR SDCURR
     C                     ENDIF
      *
      **  Retrieve the currency details.
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   ##RTCD           B:Return Cd
     C                     PARM '*KEY'    ##OPTN           I:Option
     C                     PARM ##CCY     ##CCYP  3        I:Currency Code
     C           SDCURR    PARM *BLANK    DSSDY            O:Format
      *
      **  Database Error
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVEL##CCY     W0KEY            ***************
     C                     Z-ADD15        W0ERNB           * DB ERROR 15 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *
      **  If the currency has been retrieved earlier, position the
      **  Currency Data data structure on the relevant occurrence.
     C                     ELSE
     C           C         OCUR SDCURR
     C                     ENDIF
     C/COPY WNCPYSRC,CG4210C004
     C*
     C           EXDCDT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5                                                            CEU014
      *****************************************************************   CEU014
      * Subroutine  :  T@EURO                                         *   CEU014
      * Function    :  EURO Currency Conversion:                      *   CEU014
      * Converts amount P@FRAM in P@FRCY to amount ##OUTA in P@TOCY   *   CEU014
      * Called by   :  T@EMU                                          *   CEU014
      *                                                               *   CEU014
      * Calls       :  EU0200                                         *   CEU014
      *                SRERR                                          *   CEU014
      *****************************************************************   CEU014
     C           T@EURO    BEGSR                                          CEU014
      *                                                                   CEU014
     C                     Z-ADD0         ##OUTA 150                      CEU014
     C                     CALL 'EU0200'                                  CEU014
     C                     PARM *BLANKS   P@RTCD  7        Return Code    CEU014
     C                     PARM           P@FRAM 183       FROM Ccy AmountCEU014
     C                     PARM           P@FRCY  3        FROM Currency  CEU014
     C                     PARM           P@TOCY  3        TO Currency    CEU014
     C                     PARM 0         P@OUTA 150       Outright AmountCEU014
     C                     PARM 0         P@INTA 183       Interim Amount CEU014
     C                     PARM 0         P@EXRT 159       Exchange Rate  CEU014
     C                     PARM *BLANK    P@MDIN  1        Mult/Div Ind.  CEU014
      *                                                                   CEU014
      ** Database error handling:                                         CEU014
      *                                                                   CEU014
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU014
     C                     MOVEL'EU0200  'W0FILE                          CEU014
     C                     MOVEL'*CALL   'W0KEY            ***************CEU014
     C                     Z-ADD27        W0ERNB           * DB ERROR 27 *CEU014
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
      *                                                                   CEU014
      ** Otherwise, store amount in settlement currency as ##OUTA         CEU014
      *                                                                   CEU014
     C                     ELSE                                           CEU014
     C                     MOVE P@OUTA    ##OUTA                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
     C                     ENDSR                                          CEU014
      *****************************************************************   CEU014
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
     C/COPY WNCPYSRC,CG4210C005
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*
     C**   DETERMINE NUMBER OF DECIMAL PLACES - BASE CURRENCY
     C*
     C                     MOVELBJCYCD    ##CCY
     C                     EXSR SRDCDT
     C                     Z-ADDA6NBDP    BASCDP  10
      *
      ** CALL ACCESS PROGRAM FOR GENERAL LEDGER DETAILS
      *
     C**********           CALL 'AOGELRR0'                                                    CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOGELRR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS
      *
     C                     CALL 'AOMMODR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOMMODR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR SECURITIES TRADING DATA DETAILS
     C*
     C                     CALL 'AOSTRDR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDSTRD    PARM SDSTRD    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOSTRDR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD19        W0ERNB           * DB ERROR 19 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR TRADING DATA DETAILS
     C*
     C                     CALL 'AOTRADR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDTRAD    PARM SDTRAD    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOTRADR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR DEALING DATA DETAILS
     C*
     C           BGDLMM    IFEQ 'Y'
     C**********           CALL 'AODEALR0'                                                    CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C********** SDDEAL    PARM SDDEAL    DSFDY                                               CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AODEALR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR RETAIL DETAILS
     C*
     C           BGRTBN    IFEQ 'Y'
     C           BGIOAC    OREQ 'Y'
     C                     CALL 'AORETLR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AORETLR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
     C*
     C** CALL ACCESS PROGRAM FOR MESSAGE DETAILS
     C*
     C           BGSWST    IFEQ 'Y'
     C                     CALL 'AOMGMER0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*FIRST  '##OPTN
     C           SDMGME    PARM SDMGME    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOMGMER0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     END
     C*
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF MT5XX FEATURE IS INSTALLED
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' ##RTCD
     C                     PARM '*VERIFY' ##OPTN
     C                     PARM 'S01401'  ##SARD  6
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C           ##RTCD    ANDNE'*NRF   '
     C                     MOVEL'SCSARDPD'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 24 *
     C                     Z-ADD24        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           ##RTCD    IFEQ *BLANK
     C                     MOVE 'Y'       S01401  1
     C                     END
      *
     C** Access switchable features file to determine if                  CEU014
     C** EMU User Defined Correspondence enhancement is switched on.      CEU014
     C*                                                                   CEU014
     C                     CALL 'AOSARDR0'                                CEU014
     C                     PARM '       ' ##RTCD                          CEU014
     C                     PARM '*VERIFY' ##OPTN                          CEU014
     C                     PARM 'CEU014'  ##SARD                          CEU014
      *                                                                   CEU014
      ** Database error                                                   CEU014
      *                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C           ##RTCD    ANDNE'*NRF   '                                 CEU014
     C                     MOVEL'SCSARDPD'W0FILE           ***************CEU014
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 28 *CEU014
     C                     Z-ADD28        W0ERNB           ***************CEU014
     C                     MOVEL'MEM5003' W0MSGD                          CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
     C           ##RTCD    IFEQ *BLANK                                    CEU014
     C                     MOVE 'Y'       CEU014  1                       CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CSE023
      ** Access Switchable Features file and check if CSE023 is           CSE023
      ** installed                                                        CSE023
      *                                                                   CSE023
     C                     MOVE 'N'       CSE023  1                       CSE023
     C                     CALL 'AOSARDR0'                                CSE023
     C                     PARM *BLANKS   PRTCD   7                       CSE023
     C                     PARM '*VERIFY' POPTN   7                       CSE023
     C                     PARM 'CSE023'  PSARD   6                       CSE023
      *                                                                   CSE023
     C           PRTCD     IFEQ *BLANK                                    CSE023
     C                     MOVE 'Y'       CSE023                          CSE023
     C                     ENDIF                                          CSE023
      *                                                                                       CSE022
      ** Access Switchable Features file and check if CSE022 is                               CSE022
      ** installed                                                                            CSE022
      *                                                                                       CSE022
     C                     CALL 'AOSARDR0'                                                    CSE022
     C                     PARM *BLANKS   PRTCD   7                                           CSE022
     C                     PARM '*VERIFY' POPTN   7                                           CSE022
     C**********           PARM 'CSE023'  PSARD   6                                    CSE022 CCG015
     C                     PARM 'CSE022'  PSARD                                               CCG015
      *                                                                                       CSE022
     C           PRTCD     IFEQ *BLANK                                                        CSE022
      *                                                                                       CSE022
     C                     MOVE 'Y'       CSE022  1                                           CSE022
      *                                                                                       CSE022
     C                     ELSE                                                               CSE022
      *                                                                                       CSE022
     C                     MOVE 'N'       CSE022                                              CSE022
      *                                                                                       CSE022
     C                     ENDIF                                                              CSE022
      *                                                                                       CCG015
      ** Access Switchable Features file and check if CCG015 is                               CCG015
      ** installed                                                                            CCG015
      *                                                                                       CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD                                               CCG015
     C                     PARM '*VERIFY' POPTN                                               CCG015
     C                     PARM 'CCG015'  PSARD                                               CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
      *                                                                                       CCG015
     C           PRTCD     IFEQ *BLANK                                                        CCG015
      *                                                                                       CCG015
     C                     MOVE 'Y'       CCG015  1                                           CCG015
      *                                                                                       CCG015
     C                     ELSE                                                               CCG015
      *                                                                                       CCG015
     C                     MOVE 'N'       CCG015                                              CCG015
     C           PRTCD     IFNE '*NRF   '                                                     CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL'   W0KEY                                               CCG015
     C                     Z-ADD35        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CGL031
      ** Access Switchable Features file and check if CGL031 is                               CGL031
      ** installed                                                                            CGL031
      *                                                                                       CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM *BLANKS   PRTCD                                               CGL031
     C                     PARM '*VERIFY' POPTN                                               CGL031
     C                     PARM 'CGL031'  PSARD                                               CGL031
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL031
      *                                                                                       CGL031
     C           PRTCD     IFEQ *BLANK                                                        CGL031
      *                                                                                       CGL031
     C                     MOVE 'Y'       CGL031  1                                           CGL031
      *                                                                                       CGL031
     C                     ELSE                                                               CGL031
      *                                                                                       CGL031
     C                     MOVE 'N'       CGL031                                              CGL031
     C           PRTCD     IFNE '*NRF   '                                                     CGL031
     C                     MOVEL'SCSARDPD'W0FILE                                              CGL031
     C                     MOVEL'*CALL'   W0KEY                                               CGL031
     C                     Z-ADD36        W0ERNB                                              CGL031
     C                     MOVEL'MEM5003' W0MSGD                                              CGL031
     C                     MOVEL'MIDAS  ' W0MSGF                                              CGL031
     C                     EXSR SRERR                                                         CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
     C*                                                                                       CGL031
      *                                                                                       CRE073
      ** Access Switchable Features file and check if CRE073 is                               CRE073
      ** installed                                                                            CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   PRTCD                                               CRE073
     C                     PARM '*VERIFY' POPTN                                               CRE073
     C                     PARM 'CRE073'  PSARD                                               CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANK                                                        CRE073
      *                                                                                       CRE073
     C                     MOVE 'Y'       CRE073  1                                           CRE073
      *                                                                                       CRE073
     C                     ELSE                                                               CRE073
      *                                                                                       CRE073
     C                     MOVE 'N'       CRE073                                              CRE073
     C           PRTCD     IFNE '*NRF   '                                                     CRE073
     C                     MOVEL'SCSARDPD'W0FILE                                              CRE073
     C                     MOVEL'*CALL'   W0KEY                                               CRE073
     C                     Z-ADD37        W0ERNB                                              CRE073
     C                     MOVEL'MEM5003' W0MSGD                                              CRE073
     C                     MOVEL'MIDAS  ' W0MSGF                                              CRE073
     C                     EXSR SRERR                                                         CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CER049
      ** Access Switchable Features file and check if CER049 is                               CER049
      ** installed                                                                            CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   PRTCD                                               CER049
     C                     PARM '*VERIFY' POPTN                                               CER049
     C                     PARM 'CER049'  PSARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           PRTCD     IFEQ *BLANK                                                        CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
      *                                                                                       CER049
     C           PRTCD     IFNE '*NRF   '                                                     CER049
     C                     MOVEL'SCSARDPD'W0FILE                                              CER049
     C                     MOVEL'*CALL'   W0KEY                                               CER049
     C                     Z-ADD37        W0ERNB                                              CER049
     C                     MOVEL'MEM5003' W0MSGD                                              CER049
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                     MD057247
      ** Access Switchable Features file to determine if CSE031 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD  7                                         MD057247
     C                     PARM '*VERIFY' UOPTN   7                                         MD057247
     C                     PARM 'CSE031'  UUKEY   6                                         MD057247
     C                     PARM           UDSFDY 76                                         MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE031  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE031                                            MD057247
     C                     ENDIF                                                            MD057247
      *                                                                                     MD057247
      ** Access Switchable Features file to determine if CSE071 is                          MD057247
      ** installed in the system.                                                           MD057247
      *                                                                                     MD057247
     C                     CALL 'AOSARDR0'                                                  MD057247
     C                     PARM           URTNCD                                            MD057247
     C                     PARM '*VERIFY' UOPTN                                             MD057247
     C                     PARM 'CSE071'  UUKEY                                             MD057247
     C                     PARM           UDSFDY                                            MD057247
      *                                                                                     MD057247
     C                     MOVE 'N'       CSE071  1                                         MD057247
     C           URTNCD    IFEQ *BLANKS                                                     MD057247
     C                     MOVE 'Y'       CSE071                                            MD057247
     C                     ENDIF                                                            MD057247
      *                                                                                     MD057247
     C*                                                                   CEU014
     C/COPY WNCPYSRC,CG4210C001
      *................................................................
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C           *LIKE     DEFN DEOSEQ    ##OSEQ                          082060
     C           *LIKE     DEFN A6NBDP    ##NBST                                              235291
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
      *                                                                                       CCG015
      ** Initialise XML increment                                                             CCG015
      *                                                                                       CCG015
     C                     EXSR INIXML                                                        CCG015
      *
     C           EXINZ     TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
     C/SPACE 5
     C/COPY ZSRSRC,ZNCDZ3
     C/SPACE 5
     C/COPY ZSRSRC,ZLCDZ1                                                                   MD057247
     C/SPACE 5
     C/COPY ZSRSRC,ZSDESCZ3
     C/SPACE 5
     C/COPY ZSRSRC,ZDATE1Z2
     C/SPACE 5
     C/COPY ZSRSRC,ZDATE2Z2
     C/SPACE 5
     C/COPY ZSRSRC,ZDAYSZ2
     C/SPACE 5                                                            087630
     C/COPY ZSRSRC,ZDYYRZ3                                                087630
     C/SPACE 5                                                            089202
     C/COPY ZSRSRC,ZCNSDZ1                                                089202
     C/SPACE 5                                                                                234770
     C/COPY ZSRSRC,ZCONVNZ1                                                                   234770
     C/SPACE 5                                                                                CCG015
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
      *                                                                   086160
      * Group set T_TRDD originally contained 33 RDE's. This is too large.086160
      * Subsequently the RDE's COM_BROK,COM_CUST,the CHG_NARR's 1 to 7    086160
      * and the CHG_AMNT's 1 to 7 together with TRADE_REAL and TAX have   086160
      * been seperated into a new Group Set T_TRDC.                       086160
      *                                                                   086160
** ##GRP/##RDEA
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
CUST  0001 CUSTOMER
CUST  0002 CUST_NAME
CUST  0003 CUST_ADR1
CUST  0004 CUST_ADR2
CUST  0005 CUST_ADR3
CUST  0006 CUST_ADR4
CUST  0007 CUST_TOWN                                                      086918
T_OTHT0001 CANC/AMEND
T_OTHT0002 AUTO-TRAN
T_OTHT0003 TRADE_TYPE
T_OTHT0004 TRADE_SUBT
T_OTHT0005 TRADE_INCI
T_OTHT0006 TRADE_MKTI
T_OTHT0007 TRADE_CAPI
T_OTHT0008 TRADE_PAYC
T_OTHT0009 TRADE_AIIP
T_OTHT0010 CUST_CLASS
     X/COPY WNCPYSRC,CG4210X001
T_SECD0001 SEC_SHTNAM
T_SECD0002 PROC_TYPE
T_SECD0003 SEC_NOMCCY
T_SECD0004 SEC_INVTYP
T_SECD0005 SEC_DESCP1
T_SECD0006 SEC_DESCP2
T_SECD0007 SEC_DESCP3
T_SECD0008 SEC_NXTCDT Date
T_SECD0009 SEC_LSTCDT Date
T_SECD0010 SEC_COUPRT Rate  L7
T_SECD0011 SEC_MATUDT Date
T_SECD0012 SEC_INITDT Date
T_SECD0013 SEC_ISSUDT Date
T_SECD0014 SEC_ISIN                                                       089693
T_SECD0015 SEC_INVNAM                                                                         214731
T_SECD0016 CONTSPR    Rate  L7                                                                CRE073
T_SECD0017 CONTSSG                                                                            CRE073
T_SECD0018 RNDMTD                                                                             CRE073
T_SECD0019 RNDFRCD                                                                            CRE073
T_SECD0020 CRE073F                                                                            CRE073
     X/COPY WNCPYSRC,CG4210X002
T_TRDD0001 RUNDAT     Date
T_TRDD0002 TRADE_NUM
T_TRDD0003 TRADE_DATE Date
T_TRDD0004 VALUE DATE Date
T_TRDD0005 NOMINAL    AmountL
T_TRDD0006 TRADE_PDY  Rate  L8
T_TRDD0007 TRADE_CONS AmountL
T_TRDD0008 TRADE_ACIN
T_TRDD0009 TRADE_DYSI AmountL
T_TRDD0010 TRADE_PURI AmountL
T_TRDD0011 TRADE_IADD AmountL
T_TRDD0012 TRADE_IADA AmountL
T_TRDD0013 TRADE_CTVN AmountL
T_TRDD0014 EXCH RATE  Xrate L8
T_TRDD0015 TRADE_SETC
T_TRDD0016 TRADE_CTVS AmountL
T_TRDD0017 TRADE_NARR                                                     084868
T_TRDD0018 PORT_REF                                                                           214731
T_EMU 0001 TRADE_EQCY AmountL                                             CEU014
T_EMU 0002 T_EQV_CCY                                                      CEU014
T_EMU 0003 T_EQV_CCYD                                                     CEU014
T_EMU 0004 SETTL_EQCY AmountL                                             CEU014
T_EMU 0005 SE_EQ_CCY                                                      CEU014
T_EMU 0006 SE_EQ_CCYD                                                     CEU014
T_TRDC0001 COM_BROK   AmountL
T_TRDC0002 COM_CUST   AmountL
T_TRDC0003 CHG_NARR1
T_TRDC0004 CHG_AMNT1  AmountL
T_TRDC0005 CHG_NARR2
T_TRDC0006 CHG_AMNT2  AmountL
T_TRDC0007 CHG_NARR3
T_TRDC0008 CHG_AMNT3  AmountL
T_TRDC0009 CHG_NARR4
T_TRDC0010 CHG_AMNT4  AmountL
T_TRDC0011 CHG_NARR5
T_TRDC0012 CHG_AMNT5  AmountL
T_TRDC0013 CHG_NARR6
T_TRDC0014 CHG_AMNT6  AmountL
T_TRDC0015 CHG_NARR7
T_TRDC0016 CHG_AMNT7  AmountL
T_TRDC0017 TRADE_REAL AmountL
T_TRDC0018 TAX        AmountL
T_TRDC0019 WHTAX      AmountL                                             CSE023
T_TRDC0020 EUTAX      AmountL                                                                 CGL031
T_TRDC0021 CCY_LOCAL                                                                          234770
T_TRDC0022 CCY_RAT_L  Rate  L7                                                                234770
T_TRDC0023 TAX_LOCAL  AmountL                                                                 234770
T_TRDC0024 ZSTAXFLG                                                                           CER049
T_TRDC0025 Z_TAX_AMT  AmountL                                                                 CER049
T_TRDS0001 S_OURA1
T_TRDS0002 S_OURA2
T_TRDS0003 S_OURNN
T_TRDS0004 S_OURNT
T_TRDS0005 S_OURXG
T_TRDS0006 S_OURXR
T_TRDS0007 S_THRA1
T_TRDS0008 S_THRA2
T_TRDS0009 S_THRNN
T_TRDS0010 S_THRNT
T_TRDS0011 S_ZFAL1
T_TRDS0012 S_ZFAL2
T_TRDS0013 S_ZFAON
T_TRDS0014 S_ZFAOT
T_TRDS0015 S_OURDNAM
T_TRDS0016 S_OURDTWN
T_TRDS0017 S_OURDACNO
T_TRDS0018 S_THRDNAM
T_TRDS0019 S_THRDTWN
T_TRDS0020 S_THRDACNO
T_TRDS0021 S_THRDZFAN
T_TRDS0022 S_THRDZFAT
**  Table of Proc. Type vs related Print Item Sub Type
1FIXED_INT
2COMMODITY
3FRN
4SHARE
5YEN_BOND
6SCHULDSCH
7UNIT_TRUST
8MORTGAGE
9COMM_PAPER
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZF29 DAY NOS OF FEB 29 TO 2096 (INCLUDING 2000)
0006001521029820444305904073650882610287117481320914670161311759219053
2051421975234362489726358278192928030741322023366335124365853804639507
40968424294389045351
**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
00000001
00000010
00000100
00001000
00010000
00100000
01000000
10000000
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           234770
0000001                                                                                       234770
0000010                                                                                       234770
0000100                                                                                       234770
0001000                                                                                       234770
0010000                                                                                       234770
0100000                                                                                       234770
1000000                                                                                       234770
