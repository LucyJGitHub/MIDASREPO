     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Fut and opts confirmations(start) extract')   *
/*OVRF*: OVRDBF (File in program) (file on system)                  : *
      *****************************************************************
      *                                                               *
      *  Midas - User Defined Correspondence                          *
      *                                                               *
      *  CG4600 - Futures and Options Confirmations COB (Start)       *
      *                                                               *
      *  Function:  This program extracts FF confirmation details     *
      *                                                               *
      *  Called By: mmCnnnn - (program name)                          *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 249385             Date 01Aug22               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE134             Date 01Aug12               *
      *                 CAP208             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246526             Date 21Mar07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9646            Date 20Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 18Jun99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFF003             DATE 28NOV96               *
      *                 CFF004             DATE 11SEP96               *
      *                 S01408             DATE 16AUG96               *
      *                 098117             DATE 17JUL96               *
      *                 097955             DATE 10JUL96               *
      *                 S01408             DATE 10JUN96               *
      *                 089776             DATE 17APR96               *
      *                 S71062             DATE 29JAN96               *
      *                 090308             DATE 19FEB96               *
      *                 087274             DATE 09MAY95               *
      *                 087273             DATE 09MAY95               *
      *                 086918             DATE 02MAY95               *
      *                 S01522             DATE 22NOV94               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  249385 - Ensure input fields ZDAYNO keeps original value     *
      *            (Recompiled due to changes in ZBKDT)               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CAP208 - F&O Market Instrument API (Recompile)               *
      *  246526 - Recompiled due to change in FFSETLZ4.               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  CSD006 - Recompiled over changed SDCURRPD.                   *
      *  CPB001 - 'Private Banking' Module                            *
      *  CFF003 - Enhanced OTC processing - phase II.                 *
      *  CFF004 - Increase in size of Price Fields                    *
      *         - (##WK11 Redefined as 15,0)                          *
      *  S01408 - Core hook CG4600CCP4 added.                         *
      *  098117 - Some times, reversal ind. incorrect                 *
      *         - Extract positive trade ref. at maturity             *
      *  097955 - On FF Confs, account reference only partly printed. *
      *           Fix is to set up all information correctly before   *
      *           executing FFSETL.                                   *
      *  S01408 - Core hook CG4600CCP1 added.                         *
      *           Core hook CG4600CCP2 added.                         *
      *           Core hook CG4600CCP3 added.                         *
      *           Core hook CG4600EEP1 added.                         *
      *           Core hook CG4600EEP2 added.                         *
      *           Core hook CG4600IIP1 added.                         *
      *  089776 - Add 'Account officer' details                       *
      *  S71062 - FF/PM Interface                                     *
      *  090308 - Db error 2 with key 000000 on TRANS2                *
      *         - Suppress Db error for deleted record (RECI *) as    *
      *           extract CG4604 considers deleted record (CHTP D)    *
      *  087274 - Correct set up of Print Type/Sub-Type               *
      *  087273 - Add in missing RDEs                                 *
      *  086918 - Add customer town RDE to Group set CUST.            *
      *  S01522 - User Defined Correspondence                         *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  Indicator usage                                              *
      *  ~~~~~~~~~~~~~~~                                              *
      *                                                               *
      *  51   -    No Record found on                                 *
      *  90   -    ROLBK indicator                                    *
      *                                                               *
      *  99   -    General work indicator                             *
      *                                                               *
      *****************************************************************
     FTRANS2  IF  E           K        DISK         KINFSR SRFILE
     FTRSET1  IF  E           K        DISK         KINFSR SRFILE         097955
     FSDACOFL0IF  E           K        DISK         KINFSR SRFILE         089776
     FCLINT   IF  E           K        DISK         KINFSR SRFILE
     F            CLINTCAF                          KIGNORE
     F            CLINTC1F                          KIGNORE
     FTABFF   IF  E           K        DISK         KINFSR SRFILE
     F************TABTB10F                          KIGNORE               097955
     F            TABTB11F                          KIGNORE
     F            TABTG10F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETRF                          KIGNORE
     F            TABLET2F                          KIGNORE
     FACCNT   IF  E           K        DISK         KINFSR SRFILE
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACNUM   IF  E           K        DISK         KINFSR SRFILE
     F            ACCNTABF                          KRENAMEACCNTABR
     FMARKT   IF  E           K        DISK         KINFSR SRFILE         087273
     F* Market information                                                087273
      /EJECT
      /COPY CGCPYSRC,CGPACKE
      *
      *   Number Arrays
      *
     E                    ##W        20  1
     E                    ##NUMA     29  1
      *
      **  ##GRP = Group/RDE Number            ##RDEA = RDE + Attributes
      *
     E********************##GRP   1  52 10   ##RDEA 22                    086918
     E******************* ##GRP   1  53 10   ##RDEA 22              086918087273
     E******************* ##GRP   1  45 10   ##RDEA 22              087273S71062
     E******************* ##GRP   1  46 10   ##RDEA 22              S71062089776
     E*                                                                   S01408
     E/COPY WNCPYSRC,CG4600EEP1                                           S01408
     E*                                                                   S01408
     E******************* ##GRP   1  51 10   ##RDEA 22              089776CFF003
     E                    ##GRP   1  55 10   ##RDEA 22                    CFF003
     E*                                                                   S01408
     E/COPY WNCPYSRC,CG4600EEP2                                           S01408
     E*                                                                   S01408
      *
      **  Array of Currencies accessed by program
      *
     E                    ##CY      100  3
      *
      **  Copyright array.
      *
      *   Arrays of OTC (ISPT) and the associated print item sub-type.
      *
     E                    ##IP    1   6  1   ##PS   10
      *
     E                    ##CPY   1   1 80
      /COPY ZSRSRC,FFDATEZ1                                               087273
      /COPY ZSRSRC,ZDATE1Z1                                               087273
      /COPY ZSRSRC,ZHOLE                                                  087273
      /COPY CGCPYSRC,SRERRE
      /EJECT
      *
     ITRANSDF
     I*
      ** Rename of fields on TRANS2
     I*
     I              BRCA                            ##BRTR                S01117
     I              ISTT                            ##ITTR
     I              ISCY                            ##ICTR
     I              PCAL                            ##PCTR
     I              STRP                            ##SPTR
      /COPY ZSRSRC,ZHOLI                                                  087273
      *
     I            DS
      **  Convert Ouput Sequence between Numeric and Binary
     I                                    B   1   20##OSEQ
      *
     I            DS
      **  Look-up string for RDE definition Array
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I##SDS       DS
      **  Packed data string.
     I**********                              15120 ##S                                      BUG9646
     I                                        15632 ##S                                      BUG9646
     I            DS
      **  Settlement Account
     I**********                              1  22 ##ACNT                                    CGL029
     I                                        1  28 ##ACNT                                    CGL029
     I                                        1   3 ##SABR
     I                                        4   4 ##DSH1
     I                                        5  10 ##SACU
     I                                       11  11 ##DSH2
     I                                       12  14 ##SACY
     I                                       15  15 ##DSH3
     I**********                             16  19 ##SACO                                    CGL029
     I**********                             20  20 ##DSH4                                    CGL029
     I**********                             21  22 ##SACS                                    CGL029
     I                                       16  25 ##SACO                                    CGL029
     I                                       26  26 ##DSH4                                    CGL029
     I                                       27  28 ##SACS                                    CGL029
     I*                                                                   S01408
     I/COPY WNCPYSRC,CG4600IIP1                                           S01408
     I*                                                                   S01408
      *                                                                                       CCG015
      ** SAR descriptions                                                                     CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
     I              LCD                             LCDXX                                     CCG015
      *                                                                                       CCG015
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
      *
     ISDINTY    E DSINTYPD                                                S10736
      *                                                                   S10736
      *  Instrument Type  DS for validation of Transaction Type           S10736
      *                                                                   S10736
      *
      ** Rename of fields on INTYP
      *
     I              RECI                            ##RIIT
     I              ISTT                            ##ITIT
     I              ISCY                            ##ICIT
     ISDFOCS    E DSSDFOCSPD                                              S01117
      *                                                                   S10736
      ** FF Customer/Broker Details                                       S01117
      *                                                                   S10736
     ISDBRCH    E DSSDBRCHPD
      *
      **  External DS for branch details
      *
     I              A8BICN                          BICN                  S01117
      *
     ISDCURR    E DSSDCURRPD                101
      **  External DS for currency details
      *
     ISDMMOD    E DSSDMMODPD                                              S71062
      **  External DS for module details                                  S71062
      *                                                                   S71062
     ISDACOD    E DSSDACODPD                                                                  CGL029
      **  External DS for SD Account Codes                                                    CGL029
      *                                                                                       CGL029
     IDSFDY     E DSDSFDY
      **  First DS for access programs, short data structure
      *
     I************DSSDY     E DSDSSDY                                     087273
      ****Second*DS*for Access programs, long data structure              087273
      *
     IDSPARM    E DSCNFRPD
      **  External DS for parameters based on PF/CNFRPD
     I                                        2   4 ##BRCA
     I**********                              5  100##CNUM                                    CSD027
     I                                        5  10 ##CNUM                                    CSD027
     I                                        5  10 ##CNMA                N/Used
      *
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
      ** Used to convert item reference from character to numeric
      *
      **                                                                  087273
     IRUNDT     E DSRUNDAT                                                087273
      **  Data Area RUNDAT                                                087273
      *                                                                   087273
      * Named constants
      *
     I************* 'CONF_CONF '          C         W#PTYP                087274
      *
     IW0FMT     E DSCGUDTAPD
      *
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT                N/Used
      *                                                                   S03220
     I/COPY CGCPYSRC,CGPACKI
      *                                                                   S03220
     ICPYR        DS                                                      S03220
      **  Data Structure for Compilation - Copyright Insertion            S03220
     I                                        1  80 ##CPY                 S03220
      *-------------------------------------------------------------------087273
      * Named constant:                                                   087273
      *                                                                   087273
     I              'Over-the-counter   ' C         ##OTC                 087273
      *-------------------------------------------------------------------087273
      /COPY CGCPYSRC,SRERRI
      *
      /COPY ZSRSRC,FFSETLZ1
      /COPY ZSRSRC,FFDATEZ2                                               087273
      /COPY ZSRSRC,ZHOLDS                                                 087273
      *
      /EJECT
      *****************************************************************
      *                                                               *
      *   Index to subroutines                                        *
      *   --------------------                                        *
      *                                                               *
      *   f_OTC1 - Main processing - top level group set OTC 1        *
      *   f_OTC2 - Main processing - top level group set OTC 2        *
      *   f_OTC3 - Main processing - top level group set OTC 3        *
      *   f_OTC4 - Main processing - top level group set OTC 4        *
      *   f_OTC5 - Main processing - top level group set OTC 5        *
      *   f_OTC6 - Main processing - top level group set OTC 6        *
      *   BRANCH - Branch Details (Simple)                            *
      *   F_COND - Contract Details (Simple)                          *
      *   F_INST - Instrument Details (Simple)                        *
      *   F#AMNC - Total Contingent Amount                            *
      *   F#AMNV - Total Value Of Contracts                           *
      *   F#AMNF - Commission/Charges                                 *
      *   F_TOTS - Total Details (Simple)                             *
      *   F_SETL - Settlement Details (Simple)                        *
      *   F_TRAN - Transaction Narrative (Simple)                     *
      *   CUST     Customer Details (Simple)                          *
      *   F_ATTN   For attention of (Simple)                          *
      *   SRRMDR - Common underlying group sets                       *
      *   SRTOTC - Total calculations                                 *
      *   SRADTA - Accumulate RDEs & associated data for Output       *
      *   SRODTA - Output Accumulated Data to PF/CGUDTAPD             *
      *   SRRRDE - Retrieve RDE information for RDE in group set      *
      *   SRINZ  - Initialise Fields on Each Invocation               *
      *   SRINIT - Initial processing - On First Call                 *
      *   *PSSR  - Exception/Error Handling                           *
      *****************************************************************
      /EJECT
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                FOTCST - Main Processing - Top Level Group Set *
      *****************************************************************
      *
      *   Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      *   Initial processing - Once Only
      *
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      **  Initialisation processing
      *
     C                     EXSR SRINZ
      *
      **  Detail process - top level group set
      *
      *   Access some files
      *
     C                     EXSR SRFILA
      *
      **  Generate reference number and check if further processing
      **  required - set up all available information in the record
      **  format before calling
      *
     C                     MOVELBRCA      DRBRCA
     C                     MOVELBRCA      DRORBR
     C                     MOVEL'FF'      DRMODI
     C                     CLEARDRMTRN
     C                     MOVELTNBR      DRMTRN
     C                     MOVEL*BLANK    DRMACT
     C**********           MOVELW#PTYP    DRPTYP           * print type   087274
     C                     MOVELW0PTYP    DRPTYP           * print type   087274
     C                     Z-ADD1         #1
     C                     MOVE ISPT      ##ISPT
     C           ##ISPT    LOKUP##IP,#1                  99*
     C                     MOVEL##PS,#1   DRPSTP           * print s/type
     C                     MOVEL'N'       DRATRM
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM ##CNMA    ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies create confirmation; if blank,
      **  call generation subroutines. CGD1270 => no error, but
      **  suppress all output for this transaction.
      *
     C           ##RTCD    IFNE *BLANK                     B1
     C           ##RTCD    IFEQ 'CGD1270'                  B2
     C                     ELSE                            X2
     C                     MOVEL'CG9010  'W0FILE            2
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD01        W0ERNB           * DB ERROR 01 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ENDIF                           E2
     C                     ELSE                            X1
      *
      ** Pass reference as 'Print Item Type:Print Item Sub-type'                              CCG015
      *                                                                                       CCG015
     C           DRPTYP    CAT  ':':0     COLON  11 P                                         CCG015
     C           COLON     CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *                                                                                       CCG015
     C           ISPT      CASEQ1         F#OTC1           B2
     C           ISPT      CASEQ2         F#OTC2
     C           ISPT      CASEQ3         F#OTC3
     C           ISPT      CASEQ4         F#OTC4
     C           ISPT      CASEQ5         F#OTC5
     C           ISPT      CASEQ6         F#OTC6
     C                     ENDCS                           E2
     C                     ENDIF                           E1
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
      *
     C                     RETRN
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC1                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#COND - Contract Details (Simple)             *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC1    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC1'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC1' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Contract Details (simple)
      *
     C                     EXSR F#COND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC2                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#INSO - Other Currency                        *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNV - Total Value Of Contracts              *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC2    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC2'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC2' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Other Currency
      *
     C                     EXSR F#INSO                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Value Of Contracts
      *
     C                     EXSR F#AMNV                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC3                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#COND - Contract Details (Simple)             *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC3    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC3'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC3' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Contract Details (simple)
      *
     C                     EXSR F#COND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC4                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#CNFP - Put/Call/Strike Price                 *
      *                F#CNFT - Amer/European/Underlying Tran. Type   *
      *                F#COND - Contract Details                      *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNP - Premium/Profit                        *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC4    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC4'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC4' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Put/Call
      *
     C                     EXSR F#CNFP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  American/European
      *
     C                     EXSR F#CNFT                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contracts
      *
     C                     EXSR F#COND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Premium/Profit
      *
     C                     EXSR F#AMNP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC5                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#INSO - Other Currency                        *
      *                F#CNFP - Put/Call/Strike Price                 *
      *                F#CNFT - Amer/European/Underlying Tran. Type   *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNV - Total Value Of Contracts              *
      *                F#AMNP - Premium/Profit                        *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC5    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC5'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC5' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Other Currency
      *
     C                     EXSR F#INSO                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Put/Call
      *
     C                     EXSR F#CNFP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  American/European
      *
     C                     EXSR F#CNFT                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Value Of Contracts
      *
     C                     EXSR F#AMNV                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Premium/Profit
      *
     C                     EXSR F#AMNP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#OTC6                                         *
      * Function    :  Main processing - top level group set          *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CG9010 - Create reference record               *
      *                F#REVI - Reversal Indicator                    *
      *                F#INST - Instrument Details                    *
      *                F#TRAN - Transaction Details (simple)          *
      *                F#CNFP - Put/Call/Strike Price                 *
      *                F#CNFT - Amer/European/Underlying Tran. Type   *
      *                F#COND - Contract Details                      *
      *                F#AMNC - Total Contingent Amount               *
      *                F#AMNP - Premium/Profit                        *
      *                F#AMNF - Commission/Charges                    *
      *                F#TOTS - Total Details (Simple)                *
      *                SRRMDR - Settlement/Cust/Attention/Branch      *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#OTC6    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'F#OTC6'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C           1         OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\f_OTC6' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     MOVELS#PATH    ##SPAT
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Process Reversal Indicator
      *
     C                     EXSR F#REVI                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Processing Instrument Details
      *
     C                     EXSR F#INST                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Transaction Details (simple)
      *
     C                     EXSR F#TRAN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Position Change Date (simple)
      *
     C                     EXSR F#TRND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Put/Call
      *
     C                     EXSR F#CNFP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  American/European
      *
     C                     EXSR F#CNFT                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contracts
      *
     C                     EXSR F#COND                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Contingent Amount
      *
     C                     EXSR F#AMNC                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Premium/Profit
      *
     C                     EXSR F#AMNP                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Commission/Charges
      *
     C                     EXSR F#AMNF                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Total Details (Simple)
      *
     C                     EXSR F#TOTS                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Common Details
      *
     C                     EXSR SRRMDR                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  SRRMDR                                         *
      * Function    :  Process Remaining Common Group Sets            *
      *                                                               *
      * Called by   :  F#OTC1 - Top level group set                   *
      * Called by   :  F#OTC2 - Top level group set                   *
      * Called by   :  F#OTC3 - Top level group set                   *
      * Called by   :  F#OTC4 - Top level group set                   *
      * Called by   :  F#OTC5 - Top level group set                   *
      * Called by   :  F#OTC6 - Top level group set                   *
      * Calls       :  F#SETL - Settlement Details                    *
      *                F#CUST - Customer Details                      *
      *                F#ATTN - For Attention Of                      *
      *                BRANCH - Branch Details                        *
      *                SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *****************************************************************
     C           SRRMDR    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRRMDR'  @STK,Q
      *
      **  Settlement Details (Simple)
      *
     C                     EXSR F#SETL                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Customer Details (Simple)
      *
     C                     EXSR CUST                        1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *                                                                   089776
      ** Counterparty Account Officer Details                             089776
     C                     EXSR ACOF                                      089776
     C           1         OCUR ##SRDT                      1             089776
     C                     MOVEL##SPAT    S#PATH            1             089776
      *
      **  For the attention of
      *
     C                     EXSR F#ATTN                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      **  Branch Details (simple)
      *
     C                     EXSR BRANCH                      1
     C           1         OCUR ##SRDT                      1
     C                     MOVEL##SPAT    S#PATH            1
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#REVI                                         *
      * Function    :  Instrument Details (Simple)                    *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#REVI    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#REVI'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_REVI' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_REVI'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Instrument Type
      *
     C                     MOVELREVI      ##D,1
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG4600CCP4                                           S01408
     C*                                                                   S01408
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F#INST                                         *
      * Function    :  Instrument Details (Simple)                    *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#INST    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#INST'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_INST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_INST'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Instrument Type
      *
     C                     MOVELISTT      ##D,1
      *
      **  Set up Instrument Name
      *
     C                     MOVELISTN      ##D,2
      *************                                                       087273
      ****Set*up*Settlement Date                                          087273
      *************                                                       087273
     C*************        MOVELSETD      ##D,3                           087273
      *                                                                   087273
      **  If Instrument is an OTC                                         087273
     C           ISTI      IFEQ 'Y'                                       087273
      *                                                                   087273
      **  Set up Settlement Date - Directly                               087273
     C                     MOVELSETD      ##D,3                           087273
      *                                                                   087273
      **  Set up Final Transaction Date - Directly                        087273
     C                     MOVELFTDT      ##D,7                           087273
      *                                                                   087273
      **  Set up Market                                                   087273
     C                     MOVEL'OTC'     ##D,8                           087273
      *                                                                   087273
      **  Set up Market Name                                              087273
     C                     MOVEL##OTC     ##D,9                           087273
      *                                                                   087273
      **  Set up Final Transaction Time and Value Date only for options   CFF003
      *                                                                   CFF003
     C           ISPT      IFGE 4                                         CFF003
     C           ISPT      ANDLE6                                         CFF003
      *                                                                   CFF003
      **  Set up Final Transaction Time                                   CFF003
     C                     MOVELFTTM      ##D,11                          CFF003
      *                                                                   CFF003
      **  Set up Value Date                                               CFF003
     C                     MOVELVALD      ##D,12                          CFF003
      *                                                                   CFF003
     C                     ENDIF                                          CFF003
      *                                                                   CFF003
      **  If Instrument is not an OTC                                     087273
     C                     ELSE                                           087273
      *                                                                   087273
      **  Set up Settlement Date - by calculation                         087273
     C/COPY WNCPYSRC,CG4600C001
     C                     MOVE ISCY      FFCCY2                          087273
     C                     MOVE OTHC      FFCCY3                          087273
     C                     MOVE MTHN      FFMTH                           087273
     C                     MOVE YRNO      FFYR                            087273
     C                     MOVE SEDF      FFDATC                          087273
     C                     MOVE MLOC      FFLOC                           087273
     C                     EXSR FFDATE                                    087273
     C                     MOVELFFDAY     ##D,3                           087273
      *                                                                   087273
      **  Set up Final Transaction Date - by calculation                  087273
     C/COPY WNCPYSRC,CG4600C002
     C                     MOVE FTDF      FFDATC                          087273
     C                     EXSR FFDATE                                    087273
     C/COPY WNCPYSRC,CG4600C003
     C                     MOVE FFDAY     ##D,7                           087273
     C/COPY WNCPYSRC,CG4600C004
      *                                                                   087273
      **  Set up Market                                                   087273
     C                     MOVELMRKT      ##D,8                           087273
      *                                                                   087273
      **  Set up Market Name                                              087273
     C                     MOVELMKTN      ##D,9                           087273
      *                                                                   087273
     C                     ENDIF                                          087273
      *
      **  Set up Instrument Currency
      *
     C                     MOVELISCY      ##D,4
      *                                                                   087273
      **  Set up Instrument Processing Type                               087273
     C                     MOVELISPT      ##D,5                           087273
      *                                                                   087273
      **  Set up Transaction Date                                         087273
     C                     MOVELTRSD      ##D,6                           087273
      *                                                                   087273
      **  Set up Premium Up Front Flag                                    087273
     C                     MOVELPUPF      ##D,10                          087273
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_TRAN                                         *
      * Function    :  Transaction Details                            *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#TRAN    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#TRAN'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_TRAN' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_TRAN'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Transaction Reference Number
      *
     C                     MOVELTNBR      ##D,1
      *
      ** Transaction number may be negative (for trades at maturity)
      *
     C           TNBR      IFGT *ZERO                      B1
     C                     MOVEL*BLANKS   ##D,2             1
     C                     ELSE                            X1
      *
      **  Set up Maturity Indicator
      *
     C                     Z-SUBTNBR      TNBRN   60                      098117
     C                     MOVEL*BLANKS   ##D,1                           098117
     C                     MOVELTNBRN     ##D,1                           098117
     C                     MOVEL'M'       ##D,2             1
     C                     ENDIF                           E1
      *
      **  Set up Transaction/Type
      *
     C                     MOVELTRTY      ##D,3
      *
      **  Set up Contract Price
      *
     C******************** MOVE *BLANKS   R#DATA                          SPLFIX
     C******************** Z-ADDCOPR      ##NUMB                          SPLFIX
     C******************** Z-ADDMNPF      ##MNPF                          SPLFIX
     C******************** Z-ADDTKDM      ##TKDM                          SPLFIX
     C******************** MOVE R#DATA    ##D,4                           SPLFIX
     C**********           MOVELCOPR      ##D,4                     SPLFIX087273
     C***********          MOVELCOPR      ##WK11 110                087273CFF004
     C/COPY WNCPYSRC,CG4600C007
     C                     MOVELCOPR      ##WK11 150                      CFF004
     C/COPY WNCPYSRC,CG4600C008
      *                                                                   SPLFIX
      ** Call SRNDPS to work out number of decimal places                 SPLFIX
     C                     Z-ADDTKDM      Z#TKDM                          SPLFIX
     C                     Z-ADDMNPF      Z#MNPF                          SPLFIX
     C                     EXSR SRNDPS                                    SPLFIX
     C                     MOVE Z#NDPS    ##D,4                           SPLFIX
     C*                                                                   087273
     C/COPY WNCPYSRC,CG4600C009
     C***********7         SUB  Z#NDPS    ##WK01  10                087273CFF004
     C/COPY WNCPYSRC,CG4600C010
     C           8         SUB  Z#NDPS    ##WK01  10                      CFF004
     C                     DO   ##WK01                                    087273
     C                     DIV  10        ##WK11                          087273
     C                     ENDDO                                          087273
     C                     MOVEL##WK11    ##D,4                           087273
      *                                                                   SPLFIX
      ** If ticks denominator is not 100 change default amount format     SPLFIX
      ** code from 'L' to 'T' (for ticks).                                SPLFIX
     C           TKDM      IFNE 100                                       SPLFIX
     C           'L':'T'   XLATE##R,4:12  ##R,4                           SPLFIX
     C                     ENDIF                                          SPLFIX
      *                                                                   SPLFIX
      ** Set up ticks denominator RDE                                     SPLFIX
     C                     MOVELTKDM      ##D,5                           SPLFIX
     C                     MOVE '0'       ##D,5                           SPLFIX
      *                                                                   SPLFIX
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  If the Portfolio Management Module is 'ON'                      S71062
      *                                                                   S71062
     C           BGPFMG    IFEQ 'Y'                                       S71062
     C           BGN4ST    OREQ 'Y'                                       CPB001
     C                     MOVELPTFR      ##D,6                           S71062
     C                     ENDIF                                          S71062
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_TRND                                         *
      * Function    :  Position Change Date                           *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#TRND    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#TRND'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_TRND' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_TRND'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Position Change Date
      *
     C                     MOVELPOCD      ##D,1
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_COND                                         *
      * Function    :  Total Contracts                                *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#COND    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#COND'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_COND' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_COND'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Total Contracts
      *
     C                     MOVELTOCN      ##D,1
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_AMNC                                         *
      * Function    :  Total Contingent Amount                        *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#AMNC    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#AMNC'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_AMNC' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_AMNC'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     EXSR SRTOTC
      *
      **  Set up Total Contingent Amount
      *
     C                     MOVEL##TCAM    ##D,1
     C           ISPT      IFEQ 2                          B1
     C           ISPT      OREQ 5                           1
     C                     MOVE ##OTDP    ##D,1             1
     C                     ELSE                            X1
     C                     MOVE ##ISDP    ##D,1             1
     C                     ENDIF                           E1
      *                                                                   CFF003
      **  Set up Total Contingent Amount Currency (for Options only)      CFF003
      *                                                                   CFF003
     C           ISPT      IFEQ 2                                         CFF003
     C           ISPT      OREQ 5                                         CFF003
     C                     MOVELOTHC      ##D,2                           CFF003
     C                     ENDIF                                          CFF003
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_AMNP                                         *
      * Function    :  Premium/Profit                                 *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#AMNP    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#AMNP'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_AMNP' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_AMNP'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Total Profit
      *
     C                     MOVELTOPR      ##D,1
     C                     MOVE ##ISDP    ##D,1
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_AMNF                                         *
      * Function    :  Commission/Charges                             *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#AMNF    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#AMNF'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_AMNF' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_AMNF'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Total Commission
      *
     C                     MOVELTOCM      ##D,1
     C                     MOVE ##ISDP    ##D,1
      *
      **  Set up Total Charges
      *
     C                     MOVELTOCG      ##D,2
     C                     MOVE ##ISDP    ##D,2
      *                                                                   087273
      **  Set up Total Charges and Commission                             087273
     C           TOCM      ADD  TOCG      W@150  150                      087273
     C                     MOVELW@150     ##D,3                           087273
     C                     MOVE ##ISDP    ##D,3                           087273
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG4600CCP2                                           S01408
     C*                                                                   S01408
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_AMNV                                         *
      * Function    :  Total Value Of Contracts                       *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#AMNV    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#AMNV'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_AMNV' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_AMNV'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Total Value of contracts
      *
     C                     MOVEL##TCNT    ##D,1
     C                     MOVE ##ISDP    ##D,1
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_INSO                                         *
      * Function    :  Instrument Other Currency                      *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#INSO    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#INSO'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_INSO' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_INSO'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Other Currency
      **  (with Counter Currency for options, processing types 4,5 or 6)  CFF003
      *
     C           ISPT      IFGE 4                                         CFF003
     C           ISPT      ORLE 6                                         CFF003
     C                     MOVELCTCY      ##D,1                           CFF003
     C                     ELSE                                           CFF003
     C                     MOVELOTHC      ##D,1
     C                     ENDIF                                          CFF003
      *                                                                   CFF003
      **  Set up Other Amount (for Options only)                          CFF003
      *                                                                   CFF003
     C           ISPT      IFEQ 2                                         CFF003
     C           ISPT      OREQ 5                                         CFF003
     C                     MOVELCCAM      ##D,2                           CFF003
     C                     MOVE ##CCDP    ##D,2                           CFF003
     C                     ELSE                                           CFF003
     C                     MOVE *BLANKS   ##D,2                           CFF003
     C                     ENDIF                                          CFF003
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_CNFP                                         *
      * Function    :  Put/Call/ Strike Price                         *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#CNFP    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#CNFP'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_CNFP' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_CNFP'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Put/Call indicator
      *
     C                     MOVELPCAL      ##D,1
      *
      **  Set up Strike Price
      *
     C******************** MOVE *BLANKS   R#DATA                          SPLFIX
     C******************** Z-ADDSTRP      ##NUMB                          SPLFIX
     C******************** Z-ADDMNPF      ##MNPF                          SPLFIX
     C******************** Z-ADDTKDM      ##TKDM                          SPLFIX
     C******************** MOVE R#DATA    ##D,2                           SPLFIX
     C******************** MOVELSTRP      ##D,2                     SPLFIX087273
     C                     MOVELSTRP      ##WK11                          087273
      *                                                                   SPLFIX
      ** Call SRNDPS to work out number of decimal places                 SPLFIX
     C                     Z-ADDTKDM      Z#TKDM                          SPLFIX
     C                     Z-ADDMNPF      Z#MNPF                          SPLFIX
     C                     EXSR SRNDPS                                    SPLFIX
     C                     MOVE Z#NDPS    ##D,2                           SPLFIX
      *                                                                   087273
     C/COPY WNCPYSRC,CG4600C011
     C***********7         SUB  Z#NDPS    ##WK01  10                087273CFF004
     C/COPY WNCPYSRC,CG4600C012
     C           8         SUB  Z#NDPS    ##WK01                          CFF004
     C                     DO   ##WK01                                    087273
     C                     DIV  10        ##WK11                          087273
     C                     ENDDO                                          087273
     C                     MOVEL##WK11    ##D,2                           087273
      *                                                                   SPLFIX
      ** If ticks denominator is not 100 change default amount format     SPLFIX
      ** code from 'L' to 'T' (for ticks).                                SPLFIX
     C           TKDM      IFNE 100                                       SPLFIX
     C           'L':'T'   XLATE##R,2:12  ##R,2                           SPLFIX
     C                     ENDIF                                          SPLFIX
      *                                                                   SPLFIX
      ** Set up ticks denominator RDE                                     SPLFIX
     C                     MOVELTKDM      ##D,3                           SPLFIX
     C                     MOVE '0'       ##D,3                           SPLFIX
      *                                                                   SPLFIX
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_CNFT                                         *
      * Function    :  American/European/Underlying Trans. Type       *
      *                                                               *
      * Called by   :  F#OTC* - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#CNFT    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#CNFT'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_CNFT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_CNFT'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up American/European indicator
      *
     C           AEIN      IFEQ 'E'                        B1
     C                     MOVELAEIN      ##D,1             1
     C                     ELSE                            X1
     C                     MOVEL'A'       ##D,1             1
     C                     ENDIF                           E1
      *
      **  Set up Underlying transaction type
      *
     C                     MOVELULTT      ##D,2
      *                                                                   087273
      **  Set up Underlying Instrument                                    087273
     C                     MOVELUISTT     ##D,3                           087273
      *                                                                   087273
      **  Set up Underlying Instrument Name                               087273
     C                     MOVELUISTN     ##D,4                           087273
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_TOTS                                         *
      * Function    :  Totals (Simple)                                *
      *                                                               *
      * Called by   :  FOTCST - Top level group set                   *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#TOTS    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#TOTS'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_TOTS' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_TOTS'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up Total of all amounts
      *
     C           TOCM      ADD  TOCG      ##TAMT
     C           ISPT      IFEQ 4                          B1
     C           ISPT      OREQ 5                           1
     C           ISPT      OREQ 6                           1
     C                     ADD  TOPR      ##TAMT            1
     C                     ENDIF                           E1
      *
     C                     MOVEL##TAMT    ##D,1
     C                     MOVE ##ISDP    ##D,1
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG4600CCP3                                           S01408
     C*                                                                   S01408
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  F_SETL                                         *
      * Function    :  Settlement Details                             *
      *                                                               *
      * Called by   :  SRRMDR - Common Group Set Routine              *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           F#SETL    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#SETL'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_SETL' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_SETL'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********##ISCY    IFNE ISCY                       B1             097955
     C                     MOVE BRCA      FFBRCA            1             S01117
     C**********           Z-ADDCBCD      FFCBCD            1                                 CSD027
     C                     MOVE CBCD      FFCBCD            1                                 CSD027
     C                     MOVE 'N'       FFBRKI            1
     C                     Z-ADDSETP      FFSETP            1
      *                                                                   S01117
     C           SEBR      IFNE *BLANK                     B2             S01117
     C                     MOVE SEBR      FFSETB            2             S01117
     C                     ELSE                            X2             S01117
     C                     MOVE SBID      FFSETB            2             S01117
     C                     END                             E2             S01117
      *                                                                   S01117
     C                     MOVE SETA      FFSETA            1
     C                     MOVE ISCY      FFCCY             1
      *                                                                   097955
     C**********           CALL 'AOBRCHR0'                                             097955 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD                          097955
     C                     PARM '*KEY    '##OPTN                          097955
     C                     PARM BRCA      ##BRCD                          097955
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        097955 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
     C                     EXSR FFSETL                      1
      *
     C                     MOVE ISCY      ##ISCY            1
     C***********          END                             E1             097955
      *
      **  Set up Settlement Account
      *
B1   C********** FFCNUM    IFEQ 0                                                      097955 CSD027
B1   C           FFCNUM    IFEQ *BLANKS                                                       CSD027
     C           TNBR      CHAINTRSET1               10                   097955
B2   C           *IN10     IFEQ '0'                                       097955
B3   C           CSLT      IFNE 0                                         097955
     C                     Z-ADDCSLT      FFSETP                          097955
     C                     MOVELCSLA      FFSETA                          097955
B4   C           BRSC      IFNE *BLANK                                    097955
     C                     MOVELBRSC      FFSETB                          097955
X4   C                     ELSE                                           097955
     C                     MOVELCBID      FFSETB                          097955
E4   C                     END                                            097955
     C                     EXSR FFSETL                                    097955
E3   C                     END                                            097955
B3   C********** FFCNUM    IFEQ 0                                                      097955 CSD027
B3   C           FFCNUM    IFEQ *BLANKS                                                       CSD027
     C           BSLT      ANDNE0                                         097955
     C                     Z-ADDBSLT      FFSETP                          097955
     C                     MOVELBSLA      FFSETA                          097955
B4   C           BSBR      IFNE *BLANK                                    097955
     C                     MOVELBSBR      FFSETB                          097955
X4   C                     ELSE                                           097955
     C                     MOVELBBID      FFSETB                          097955
E4   C                     END                                            097955
     C                     EXSR FFSETL                                    097955
E3   C                     END                                            097955
E2   C                     END                                            097955
E1   C                     END                                            097955
     C*                                                                   097955
     C********** FFCNUM    IFNE 0                                                      097955 CSD027
     C           FFCNUM    IFNE *BLANKS                                                       CSD027
     C***************      MOVE FFBRCA    ##SABR                          097955
     C                     MOVE FFBRCB    ##SABR                          097955
     C                     MOVE FFCNUM    ##SACU
     C                     MOVE ISCY      ##SACY
     C                     MOVE FFACOD    ##SACO
     C                     MOVE FFACSQ    ##SACS
     C                     MOVEL##ACNT    ##D,1
     C/COPY WNCPYSRC,CG4600C005
     C                     ELSE                                           097955
     C                     MOVEL*BLANKS   ##D,1                           097955
     C/COPY WNCPYSRC,CG4600C006
     C                     ENDIF                                          097955
      *
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG4600CCP1                                           S01408
     C*                                                                   S01408
      **  Set up Transaction Narrative
      *
     C                     MOVELTNAR      ##D,2
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  CUST                                           *
      * Function    :  Customer Details (Simple)                      *
      *                - Obtain Customer Details                      *
      *                                                               *
      * Called by   :  SRRMDR - Common Group Set Routine              *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           CUST      BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'CUST  '  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\CUST  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'CUST  '  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Access Customer Details if the Customer has changed.
      **  (LF/SDCUSTL1)
      *
     C           ##NBRK    IFEQ 'Y'                        B1
      *
      ** If correspondence address not blank, access CLINT for
      ** alternate name/address
      *
     C           BHCOAD    IFNE *BLANK                     B2
     C                     MOVE BHCOAD    ##TYPE            2
     C           ##CLNT    CHAINCLINT                50     2
     C                     ENDIF                           E2
      *
      ** If record not found or correspondence address is blank,
      ** access CLINT for name/address
      *
     C           *IN50     IFEQ *ON                        B2
     C           RECI      ORNE 'D'                         2
     C           BHCOAD    OREQ *BLANK                      2
      *
     C                     MOVE 'B'       ##TYPE            2
     C           ##CLNT    CHAINCLINT                50     2
      *
      **  If not found, Database Error.
      *
     C           *IN50     IFEQ *ON                        B3
     C           RECI      ORNE 'D'                         3
     C                     MOVEL'CLINT   'W0FILE            3
     C                     MOVEL##CBCD    W0KEY            ***************
     C                     Z-ADD05        W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            3
     C                     EXSR SRERR                       3
     C                     ENDIF                           E3
     C                     ENDIF                           E2
     C                     ENDIF                           E1
      *
      **  Set up Customer Number
      *
     C/COPY WNCPYSRC,CG4600C015
     C                     MOVELCNUM      ##D,1
     C/COPY WNCPYSRC,CG4600C016
      *
      **  Set up Customer Address Line 1
      *
     C                     MOVELCNA1      ##D,3
      *
      **  Set up Customer Address Line 2
      *
     C                     MOVELCNA2      ##D,4
      *
      **  Set up Customer Address Line 3
      *
     C                     MOVELCNA3      ##D,5
      *
      **  Set up Customer Address Line 4
      *
     C                     MOVELCNA4      ##D,6
      *                                                                   086918
      ** Customer Town                                                    086918
     C                     MOVELCTWN      ##D,7                           086918
      *
     C           ##NBRK    IFEQ 'Y'                        B1
     C                     MOVE 'A'       ##TYPE            1
     C           ##CLNT    CHAINCLINT                50     1
      *
      **  If not found, Database Error.
      *
     C           *IN50     IFEQ *ON                        B2
     C           RECI      ORNE 'D'                         2
     C                     MOVEL'CLINT   'W0FILE            2
     C                     MOVEL##CBCD    W0KEY            ***************
     C                     Z-ADD05        W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ENDIF                           E2
     C                     ENDIF                           E1
      *
      **  Set up Customer Name
      *
     C                     MOVELCRNM      ##D,2
      *
      **  Set up First/Subsequent/Last Indicator
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT                                                              089776
      *****************************************************************   089776
      * Subroutine  :  ACOF                                           *   089776
      * Function    :  Account Officer Details                        *   089776
      *                                                               *   089776
      * Called by   :  SRRMDR - Common Group Set Routine              *   089776
      * Calls       :  SRRRDE - Retrieve RDE Information              *   089776
      *                SRADTA - Format Extract Data                   *   089776
      *                SRODTA - Output Extract Data                   *   089776
      *                SRERR  - Database Error                        *   089776
      *****************************************************************   089776
     C           ACOF      BEGSR                                          089776
      *                                                                   089776
      **  Set up subroutine stack name                                    089776
      *                                                                   089776
     C                     ADD  1         Q                               089776
     C                     MOVEL'ACOF  '  @STK,Q                          089776
      *                                                                   089776
      **  Retrieve subroutine specific data.                              089776
      *                                                                   089776
     C                     ADD  1         ##OCUR                          089776
     C           ##OCUR    OCUR ##SRDT                                    089776
      *                                                                   089776
      **  Set up Path.                                                    089776
      *                                                                   089776
     C                     MOVEL'\ACOF  ' ##PNAM                          089776
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          089776
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT                          089776
      *................................................................   089776
      *                                                                   089776
      **  Retrieve RDE information for RDE's in Group Set                 089776
      *                                                                   089776
     C                     MOVEL'ACOF  '  ##GRPS                          089776
     C                     Z-ADD1         ##RDEN                          089776
     C                     EXSR SRRRDE                                    089776
      *                                                                   089776
      **  Do not process if Account Officer blank.                        089776
     C           ACOC      IFEQ *BLANKS                                   089776
     C                     GOTO EXACOF                                    089776
     C                     ENDIF                                          089776
      *                                                                   089776
      **  Account Officer details                                         089776
     C           ACOC      CHAINSDACOFL0             50                   089776
      *                                                                   089776
      **  Account Officer details not found                               089776
     C           *IN50     IFEQ '1'                                       089776
     C                     GOTO EXACOF                                    089776
     C                     END                                            089776
      *                                                                   089776
      **  Account Officer Code                                            089776
     C                     MOVELAZACOC    ##D,1                           089776
      *                                                                   089776
      **  Account Officer Dept                                            089776
     C                     MOVELAZDPCD    ##D,2                           089776
      *                                                                   089776
      **  Account Officer Name                                            089776
     C                     MOVELAZACON    ##D,3                           089776
      *                                                                   089776
      **  Account Officer Telephone Number                                089776
     C                     MOVELAZAPHN    ##D,4                           089776
      *                                                                   089776
      **  Account Officer Telephone Extension                             089776
     C                     MOVELAZAEXT    ##D,5                           089776
      *                                                                   089776
      **  Set up First/Subsequent/Last Indicator                          089776
     C                     MOVE 'FR'      ##FSLI                          089776
      *                                                                   089776
      **  Accumulate RDE's and associated data and output to              089776
      **  PF/CGUDTAPD.                                                    089776
     C                     EXSR SRADTA                                    089776
     C                     EXSR SRODTA                                    089776
      *                                                                   089776
      *................................................................   089776
      *                                                                   089776
      **  Unwind subroutine stack name                                    089776
      *                                                                   089776
     C           EXACOF    TAG                                            089776
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q                          089776
     C                     SUB  1         Q                               089776
      *                                                                   089776
     C                     ENDSR                                          089776
      *****************************************************************   089776
      /EJECT
      *****************************************************************
      * Subroutine  :  F_ATTN                                         *
      * Function    :  For the attention of                           *
      *                                                               *
      * Called by   :  SRRMDR - Common Group Set Routine              *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *****************************************************************
     C           F#ATTN    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'F#ATTN'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\F_ATTN' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'F_ATTN'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Set up For the attention of
      *
     C                     MOVELBHFTAO    ##D,1
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details (Simple)                        *
      *                - Obtain Branch Details                        *
      *                                                               *
      * Called by   :  SRRMDR - Common Group Set Routine              *
      * Calls       :  SRRRDE - Retrieve RDE Information              *
      *                SRADTA - Format Extract Data                   *
      *                SRODTA - Output Extract Data                   *
      *                AOBRCHR0 - Obtain Branch Details               *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      **  Retrieve subroutine specific data.
      *
     C                     ADD  1         ##OCUR
     C           ##OCUR    OCUR ##SRDT
      *
      **  Set up Path.
      *
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
      ** Write a record (push order) in PF/CGUXMGPD                                           CCG015
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     MOVELS#PATH    ##SPAT
      *................................................................
      *
      **  Retrieve RDE information for RDE's in Group Set
      *
     C                     MOVEL'BRANCH'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Get Branch Details if the Branch has changed
      *
     C           BRCA      IFNE ##BRCD
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      **  Database Error
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD04        W0ERNB           * DB ERROR 04 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     MOVE 'Y'       ##NWBR
     C                     ENDIF
      *
      **  Set up Branch Code
      *
     C                     MOVELA8BRCD    ##D,1
      *
      **  Set up Branch Name
      *
     C                     MOVELA8BRNM    ##D,2
      *
      **  Set up First/Subsequent/Last Indicator
      *
     C                     MOVE 'FR'      ##FSLI
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
      *
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
      ** Write a record (pop order) in PF/CGUXMGPD                                            CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  SRFILA                                         *
      * Function    :  Access necessary files                         *
      *                                                               *
      * Called by   :  FOTCST - Top level group set                   *
      * Calls       :                                                 *
      *****************************************************************
     C           SRFILA    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRFILA'  @STK,Q
      *
      **  Call access program for Instrument Type Details
      *
     C           ISTT      IFNE ##ISTT                     B1
     C                     CALL 'AOFFITR0'                  1             S10736
     C                     PARM *BLANKS   ##RTCD           B:Return Cd    S10736
     C                     PARM '*KEY'    ##OPTN  7        I:Option       S10736
     C                     PARM ISTT      ##ISTT           I:Instr. Type  S10736
     C           SDINTY    PARM *BLANK    DSFDY            O:Format       S10736
      *                                                                   S10736
     C           ##RTCD    IFNE *BLANKS                    B2
     C           ##RIIT    ORNE 'D'                         2
     C                     MOVEL'INTYP   'W0FILE            2
     C                     MOVE *BLANKS   W0KEY             2
     C                     MOVEL##ISTT    W0KEY            ***************
     C                     Z-ADD01        W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ENDIF                           E2
      *                                                                   087273
      **  If the Instrument is an Option (ISPT = 4, 5 or 6) and is not    087273
      **  an OTC (ISTI = N), access the details for the Underlying        087273
      **  Instrument.                                                     087273
     C           ISPT      IFGE 4                                         087273
     C           ISPT      ANDLE6                                         087273
     C           ISTI      ANDEQ'N'                                       087273
     C                     MOVE ISTT      UISTT                           087273
     C                     MOVE FTRF      UISTT                           087273
      *                                                                   087273
     C                     CALL 'AOFFITR0'                                087273
     C                     PARM *BLANKS   ##RTCD           B:Return Cd    087273
     C                     PARM '*KEY'    ##OPTN  7        I:Option       087273
     C                     PARM           UISTT            I:Instr. Type  087273
     C           SDINTY    PARM *BLANK    DSFDY            O:Format       087273
      *                                                                   087273
     C           ##RTCD    IFNE *BLANKS                                   087273
     C           ##RIIT    ORNE 'D'                                       087273
     C                     MOVEL'INTYP   'W0FILE                          087273
     C                     MOVE *BLANKS   W0KEY                           087273
     C                     MOVELUISTT     W0KEY            ***************087273
     C                     Z-ADD09        W0ERNB           * DB ERROR 09 *087273
     C                     MOVEL'MEM5004' W0MSGD           ***************087273
     C                     MOVEL'MIDAS  ' W0MSGF                          087273
     C                     EXSR SRERR                                     087273
     C                     ENDIF                                          087273
      *                                                                   087273
      **  Save the Underlying Instrument Name                             087273
     C                     MOVE ISTN      UISTN                           087273
     C                     ENDIF                                          087273
      *                                                                   087273
      **  Re-access the original Instrument details                       087273
     C                     CALL 'AOFFITR0'                  1             087273
     C                     PARM *BLANKS   ##RTCD           B:Return Cd    087273
     C                     PARM '*KEY'    ##OPTN  7        I:Option       087273
     C                     PARM ISTT      ##ISTT           I:Instr. Type  087273
     C           SDINTY    PARM *BLANK    DSFDY            O:Format       087273
      *                                                                   087273
     C           ##RTCD    IFNE *BLANKS                    B2             087273
     C           ##RIIT    ORNE 'D'                         2             087273
     C                     MOVEL'INTYP   'W0FILE            2             087273
     C                     MOVE *BLANKS   W0KEY             2             087273
     C                     MOVEL##ISTT    W0KEY            ***************087273
     C                     Z-ADD10        W0ERNB           * DB ERROR 10 *087273
     C                     MOVEL'MEM5004' W0MSGD           ***************087273
     C                     MOVEL'MIDAS  ' W0MSGF            2             087273
     C                     EXSR SRERR                       2             087273
     C                     ENDIF                           E2             087273
      *                                                                   087273
      **  Access the Market File if not an OTC                            087273
     C           ISTI      IFEQ 'N'                        B2             087273
     C                     MOVELISTT      MRKT              2             087273
     C           MRKT      CHAINMARKT                50     2             087273
     C           *IN50     IFEQ *ON                        B3             087273
     C           RECI      ORNE 'D'                         3             087273
     C                     MOVEL'MARKT'   W0FILE            3             087273
     C                     MOVE *BLANKS   W0KEY             3             087273
     C                     MOVELMRKT      W0KEY            ***************087273
     C                     Z-ADD11        W0ERNB           * DB ERROR 11 *087273
     C                     MOVEL'MEM5004' W0MSGD           ***************087273
     C                     MOVEL'MIDAS  ' W0MSGF            3             087273
     C                     EXSR SRERR                       3             087273
     C                     ENDIF                           E3             087273
     C                     ENDIF                           E2             087273
      *                                                                   087273
     C                     ENDIF                           E1
      *
      **  Call access program for Customer Broker Code Details
      *
     C           ##CBCH    IFNE ##CBCD                     B1
     C                     CALL 'AOFOCSR0'                  1
     C                     PARM *BLANK    ##RTCD            1
     C                     PARM '*KEY   ' ##OPTN            1
     C                     PARM ##CBCH    ##CBCD            1
     C           SDFOCS    PARM SDFOCS    DSFDY             1
     C           ##RTCD    IFNE *BLANKS                    B2
     C                     MOVEL'SDFOCSPD'W0FILE            2
     C                     MOVE *BLANKS   W0KEY             2
     C                     MOVEL##CBCD    W0KEY            ***************
     C                     Z-ADD02        W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ENDIF                           E2
     C                     MOVE 'Y'       ##NBRK
     C                     ENDIF                           E1
      *
      ** Access the transaction involved off TRANS2
      *
     C           TNBR      IFNE ##TNBR                     B1
     C           TNBR      CHAINTRANS2               50     1
     C           *IN50     IFEQ *ON                        B2
     C***********RECI      ORNE 'D'                         2             090308
     C                     MOVEL'TRANS2  'W0FILE            2
     C                     MOVE *BLANKS   W0KEY             2
     C                     MOVE TNBR      ##TBRC            2
     C***********          MOVEL##TNBR    W0KEY            ***************090308
     C                     MOVEL##TBRC    W0KEY            ***************090308
     C                     Z-ADD03        W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ELSE                            X2
     C                     Z-ADDTNBR      ##TNBR            2
      *                                                                   098117
      * Ensure reversal ind. is correct                                   098117
      *                                                                   098117
     C           REVI      IFEQ 0                                         098117
     C           RECI      ANDEQ'R'                                       098117
     C           REVI      OREQ 0                                         098117
     C           RECI      ANDEQ'*'                                       098117
     C                     Z-ADD1         REVI                            098117
     C                     ENDIF                                          098117
      *                                                                   098117
     C                     ENDIF                           E2
     C                     ENDIF                           E1
      *
      ** Access currency file for decimal places
      *
     C                     MOVE ISCY      ##CCY
     C                     EXSR SRDCDP
     C                     Z-ADDA6NBDP    ##ISDP
     C           OTHC      IFNE *BLANKS                    B1
     C           ISPT      IFEQ 2                                         CFF003
     C           ISPT      OREQ 5                                         CFF003
     C                     MOVE OTHC      ##CCY                           CFF003
     C                     ELSE                                           CFF003
     C                     MOVE ISCY      ##CCY             1
     C                     ENDIF                                          CFF003
     C                     EXSR SRDCDP                      1
     C                     Z-ADDA6NBDP    ##OTDP            1
     C                     ELSE                            X1
     C                     Z-ADD0         ##OTDP            1
     C                     ENDIF                           E1
      ** Access currency file for decimal places (for Counter Ccy)        CFF003
      *                                                                   CFF003
     C                     MOVE CTCY      ##CCY                           CFF003
     C                     EXSR SRDCDP                                    CFF003
     C                     Z-ADDA6NBDP    ##CCDP                          CFF003
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  SRDCDP                                         *
      * Function    :  No of dec places in currency                   *
      *                                                               *
      * Called by   :  XXXXXX                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRDCDP    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRDCDP'  @STK,Q
      *
      **  Access array of Currency Details already loaded
      *
     C                     Z-ADD1         C       30
     C           ##CCY     LOKUP##CY,C                   99
      *
      **  If no match is found determine the next free space in the
      **  loaded currency array.
     C           *IN99     IFEQ *OFF                       B1
     C                     Z-ADD1         C                 1
     C           *BLANK    LOKUP##CY,C                   99 1
      *
      **  If no space is left, set the Currency Data data structure to
      **  the 101st occurrence so that when the new details are
      **  retrieved no existing details are overwritten.
     C           *IN99     IFEQ *OFF                       B2
     C           101       OCUR SDCURR                      2
      *
      **  If a space is found, set up the new currency into the array
      **  and position the Currency Data data structure on the
      **  occurrence matching the array index.
      *
     C                     ELSE                            X2
     C                     MOVE ##CCY     ##CY,C            2
     C           C         OCUR SDCURR                      2
     C                     ENDIF                           E2
      *
      **  Retrieve the currency details.
      *
     C                     CALL 'AOCURRR0'                  1
     C                     PARM *BLANKS   ##RTCD           B:Return Cd
     C                     PARM '*KEY'    ##OPTN           I:Option
     C                     PARM ##CCY     ##CCYP  3        I:Currency Code
     C           SDCURR    PARM *BLANK    DSSDY            O:Format
      *
      **  Database Error
      *
     C           ##RTCD    IFNE *BLANK                     B2
     C                     MOVEL'SDCURRPD'W0FILE            2
     C                     MOVEL##CCY     W0KEY            ***************
     C                     Z-ADD06        W0ERNB           * DB ERROR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF            2
     C                     EXSR SRERR                       2
     C                     ENDIF                           E2
      *
      **  If the currency has been retrieved earlier, position the
      **  Currency Data data structure on the relevant occurrence.
      *
     C                     ELSE                            X1
     C           C         OCUR SDCURR                      1
     C                     ENDIF                           E1
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  SRTOTC                                         *
      * Function    :  Total Contingent Amount                        *
      *                                                               *
      * Called by   :  XXXXXX                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRTOTC    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q       50
     C                     MOVEL'SRTOTC'  @STK,Q
      *
      ** Total Contingent amount = contingent amount * no. of contracts
      *
     C           CTAM      MULT TOCN      ##TCAM
      *
      ** Total Contingent amount * price * 10pwr quotation
      **               convention  *10pwr rate conversion factor
      *
     C           ISPT      IFEQ 2                          B1
     C           ISPT      OREQ 5                           1
      *
     C           ISPT      IFEQ 2                          B2
     C           ##TCAM    MULT COPR      ##TCNT            2
     C                     ENDIF                           E2
      *
     C           ISPT      IFEQ 5                          B2
     C           ##TCAM    MULT STRP      ##TCNT            2
     C                     ENDIF                           E2
      *
     C           QOTC      IFGT 0                          B2
     C                     DO   QOTC                       B3
     C           ##TCNT    MULT 10        ##TCNT            3
     C                     ENDDO                           E3
     C                     ENDIF                           E2
      *
     C           QOTC      IFLT 0                          B2
     C                     Z-SUBQOTC      ##QOTC            2
     C                     DO   ##QOTC                     B3
     C           ##TCNT    DIV  10        ##TCNT            3
     C                     ENDDO                           E3
     C                     ENDIF                           E2
      *
     C           ##ISDP    SUB  ##OTDP    ##RCNF
      *
     C           ##RCNF    IFGT 0                          B2
     C                     DO   ##RCNF                     B3
     C           ##TCNT    MULT 10        ##TCNT            3
     C                     ENDDO                           E3
     C                     ENDIF                           E2
      *
     C           ##RCNF    IFLT 0                          B2
     C                     Z-SUB##RCNF    ##RCNF            2
     C                     DO   ##RCNF                     B3
     C           ##TCNT    DIV  10        ##TCNT            3
     C                     ENDDO                           E3
     C                     ENDIF                           E2
     C                     ENDIF                           E1
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************   SPLFIX
      * Subroutine  :  SRNDPS                                         *   SPLFIX
      * Function    :  Caluclate number of 'decimal places' for tick  *   SPLFIX
      *                based prices                                   *   SPLFIX
      *                                                               *   SPLFIX
      * Called by   :  F#TRAN                                         *   SPLFIX
      * Calls       :  None                                           *   SPLFIX
      *****************************************************************   SPLFIX
      *
     C           SRNDPS    BEGSR                                          SPLFIX
      *                                                                   SPLFIX
      ** Set up subroutine stack name                                     SPLFIX
     C                     ADD  1         Q                               SPLFIX
     C                     MOVEL'SRNDPS'  @STK,Q                          SPLFIX
      *                                                                   SPLFIX
      ** Set up input fields                                              SPLFIX
     C           *LIKE     DEFN TKDM      Z#TKDM
     C           *LIKE     DEFN MNPF      Z#MNPF
     C                     Z-ADD0         Z#NDPS  10                      SPLFIX
      *                                                                   SPLFIX
      ** If ticks denominator is not 100, calculate number of d.p.s       SPLFIX
      ** from number of signicant digits.
     C           Z#TKDM    IFNE 100
     C           Z#TKDM    IFLE 10                                        SPLFIX
     C                     Z-ADD1         Z#NDPS                          SPLFIX
     C                     ELSE                                           SPLFIX
     C           Z#TKDM    IFLE 100                                       SPLFIX
     C                     Z-ADD2         Z#NDPS                          SPLFIX
     C                     ELSE                                           SPLFIX
     C           Z#TKDM    IFLE 1000                                      SPLFIX
     C                     Z-ADD3         Z#NDPS                          SPLFIX
     C                     ENDIF                                          SPLFIX
     C                     ENDIF                                          SPLFIX
     C                     ENDIF                                          SPLFIX
     C                     ELSE
      *
      ** If ticks denominator IS 100, calculate number of d.p.s from
      ** minimum price fluctuation
     C/COPY WNCPYSRC,CG4600C013
     C***********          MOVE Z#MNPF    #WK7A   7                       CFF004
     C***********'0'       CHEKR#WK7A     Z#NDPS                          CFF004
     C/COPY WNCPYSRC,CG4600C014
     C                     MOVE Z#MNPF    #WK8A   8                       CFF004
     C           '0'       CHEKR#WK8A     Z#NDPS                          CFF004
     C                     ENDIF                                          SPLFIX
      *                                                                   SPLFIX
      ** Unwind subroutine stack name                                     SPLFIX
     C                     MOVEA*BLANKS   @STK,Q                          SPLFIX
     C                     SUB  1         Q                               SPLFIX
      *                                                                   SPLFIX
     C                     ENDSR                                          SPLFIX
      *****************************************************************   SPLFIX
      /EJECT
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
      *                                                                                       CCG015
      ** If enhancement CCG015 is installed, do not pack RDEs.                                CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 07 *
     C                     Z-ADD7         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
      ** Write a record in PF/CGUXMRPD                                                        CCG015
      *                                                                                       CCG015
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD##PBIN    DEPBIN
     C                     Z-ADD##TBIN    DETBIN
     C                     MOVE ##FSLI    DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      **  Set Flag to show record formatted
     C                     MOVE 'Y'       ##RFMT  1
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *                                                                                       CCG015
      ** If enhancement CCG015 is on, don't write to PF/CGUDTAPD.                             CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
      *
      **  Output PF/CGUDTAPD Record.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 08 *
     C                     Z-ADD8         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF                                                              CCG015
      *
      **  Reset Flag to show formatted data output.
     C                     MOVE *BLANKS   ##RFMT
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************   SPLFIX
      **Subroutine**:**SRADTA******************************************   SPLFIX
      **Function****:**Accumulate*RDEs*and*associated*data*for*output**   SPLFIX
      *****************************************************************   SPLFIX
      **Called*by***:**simple*group*set*subroutines********************   SPLFIX
      **Calls*******:**CG3999*-*Format*and*Pack*Data*******************   SPLFIX
      *****************SRERR**-*Database*Error*************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********SRADTA****BEGSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*up*subroutine*stack*name*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ADD**1*********Q****************************   SPLFIX
     C*********************MOVEL'SRADTA'**@STK,Q***********************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Reformat*RDE*data********************************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************EXSR*SRRFMN*********************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Pack*RDEs*and*associated*data*into*data*string***************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************CLEAR##SDS**********************************   SPLFIX
     C*********************CALL*'CG3999'*******************************   SPLFIX
     C*********************PARM**BLANK****##RTCD***********************   SPLFIX
     C*********************PARM*'*PACK***'W0ACT************************   SPLFIX
     C*********************PARM***********##R**************************   SPLFIX
     C*********************PARM***********##D**************************   SPLFIX
     C*********************PARM***********##S**************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Database*error***********************************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********##RTCD****IFNE**BLANK*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************MOVEL'CG3999**'W0FILE**************************SPLFIX
     C*********************MOVEL##RTCD****W0KEY**************DB*ERROR*08 *SPLFIX
     C*********************Z-ADD08********W0ERNB**************************SPLFIX
     C*********************MOVEL'MEM5003'*W0MSGD***********************   SPLFIX
     C*********************MOVEL'MIDAS**'*W0MSGF***********************   SPLFIX
     C*********************EXSR*SRERR**********************************   SPLFIX
     C*********************ENDIF***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Initialise*Write*Format*Parameter.***************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************CLEARW0FMT**********************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*up*Control*Information.**********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************Z-ADD##ITEM****DEITEM***********************   SPLFIX
     C*********************ADD**1*********##OSEQ***********************   SPLFIX
     C*********************Z-ADD##OSEQ****DEOSEQ***********************   SPLFIX
     C*********************Z-ADD1*********DEPBIN***********************   SPLFIX
     C*********************Z-ADD1*********DETBIN***********************   SPLFIX
     C*********************MOVE*##FSLI****DEFSLI***********************   SPLFIX
     C*********************MOVE**BLANKS***W0PATH***********************   SPLFIX
     C*********************MOVELS#PATH****W0PATH***********************   SPLFIX
      *****************************************************************   SPLFIX
      ****Append*Data*from*pack*routine.*******************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********W0FMT*****CAT**##SDS:0***W0FMT************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*Flag*to*show*record*formatted****************************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Unwind*subroutine*stack*name*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************MOVEA*BLANKS***@STK,Q***********************   SPLFIX
     C*********************SUB**1*********Q****************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ENDSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      *****************************************************************   SPLFIX
      **Subroutine**:**SRRFMN******************************************   SPLFIX
      **Function****:**Reformat*RDE*data*******************************   SPLFIX
      *****************************************************************   SPLFIX
      **Called*by***:**SRADTA******************************************   SPLFIX
      **Calls*******:**************************************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********SRRFMN****BEGSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*up*subroutine*stack*name*********************************   SPLFIX
     C*********************ADD**1*********Q****************************   SPLFIX
     C*********************MOVEL'SRRFMN'**@STK,Q***********************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ***Loop*through*RDE's*and*data***********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************Z-ADD0*********#1***************************   SPLFIX
     C***********#1********DOUEQ20*************************************   SPLFIX
     C*********************ADD**1*********#1***************************   SPLFIX
     C*********************MOVEL##R,#1****R#DEFN***********************   SPLFIX
     C*********************MOVEL##D,#1****R#DATA***********************   SPLFIX
      *****************************************************************   SPLFIX
      ***If*RDE*is*edited**********************************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********##RDEC****IFNE**BLANK*********************************   SPLFIX
     C***********##RDEC****ANDNE'Price*'*******************************   SPLFIX
      *****************************************************************   SPLFIX
      **Reformat*Amount************************************************   SPLFIX
     C*********************Z-ADD1*********#2***************************   SPLFIX
     C************BLANK****LOKUP##NUMA,#2****************99************   SPLFIX
     C*********************Z-ADD20********#3***************************   SPLFIX
     C*********************Z-ADD0*********##WNUM***********************   SPLFIX
     C***********#2********DOWGT1**************************************   SPLFIX
     C***********#2********ANDLE20*************************************   SPLFIX
     C***********#3********ANDGT1**************************************   SPLFIX
     C*********************SUB**1*********#2***************************   SPLFIX
     C*********************MOVEL##NUMA,#2*##W,#3***********************   SPLFIX
     C*********************SUB**1*********#3***************************   SPLFIX
     C*********************ENDDO***************************************   SPLFIX
     C*********************Z-ADD##WNUM****##NUMB***********************   SPLFIX
      *****************************************************************   SPLFIX
      **Default*Edit*Type**********************************************   SPLFIX
     C***********##EDTT****IFEQ**BLANK*********************************   SPLFIX
     C*********************MOVEL##RDET****##EDTT***********************   SPLFIX
     C*********************END*****************************************   SPLFIX
      *****************************************************************   SPLFIX
      **Default*Decimal*Places*****************************************   SPLFIX
     C***********##DCPA****IFEQ**BLANK*********************************   SPLFIX
     C*********************MOVEL##RDED****##DCPA***********************   SPLFIX
     C*********************END*****************************************   SPLFIX
      **New*RDE*data***************************************************   SPLFIX
     C*********************MOVELR#DATA****##D,#1***********************   SPLFIX
     C*********************ENDIF***************************************   SPLFIX
     C*********************ENDDO***************************************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Unwind*subroutine*stack*name*********************************   SPLFIX
     C*********************MOVEA*BLANKS***@STK,Q***********************   SPLFIX
     C*********************SUB**1*********Q****************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ENDSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      *****************************************************************   SPLFIX
      **Subroutine**:**SRODTA******************************************   SPLFIX
      **Function****:**Output*Accumulated*data*to*PF/CGUDTAPD**********   SPLFIX
      *****************************************************************   SPLFIX
      **Called*by***:**simple*group*set*subroutines********************   SPLFIX
      **Calls*******:**CG9020*-*Output*Data*to*CGUDTAPD****************   SPLFIX
      *****************SRERR**-*Database*Error*************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********SRODTA****BEGSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*up*subroutine*stack*name*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ADD**1*********Q****************************   SPLFIX
     C*********************MOVEL'SRODTA'**@STK,Q***********************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Output*PF/CGUDTAPD*Record.***********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************CALL*'CG9020'*******************************   SPLFIX
     C*********************PARM**BLANK****##RTCD***********************   SPLFIX
     C*********************PARM*'*WRITE**'W0ACT************************   SPLFIX
     C*********************PARM***********W0PATH256********************   SPLFIX
     C*********************PARM***********W0FMT************************   SPLFIX
     C*********************PARM**BLANK****W0TITL**7********************   SPLFIX
     C*********************PARM**BLANK****W0ULIN**7********************   SPLFIX
     C*********************PARM***********W0CMT************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Database*error***********************************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********##RTCD****IFNE**BLANK*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************MOVEL'CG9020**'W0FILE**************************SPLFIX
     C*********************MOVEL##RTCD****W0KEY**************DB*ERROR*09 *SPLFIX
     C*********************Z-ADD09********W0ERNB**************************SPLFIX
     C*********************MOVEL'MEM5003'*W0MSGD***********************   SPLFIX
     C*********************MOVEL'MIDAS**'*W0MSGF***********************   SPLFIX
     C*********************EXSR*SRERR**********************************   SPLFIX
     C*********************ENDIF***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Reset*Flag*to*show*formatted*data*output.********************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Unwind*subroutine*stack*name*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************MOVEA*BLANKS***@STK,Q***********************   SPLFIX
     C*********************SUB**1*********Q****************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ENDSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      *****************************************************************   SPLFIX
      **Subroutine**:**SRRRDE******************************************   SPLFIX
      **Function****:**Retrieve*RDE*information*for*RDEs*in*group*set**   SPLFIX
      *****************************************************************   SPLFIX
      **Called*by***:**simple*group*set*subroutines********************   SPLFIX
      **Calls*******:**-***********************************************   SPLFIX
      *****************************************************************   SPLFIX
     C***********SRRRDE****BEGSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Set*up*subroutine*stack*name*********************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ADD**1*********Q****************************   SPLFIX
     C*********************MOVEL'SRRRDE'**@STK,Q***********************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Reset********************************************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************MOVEL*BLANK****##R**************************   SPLFIX
     C*********************MOVEL*BLANK****##D**************************   SPLFIX
     C*********************MOVEL*BLANK****##S**************************   SPLFIX
      *****************************************************************   SPLFIX
      ****Get*information*about*next*20*RDEs*in*group*set*from*compile*   SPLFIX
      ****time*arrays**************************************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************Z-ADD0*********#1***************************   SPLFIX
     C************IN99*****DOUEQ'0'************************************   SPLFIX
     C***********#1********OREQ*20*************************************   SPLFIX
     C*********************Z-ADD1*********#2***************************   SPLFIX
     C***********##GRPX****LOKUP##GRP,#2*****************99************   SPLFIX
     C************IN99*****IFEQ*'1'************************************   SPLFIX
     C*********************ADD**1*********#1***************************   SPLFIX
     C*********************MOVEL##RDEA,#2*##R,#1***********************   SPLFIX
     C*********************ADD**1*********##RDEN***********************   SPLFIX
     C*********************ENDIF***************************************   SPLFIX
     C*********************ENDDO***************************************   SPLFIX
      *****************************************************************   SPLFIX
      *................................................................   SPLFIX
      *****************************************************************   SPLFIX
      ****Unwind*subroutine*stack*name*********************************   SPLFIX
     C*********************MOVEA*BLANKS***@STK,Q***********************   SPLFIX
     C*********************SUB**1*********Q****************************   SPLFIX
      *****************************************************************   SPLFIX
     C*********************ENDSR***************************************   SPLFIX
      *****************************************************************   SPLFIX
      /EJECT                                                              SPLFIX
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
      *
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     Z-ADD1         ##OCUR  20
     C                     MOVE *BLANKS   S#PATH
     C                     MOVE *BLANKS   ##ISPT  1
     C                     Z-ADD*ZEROS    ##OSEQ
     C                     MOVE *BLANKS   ##NBRK
     C                     MOVE *BLANKS   ##NWBR
     C                     MOVE *BLANKS   FFBRCA
     C                     MOVE *BLANKS   FFCNUM
     C                     MOVE *BLANKS   FFACOD
     C                     MOVE *BLANKS   FFACSQ
     C                     Z-ADD0         ##TCNT
     C                     MOVE CBCD      ##CBCH
      *                                                                                       CCG015
     C                     EXSR INIXML                                                        CCG015
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
      *
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      **  Parameter list for current program invocation.
      *
     C           *ENTRY    PLIST
     C                     PARM           W0RTN
     C                     PARM           W0CMT   3
     C                     PARM           DSPARM
     C                     PARM           W0PTYP 10                       087274
      *
      **  Define Fields
      *
     C           *LIKE     DEFN DERPTH    ##RPTH
     C           *LIKE     DEFN DENPTH    ##NPTH
     C           *LIKE     DEFN DEFSLI    ##FSLI
     C                     MOVE *BLANKS   S#PATH256
     C                     MOVE *BLANKS   ##NBRK  1
     C                     MOVE *BLANKS   ##NWBR  1
     C           *LIKE     DEFN BRCA      ##BRCD
     C           *LIKE     DEFN BHCUST    ##CBCD
     C           *LIKE     DEFN BHCUST    ##CBCH
     C           *LIKE     DEFN BHCUST    ##TBRC
     C           *LIKE     DEFN A6NBDP    ##ISDP
     C           *LIKE     DEFN A6NBDP    ##OTDP
     C           *LIKE     DEFN A6NBDP    ##RCNF
     C           *LIKE     DEFN A6NBDP    ##CCDP                          CFF003
     C           *LIKE     DEFN RTCB      ##TCNT
     C           *LIKE     DEFN RTCB      ##TCAM
     C           *LIKE     DEFN RTCB      ##TAMT
     C           *LIKE     DEFN ISCY      ##CCY
     C           *LIKE     DEFN ISCY      ##ISCY
     C           *LIKE     DEFN ISTT      ##ISTT
     C           *LIKE     DEFN QOTC      ##QOTC
     C           *LIKE     DEFN TNBR      ##TNBR
     C           *LIKE     DEFN BHCOAD    ##TYPE
     C           *LIKE     DEFN ISTT      UISTT                           087273
     C           *LIKE     DEFN ISTN      UISTN                           087273
      *
      **  Key list for CLINT
      *
     C           ##CLNT    KLIST
     C                     KFLD           CBCD
     C                     KFLD           ##TYPE
      *
      /COPY ZSRSRC,FFSETLZ2
      *
      **  Copyright
      *
     C                     MOVEA##CPY     ##BIS  80
      *                                                                   S71062
      **  Get module details using access object                          S71062
      *                                                                   S71062
     C                     CALL 'AOMMODR0'                                S71062
     C                     PARM *BLANKS   ##RTCD                          S71062
     C                     PARM '*FIRST ' ##OPTN                          S71062
     C           SDMMOD    PARM SDMMOD    DSFDY                           S71062
      *                                                                   S71062
      **  Check if error occurred                                         S71062
      *                                                                   S71062
     C           ##RTCD    IFNE *BLANK                                    S71062
     C                     MOVEL'AOMMODR0'W0FILE                          S71062
     C                     MOVEL'*CALL'   W0KEY            ***************S71062
     C                     Z-ADD12        W0ERNB           * DB ERROR 12 *S71062
     C                     MOVEL'MEM5003' W0MSGD           ***************S71062
     C                     MOVEL'MIDAS  ' W0MSGF                          S71062
     C                     EXSR SRERR                                     S71062
     C                     ENDIF                                          S71062
      *
     C                     MOVE '-'       ##DSH1
     C                     MOVE '-'       ##DSH2
     C                     MOVE '-'       ##DSH3
     C                     MOVE '-'       ##DSH4
      *                                                                   SPLFIX
      ** Define bind constants                                            SPLFIX
     C           *LIKE     DEFN DEPBIN    ##PBIN                          SPLFIX
     C           *LIKE     DEFN DETBIN    ##TBIN                          SPLFIX
     C                     Z-ADD1         ##PBIN                          SPLFIX
     C                     Z-ADD1         ##TBIN                          SPLFIX
      *                                                                   087273
      **  Retrieve the RUNDAT data area.                                  087273
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           087273
     C                     IN   RUNDT                                     087273
      *                                                                   087273
      **  Set *IN98 on if date is in MM/DD/YY format                      087273
     C           AGDFF     COMP 'M'                      98               087273
      *
      /EJECT
      /COPY ZSRSRC,FFSETLZ3
      *                                                                   097955
      * FFSETL Subr info. setup                                           097955
      *                                                                   097955
     C                     MOVEL'1'       *INU6                           097955
      *                                                                   097955
     C                     MOVEL'01      'ZTABKY 12                       097955
     C                     MOVE '  10'    ZTABKY                          097955
     C**                                                                  097955
     C           ZTABKY    CHAINTABTB10F             99                   097955
     C**                                                                  097955
     C                     MOVE '  20'    ZTABKY                          097955
     C**                                                                  097955
     C           ZTABKY    CHAINTABTB20F             99                   097955
     C**                                                                  097955
     C                     MOVE '  40'    ZTABKY                          097955
     C**                                                                  097955
     C           ZTABKY    CHAINTABTB40F             99                   097955
     C**                                                                  097955
     C                     MOVE '  80'    ZTABKY                          097955
     C**                                                                  097955
     C           ZTABKY    CHAINTABTB80F             99                   097955
     C/COPY WNCPYSRC,CG4600C017
      *
      *................................................................
      *
      **  Unwind subroutine stack name
      *
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *                                                                                       CCG015
      ** Check if enhancement CCG015 is installed                                             CCG015
      *                                                                                       CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD   7                                           CCG015
     C                     PARM '*VERIFY' POPTN   7                                           CCG015
     C                     PARM 'CCG015'  PSARD   6                                           CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
      *                                                                                       CCG015
     C           PRTCD     IFNE *BLANKS                                                       CCG015
     C           PRTCD     ANDNE'*NRF    '                                                    CCG015
     C                     MOVE 'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL'   W0KEY                                               CCG015
     C                     Z-ADD13        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C           PRTCD     IFEQ *BLANKS                                                       CCG015
     C                     MOVE 'Y'       CCG015  1                                           CCG015
     C                     ELSE                                                               CCG015
     C                     MOVE 'N'       CCG015                                              CCG015
     C                     ENDIF                                                              CCG015
      *
     C                     ENDSR
      *****************************************************************
      /EJECT
      /COPY CGCPYSRC,CGNWEX                                                                   CCG015
      /COPY ZSRSRC,FFSETLZ4
      /EJECT
      /COPY CGCPYSRC,SRERRPSSR
      /EJECT
      /COPY CGCPYSRC,SRERRC
      /COPY ZSRSRC,FFDATEZ3                                               087273
      /COPY ZSRSRC,ZDATE1Z2                                               087273
      /COPY ZSRSRC,ZBKDT                                                  087273
      /COPY ZSRSRC,ZFWDT                                                  087273
      /COPY ZSRSRC,ZCHKH                                                  087273
      /COPY ZSRSRC,ZACCH                                                  087273
** ##GRP/##RDE
F_REVI0001 REVERSALIN
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
F_INST0001 INSTRUMENT
F_INST0002 INSTRNAME
F_INST0003 SETTLEDATE Date
F_INST0004 INSTRCCY
F_INST0005 INST_PROCT                                                     087273
F_INST0006 TRAN_DATE  Date                                                087273
F_INST0007 TRAN_DAT_F Date                                                087273
F_INST0008 MARKET_COD                                                     087273
F_INST0009 MARKET_NAM                                                     087273
F_INST0010 PREM_UP_FR                                                     087273
F_INST0011 TRAN_TIM_F                    Final Transaction Time           CFF003
F_INST0012 VALUE DATE Date               Value Date                       CFF003
F_TRND0001 POSNCHGDT  Date
F_TRAN0001 TRANSREFNO
F_TRAN0002 MATUREDIN
F_TRAN0003 TRANSTYPE
F_TRAN0004 CONTRCTPRC AmountL
F_TRAN0005 CON_PRIC_T AmountL
F_COND0001 TOTCONTRCT
F_AMNC0001 TOTCONTAMT AmountL
F_AMNC0002 TOTCONTCCY                    Total Contingent Amount Currency CFF003
F_AMNF0001 TOTCOMMISS AmountL
F_AMNF0002 TOTCHARGES AmountL
F_AMNF0003 TOTCOMCHRG AmountL                                             087273
F_TOTS0001 TOTALALLAM AmountL
F_INSO0001 OTHERCCY
F_INSO0002 OTHERAMT   AmountL            Other Amount                     CFF003
F_AMNV0001 TOTVALCNTR AmountL
F_CNFP0001 PUTCALLIN
F_CNFP0002 STRIKEPRC  AmountL
F_CNFP0003 STR_PRIC_T AmountL
F_CNFT0001 AMEREURIN
F_CNFT0002 UNDERTRTYP
F_CNFT0003 UND_INSTR                                                      087273
F_CNFT0004 UND_INST_N                                                     087273
F_AMNP0001 PREMPROFIT AmountL
F_SETL0001 SETTLACCNT
F_SETL0002 TRANSNARR
CUST  0001 CUSTOMER
CUST  0002 CUST_NAME
CUST  0003 CUST_ADR1
CUST  0004 CUST_ADR2
CUST  0005 CUST_ADR3
CUST  0006 CUST_ADR4
CUST  0007 CUST_TOWN                                                      086918
ACOF  0001 ACOF_CODE                     Account Officer Code             089776
ACOF  0002 ACOF_DEPT                     Account Officer Dept             089776
ACOF  0003 ACOF_NAME                     Account Officer Name             089776
ACOF  0004 ACOF_TELP                     Account Officer Telephone Num.   089776
ACOF  0005 ACOF_TELX                     Account Officer Telephone Ext.   089776
F_ATTN0001 FORATTENTN
F_TRAN0006 PORT_REF                                                       S71062
**  Table of Instrument Processing Type vs Print Item Sub Type            087274
1INT_RATE                                                                 087274
2CURRENCY                                                                 087274
3COMMODITY                                                                087274
4INT_RATE                                                                 087274
5CURRENCY                                                                 087274
6COMMODITY                                                                087274
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   TABDY/TABNO - SHORTNAMES & DAY NUMBERS                               087273
F0S1X2M3U4W5T6                                                            087273
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                      087273
0366073110961461                                                          087273
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        087273
000031059090120151181212243273304334365                                   087273
