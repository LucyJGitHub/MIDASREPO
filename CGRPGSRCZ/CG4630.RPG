000100200528     H        1
000110200528     F*****************************************************************
000120200528/*STD *  RPGBASE                                                      *
000130200528/*EXI *  TEXT('Midas CG FT DR/CR advices generation extract')         *
000140200528     F*****************************************************************
000150200528     F*                                                               *
000160200528     F*  Midas - User Defined Correspondence                          *
000170200528     F*                                                               *
000180200528     F*  CG4630 - FT Extract Program                                  *
000190200528     F*                                                               *
000200200528     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
000210200528     F*  (phase(s))                                                   *
000220200528     F*                                                               *
000230200528     F*  Called By: mmCnnnn - (program name)                          *
000240200528     F*                                                               *
000250200528      *  (c) Finastra International Limited 2001                      *
000260200528      *                                                               *
000270200604      *  Last Amend No. 249281             Date 22May20               *
000280200528      *  Prev Amend No. MD046248           Date 27Oct17               *
000290200528      *                 MD038960           Date 08Jun16               *
000300200528      *                 CFT134             Date 13Feb12               *
000310200528      *                 AR1097394          Date 02Apr13               *
000320200528      *                 AR1096709A         Date 02Apr13               *
000330200528      *                 AR1096709          Date 20Mar13               *
000340200528      *                 AR1082119A         Date 18Mar13               *
000350200528      *                 AR1096097          Date 15Mar13               *
000360200528      *                 AR1082119          Date 29Jan13               *
000370200528      *                 CFT121             Date 28Sep12               *
000380200528      *                 CFT120             Date 28Sep12               *
000390200528      *                 AR850312           Date 18Nov10               *
000400200528      *                 CER049             Date 06Dec10               *
000410200528      *                 CRE075             Date 06Dec10               *
000420200528      *                 CER059             Date 19Jul10               *
000430200528      *                 BUG23445A          Date 19Apr09               *
000440200528      *                 BUG23445           Date 17Mar09               *
000450200528      *                 BUG23197           Date 03Mar09               *
000460200528      *                 BUG22749           Date 07Feb09               *
000470200528      *                 BUG22563           Date 30Jan09               *
000480200528      *                 CER031             Date 19May08               *
000490200528      *                 CER047             Date 19May08               *
000500200528      * Bank Fusion Midas 1.4 Base -----------------------------------*
000510200528      * Midas Plus 1.4 Base 04 ---------------------------------------*
000520200528      *                 BUG15265           Date 06Nov07               *
000530200528      *                 BUG15105           Date 23Oct07               *
000540200528      *                 CSW207             Date 06Dec06               *
000550200528      * Midas Plus 1.4 Base ------------------------------------------*
000560200528      * Midas Plus 1.3 ----------- Base ------------------------------*
000570200528      *                 BUG12827           Date 06Dec06               *
000580200528      *                 BUG12648           Date 14Nov06               *
000590200528      *                 CFT032             Date 11Sep06               *
000600200528      *                 CDL049             Date 05Jul06               *
000610200528      *                 BUG11679           Date 05Jul06               *
000620200528      *                 CSD031             Date 10Apr06               *
000630200528      *                 CSD027             Date 09Dec05               *
000640200528      *                 BUG9646            Date 20Dec05               *
000650200528      *                 CLE025             Date 20Oct03               *
000660200528      *                 TDA035             Date 02Apr04               *
000670200528      *                 CSC022             Date 24Feb04               *
000680200528      *                 CGL029             Date 01Sep03               *
000690200528      *                 222373             Date 03Nov03               *
000700200528      * Midas Release 4.01.02 ----------------------------------------*
000710200528      *                 203663             Date 17Jun02               *
000720200528      * Midas Release 4.01 -------------------------------------------*
000730200528      *                 CCG015             Date 09Aug01               *
000740200528      * Midas Release 4 --------------- Base -------------------------*
000750200528      *                 CSW201             Date 02May01               *
000760200528      *                 192761             Date 18May01               *
000770200528      * Midas DBA 3.05 -----------------------------------------------*
000780200528      *                 CFT009             Date 01Jun00               *
000790200528      *                 152149             DATE 30Jan01               *
000800200528      * Midas DBA 3.04 -----------------------------------------------*
000810200528      *                 CFT014             Date 25May00               *
000820200528      * Midas DBA 3.03 -----------------------------------------------*
000830200528      *                 CFT008             Date 04Jan00               *
000840200528      *                 CFT006             Date 01Oct99               *
000850200528      * Midas DBA 3.02 -----------------------------------------------*
000860200528     F*                 CPB001             Date 20Sep99               *
000870200528      * Midas DBA 3.00 ---------------- Base -------------------------*
000880200528      *                 CFT003             Date 18Nov98               *
000890200528      *                 137419             Date 19Jun98               *
000900200528     F*                 CEU006             DATE 02APR98               *
000910200528     F*                 096419             DATE 09NOV95               *
000920200528     F*                 095577             DATE 07NOV95               *
000930200528     F*                 089214             DATE 16JUN95               *
000940200528     F*                 087994             DATE 17MAY95               *
000950200528     F*                 087995             DATE 11MAY95               *
000960200528     F*                 086382             DATE 18APR95               *
000970200528     F*                 085775             DATE 05APR95               *
000980200528     F*                 086177             DATE 30MAR95               *
000990200528     F*                 S01522             DATE 25JAN95               *
001000200528     F*                                                               *
001010200528     F*---------------------------------------------------------------*
001020200528     F*                                                               *
001030200528      *  249281 - FT CD/DR Advice has incorrect account ID.           *
001040200528      *           Changed branch code's position and W8FT DS being    *
001050200528      *           passed by CG4980.                                   *
001060200528      *  MD046248 - Finastra Rebranding                               *
001070200528      *  MD038960 - Program dump because CER049 has been switched on  *
001080200528      *             but Effective Date has not been reached yet. Fix  *
001090200528      *             is to not extract Stamp Tax details instead.      *
001100200528      *           - Applied for MD039263                              *
001110200528      *  CFT134 - Add IBAN to DR/CR Advices                           *
001120200528      *  AR1097394 - Charges currency must be shown in the Credit     *
001130200528      *              advice instead of charge currency ind setting in *
001140200528      *              the FT ICD                                       *
001150200528      *  AR1096709A - If the Charge to the DR of A/c is Partial       *
001160200528      *               account data of the said field is missing in the*
001170200528      *               Credit and Debit advice                         *
001180200528      *  AR1096709 - If the Charge to the DR of A/c is Partial account*
001190200528      *              data of the said field is missing in the Credit  *
001200200528      *              and Debit advice                                 *
001210200528      *  AR1082119A - In the debit advice, entered currency generated *
001220200528      *              is EUR. The currency of the charge to debit ac   *
001230200528      *              is USD.                                          *
001240200528      *  AR1096097 - If Charges to the DR of Account is Nostro, data  *
001250200528      *              of the mentioned field is missing in the 1st and *
001260200528      *              2nd Advices.                                     *
001270200528      *  AR1082119 - In the debit advice, entered currency generated  *
001280200528      *              is EUR. The currency of the charge to debit ac   *
001290200528      *              is USD.                                          *
001300200528      *  CFT121 - FT IN/OP - Separate DR Advice for Charges           *
001310200528      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
001320200528      *  AR850312 - Error on program CG4630, record not found in      *
001330200528      *             SDBOOKPD                                          *
001340200528      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
001350200528      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
001360200528      *  CER059 - German Feature Upgrade to Delhi                     *
001370200528      *  BUG23445A - Paper statements were not reformatted based on   *
001380200528      *              network *PAPER                                   *
001390200528      *  BUG23445 - Format network according to network Paper if      *
001400200528      *             Account is linked                                 *
001410200528      *  BUG23197 - Pass blank parameter to the MG001900(Output       *
001420200528      *             parameter)                                        *
001430200528      *  BUG22749 - Component failed due to DB Error SCSARDPD         *
001440200528      *             (Partially fixed by BUG22563)                     *
001450200528      *  BUG22563 - Component CGC2050 failed due to DB Error SCSARDPD *
001460200528      *  CER031 - FT/GL Extended Narrative German Features            *
001470200528      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
001480200528      *           (Recompile)                                         *
001490200528      *  BUG15265 - Component CGC2050 failed due to DB Error AOCURRR0 *
001500200528      *  BUG15105 - Missing Process for SWIFT 2007                    *
001510200528      *  CSW207 - SWIFT 2007 Changes                                  *
001520200528      *  BUG12827 - Blank M2CHGC caused CGC2050 component to fail     *
001530200528      *  BUG12648 - Blank M1CHGC caused CGC2050 component to fail     *
001540200528      *  CFT032 - Account line in field 50X in MT103                  *
001550200528      *  CDL049 - Addition of a Reference Rate field (recompile)      *
001560200528      *  BUG11679 - Additional Conversion of Customer Number to Alpha.*
001570200528      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
001580200528      *  CSD027 - Conversion Of Customer Number to Alpha              *
001590200528      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
001600200528      *  CLE025 - Credit Lines (Recompile)                            *
001610200528      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
001620200528      *  CSC022 - Commitment Control Changes for MidasPlus            *
001630200528      *           (Recompile)                                         *
001640200528      *  CGL029 - Increase Account Code to 10 digits                  *
001650200528      *  222373 - Correct parameters on program calls                 *
001660200528      *  203663 - 'Charges to the Debit of Account No.' is not set up *
001670200528      *           correctly.                                          *
001680200528      *  CCG015 - Correspondence Manager Phase 1                      *
001690200528      *  CSW201 - SWIFT 2001 Standards Update                         *
001700200528      *  192761 - Some parts of CFT014 are not switchable.            *
001710200528      *  CFT009 - FT Fees and Charge Development                      *
001720200528     F*  152149 - PAY_DLVCCY & PAY_DLVAMT not appearing for CP's      *
001730200528      *  CFT014 - Stright-through Processing Phase 2                  *
001740200528      *           MT103 Messages Generation for FT                    *
001750200528      *  CFT008 - Funds Transfer/Swift Messages MT102                 *
001760200528      *  CFT006 - Funds Transfer/Swift Messages MT101                 *
001770200528     F*  CPB001 - 'Private Banking' Module                            *
001780200528     F*  CFT003 - Settlment Method '14'                               *
001790200528     F*  137419 - Vat not extracted for cheques for collection.       *
001800200528     F*  CEU006 - EMU Funds Transfer Payments and Settlements:        *
001810200528     F*           added 3 new group sets FT_DLV, CHGENT and CHGEUR    *
001820200528     F*           to existing group sets DRCR01,DRCR02,DRCR03,DRCR04. *
001830200528     F*  096419 - Place destination in Account with Bank if latter blk*
001840200528     F*  095577 - Add new RDEs                                        *
001850200528     F*           CR DATE Credit Date                                 *
001860200528     F*           DR DATE Dedit Date                                  *
001870200528     F*           SETTLE MOD Settlement Method                        *
001880200528     F*  089214 - Add in telex amount for collections                 *
001890200528     F*           Correct A/c with bank address                       *
001900200528     F*  087994 - Various formatting errors                           *
001910200528     F*  087995 - Remove *DBERR from AOCURRR0 call                    *
001920200528     F*           Correct Currency as parameter                       *
001930200528     F*           Use cheque sequence number to get information       *
001940200528     F*  086382 - Do not call A0PRFCR0 if profit center blank.        *
001950200528     F*  085775 - Change customer report town from 10A to 35A         *
001960200528     F*  086177 - Move generation so not print can be set             *
001970200528     F*  S01522 - User Defined Correspondence                         *
001980200528     F*                                                               *
001990200528     F*****************************************************************
002000200528     F*                                                               *
002010200528     F*  Indicator usage                                              *
002020200528     F*  ~~~~~~~~~~~~~~~                                              *
002030200528     F*                                                               *
002040200528     F*                                                               *
002050200528     F*  99   -    General work indicator                             *
002060200528     F*                                                               *
002070200528     F*****************************************************************
002080200528     F/SPACE 5
002090200528     FCQCOD   IF  E           K        DISK
002100200528     FCQPAC   IF  E           K        DISK
002110200528     FINPAY   IF  E           K        DISK
002120200528     FOTPAY   IF  E           K        DISK
002130200528     FFT101HL3IF  E           K        DISK                               CFT006
002140200528     FFT102HL3IF  E           K        DISK                               CFT008
002150200528     FFT101DL0IF  E           K        DISK                               CFT006
002160200528     FFT102DL0IF  E           K        DISK                               CFT008
002170200528     FMUSER   IF  E           K        DISK
002180200528     FINPAYXL0IF  E           K        DISK                               CFT014
002190200528     FOTPAYXL0IF  E           K        DISK                               CFT014
002200200528      *                                                                                       CER049
002210200528      ** Midas FT Incoming Payments Extension Detail                                          CER049
002220200528      *                                                                                       CER049
002230200528     FINPAYQL0IF  E           K        DISK                                                   CER049
002240200528      *                                                                                       CER049
002250200528      ** Midas FT Outgoing Payments Extension Detail                                          CER049
002260200528      *                                                                                       CER049
002270200528     FOTPAYQL0IF  E           K        DISK                                                   CER049
002280200528      *                                                                                       CER049
002290200528      ** Midas FT Cheques to be Paid Extension File                                           CER049
002300200528      *                                                                                       CER049
002310200528     FCQPACQL0IF  E           K        DISK                                                   CER049
002320200528      *                                                                                       CER049
002330200528      ** Midas FT Cheques for Collection Extension File                                       CER049
002340200528      *                                                                                       CER049
002350200528     FCQCOCQL0IF  E           K        DISK                                                   CER049
002360200528      *                                                                                     BUG23445
002370200528      ** Midas GL Network accounts - MT94x - retrieval                                      BUG23445
002380200528      *                                                                                     BUG23445
002390200528     F*GLNW94L1IF  E           K        DISK                                      BUG23445 BUG23445A
002400200528     FGLNWACL1IF  E           K        DISK                                                BUG23445A
002410200528      *                                                                                     BUG23445
002420200528     F/COPY WNCPYSRC,CG4630F001
002430200528     E/COPY CGCPYSRC,CGPACKE
002440200528     E/COPY CGCPYSRC,SRERRE
002450200528     E**  Number Arrays
002460200528     E                    ##W        20  1
002470200528     E                    ##NUMA     29  1
002480200528     E*
002490200528     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
002500200528     E*
002510200528     E***********         ##GRP   1  71 10   ##RDEA 22                    095577
002520200528     E/COPY WNCPYSRC,CG4630E001
002530200528     E***********         ##GRP   1  74 10   ##RDEA 22              095577CEU006
002540200528     E***********         ##GRP   1 108 10   ##RDEA 22              CEU006CPB001
002550200528     E******************* ##GRP   1 109 10   ##RDEA 22              CPB001CFT006
002560200528     E***********         ##GRP   1 224 10   ##RDEA 22             CFT006 CFT014
002570200528     E********************##GRP   1 258 10   ##RDEA 22              CFT014CFT009
002580200528     E**********          ##GRP   1 350 10   ##RDEA 22                                 CFT009 CSW201
002590200528     E**********          ##GRP   1 366 10   ##RDEA 22                                 CSW201 CER031
002600200528     E**********          ##GRP   1 406 10   ##RDEA 22                                 CER031 CER049
002610200528     E**********          ##GRP   1 408 10   ##RDEA 22                                 CER049 CFT121
002620200528     E**********          ##GRP   1 409 10   ##RDEA 22                                 CFT121 CFT120
002630200528     E**********          ##GRP   1 411 10   ##RDEA 22                                 CFT120 CFT134
002640200528     E                    ##GRP   1 412 10   ##RDEA 22                                        CFT134
002650200528     E/COPY WNCPYSRC,CG4630E002
002660200528     E*
002670200528     E**  Array of Currencies accessed by program
002680200528     E                    ##CY      100  3
002690200528     E*
002700200528     E**  Copyright array.
002710200528     E                    ##CPY   1   1 80
002720200528      *                                                                   CFT008
002730200528     E                    FLDNAM     40 10                                                    CER031
002740200528     E                    MSGID      40  7                                                    CER031
002750200528     E                    MSGDTA     40 45                                                    CER031
002760200528     E                    WFLDNM     40 10                                                    CER031
002770200528     E                    WMGID      40  7                                                    CER031
002780200528     E                    WMGDTA     40 45                                                    CER031
002790200528      *                                                                                       CER031
002800200528     IFT102HD0                                                            CFT008
002810200528     I              SINST                           SINSTX                CFT008
002820200528     I*
002830200528     I            DS
002840200528     I                                    B   1   20##OSEQ
002850200528     I**  Convert Ouput Sequence between Numeric and Binary
002860200528     I*
002870200528     I            DS
002880200528     I                                        1  10 ##GRPX
002890200528     I                                        1   6 ##GRPS
002900200528     I                                        7  100##RDEN
002910200528     I**  Look-up string for RDE definition Array
002920200528     I*
002930200528     I##SDS       DS
002940200528     I**********                              15120 ##S                                      BUG9646
002950200528     I                                        15632 ##S                                      BUG9646
002960200528     I##ADS       DS                           5120                       CFT009
002970200528     I**  Packed data string.
002980200528     I*
002990200528     I            DS
003000200528     I                                        1  20 ##W
003010200528     I                                        1  200##WNUM
003020200528     I**  Number Field
003030200528     I*
003040200528     I            DS
003050200528     I                                        1   8 ##ITMA
003060200528     I                                        1   80##ITEM
003070200528     I*
003080200528     I#RETLN      DS
003090200528     I**********                              1   60##CNUM                                    CSD027
003100200528     I                                        1   6 ##CNUM                                    CSD027
003110200528     I                                        7   9 ##CCY
003120200528     I**********                             10  130##ACOD                                    CGL029
003130200528     I**********                             14  150##ACSQ                                    CGL029
003140200528     I**********                             16  18 ##BRC1                                    CGL029
003150200528     I                                       10  190##ACOD                                    CGL029
003160200528     I                                       20  210##ACSQ                                    CGL029
003170200528     I                                       12  24 ##BRC1                                    CGL029
003180200528      *                                                                   CPB001
003190200528     I            DS                                                      CPB001
003200200528     I                                        1   6 KCNUM                 CPB001
003210200528     I**********                              7  10 KACOD                              CPB001 CGL029
003220200528     I**********                             11  12 KACSQ                              CPB001 CGL029
003230200528     I**********                             13  15 KBRCA                              CPB001 CGL029
003240200528     I**********                              1  15 WORC1                              CPB001 CGL029
003250200528     I                                        7  16 KACOD                                     CGL029
003260200528     I                                       17  18 KACSQ                                     CGL029
003270200528     I                                       19  21 KBRCA                                     CGL029
003280200528     I                                        1  21 WORC1                                     CGL029
003290200528     I            DS
003300200528      *
003310200528      * Data Structure redefining Address fields
003320200528      *
003330200528     I                                        1 210 ADDRSS
003340200528     I                                        1  35 ADCHK1
003350200528     I                                       36  70 ADCHK2
003360200528     I                                       71 105 ADCHK3
003370200528     I                                      106 140 ADCHK4
003380200528     I                                      141 175 ADCHK5
003390200528     I                                      176 210 ADCHK6
003400200528      *
003410200528      * Blank Line Analysis data structure
003420200528      *
003430200528     I                                       36 210 ADCH26
003440200528     I                                       71 210 ADCH36
003450200528      *
003460200528      * SWIFT Address Analysis data structure
003470200528      *
003480200528     I                                        1   1 ADSLSH
003490200528     I                                        1  11 ADSWFT
003500200528     I                                       12  35 ADEXSW
003510200528     I                                       36  36 ADSLS2
003520200528     I                                       36  46 ADSWF2
003530200528     I                                       47  70 ADEXS2
003540200528      *
003550200528      * Customer Analysis data structure
003560200528      *
003570200528     I                                        1  10 ADCUST
003580200528     I                                       11  35 ADEXCS
003590200528     I                                        1   6 ADCNUM
003600200528     I                                        7  35 ADEXCN
003610200528     I                                       36  45 ADCUS2
003620200528     I                                       46  70 ADXCS2
003630200528     I                                       36  41 ADCNM2
003640200528     I                                       42  70 ADXCN2
003650200528      *
003660200528      * Account Analysis data structure FULL Account
003670200528      *
003680200528     I                                        1   6 ADGCNM
003690200528     I                                        7   9 ADGCCY
003700200528     I**********                             10  13 ADGACD                                    CGL029
003710200528     I**********                             14  15 ADGASQ                                    CGL029
003720200528     I**********                             16  18 ADGBRC                                    CGL029
003730200528     I**********                             16  35 ADEXG1                                    CGL029
003740200528     I**********                             19  35 ADEXGL                                    CGL029
003750200528     I                                       10  19 ADGACD                                    CGL029
003760200528     I                                       20  21 ADGASQ                                    CGL029
003770200528     I                                       22  24 ADGBRC                                    CGL029
003780200528     I                                       22  35 ADEXG1                                    CGL029
003790200528     I                                       25  35 ADEXGL                                    CGL029
003800200528      *
003810200528      * Partial Account Analysis data structure
003820200528      *
003830200528     I                                        1   6 ADPCNM
003840200528     I**********                              7  10 ADPACD                                    CGL029
003850200528     I**********                             11  12 ADPASQ                                    CGL029
003860200528     I**********                             13  15 ADPBRC                                    CGL029
003870200528     I**********                             13  35 ADEXP1                                    CGL029
003880200528     I**********                             16  35 ADEXPA                                    CGL029
003890200528     I                                        7  16 ADPACD                                    CGL029
003900200528     I                                       17  18 ADPASQ                                    CGL029
003910200528     I                                       19  21 ADPBRC                                    CGL029
003920200528     I                                       19  35 ADEXP1                                    CGL029
003930200528     I                                       22  35 ADEXPA                                    CGL029
003940200528      *
003950200528      * Nostro Number Account Analysis data structure
003960200528      *
003970200528     I                                        1   2 ADNOSN
003980200528     I                                        3  35 ADEXNN
003990200528      *
004000200528      * Nostro Account Analysis data structure
004010200528      *
004020200528     I                                        1   5 ADFNOS
004030200528     I                                        1   3 ADFCCY
004040200528     I                                        4   5 ADFNNB
004050200528     I                                        6  35 ADFNEX
004060200528      *
004070200528      * Retail Account Analysis data structure
004080200528      *
004090200528     I                                        1  10 ADACNO
004100200528     I                                       11  35 ADEXAC
004110200528      *
004120200528     I            DS
004130200528      *
004140200528      * Data Structure redefining Partial Account
004150200528      *
004160200528     I**********                              1  12 PTACCT                                    CGL029
004170200528     I                                        1  18 PTACCT                                    CGL029
004180200528     I                                        1   6 PTCNUM
004190200528     I**********                              7  10 PTACOD                                    CGL029
004200200528     I**********                             11  12 PTACSQ                                    CGL029
004210200528     I                                        7  16 PTACOD                                    CGL029
004220200528     I                                       17  18 PTACSQ                                    CGL029
004230200528     I            DS
004240200528      *
004250200528      * Data Structure for address work fields.
004260200528      *
004270200528     I                                        1  35 W#ADD1
004280200528     I                                       36  70 W#ADD2
004290200528     I                                       71 105 W#ADD3
004300200528     I                                      106 140 W#ADD4
004310200528     I                                      141 175 W#ADD5
004320200528     I                                        1 175 W#ADDR
004330200528     I*                                                                   CFT006
004340200528     I** Data area for redefining GL account (OLD)                        CFT006
004350200528     I*                                                                   CFT006
004360200528     I            DS                                                      CFT006
004370200528     I**********                              1  18 OGLACT                             CFT006 CGL029
004380200528     I                                        1  24 OGLACT                                    CGL029
004390200528     I                                        1   6 OGLCNM                CFT006
004400200528     I                                        7   9 OGLCCY                CFT006
004410200528     I**********                             10  13 OGLACD                             CFT006 CGL029
004420200528     I**********                             14  15 OGLSEQ                             CFT006 CGL029
004430200528     I**********                             16  18 OGLBRH                             CFT006 CGL029
004440200528     I                                       10  19 OGLACD                                    CGL029
004450200528     I                                       20  21 OGLSEQ                                    CGL029
004460200528     I                                       22  24 OGLBRH                                    CGL029
004470200528     I*                                                                   CFT006
004480200528     I** Data area for redefining GL account (NEW)                        CFT006
004490200528     I*                                                                   CFT006
004500200528     I            DS                                                      CFT006
004510200528     I**********                              1  18 NGLACT                             CFT006 CGL029
004520200528     I                                        1  24 NGLACT                                    CGL029
004530200528     I                                        1   3 NGLBRH                CFT006
004540200528     I                                        4   9 NGLCNM                CFT006
004550200528     I                                       10  12 NGLCCY                CFT006
004560200528     I**********                             13  16 NGLACD                             CFT006 CGL029
004570200528     I**********                             17  18 NGLSEQ                             CFT006 CGL029
004580200528     I                                       13  22 NGLACD                                    CGL029
004590200528     I                                       23  24 NGLSEQ                                    CGL029
004600200528      *                                                                   087994
004610200528      *  Calling parameter data structure for AOCCYCV0                    087994
004620200528      *                                                                   087994
004630200528     ID#DTA       DS                            256                       087994
004640200528      *                                       From Currency & amount      087994
004650200528     I                                        1   3 D#FCCY                087994
004660200528     I                                    P   4  110D#FAMT                087994
004670200528      *                                       To Currency & amount        087994
004680200528     I                                       12  14 D#TCCY                087994
004690200528     I                                    P  15  220D#TAMT                087994
004700200528      *                                       Rate and multi/div ind.     087994
004710200528     I                                       23  23 I#MDIN                087994
004720200528     I                                    P  24  368I#RATE                087994
004730200528      *                            Output     Rate and multi/div ind.     087994
004740200528      *                                       If no in rate               087994
004750200528     I                                       37  37 O#MDIN                087994
004760200528     I                                    P  38  508O#RATE                087994
004770200528      *
004780200528     IDSSDY     E DSDSSDY
004790200528     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
004800200528     ISDCURR    E DSSDCURRPD
004810200528     I* DS FOR CURRENCIES DETAILS
004820200528     ISDBRCH    E DSSDBRCHPD
004830200528     I* DS FOR BRANCH DETAILS
004840200528     ISDBANK    E DSSDBANKPD
004850200528     I* DS FOR BANK DETAILS
004860200528     ISDMMOD    E DSSDMMODPD                                              CPB001
004870200528     I* DS FOR MODULE DETAILS                                             CPB001
004880200528     IDSFDY     E DSDSFDY
004890200528     I*
004900200528     ISDBOOK    E DSSDBOOKPD
004910200528     I*
004920200528     ISDPRFC    E DSSDPRFCPD
004930200528     I* DS FOR PROFIT CENTRE DETAILS
004940200528     I*                                                                                       CFT134
004950200528     ISDNOST    E DSSDNOSTPD                                                                  CFT134
004960200528     I* DS FOR NOSTRO DETAILS                                                                 CFT134
004970200528     I*
004980200528     I** RECORD FORMATS FOR ACCESS TO BOOK DETAILS
004990200528     I*
005000200528     ISDGELR    E DSSDGELRPD                                              CEU006
005010200528     I              QQACCD                          QQACCX                                  BUG23445
005020200528     I* DS for GL ICD Details                                             CEU006
005030200528     I*                                                                   CEU006
005040200528     ISDFTFR    E DSSDFTFRPD                                              CEU006
005050200528     I* DS for FT ICD Details                                             CEU006
005060200528     I*                                                                   CEU006
005070200528     ISDDLST    E DSSDDLSTPD
005080200528     I* DS FOR DEAL SUBTYPE DETAILS
005090200528      *                                                                                       CCG015
005100200528     ISCSARD    E DSSCSARDPD                                                                  CCG015
005110200528      ** DS for SAR details                                                                   CCG015
005120200528     I              LCD                             WSCLCD                                    CCG015
005130200528      *                                                                                       CCG015
005140200528     I##UDCR    E DSCGUDCRPD
005150200528      ** External DS for incomplete reference
005160200528     ISDACCT    E DSACCNTAB                                               CPB001
005170200528     I              PRFC                            APRFC                 CPB001
005180200528     I              BRCA                            ABRCA                 CPB001
005190200528     I              LCD                             ALCD                  CPB001
005200200528     I/COPY WNCPYSRC,CG4630I001
005210200528     I##SRDT      DS                         20
005220200528      **  DS to store subroutine specific data.
005230200528      **  - Saved Path
005240200528     I                                        1  70 ##SPAT
005250200528     I/COPY CGCPYSRC,CGPACKI
005260200528      *
005270200528     ICPYR        DS
005280200528      **  Data Structure for Compilation - Copyright Insertion
005290200528     I                                        1  80 ##CPY
005300200528      *
005310200528      *    STANDARD LOCAL DATA AREA FIELDS
005320200528      *
005330200528     IRUNDT       DS
005340200528      *  DATA AREA RUNDAT
005350200528      *
005360200528      *
005370200528     I                                        1   7 RUNA
005380200528     I                                    P   8  100RUND
005390200528     I                                       11  11 SSF
005400200528     I                                       12  12 DATF
005410200528     I                                       13  13 MBIN
005420200528     IW8FT        DS                            256
005430200528      *
005440200528      * Address data structure
005450200528      *
005460200528      * Currency
005470200528     I                                        1   3 W8CCY
005480200528      * Settlement Type
005490200528     I                                        4   5 W8STMT
005500200528      * Mandatory Text - convert BIC identifiers
005510200528     I                                        6   6 W8MTXT
005520200528      * Message Tag
005530200528     I                                        7  11 W8MTAG
005540200528      * Construct of data in field
005550200528     I                                       12  12 W8TYPE
005560200528      * Number of Lines available
005570200528     I                                       13  140W8NLIN
005580200528      * Network and Message Type
005590200528     I                                       15  20 W8NWRK
005600200528     I                                       21  23 W8MTPY
005610200528      * Calling Program
005620200528     I                                       24  33 W8CPGM
005630200528      * Action *PRINT/*ENQ/*MSG GEN
005640200528     I                                       34  41 W8ACT
005650200528      * Critical reporting - Database error if 'Y'
005660200528      * If no BIC directory and BIC entered no error
005670200528     I                                       42  42 W8CRIT
005680200528      * Force Midas Address - where possible
005690200528     I                                       43  43 W8MADD
005700200528      * If Retail get first address from account
005710200528     I                                       44  44 W8RTAD
005720200528      * Alternative Address
005730200528     I                                       45  45 W8ALTN
005740200528      * Address type selected in W0MSG
005750200528     I                                       46  46 W8ADTP
005760200528      * Customer number
005770200528     I**********                             47  520W0CNUM                                    CSD027
005780200528     I                                       47  52 W0CNUM                                    CSD027
005790200528      * Retail Account number
005800200528     I                                       53  620W0ACNO
005810200528      * Currency
005820200528     I*****************                      63  650W#CCY                 087995
005830200528     I                                       63  65 W#CCY                 087995
005840200528      * Account Code
005850200528     I**********                             66  690W0ACOD                                    CER031
005860200528     I                                       66  690QQACOD                                    CER031
005870200528      * Account Sequence
005880200528     I                                       70  710W0ACSQ
005890200528      * Account Name
005900200528     I                                       72 101 W0ANAM
005910200528      * Branch
005920200528     I                                      102 104 W0BRCA
005930200528      * Customer name
005940200528     I                                      105 124 W0CRNM
005950200528      * Customer SWIFT I.D
005960200528     I                                      125 136 W0CSID
005970200528      * Customer account line
005980200528     I                                      137 171 W0ACLN
005990200528      * Customer report town
006000200528     I************                          172 181 W0RTWN                085775
006010200528     I                                      172 206 W0RTWN                085775
006020200528      *                                                                                       CER031
006030200528     I                                      207 2160W0ACOD                                    CER031
006040200528     I**DSPAR1      DS                                                    087995
006050200528     IDSPAR1      DS                            256                       087995
006060200528      *
006070200528      ** Print Item Type
006080200528     I                                        1  10 ##PTYP
006090200528      *
006100200528      ** Print Item Sub-Type
006110200528     I                                       11  20 ##PSTP
006120200528      *
006130200528      ** File containing document data
006140200528     I                                       21  27 ##FILE
006150200528      *
006160200528      ** Branch
006170200528     I                                       28  30 ##BRCA
006180200528      *
006190200528      ** Payment type
006200200528     I                                       31  32 ##PYTP
006210200528      *
006220200528      ** Payment Reference
006230200528     I                                       33  47 ##PREF
006240200528      *
006250200528      ** Commit (YES/NO )
006260200528     I                                       48  50 W0CMT
006270200528      *
006280200528      ** Update files (YES/NO )
006290200528     I                                       51  53 W0UPF
006300200528      *
006310200528      ** Item suppressed
006320200528     I                                       54  56 ##ISUP
006330200528      *
006340200528      ** Cheque Number
006350200528     I                                       57  650##CQNM
006360200528      *
006370200528      ** Number of cheques 'extracted'
006380200528     I                                       66  700##RECU
006390200528      *                                                                   087995
006400200528      ** Cheques sequence number                                          087995
006410200528     I                                       71  720##CQSQ                087995
006420200528      *                                                                   CEU006
006430200528     I/COPY FTCPYSRC,FT0010I001                                           CEU006
006440200528      **  Input/output parameters for call to FT0010.                     CEU006
006450200528      *
006460200528     IW0FMT     E DSCGUDTAPD
006470200528      **  Record format of PF/CGUDTAPD for use as a parameter
006480200528      *
006490200528     I            DS                                                                          CER031
006500200528     I                                        1  100PACCD                                     CER031
006510200528      *                                                                                       CER031
006520200528     I                                       11  120PACSQ                                     CER031
006530200528      *                                                                                       CER049
006540200528      ** Midas SD Stamp Tax Defaults by Business Type Data Structure                          CER049
006550200528      *                                                                                       CER049
006560200528     ISDSTPD    E DSSDSTPDPD                                                                  CER049
006570200528     I*---------------------------------------------------------------------
006580200528     I/COPY CGCPYSRC,SRERRI
006590200528     I/COPY WNCPYSRC,CG4630I002
006600200528      *****************************************************************
006610200528      * Process     :  MAINLINE                                       *
006620200528      * Function    :  Mainline processing                            *
006630200528      *                                                               *
006640200528      * Called by   :  None                                           *
006650200528      * Calls       :  SRINIT - Initial Processing - On First Call    *
006660200528      *                SRINZ  - Initialise Fields on Each Invocation  *
006670200528      *                SRMAIN - Main Processing                       *
006680200528      *****************************************************************
006690200528      *
006700200528      **  Parameter list for current program invocation.
006710200528     C           *ENTRY    PLIST
006720200528     C                     PARM           W0RTN   7
006730200528     C***********          PARM           DSPARM 70                       087995
006740200528     C                     PARM           DSPARM256                       087995
006750200528      *
006760200528     C                     MOVELDSPARM    DSPAR1
006770200528      *
006780200528      **  Set up subroutine stack name
006790200528     C                     ADD  1         Q
006800200528     C                     MOVEL'MAIN'    @STK,Q
006810200528      *
006820200528      *................................................................
006830200528      *
006840200528      **  Initial processing - Once Only
006850200528     C           ##INIT    IFEQ *BLANK
006860200528     C                     EXSR SRINIT
006870200528     C                     MOVE 'Y'       ##INIT  1
006880200528     C                     ENDIF
006890200528      *
006900200528      **  Obtain data from the relevant file
006910200528     C                     EXSR SRMDTA
006920200528     C                     MOVE 'Y'       WRPT    1                       CFT006
006930200528     C           ##FILE    IFEQ 'FT101H'                                  CFT006
006940200528     C           ##PREF    CHAINFT101DL0             10                   CFT006
006950200528     C                     ENDIF                                          CFT006
006960200528     C           ##FILE    IFEQ 'FT102H'                                  CFT008
006970200528     C           ##PREF    CHAINFT102DL0             10                   CFT008
006980200528     C                     ENDIF                                          CFT008
006990200528      *                                                                   CFT014
007000200528      ** Access Incoming Payments Extension File                          CFT014
007010200528     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
007020200528     C           CFT014    ANDEQ'Y'                                       CFT014
007030200528     C           ##FILE    OREQ 'INPAY  '                                 CFT009
007040200528     C           CFT009    ANDEQ'Y'                                       CFT009
007050200528     C           ##PREF    CHAININPAYXL0             10                   CFT014
007060200528      *                                                                   CFT014
007070200528     C           *IN10     IFEQ *ON                                       CFT014
007080200528     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
007090200528     C                     MOVEL##PREF    W0KEY                           CFT014
007100200528     C                     Z-ADD34        W0ERNB                          CFT014
007110200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
007120200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
007130200528     C                     EXSR SRERR                                     CFT014
007140200528     C                     ENDIF                                          CFT014
007150200528     C                     ENDIF                                          CFT014
007160200528      *                                                                   CFT014
007170200528      ** Access Outgoing Payments Extension File                          CFT014
007180200528     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
007190200528     C           CFT014    ANDEQ'Y'                                       CFT014
007200200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT009
007210200528     C           CFT009    ANDEQ'Y'                                       CFT009
007220200528     C           ##PREF    CHAINOTPAYXL0             10                   CFT014
007230200528      *                                                                   CFT014
007240200528     C           *IN10     IFEQ *ON                                       CFT014
007250200528     C                     MOVEL'OTPAYXL0'W0FILE                          CFT014
007260200528     C                     MOVEL##PREF    W0KEY                           CFT014
007270200528     C                     Z-ADD35        W0ERNB                          CFT014
007280200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
007290200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
007300200528     C                     EXSR SRERR                                     CFT014
007310200528     C                     ENDIF                                          CFT014
007320200528     C                     ENDIF                                          CFT014
007330200528      *
007340200528      **  Initialisation processing
007350200528     C           WRPT      DOWEQ'Y'                                       CFT006
007360200528     C           ##FILE    IFNE 'FT101H  '                                CFT006
007370200528     C           ##FILE    ANDNE'FT102H  '                                CFT008
007380200528     C                     MOVE 'N'       WRPT                            CFT006
007390200528     C                     ENDIF                                          CFT006
007400200528     C                     EXSR SRINZ
007410200528      *
007420200528     C* Try to generate record if customer                                086177
007430200528     C********** W0CNUM    IFNE *ZEROS                                                 086177 CSD027
007440200528     C           W0CNUM    IFNE *BLANKS                                                       CSD027
007450200528     C/COPY WNCPYSRC,CG4630C005
007460200528      *     Add processing to produce a credit advice if                  CFT003
007470200528      *     settlement type 14 for Outgoing Payments.                     CFT003
007480200528      *     If an outgoing payment and the settlement type is 14,         CFT003
007490200528      *     (Print type/Subtype FT_ADV_CR/OUT_PAY) then this              CFT003
007500200528      *     program will be called twice for the same extract             CFT003
007510200528      *     record so that a CR advice can be produced along              CFT003
007520200528      *     with the existing DR advice.                                  CFT003
007530200528      *     For FT_ADV_CR/OUT_PAY the primary correspondent is            CFT003
007540200528      *     set to the value of the customer number of the retail         CFT003
007550200528      *     account entered in the Destination field. This value          CFT003
007560200528      *     was captured in the first call to the program (DR             CFT003
007570200528      *     advice) in the subroutine #DETIN                              CFT003
007580200528      *****************************************************************   CFT003
007590200528      *                                                                   CFT003
007600200528     C           UUCRAD    IFEQ *BLANKS                                   CFT003
007610200528     C                     MOVEL'FT_ADV_C'UUCRAD  9        Too big        CFT003
007620200528     C                     MOVE 'R'       UUCRAD           Too big        CFT003
007630200528     C                     ENDIF                                          CFT003
007640200528      *
007650200528      **  If CR advice to be produced.                                    CFT003
007660200528     C           ##PTYP    IFEQ UUCRAD                                    CFT003
007670200528     C           ##PSTP    ANDEQ'OUT_PAY'                                 CFT003
007680200528      *                                                                   CFT003
007690200528      *  Get Destination Customer                                         CFT003
007700200528      *                                                                   CFT003
007710200528     C********** SNCO      IFNE *ZEROS                                               CFT003 BUG11679
007720200528     C           SNCO      IFNE *BLANKS                                                     BUG11679
007730200528     C                     MOVE SNCT      WTYPE                           CFT003
007740200528     C                     MOVELSNCO      WPTY                            CFT003
007750200528     C                     MOVE PCCY      WCCY                            CFT003
007760200528     C                     MOVELSNCO      WPTY1                           CFT003
007770200528     C                     MOVEL*BLANKS   WBRCA                           CFT003
007780200528     C                     EXSR SRTPSR                                    CFT003
007790200528     C                     ENDIF                                          CFT003
007800200528     C********** W0CNUM    IFEQ *ZEROS                                                 CFT003 CSD027
007810200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
007820200528     C           DSTT      IFNE 'A'                                       CFT003
007830200528     C                     MOVE DSTT      WTYPE                           CFT003
007840200528     C                     MOVELDST1      WPTY                            CFT003
007850200528     C                     MOVE PCCY      WCCY                            CFT003
007860200528     C                     MOVELDST1      WPTY1                           CFT003
007870200528     C                     MOVELDST2      WPTY2                           CFT003
007880200528     C                     MOVEL*BLANKS   WBRCA                           CFT003
007890200528     C                     EXSR SRTPSR                                    CFT003
007900200528     C                     ENDIF                                          CFT003
007910200528     C                     ENDIF                                          CFT003
007920200528     C                     ENDIF                                          CFT003
007930200528     C           ##PTYP    IFEQ UUCRAD                                    CFT006
007940200528     C           ##PSTP    ANDEQ'FT_RFT '                                 CFT006
007950200528     C           BENTTP    ANDNE'A'                                       CFT006
007960200528      *                                                                   CFT006
007970200528     C           BENTTP    IFEQ 'G'                                       CFT006
007980200528     C                     MOVELTBNA35    NGLACT                          CFT006
007990200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
008000200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
008010200528     C                     MOVE NGLACD    OGLACD                          CFT006
008020200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
008030200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
008040200528     C                     MOVELOGLACT    TBNA35                          CFT006
008050200528     C                     MOVELTBNB35    NGLACT                          CFT006
008060200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
008070200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
008080200528     C                     MOVE NGLACD    OGLACD                          CFT006
008090200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
008100200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
008110200528     C                     MOVELOGLACT    TBNB35                          CFT006
008120200528     C                     ENDIF                                          CFT006
008130200528      *                                                                   CFT006
008140200528     C                     MOVE BENTTP    WTYPE                           CFT006
008150200528     C                     MOVELTBNA35    WPTY                            CFT006
008160200528     C                     MOVE PAYCCY    WCCY                            CFT006
008170200528     C                     MOVELTBNA35    WPTY1                           CFT006
008180200528     C                     MOVELTBNB35    WPTY2                           CFT006
008190200528     C                     MOVELBRCA      WBRCA                           CFT006
008200200528     C                     EXSR SRTPSR                                    CFT006
008210200528     C                     ENDIF                                          CFT006
008220200528     C           ##PTYP    IFEQ UUCRAD                                    CFT008
008230200528     C           ##PSTP    ANDEQ'FT_CCT '                                 CFT008
008240200528     C           BENTTD    ANDNE'A'                                       CFT008
008250200528      *                                                                   CFT006
008260200528     C           BENTTD    IFEQ 'G'                                       CFT006
008270200528     C                     MOVELBENF1     NGLACT                          CFT006
008280200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
008290200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
008300200528     C                     MOVE NGLACD    OGLACD                          CFT006
008310200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
008320200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
008330200528     C                     MOVELOGLACT    BENF1                           CFT006
008340200528     C                     MOVELBENF2     NGLACT                          CFT006
008350200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
008360200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
008370200528     C                     MOVE NGLACD    OGLACD                          CFT006
008380200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
008390200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
008400200528     C                     MOVELOGLACT    BENF2                           CFT006
008410200528     C                     ENDIF                                          CFT006
008420200528      *                                                                   CFT006
008430200528     C                     MOVE BENTTD    WTYPE                           CFT008
008440200528     C                     MOVELBENF1     WPTY                            CFT008
008450200528     C                     MOVE PAYCCY    WCCY                            CFT008
008460200528     C                     MOVELBENF1     WPTY1                           CFT008
008470200528     C                     MOVELBENF2     WPTY2                           CFT008
008480200528     C                     MOVELBRCA      WBRCA                           CFT008
008490200528     C                     EXSR SRTPSR                                    CFT008
008500200528     C                     ENDIF                                          CFT008
008510200528      *                                                                   CFT003
008520200528     C           UUDRAD    IFEQ *BLANKS                                   CFT003
008530200528     C                     MOVEL'FT_ADV_D'UUDRAD  9        Too big        CFT003
008540200528     C                     MOVE 'R'       UUDRAD           Too big        CFT003
008550200528     C                     ENDIF                                          CFT003
008560200528      *
008570200528      **  If DR advice to be produced.                                    CFT003
008580200528     C           ##PTYP    IFEQ UUDRAD                                    CFT003
008590200528     C           ##PSTP    ANDEQ'IN_PAY'                                  CFT003
008600200528      *                                                                   CFT014
008610200528      ** Third Reimbursement Institution precedes the Receiver's          CFT014
008620200528      ** Correspondent and the Sender.                                    CFT014
008630200528     C           CFT014    IFEQ 'Y'                                       CFT014
008640200528     C           INTRIT    ANDNE*BLANK                                    CFT014
008650200528     C                     MOVELINTRIT    WTYPE                           CFT014
008660200528     C                     MOVELINTRIB    WPTY                            CFT014
008670200528     C                     MOVELSMCY      WCCY                            CFT014
008680200528     C                     MOVELINTRIB    WPTY1                           CFT014
008690200528     C                     MOVEL*BLANKS   WBRCA                           CFT014
008700200528     C                     EXSR SRTPSR                                    CFT014
008710200528     C                     ENDIF                                          CFT014
008720200528      *                                                                   CFT014
008730200528     C           CFT014    IFEQ 'Y'                                       192761
008740200528     C********** W0CNUM    IFEQ *ZERO                                                  CFT014 CSD027
008750200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
008760200528      *                                                                   CFT014
008770200528     C***********RCCO      IFNE *ZERO                              CFT003 CFT014
008780200528     C***********          MOVE RCRT      WTYPE                    CFT003 CFT014
008790200528     C***********          MOVELRCCO      WPTY                     CFT003 CFT014
008800200528     C           INRCRT    IFNE 'A'                                       CFT014
008810200528     C                     MOVELINRCRT    WTYPE                           CFT014
008820200528     C                     MOVELINRCO1    WPTY                            CFT014
008830200528     C                     MOVE SMCY      WCCY                            CFT003
008840200528     C***********          MOVELRCCO      WPTY1                    CFT003 CFT014
008850200528     C                     MOVELINRCO1    WPTY1                           CFT014
008860200528     C                     MOVELINRCO2    WPTY2                           CFT014
008870200528     C                     MOVEL*BLANKS   WBRCA                           CFT003
008880200528     C                     EXSR SRTPSR                                    CFT003
008890200528     C                     ENDIF                                          CFT003
008900200528     C********** W0CNUM    IFEQ *ZEROS                                                 CFT003 CSD027
008910200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
008920200528     C           SNTP      IFNE 'A'                                       CFT003
008930200528     C                     MOVE SNTP      WTYPE                           CFT003
008940200528     C                     MOVELSND1      WPTY                            CFT003
008950200528     C                     MOVE SMCY      WCCY                            CFT003
008960200528     C                     MOVELSND1      WPTY1                           CFT003
008970200528     C                     MOVELSND2      WPTY2                           CFT003
008980200528     C                     MOVEL*BLANKS   WBRCA                           CFT003
008990200528     C                     EXSR SRTPSR                                    CFT003
009000200528     C                     ENDIF                                          CFT003
009010200528     C                     ENDIF                                          CFT003
009020200528     C                     ENDIF                                          CFT014
009030200528     C                     ELSE                                           192761
009040200528     C********** RCCO      IFNE *ZERO                                                192761 BUG11679
009050200528     C           RCCO      IFNE *BLANKS                                                     BUG11679
009060200528     C                     MOVE RCRT      WTYPE                           192761
009070200528     C                     MOVELRCCO      WPTY                            192761
009080200528     C                     MOVE SMCY      WCCY                            192761
009090200528     C                     MOVELRCCO      WPTY1                           192761
009100200528     C                     MOVEL*BLANKS   WBRCA                           192761
009110200528     C                     EXSR SRTPSR                                    192761
009120200528     C                     ENDIF                                          192761
009130200528     C********** W0CNUM    IFEQ *ZEROS                                                 192761 CSD027
009140200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
009150200528     C           SNTP      IFNE 'A'                                       192761
009160200528     C                     MOVE SNTP      WTYPE                           192761
009170200528     C                     MOVELSND1      WPTY                            192761
009180200528     C                     MOVE SMCY      WCCY                            192761
009190200528     C                     MOVELSND1      WPTY1                           192761
009200200528     C                     MOVELSND2      WPTY2                           192761
009210200528     C                     MOVEL*BLANKS   WBRCA                           192761
009220200528     C                     EXSR SRTPSR                                    192761
009230200528     C                     ENDIF                                          192761
009240200528     C                     ENDIF                                          192761
009250200528     C                     ENDIF                                          192761
009260200528     C                     ENDIF                                          CFT003
009270200528     C                     EXSR SRGENR                                    086177
009280200528     C                     ENDIF                                          086177
009290200528      *
009300200528      **  Main processing
009310200528     C********** W0CNUM    IFNE *ZEROS                                                        CSD027
009320200528     C           W0CNUM    IFNE *BLANKS                                                       CSD027
009330200528     C           ##RTCD    ANDNE'CGD1270'                                 086177
009340200528     C                     EXSR SRMAIN
009350200528     C                     ELSE
009360200528     C                     MOVEL'*NOPRNT' W0RTN
009370200528     C                     ENDIF
009380200528      *                                                                   CFT006
009390200528     C           ##FILE    IFEQ 'FT101H  '                                CFT006
009400200528     C           ##FILE    OREQ 'FT102H  '                                CFT008
009410200528     C           ##FILE    IFEQ 'FT101H  '                                CFT006
009420200528     C           ##PREF    READEFT101DL0                 10               CFT006
009430200528     C                     ELSE                                           CFT008
009440200528     C           ##PREF    READEFT102DL0                 10               CFT008
009450200528     C                     ENDIF                                          CFT006
009460200528     C           *IN10     IFEQ '1'                                       CFT006
009470200528     C                     MOVE 'N'       WRPT                            CFT006
009480200528     C                     ENDIF                                          CFT006
009490200528     C                     ENDIF                                          CFT006
009500200528     C                     ENDDO                                          CFT006
009510200528      *
009520200528      *................................................................
009530200528      *
009540200528      **  Unwind subroutine stack name
009550200528     C                     MOVEA*BLANKS   @STK,Q
009560200528     C                     SUB  1         Q
009570200528      *
009580200528      **  Terminate program
009590200528     C                     RETRN
009600200528      *****************************************************************
009610200528     C/SPACE 5
009620200528      *****************************************************************
009630200528      * Subroutine  :  SRMAIN                                         *
009640200528      * Function    :  Main processing                                *
009650200528      *                                                               *
009660200528      * Called by   :  Mainline                                       *
009670200528      * Calls       :                                                 *
009680200528      *****************************************************************
009690200528     C           SRMAIN    BEGSR
009700200528      *
009710200528      **  Set up subroutine stack name
009720200528     C                     ADD  1         Q       50
009730200528     C                     MOVEL'SRMAIN'  @STK,Q
009740200528      *
009750200528      *................................................................
009760200528      *
009770200528      *
009780200528     C***********          EXSR SRGENR                                    086177
009790200528      *
009800200528     C/COPY WNCPYSRC,CG4630C018
009810200528     C                     SELEC
009820200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
009830200528     C                     EXSR DRCR01
009840200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
009850200528     C                     EXSR DRCR02
009860200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
009870200528     C                     EXSR DRCR03
009880200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Collectn
009890200528     C                     EXSR DRCR04
009900200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
009910200528     C                     EXSR DRCR05                                    CFT006
009920200528     C           ##FILE    WHEQ 'FT102H '                                 CFT008
009930200528     C                     EXSR DRCR06                                    CFT008
009940200528     C                     ENDSL
009950200528     C/COPY WNCPYSRC,CG4630C019
009960200528      *
009970200528      *................................................................
009980200528      *
009990200528     C           EXMAIN    TAG
010000200528      *
010010200528      **  Unwind subroutine stack name
010020200528     C                     MOVEA*BLANKS   @STK,Q
010030200528     C                     SUB  1         Q
010040200528      *
010050200528     C                     ENDSR
010060200528      *****************************************************************
010070200528     C/SPACE 5
010080200528      *****************************************************************
010090200528      * Subroutine  :  SRMDTA                                         *
010100200528      * Function    :  Obtain data from relevant file                 *
010110200528      *                                                               *
010120200528      * Called by   :  Main processing                                *
010130200528      * Calls       :                                                 *
010140200528      *****************************************************************
010150200528     C           SRMDTA    BEGSR
010160200528      *
010170200528      **  Set up subroutine stack name
010180200528     C                     ADD  1         Q       50
010190200528     C                     MOVEL'SRMDTA'  @STK,Q
010200200528      *
010210200528      *................................................................
010220200528      *
010230200528     C           KKEY01    KLIST
010240200528     C                     KFLD           ##PREF
010250200528     C                     KFLD           WCQSQX  20
010260200528      *
010270200528     C                     SELEC
010280200528     C           ##FILE    WHEQ 'CQCOD  '
010290200528     C                     Z-ADD0         WCQSQX                          087995
010300200528     C           KKEY01    CHAINCQCOD                98
010310200528     C                     Z-ADD##CQSQ    WCQSQX                          087995
010320200528     C           KKEY01    CHAINCQCOD                98                   087995
010330200528     C           ##FILE    WHEQ 'CQPAC  '
010340200528     C                     Z-ADD0         WCQSQX                          087995
010350200528     C           KKEY01    CHAINCQPAC                98
010360200528     C                     Z-ADD##CQSQ    WCQSQX                          087995
010370200528     C           KKEY01    CHAINCQPAC                98                   087995
010380200528     C           ##FILE    WHEQ 'INPAY  '
010390200528     C           ##PREF    CHAININPAY                98
010400200528     C           ##FILE    WHEQ 'OTPAY  '
010410200528     C           ##PREF    CHAINOTPAY                98
010420200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
010430200528     C           ##PREF    CHAINFT101HL3             98                   CFT006
010440200528     C           ##FILE    WHEQ 'FT102H '                                 CFT008
010450200528     C           ##PREF    CHAINFT102HL3             98                   CFT008
010460200528     C                     ENDSL
010470200528     C/COPY WNCPYSRC,CG4630C014
010480200528      *
010490200528      ** DATABASE ERROR
010500200528      *
010510200528     C           *IN98     IFEQ *ON
010520200528     C                     MOVEL##PREF    W#PREF 17
010530200528     C           ##FILE    IFEQ 'CQCOD  '
010540200528     C           ##FILE    OREQ 'CQPAC  '
010550200528     C                     MOVE '00'      W#PREF
010560200528     C                     ENDIF
010570200528      *
010580200528     C                     MOVEL##FILE    W0FILE
010590200528     C                     MOVELW#PREF    W0KEY            ***************
010600200528     C                     Z-ADD5         W0ERNB           * DB ERROR 05 *
010610200528     C                     MOVEL'MEM5004' W0MSGD           ***************
010620200528     C                     MOVEL'MIDAS  ' W0MSGF
010630200528     C                     EXSR SRERR
010640200528     C                     END
010650200528      *
010660200528      *................................................................
010670200528      *
010680200528     C           EXMDTA    TAG
010690200528      *
010700200528      **  Unwind subroutine stack name
010710200528     C                     MOVEA*BLANKS   @STK,Q
010720200528     C                     SUB  1         Q
010730200528      *
010740200528     C                     ENDSR
010750200528      *****************************************************************
010760200528     C/SPACE 5
010770200528      *****************************************************************
010780200528      * Subroutine  :  DRCR01                                         *
010790200528      * Function    :  Incoming payments - DR Advices                 *
010800200528      *                                                               *
010810200528      * Called by   :  SRMAIN - Main Processing                       *
010820200528      * Calls       :                                                 *
010830200528      *****************************************************************
010840200528     C           DRCR01    BEGSR
010850200528      *
010860200528      **  Set up subroutine stack name
010870200528     C                     ADD  1         Q
010880200528     C                     MOVEL'DRCR01'  @STK,Q
010890200528      *
010900200528      *................................................................
010910200528      *
010920200528      **  Set up Path.
010930200528     C                     MOVEL'\DRCR01' ##PNAM  7
010940200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
010950200528      *                                                                                       CCG015
010960200528     C                     EXSR PSHGRS                                                        CCG015
010970200528      *
010980200528      **  Store Path
010990200528     C           1         OCUR ##SRDT
011000200528     C                     MOVELS#PATH    ##SPAT
011010200528      *
011020200528      ****Branch*Details**************                                    CFT009
011030200528     C*********************EXSR BRANCH                                    CFT009
011040200528      ********************************                                    CFT009
011050200528      ****Book*Details****************                                    CFT009
011060200528     C*********************EXSR BOOK                                      CFT009
011070200528      ********************************                                    CFT009
011080200528      ****Profit*Centre*Details*******                                    CFT009
011090200528     C*********************EXSR PROF@C                                    CFT009
011100200528      *                                                                   CFT009
011110200528      *   Branch, Book, Profit Centre Details                             CFT009
011120200528     C                     EXSR BBP                                       CFT009
011130200528      *
011140200528      **  FT Transaction Users
011150200528     C                     EXSR FT@USR
011160200528      ***********                                                         CFT014
011170200528      ****Payment*Main*Data********************************************   CFT014
011180200528     C***********          EXSR PAYMNT                                    CFT014
011190200528      **********                                                          087994
011200200528      ****Payment Secondary data                                          087994
011210200528     C**********           EXSR PAY@II                                    087994
011220200528      ***********                                                         CFT014
011230200528      ****Credit/Cheque*Currency***************************************   CFT014
011240200528     C***********          EXSR CR@CCY                                    CFT014
011250200528      ***********                                                         CFT014
011260200528      ****Debit*Currency***********************************************   CFT014
011270200528     C***********          EXSR DR@CCY                                    CFT014
011280200528     C           CFT014    IFEQ 'Y'                                       192761
011290200528      *                                                                   CFT014
011300200528      ** Payment Main data, Credit/Cheque currency, Debit Currency        CFT014
011310200528     C                     EXSR PYDRCR                                    CFT014
011320200528     C                     ELSE                                           192761
011330200528      *                                                                   192761
011340200528      **  Payment Main Data                                               192761
011350200528     C                     EXSR PAYMNT                                    192761
011360200528      *                                                                   192761
011370200528      **  Credit/Cheque Currency                                          192761
011380200528     C                     EXSR CR@CCY                                    192761
011390200528      *                                                                   192761
011400200528      **  Debit Currency                                                  192761
011410200528     C                     EXSR DR@CCY                                    192761
011420200528     C                     ENDIF                                          192761
011430200528      *                                                                   087994
011440200528      **  Payment Secondary data                                          087994
011450200528     C                     EXSR PAY@II                                    087994
011460200528      *                                                                                       CER049
011470200528      ** Stamp Tax data (if feature is switched on)                                           CER049
011480200528      *                                                                                       CER049
011490200528     C           CER049    IFEQ 'Y'                                                           CER049
011500200528     C                     EXSR FTSTAX                                                        CER049
011510200528     C                     ENDIF                                                              CER049
011520200528      *                                                                   CFT014
011530200528      **  Third Reimbursement Institution                                 CFT014
011540200528     C           CFT014    IFEQ 'Y'                                       CFT014
011550200528     C           INTRIT    ANDNE*BLANK                                    CFT014
011560200528     C                     EXSR SRTRIB                                    CFT014
011570200528     C                     ENDIF                                          CFT014
011580200528      *
011590200528      **  Receiver's Correspondant
011600200528     C                     EXSR RECEVR
011610200528      *
011620200528      **  Ordering Institution
011630200528     C                     EXSR O@INST
011640200528      *
011650200528      **  Ordering Customer Details
011660200528     C                     EXSR O@CUST
011670200528      *
011680200528      **  Account with bank
011690200528     C                     EXSR AC@W@B
011700200528      *
011710200528      **  Beneficiary Details
011720200528     C                     EXSR BENEF
011730200528      *
011740200528      **  Details of Payment
011750200528     C                     EXSR PAYDET
011760200528      *
011770200528      **  Charges to the debit of
011780200528     C                     EXSR CG@DAC
011790200528      *
011800200528      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
011810200528      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
011820200528      **  (Only if CFT009 is off)                                         CFT009
011830200528      *                                                                   CEU006
011840200528     C           CEU006    IFEQ 'Y'                                       CEU006
011850200528     C           CFT009    ANDEQ'N'                                       CFT009
011860200528      *                                                                   CEU006
011870200528      **  Funds Transfer Delivery Details                                 CEU006
011880200528     C                     EXSR FT@DLV                                    CEU006
011890200528      *                                                                   CEU006
011900200528      **  Entered Charges                                                 CEU006
011910200528     C                     EXSR CHGENT                                    CEU006
011920200528      *                                                                   CEU006
011930200528      **  Euro Charges                                                    CEU006
011940200528     C                     EXSR CHGEUR                                    CEU006
011950200528      *                                                                   CEU006
011960200528     C                     ENDIF                                          CEU006
011970200528      *                                                                   CEU006
011980200528     C/COPY WNCPYSRC,CG4630C008
011990200528      *                                                                   CFT014
012000200528      ** Charge Transparency fields                                       CFT014
012010200528     C           CFT014    IFEQ 'Y'                                       CFT014
012020200528     C                     EXSR SRSRCH                                    CFT014
012030200528     C                     ENDIF                                          CFT014
012040200528      *                                                                   CFT003
012050200528      **  Sender                                                          CFT003
012060200528     C                     EXSR SEND2                                     CFT003
012070200528      *................................................................
012080200528      *                                                                   CFT009
012090200528      ** Fees and charges                                                 CFT009
012100200528      *                                                                   CFT009
012110200528     C           CFT009    IFEQ 'Y'                                       CFT009
012120200528      *                                                                   CFT009
012130200528      **  Funds Transfer Delivery Details                                 CFT009
012140200528     C           CEU006    IFEQ 'Y'                                       CFT009
012150200528     C                     EXSR FT@DLV                                    CFT009
012160200528     C                     ENDIF                                          CFT009
012170200528      *                                                                   CFT009
012180200528     C                     EXSR INFEES                                    CFT009
012190200528      *                                                                   CFT009
012200200528      **  Entered Charges                                                 CFT009
012210200528     C                     EXSR INENTC                                    CFT009
012220200528      *                                                                   CFT009
012230200528      **  Entered Charges VAT                                             CFT009
012240200528     C                     EXSR INVATA                                    CFT009
012250200528      *                                                                   CFT009
012260200528     C           CEU006    IFEQ 'Y'                                       CFT009
012270200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
012280200528      *                                                                   CFT009
012290200528      **  Euro Charges                                                    CFT009
012300200528     C                     EXSR INEURC                                    CFT009
012310200528      *                                                                   CFT009
012320200528      **  Euro Charges VAT                                                CFT009
012330200528     C                     EXSR INVATE                                    CFT009
012340200528     C                     ENDIF                                          CFT009
012350200528      *                                                                   CFT009
012360200528     C                     ENDIF                                          CFT009
012370200528      *                                                                   CFT009
012380200528      *
012390200528     C           CER031    IFEQ 'Y'                                                           CER031
012400200528     C                     EXSR SRIPNR                                                        CER031
012410200528     C                     ENDIF                                                              CER031
012420200528      *                                                                                       CER031
012430200528     C           CFT004    IFEQ 'Y'                                                           CFT134
012440200528     C           CFT134    ANDEQ'Y'                                                           CFT134
012450200528     C                     EXSR SRGTIB                                                        CFT134
012460200528     C                     ENDIF                                                              CFT134
012470200528      *                                                                                       CFT134
012480200528     C           EXCR01    TAG
012490200528      *                                                                                       CCG015
012500200528     C                     EXSR POPGRS                                                        CCG015
012510200528      *
012520200528      **  Unwind subroutine stack name
012530200528     C                     MOVEA*BLANKS   @STK,Q
012540200528     C                     SUB  1         Q
012550200528      *
012560200528     C                     ENDSR
012570200528      *****************************************************************
012580200528     C/SPACE 5
012590200528      *****************************************************************
012600200528      * Subroutine  :  DRCR02                                         *
012610200528      * Function    :  Outgoing payments - DR Advices                 *
012620200528      *                                                               *
012630200528      * Called by   :  SRMAIN - Main Processing                       *
012640200528      * Calls       :                                                 *
012650200528      *****************************************************************
012660200528     C           DRCR02    BEGSR
012670200528      *
012680200528      **  Set up subroutine stack name
012690200528     C                     ADD  1         Q
012700200528     C                     MOVEL'DRCR02'  @STK,Q
012710200528      *
012720200528      *................................................................
012730200528      *
012740200528      **  Set up Path.
012750200528     C                     MOVEL'\DRCR02' ##PNAM  7
012760200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
012770200528      *                                                                                       CCG015
012780200528     C                     EXSR PSHGRS                                                        CCG015
012790200528      *
012800200528      **  Store Path
012810200528     C           1         OCUR ##SRDT
012820200528     C                     MOVELS#PATH    ##SPAT
012830200528      *
012840200528      ****Branch*Details**************                                    CFT009
012850200528     C*********************EXSR BRANCH                                    CFT009
012860200528      ********************************                                    CFT009
012870200528      ****Book*Details****************                                    CFT009
012880200528     C*********************EXSR BOOK                                      CFT009
012890200528      ********************************                                    CFT009
012900200528      ****Profit*Centre*Details*******                                    CFT009
012910200528     C*********************EXSR PROF@C                                    CFT009
012920200528      *                                                                   CFT009
012930200528      *   Branch, Book, Profit Centre Details                             CFT009
012940200528     C                     EXSR BBP                                       CFT009
012950200528      *
012960200528      **  FT Transaction Users
012970200528     C                     EXSR FT@USR
012980200528      ***********                                                         CFT014
012990200528      ****Payment*Main*Data********************************************   CFT014
013000200528     C***********          EXSR PAYMNT                                    CFT014
013010200528      **********                                                          087994
013020200528      ****Payment Secondary data                                          087994
013030200528     C**********           EXSR PAY@II                                    087994
013040200528      ***********                                                         CFT014
013050200528      ****Credit/Cheque*Currency***************************************   CFT014
013060200528     C***********          EXSR CR@CCY                                    CFT014
013070200528      ***********                                                         CFT014
013080200528      ****Debit*Currency***********************************************   CFT014
013090200528     C***********          EXSR DR@CCY                                    CFT014
013100200528     C           CFT014    IFEQ 'Y'                                       192761
013110200528      *                                                                   CFT014
013120200528      ** Payment Main data, Credit/Cheque currency, Debit Currency        CFT014
013130200528     C                     EXSR PYDRCR                                    CFT014
013140200528     C                     ELSE                                           192761
013150200528      *                                                                   192761
013160200528      **  Payment Main Data                                               192761
013170200528     C                     EXSR PAYMNT                                    192761
013180200528      *                                                                   192761
013190200528      **  Credit/Cheque Currency                                          192761
013200200528     C                     EXSR CR@CCY                                    192761
013210200528      *                                                                   192761
013220200528      **  Debit Currency                                                  192761
013230200528     C                     EXSR DR@CCY                                    192761
013240200528     C                     ENDIF                                          192761
013250200528      *                                                                   087994
013260200528      **  Payment Secondary data                                          087994
013270200528     C                     EXSR PAY@II                                    087994
013280200528      *                                                                                       CER049
013290200528      ** Stamp Tax data (if feature is switched on)                                           CER049
013300200528      *                                                                                       CER049
013310200528     C           CER049    IFEQ 'Y'                                                           CER049
013320200528     C                     EXSR FTSTAX                                                        CER049
013330200528     C                     ENDIF                                                              CER049
013340200528      *                                                                   CFT014
013350200528      **  Third Reimbursement Institution                                 CFT014
013360200528     C           CFT014    IFEQ 'Y'                                       CFT014
013370200528     C           OPTRIT    ANDNE*BLANK                                    CFT014
013380200528     C                     EXSR SRTRIB                                    CFT014
013390200528     C                     ENDIF                                          CFT014
013400200528      *
013410200528      **  Sender's Correspondant
013420200528     C                     EXSR SENDER
013430200528      *
013440200528      **  Ordering Institution
013450200528     C                     EXSR O@INST
013460200528      *
013470200528      **  Ordering Customer Details
013480200528     C                     EXSR O@CUST
013490200528     C/COPY WNCPYSRC,CG4630C006
013500200528      *
013510200528      **  Account with bank
013520200528     C                     EXSR AC@W@B
013530200528      *
013540200528      **  Beneficiary Details
013550200528     C                     EXSR BENEF
013560200528      *
013570200528      **  Details of Payment
013580200528     C                     EXSR PAYDET
013590200528      *
013600200528      **  Charges to the debit of
013610200528     C                     EXSR CG@DAC
013620200528      *
013630200528      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
013640200528      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
013650200528      **  (Only if CFT009 is off)                                         CFT009
013660200528      *                                                                   CEU006
013670200528     C           CEU006    IFEQ 'Y'                                       CEU006
013680200528     C           CFT009    ANDEQ'N'                                       CFT009
013690200528      *                                                                   CEU006
013700200528      **  Funds Transfer Delivery Details                                 CEU006
013710200528     C                     EXSR FT@DLV                                    CEU006
013720200528      *                                                                   CEU006
013730200528      **  Entered Charges                                                 CEU006
013740200528     C                     EXSR CHGENT                                    CEU006
013750200528      *                                                                   CEU006
013760200528      **  Euro Charges                                                    CEU006
013770200528     C                     EXSR CHGEUR                                    CEU006
013780200528      *                                                                   CEU006
013790200528     C                     ENDIF                                          CEU006
013800200528      *                                                                   CEU006
013810200528     C/COPY WNCPYSRC,CG4630C009
013820200528      *                                                                   CFT014
013830200528      ** Charge Transparency fields                                       CFT014
013840200528     C           CFT014    IFEQ 'Y'                                       CFT014
013850200528     C                     EXSR SRSRCH                                    CFT014
013860200528     C                     ENDIF                                          CFT014
013870200528      *                                                                   EAH010
013880200528      **  Destination                                                     EAH010
013890200528     C                     EXSR DESTIN                                    EAH010
013900200528      *                                                                   CFT009
013910200528      ** Fees and charges                                                 CFT009
013920200528      *                                                                   CFT009
013930200528     C           CFT009    IFEQ 'Y'                                       CFT009
013940200528      *                                                                   CFT009
013950200528      **  Funds Transfer Delivery Details                                 CFT009
013960200528      *                                                                   CFT009
013970200528     C           CEU006    IFEQ 'Y'                                       CFT009
013980200528     C                     EXSR FT@DLV                                    CFT009
013990200528     C                     ENDIF                                          CFT009
014000200528      *                                                                   CFT009
014010200528     C                     EXSR OTFEES                                    CFT009
014020200528      *                                                                   CFT009
014030200528      **  Entered Charges                                                 CFT009
014040200528     C                     EXSR OTENTC                                    CFT009
014050200528      *                                                                   CFT009
014060200528      **  Entered Charges VAT                                             CFT009
014070200528     C                     EXSR OTVATA                                    CFT009
014080200528      *                                                                   CFT009
014090200528     C           CEU006    IFEQ 'Y'                                       CFT009
014100200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
014110200528      *                                                                   CFT009
014120200528      **  Euro Charges                                                    CFT009
014130200528     C                     EXSR OTEURC                                    CFT009
014140200528      *                                                                   CFT009
014150200528      **  Euro Charges VAT                                                CFT009
014160200528     C                     EXSR OTVATE                                    CFT009
014170200528     C                     ENDIF                                          CFT009
014180200528      *                                                                   CFT009
014190200528     C                     ENDIF                                          CFT009
014200200528      *                                                                   CFT009
014210200528      *................................................................
014220200528      *
014230200528     C           CER031    IFEQ 'Y'                                                           CER031
014240200528     C                     EXSR SROPNR                                                        CER031
014250200528     C                     ENDIF                                                              CER031
014260200528      *                                                                                       CER031
014270200528     C           CFT004    IFEQ 'Y'                                                           CFT134
014280200528     C           CFT134    ANDEQ'Y'                                                           CFT134
014290200528     C                     EXSR SRGTIB                                                        CFT134
014300200528     C                     ENDIF                                                              CFT134
014310200528      *                                                                                       CFT134
014320200528     C           EXCR02    TAG
014330200528      *                                                                                       CCG015
014340200528     C                     EXSR POPGRS                                                        CCG015
014350200528      *
014360200528      **  Unwind subroutine stack name
014370200528     C                     MOVEA*BLANKS   @STK,Q
014380200528     C                     SUB  1         Q
014390200528      *
014400200528     C                     ENDSR
014410200528      *****************************************************************
014420200528     C/SPACE 5
014430200528      *****************************************************************
014440200528      * Subroutine  :  DRCR03                                         *
014450200528      * Function    :  Cheques to be paid                             *
014460200528      *                                                               *
014470200528      * Called by   :  SRMAIN - Main Processing                       *
014480200528      * Calls       :                                                 *
014490200528      *****************************************************************
014500200528     C           DRCR03    BEGSR
014510200528      *
014520200528      **  Set up subroutine stack name
014530200528     C                     ADD  1         Q
014540200528     C                     MOVEL'DRCR03'  @STK,Q
014550200528      *
014560200528      *................................................................
014570200528      *
014580200528      **  Set up Path.
014590200528     C                     MOVEL'\DRCR03' ##PNAM  7
014600200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
014610200528      *                                                                                       CCG015
014620200528     C                     EXSR PSHGRS                                                        CCG015
014630200528      *
014640200528      **  Store Path
014650200528     C           1         OCUR ##SRDT
014660200528     C                     MOVELS#PATH    ##SPAT
014670200528      *
014680200528      **  Branch Details
014690200528     C                     EXSR BRANCH
014700200528      *
014710200528      **  Book Details
014720200528     C                     EXSR BOOK
014730200528      *
014740200528      **  Profit Centre Details
014750200528     C                     EXSR PROF@C
014760200528      *
014770200528      **  FT Transaction Users
014780200528     C                     EXSR FT@USR
014790200528      *
014800200528      **  Payment Main Data
014810200528     C                     EXSR PAYMNT
014820200528      **********                                                          087994
014830200528      ****Payment Secondary data                                          087994
014840200528     C**********           EXSR PAY@II                                    087994
014850200528      *
014860200528      **  Credit/Cheque Currency
014870200528     C                     EXSR CR@CCY
014880200528      *
014890200528      **  Debit Currency
014900200528     C                     EXSR DR@CCY
014910200528      *                                                                   087994
014920200528      **  Payment Secondary data                                          087994
014930200528     C                     EXSR PAY@II                                    087994
014940200528      *                                                                                       CER049
014950200528      ** Stamp Tax data (if feature is switched on)                                           CER049
014960200528      *                                                                                       CER049
014970200528     C           CER049    IFEQ 'Y'                                                           CER049
014980200528     C                     EXSR FTSTAX                                                        CER049
014990200528     C                     ENDIF                                                              CER049
015000200528      *
015010200528      **  Sender's Correspondant
015020200528     C                     EXSR SENDER
015030200528      *
015040200528      **  Remit
015050200528     C                     EXSR REMIT
015060200528      *
015070200528      **  Debit Party
015080200528     C                     EXSR DR@PTY
015090200528      *
015100200528      **  Charges to the debit of
015110200528     C                     EXSR CG@DAC
015120200528     C/COPY WNCPYSRC,CG4630C016
015130200528      *
015140200528      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
015150200528      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
015160200528      **  (Only if CFT009 is off)                                         CFT009
015170200528      *                                                                   CEU006
015180200528     C           CEU006    IFEQ 'Y'                                       CEU006
015190200528     C           CFT009    ANDEQ'N'                                       CFT009
015200200528     C           CEU006    OREQ 'Y'                                                         BUG12648
015210200528     C           CFT009    ANDEQ'Y'                                                         BUG12648
015220200528     C           WALLOW    ANDEQ'N'                                                         BUG12648
015230200528      *                                                                   CEU006
015240200528      **  Funds Transfer Delivery Details                                 CEU006
015250200528     C                     EXSR FT@DLV                                    CEU006
015260200528      *                                                                   CEU006
015270200528      **  Entered Charges                                                 CEU006
015280200528     C                     EXSR CHGENT                                    CEU006
015290200528      *                                                                   CEU006
015300200528      **  Euro Charges                                                    CEU006
015310200528     C                     EXSR CHGEUR                                    CEU006
015320200528      *                                                                   CEU006
015330200528     C                     ENDIF                                          CEU006
015340200528      *                                                                   CEU006
015350200528     C/COPY WNCPYSRC,CG4630C022
015360200528      *                                                                   CFT009
015370200528      ** Fees and charges                                                 CFT009
015380200528      *                                                                   CFT009
015390200528     C           CFT009    IFEQ 'Y'                                       CFT009
015400200528     C           WALLOW    ANDEQ'Y'                                                         BUG12648
015410200528      *                                                                   CFT009
015420200528      **  Funds Transfer Delivery Details                                 CFT009
015430200528      *                                                                   CFT009
015440200528     C           CEU006    IFEQ 'Y'                                       CFT009
015450200528     C                     EXSR FT@DLV                                    CFT009
015460200528     C                     ENDIF                                          CFT009
015470200528      *                                                                   CFT009
015480200528     C                     EXSR CPFEES                                    CFT009
015490200528      *                                                                   CFT009
015500200528      **  Entered Charges                                                 CFT009
015510200528     C                     EXSR CPENTC                                    CFT009
015520200528      *                                                                   CFT009
015530200528      **  Entered Charges VAT                                             CFT009
015540200528     C                     EXSR CPVATA                                    CFT009
015550200528      *                                                                   CFT009
015560200528     C           CEU006    IFEQ 'Y'                                       CFT009
015570200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
015580200528      *                                                                   CFT009
015590200528      **  Euro Charges                                                    CFT009
015600200528     C                     EXSR CPEURC                                    CFT009
015610200528      *                                                                   CFT009
015620200528      **  Euro Charges VAT                                                CFT009
015630200528     C                     EXSR CPVATE                                    CFT009
015640200528     C                     ENDIF                                          CFT009
015650200528      *                                                                   CFT009
015660200528     C                     ENDIF                                          CFT009
015670200528      *                                                                   CFT009
015680200528      *................................................................
015690200528      *
015700200528     C           EXCR03    TAG
015710200528      *                                                                                       CCG015
015720200528     C                     EXSR POPGRS                                                        CCG015
015730200528      *
015740200528      **  Unwind subroutine stack name
015750200528     C                     MOVEA*BLANKS   @STK,Q
015760200528     C                     SUB  1         Q
015770200528      *
015780200528     C                     ENDSR
015790200528      *****************************************************************
015800200528     C/SPACE 5
015810200528      *****************************************************************
015820200528      * Subroutine  :  DRCR04                                         *
015830200528      * Function    :  Cheques for collection - Cr Advices            *
015840200528      *                                                               *
015850200528      * Called by   :  SRMAIN - Main Processing                       *
015860200528      * Calls       :                                                 *
015870200528      *****************************************************************
015880200528     C           DRCR04    BEGSR
015890200528      *
015900200528      **  Set up subroutine stack name
015910200528     C                     ADD  1         Q
015920200528     C                     MOVEL'DRCR04'  @STK,Q
015930200528      *
015940200528      *................................................................
015950200528      *
015960200528      **  Set up Path.
015970200528     C                     MOVEL'\DRCR04' ##PNAM  7
015980200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
015990200528      *                                                                                       CCG015
016000200528     C                     EXSR PSHGRS                                                        CCG015
016010200528      *
016020200528      **  Store Path
016030200528     C           1         OCUR ##SRDT
016040200528     C                     MOVELS#PATH    ##SPAT
016050200528      *
016060200528      **  Branch Details
016070200528     C                     EXSR BRANCH
016080200528      *
016090200528      **  Book Details
016100200528     C                     EXSR BOOK
016110200528      *
016120200528      **  Profit Centre Details
016130200528     C                     EXSR PROF@C
016140200528      *
016150200528      **  FT Transaction Users
016160200528     C                     EXSR FT@USR
016170200528      *
016180200528      **  Payment Main Data
016190200528     C                     EXSR PAYMNT
016200200528      **********                                                          087994
016210200528      ****Payment Secondary data                                          087994
016220200528     C**********           EXSR PAY@II                                    087994
016230200528      *
016240200528      **  Credit/Cheque Currency
016250200528     C                     EXSR CR@CCY
016260200528      *
016270200528      **  Debit Currency
016280200528     C                     EXSR DR@CCY
016290200528      *                                                                   087994
016300200528      **  Payment Secondary data                                          087994
016310200528     C                     EXSR PAY@II                                    087994
016320200528      *                                                                                       CER049
016330200528      ** Stamp Tax data (if feature is switched on)                                           CER049
016340200528      *                                                                                       CER049
016350200528     C           CER049    IFEQ 'Y'                                                           CER049
016360200528     C                     EXSR FTSTAX                                                        CER049
016370200528     C                     ENDIF                                                              CER049
016380200528      *
016390200528      **  Receiver's Correspondant
016400200528     C                     EXSR RECEVR
016410200528      *
016420200528      **  Collecting Institution
016430200528     C                     EXSR C@INST
016440200528      *
016450200528      **  Credit Party
016460200528     C                     EXSR CR@PTY
016470200528      *
016480200528      **  Narrative
016490200528     C                     EXSR NARR
016500200528      *
016510200528      **  Charges to the debit of
016520200528     C                     EXSR CG@DAC
016530200528     C/COPY WNCPYSRC,CG4630C021
016540200528      *
016550200528      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
016560200528      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
016570200528      **  (Only if CFT009 is off)                                         CFT009
016580200528      *                                                                   CEU006
016590200528     C           CEU006    IFEQ 'Y'                                       CEU006
016600200528     C           CFT009    ANDEQ'N'                                       CFT009
016610200528     C           CEU006    OREQ 'Y'                                                         BUG12648
016620200528     C           CFT009    ANDEQ'Y'                                                         BUG12648
016630200528     C           WALLOW    ANDEQ'N'                                                         BUG12648
016640200528      *                                                                   CEU006
016650200528      **  Funds Transfer Delivery Details                                 CEU006
016660200528     C                     EXSR FT@DLV                                    CEU006
016670200528      *                                                                   CEU006
016680200528      **  Entered Charges                                                 CEU006
016690200528     C                     EXSR CHGENT                                    CEU006
016700200528      *                                                                   CEU006
016710200528      **  Euro Charges                                                    CEU006
016720200528     C                     EXSR CHGEUR                                    CEU006
016730200528      *                                                                   CEU006
016740200528     C                     ENDIF                                          CEU006
016750200528      *                                                                   CEU006
016760200528     C/COPY WNCPYSRC,CG4630C023
016770200528      *                                                                   CFT009
016780200528      ** Fees and charges                                                 CFT009
016790200528      *                                                                   CFT009
016800200528     C           CFT009    IFEQ 'Y'                                       CFT009
016810200528     C           WALLOW    ANDEQ'Y'                                                         BUG12648
016820200528      *                                                                   CFT009
016830200528      **  Funds Transfer Delivery Details                                 CFT009
016840200528      *                                                                   CFT009
016850200528     C           CEU006    IFEQ 'Y'                                       CFT009
016860200528     C                     EXSR FT@DLV                                    CFT009
016870200528     C                     ENDIF                                          CFT009
016880200528      *                                                                   CFT009
016890200528     C                     EXSR CCFEES                                    CFT009
016900200528      *                                                                   CFT009
016910200528      **  Entered Charges                                                 CFT009
016920200528     C                     EXSR CCENTC                                    CFT009
016930200528      *                                                                   CFT009
016940200528      **  Entered Charges VAT                                             CFT009
016950200528     C                     EXSR CCVATA                                    CFT009
016960200528      *                                                                   CFT009
016970200528     C           CEU006    IFEQ 'Y'                                       CFT009
016980200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
016990200528      *                                                                   CFT009
017000200528      **  Euro Charges                                                    CFT009
017010200528     C                     EXSR CCEURC                                    CFT009
017020200528      *                                                                   CFT009
017030200528      **  Euro Charges VAT                                                CFT009
017040200528     C                     EXSR CCVATE                                    CFT009
017050200528     C                     ENDIF                                          CFT009
017060200528      *                                                                   CFT009
017070200528     C                     ENDIF                                          CFT009
017080200528      *                                                                   CFT009
017090200528      *................................................................
017100200528      *
017110200528     C           EXCR04    TAG
017120200528      *                                                                                       CCG015
017130200528     C                     EXSR POPGRS                                                        CCG015
017140200528      *
017150200528      **  Unwind subroutine stack name
017160200528     C                     MOVEA*BLANKS   @STK,Q
017170200528     C                     SUB  1         Q
017180200528      *
017190200528     C                     ENDSR
017200200528     C*****************************************************************
017210200528      /SPACE 5                                                            CFT006
017220200528      *****************************************************************   CFT006
017230200528      * Subroutine  :  DRCR05                                         *   CFT006
017240200528      * Function    :  Request for Transfer                           *   CFT006
017250200528      *                                                               *   CFT006
017260200528      * Called by   :  SRMAIN - Main Processing                       *   CFT006
017270200528      * Calls       :                                                 *   CFT006
017280200528      *****************************************************************   CFT006
017290200528     C           DRCR05    BEGSR                                          CFT006
017300200528      *                                                                   CFT006
017310200528      **  Set up subroutine stack name                                    CFT006
017320200528     C                     ADD  1         Q                               CFT006
017330200528     C                     MOVEL'DRCR05'  @STK,Q                          CFT006
017340200528      *                                                                   CFT006
017350200528      *................................................................   CFT006
017360200528      *                                                                   CFT006
017370200528      **  Set up Path.                                                    CFT006
017380200528     C                     MOVEL'\DRCR05' ##PNAM  7                       CFT006
017390200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
017400200528      *                                                                                       CCG015
017410200528     C                     EXSR PSHGRS                                                        CCG015
017420200528      *                                                                   CFT006
017430200528      **  Store Path                                                      CFT006
017440200528     C           1         OCUR ##SRDT                                    CFT006
017450200528     C                     MOVELS#PATH    ##SPAT                          CFT006
017460200528      *                                                                   CFT006
017470200528      ** Request for Transfer Details                                     CFT006
017480200528      *                                                                   CFT006
017490200528     C                     EXSR SRRFT                                     CFT006
017500200528     C                     EXSR SRRFI                                     CFT006
017510200528     C                     EXSR DR@CCY                                    CFT006
017520200528     C                     EXSR CR@CCY                                    CFT006
017530200528      *                                                                   CFT006
017540200528      ** Book Details                                                     CFT006
017550200528      *                                                                   CFT006
017560200528     C                     EXSR BOOK                                      CFT006
017570200528      *                                                                   CFT006
017580200528      ** Profit Centre Details                                            CFT006
017590200528      *                                                                   CFT006
017600200528     C                     EXSR PROF@C                                    CFT006
017610200528     C                     EXSR SRMT0                                     CFT006
017620200528     C                     EXSR SRMT1                                     CFT006
017630200528     C                     EXSR SRMT2                                     CFT006
017640200528      *                                                                   CFT009
017650200528      ** Fees and charges                                                 CFT009
017660200528      *                                                                   CFT009
017670200528     C           CFT009    IFEQ 'Y'                                       CFT009
017680200528     C           WALLOW    ANDEQ'Y'                                                         BUG12648
017690200528     C                     EXSR RFFEES                                    CFT009
017700200528      *                                                                   CFT009
017710200528      **  Entered Charges                                                 CFT009
017720200528     C                     EXSR RFENTC                                    CFT009
017730200528      *                                                                   CFT009
017740200528      **  Entered Charges VAT                                             CFT009
017750200528     C                     EXSR RFVATA                                    CFT009
017760200528      *                                                                   CFT009
017770200528     C           CEU006    IFEQ 'Y'                                       CFT009
017780200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
017790200528      *                                                                   CFT009
017800200528      **  Euro Charges                                                    CFT009
017810200528     C                     EXSR RFEURC                                    CFT009
017820200528      *                                                                   CFT009
017830200528      **  Euro Charges VAT                                                CFT009
017840200528     C                     EXSR RFVATE                                    CFT009
017850200528     C                     ENDIF                                          CFT009
017860200528      *                                                                   CFT009
017870200528     C                     ENDIF                                          CFT009
017880200528      *                                                                                       CCG015
017890200528     C                     EXSR POPGRS                                                        CCG015
017900200528      *                                                                   CFT006
017910200528     C                     ENDSR                                          CFT006
017920200528      *****************************************************************   CFT006
017930200528      /SPACE 5                                                            CFT006
017940200528      *****************************************************************   CFT008
017950200528      * Subroutine  :  DRCR06                                         *   CFT008
017960200528      * Function    :  Customer Credit Transfer                       *   CFT008
017970200528      *                                                               *   CFT008
017980200528      * Called by   :  SRMAIN - Main Processing                       *   CFT008
017990200528      * Calls       :                                                 *   CFT008
018000200528      *****************************************************************   CFT008
018010200528     C           DRCR06    BEGSR                                          CFT008
018020200528      *                                                                   CFT008
018030200528      **  Set up subroutine stack name                                    CFT008
018040200528     C                     ADD  1         Q                               CFT008
018050200528     C                     MOVEL'DRCR06'  @STK,Q                          CFT008
018060200528      *                                                                   CFT008
018070200528      *................................................................   CFT008
018080200528      *                                                                   CFT008
018090200528      **  Set up Path.                                                    CFT008
018100200528     C                     MOVEL'\DRCR06' ##PNAM  7                       CFT008
018110200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
018120200528      *                                                                                       CCG015
018130200528     C                     EXSR PSHGRS                                                        CCG015
018140200528      *                                                                   CFT008
018150200528      **  Store Path                                                      CFT008
018160200528     C           1         OCUR ##SRDT                                    CFT008
018170200528     C                     MOVELS#PATH    ##SPAT                          CFT008
018180200528      *                                                                   CFT008
018190200528      ** Customer Credit Transfer                                         CFT008
018200200528      *                                                                   CFT008
018210200528     C                     EXSR SRCCT                                     CFT008
018220200528     C                     EXSR DR@CCY                                    CFT008
018230200528     C                     EXSR CR@CCY                                    CFT008
018240200528     C                     EXSR SRCCI                                     CFT008
018250200528      ** Include 4 new Sender's Charges if CSW201 is on                                       CSW201
018260200528     C           CSW201    IFEQ 'Y'                                                           CSW201
018270200528     C                     EXSR SRSCGH                                                        CSW201
018280200528     C                     ENDIF                                                              CSW201
018290200528      *                                                                   CFT008
018300200528      ** Book Details                                                     CFT008
018310200528      *                                                                   CFT008
018320200528     C                     EXSR BOOK                                      CFT008
018330200528      *                                                                   CFT008
018340200528      ** Profit Centre Details                                            CFT008
018350200528      *                                                                   CFT008
018360200528     C                     EXSR PROF@C                                    CFT008
018370200528     C                     EXSR SRMT0                                     CFT008
018380200528     C                     EXSR SRMT1                                     CFT008
018390200528     C                     EXSR SRMT2                                     CFT008
018400200528      *                                                                   CFT009
018410200528      ** Fees and charges                                                 CFT009
018420200528      *                                                                   CFT009
018430200528     C           CFT009    IFEQ 'Y'                                       CFT009
018440200528     C           WALLOW    ANDEQ'Y'                                                         BUG12648
018450200528     C                     EXSR CTFEES                                    CFT009
018460200528      *                                                                   CFT009
018470200528      **  Entered Charges                                                 CFT009
018480200528     C                     EXSR CTENTC                                    CFT009
018490200528      *                                                                   CFT009
018500200528      **  Entered Charges VAT                                             CFT009
018510200528     C                     EXSR CTVATA                                    CFT009
018520200528      *                                                                   CFT009
018530200528     C           CEU006    IFEQ 'Y'                                       CFT009
018540200528     C           WCHGIN    ANDEQ'Y'                                       CFT009
018550200528      *                                                                   CFT009
018560200528      **  Euro Charges                                                    CFT009
018570200528     C                     EXSR CTEURC                                    CFT009
018580200528      *                                                                   CFT009
018590200528      **  Euro Charges VAT                                                CFT009
018600200528     C                     EXSR CTVATE                                    CFT009
018610200528     C                     ENDIF                                          CFT009
018620200528      *                                                                   CFT009
018630200528     C                     ENDIF                                          CFT009
018640200528      *                                                                                       CCG015
018650200528     C                     EXSR POPGRS                                                        CCG015
018660200528      *                                                                   CFT008
018670200528     C                     ENDSR                                          CFT008
018680200528      *****************************************************************   CFT008
018690200528     C/SPACE 5
018700200528      *****************************************************************
018710200528      * Subroutine  :  BRANCH                                         *
018720200528      * Function    :  Branch Details                                 *
018730200528      *                                                               *
018740200528      * Called by   :                                                 *
018750200528      * Calls       :                                                 *
018760200528      *****************************************************************
018770200528     C           BRANCH    BEGSR
018780200528      *
018790200528      **  Set up subroutine stack name
018800200528     C                     ADD  1         Q
018810200528     C                     MOVEL'BRANCH'  @STK,Q
018820200528      *
018830200528      *................................................................
018840200528      *
018850200528      **  Retrieve subroutine specific data.
018860200528     C           1         OCUR ##SRDT
018870200528     C                     MOVEL##SPAT    S#PATH
018880200528      *
018890200528      **  Set up Path.
018900200528     C                     MOVEL'\BRANCH' ##PNAM
018910200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
018920200528      *                                                                                       CCG015
018930200528     C                     EXSR PSHGRS                                                        CCG015
018940200528      *
018950200528      **  Retrieve RDE information for RDEs in group set
018960200528      *
018970200528     C                     MOVEL@STK,Q    ##GRPS
018980200528     C                     Z-ADD1         ##RDEN
018990200528     C                     EXSR SRRRDE
019000200528      *
019010200528      ** Get Branch Details
019020200528      *
019030200528     C**********           CALL 'AOBRCHR0'                                                    CGL029
019040200528     C                     CALL 'AOBRCHR1'                                                    CGL029
019050200528     C                     PARM '*MSG    '##RTCD
019060200528     C                     PARM '*KEY    '##OPTN
019070200528     C                     PARM BRCA      ##BRCD  3
019080200528     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
019090200528     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
019100200528      *
019110200528      ** DATABASE ERROR
019120200528      *
019130200528     C           ##RTCD    IFNE *BLANK
019140200528     C                     MOVEL'SDBRCHPD'W0FILE
019150200528     C                     MOVELBRCA      W0KEY            ***************
019160200528     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
019170200528     C                     MOVEL'MEM5004' W0MSGD           ***************
019180200528     C                     MOVEL'MIDAS  ' W0MSGF
019190200528     C                     EXSR SRERR
019200200528     C                     END
019210200528     C/COPY WNCPYSRC,CG4630C012
019220200528      *
019230200528      ** Branch
019240200528     C                     MOVELA8BRCD    ##D,1
019250200528      *
019260200528      ** Branch Name
019270200528     C                     MOVELA8BRNM    ##D,2
019280200528      *
019290200528     C/COPY WNCPYSRC,CG4630C013
019300200528      **  Accumulate RDE's and associated data and output to
019310200528      **  PF/CGUDTAPD.
019320200528     C                     EXSR SRADTA
019330200528     C                     EXSR SRODTA
019340200528      *
019350200528      *................................................................
019360200528      *
019370200528     C           EXBRCH    TAG
019380200528      *                                                                                       CCG015
019390200528     C                     EXSR POPGRS                                                        CCG015
019400200528      *
019410200528      **  Unwind subroutine stack name
019420200528     C                     MOVEA*BLANKS   @STK,Q
019430200528     C                     SUB  1         Q
019440200528      *
019450200528     C                     ENDSR
019460200528     C*****************************************************************
019470200528     C/SPACE 5
019480200528      *****************************************************************
019490200528      * Subroutine  :  BOOK                                           *
019500200528      * Function    :  Book Details                                   *
019510200528      *                                                               *
019520200528      * Called by   :                                                 *
019530200528      * Calls       :                                                 *
019540200528      *****************************************************************
019550200528     C           BOOK      BEGSR
019560200528      *
019570200528      **  Set up subroutine stack name
019580200528     C                     ADD  1         Q
019590200528     C                     MOVEL'BOOK  '  @STK,Q
019600200528      *
019610200528      *................................................................
019620200528      *
019630200528      **  Retrieve subroutine specific data.
019640200528     C           1         OCUR ##SRDT
019650200528     C                     MOVEL##SPAT    S#PATH
019660200528      *
019670200528      **  Set up Path.
019680200528     C                     MOVEL'\BOOK  ' ##PNAM
019690200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
019700200528      *                                                                                       CCG015
019710200528     C                     EXSR PSHGRS                                                        CCG015
019720200528      *
019730200528      **  Retrieve RDE information for RDEs in group set
019740200528      *
019750200528     C                     MOVEL@STK,Q    ##GRPS
019760200528     C                     Z-ADD1         ##RDEN
019770200528     C                     EXSR SRRRDE
019780200528      *
019790200528      ** Get Book Details
019800200528     C           BOKC      IFNE *BLANKS                                                     AR850312
019810200528     C                     CALL 'AOBOOKR0'
019820200528     C                     PARM *BLANKS   @RTCD
019830200528     C                     PARM '*KEY   ' @OPTN
019840200528     C                     PARM BOKC      @BOKC   2
019850200528     C           SDBOOK    PARM SDBOOK    DSFDY
019860200528      *
019870200528      ** DATABASE ERROR
019880200528      *
019890200528     C           @RTCD     IFNE *BLANK
019900200528     C                     MOVEL'SDBOOKPD'W0FILE
019910200528     C                     MOVELBOKC      W0KEY            ***************
019920200528     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
019930200528     C                     MOVEL'MEM5004' W0MSGD           ***************
019940200528     C                     MOVEL'MIDAS  ' W0MSGF
019950200528     C                     EXSR SRERR
019960200528     C                     END
019970200528     C                     ENDIF                                                            AR850312
019980200528      *
019990200528      ** Book Code
020000200528     C                     MOVELBOKC      ##D,1
020010200528      *
020020200528      ** Book Description
020030200528     C                     MOVELBDBKD     ##D,2
020040200528      *
020050200528      **  Accumulate RDE's and associated data and output to
020060200528      **  PF/CGUDTAPD.
020070200528     C                     EXSR SRADTA
020080200528     C                     EXSR SRODTA
020090200528      *
020100200528      *................................................................
020110200528      *
020120200528     C           EXOK      TAG
020130200528      *                                                                                       CCG015
020140200528     C                     EXSR POPGRS                                                        CCG015
020150200528      *
020160200528      **  Unwind subroutine stack name
020170200528     C                     MOVEA*BLANKS   @STK,Q
020180200528     C                     SUB  1         Q
020190200528      *
020200200528     C                     ENDSR
020210200528     C*****************************************************************
020220200528     C/SPACE 5
020230200528      *****************************************************************
020240200528      * Subroutine  :  PROF@C                                         *
020250200528      * Function    :  Book Details                                   *
020260200528      *                                                               *
020270200528      * Called by   :                                                 *
020280200528      * Calls       :                                                 *
020290200528      *****************************************************************
020300200528     C           PROF@C    BEGSR
020310200528      *
020320200528      **  Set up subroutine stack name
020330200528     C                     ADD  1         Q
020340200528     C                     MOVEL'PROF_C'  @STK,Q
020350200528      *
020360200528      *................................................................
020370200528      *
020380200528      **  Retrieve subroutine specific data.
020390200528     C           1         OCUR ##SRDT
020400200528     C                     MOVEL##SPAT    S#PATH
020410200528      *
020420200528      **  Set up Path.
020430200528     C                     MOVEL'\PROF_C' ##PNAM
020440200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
020450200528      *                                                                                       CCG015
020460200528     C                     EXSR PSHGRS                                                        CCG015
020470200528      *
020480200528      **  Retrieve RDE information for RDEs in group set
020490200528      *
020500200528     C                     MOVEL@STK,Q    ##GRPS
020510200528     C                     Z-ADD1         ##RDEN
020520200528     C                     EXSR SRRRDE
020530200528      *                                                                   086382
020540200528      **  Bypass if profit center blank.                                  086382
020550200528     C           PRFC      IFEQ *BLANKS                                   086382
020560200528     C                     GOTO EXOF@C                                    086382
020570200528     C                     ENDIF                                          086382
020580200528      *
020590200528      **  Obtain Profit Centre details
020600200528     C                     CALL 'AOPRFCR0'
020610200528     C                     PARM *BLANKS   @RTCD
020620200528     C                     PARM '*KEY   ' @OPTN
020630200528     C                     PARM PRFC      @KEY    4
020640200528     C           SDPRFC    PARM SDPRFC    DSFDY
020650200528      *
020660200528      ** DATABASE ERROR
020670200528      *
020680200528     C           @RTCD     IFNE *BLANK
020690200528     C                     MOVEL'SDPRFCPD'W0FILE
020700200528     C                     MOVELPRFC      W0KEY            ***************
020710200528     C                     Z-ADD3         W0ERNB           * DB ERROR 03 *
020720200528     C                     MOVEL'MEM5004' W0MSGD           ***************
020730200528     C                     MOVEL'MIDAS  ' W0MSGF
020740200528     C                     EXSR SRERR
020750200528     C                     END
020760200528      *
020770200528      ** Profit Centre
020780200528     C                     MOVELPRFC      ##D,1
020790200528      *
020800200528      ** Profit Centre Description
020810200528     C                     MOVELDSPCDS    ##D,2
020820200528      *
020830200528      **  Accumulate RDE's and associated data and output to
020840200528      **  PF/CGUDTAPD.
020850200528     C                     EXSR SRADTA
020860200528     C                     EXSR SRODTA
020870200528      *
020880200528      *................................................................
020890200528      *
020900200528     C           EXOF@C    TAG
020910200528      *                                                                                       CCG015
020920200528     C                     EXSR POPGRS                                                        CCG015
020930200528      *
020940200528      **  Unwind subroutine stack name
020950200528     C                     MOVEA*BLANKS   @STK,Q
020960200528     C                     SUB  1         Q
020970200528      *
020980200528     C                     ENDSR
020990200528     C*****************************************************************
021000200528     C/SPACE 5
021010200528      *****************************************************************
021020200528      * Subroutine  :  FT@USR                                         *
021030200528      * Function    :  FT Transaction Users                           *
021040200528      *                                                               *
021050200528      * Called by   :                                                 *
021060200528      * Calls       :                                                 *
021070200528      *****************************************************************
021080200528     C           FT@USR    BEGSR
021090200528      *
021100200528      **  Set up subroutine stack name
021110200528     C                     ADD  1         Q
021120200528     C                     MOVEL'FT_USR'  @STK,Q
021130200528      *
021140200528      *................................................................
021150200528      *
021160200528      **  Retrieve subroutine specific data.
021170200528     C           1         OCUR ##SRDT
021180200528     C                     MOVEL##SPAT    S#PATH
021190200528      *
021200200528      **  Set up Path.
021210200528     C                     MOVEL'\FT_USR' ##PNAM
021220200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
021230200528      *                                                                                       CCG015
021240200528     C                     EXSR PSHGRS                                                        CCG015
021250200528      *
021260200528      **  Retrieve RDE information for RDEs in group set
021270200528      *
021280200528     C                     MOVEL@STK,Q    ##GRPS
021290200528     C                     Z-ADD1         ##RDEN
021300200528     C                     EXSR SRRRDE
021310200528      *
021320200528      ** Input User 1
021330200528     C                     MOVELINUSR1    ##D,1
021340200528      *
021350200528      ** Input User 2
021360200528     C                     MOVELINUSR2    ##D,2
021370200528      *
021380200528      ** Authorising User 1
021390200528     C                     MOVELAUP1      ##D,3
021400200528      *
021410200528      ** Authorising User 2
021420200528     C                     MOVELAUP2      ##D,4
021430200528      *
021440200528      ** Input User 1 Description.
021450200528     C           INUSR1    CHAINMUSER                98
021460200528     C           *IN98     IFEQ *OFF
021470200528     C                     MOVELUSER1     ##D,5
021480200528     C                     ENDIF
021490200528      *
021500200528      ** Input User 2 Description.
021510200528     C           INUSR1    IFNE INUSR2
021520200528     C           INUSR2    CHAINMUSER                98
021530200528     C           *IN98     IFEQ *OFF
021540200528     C                     MOVELUSER1     ##D,6
021550200528     C                     ENDIF
021560200528     C                     ELSE
021570200528     C                     MOVELUSER1     ##D,6
021580200528     C                     ENDIF
021590200528      *
021600200528      ** Authorising User 1 Description.
021610200528     C           AUP1      CHAINMUSER                98
021620200528     C           *IN98     IFEQ *OFF
021630200528     C                     MOVELUSER1     ##D,7
021640200528     C                     ENDIF
021650200528      *
021660200528      ** Authorising User 1 Description.
021670200528     C           AUP1      IFNE AUP2
021680200528     C           AUP2      CHAINMUSER                98
021690200528     C           *IN98     IFEQ *OFF
021700200528     C                     MOVELUSER1     ##D,8
021710200528     C                     ENDIF
021720200528     C                     ELSE
021730200528     C                     MOVELUSER1     ##D,8
021740200528     C                     ENDIF
021750200528      *
021760200528      **  Accumulate RDE's and associated data and output to
021770200528      **  PF/CGUDTAPD.
021780200528     C                     EXSR SRADTA
021790200528     C                     EXSR SRODTA
021800200528      *
021810200528      *................................................................
021820200528      *
021830200528     C           EX@USR    TAG
021840200528      *                                                                                       CCG015
021850200528     C                     EXSR POPGRS                                                        CCG015
021860200528      *
021870200528      **  Unwind subroutine stack name
021880200528     C                     MOVEA*BLANKS   @STK,Q
021890200528     C                     SUB  1         Q
021900200528      *
021910200528     C                     ENDSR
021920200528     C*****************************************************************
021930200528     C/SPACE 5
021940200528      *****************************************************************
021950200528      * Subroutine  :  PAYMNT                                         *
021960200528      * Function    :  Payment - Main data                            *
021970200528      *                                                               *
021980200528      * Called by   :                                                 *
021990200528      * Calls       :                                                 *
022000200528      *****************************************************************
022010200528     C           PAYMNT    BEGSR
022020200528      *
022030200528      **  Set up subroutine stack name
022040200528     C                     ADD  1         Q
022050200528     C                     MOVEL'PAYMNT'  @STK,Q
022060200528      *
022070200528      *................................................................
022080200528      *
022090200528      **  Retrieve subroutine specific data.
022100200528     C           1         OCUR ##SRDT
022110200528     C                     MOVEL##SPAT    S#PATH
022120200528      *
022130200528      **  Set up Path.
022140200528     C                     MOVEL'\PAYMNT' ##PNAM
022150200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
022160200528      *                                                                                       CCG015
022170200528     C                     EXSR PSHGRS                                                        CCG015
022180200528      *
022190200528      **  Retrieve RDE information for RDEs in group set
022200200528      *
022210200528     C                     MOVEL@STK,Q    ##GRPS
022220200528     C                     Z-ADD1         ##RDEN
022230200528     C                     EXSR SRRRDE
022240200528      *
022250200528      **  Payment Reference
022260200528     C                     MOVELPREF      ##D,1
022270200528      *
022280200528      **  Value Date
022290200528     C                     SELEC
022300200528     C           ##FILE    WHEQ 'INPAY  '                  Ingoing  Payments
022310200528     C***********##FILE    OREQ 'OTPAY  '                  Outgoing Paymen087994
022320200528     C                     MOVELPVDT      ##D,2
022330200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087994
022340200528     C                     MOVELSLDT      ##D,2                           087994
022350200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
022360200528     C                     MOVELDRVD      ##D,2
022370200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
022380200528     C                     MOVELCRVD      ##D,2
022390200528     C                     ENDSL
022400200528      *
022410200528      **  Payment Date
022420200528     C                     MOVELBJRDNB    ##D,3
022430200528      *
022440200528      **  Payment Type
022450200528     C                     MOVELPYTP      ##D,4
022460200528      *
022470200528      **  Payment Sub-Type
022480200528     C                     MOVELPYST      ##D,5
022490200528      *
022500200528      **  Obtain Payment Sub-Type Description
022510200528     C                     CALL 'AODLSTR0'
022520200528     C                     PARM *BLANKS   @RTCD
022530200528     C                     PARM '*KEY   ' @OPTN
022540200528     C                     PARM PYST      @AQCD   3
022550200528     C           SDDLST    PARM SDDLST    DSFDY
022560200528      *
022570200528      ** DATABASE ERROR
022580200528      *
022590200528     C           @RTCD     IFNE *BLANK
022600200528     C                     MOVEL'SDDLSTPD'W0FILE
022610200528     C                     MOVELPYST      W0KEY            ***************
022620200528     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
022630200528     C                     MOVEL'MEM5004' W0MSGD           ***************
022640200528     C                     MOVEL'MIDAS  ' W0MSGF
022650200528     C                     EXSR SRERR
022660200528     C                     END
022670200528      *
022680200528      **  Payment Sub-Type Description
022690200528     C                     MOVELASDSTN    ##D,6
022700200528      *                                                                   095577
022710200528      * Set up Settle Method                                              095577
022720200528      *                                                                   095577
022730200528     C                     SELEC                                          095577
022740200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
022750200528     C                     MOVEL'00'      ##D,7                           095577
022760200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen095577
022770200528     C                     MOVELSTMT      ##D,7                           095577
022780200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
022790200528     C                     MOVELSTMT      ##D,7                           095577
022800200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
022810200528     C                     MOVEL'00'      ##D,7                           095577
022820200528     C                     ENDSL                                          095577
022830200528     C/COPY WNCPYSRC,CG4630C015
022840200528      *
022850200528      **  Accumulate RDE's and associated data and output to
022860200528      **  PF/CGUDTAPD.
022870200528     C                     EXSR SRADTA
022880200528     C                     EXSR SRODTA
022890200528      *
022900200528      *................................................................
022910200528      *
022920200528     C           EXYMNT    TAG
022930200528      *                                                                                       CCG015
022940200528     C                     EXSR POPGRS                                                        CCG015
022950200528      *
022960200528      **  Unwind subroutine stack name
022970200528     C                     MOVEA*BLANKS   @STK,Q
022980200528     C                     SUB  1         Q
022990200528      *
023000200528     C                     ENDSR
023010200528     C*****************************************************************
023020200528     C/SPACE 5
023030200528      *****************************************************************
023040200528      * Subroutine  :  PAY@II                                         *
023050200528      * Function    :  Payment - Secondary Data                       *
023060200528      *                                                               *
023070200528      * Called by   :                                                 *
023080200528      * Calls       :                                                 *
023090200528      *****************************************************************
023100200528     C           PAY@II    BEGSR
023110200528      *
023120200528      **  Set up subroutine stack name
023130200528     C                     ADD  1         Q
023140200528     C                     MOVEL'PAY_II'  @STK,Q
023150200528      *
023160200528      *................................................................
023170200528      *
023180200528      **  Retrieve subroutine specific data.
023190200528     C           1         OCUR ##SRDT
023200200528     C                     MOVEL##SPAT    S#PATH
023210200528      *
023220200528      **  Set up Path.
023230200528     C                     MOVEL'\PAY_II' ##PNAM
023240200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
023250200528      *                                                                                       CCG015
023260200528     C                     EXSR PSHGRS                                                        CCG015
023270200528      *
023280200528      **  Retrieve RDE information for RDEs in group set
023290200528      *
023300200528     C                     MOVEL@STK,Q    ##GRPS
023310200528     C                     Z-ADD1         ##RDEN
023320200528     C                     EXSR SRRRDE
023330200528      *
023340200528      **  Payment Exchange rate
023350200528     C                     MOVELRATE      ##D,1
023360200528      *
023370200528      **  Ascertain the correct currency code.
023380200528     C           *LIKE     DEFN ##CCY     #CCY
023390200528     C********** CDRO      IFNE *ZEROS                                                      BUG11679
023400200528     C           CDRO      IFNE *BLANKS                                                     BUG11679
023410200528     C           CFT120    IFEQ 'Y'                                                           CFT120
023420200528     C                     SELEC                                                              CFT120
023430200528      *                                                                                       CFT120
023440200528      ** Incoming payment                                                                     CFT120
023450200528      *                                                                                       CFT120
023460200528     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
023470200528     C           INCDRC    IFEQ *BLANKS                                                       CFT120
023480200528     C                     MOVELBJCYCD    #CCY                                                CFT120
023490200528     C                     ELSE                                                               CFT120
023500200528     C                     MOVELINCDRC    #CCY                                                CFT120
023510200528     C                     ENDIF                                                              CFT120
023520200528      *                                                                                       CFT120
023530200528      ** Outgoing payment                                                                     CFT120
023540200528      *                                                                                       CFT120
023550200528     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
023560200528     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
023570200528     C                     MOVELBJCYCD    #CCY                                                CFT120
023580200528     C                     ELSE                                                               CFT120
023590200528     C                     MOVELOPCDRC    #CCY                                                CFT120
023600200528     C                     ENDIF                                                              CFT120
023610200528     C                     OTHER                                                              CFT120
023620200528     C                     MOVELBJCYCD    #CCY                                                CFT120
023630200528     C                     ENDSL                                                              CFT120
023640200528     C                     ELSE                                                               CFT120
023650200528     C                     MOVELBJCYCD    #CCY
023660200528     C                     ENDIF                                                              CFT120
023670200528     C                     ELSE
023680200528      *                                                                   087994
023690200528      * Set charge currency depending on file being processed             087994
023700200528      *                                                                   087994
023710200528     C                     SELEC                                          087994
023720200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
023730200528     C           ##FILE    OREQ 'OTPAY  '                                 087994
023740200528     C           ADDC      IFEQ 'A'                                       087994
023750200528     C                     MOVELSMCY      #CCY                            087994
023760200528     C                     ELSE                                           087994
023770200528     C                     MOVELPCCY      #CCY                            087994
023780200528     C                     ENDIF                                          087994
023790200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
023800200528     C                     MOVELDRCY      #CCY                            087994
023810200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
023820200528     C                     MOVELCRCY      #CCY                            087994
023830200528     C                     ENDSL                                          087994
023840200528     C                     ENDIF
023850200528      *
023860200528      **  Charge currency
023870200528     C                     MOVEL#CCY      ##D,2
023880200528      *
023890200528      **  Obtain currency details
023900200528     C                     CALL 'AOCURRR0'
023910200528     C***********          PARM '*DBERR'  @RTCD   7                       087995
023920200528     C                     PARM *BLANKS   @RTCD   7                       087995
023930200528     C                     PARM '*KEY   ' @OPTN   7
023940200528     C                     PARM #CCY      @AJCD   3
023950200528     C           SDCURR    PARM SDCURR    DSSDY
023960200528      *
023970200528      ** DATABASE ERROR
023980200528      *
023990200528     C           @RTCD     IFNE *BLANK
024000200528     C                     MOVEL'SDCURRPD'W0FILE
024010200528     C                     MOVEL#CCY      W0KEY            ***************
024020200528     C                     Z-ADD9         W0ERNB           * DB ERROR 09 *
024030200528     C                     MOVEL'MEM5004' W0MSGD           ***************
024040200528     C                     MOVEL'MIDAS  ' W0MSGF
024050200528     C                     EXSR SRERR
024060200528     C                     END
024070200528     C/COPY WNCPYSRC,CG4630C001
024080200528      *
024090200528      **  Add/Deduct Flag
024100200528     C                     SELEC
024110200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024120200528     C           ##FILE    OREQ 'OTPAY  '
024130200528     C                     MOVELADDC      ##D,3
024140200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
024150200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
024160200528     C                     MOVEL'D'       ##D,3
024170200528     C                     ENDSL
024180200528      *
024190200528      **  Transfer Commission
024200200528     C/COPY WNCPYSRC,CG4630C024
024210200528     C                     MOVELTRCM      ##D,4
024220200528     C/COPY WNCPYSRC,CG4630C025
024230200528     C                     MOVE A6NBDP    ##D,4
024240200528      *
024250200528      **  FX/Charge Commission
024260200528     C                     SELEC
024270200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024280200528     C/COPY WNCPYSRC,CG4630C026
024290200528     C                     MOVELINCHCM    ##D,5
024300200528     C/COPY WNCPYSRC,CG4630C027
024310200528     C                     MOVE A6NBDP    ##D,5
024320200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
024330200528     C/COPY WNCPYSRC,CG4630C028
024340200528     C                     MOVELOPCHCM    ##D,5
024350200528     C/COPY WNCPYSRC,CG4630C029
024360200528     C                     MOVE A6NBDP    ##D,5
024370200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
024380200528     C/COPY WNCPYSRC,CG4630C030
024390200528     C                     MOVELPDCHCM    ##D,5
024400200528     C/COPY WNCPYSRC,CG4630C031
024410200528     C                     MOVE A6NBDP    ##D,5
024420200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
024430200528     C/COPY WNCPYSRC,CG4630C032
024440200528     C                     MOVELCCCHCM    ##D,5
024450200528     C/COPY WNCPYSRC,CG4630C033
024460200528     C                     MOVE A6NBDP    ##D,5
024470200528     C                     ENDSL
024480200528      *
024490200528      **  Telex Charge
024500200528     C                     SELEC
024510200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024520200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
024530200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
024540200528     C/COPY WNCPYSRC,CG4630C034
024550200528     C                     MOVELTXCH      ##D,6
024560200528     C/COPY WNCPYSRC,CG4630C035
024570200528     C                     MOVE A6NBDP    ##D,6
024580200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
024590200528     C                     MOVE *BLANKS   ##D,6
024600200528     C                     ENDSL
024610200528      *
024620200528      **  Cheque Charge
024630200528     C                     SELEC
024640200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024650200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
024660200528     C/COPY WNCPYSRC,CG4630C036
024670200528     C                     MOVELCQCH      ##D,7
024680200528     C/COPY WNCPYSRC,CG4630C037
024690200528     C                     MOVE A6NBDP    ##D,7
024700200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
024710200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
024720200528     C                     MOVEL*BLANKS   ##D,7
024730200528     C                     ENDSL
024740200528      *
024750200528      **  Costs Abroad
024760200528     C                     SELEC
024770200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024780200528     C                     MOVE *BLANKS   ##D,8
024790200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
024800200528     C           ##FILE    OREQ 'CQPAC  '                  Cheques to be paid
024810200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
024820200528     C/COPY WNCPYSRC,CG4630C038
024830200528     C                     MOVELCSTA      ##D,8
024840200528     C/COPY WNCPYSRC,CG4630C039
024850200528     C                     MOVE A6NBDP    ##D,8
024860200528     C                     ENDSL
024870200528      *
024880200528      **  SWIFT priority charge
024890200528     C                     SELEC
024900200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
024910200528     C           ##FILE    OREQ 'CQPAC  '                  Cheques to be paid
024920200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
024930200528     C                     MOVE *BLANKS   ##D,9
024940200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
024950200528     C/COPY WNCPYSRC,CG4630C040
024960200528     C                     MOVELSPCH      ##D,9
024970200528     C/COPY WNCPYSRC,CG4630C041
024980200528     C                     MOVE A6NBDP    ##D,9
024990200528     C                     ENDSL
025000200528      *
025010200528      **  Miscellaneous charge
025020200528     C                     SELEC
025030200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
025040200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
025050200528     C/COPY WNCPYSRC,CG4630C042
025060200528     C                     MOVELMSCH      ##D,10
025070200528     C/COPY WNCPYSRC,CG4630C043
025080200528     C                     MOVE A6NBDP    ##D,10
025090200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
025100200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
025110200528     C                     MOVE *BLANKS   ##D,10
025120200528     C                     ENDSL
025130200528      *
025140200528      **  VAT
025150200528     C                     SELEC
025160200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
025170200528     C/COPY WNCPYSRC,CG4630C044
025180200528     C                     MOVELINVATT    ##D,11
025190200528     C/COPY WNCPYSRC,CG4630C045
025200200528     C                     MOVE A6NBDP    ##D,11
025210200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
025220200528     C/COPY WNCPYSRC,CG4630C046
025230200528     C                     MOVELOPVATT    ##D,11
025240200528     C/COPY WNCPYSRC,CG4630C047
025250200528     C                     MOVE A6NBDP    ##D,11
025260200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
025270200528     C/COPY WNCPYSRC,CG4630C048
025280200528     C                     MOVELPDVATT    ##D,11
025290200528     C/COPY WNCPYSRC,CG4630C049
025300200528     C                     MOVE A6NBDP    ##D,11
025310200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
025320200528     C/COPY WNCPYSRC,CG4630C050
025330200528     C                     MOVELCCVATT    ##D,11
025340200528     C/COPY WNCPYSRC,CG4630C051
025350200528     C                     MOVE A6NBDP    ##D,11
025360200528     C                     ENDSL
025370200528      *
025380200528      **  Total Charge
025390200528     C           *LIKE     DEFN TXCH      #W110A
025400200528     C           *LIKE     DEFN TXCH      #W110B
025410200528     C           *LIKE     DEFN TXCH      #W110C
025420200528     C           *LIKE     DEFN TXCH      #W110D
025430200528     C           *LIKE     DEFN TXCH      #W110E
025440200528     C                     Z-ADD*ZEROS    #W110A
025450200528     C                     Z-ADD*ZEROS    #W110B
025460200528     C                     Z-ADD*ZEROS    #W110C
025470200528     C                     Z-ADD*ZEROS    #W110D
025480200528     C                     Z-ADD*ZEROS    #W110E
025490200528     C***********ADCH      ADD  TLCH      #W110E                          087994
025500200528     C***********TRCM      ADD  OPCHCM    #W110A                          087994
025510200528     C***********TXCH      ADD  CQCH      #W110B                          087994
025520200528     C***********CSTA      ADD  SPCH      #W110C                          087994
025530200528     C***********#W110C    ADD  MSCH      #W110C                          087994
025540200528      *                                                                   087994
025550200528      * Set charges depending on transaction type                         087994
025560200528      *                                                                   087994
025570200528     C                     SELEC                                          087994
025580200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
025590200528     C                     Z-ADDTRCM      #W110D                          087994
025600200528     C           #W110D    ADD  INCHCM    #W110D                          087994
025610200528     C           #W110D    ADD  TXCH      #W110D                          087994
025620200528     C           #W110D    ADD  CQCH      #W110D                          087994
025630200528     C           #W110D    ADD  ADCH      #W110D                          087994
025640200528     C           #W110D    ADD  TLCH      #W110D                          087994
025650200528     C           #W110D    ADD  MSCH      #W110D                          087994
025660200528     C           #W110D    ADD  INVATT    #W110D                          087994
025670200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087994
025680200528     C                     Z-ADDTRCM      #W110D                          087994
025690200528     C           #W110D    ADD  OPCHCM    #W110D                          087994
025700200528     C           #W110D    ADD  TXCH      #W110D                          087994
025710200528     C           #W110D    ADD  CQCH      #W110D                          087994
025720200528     C           #W110D    ADD  CSTA      #W110D                          087994
025730200528     C           #W110D    ADD  SPCH      #W110D                          087994
025740200528     C           #W110D    ADD  MSCH      #W110D                          087994
025750200528     C           #W110D    ADD  OPVATT    #W110D                          087994
025760200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
025770200528     C                     Z-ADDTRCM      #W110D                          087994
025780200528     C           #W110D    ADD  CCCHCM    #W110D                          087994
025790200528     C           #W110D    ADD  COLL      #W110D                          087994
025800200528     C           #W110D    ADD  CSTA      #W110D                          087994
025810200528     C           #W110D    ADD  TXCH      #W110D                          089214
025820200528     C           #W110D    ADD  CCVATT    #W110D                          087994
025830200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
025840200528     C                     Z-ADDTRCM      #W110D                          087994
025850200528     C           #W110D    ADD  PDCHCM    #W110D                          087994
025860200528     C           #W110D    ADD  COLL      #W110D                          087994
025870200528     C           #W110D    ADD  CSTA      #W110D                          087994
025880200528     C           #W110D    ADD  PDVATT    #W110D                          087994
025890200528     C                     ENDSL                                          087994
025900200528      *                                                                   087994
025910200528      * Calculate total charges                                           087994
025920200528      *                                                                   087994
025930200528      ***********                                                         087994
025940200528     C***********#W110A    ADD  #W110B    #W110D                          087994
025950200528     C***********#W110D    ADD  #W110C    #W110D                          087994
025960200528     C***********#W110D    ADD  #W110E    #W110D                          087994
025970200528     C/COPY WNCPYSRC,CG4630C052
025980200528     C                     MOVEL#W110D    ##D,12
025990200528     C/COPY WNCPYSRC,CG4630C053
026000200528     C                     MOVE A6NBDP    ##D,12
026010200528      *
026020200528      **  Net Amount
026030200528     C           *LIKE     DEFN #W110D    #NETA
026040200528     C                     Z-ADD*ZEROS    #NETA
026050200528      *
026060200528      * Set up net amount depending on file being processed               087994
026070200528      *                                                                   087994
026080200528     C                     SELEC                                          087994
026090200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
026100200528     C           ##FILE    OREQ 'OTPAY  '                                 087994
026110200528     C********** CDRO      IFNE *ZEROS                     B1                               BUG11679
026120200528     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
026130200528     C           ADDC      IFEQ 'A'                        B*2
026140200528     C                     Z-ADDSMAM      #NETA
026150200528     C                     ELSE                            X*2
026160200528     C                     Z-ADDPYAM      #NETA
026170200528     C                     ENDIF                           E*2
026180200528     C                     ELSE                            X1
026190200528     C           ADDC      IFEQ 'A'                        B*2
026200200528     C           SMAM      ADD  #W110D    #NETA
026210200528     C                     ELSE                            X*2
026220200528     C           PYAM      SUB  #W110D    #NETA
026230200528     C                     ENDIF                           E*2
026240200528     C                     ENDIF                           E1
026250200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
026260200528     C********** CDRO      IFNE *ZEROS                     B1                        087944 BUG11679
026270200528     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
026280200528     C                     Z-ADDW#AMT     #NETA                           087994
026290200528     C                     ELSE                            X1             087994
026300200528     C           W#AMT     ADD  #W110D    #NETA                           087994
026310200528     C                     ENDIF                           X1             087994
026320200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
026330200528     C********** CDRO      IFNE *ZEROS                     B1                        087944 BUG11679
026340200528     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
026350200528     C                     Z-ADDW#AMT     #NETA                           087994
026360200528     C                     ELSE                            X1             087994
026370200528     C           W#AMT     SUB  #W110D    #NETA                           087994
026380200528     C                     ENDIF                           X1             087994
026390200528     C                     ENDSL                                          087994
026400200528      *
026410200528     C/COPY WNCPYSRC,CG4630C054
026420200528     C                     MOVEL#NETA     ##D,13
026430200528     C/COPY WNCPYSRC,CG4630C055
026440200528     C                     MOVE A6NBDP    ##D,13
026450200528      *
026460200528      **  Details of charges
026470200528     C                     SELEC
026480200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
026490200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
026500200528     C                     MOVELDTCH      ##D,14
026510200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
026520200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
026530200528     C                     MOVE *BLANKS   ##D,14
026540200528     C                     ENDSL
026550200528      *
026560200528      **  Related Reference
026570200528     C                     SELEC
026580200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
026590200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
026600200528     C                     MOVELRLPR      ##D,15
026610200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
026620200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
026630200528     C                     MOVE *BLANKS   ##D,15
026640200528     C                     ENDSL
026650200528      *
026660200528      **  Collection Charge
026670200528     C                     SELEC
026680200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
026690200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
026700200528     C                     MOVE *BLANKS   ##D,16
026710200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
026720200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
026730200528     C/COPY WNCPYSRC,CG4630C056
026740200528     C                     MOVELCOLL      ##D,16
026750200528     C/COPY WNCPYSRC,CG4630C057
026760200528     C                     MOVE A6NBDP    ##D,16
026770200528     C                     ENDSL
026780200528      *
026790200528      **  Telephone Charge
026800200528     C                     SELEC
026810200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
026820200528     C/COPY WNCPYSRC,CG4630C058
026830200528     C                     MOVELTLCH      ##D,17
026840200528     C/COPY WNCPYSRC,CG4630C059
026850200528     C                     MOVE A6NBDP    ##D,17
026860200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
026870200528     C           ##FILE    OREQ 'CQPAC  '                  Outgoing Payments
026880200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
026890200528     C                     MOVE *BLANKS   ##D,17
026900200528     C                     ENDSL
026910200528      *
026920200528      **  Advice Charge
026930200528     C                     SELEC
026940200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
026950200528     C/COPY WNCPYSRC,CG4630C060
026960200528     C                     MOVELADCH      ##D,18
026970200528     C/COPY WNCPYSRC,CG4630C061
026980200528     C                     MOVE A6NBDP    ##D,18
026990200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
027000200528     C           ##FILE    OREQ 'CQPAC  '                  Outgoing Payments
027010200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
027020200528     C                     MOVE *BLANKS   ##D,18
027030200528     C                     ENDSL
027040200528      *
027050200528      **  Deductions
027060200528     C           ##FILE    IFEQ 'CQPAC  '                  Cheques to be paid
027070200528     C/COPY WNCPYSRC,CG4630C062
027080200528     C                     MOVELDEDS      ##D,19
027090200528     C/COPY WNCPYSRC,CG4630C063
027100200528     C                     MOVE A6NBDP    ##D,19
027110200528     C                     ELSE
027120200528     C                     MOVE *BLANKS   ##D,19
027130200528     C                     ENDIF
027140200528      *
027150200528      **  Accumulate RDE's and associated data and output to
027160200528      **  PF/CGUDTAPD.
027170200528     C                     EXSR SRADTA
027180200528     C                     EXSR SRODTA
027190200528      *
027200200528      *................................................................
027210200528      *
027220200528     C           EXY@II    TAG
027230200528      *                                                                                       CCG015
027240200528     C                     EXSR POPGRS                                                        CCG015
027250200528      *
027260200528      **  Unwind subroutine stack name
027270200528     C                     MOVEA*BLANKS   @STK,Q
027280200528     C                     SUB  1         Q
027290200528      *
027300200528     C                     ENDSR
027310200528     C*****************************************************************
027320200528     C/SPACE 5                                                                                CER049
027330200528      *****************************************************************                       CER049
027340200528      * Subroutine  :  FTSTAX                                         *                       CER049
027350200528      * Function    :  Extract Stamp Tax information                  *                       CER049
027360200528      *                                                               *                       CER049
027370200528      * Called by   : DRCR01, DRCR02, DRCR03. DRCR04                  *                       CER049
027380200528      * Calls       :                                                 *                       CER049
027390200528      *****************************************************************                       CER049
027400200528     C           FTSTAX    BEGSR                                                              CER049
027410200528      *                                                                                       CER049
027420200528      ** Set up subroutine stack name                                                         CER049
027430200528      *                                                                                       CER049
027440200528     C                     ADD  1         Q                                                   CER049
027450200528     C                     MOVEL'FTSTAX'  @STK,Q                                              CER049
027460200528      *                                                                                       CER049
027470200528      *................................................................                       CER049
027480200528      *                                                                                       CER049
027490200528      ** Retrieve subroutine specific data.                                                   CER049
027500200528      *                                                                                       CER049
027510200528     C           1         OCUR ##SRDT                                                        CER049
027520200528     C                     MOVEL##SPAT    S#PATH                                              CER049
027530200528      *                                                                                       CER049
027540200528      ** Set up Path.                                                                         CER049
027550200528      *                                                                                       CER049
027560200528     C                     MOVEL'\FTSTAX' ##PNAM                                              CER049
027570200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER049
027580200528      *                                                                                       CER049
027590200528     C                     EXSR PSHGRS                                                        CER049
027600200528      *                                                                                       CER049
027610200528      ** Retrieve RDE information for RDEs in group set                                       CER049
027620200528      *                                                                                       CER049
027630200528     C                     MOVEL@STK,Q    ##GRPS                                              CER049
027640200528     C                     Z-ADD1         ##RDEN                                              CER049
027650200528     C                     EXSR SRRRDE                                                        CER049
027660200528      *                                                                                       CER049
027670200528      ** Set up key for Stamp Tax file                                                        CER049
027680200528      *                                                                                       CER049
027690200528     C           *LIKE     DEFN QCPREF    K1PREF                                              CER049
027700200528     C           *LIKE     DEFN QCCQSQ    K1CQSQ                                              CER049
027710200528      *                                                                                       CER049
027720200528     C           STKEY     KLIST                                                              CER049
027730200528     C                     KFLD           K1PREF                                              CER049
027740200528     C                     KFLD           K1CQSQ                                              CER049
027750200528      *                                                                                       CER049
027760200528     C                     MOVE ##PREF    K1PREF                                              CER049
027770200528     C                     MOVE ##CQSQ    K1CQSQ                                              CER049
027780200528     C                     SETON                     98                                       CER049
027790200528      *                                                                                       CER049
027800200528     C                     SELEC                                                              CER049
027810200528     C           ##FILE    WHEQ 'INPAY  '                                                     CER049
027820200528     C                     MOVEL'I/OPAY'  U#ORGN                                              CER049
027830200528      *                                                                                       CER049
027840200528      ** Retrieve the FT Payments record                                                      CER049
027850200528      *                                                                                       CER049
027860200528     C           K1PREF    CHAININPAYQL0             98                                       CER049
027870200528      *                                                                                       CER049
027880200528      ** If record found, extract stamp tax data                                              CER049
027890200528      *                                                                                       CER049
027900200528     C           *IN98     IFEQ *OFF                                                          CER049
027910200528      *                                                                                       CER049
027920200528      ** Stamp Tax Liable Flag                                                                CER049
027930200528      *                                                                                       CER049
027940200528     C                     MOVELIPTAX     ##D,1                                               CER049
027950200528      *                                                                                       CER049
027960200528      ** Stamp Tax Amount                                                                     CER049
027970200528      *                                                                                       CER049
027980200528     C                     MOVELIPSTAF    ##D,2                                               CER049
027990200528      *                                                                                       CER049
028000200528     C                     MOVE IPCDTE    U#DATE                                              CER049
028010200528     C                     ENDIF                                                              CER049
028020200528      *                                                                                       CER049
028030200528     C           ##FILE    WHEQ 'OTPAY  '                                                     CER049
028040200528     C                     MOVEL'I/OPAY'  U#ORGN                                              CER049
028050200528      *                                                                                       CER049
028060200528      ** Retrieve the FT Payments record                                                      CER049
028070200528      *                                                                                       CER049
028080200528     C           K1PREF    CHAINOTPAYQL0             98                                       CER049
028090200528      *                                                                                       CER049
028100200528      ** If record found, extract stamp tax data                                              CER049
028110200528      *                                                                                       CER049
028120200528     C           *IN98     IFEQ *OFF                                                          CER049
028130200528      *                                                                                       CER049
028140200528      ** Stamp Tax Liable Flag                                                                CER049
028150200528      *                                                                                       CER049
028160200528     C                     MOVELOTTAX     ##D,1                                               CER049
028170200528      *                                                                                       CER049
028180200528      ** Stamp Tax Amount                                                                     CER049
028190200528      *                                                                                       CER049
028200200528     C                     MOVELOTSTAF    ##D,2                                               CER049
028210200528      *                                                                                       CER049
028220200528     C                     MOVE OTCDTE    U#DATE                                              CER049
028230200528     C                     ENDIF                                                              CER049
028240200528      *                                                                                       CER049
028250200528     C           ##FILE    WHEQ 'CQPAC  '                                                     CER049
028260200528     C                     MOVEL'I/OCHEQ' U#ORGN                                              CER049
028270200528      *                                                                                       CER049
028280200528      ** Retrieve the FT Payments record                                                      CER049
028290200528      *                                                                                       CER049
028300200528     C           STKEY     CHAINCQPACQL0             98                                       CER049
028310200528      *                                                                                       CER049
028320200528      ** If record found, extract stamp tax data                                              CER049
028330200528      *                                                                                       CER049
028340200528     C           *IN98     IFEQ *OFF                                                          CER049
028350200528      *                                                                                       CER049
028360200528      ** Stamp Tax Liable Flag                                                                CER049
028370200528      *                                                                                       CER049
028380200528     C                     MOVELQPTAX     ##D,1                                               CER049
028390200528      *                                                                                       CER049
028400200528      ** Stamp Tax Amount                                                                     CER049
028410200528      *                                                                                       CER049
028420200528     C                     MOVELQPSTAF    ##D,2                                               CER049
028430200528      *                                                                                       CER049
028440200528     C                     MOVE QPCDTE    U#DATE                                              CER049
028450200528     C                     ENDIF                                                              CER049
028460200528      *                                                                                       CER049
028470200528     C           ##FILE    WHEQ 'CQCOD  '                                                     CER049
028480200528     C                     MOVEL'I/OCHEQ' U#ORGN                                              CER049
028490200528      *                                                                                       CER049
028500200528      ** Retrieve the FT Payments record                                                      CER049
028510200528      *                                                                                       CER049
028520200528     C           STKEY     CHAINCQCOCQL0             98                                       CER049
028530200528      *                                                                                       CER049
028540200528      ** If record found, extract stamp tax data                                              CER049
028550200528      *                                                                                       CER049
028560200528     C           *IN98     IFEQ *OFF                                                          CER049
028570200528      *                                                                                       CER049
028580200528      ** Stamp Tax Liable Flag                                                                CER049
028590200528      *                                                                                       CER049
028600200528     C                     MOVELQCTAX     ##D,1                                               CER049
028610200528      *                                                                                       CER049
028620200528      ** Stamp Tax Amount                                                                     CER049
028630200528      *                                                                                       CER049
028640200528     C                     MOVELQCSTAF    ##D,2                                               CER049
028650200528      *                                                                                       CER049
028660200528     C                     MOVE QCCDTE    U#DATE                                              CER049
028670200528     C                     ENDIF                                                              CER049
028680200528      *                                                                                       CER049
028690200528     C                     ENDSL                                                              CER049
028700200528      *                                                                                       CER049
028710200528     C           *IN98     IFEQ *OFF                                                          CER049
028720200528     C                     CALL 'SD008141'                                                    CER049
028730200528     C                     PARM           U#DATE  50                                          CER049
028740200528     C                     PARM           U#ORGN 10                                           CER049
028750200528     C                     PARM *BLANKS   ##TYPE  4                                           CER049
028760200528     C                     PARM           U#CTAX 138                                          CER049
028770200528     C                     PARM           U#MTAX 138                                          CER049
028780200528     C                     PARM           U#CCCY  3                                           CER049
028790200528     C                     PARM           U#MCCY  3                                           CER049
028800200528     C                     PARM           U#CSCC  2                                           CER049
028810200528     C                     PARM           U#MSCC  2                                           CER049
028820200528     C                     PARM           U#TXTY  1                                           CER049
028830200528     C                     PARM           SDSTPD                                              CER049
028840200528      *                                                                                       CER049
028850200528      ** If there is a default for the Module use this tax rate and ccy                       CER049
028860200528      ** otherwise use the ICD Control defaults.                                              CER049
028870200528      *                                                                                       CER049
028880200528     C           U#MTAX    IFNE *ZEROS                                                        CER049
028890200528     C                     MOVE U#MCCY    U#SCCY  3                                           CER049
028900200528     C                     ELSE                                                               CER049
028910200528     C                     MOVE U#CCCY    U#SCCY                                              CER049
028920200528     C                     ENDIF                                                              CER049
028930200528      *                                                                                       CER049
028940200528      ** If currencies are blank, Stamp Tax feature may be on but not yet active            MD038960
028950200528     C           U#SCCY    IFEQ *BLANKS                                                     MD038960
028960200528     C                     MOVEL*BLANKS   ##D,1                                             MD038960
028970200528     C                     MOVEL*BLANKS   ##D,2                                             MD038960
028980200528     C                     ELSE                                                             MD038960
028990200528      *                                                                                     MD038960
029000200528      ** Stamp Tax Amount                                                                     CER049
029010200528      *                                                                                       CER049
029020200528     C                     CALL 'AOCURRR0'                                                    CER049
029030200528     C                     PARM *BLANKS   @RTCD                                               CER049
029040200528     C                     PARM '*KEY   ' @OPTN                                               CER049
029050200528     C                     PARM           U#SCCY                                              CER049
029060200528     C           SDCURR    PARM SDCURR    DSSDY                                               CER049
029070200528      *                                                                                       CER049
029080200528      ** DATABASE ERROR                                                                       CER049
029090200528      *                                                                                       CER049
029100200528     C           @RTCD     IFNE *BLANK                                                        CER049
029110200528     C                     MOVEL'SDCURRPD'W0FILE                                              CER049
029120200528     C                     MOVELU#SCCY    W0KEY            ***************                    CER049
029130200528     C                     Z-ADD68        W0ERNB           * DB ERROR 68 *                    CER049
029140200528     C                     MOVEL'MEM5004' W0MSGD           ***************                    CER049
029150200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
029160200528     C                     EXSR SRERR                                                         CER049
029170200528     C                     ENDIF                                                              CER049
029180200528      *                                                                                       CER049
029190200528     C                     MOVE A6NBDP    ##D,2                                               CER049
029200200528      *                                                                                       CER049
029210200528     C                     ENDIF                                                              CER049
029220200528     C                     ENDIF                                                            MD038960
029230200528      *                                                                                       CER049
029240200528      ** Accumulate RDE's and associated data and output to                                   CER049
029250200528      ** PF/CGUDTAPD.                                                                         CER049
029260200528      *                                                                                       CER049
029270200528     C                     EXSR SRADTA                                                        CER049
029280200528     C                     EXSR SRODTA                                                        CER049
029290200528      *                                                                                       CER049
029300200528      *................................................................                       CER049
029310200528      *                                                                                       CER049
029320200528     C           EXSTAX    TAG                                                                CER049
029330200528      *                                                                                       CER049
029340200528     C                     EXSR POPGRS                                                        CER049
029350200528      *                                                                                       CER049
029360200528      **  Unwind subroutine stack name                                                        CER049
029370200528      *                                                                                       CER049
029380200528     C                     MOVEA*BLANKS   @STK,Q                                              CER049
029390200528     C                     SUB  1         Q                                                   CER049
029400200528      *                                                                                       CER049
029410200528     C                     ENDSR                                                              CER049
029420200528      *****************************************************************                       CER049
029430200528     C/SPACE 5
029440200528      *****************************************************************
029450200528      * Subroutine  :  CR@CCY                                         *
029460200528      * Function    :  Credit/Cheque Currency                         *
029470200528      *                                                               *
029480200528      * Called by   :                                                 *
029490200528      * Calls       :                                                 *
029500200528      *****************************************************************
029510200528     C           CR@CCY    BEGSR
029520200528      *
029530200528      **  Set up subroutine stack name
029540200528     C                     ADD  1         Q
029550200528     C                     MOVEL'CR_CCY'  @STK,Q
029560200528      *
029570200528      *................................................................
029580200528      *
029590200528      **  Retrieve subroutine specific data.
029600200528     C           1         OCUR ##SRDT
029610200528     C                     MOVEL##SPAT    S#PATH
029620200528      *
029630200528      **  Set up Path.
029640200528     C                     MOVEL'\CR_CCY' ##PNAM
029650200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
029660200528      *                                                                                       CCG015
029670200528     C                     EXSR PSHGRS                                                        CCG015
029680200528      *
029690200528      **  Retrieve RDE information for RDEs in group set
029700200528      *
029710200528     C                     MOVEL@STK,Q    ##GRPS
029720200528     C                     Z-ADD1         ##RDEN
029730200528     C                     EXSR SRRRDE
029740200528      *
029750200528      **  Credit Cheque/Currency
029760200528     C                     SELEC
029770200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
029780200528     C                     MOVELCRCY      ##D,1
029790200528     C                     MOVELCRCY      @AJCD
029800200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
029810200528     C           ##FILE    OREQ 'FT102H '                                 CFT008
029820200528     C                     MOVELPAYCCY    ##D,1                           CFT006
029830200528     C                     MOVELPAYCCY    @AJCD                           CFT006
029840200528     C                     OTHER
029850200528     C                     MOVELPCCY      ##D,1
029860200528     C                     MOVELPCCY      @AJCD
029870200528     C                     ENDSL
029880200528      *
029890200528      **  Obtain currency details
029900200528     C           @AJCD     IFNE *BLANKS                                                     BUG15265
029910200528     C                     CALL 'AOCURRR0'
029920200528     C***********          PARM '*DBERR'  @RTCD   7                       087995
029930200528     C                     PARM *BLANKS   @RTCD   7                       087995
029940200528     C                     PARM '*KEY   ' @OPTN   7
029950200528     C                     PARM           @AJCD   3
029960200528     C           SDCURR    PARM SDCURR    DSSDY
029970200528      *
029980200528      ** DATABASE ERROR
029990200528      *
030000200528     C           @RTCD     IFNE *BLANK
030010200528     C                     MOVEL'SDCURRPD'W0FILE
030020200528     C                     MOVELPCCY      W0KEY            ***************
030030200528     C                     Z-ADD10        W0ERNB           * DB ERROR 10 *
030040200528     C                     MOVEL'MEM5004' W0MSGD           ***************
030050200528     C                     MOVEL'MIDAS  ' W0MSGF
030060200528     C                     EXSR SRERR
030070200528     C                     END
030080200528     C/COPY WNCPYSRC,CG4630C002
030090200528      *
030100200528      **  Credit/Cheque Currency Name
030110200528     C                     MOVELA6CYNM    ##D,2
030120200528     C                     ENDIF                                                            BUG15265
030130200528      *
030140200528      **  Credit/Cheque Amount
030150200528     C                     SELEC
030160200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
030170200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
030180200528     C/COPY WNCPYSRC,CG4630C064
030190200528     C                     MOVELPYAM      ##D,3
030200200528     C/COPY WNCPYSRC,CG4630C065
030210200528     C                     MOVE A6NBDP    ##D,3
030220200528     C           ##FILE    WHEQ 'CQPAC  '
030230200528     C/COPY WNCPYSRC,CG4630C066
030240200528     C                     MOVELCQAM      ##D,3
030250200528     C/COPY WNCPYSRC,CG4630C067
030260200528     C                     MOVE A6NBDP    ##D,3                           087994
030270200528     C***********##FILE    OREQ 'CQCOD  '                  Cheques for col087994
030280200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
030290200528     C***********          MOVELCQAM      ##D,3                           087994
030300200528      *                                                                   087994
030310200528      * Calculate Credit currency equivalent                              087994
030320200528      *                                                                   087994
030330200528     C           MDIN      IFEQ 0                                         087994
030340200528     C                     MOVEL'D'       I#MDIN                          087994
030350200528     C                     ELSE                                           087994
030360200528     C                     MOVEL'M'       I#MDIN                          087994
030370200528     C                     END                                            087994
030380200528     C                     Z-ADDRATE      I#RATE                          087994
030390200528     C                     Z-ADDCQAM      D#FAMT                          087994
030400200528     C                     MOVELSMCY      D#FCCY                          087994
030410200528     C                     MOVELCRCY      D#TCCY                          087994
030420200528     C                     CALL 'AOCCYCV0'             9090               087994
030430200528     C           R#RTN     PARM *BLANKS   O#RTN   7                       087994
030440200528     C                     PARM '*F*T*RAT'W0ACT   8                       087994
030450200528     C           D#DTA     PARM D#DTA     O#DTA 256                       087994
030460200528      *                                                                   087994
030470200528     C           *IN90     IFEQ '1'                                       087994
030480200528     C           R#RTN     ORNE *BLANKS                                   087994
030490200528     C                     MOVEL'*CALL   'W0FILE                          087994
030500200528     C                     MOVEL'AOCCYCV0'W0KEY            ***************087994
030510200528     C                     Z-ADD15        W0ERNB           * DB ERROR 15 *087994
030520200528     C                     MOVEL'MEM5003' W0MSGD           ***************087994
030530200528     C                     MOVEL'MIDAS  ' W0MSGF                          087994
030540200528     C                     EXSR SRERR                                     087994
030550200528     C                     END                                            087994
030560200528      *                                                                   087994
030570200528     C                     Z-ADDD#TAMT    W#AMT                           087994
030580200528     C/COPY WNCPYSRC,CG4630C068
030590200528     C                     MOVELD#TAMT    ##D,3                           087994
030600200528     C/COPY WNCPYSRC,CG4630C069
030610200528     C                     MOVE A6NBDP    ##D,3
030620200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
030630200528     C           ##FILE    OREQ 'FT102H '                                 CFT008
030640200528     C                     MOVELPAYAMT    ##D,3                           CFT006
030650200528     C                     MOVE A6NBDP    ##D,3                           CFT006
030660200528     C                     Z-ADDA6NBDP    WPDCP   20                      CFT006
030670200528     C                     ENDSL
030680200528      *
030690200528      **  Cheque Number
030700200528     C                     SELEC                                          CFT006
030710200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
030720200528     C           ##FILE    OREQ 'FT102H '                                 CFT008
030730200528     C                     MOVELCHQNUM    ##D,4                           CFT006
030740200528     C                     OTHER                                          CFT006
030750200528     C                     MOVE *BLANKS   ##D,4
030760200528     C                     ENDSL                                          CFT006
030770200528      *
030780200528      **  Cheque Sequence Number
030790200528     C                     SELEC
030800200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
030810200528     C           ##FILE    OREQ 'CQPAC  '                  Cheques for Pai087994
030820200528     C                     MOVELCQSQ      ##D,5
030830200528     C                     OTHER
030840200528     C                     MOVE *BLANKS   ##D,5
030850200528     C                     ENDSL
030860200528      *                                                                   095577
030870200528      * Set up Credit Date                                                095577
030880200528      *                                                                   095577
030890200528     C                     SELEC                                          095577
030900200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
030910200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Paymen095577
030920200528     C                     MOVELPVDT      ##D,6                           095577
030930200528     C                     MOVELPVDT      ##D,6                           095577
030940200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
030950200528     C                     MOVELPVDT      ##D,6                           095577
030960200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
030970200528     C                     MOVELCRVD      ##D,6                           095577
030980200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
030990200528     C           ##FILE    OREQ 'FT102H '                                 CFT008
031000200528     C                     MOVELCRDVDT    ##D,6                           CFT006
031010200528     C                     ENDSL                                          095577
031020200528      *
031030200528      **  Accumulate RDE's and associated data and output to
031040200528      **  PF/CGUDTAPD.
031050200528     C                     EXSR SRADTA
031060200528     C                     EXSR SRODTA
031070200528      *
031080200528      *................................................................
031090200528      *
031100200528     C           EX@CCY    TAG
031110200528      *                                                                                       CCG015
031120200528     C                     EXSR POPGRS                                                        CCG015
031130200528      *
031140200528      **  Unwind subroutine stack name
031150200528     C                     MOVEA*BLANKS   @STK,Q
031160200528     C                     SUB  1         Q
031170200528      *
031180200528     C                     ENDSR
031190200528     C*****************************************************************
031200200528     C/SPACE 5
031210200528      *****************************************************************
031220200528      * Subroutine  :  DR@CCY                                         *
031230200528      * Function    :  Debit Currency                                 *
031240200528      *                                                               *
031250200528      * Called by   :                                                 *
031260200528      * Calls       :                                                 *
031270200528      *****************************************************************
031280200528     C           DR@CCY    BEGSR
031290200528      *
031300200528      **  Set up subroutine stack name
031310200528     C                     ADD  1         Q
031320200528     C                     MOVEL'DR_CCY'  @STK,Q
031330200528      *
031340200528      *................................................................
031350200528      *
031360200528      **  Retrieve subroutine specific data.
031370200528     C           1         OCUR ##SRDT
031380200528     C                     MOVEL##SPAT    S#PATH
031390200528      *
031400200528      **  Set up Path.
031410200528     C                     MOVEL'\DR_CCY' ##PNAM
031420200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
031430200528      *                                                                                       CCG015
031440200528     C                     EXSR PSHGRS                                                        CCG015
031450200528      *
031460200528      **  Retrieve RDE information for RDEs in group set
031470200528      *
031480200528     C                     MOVEL@STK,Q    ##GRPS
031490200528     C                     Z-ADD1         ##RDEN
031500200528     C                     EXSR SRRRDE
031510200528      *
031520200528      **  Debit Currency
031530200528     C                     SELEC
031540200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
031550200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
031560200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
031570200528     C                     MOVELSMCY      ##D,1
031580200528     C                     MOVELSMCY      @AJCD
031590200528     C           ##FILE    WHEQ 'CQPAC  '
031600200528     C                     MOVELDRCY      ##D,1
031610200528     C                     MOVELDRCY      @AJCD
031620200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
031630200528     C                     MOVELTRNCCY    ##D,1                           CFT006
031640200528     C                     MOVELTRNCCY    @AJCD                           CFT006
031650200528     C           ##FILE    WHEQ 'FT102H '                                 CFT008
031660200528     C                     MOVELCCTCCY    ##D,1                           CFT008
031670200528     C                     MOVELCCTCCY    @AJCD                           CFT008
031680200528     C                     ENDSL
031690200528      *
031700200528      **  Obtain currency details
031710200528     C                     CALL 'AOCURRR0'
031720200528     C***********          PARM '*DBERR'  @RTCD   7                       087995
031730200528     C                     PARM *BLANKS   @RTCD   7                       087995
031740200528     C                     PARM '*KEY   ' @OPTN   7
031750200528     C                     PARM           @AJCD   3
031760200528     C           SDCURR    PARM SDCURR    DSSDY
031770200528      *
031780200528      ** DATABASE ERROR
031790200528      *
031800200528     C           @RTCD     IFNE *BLANK
031810200528     C                     MOVEL'SDCURRPD'W0FILE
031820200528     C                     MOVELSMCY      W0KEY            ***************
031830200528     C                     Z-ADD6         W0ERNB           * DB ERROR 06 *
031840200528     C                     MOVEL'MEM5004' W0MSGD           ***************
031850200528     C                     MOVEL'MIDAS  ' W0MSGF
031860200528     C                     EXSR SRERR
031870200528     C                     END
031880200528     C/COPY WNCPYSRC,CG4630C003
031890200528      *
031900200528      **  Debit Currency Name
031910200528     C                     MOVELA6CYNM    ##D,2
031920200528      *
031930200528      **  Debit Amount
031940200528     C                     SELEC
031950200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
031960200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
031970200528     C/COPY WNCPYSRC,CG4630C070
031980200528     C                     MOVELSMAM      ##D,3
031990200528     C/COPY WNCPYSRC,CG4630C071
032000200528     C                     MOVE A6NBDP    ##D,3
032010200528     C***********##FILE    WHEQ 'CQPAC  '                                 087994
032020200528     C***********##FILE    OREQ 'CQCOD  '                  Cheques for col087994
032030200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
032040200528     C/COPY WNCPYSRC,CG4630C072
032050200528     C                     MOVELCQAM      ##D,3
032060200528     C/COPY WNCPYSRC,CG4630C073
032070200528     C                     MOVE A6NBDP    ##D,3
032080200528     C           ##FILE    WHEQ 'CQPAC  '                                 087994
032090200528      *                                                                   087994
032100200528      * Calculate Debit currency equivalent                               087994
032110200528      *                                                                   087994
032120200528     C           MDIN      IFEQ 0                                         087994
032130200528     C                     MOVEL'D'       I#MDIN                          087994
032140200528     C                     ELSE                                           087994
032150200528     C                     MOVEL'M'       I#MDIN                          087994
032160200528     C                     END                                            087994
032170200528     C                     Z-ADDRATE      I#RATE                          087994
032180200528     C                     Z-ADDCQAM      D#FAMT                          087994
032190200528     C                     MOVELPCCY      D#FCCY                          087994
032200200528     C                     MOVELDRCY      D#TCCY                          087994
032210200528     C                     CALL 'AOCCYCV0'             9090               087994
032220200528     C           R#RTN     PARM *BLANKS   O#RTN   7                       087994
032230200528     C                     PARM '*F*T*RAT'W0ACT   8                       087994
032240200528     C           D#DTA     PARM D#DTA     O#DTA 256                       087994
032250200528      *                                                                   087994
032260200528     C           *IN90     IFEQ '1'                                       087994
032270200528     C           R#RTN     ORNE *BLANKS                                   087994
032280200528     C                     MOVEL'*CALL   'W0FILE                          087994
032290200528     C                     MOVEL'AOCCYCV0'W0KEY            ***************087994
032300200528     C                     Z-ADD14        W0ERNB           * DB ERROR 14 *087994
032310200528     C                     MOVEL'MEM5003' W0MSGD           ***************087994
032320200528     C                     MOVEL'MIDAS  ' W0MSGF                          087994
032330200528     C           *LIKE     DEFN O#RTN     R#RTN                           087994
032340200528     C                     EXSR SRERR                                     087994
032350200528     C                     END                                            087994
032360200528      *                                                                   087994
032370200528     C                     Z-ADDD#TAMT    W#AMT  150                      087994
032380200528     C/COPY WNCPYSRC,CG4630C074
032390200528     C                     MOVELD#TAMT    ##D,3                           087994
032400200528     C/COPY WNCPYSRC,CG4630C075
032410200528     C                     MOVE A6NBDP    ##D,3                           087994
032420200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
032430200528     C                     MOVELTRNAMT    ##D,3                           CFT006
032440200528     C                     MOVE A6NBDP    ##D,3                           CFT006
032450200528     C                     Z-ADDA6NBDP    WTRFT   20                      CFT006
032460200528     C           ##FILE    WHEQ 'FT102H '                                 CFT008
032470200528     C                     MOVELCCTAMT    ##D,3                           CFT008
032480200528     C                     MOVE A6NBDP    ##D,3                           CFT008
032490200528     C                     Z-ADDA6NBDP    WTCCT   20                      CFT008
032500200528     C                     ENDSL
032510200528      *                                                                   095577
032520200528      * Set up Dedit Date                                                 095577
032530200528      *                                                                   095577
032540200528     C                     SELEC                                          095577
032550200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
032560200528     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Paymen095577
032570200528     C                     MOVELSLDT      ##D,4                           095577
032580200528     C                     MOVELSLDT      ##D,4                           095577
032590200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
032600200528     C                     MOVELDRVD      ##D,4                           095577
032610200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
032620200528     C                     MOVELSLDT      ##D,4                           095577
032630200528     C           ##FILE    WHEQ 'FT101H '                                 CFT006
032640200528     C           ##FILE    OREQ 'FT102H '                                 CFT008
032650200528     C                     MOVELDBTVDT    ##D,4                           CFT006
032660200528     C                     ENDSL                                          095577
032670200528      *
032680200528      **  Accumulate RDE's and associated data and output to
032690200528      **  PF/CGUDTAPD.
032700200528     C                     EXSR SRADTA
032710200528     C                     EXSR SRODTA
032720200528      *
032730200528      *................................................................
032740200528      *
032750200528     C           EX@CC1    TAG
032760200528      *                                                                                       CCG015
032770200528     C                     EXSR POPGRS                                                        CCG015
032780200528      *
032790200528      **  Unwind subroutine stack name
032800200528     C                     MOVEA*BLANKS   @STK,Q
032810200528     C                     SUB  1         Q
032820200528      *
032830200528     C                     ENDSR
032840200528      *****************************************************************
032850200528     C/SPACE 5
032860200528      *****************************************************************
032870200528      * Subroutine  :  CORDTA                                         *
032880200528      * Function    :  Correspondent data                             *
032890200528      *                                                               *
032900200528      * Called by   :  SRMAIN - Main Processing                       *
032910200528      * Calls       :                                                 *
032920200528      *****************************************************************
032930200528     C           CORDTA    BEGSR
032940200528      *
032950200528      **  Set up subroutine stack name
032960200528     C                     ADD  1         Q
032970200528     C                     MOVEL'CORDTA'  @STK,Q
032980200528      *
032990200528      *................................................................
033000200528      *
033010200528      **  Set up Path.
033020200528     C                     MOVEL'\CORDTA' ##PNAM  7
033030200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
033040200528      *                                                                                       CCG015
033050200528     C                     EXSR PSHGRS                                                        CCG015
033060200528      *
033070200528      **  Correspondent type.
033080200528     C                     MOVEL#TYPE     ##D,1
033090200528      *
033100200528      **  Customer.
033110200528     C                     MOVELW0CNUM    ##D,2
033120200528      *
033130200528      **  Customer name.
033140200528     C                     MOVELW0CRNM    ##D,3
033150200528      *
033160200528      **  Customer town.
033170200528     C                     MOVELW0RTWN    ##D,4
033180200528      *
033190200528      **  Account line.
033200200528     C                     MOVELW0ACLN    ##D,5
033210200528      *
033220200528      **  Retail account no.
033230200528     C                     MOVELW0ACNO    ##D,6
033240200528      *
033250200528      **  Midas account number.
033260200528     C                     CLEAR#RETLN
033270200528     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
033280200528     C                     MOVE W0CNUM    ##CNUM                                              CSD027
033290200528     C                     MOVELW#CCY     ##CCY
033300200528     C                     Z-ADDW0ACOD    ##ACOD
033310200528     C                     Z-ADDW0ACSQ    ##ACSQ
033320200528     C                     MOVELBRCA      ##BRC1
033330200528     C/COPY WNCPYSRC,CG4630C020
033340200528     C***********          MOVEL#RETLN    ##D,5                           087995
033350200528     C                     MOVEL#RETLN    ##D,7                           087995
033360200528      *
033370200528      **  Account name.
033380200528     C                     MOVELW0ANAM    ##D,8
033390200528      *
033400200528      **  SWIFT ID.
033410200528     C                     MOVELW0CSID    ##D,9
033420200528      *
033430200528      **  Address line 1.
033440200528     C                     MOVELW#ADD1    ##D,10
033450200528      *
033460200528      **  Address line 2.
033470200528     C                     MOVELW#ADD2    ##D,11
033480200528      *
033490200528      **  Address line 3.
033500200528     C                     MOVELW#ADD3    ##D,12
033510200528      *
033520200528      **  Address line 4.
033530200528     C                     MOVELW#ADD4    ##D,13
033540200528      *
033550200528      **  Address line 5.
033560200528     C                     MOVELW#ADD5    ##D,14
033570200528      *                                                                   CPB001
033580200528      **  Portfolio Reference                                             CPB001
033590200528     C                     MOVE *BLANKS   ##D,15                          CPB001
033600200528      *                                                                   CPB001
033610200528     C           BGN4ST    IFEQ 'Y'                                       CPB001
033620200528      *                                                                   CPB001
033630200528     C           ##FILE    IFEQ 'OTPAY  '                                 CPB001
033640200528     C           ORC1      ANDNE*BLANKS                                   CPB001
033650200528     C           ##FILE    OREQ 'INPAY  '                                 CPB001
033660200528     C           BNC1      ANDNE*BLANKS                                   CPB001
033670200528     C                     MOVEL*BLANKS   KRACN                           CPB001
033680200528     C                     MOVEL*BLANKS   KCNUM                           CPB001
033690200528     C                     MOVEL*BLANKS   KCCY                            CPB001
033700200528     C                     MOVEL*BLANKS   KACOD                           CPB001
033710200528     C                     MOVEL*BLANKS   KACSQ                           CPB001
033720200528     C                     MOVEL*BLANKS   KBRCA                           CPB001
033730200528      *                                                                   CPB001
033740200528     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
033750200528     C           ORCT      IFEQ 'R'                                       CPB001
033760200528     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
033770200528     C           WSLSH     IFEQ '/'                                                           CFT032
033780200528     C           10        SUBSTORC1:2    KRACN                                               CFT032
033790200528     C                     ELSE                                                               CFT032
033800200528     C                     MOVELORC1      KRACN                           CPB001
033810200528     C                     ENDIF                                                              CFT032
033820200528     C                     ENDIF                                          CPB001
033830200528      *                                                                   CPB001
033840200528     C           ORCT      IFEQ 'P'                                       CPB001
033850200528     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
033860200528     C           WSLSH     IFEQ '/'                                                           CFT032
033870200528     C           21        SUBSTORC1:2    WORC1                                               CFT032
033880200528     C                     ELSE                                                               CFT032
033890200528     C                     MOVELORC1      WORC1                           CPB001
033900200528     C                     ENDIF                                                              CFT032
033910200528     C                     MOVELSMCY      KCCY                            CPB001
033920200528     C                     ENDIF                                          CPB001
033930200528      *                                                                                       CFT032
033940200528     C           ORCT      IFEQ 'I'                                                           CFT032
033950200528     C           ##FILE    ANDEQ'OTPAY  '                                                     CFT032
033960200528     C           WSLSH     IFEQ '/'                                                           CFT032
033970200528     C           34        SUBSTORC1:2    WIBAN  34                                           CFT032
033980200528     C                     ELSE                                                               CFT032
033990200528     C                     MOVELORC1      WIBAN                                               CFT032
034000200528     C                     ENDIF                                                              CFT032
034010200528     C                     EXSR SRIBAN                                                        CFT032
034020200528     C                     ENDIF                                                              CFT032
034030200528      *                                                                   CPB001
034040200528     C           BNCT      IFEQ 'R'                                       CPB001
034050200528     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
034060200528     C                     MOVELBNC1      KRACN                           CPB001
034070200528     C                     ENDIF                                          CPB001
034080200528      *                                                                   CPB001
034090200528     C           BNCT      IFEQ 'P'                                       CPB001
034100200528     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
034110200528     C                     MOVELBNC1      WORC1                           CPB001
034120200528     C                     MOVELSMCY      KCCY                            CPB001
034130200528     C                     ENDIF                                          CPB001
034140200528      *                                                                   CPB001
034150200528      ** Get Account details                                              CPB001
034160200528     C           ORCT      IFEQ 'R'                                       CPB001
034170200528     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
034180200528     C           ORCT      OREQ 'P'                                       CPB001
034190200528     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
034200200528     C           BNCT      OREQ 'R'                                       CPB001
034210200528     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
034220200528     C           BNCT      OREQ 'P'                                       CPB001
034230200528     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
034240200528     C                     CALL 'AOACCTR0'                                CPB001
034250200528     C                     PARM *BLANKS   WRTCD   7                       CPB001
034260200528     C                     PARM '*KEY    'WOPTN   7                       CPB001
034270200528     C                     PARM           KRACN  10                       CPB001
034280200528     C                     PARM           KCNUM   6                       CPB001
034290200528     C                     PARM           KCCY    3                       CPB001
034300200528     C**********           PARM           KACOD   4                                    CPB001 CGL029
034310200528     C                     PARM           KACOD  10                                           CGL029
034320200528     C                     PARM           KACSQ   2                       CPB001
034330200528     C                     PARM           KBRCA   3                       CPB001
034340200528     C           SDACCT    PARM SDACCT    DSSDY                           CPB001
034350200528      *                                                                   CPB001
034360200528     C                     MOVE PTFR      WPTFR   3                       CPB001
034370200528     C                     MOVELWPTFR     ##D,15                          CPB001
034380200528     C                     ENDIF                                          CPB001
034390200528     C                     ENDIF                                          CPB001
034400200528      *                                                                   CPB001
034410200528     C                     ENDIF                                          CPB001
034420200528      *                                                                                       CFT121
034430200528      **  CFT121 Flag                                                                         CFT121
034440200528      *                                                                                       CFT121
034450200528     C           CFT121    IFEQ 'Y'                                                           CFT121
034460200528     C                     MOVEL'Y'       ##D,16                                              CFT121
034470200528     C                     ENDIF                                                              CFT121
034480200528      *                                                                                       CFT120
034490200528      **  CFT120 Flag                                                                         CFT120
034500200528      *                                                                                       CFT120
034510200528     C           CFT120    IFEQ 'N'                                                           CFT120
034520200528     C                     MOVEL'N'       ##D,17                                              CFT120
034530200528     C                     ELSE                                                               CFT120
034540200528     C                     MOVEL'Y'       ##D,17                                              CFT120
034550200528      *                                                                                       CFT120
034560200528      **  Charge to the Debit of Account Currency                                             CFT120
034570200528      *                                                                                       CFT120
034580200528     C                     SELEC                                                              CFT120
034590200528      *                                                                                       CFT120
034600200528      ** Incoming payment                                                                     CFT120
034610200528      *                                                                                       CFT120
034620200528     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
034630200528     C           INCDRC    IFEQ *BLANKS                                                       CFT120
034640200528     C                     MOVELBJCYCD    ##D,18                                              CFT120
034650200528     C                     ELSE                                                               CFT120
034660200528     C                     MOVELINCDRC    ##D,18                                              CFT120
034670200528     C                     ENDIF                                                              CFT120
034680200528      *                                                                                       CFT120
034690200528      ** Outgoing payment                                                                     CFT120
034700200528      *                                                                                       CFT120
034710200528     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
034720200528     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
034730200528     C                     MOVELBJCYCD    ##D,18                                              CFT120
034740200528     C                     ELSE                                                               CFT120
034750200528     C                     MOVELOPCDRC    ##D,18                                              CFT120
034760200528     C                     ENDIF                                                              CFT120
034770200528     C                     ENDSL                                                              CFT120
034780200528     C                     ENDIF                                                              CFT120
034790200528      *
034800200528     C/COPY WNCPYSRC,CG4630C010
034810200528      *................................................................
034820200528      *
034830200528     C           EXRDTA    TAG
034840200528      *                                                                                       CCG015
034850200528     C                     EXSR POPGRS                                                        CCG015
034860200528      *
034870200528      **  Unwind subroutine stack name
034880200528     C                     MOVEA*BLANKS   @STK,Q
034890200528     C                     SUB  1         Q
034900200528      *
034910200528     C                     ENDSR
034920200528     C*****************************************************************
034930200528     C/SPACE 5
034940200528      *****************************************************************
034950200528      * Subroutine  :  RECEVR                                         *
034960200528      * Function    :  Receiver's Correspondant                       *
034970200528      *                                                               *
034980200528      * Called by   :                                                 *
034990200528      * Calls       :                                                 *
035000200528      *****************************************************************
035010200528     C           RECEVR    BEGSR
035020200528      *
035030200528      **  Set up subroutine stack name
035040200528     C                     ADD  1         Q
035050200528     C                     MOVEL'RECEVR'  @STK,Q
035060200528      *
035070200528      *................................................................
035080200528      *
035090200528      **  Retrieve subroutine specific data.
035100200528     C           1         OCUR ##SRDT
035110200528     C                     MOVEL##SPAT    S#PATH
035120200528      *
035130200528      **  Set up Path.
035140200528     C                     MOVEL'\RECEVR' ##PNAM
035150200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
035160200528      *                                                                                       CCG015
035170200528     C                     EXSR PSHGRS                                                        CCG015
035180200528      *
035190200528      **  Retrieve RDE information for RDEs in group set
035200200528      *
035210200528     C                     MOVEL'CORDTA'  ##GRPS
035220200528     C                     Z-ADD1         ##RDEN
035230200528     C                     EXSR SRRRDE
035240200528     C*
035250200528     C           CFT014    IFEQ 'Y'                                       192761
035260200528     C                     SELEC
035270200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
035280200528     C***********RCRT      ANDNE*BLANKS                            087995 CFT014
035290200528     C           INRCRT    ANDNE*BLANKS                                   CFT014
035300200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
035310200528     C           RCRT      ANDNE*BLANKS                                   087995
035320200528     C*
035330200528     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
035340200528     C                     MOVELINRCRT    WTYPE                           CFT014
035350200528     C                     MOVELINRCO1    WPTY                            CFT014
035360200528     C                     MOVELINRCO1    WPTY1                           CFT014
035370200528     C                     MOVELINRCO2    WPTY2                           CFT014
035380200528     C                     ELSE                                           CFT014
035390200528     C                     MOVE RCRT      WTYPE   1
035400200528     C**********           MOVELRCCO      WPTY   12                                           CGL029
035410200528     C                     MOVELRCCO      WPTY   18                                           CGL029
035420200528     C                     MOVELRCCO      WPTY1                           CFT014
035430200528     C                     ENDIF                                          CFT014
035440200528     C                     MOVE SMCY      WCCY    3
035450200528     C***********          MOVELRCCO      WPTY1                           CFT014
035460200528     C                     MOVEL*BLANKS   WBRCA   3
035470200528      *
035480200528     C                     EXSR SRTPSR
035490200528      *
035500200528      *
035510200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
035520200528     C           SNCT      ANDNE*BLANKS                                   087995
035530200528     C                     MOVE SNCT      WTYPE
035540200528     C                     MOVELSNCO      WPTY
035550200528     C                     MOVE PCCY      WCCY
035560200528     C                     MOVELSNCO      WPTY1
035570200528     C                     MOVEL*BLANKS   WBRCA
035580200528      *
035590200528     C                     EXSR SRTPSR
035600200528      *
035610200528      * If no data exit                                                   087995
035620200528      *                                                                   087995
035630200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087995
035640200528     C           SNCT      ANDEQ*BLANKS                                   087995
035650200528     C           ##FILE    OREQ 'INPAY  '                  Incoming Paymen087995
035660200528     C***********RCRT      ANDEQ*BLANKS                            087995 CFT014
035670200528     C           INRCRT    ANDEQ*BLANKS                                   CFT014
035680200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col087995
035690200528     C           RCRT      ANDEQ*BLANKS                                   087995
035700200528     C                     GOTO EXCEVR                                    087995
035710200528      *                                                                   087995
035720200528     C                     ENDSL
035730200528      *
035740200528      **  Information Type
035750200528     C                     MOVE *BLANKS   #TYPE
035760200528     C           *LIKE     DEFN RCRT      #TYPE
035770200528     C                     SELEC
035780200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
035790200528     C***********          MOVELRCRT      #TYPE                           CFT014
035800200528     C                     MOVELINRCRT    #TYPE                           CFT014
035810200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
035820200528     C                     MOVELSNCT      #TYPE
035830200528     C                     ENDSL
035840200528     C                     ELSE                                           192761
035850200528     C                     SELEC                                          192761
035860200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen192761
035870200528     C           RCRT      ANDNE*BLANKS                                   192761
035880200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col192761
035890200528     C           RCRT      ANDNE*BLANKS                                   192761
035900200528     C*                                                                   192761
035910200528     C                     MOVE RCRT      WTYPE   1                       192761
035920200528     C**********           MOVELRCCO      WPTY   12                                    192761 CGL029
035930200528     C                     MOVELRCCO      WPTY   18                                           CGL029
035940200528     C                     MOVE SMCY      WCCY    3                       192761
035950200528     C                     MOVELRCCO      WPTY1                           192761
035960200528     C                     MOVEL*BLANKS   WBRCA   3                       192761
035970200528      *                                                                   192761
035980200528     C                     EXSR SRTPSR                                    192761
035990200528      *                                                                   192761
036000200528      *                                                                   192761
036010200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
036020200528     C           SNCT      ANDNE*BLANKS                                   192761
036030200528     C                     MOVE SNCT      WTYPE                           192761
036040200528     C                     MOVELSNCO      WPTY                            192761
036050200528     C                     MOVE PCCY      WCCY                            192761
036060200528     C                     MOVELSNCO      WPTY1                           192761
036070200528     C                     MOVEL*BLANKS   WBRCA                           192761
036080200528      *                                                                   192761
036090200528     C                     EXSR SRTPSR                                    192761
036100200528      *                                                                   192761
036110200528      * If no data exit                                                   192761
036120200528      *                                                                   192761
036130200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
036140200528     C           SNCT      ANDEQ*BLANKS                                   192761
036150200528     C           ##FILE    OREQ 'INPAY  '                  Incoming Paymen192761
036160200528     C           RCRT      ANDEQ*BLANKS                                   192761
036170200528     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col192761
036180200528     C           RCRT      ANDEQ*BLANKS                                   192761
036190200528     C                     GOTO EXCEVR                                    192761
036200200528      *                                                                   192761
036210200528     C                     ENDSL                                          192761
036220200528      *                                                                   192761
036230200528      **  Information Type                                                192761
036240200528     C                     MOVE *BLANKS   #TYPE                           192761
036250200528     C                     SELEC                                          192761
036260200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen192761
036270200528     C                     MOVELRCRT      #TYPE                           192761
036280200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
036290200528     C                     MOVELSNCT      #TYPE                           192761
036300200528     C                     ENDSL                                          192761
036310200528     C                     ENDIF                                          192761
036320200528     C***********          MOVELW0CSID    ##D,7
036330200528      *
036340200528     C                     MOVE *BLANKS   W#ADDR
036350200528      *                                                                   CFT014
036360200528     C           ##FILE    IFEQ 'INPAY   '                                CFT014
036370200528     C           INRCRT    ANDEQ'A'                                       CFT014
036380200528     C           CFT014    ANDEQ'Y'                                       CFT014
036390200528      *                                                                   CFT014
036400200528     C                     MOVELINRCO1    W#ADD1                          CFT014
036410200528     C                     MOVELINRCO2    W#ADD2                          CFT014
036420200528     C                     MOVELINRCO3    W#ADD3                          CFT014
036430200528     C                     MOVELINRCO4    W#ADD4                          CFT014
036440200528     C                     MOVELINRCO5    W#ADD5                          CFT014
036450200528      *                                                                   CFT014
036460200528     C                     ELSE                                           CFT014
036470200528      **  Address line 1
036480200528     C                     MOVELCNA1      W#ADD1
036490200528      **  Address line 2
036500200528     C                     MOVELCNA2      W#ADD2
036510200528      *
036520200528      **  Address line 3
036530200528     C                     MOVELCNA3      W#ADD3
036540200528      *
036550200528      **  Address line 4
036560200528     C                     MOVELCNA4      W#ADD4
036570200528      *
036580200528      **  Address line 5
036590200528     C                     MOVE *BLANKS   W#ADD5
036600200528      *                                                                   CFT014
036610200528     C                     ENDIF                                          CFT014
036620200528      *
036630200528     C/COPY WNCPYSRC,CG4630C011
036640200528     C                     EXSR CORDTA
036650200528      *
036660200528      **  Accumulate RDE's and associated data and output to
036670200528      **  PF/CGUDTAPD.
036680200528     C                     EXSR SRADTA
036690200528     C                     EXSR SRODTA
036700200528      *
036710200528      *................................................................
036720200528      *
036730200528     C           EXCEVR    TAG
036740200528      *                                                                                       CCG015
036750200528     C                     EXSR POPGRS                                                        CCG015
036760200528      *
036770200528      **  Unwind subroutine stack name
036780200528     C                     MOVEA*BLANKS   @STK,Q
036790200528     C                     SUB  1         Q
036800200528      *
036810200528     C                     ENDSR
036820200528     C*****************************************************************
036830200528     C/SPACE 5
036840200528      *****************************************************************
036850200528      * Subroutine  :  SENDER                                         *
036860200528      * Function    :  Sender's Correspondant                         *
036870200528      *                                                               *
036880200528      * Called by   :                                                 *
036890200528      * Calls       :                                                 *
036900200528      *****************************************************************
036910200528     C           SENDER    BEGSR
036920200528      *
036930200528      **  Set up subroutine stack name
036940200528     C                     ADD  1         Q
036950200528     C                     MOVEL'SENDER'  @STK,Q
036960200528      *
036970200528      *................................................................
036980200528      *
036990200528      * If no data exixt                                                  087995
037000200528      *                                                                   087995
037010200528     C           SNCT      IFEQ *BLANKS                                   087995
037020200528     C                     GOTO EXNDER                                    087995
037030200528     C                     ENDIF                                          087995
037040200528      **  Retrieve subroutine specific data.
037050200528     C           1         OCUR ##SRDT
037060200528     C                     MOVEL##SPAT    S#PATH
037070200528      *
037080200528      **  Set up Path.
037090200528     C                     MOVEL'\SENDER' ##PNAM
037100200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
037110200528      *                                                                                       CCG015
037120200528     C                     EXSR PSHGRS                                                        CCG015
037130200528      *
037140200528      **  Retrieve RDE information for RDEs in group set
037150200528      *
037160200528     C                     MOVEL'CORDTA'  ##GRPS
037170200528     C                     Z-ADD1         ##RDEN
037180200528     C                     EXSR SRRRDE
037190200528      *
037200200528     C                     MOVE SNCT      WTYPE
037210200528     C                     MOVELSNCO      WPTY
037220200528     C                     MOVE PCCY      WCCY
037230200528     C                     MOVELSNCO      WPTY1
037240200528     C                     MOVEL*BLANKS   WBRCA
037250200528     C**************       MOVELCDBR      WBRCA1  3                             AR1096709 AR1096709A
037260200528      *
037270200528     C                     EXSR SRTPSR
037280200528      *
037290200528      **  Information Type
037300200528     C                     MOVE *BLANKS   #TYPE
037310200528     C                     MOVELSNCT      #TYPE
037320200528      *
037330200528     C                     MOVE *BLANKS   W#ADDR
037340200528      **  Address line 1
037350200528     C                     MOVELCNA1      W#ADD1
037360200528      **  Address line 2
037370200528     C                     MOVELCNA2      W#ADD2
037380200528      *
037390200528      **  Address line 3
037400200528     C                     MOVELCNA3      W#ADD3
037410200528      *
037420200528      **  Address line 4
037430200528     C                     MOVELCNA4      W#ADD4
037440200528      *
037450200528      **  Address line 5
037460200528     C                     MOVE *BLANKS   W#ADD5
037470200528      *
037480200528     C                     EXSR CORDTA
037490200528      *
037500200528      **  Accumulate RDE's and associated data and output to
037510200528      **  PF/CGUDTAPD.
037520200528     C                     EXSR SRADTA
037530200528     C                     EXSR SRODTA
037540200528      *                                                                                       CCG015
037550200528     C                     EXSR POPGRS                                                        CCG015
037560200528      *
037570200528      *................................................................
037580200528      *
037590200528     C           EXNDER    TAG
037600200528      *
037610200528      **  Unwind subroutine stack name
037620200528     C                     MOVEA*BLANKS   @STK,Q
037630200528     C                     SUB  1         Q
037640200528      *
037650200528     C                     ENDSR
037660200528     C*****************************************************************
037670200528     C/SPACE 5
037680200528      *****************************************************************
037690200528      * Subroutine  :  O@INST                                         *
037700200528      * Function    :  Ordering Institution                           *
037710200528      *                                                               *
037720200528      * Called by   :                                                 *
037730200528      * Calls       :                                                 *
037740200528      *****************************************************************
037750200528     C           O@INST    BEGSR
037760200528      *
037770200528      **  Set up subroutine stack name
037780200528     C                     ADD  1         Q
037790200528     C                     MOVEL'O_INST'  @STK,Q
037800200528      *
037810200528      *................................................................
037820200528      *
037830200528      * If no data exixt                                                  087995
037840200528      *                                                                   087995
037850200528     C           ORBT      IFEQ *BLANKS                                   087995
037860200528     C                     GOTO EXINST                                    087995
037870200528     C                     ENDIF                                          087995
037880200528      *
037890200528      **  Retrieve subroutine specific data.
037900200528     C           1         OCUR ##SRDT
037910200528     C                     MOVEL##SPAT    S#PATH
037920200528      *
037930200528      **  Set up Path.
037940200528     C                     MOVEL'\O_INST' ##PNAM
037950200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
037960200528      *                                                                                       CCG015
037970200528     C                     EXSR PSHGRS                                                        CCG015
037980200528      *
037990200528      **  Retrieve RDE information for RDEs in group set
038000200528      *
038010200528     C                     MOVEL'CORDTA'  ##GRPS
038020200528     C                     Z-ADD1         ##RDEN
038030200528     C                     EXSR SRRRDE
038040200528      *
038050200528     C           ##FILE    IFEQ 'INPAY  '                  Incoming Payments
038060200528     C                     MOVE ORBT      WTYPE
038070200528     C                     MOVE SMCY      WCCY
038080200528     C                     MOVE *BLANKS   WBRCA
038090200528     C                     MOVELORB1      WPTY1                           087995
038100200528     C                     MOVELORB2      WPTY2                           087995
038110200528     C                     ENDIF
038120200528      *
038130200528     C           ##FILE    IFEQ 'OTPAY  '                  Outgoing Payments
038140200528     C                     MOVE ORBT      WTYPE
038150200528     C                     MOVELORBK      WPTY
038160200528     C                     MOVE SMCY      WCCY
038170200528     C                     MOVELORBK      WPTY1
038180200528     C                     MOVELORBB      WBRCA
038190200528     C                     ENDIF
038200200528      *
038210200528     C                     EXSR SRTPSR
038220200528      *
038230200528      **  Ordering Information Type
038240200528     C                     MOVE *BLANKS   #TYPE
038250200528     C                     MOVELORBT      #TYPE
038260200528      *
038270200528      **  Ordering customer Address line 1
038280200528     C                     MOVE *BLANKS   W#ADDR
038290200528     C           ORBT      IFEQ 'A'                                       087995
038300200528     C                     MOVELORB1      W#ADD1
038310200528      *
038320200528      **  Ordering customer Address line 2
038330200528     C                     MOVELORB2      W#ADD2
038340200528      *
038350200528      **  Ordering customer Address line 3
038360200528     C                     MOVELORB3      W#ADD3
038370200528      *
038380200528      **  Ordering customer Address line 4
038390200528     C                     MOVELORB4      W#ADD4
038400200528      *
038410200528      **  Ordering customer Address line 5
038420200528     C                     MOVELORB5      W#ADD5
038430200528     C                     ELSE                                           087995
038440200528      **  Address line 1                                                  087995
038450200528     C                     MOVELCNA1      W#ADD1                          087995
038460200528      **  Address line 2                                                  087995
038470200528     C                     MOVELCNA2      W#ADD2                          087995
038480200528      *                                                                   087995
038490200528      **  Address line 3                                                  087995
038500200528     C                     MOVELCNA3      W#ADD3                          087995
038510200528      *                                                                   087995
038520200528      **  Address line 4                                                  087995
038530200528     C                     MOVELCNA4      W#ADD4                          087995
038540200528      *                                                                   087995
038550200528      **  Address line 5                                                  087995
038560200528     C                     MOVE *BLANKS   W#ADD5                          087995
038570200528     C                     ENDIF                                          087995
038580200528      *
038590200528     C                     EXSR CORDTA
038600200528      *
038610200528      **  Accumulate RDE's and associated data and output to
038620200528      **  PF/CGUDTAPD.
038630200528     C                     EXSR SRADTA
038640200528     C                     EXSR SRODTA
038650200528      *                                                                                       CCG015
038660200528     C                     EXSR POPGRS                                                        CCG015
038670200528      *
038680200528      *................................................................
038690200528      *
038700200528     C           EXINST    TAG
038710200528      *
038720200528      **  Unwind subroutine stack name
038730200528     C                     MOVEA*BLANKS   @STK,Q
038740200528     C                     SUB  1         Q
038750200528      *
038760200528     C                     ENDSR
038770200528     C*****************************************************************
038780200528     C/SPACE 5
038790200528      *****************************************************************
038800200528      * Subroutine  :  O@CUST                                         *
038810200528      * Function    :  Ordering Customer Details                      *
038820200528      *                                                               *
038830200528      * Called by   :                                                 *
038840200528      * Calls       :                                                 *
038850200528      *****************************************************************
038860200528     C           O@CUST    BEGSR
038870200528      *
038880200528      **  Set up subroutine stack name
038890200528     C                     ADD  1         Q
038900200528     C                     MOVEL'O_CUST'  @STK,Q
038910200528      *
038920200528      *................................................................
038930200528      *
038940200528      **  Retrieve subroutine specific data.
038950200528     C           1         OCUR ##SRDT
038960200528     C                     MOVEL##SPAT    S#PATH
038970200528      *
038980200528      **  Set up Path.
038990200528     C                     MOVEL'\O_CUST' ##PNAM
039000200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
039010200528      *                                                                                       CCG015
039020200528     C                     EXSR PSHGRS                                                        CCG015
039030200528      *
039040200528      **  Retrieve RDE information for RDEs in group set
039050200528      *
039060200528     C                     MOVEL'CORDTA'  ##GRPS
039070200528     C                     Z-ADD1         ##RDEN
039080200528     C                     EXSR SRRRDE
039090200528      *
039100200528     C***********ORCT      IFNE 'A'                        B1             087995
039110200528     C*
039120200528     C                     MOVE ORCT      WTYPE
039130200528      *                                                                                       CFT032
039140200528     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
039150200528     C           WSLSH     IFEQ '/'                                                           CFT032
039160200528     C           18        SUBSTORC1:2    WPTY                                                CFT032
039170200528     C           ORCT      IFEQ 'R'                                                           CFT032
039180200528     C           ORCT      OREQ 'P'                                                           CFT032
039190200528     C           ORCT      OREQ 'I'                                                         BUG15105
039200200528     C           34        SUBSTORC1:2    WPTY1     P                                         CFT032
039210200528     C                     ELSE                                                               CFT032
039220200528     C**********           MOVELORC1      WPTY1                                      CFT032 BUg15105
039230200528     C                     MOVELORC2      WPTY1                                             BUG15105
039240200528     C                     ENDIF                                                              CFT032
039250200528     C                     ELSE                                                               CFT032
039260200528      *                                                                                       CFT032
039270200528     C                     MOVELORC1      WPTY
039280200528     C                     MOVELORC1      WPTY1                                               CFT032
039290200528     C                     ENDIF                                                              CFT032
039300200528     C                     MOVE SMCY      WCCY
039310200528     C**********           MOVELORC1      WPTY1                                               CFT032
039320200528     C                     MOVELORC2      WPTY2
039330200528     C                     MOVEL*BLANKS   WBRCA
039340200528     C                     EXSR SRTPSR
039350200528     C***********          ENDIF                           E1             087995
039360200528      *
039370200528      **  Ordering Information Type
039380200528     C                     MOVE *BLANKS   #TYPE
039390200528     C                     MOVELORCT      #TYPE
039400200528     C                     MOVE *BLANKS   W#ADDR
039410200528      *
039420200528      ***********                                                         087995
039430200528     C***********          SELEC                                          087995
039440200528     C***********##FILE    WHEQ 'INPAY  '                  Incoming PaymentsBXXX
039450200528      ***********                                                         087995
039460200528      ****Ordering customer Address line 1                                087995
039470200528     C***********          MOVELORC1      W#ADD1                          087995
039480200528      ***********                                                         087995
039490200528      ****Ordering customer Address line 2                                087995
039500200528     C***********          MOVELORC2      W#ADD2                          087995
039510200528      ***********                                                         087995
039520200528      ****Ordering customer Address line 3                                087995
039530200528     C***********          MOVELORC3      W#ADD3                          087995
039540200528      ***********                                                         087995
039550200528      ****Ordering customer Address line 4                                087995
039560200528     C***********          MOVELORC4      W#ADD4                          087995
039570200528      ***********                                                         087995
039580200528     C***********##FILE    WHEQ 'OTPAY  '                  Incoming PaymentsBXXX
039590200528     C***********ORCT      IFNE 'A'                                       087995
039600200528      ***********                                                         087995
039610200528      ****Ordering customer Address line 1                                087995
039620200528     C***********          MOVELBNC1      W#ADD1                          087995
039630200528      ***********                                                         087995
039640200528      ****Ordering customer Address line 2                                087995
039650200528     C***********          MOVELBNC2      W#ADD2                          087995
039660200528      ***********                                                         087995
039670200528      ****Ordering customer Address line 3                                087995
039680200528     C***********          MOVELBNC3      W#ADD3                          087995
039690200528      ***********                                                         087995
039700200528      ****Ordering customer Address line 4                                087995
039710200528     C***********          MOVELBNC4      W#ADD4                          087995
039720200528      ***********                                                         087995
039730200528     C***********          ELSE                                           087995
039740200528      ***********                                                         087995
039750200528      ****Ordering customer Address line 1                                087995
039760200528     C***********          MOVELORC1      W#ADD1                          087995
039770200528      ***********                                                         087995
039780200528      ****Ordering customer Address line 2                                087995
039790200528     C***********          MOVELORC2      W#ADD2                          087995
039800200528      ***********                                                         087995
039810200528      ****Ordering customer Address line 3                                087995
039820200528     C***********          MOVELORC3      W#ADD3                          087995
039830200528      ***********                                                         087995
039840200528      ****Ordering customer Address line 4                                087995
039850200528     C***********          MOVELORC4      W#ADD4                          087995
039860200528     C***********          ENDIF                                          087995
039870200528      ***********                                                         087995
039880200528     C***********          ENDSL                                          087995
039890200528     C           ORCT      IFEQ 'A'                        B1             087995
039900200528      *   Ordering customer Address line 1                                087995
039910200528     C                     MOVELORC1      W#ADD1                          087995
039920200528      *                                                                   087995
039930200528      *   Ordering customer Address line 2                                087995
039940200528     C                     MOVELORC2      W#ADD2                          087995
039950200528      *                                                                   087995
039960200528      *   Ordering customer Address line 3                                087995
039970200528     C                     MOVELORC3      W#ADD3                          087995
039980200528      *                                                                   087995
039990200528      *   Ordering customer Address line 4                                087995
040000200528     C                     MOVELORC4      W#ADD4                          087995
040010200528      *                                                                                       CFT032
040020200528      **  Ordering customer Address line 5                                                    CFT032
040030200528     C                     MOVELORC5      W#ADD5                                              CFT032
040040200528     C                     ELSE                                           087995
040050200528      **  Address line 1                                                  087995
040060200528     C                     MOVELCNA1      W#ADD1                          087995
040070200528      **  Address line 2                                                  087995
040080200528     C                     MOVELCNA2      W#ADD2                          087995
040090200528      *                                                                   087995
040100200528      **  Address line 3                                                  087995
040110200528     C                     MOVELCNA3      W#ADD3                          087995
040120200528      *                                                                   087995
040130200528      **  Address line 4                                                  087995
040140200528     C                     MOVELCNA4      W#ADD4                          087995
040150200528      *                                                                   087995
040160200528      **  Address line 5                                                  087995
040170200528     C                     MOVE *BLANKS   W#ADD5                          087995
040180200528     C                     ENDIF                                          087995
040190200528      *
040200200528     C                     EXSR CORDTA
040210200528      *
040220200528      **  Accumulate RDE's and associated data and output to
040230200528      **  PF/CGUDTAPD.
040240200528     C                     EXSR SRADTA
040250200528     C                     EXSR SRODTA
040260200528      *
040270200528      *................................................................
040280200528      *
040290200528     C           EXCUST    TAG
040300200528      *                                                                                       CCG015
040310200528     C                     EXSR POPGRS                                                        CCG015
040320200528      *
040330200528      **  Unwind subroutine stack name
040340200528     C                     MOVEA*BLANKS   @STK,Q
040350200528     C                     SUB  1         Q
040360200528      *
040370200528     C                     ENDSR
040380200528     C*****************************************************************
040390200528     C/SPACE 5
040400200528      *****************************************************************
040410200528      * Subroutine  :  AC@W@B                                         *
040420200528      * Function    :  Account with Bank details                      *
040430200528      *                                                               *
040440200528      * Called by   :                                                 *
040450200528      * Calls       :                                                 *
040460200528      *****************************************************************
040470200528     C           AC@W@B    BEGSR
040480200528      *
040490200528      **  Set up subroutine stack name
040500200528     C                     ADD  1         Q
040510200528     C                     MOVEL'AC_W_B'  @STK,Q
040520200528      *
040530200528      *................................................................
040540200528      *
040550200528      * If no data exixt                                                  087995
040560200528      *                                                                   087995
040570200528     C           ACBT      IFEQ *BLANKS                                   087995
040580200528     C           ##FILE    ANDNE'OTPAY'                                   096419
040590200528     C                     GOTO EX@W@B                                    087995
040600200528     C                     ENDIF                                          087995
040610200528      **  Retrieve subroutine specific data.
040620200528     C           1         OCUR ##SRDT
040630200528     C                     MOVEL##SPAT    S#PATH
040640200528      *
040650200528      **  Set up Path.
040660200528     C                     MOVEL'\AC_W_B' ##PNAM
040670200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
040680200528      *                                                                                       CCG015
040690200528     C                     EXSR PSHGRS                                                        CCG015
040700200528      *
040710200528      **  Retrieve RDE information for RDEs in group set
040720200528      *
040730200528     C                     MOVEL'CORDTA'  ##GRPS
040740200528     C                     Z-ADD1         ##RDEN
040750200528     C                     EXSR SRRRDE
040760200528      *
040770200528     C***********ACBK      IFNE *BLANKS                                   087995
040780200528     C                     SELEC                                          087995
040790200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087995
040800200528     C                     MOVE ACBT      WTYPE
040810200528     C                     MOVELACBK      WPTY
040820200528     C                     MOVE PCCY      WCCY
040830200528     C                     MOVELACBK      WPTY1
040840200528     C                     MOVELACBB      WBRCA
040850200528      *                                                                   087995
040860200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087995
040870200528      *                                                                   096419
040880200528      * If Account with bank not used then use destination                096419
040890200528      *                                                                   096419
040900200528     C           ACBT      IFNE *BLANKS                                   096419
040910200528     C                     MOVE ACBT      WTYPE                           087995
040920200528     C                     MOVELACBK      WPTY                            087995
040930200528     C                     MOVE PCCY      WCCY                            087995
040940200528     C                     MOVELACB1      WPTY1                           087995
040950200528     C                     MOVELACB2      WPTY2                           087995
040960200528     C                     MOVEL*BLANKS   WBRCA                           087995
040970200528      *                                                                   096419
040980200528     C                     ELSE                                           096419
040990200528     C                     MOVELDSTT      WTYPE                           087995
041000200528     C                     MOVE PCCY      WCCY                            087995
041010200528     C                     MOVELDST1      WPTY1                           087995
041020200528     C                     MOVELDST2      WPTY2                           087995
041030200528     C                     MOVEL*BLANKS   WBRCA                           087995
041040200528     C                     ENDIF                                          096419
041050200528      *                                                                   096419
041060200528     C                     ENDSL                                          087995
041070200528     C***********          ELSE                                           087995
041080200528     C***********BNCT      IFNE 'A'                                       087995
041090200528     C***********##FILE    ANDEQ'INPAY  '                  Incoming PaymentsBXXX
041100200528     C***********          MOVE BNCT      WTYPE                           087995
041110200528     C***********          MOVELBNC1      WPTY                            087995
041120200528     C***********          MOVE PCCY      WCCY                            087995
041130200528     C***********          MOVELBNC1      WPTY1                           S01435
041140200528     C***********          MOVELBNC2      WPTY2                           S01435
041150200528     C***********          MOVEL*BLANKS   WBRCA                           S01435
041160200528     C***********          ENDIF                                          087995
041170200528     C***********          ENDIF                                          087995
041180200528      *
041190200528     C                     EXSR SRTPSR
041200200528      *
041210200528      **  Account with bank Information Type
041220200528     C                     MOVE *BLANKS   #TYPE
041230200528     C                     MOVELACBT      #TYPE
041240200528      *
041250200528     C                     MOVE *BLANKS   W#ADDR
041260200528     C                     SELEC
041270200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
041280200528      **  Account with bank Address line 1
041290200528     C                     MOVELCNA1      W#ADD1
041300200528      **  Account with bank Address line 2
041310200528     C                     MOVELCNA2      W#ADD2
041320200528      *
041330200528      **  Account with bank Address line 3
041340200528     C                     MOVELCNA3      W#ADD3
041350200528      *
041360200528      **  Account with bank Address line 4
041370200528     C                     MOVELCNA4      W#ADD4
041380200528      *
041390200528      **  Account with bank Address line 5
041400200528     C                     MOVE *BLANKS   W#ADD5
041410200528      *
041420200528     C           ##FILE    WHEQ 'OTPAY  '                              ments
041430200528     C***********ACBT      ANDEQ'A'                                 087995089214
041440200528      *                                                                   096419
041450200528      * If Account with bank not used then use destination                096419
041460200528      *                                                                   096419
041470200528     C                     SELEC                                          096419
041480200528     C           ACBT      WHEQ 'A'                                       096419
041490200528     C***********ACBT      IFEQ 'A'                                 089214096419
041500200528      **  Account with bank Address line 1
041510200528     C                     MOVELACB1      W#ADD1
041520200528      **  Account with bank Address line 2
041530200528     C                     MOVELACB2      W#ADD2
041540200528      *
041550200528      **  Account with bank Address line 3
041560200528     C                     MOVELACB3      W#ADD3
041570200528      *
041580200528      **  Account with bank Address line 4
041590200528     C                     MOVELACB4      W#ADD4
041600200528      *
041610200528      **  Account with bank Address line 5
041620200528     C***********          MOVE *BLANKS   W#ADD5                          089214
041630200528     C                     MOVELACB5      W#ADD5                          089214
041640200528      *
041650200528      *   Fill with destination details if an address                     096419
041660200528     C           DSTT      WHEQ 'A'                                       096419
041670200528     C           ACBT      ANDEQ*BLANKS                                   096419
041680200528      **  Destination Address line 1                                      096419
041690200528     C                     MOVELDST1      W#ADD1                          096419
041700200528      **  Destination Address line 2                                      096419
041710200528     C                     MOVELDST2      W#ADD2                          096419
041720200528      *                                                                   096419
041730200528      **  Destination Address line 3                                      096419
041740200528     C                     MOVELDST3      W#ADD3                          096419
041750200528      *                                                                   096419
041760200528      **  Destination Address line 4                                      096419
041770200528     C                     MOVELDST4      W#ADD4                          096419
041780200528      *                                                                   096419
041790200528      **  Balnaks in Address line 5                                       096419
041800200528     C                     MOVE *BLANKS   W#ADD5                          096419
041810200528     C                     OTHER                                          096419
041820200528     C**********           ELSE                                     089214096419
041830200528     C**  Account with bankEAddress line 1                                089214
041840200528     C                     MOVELCNA1      W#ADD1                          089214
041850200528     C**  Account with bankEAddress line 2                                089214
041860200528     C                     MOVELCNA2      W#ADD2                          089214
041870200528     C*                                                                   089214
041880200528     C**  Account with bankEAddress line 3                                089214
041890200528     C                     MOVELCNA3      W#ADD3                          089214
041900200528     C*                                                                   089214
041910200528     C**  Account with bankEAddress line 4                                089214
041920200528     C                     MOVELCNA4      W#ADD4                          089214
041930200528     C*                                                                   089214
041940200528     C**  Account with bankEAddress line 5                                089214
041950200528     C                     MOVELCNA5      W#ADD5                          089214
041960200528     C                     ENDSL                                          096419
041970200528     C*********            ENDIF                                    089214096419
041980200528     C                     ENDSL
041990200528      *
042000200528     C                     EXSR CORDTA
042010200528      *
042020200528      **  Accumulate RDE's and associated data and output to
042030200528      **  PF/CGUDTAPD.
042040200528     C                     EXSR SRADTA
042050200528     C                     EXSR SRODTA
042060200528      *                                                                                       CCG015
042070200528     C                     EXSR POPGRS                                                        CCG015
042080200528      *
042090200528      *................................................................
042100200528      *
042110200528     C           EX@W@B    TAG
042120200528      *
042130200528      **  Unwind subroutine stack name
042140200528     C                     MOVEA*BLANKS   @STK,Q
042150200528     C                     SUB  1         Q
042160200528      *
042170200528     C                     ENDSR
042180200528     C*****************************************************************
042190200528     C/SPACE 5
042200200528      *****************************************************************
042210200528      * Subroutine  :  BENEF                                          *
042220200528      * Function    :  Beneficiary Details                            *
042230200528      *                                                               *
042240200528      * Called by   :                                                 *
042250200528      * Calls       :                                                 *
042260200528      *****************************************************************
042270200528     C           BENEF     BEGSR
042280200528      *
042290200528      **  Set up subroutine stack name
042300200528     C                     ADD  1         Q
042310200528     C                     MOVEL'BENEF '  @STK,Q
042320200528      *
042330200528      *................................................................
042340200528      *
042350200528      * If no data exixt                                                  087995
042360200528      *                                                                   087995
042370200528     C           BNCT      IFEQ *BLANKS                                   087995
042380200528     C                     GOTO EXNEF                                     087995
042390200528     C                     ENDIF                                          087995
042400200528      **  Retrieve subroutine specific data.
042410200528     C           1         OCUR ##SRDT
042420200528     C                     MOVEL##SPAT    S#PATH
042430200528      *
042440200528      **  Set up Path.
042450200528     C                     MOVEL'\BENEF ' ##PNAM
042460200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
042470200528      *                                                                                       CCG015
042480200528     C                     EXSR PSHGRS                                                        CCG015
042490200528      *
042500200528      **  Retrieve RDE information for RDEs in group set
042510200528      *
042520200528     C                     MOVEL'CORDTA'  ##GRPS
042530200528     C                     Z-ADD1         ##RDEN
042540200528     C                     EXSR SRRRDE
042550200528      *
042560200528     C***********BNCT      IFNE 'A'                                       087995
042570200528      *
042580200528     C                     MOVE BNCT      WTYPE
042590200528     C                     MOVE PCCY      WCCY
042600200528     C                     MOVELBNC1      WPTY1                           087995
042610200528     C                     MOVELBNC2      WPTY2                           087995
042620200528     C                     MOVEL*BLANKS   WBRCA
042630200528      *
042640200528     C                     EXSR SRTPSR
042650200528     C***********          ENDIF                                          087995
042660200528      *
042670200528      **  Beneficiary Information Type
042680200528     C                     MOVE *BLANKS   #TYPE
042690200528     C                     MOVELBNCT      #TYPE
042700200528      *
042710200528     C                     MOVE *BLANKS   W#ADDR
042720200528     C           BNCT      IFEQ 'A'                                       087995
042730200528      **  Beneficiary Address line 1
042740200528     C                     MOVELBNC1      W#ADD1
042750200528      **  Beneficiary Address line 2
042760200528     C                     MOVELBNC2      W#ADD2
042770200528      *
042780200528      **  Beneficiary Address line 3
042790200528     C                     MOVELBNC3      W#ADD3
042800200528      *
042810200528      **  Beneficiary Address line 4
042820200528     C                     MOVELBNC4      W#ADD4
042830200528      *
042840200528      **  Beneficiary Address line 5
042850200528     C                     MOVELBNC5      W#ADD5
042860200528     C                     ELSE                                           087995
042870200528      **  Address line 1                                                  087995
042880200528     C                     MOVELCNA1      W#ADD1                          087995
042890200528      **  Address line 2                                                  087995
042900200528     C                     MOVELCNA2      W#ADD2                          087995
042910200528      *                                                                   087995
042920200528      **  Address line 3                                                  087995
042930200528     C                     MOVELCNA3      W#ADD3                          087995
042940200528      *                                                                   087995
042950200528      **  Address line 4                                                  087995
042960200528     C                     MOVELCNA4      W#ADD4                          087995
042970200528      *                                                                   087995
042980200528      **  Address line 5                                                  087995
042990200528     C                     MOVE *BLANKS   W#ADD5                          087995
043000200528     C                     ENDIF                                          087995
043010200528      *
043020200528     C                     EXSR CORDTA
043030200528      *
043040200528      **  Accumulate RDE's and associated data and output to
043050200528      **  PF/CGUDTAPD.
043060200528     C                     EXSR SRADTA
043070200528     C                     EXSR SRODTA
043080200528      *                                                                                       CCG015
043090200528     C                     EXSR POPGRS                                                        CCG015
043100200528      *
043110200528      *................................................................
043120200528      *
043130200528     C           EXNEF     TAG
043140200528      *
043150200528      **  Unwind subroutine stack name
043160200528     C                     MOVEA*BLANKS   @STK,Q
043170200528     C                     SUB  1         Q
043180200528      *
043190200528     C                     ENDSR
043200200528     C*****************************************************************
043210200528     C/SPACE 5
043220200528      *****************************************************************
043230200528      * Subroutine  :  PAYDET                                         *
043240200528      * Function    :  Details of Payment                             *
043250200528      *                                                               *
043260200528      * Called by   :                                                 *
043270200528      * Calls       :                                                 *
043280200528      *****************************************************************
043290200528     C           PAYDET    BEGSR
043300200528      *
043310200528      **  Set up subroutine stack name
043320200528     C                     ADD  1         Q
043330200528     C                     MOVEL'PAYDET'  @STK,Q
043340200528      *
043350200528      *................................................................
043360200528      *
043370200528      **  Retrieve subroutine specific data.
043380200528     C           1         OCUR ##SRDT
043390200528     C                     MOVEL##SPAT    S#PATH
043400200528      *
043410200528      **  Set up Path.
043420200528     C                     MOVEL'\PAYDET' ##PNAM
043430200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
043440200528      *                                                                                       CCG015
043450200528     C                     EXSR PSHGRS                                                        CCG015
043460200528      *
043470200528      **  Retrieve RDE information for RDEs in group set
043480200528      *
043490200528     C                     MOVEL@STK,Q    ##GRPS
043500200528     C                     Z-ADD1         ##RDEN
043510200528     C                     EXSR SRRRDE
043520200528      *
043530200528      **  Details of payment - 1
043540200528     C                     MOVELDTP1      ##D,1
043550200528      *
043560200528      **  Details of payment - 2
043570200528     C                     MOVELDTP2      ##D,2
043580200528      *
043590200528      **  Details of payment - 3
043600200528     C                     MOVELDTP3      ##D,3
043610200528      *
043620200528      **  Details of payment - 4
043630200528     C                     MOVELDTP4      ##D,4
043640200528      *
043650200528      **  Accumulate RDE's and associated data and output to
043660200528      **  PF/CGUDTAPD.
043670200528     C                     EXSR SRADTA
043680200528     C                     EXSR SRODTA
043690200528      *
043700200528      *................................................................
043710200528      *
043720200528     C           EXYDET    TAG
043730200528      *                                                                                       CCG015
043740200528     C                     EXSR POPGRS                                                        CCG015
043750200528      *
043760200528      **  Unwind subroutine stack name
043770200528     C                     MOVEA*BLANKS   @STK,Q
043780200528     C                     SUB  1         Q
043790200528      *
043800200528     C                     ENDSR
043810200528     C*
043820200528     C*****************************************************************
043830200528     C/SPACE 5
043840200528      *****************************************************************
043850200528      * Subroutine  :  CG@DAC                                         *
043860200528      * Function    :  Charges to the debit of                        *
043870200528      *                                                               *
043880200528      * Called by   :                                                 *
043890200528      * Calls       :                                                 *
043900200528      *****************************************************************
043910200528     C           CG@DAC    BEGSR
043920200528      *
043930200528      **  Set up subroutine stack name
043940200528     C                     ADD  1         Q
043950200528     C                     MOVEL'CG_DAC'  @STK,Q
043960200528      *
043970200528      *................................................................
043980200528      *
043990200528      * If no data exixt                                                  087995
044000200528      *                                                                   087995
044010200528     C           CDRT      IFEQ *BLANKS                                   087995
044020200528     C                     GOTO EX@DAC                                    087995
044030200528     C                     ENDIF                                          087995
044040200528      **  Retrieve subroutine specific data.
044050200528     C           1         OCUR ##SRDT
044060200528     C                     MOVEL##SPAT    S#PATH
044070200528      *
044080200528      **  Set up Path.
044090200528     C                     MOVEL'\CG_DAC' ##PNAM
044100200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
044110200528      *                                                                                       CCG015
044120200528     C                     EXSR PSHGRS                                                        CCG015
044130200528      *
044140200528      **  Retrieve RDE information for RDEs in group set
044150200528      *
044160200528     C                     MOVEL'CORDTA'  ##GRPS
044170200528     C                     Z-ADD1         ##RDEN
044180200528     C                     EXSR SRRRDE
044190200528      *
044200200528     C                     MOVE CDRT      WTYPE   1
044210200528     C**********           MOVELCDRO      WPTY   12                                           CGL029
044220200528     C                     MOVELCDRO      WPTY   18                                           CGL029
044230200528     C           CFT120    IFEQ 'N'                                                        AR1096097
044240200528     C                     MOVE SMCY      WCCY    3
044250200528     C                     ELSE                                                            AR1096097
044260200528     C                     SELEC                                                           AR1096097
044270200528     C           ##FILE    WHEQ 'INPAY  '                                                  AR1096097
044280200528     C                     MOVE INCDRC    WCCY                                             AR1096097
044290200528     C           ##FILE    WHEQ 'OTPAY  '                                                  AR1096097
044300200528     C                     MOVE OPCDRC    WCCY                                             AR1096097
044310200528     C                     ENDSL                                                           AR1096097
044320200528     C                     ENDIF                                                           AR1096097
044330200528     C                     MOVELCDRO      WPTY1                                               203663
044340200528     C                     MOVEL*BLANKS   WBRCA   3
044350200528     C                     MOVELCDBR      WBRCA1  3                                       AR1096709A
044360200528      *
044370200528     C                     EXSR SRTPSR
044380200528      *
044390200528      **  Information Type
044400200528     C                     MOVE *BLANKS   #TYPE
044410200528     C                     MOVELCDRT      #TYPE
044420200528      *
044430200528     C                     MOVE *BLANKS   W#ADDR
044440200528      **  Address line 1
044450200528     C                     MOVELCNA1      W#ADD1
044460200528      **  Address line 2
044470200528     C                     MOVELCNA2      W#ADD2
044480200528      *
044490200528      **  Address line 3
044500200528     C                     MOVELCNA3      W#ADD3
044510200528      *
044520200528      **  Address line 4
044530200528     C                     MOVELCNA4      W#ADD4
044540200528      *
044550200528      **  Address line 5
044560200528     C                     MOVEL*BLANKS   W#ADD5
044570200528      *
044580200528     C                     EXSR CORDTA
044590200528      *
044600200528      **  Accumulate RDE's and associated data and output to
044610200528      **  PF/CGUDTAPD.
044620200528     C                     EXSR SRADTA
044630200528     C                     EXSR SRODTA
044640200528      *                                                                                       CCG015
044650200528     C                     EXSR POPGRS                                                        CCG015
044660200528      *
044670200528      *................................................................
044680200528      *
044690200528     C           EX@DAC    TAG
044700200528      *
044710200528      **  Unwind subroutine stack name
044720200528     C                     MOVEA*BLANKS   @STK,Q
044730200528     C                     SUB  1         Q
044740200528      *
044750200528     C                     ENDSR
044760200528     C*****************************************************************
044770200528     C/COPY WNCPYSRC,CG4630C017
044780200528     C/SPACE 5
044790200528      *****************************************************************
044800200528      * Subroutine  :  REMIT                                          *
044810200528      * Function    :  Remitting Party                                *
044820200528      *                                                               *
044830200528      * Called by   :                                                 *
044840200528      * Calls       :                                                 *
044850200528      *****************************************************************
044860200528     C           REMIT     BEGSR
044870200528      *
044880200528      **  Set up subroutine stack name
044890200528     C                     ADD  1         Q
044900200528     C                     MOVEL'REMIT '  @STK,Q
044910200528      *
044920200528      *................................................................
044930200528      *
044940200528      **  Retrieve subroutine specific data.
044950200528     C           1         OCUR ##SRDT
044960200528     C                     MOVEL##SPAT    S#PATH
044970200528      *
044980200528      **  Set up Path.
044990200528     C                     MOVEL'\REMIT ' ##PNAM
045000200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
045010200528      *                                                                                       CCG015
045020200528     C                     EXSR PSHGRS                                                        CCG015
045030200528      *
045040200528      **  Retrieve RDE information for RDEs in group set
045050200528      *
045060200528     C                     MOVEL'CORDTA'  ##GRPS
045070200528     C                     Z-ADD1         ##RDEN
045080200528     C                     EXSR SRRRDE
045090200528      *
045100200528     C***********RBKT      IFNE 'A'                                       087995
045110200528      *
045120200528     C                     MOVE RBKT      WTYPE
045130200528     C                     MOVELRBK1      WPTY
045140200528     C                     MOVE PCCY      WCCY
045150200528     C                     MOVELRBK1      WPTY1
045160200528     C                     MOVELRBK2      WPTY2
045170200528     C                     MOVEL*BLANKS   WBRCA
045180200528      *
045190200528     C                     EXSR SRTPSR
045200200528      *
045210200528     C***********          ENDIF                                          087995
045220200528      *
045230200528      **  Information Type
045240200528     C                     MOVE *BLANKS   #TYPE
045250200528     C                     MOVELRBKT      #TYPE
045260200528      *
045270200528     C                     MOVE *BLANKS   W#ADDR
045280200528     C           RBKT      IFEQ 'A'                                       087995
045290200528      **  Address line 1
045300200528     C                     MOVELRBK1      W#ADD1
045310200528      **  Address line 2
045320200528     C                     MOVELRBK2      W#ADD2
045330200528      *
045340200528      **  Address line 3
045350200528     C                     MOVELRBK3      W#ADD3
045360200528      *
045370200528      **  Address line 4
045380200528     C                     MOVELRBK4      W#ADD4
045390200528      *
045400200528      **  Address line 5
045410200528     C                     MOVE *BLANKS   W#ADD5
045420200528     C                     ELSE                                           087995
045430200528      **  Address line 1                                                  087995
045440200528     C                     MOVELCNA1      W#ADD1                          087995
045450200528      **  Address line 2                                                  087995
045460200528     C                     MOVELCNA2      W#ADD2                          087995
045470200528      *                                                                   087995
045480200528      **  Address line 3                                                  087995
045490200528     C                     MOVELCNA3      W#ADD3                          087995
045500200528      *                                                                   087995
045510200528      **  Address line 4                                                  087995
045520200528     C                     MOVELCNA4      W#ADD4                          087995
045530200528      *                                                                   087995
045540200528      **  Address line 5                                                  087995
045550200528     C                     MOVE CNA5      W#ADD5                          087995
045560200528     C                     ENDIF                                          087995
045570200528      *
045580200528     C                     EXSR CORDTA
045590200528      *
045600200528      **  Accumulate RDE's and associated data and output to
045610200528      **  PF/CGUDTAPD.
045620200528     C                     EXSR SRADTA
045630200528     C                     EXSR SRODTA
045640200528      *
045650200528      *................................................................
045660200528      *
045670200528     C           EXMIT     TAG
045680200528      *                                                                                       CCG015
045690200528     C                     EXSR POPGRS                                                        CCG015
045700200528      *
045710200528      **  Unwind subroutine stack name
045720200528     C                     MOVEA*BLANKS   @STK,Q
045730200528     C                     SUB  1         Q
045740200528      *
045750200528     C                     ENDSR
045760200528     C*****************************************************************
045770200528     C/SPACE 5
045780200528      *****************************************************************
045790200528      * Subroutine  :  DR@PTY                                         *
045800200528      * Function    :  Debit Party                                    *
045810200528      *                                                               *
045820200528      * Called by   :                                                 *
045830200528      * Calls       :                                                 *
045840200528      *****************************************************************
045850200528     C           DR@PTY    BEGSR
045860200528      *
045870200528      **  Set up subroutine stack name
045880200528     C                     ADD  1         Q
045890200528     C                     MOVEL'DR@PTY'  @STK,Q
045900200528      *
045910200528      *................................................................
045920200528      *
045930200528      **  Retrieve subroutine specific data.
045940200528     C           1         OCUR ##SRDT
045950200528     C                     MOVEL##SPAT    S#PATH
045960200528      *
045970200528      **  Set up Path.
045980200528     C                     MOVEL'\DR_PTY' ##PNAM
045990200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
046000200528      *                                                                                       CCG015
046010200528     C                     EXSR PSHGRS                                                        CCG015
046020200528      *
046030200528      **  Retrieve RDE information for RDEs in group set
046040200528      *
046050200528     C                     MOVEL'CORDTA'  ##GRPS
046060200528     C                     Z-ADD1         ##RDEN
046070200528     C                     EXSR SRRRDE
046080200528      *
046090200528     C                     MOVE DRPT      WTYPE
046100200528     C                     MOVELDRPY      WPTY
046110200528     C                     MOVE DRCY      WCCY
046120200528     C                     MOVELDRPY      WPTY1
046130200528     C                     MOVELDRBR      WBRCA
046140200528      *
046150200528     C                     EXSR SRTPSR
046160200528      *
046170200528      **  Debit Party Information Type
046180200528     C                     MOVE *BLANKS   #TYPE
046190200528     C                     MOVELDRPT      #TYPE
046200200528      *
046210200528     C                     MOVE *BLANKS   W#ADDR
046220200528      **  Debit Party Address line 1
046230200528     C                     MOVELCNA1      W#ADD1
046240200528      **  Debit Party Address line 2
046250200528     C                     MOVELCNA2      W#ADD2
046260200528      *
046270200528      **  Debit Party Address line 3
046280200528     C                     MOVELCNA3      W#ADD3
046290200528      *
046300200528      **  Debit Party Address line 4
046310200528     C                     MOVELCNA4      W#ADD4
046320200528      *
046330200528      **  Debit Party Address line 5
046340200528     C                     MOVE *BLANKS   W#ADD5
046350200528      *
046360200528     C                     EXSR CORDTA
046370200528      *
046380200528      **  Accumulate RDE's and associated data and output to
046390200528      **  PF/CGUDTAPD.
046400200528     C                     EXSR SRADTA
046410200528     C                     EXSR SRODTA
046420200528      *
046430200528      *................................................................
046440200528      *
046450200528     C           EX@PTY    TAG
046460200528      *                                                                                       CCG015
046470200528     C                     EXSR POPGRS                                                        CCG015
046480200528      *
046490200528      **  Unwind subroutine stack name
046500200528     C                     MOVEA*BLANKS   @STK,Q
046510200528     C                     SUB  1         Q
046520200528      *
046530200528     C                     ENDSR
046540200528     C*****************************************************************
046550200528     C/SPACE 5
046560200528      *****************************************************************
046570200528      * Subroutine  :  C@INST                                         *
046580200528      * Function    :  Collecting Institution                         *
046590200528      *                                                               *
046600200528      * Called by   :                                                 *
046610200528      * Calls       :                                                 *
046620200528      *****************************************************************
046630200528     C           C@INST    BEGSR
046640200528      *
046650200528      **  Set up subroutine stack name
046660200528     C                     ADD  1         Q
046670200528     C                     MOVEL'C@INST'  @STK,Q
046680200528      *
046690200528      *................................................................
046700200528      *
046710200528      **  Retrieve subroutine specific data.
046720200528     C           1         OCUR ##SRDT
046730200528     C                     MOVEL##SPAT    S#PATH
046740200528      *
046750200528      **  Set up Path.
046760200528     C                     MOVEL'\C_INST' ##PNAM
046770200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
046780200528      *                                                                                       CCG015
046790200528     C                     EXSR PSHGRS                                                        CCG015
046800200528      *
046810200528      **  Retrieve RDE information for RDEs in group set
046820200528      *
046830200528     C                     MOVEL'CORDTA'  ##GRPS
046840200528     C                     Z-ADD1         ##RDEN
046850200528     C                     EXSR SRRRDE
046860200528      *
046870200528     C***********COBT      IFNE 'A'                                       087995
046880200528     C*
046890200528     C                     MOVE COBT      WTYPE   1
046900200528     C**********           MOVELCOB1      WPTY   12                                           CGL029
046910200528     C                     MOVELCOB1      WPTY   18                                           CGL029
046920200528     C                     MOVE SMCY      WCCY    3
046930200528     C                     MOVELCOB1      WPTY1
046940200528     C                     MOVELCOB2      WPTY2
046950200528     C                     MOVEL*BLANKS   WBRCA   3
046960200528      *
046970200528     C                     EXSR SRTPSR
046980200528      *
046990200528     C***********          ENDIF                                          087995
047000200528      *
047010200528      **  Collecting Inst. Information Type
047020200528     C                     MOVE *BLANKS   #TYPE
047030200528     C                     MOVELCOBT      #TYPE
047040200528     C                     MOVE *BLANKS   W#ADDR
047050200528     C           COBT      IFEQ 'A'                                       087995
047060200528      **  Collecting Inst. Address line 1
047070200528     C                     MOVELCOB1      W#ADD1
047080200528      **  Collecting Inst. Address line 2
047090200528     C                     MOVELCOB2      W#ADD2
047100200528      *
047110200528      **  Collecting Inst. Address line 3
047120200528     C                     MOVELCOB3      W#ADD3
047130200528      *
047140200528      **  Collecting Inst. Address line 4
047150200528     C                     MOVELCOB4      W#ADD4
047160200528     C                     ELSE                                           087995
047170200528      **  Address line 1                                                  087995
047180200528     C                     MOVELCNA1      W#ADD1                          087995
047190200528      **  Address line 2                                                  087995
047200200528     C                     MOVELCNA2      W#ADD2                          087995
047210200528      *                                                                   087995
047220200528      **  Address line 3                                                  087995
047230200528     C                     MOVELCNA3      W#ADD3                          087995
047240200528      *                                                                   087995
047250200528      **  Address line 4                                                  087995
047260200528     C                     MOVELCNA4      W#ADD4                          087995
047270200528      *                                                                   087995
047280200528      **  Address line 5                                                  087995
047290200528     C                     MOVE CNA5      W#ADD5                          087995
047300200528     C                     ENDIF                                          087995
047310200528      *
047320200528     C                     EXSR CORDTA
047330200528      *
047340200528      **  Accumulate RDE's and associated data and output to
047350200528      **  PF/CGUDTAPD.
047360200528     C                     EXSR SRADTA
047370200528     C                     EXSR SRODTA
047380200528      *
047390200528      *................................................................
047400200528      *
047410200528     C           EXINS1    TAG
047420200528      *                                                                                       CCG015
047430200528     C                     EXSR POPGRS                                                        CCG015
047440200528      *
047450200528      **  Unwind subroutine stack name
047460200528     C                     MOVEA*BLANKS   @STK,Q
047470200528     C                     SUB  1         Q
047480200528      *
047490200528     C                     ENDSR
047500200528     C*****************************************************************
047510200528     C/SPACE 5
047520200528      *****************************************************************
047530200528      * Subroutine  :  CR@PTY                                         *
047540200528      * Function    :  Credit Party                                   *
047550200528      *                                                               *
047560200528      * Called by   :                                                 *
047570200528      * Calls       :                                                 *
047580200528      *****************************************************************
047590200528     C           CR@PTY    BEGSR
047600200528      *
047610200528      **  Set up subroutine stack name
047620200528     C                     ADD  1         Q
047630200528     C                     MOVEL'CR@PTY'  @STK,Q
047640200528      *
047650200528      *................................................................
047660200528      *
047670200528      **  Retrieve subroutine specific data.
047680200528     C           1         OCUR ##SRDT
047690200528     C                     MOVEL##SPAT    S#PATH
047700200528      *
047710200528      **  Set up Path.
047720200528     C                     MOVEL'\CR_PTY' ##PNAM
047730200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
047740200528      *                                                                                       CCG015
047750200528     C                     EXSR PSHGRS                                                        CCG015
047760200528      *
047770200528      **  Retrieve RDE information for RDEs in group set
047780200528      *
047790200528     C                     MOVEL'CORDTA'  ##GRPS
047800200528     C                     Z-ADD1         ##RDEN
047810200528     C                     EXSR SRRRDE
047820200528      *
047830200528     C                     MOVE CRPT      WTYPE
047840200528     C                     MOVELCRPY      WPTY
047850200528     C                     MOVE CRCY      WCCY
047860200528     C                     MOVELCRPY      WPTY1
047870200528     C                     MOVELCRBR      WBRCA
047880200528      *
047890200528     C                     EXSR SRTPSR
047900200528      *
047910200528      **  Credit party  Information Type
047920200528     C                     MOVE *BLANKS   #TYPE
047930200528     C                     MOVELCRPT      ##D,1
047940200528      *
047950200528     C                     MOVE *BLANKS   W#ADDR
047960200528      **  Credit Party Address line 1
047970200528     C                     MOVELCNA1      W#ADD1
047980200528      **  Credit Party Address line 2
047990200528     C                     MOVELCNA2      W#ADD2
048000200528      *
048010200528      **  Credit Party Address line 3
048020200528     C                     MOVELCNA3      W#ADD3
048030200528      *
048040200528      **  Credit Party Address line 4
048050200528     C                     MOVELCNA4      W#ADD4
048060200528      *
048070200528      **  Credit Party Address line 4
048080200528     C                     MOVE *BLANKS   W#ADD5
048090200528      *                                                                   087994
048100200528     C                     EXSR CORDTA                                    087994
048110200528      *
048120200528      **  Accumulate RDE's and associated data and output to
048130200528      **  PF/CGUDTAPD.
048140200528     C                     EXSR SRADTA
048150200528     C                     EXSR SRODTA
048160200528      *
048170200528      *................................................................
048180200528      *
048190200528     C           EX@PT1    TAG
048200200528      *                                                                                       CCG015
048210200528     C                     EXSR POPGRS                                                        CCG015
048220200528      *
048230200528      **  Unwind subroutine stack name
048240200528     C                     MOVEA*BLANKS   @STK,Q
048250200528     C                     SUB  1         Q
048260200528      *
048270200528     C                     ENDSR
048280200528     C*****************************************************************
048290200528     C/SPACE 5
048300200528      *****************************************************************
048310200528      * Subroutine  :  NARR                                           *
048320200528      * Function    :  Narrative                                      *
048330200528      *                                                               *
048340200528      * Called by   :                                                 *
048350200528      * Calls       :                                                 *
048360200528      *****************************************************************
048370200528     C           NARR      BEGSR
048380200528      *
048390200528      **  Set up subroutine stack name
048400200528     C                     ADD  1         Q
048410200528     C                     MOVEL'NARR  '  @STK,Q
048420200528      *
048430200528      *................................................................
048440200528      *
048450200528      **  Retrieve subroutine specific data.
048460200528     C           1         OCUR ##SRDT
048470200528     C                     MOVEL##SPAT    S#PATH
048480200528      *
048490200528      **  Set up Path.
048500200528     C                     MOVEL'\NARR  ' ##PNAM
048510200528     C           S#PATH    CAT  ##PNAM:0  S#PATH
048520200528      *                                                                                       CCG015
048530200528     C                     EXSR PSHGRS                                                        CCG015
048540200528      *
048550200528      **  Retrieve RDE information for RDEs in group set
048560200528      *
048570200528     C                     MOVEL@STK,Q    ##GRPS
048580200528     C                     Z-ADD1         ##RDEN
048590200528      *
048600200528     C                     EXSR SRRRDE
048610200528      *
048620200528      ** Narrative field - 1
048630200528     C                     MOVELNAR1      ##D,1
048640200528      *
048650200528      ** Narrative field - 2
048660200528     C                     MOVELNAR2      ##D,2
048670200528      *
048680200528      ** Narrative field - 3
048690200528     C                     MOVELNAR3      ##D,3
048700200528      *
048710200528      ** Narrative field - 4
048720200528     C                     MOVELNAR4      ##D,4
048730200528      *
048740200528      ** Narrative field - 5
048750200528     C                     MOVELNAR5      ##D,5
048760200528      *
048770200528      ** Narrative field - 6
048780200528     C                     MOVELNAR6      ##D,6
048790200528      *
048800200528      **  Accumulate RDE's and associated data and output to
048810200528      **  PF/CGUDTAPD.
048820200528     C                     EXSR SRADTA
048830200528     C                     EXSR SRODTA
048840200528      *
048850200528      *................................................................
048860200528      *
048870200528     C           EXRR      TAG
048880200528      *                                                                                       CCG015
048890200528     C                     EXSR POPGRS                                                        CCG015
048900200528      *
048910200528      **  Unwind subroutine stack name
048920200528     C                     MOVEA*BLANKS   @STK,Q
048930200528     C                     SUB  1         Q
048940200528      *
048950200528     C                     ENDSR
048960200528     C*****************************************************************   CEU006
048970200528     C/SPACE 5                                                            CEU006
048980200528      *****************************************************************   CEU006
048990200528      * Subroutine  :  FT@DLV                                         *   CEU006
049000200528      * Function    :  Funds Transfer Delivery Details                *   CEU006
049010200528      *                                                               *   CEU006
049020200528      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
049030200528      * Calls       :                                                 *   CEU006
049040200528      *****************************************************************   CEU006
049050200528     C           FT@DLV    BEGSR                                          CEU006
049060200528      *                                                                   CEU006
049070200528      **  Set up subroutine stack name                                    CEU006
049080200528     C                     ADD  1         Q                               CEU006
049090200528     C                     MOVEL'FT_DLV'  @STK,Q                          CEU006
049100200528      *                                                                   CEU006
049110200528      *................................................................   CEU006
049120200528      *                                                                   CEU006
049130200528      **  Retrieve subroutine specific data.                              CEU006
049140200528     C           1         OCUR ##SRDT                                    CEU006
049150200528     C                     MOVEL##SPAT    S#PATH                          CEU006
049160200528      *                                                                   CEU006
049170200528      **  Set up Path.                                                    CEU006
049180200528     C                     MOVEL'\FT_DLV' ##PNAM                          CEU006
049190200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
049200200528      *                                                                                       CCG015
049210200528     C                     EXSR PSHGRS                                                        CCG015
049220200528      *                                                                   CEU006
049230200528      **  Retrieve RDE information for RDEs in group set                  CEU006
049240200528      *                                                                   CEU006
049250200528     C                     MOVEL@STK,Q    ##GRPS                          CEU006
049260200528     C                     Z-ADD1         ##RDEN                          CEU006
049270200528     C                     EXSR SRRRDE                                    CEU006
049280200528      *                                                                   CEU006
049290200528      **  Notified Delivery Currency                                      CEU006
049300200528      *                                                                   CEU006
049310200528     C                     SELEC                                          CEU006
049320200528     C           NDCY      WHEQ *BLANKS                                   CEU006
049330200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
049340200528     C                     MOVEL*BLANKS   ##D,1                           CEU006
049350200528      *                                                                   CEU006
049360200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
049370200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
049380200528     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
049390200528      *                                                                   CEU006
049400200528     C           CFT014    IFEQ 'Y'                                       192761
049410200528     C                     MOVE *BLANK    WNINCY  1                       CFT014
049420200528     C                     Z-ADD0         WNTPSD  50                      CFT014
049430200528     C                     ENDIF                                          192761
049440200528     C                     CALL 'AOCURRR0'                                CEU006
049450200528     C                     PARM *BLANKS   @RTCD                           CEU006
049460200528     C                     PARM '*KEY   ' @OPTN                           CEU006
049470200528     C                     PARM NDCY      @AJCD                           CEU006
049480200528     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
049490200528      *                                                                   CEU006
049500200528      ** DATABASE ERROR                                                   CEU006
049510200528     C           @RTCD     IFNE *BLANK                                    CEU006
049520200528     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
049530200528     C                     MOVELNDCY      W0KEY            ***************CEU006
049540200528     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU006
049550200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
049560200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
049570200528     C                     EXSR SRERR                                     CEU006
049580200528     C                     ELSE                                           CFT014
049590200528     C           CFT014    IFEQ 'Y'                                       192761
049600200528     C                     MOVE A6INCY    WNINCY                          CFT014
049610200528     C                     Z-ADDA6TPSD    WNTPSD                          CFT014
049620200528     C                     ENDIF                                          CEU006
049630200528     C                     ENDIF                                          192761
049640200528     C/COPY WNCPYSRC,CG4630C076
049650200528      *                                                                   CFT014
049660200528      ** Access Settlement Currency's details                             CFT014
049670200528     C           CFT014    IFEQ 'Y'                                       192761
049680200528     C                     MOVE *BLANK    WSINCY  1                       CFT014
049690200528     C                     Z-ADD0         WSTPSD  50                      CFT014
049700200528     C           CFT014    IFEQ 'Y'                                       CFT014
049710200528     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
049720200528     C                     MOVE SMCY      P@CCY                           CFT014
049730200528     C                     EXSR SRCURR                                    CFT014
049740200528     C                     MOVE A6INCY    WSINCY                          CFT014
049750200528     C                     Z-ADDA6TPSD    WSTPSD                          CFT014
049760200528     C                     ENDIF                                          CFT014
049770200528      *                                                                   CEU006
049780200528      ** If CFT014 and Incoming payment,                                  CFT014
049790200528      ** output only if both of them involve Euro currencies              CFT014
049800200528     C           CFT014    IFEQ 'N'                                       CFT014
049810200528     C           CFT014    OREQ 'Y'                                       CFT014
049820200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
049830200528     C           CFT014    OREQ 'Y'                                       CFT014
049840200528     C           ##FILE    ANDEQ'CQPAC  '                                 CFT014
049850200528     C           CFT014    OREQ 'Y'                                       CFT014
049860200528     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
049870200528     C           WNINCY    ANDEQ'Y'                                       CFT014
049880200528     C           WNTPSD    ANDLESLDT                                      CFT014
049890200528     C           SMCY      ANDEQBKEURO                                    CFT014
049900200528     C           CFT014    OREQ 'Y'                                       CFT014
049910200528     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
049920200528     C           WSINCY    ANDEQ'Y'                                       CFT014
049930200528     C           WSTPSD    ANDLESLDT                                      CFT014
049940200528     C           NDCY      ANDEQBKEURO                                    CFT014
049950200528     C                     MOVELNDCY      ##D,1                           CEU006
049960200528     C                     ENDIF                                          CFT014
049970200528     C                     ELSE                                           192761
049980200528     C                     MOVELNDCY      ##D,1                           192761
049990200528     C                     ENDIF                                          192761
050000200528      *                                                                   CEU006
050010200528     C                     ENDSL                                          CEU006
050020200528      *                                                                   CEU006
050030200528      **  Notified Delivery Amount                                        CEU006
050040200528     C                     SELEC                                          CEU006
050050200528     C           NDCY      WHEQ *BLANKS                                   CEU006
050060200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
050070200528     C                     MOVEL*BLANKS   ##D,2                           CEU006
050080200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
050090200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
050100200528     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
050110200528     C           CFT014    IFEQ 'Y'                                       192761
050120200528      ** If CFT014, output only if both of them involve Euro currencies   CFT014
050130200528     C           CFT014    IFEQ 'N'                                       CFT014
050140200528     C           CFT014    OREQ 'Y'                                       CFT014
050150200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
050160200528     C           CFT014    OREQ 'Y'                                       CFT014
050170200528     C           ##FILE    ANDEQ'CQPAC  '                                 CFT014
050180200528     C           CFT014    OREQ 'Y'                                       CFT014
050190200528     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
050200200528     C           WNINCY    ANDEQ'Y'                                       CFT014
050210200528     C           WNTPSD    ANDLESLDT                                      CFT014
050220200528     C           SMCY      ANDEQBKEURO                                    CFT014
050230200528     C           CFT014    OREQ 'Y'                                       CFT014
050240200528     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
050250200528     C           WSINCY    ANDEQ'Y'                                       CFT014
050260200528     C           WSTPSD    ANDLESLDT                                      CFT014
050270200528     C           NDCY      ANDEQBKEURO                                    CFT014
050280200528     C                     MOVELNDAM      ##D,2                           CEU006
050290200528     C/COPY WNCPYSRC,CG4630C077
050300200528     C                     MOVE A6NBDP    ##D,2                           CEU006
050310200528     C                     ENDIF                                          CFT014
050320200528     C                     ELSE                                           192761
050330200528     C                     MOVELNDAM      ##D,2                           192761
050340200528     C                     MOVE A6NBDP    ##D,2                           192761
050350200528     C                     ENDIF                                          192761
050360200528     C                     ENDSL                                          CEU006
050370200528      *                                                                   CEU006
050380200528      **  Pay Delivery Currency                                           CEU006
050390200528     C                     SELEC                                          CEU006
050400200528     C           PDCY      WHEQ *BLANKS                                   CEU006
050410200528     C           ##FILE    OREQ 'INPAY  '                                 CEU006
050420200528     C***********##FILE    OREQ 'CQPAC  '                           CEU006152149
050430200528     C                     MOVEL*BLANKS   ##D,3                           CEU006
050440200528      *                                                                   CEU006
050450200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
050460200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
050470200528     C           ##FILE    OREQ 'CQPAC  '                                 152149
050480200528      *                                                                   CEU006
050490200528     C           CFT014    IFEQ 'Y'                                       192761
050500200528     C                     MOVE *BLANK    WNINCY                          CFT014
050510200528     C                     Z-ADD0         WNTPSD                          CFT014
050520200528     C                     ENDIF                                          192761
050530200528     C                     CALL 'AOCURRR0'                                CEU006
050540200528     C                     PARM *BLANKS   @RTCD                           CEU006
050550200528     C                     PARM '*KEY   ' @OPTN                           CEU006
050560200528     C                     PARM PDCY      @AJCD                           CEU006
050570200528     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
050580200528      *                                                                   CEU006
050590200528      ** DATABASE ERROR                                                   CEU006
050600200528     C           @RTCD     IFNE *BLANK                                    CEU006
050610200528     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
050620200528     C                     MOVELPDCY      W0KEY            ***************CEU006
050630200528     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *CEU006
050640200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
050650200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
050660200528     C                     EXSR SRERR                                     CEU006
050670200528     C                     ELSE                                           CFT014
050680200528     C           CFT014    IFEQ 'Y'                                       192761
050690200528     C                     MOVE A6INCY    WNINCY                          CFT014
050700200528     C                     Z-ADDA6TPSD    WNTPSD                          CFT014
050710200528     C                     ENDIF                                          CEU006
050720200528     C                     ENDIF                                          192761
050730200528     C/COPY WNCPYSRC,CG4630C078
050740200528      *                                                                   CFT014
050750200528     C           CFT014    IFEQ 'Y'                                       192761
050760200528      ** Access Pay Currency's details                                    CFT014
050770200528     C                     MOVE *BLANK    WPINCY  1                       CFT014
050780200528     C                     Z-ADD0         WPTPSD  50                      CFT014
050790200528     C           CFT014    IFEQ 'Y'                                       CFT014
050800200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
050810200528     C                     MOVE PCCY      P@CCY                           CFT014
050820200528     C                     EXSR SRCURR                                    CFT014
050830200528     C                     MOVE A6INCY    WPINCY                          CFT014
050840200528     C                     Z-ADDA6TPSD    WPTPSD                          CFT014
050850200528     C                     ENDIF                                          CFT014
050860200528     C                     ENDIF                                          192761
050870200528      *                                                                   CEU006
050880200528      ** If CFT014, output only if both of them involve Euro currencies   CFT014
050890200528     C           CFT014    IFEQ 'Y'                                       192761
050900200528     C           CFT014    IFEQ 'N'                                       CFT014
050910200528     C           CFT014    OREQ 'Y'                                       CFT014
050920200528     C           ##FILE    ANDEQ'CQCOD  '                                 CFT014
050930200528     C           CFT014    OREQ 'Y'                                       CFT014
050940200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
050950200528     C           WNINCY    ANDEQ'Y'                                       CFT014
050960200528     C           WNTPSD    ANDLEPVDT                                      CFT014
050970200528     C           PCCY      ANDEQBKEURO                                    CFT014
050980200528     C           CFT014    OREQ 'Y'                                       CFT014
050990200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
051000200528     C           WPINCY    ANDEQ'Y'                                       CFT014
051010200528     C           WPTPSD    ANDLEPVDT                                      CFT014
051020200528     C           PDCY      ANDEQBKEURO                                    CFT014
051030200528     C                     MOVELPDCY      ##D,3                           CEU006
051040200528     C                     ENDIF                                          CFT014
051050200528     C                     ELSE                                           192761
051060200528     C                     MOVELPDCY      ##D,3                           192761
051070200528     C                     ENDIF                                          192761
051080200528      *                                                                   CEU006
051090200528     C                     ENDSL                                          CEU006
051100200528      *                                                                   CEU006
051110200528      **  Pay Delivery Amount                                             CEU006
051120200528     C                     SELEC                                          CEU006
051130200528     C           PDCY      WHEQ *BLANKS                                   CEU006
051140200528     C           ##FILE    OREQ 'INPAY  '                                 CEU006
051150200528     C***********##FILE    OREQ 'CQPAC  '                           CEU006152149
051160200528     C                     MOVEL*BLANKS   ##D,4                           CEU006
051170200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
051180200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
051190200528     C           ##FILE    OREQ 'CQPAC  '                                 152149
051200200528     C           CFT014    IFEQ 'Y'                                       192761
051210200528      ** If CFT014, output only if both of them involve Euro currencies   CFT014
051220200528     C           CFT014    IFEQ 'N'                                       CFT014
051230200528     C           CFT014    OREQ 'Y'                                       CFT014
051240200528     C           ##FILE    ANDEQ'CQCOD  '                                 CFT014
051250200528     C           CFT014    OREQ 'Y'                                       CFT014
051260200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
051270200528     C           WNINCY    ANDEQ'Y'                                       CFT014
051280200528     C           WNTPSD    ANDLEPVDT                                      CFT014
051290200528     C           PCCY      ANDEQBKEURO                                    CFT014
051300200528     C           CFT014    OREQ 'Y'                                       CFT014
051310200528     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
051320200528     C           WPINCY    ANDEQ'Y'                                       CFT014
051330200528     C           WPTPSD    ANDLEPVDT                                      CFT014
051340200528     C           PDCY      ANDEQBKEURO                                    CFT014
051350200528     C                     MOVELPDAM      ##D,4                           CEU006
051360200528     C/COPY WNCPYSRC,CG4630C079
051370200528     C                     MOVE A6NBDP    ##D,4                           CEU006
051380200528     C                     ENDIF                                          CFT014
051390200528     C                     ELSE                                           192761
051400200528     C                     MOVELPDAM      ##D,4                           192761
051410200528     C                     MOVE A6NBDP    ##D,4                           192761
051420200528     C                     ENDIF                                          192761
051430200528     C                     ENDSL                                          CEU006
051440200528      *                                                                   CEU006
051450200528     C/COPY WNCPYSRC,CG4630C098
051460200528      **  Accumulate RDE's and associated data and output to              CEU006
051470200528      **  PF/CGUDTAPD.                                                    CEU006
051480200528     C                     EXSR SRADTA                                    CEU006
051490200528     C                     EXSR SRODTA                                    CEU006
051500200528      *                                                                   CEU006
051510200528      *................................................................   CEU006
051520200528      *                                                                   CEU006
051530200528     C           EX@DLV    TAG                                            CEU006
051540200528      *                                                                                       CCG015
051550200528     C                     EXSR POPGRS                                                        CCG015
051560200528      *                                                                   CEU006
051570200528      **  Unwind subroutine stack name                                    CEU006
051580200528     C                     MOVEA*BLANKS   @STK,Q                          CEU006
051590200528     C                     SUB  1         Q                               CEU006
051600200528      *                                                                   CEU006
051610200528     C                     ENDSR                                          CEU006
051620200528     C*****************************************************************   CEU006
051630200528     C/SPACE 5                                                            CEU006
051640200528      *****************************************************************   CEU006
051650200528      * Subroutine  :  CHGENT                                         *   CEU006
051660200528      * Function    :  Entered Charges                                *   CEU006
051670200528      *                                                               *   CEU006
051680200528      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
051690200528      * Calls       :  EURAMT                                         *   CEU006
051700200528      *****************************************************************   CEU006
051710200528     C           CHGENT    BEGSR                                          CEU006
051720200528      *                                                                   CEU006
051730200528      **  Set up subroutine stack name                                    CEU006
051740200528     C                     ADD  1         Q                               CEU006
051750200528     C                     MOVEL'CHGENT'  @STK,Q                          CEU006
051760200528      *                                                                   CEU006
051770200528      *................................................................   CEU006
051780200528      *                                                                   CEU006
051790200528      **  Retrieve subroutine specific data.                              CEU006
051800200528     C           1         OCUR ##SRDT                                    CEU006
051810200528     C                     MOVEL##SPAT    S#PATH                          CEU006
051820200528      *                                                                   CEU006
051830200528      **  Set up Path.                                                    CEU006
051840200528     C                     MOVEL'\CHGENT' ##PNAM                          CEU006
051850200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
051860200528      *                                                                                       CCG015
051870200528     C                     EXSR PSHGRS                                                        CCG015
051880200528      *                                                                   CEU006
051890200528      **  Retrieve RDE information for RDEs in group set                  CEU006
051900200528      *                                                                   CEU006
051910200528     C                     MOVEL@STK,Q    ##GRPS                          CEU006
051920200528     C                     Z-ADD1         ##RDEN                          CEU006
051930200528     C                     EXSR SRRRDE                                    CEU006
051940200528      *                                                                   CEU006
051950200528      **  Entered Currency                                                CEU006
051960200528      *                                                                   CEU006
051970200528     C           *LIKE     DEFN SLDT      W#DATE                          CEU006
051980200528      *                                                                   CEU006
051990200528     C                     SELEC                                          CEU006
052000200528      *                                                                   CEU006
052010200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
052020200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
052030200528     C                     SELEC                                          CEU006
052040200528     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
052050200528     C           CDRO      WHNE *BLANKS                                                     BUG11679
052060200528     C           CFT120    ANDEQ'Y'                                                           CFT120
052070200528      *                                                                                       CFT120
052080200528      ** Incoming Payment                                                                     CFT120
052090200528      *                                                                                       CFT120
052100200528     C           ##FILE    IFEQ 'INPAY  '                                                     CFT120
052110200528     C           INCDRC    IFEQ *BLANKS                                                       CFT120
052120200528     C                     MOVELBJCYCD    #CCY                                                CFT120
052130200528     C                     ELSE                                                               CFT120
052140200528     C                     MOVELINCDRC    #CCY                                                CFT120
052150200528     C                     ENDIF                                                              CFT120
052160200528     C                     ENDIF                                                              CFT120
052170200528      *                                                                                       CFT120
052180200528      ** Outgoing Payment                                                                     CFT120
052190200528      *                                                                                       CFT120
052200200528     C           ##FILE    IFEQ 'OTPAY  '                                                     CFT120
052210200528     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
052220200528     C                     MOVELBJCYCD    #CCY                                                CFT120
052230200528     C                     ELSE                                                               CFT120
052240200528     C                     MOVELOPCDRC    #CCY                                                CFT120
052250200528     C                     ENDIF                                                              CFT120
052260200528     C                     ENDIF                                                              CFT120
052270200528     C           CDRO      WHNE *BLANKS                                                       CFT120
052280200528     C           CFT120    ANDEQ'N'                                                           CFT120
052290200528     C********** BTCHCY    OREQ 'B'                                                 CEU006 AR1082119
052300200528     C           BTCHCY    OREQ 'B'                                                       AR1082119A
052310200528     C**********           SELEC                                                AR1082119 AR1082119A
052320200528     C********** BTCHCY    WHEQ 'B'                                             AR1082119 AR1082119A
052330200528     C                     MOVELBJCYCD    #CCY                            CEU006
052340200528     C           BTCHCY    WHEQ 'L'                                       CEU006
052350200528     C                     MOVELBJLCCY    #CCY                            CEU006
052360200528     C           BTCHCY    WHEQ 'C'                                       CEU006
052370200528     C           ADDC      ANDEQ'A'                                       CEU006
052380200528     C                     MOVELSMCY      #CCY                            CEU006
052390200528     C********** BTCHCY    WHEQ 'C'                                             AR1082119 AR1082119A
052400200528     C********** ADDC      ANDEQ'D'                                             AR1082119 AR1082119A
052410200528     C**********           OTHER                                                    CEU006 AR1082119
052420200528     C**********           MOVELPCCY      #CCY                                     CEU006 AR1082119A
052430200528     C           BTCHCY    WHEQ 'F'                                                        AR1082119
052440200528     C                     MOVELFCHCCY    #CCY                                             AR1082119
052450200528     C                     OTHER                                                          AR1082119A
052460200528     C                     MOVELPCCY      #CCY                                            AR1082119A
052470200528     C**********           ENDSL                                                AR1082119 AR1082119A
052480200528     C                     ENDSL                                          CEU006
052490200528     C           ADDC      IFEQ 'A'                                       CEU006
052500200528     C                     Z-ADDSLDT      W#DATE                          CEU006
052510200528     C                     ELSE                                           CEU006
052520200528     C                     Z-ADDPVDT      W#DATE                          CEU006
052530200528     C                     ENDIF                                          CEU006
052540200528      *                                                                   CEU006
052550200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
052560200528     C                     SELEC                                          CEU006
052570200528     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
052580200528     C           CDRO      WHNE *BLANKS                                                     BUG11679
052590200528     C           CFT120    ANDEQ'N'                                                           CFT120
052600200528     C           BTCHCY    OREQ 'B'                                       CEU006
052610200528     C                     MOVE BJCYCD    #CCY                            CEU006
052620200528     C           BTCHCY    WHEQ 'L'                                       CEU006
052630200528     C                     MOVE BJLCCY    #CCY                            CEU006
052640200528     C           BTCHCY    WHEQ 'C'                                       CEU006
052650200528     C                     MOVE DRCY      #CCY                            CEU006
052660200528     C                     ENDSL                                          CEU006
052670200528     C                     Z-ADDDRVD      W#DATE                          CEU006
052680200528      *                                                                   CEU006
052690200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
052700200528     C                     SELEC                                          CEU006
052710200528     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
052720200528     C           CDRO      WHNE *BLANKS                                                     BUG11679
052730200528     C           BTCHCY    OREQ 'B'                                       CEU006
052740200528     C                     MOVE BJCYCD    #CCY                            CEU006
052750200528     C           BTCHCY    WHEQ 'L'                                       CEU006
052760200528     C                     MOVE BJLCCY    #CCY                            CEU006
052770200528     C           BTCHCY    WHEQ 'C'                                       CEU006
052780200528     C                     MOVE CRCY      #CCY                            CEU006
052790200528     C                     ENDSL                                          CEU006
052800200528     C                     Z-ADDCRVD      W#DATE                          CEU006
052810200528      *                                                                   CEU006
052820200528     C                     ENDSL                                          CEU006
052830200528      *                                                                   CEU006
052840200528     C                     CALL 'AOCURRR0'                                CEU006
052850200528     C                     PARM *BLANKS   @RTCD                           CEU006
052860200528     C                     PARM '*KEY   ' @OPTN                           CEU006
052870200528     C                     PARM #CCY      @AJCD                           CEU006
052880200528     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
052890200528      *                                                                   CEU006
052900200528      ** DATABASE ERROR                                                   CEU006
052910200528     C           @RTCD     IFNE *BLANK                                    CEU006
052920200528     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
052930200528     C                     MOVEL#CCY      W0KEY            ***************CEU006
052940200528     C                     Z-ADD19        W0ERNB           * DB ERROR 19 *CEU006
052950200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
052960200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
052970200528     C                     EXSR SRERR                                     CEU006
052980200528     C                     ENDIF                                          CEU006
052990200528     C/COPY WNCPYSRC,CG4630C080
053000200528      *                                                                   CEU006
053010200528      ** save entry currency as #ENTCY and In Ccy Indicator as #ENTIN     CEU006
053020200528      ** for use in subroutine CHGEUR.                                    CEU006
053030200528      *                                                                   CEU006
053040200528     C                     MOVEL#CCY      #ENTCY  3                       CEU006
053050200528     C                     MOVELA6INCY    #ENTIN  1                       CEU006
053060200528     C           A6TPSD    IFGT W#DATE                                    CEU006
053070200528     C                     MOVE 'N'       #ENTIN                          CEU006
053080200528     C                     ENDIF                                          CEU006
053090200528      *                                                                   CEU006
053100200528     C                     MOVEL#CCY      ##D,1                           CEU006
053110200528      *                                                                   CEU006
053120200528      **  Entered Transfer Commission                                     CEU006
053130200528      *                                                                   CEU006
053140200528     C           *LIKE     DEFN TRCH      #ENTTF                          CEU006
053150200528     C                     Z-ADD0         #ENTTF                          CEU006
053160200528      *                                                                   CEU006
053170200528     C                     SELEC                                          CEU006
053180200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
053190200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
053200200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
053210200528     C                     Z-ADDDUMA1     #ENTTF                          CEU006
053220200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
053230200528     C                     Z-ADDTRCH      #ENTTF                          CEU006
053240200528     C                     ENDSL                                          CEU006
053250200528      *                                                                   CEU006
053260200528     C                     MOVEL#ENTTF    ##D,2                           CEU006
053270200528     C/COPY WNCPYSRC,CG4630C081
053280200528     C                     MOVE A6NBDP    ##D,2                           CEU006
053290200528      *                                                                   CEU006
053300200528      **  Entered FX/Charge Commission                                    CEU006
053310200528      *                                                                   CEU006
053320200528     C           *LIKE     DEFN PDCHCH    #ENTFX                          CEU006
053330200528     C                     Z-ADD0         #ENTFX                          CEU006
053340200528      *                                                                   CEU006
053350200528     C                     SELEC                                          CEU006
053360200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
053370200528     C                     Z-ADDINDUM7    #ENTFX                          CEU006
053380200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
053390200528     C                     Z-ADDOPDUM7    #ENTFX                          CEU006
053400200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
053410200528     C                     Z-ADDPDCHCH    #ENTFX                          CEU006
053420200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
053430200528     C                     Z-ADDCCDUM5    #ENTFX                          CEU006
053440200528     C                     ENDSL                                          CEU006
053450200528      *                                                                   CEU006
053460200528     C                     MOVEL#ENTFX    ##D,3                           CEU006
053470200528     C/COPY WNCPYSRC,CG4630C082
053480200528     C                     MOVE A6NBDP    ##D,3                           CEU006
053490200528      *                                                                   CEU006
053500200528      **  Entered Telex Charge                                            CEU006
053510200528      *                                                                   CEU006
053520200528     C           *LIKE     DEFN DUMA2     #ENTTX                          CEU006
053530200528     C                     Z-ADD0         #ENTTX                          CEU006
053540200528      *                                                                   CEU006
053550200528     C                     SELEC                                          CEU006
053560200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
053570200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
053580200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
053590200528     C                     Z-ADDDUMA2     #ENTTX                          CEU006
053600200528     C                     MOVELDUMA2     ##D,4                           CEU006
053610200528     C/COPY WNCPYSRC,CG4630C083
053620200528     C                     MOVE A6NBDP    ##D,4                           CEU006
053630200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
053640200528     C                     MOVE *BLANKS   ##D,4                           CEU006
053650200528     C                     ENDSL                                          CEU006
053660200528      *                                                                   CEU006
053670200528      **  Entered Cheque Charge                                           CEU006
053680200528      *                                                                   CEU006
053690200528     C           *LIKE     DEFN DUMA3     #ENTCQ                          CEU006
053700200528     C                     Z-ADD0         #ENTCQ                          CEU006
053710200528      *                                                                   CEU006
053720200528     C                     SELEC                                          CEU006
053730200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
053740200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
053750200528     C                     Z-ADDDUMA3     #ENTCQ                          CEU006
053760200528     C                     MOVELDUMA3     ##D,5                           CEU006
053770200528     C/COPY WNCPYSRC,CG4630C084
053780200528     C                     MOVE A6NBDP    ##D,5                           CEU006
053790200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
053800200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
053810200528     C                     MOVEL*BLANKS   ##D,5                           CEU006
053820200528     C                     ENDSL                                          CEU006
053830200528      *                                                                   CEU006
053840200528      **  Entered Costs Abroad                                            CEU006
053850200528      *                                                                   CEU006
053860200528     C           *LIKE     DEFN CSTH      #ENTCS                          CEU006
053870200528     C                     Z-ADD0         #ENTCS                          CEU006
053880200528      *                                                                   CEU006
053890200528     C                     SELEC                                          CEU006
053900200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
053910200528     C                     MOVE *BLANKS   ##D,6                           CEU006
053920200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
053930200528     C                     Z-ADDDUMA4     #ENTCS                          CEU006
053940200528     C                     MOVELDUMA4     ##D,6                           CEU006
053950200528     C/COPY WNCPYSRC,CG4630C085
053960200528     C                     MOVE A6NBDP    ##D,6                           CEU006
053970200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
053980200528     C                     Z-ADDCSTH      #ENTCS                          CEU006
053990200528     C                     MOVELCSTH      ##D,6                           CEU006
054000200528     C/COPY WNCPYSRC,CG4630C086
054010200528     C                     MOVE A6NBDP    ##D,6                           CEU006
054020200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
054030200528     C                     Z-ADDDUMA3     #ENTCS                          CEU006
054040200528     C                     MOVELDUMA3     ##D,6                           CEU006
054050200528     C/COPY WNCPYSRC,CG4630C087
054060200528     C                     MOVE A6NBDP    ##D,6                           CEU006
054070200528     C                     ENDSL                                          CEU006
054080200528      *                                                                   CEU006
054090200528      **  Entered SWIFT Charge                                            CEU006
054100200528      *                                                                   CEU006
054110200528     C           *LIKE     DEFN DUMA5     #ENTSW                          CEU006
054120200528     C                     Z-ADD0         #ENTSW                          CEU006
054130200528      *                                                                   CEU006
054140200528     C                     SELEC                                          CEU006
054150200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
054160200528     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
054170200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
054180200528     C                     MOVE *BLANKS   ##D,7                           CEU006
054190200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
054200200528     C                     Z-ADDDUMA5     #ENTSW                          CEU006
054210200528     C                     MOVELDUMA5     ##D,7                           CEU006
054220200528     C/COPY WNCPYSRC,CG4630C088
054230200528     C                     MOVE A6NBDP    ##D,7                           CEU006
054240200528     C                     ENDSL                                          CEU006
054250200528      *                                                                   CEU006
054260200528      **  Entered Collection Charge                                       CEU006
054270200528      *                                                                   CEU006
054280200528     C           *LIKE     DEFN COLH      #ENTCL                          CEU006
054290200528     C                     Z-ADD0         #ENTCL                          CEU006
054300200528      *                                                                   CEU006
054310200528     C                     SELEC                                          CEU006
054320200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
054330200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
054340200528     C                     MOVE *BLANKS   ##D,8                           CEU006
054350200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
054360200528     C                     Z-ADDCOLH      #ENTCL                          CEU006
054370200528     C                     MOVELCOLH      ##D,8                           CEU006
054380200528     C/COPY WNCPYSRC,CG4630C089
054390200528     C                     MOVE A6NBDP    ##D,8                           CEU006
054400200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
054410200528     C                     Z-ADDDUMA4     #ENTCL                          CEU006
054420200528     C                     MOVELDUMA4     ##D,8                           CEU006
054430200528     C/COPY WNCPYSRC,CG4630C090
054440200528     C                     MOVE A6NBDP    ##D,8                           CEU006
054450200528     C                     ENDSL                                          CEU006
054460200528      *                                                                   CEU006
054470200528      **  Entered Telephone Charge                                        CEU006
054480200528      *                                                                   CEU006
054490200528     C           *LIKE     DEFN DUMA5     #ENTTP                          CEU006
054500200528     C                     Z-ADD0         #ENTTP                          CEU006
054510200528      *                                                                   CEU006
054520200528     C                     SELEC                                          CEU006
054530200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
054540200528     C                     Z-ADDDUMA5     #ENTTP                          CEU006
054550200528     C                     MOVELDUMA5     ##D,9                           CEU006
054560200528     C/COPY WNCPYSRC,CG4630C091
054570200528     C                     MOVE A6NBDP    ##D,9                           CEU006
054580200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
054590200528     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
054600200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
054610200528     C                     MOVE *BLANKS   ##D,9                           CEU006
054620200528     C                     ENDSL                                          CEU006
054630200528      *                                                                   CEU006
054640200528      **  Entered Advice Charge                                           CEU006
054650200528      *                                                                   CEU006
054660200528     C           *LIKE     DEFN DUMA4     #ENTAD                          CEU006
054670200528     C                     Z-ADD0         #ENTAD                          CEU006
054680200528      *                                                                   CEU006
054690200528     C                     SELEC                                          CEU006
054700200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
054710200528     C                     Z-ADDDUMA4     #ENTAD                          CEU006
054720200528     C                     MOVELDUMA4     ##D,10                          CEU006
054730200528     C/COPY WNCPYSRC,CG4630C092
054740200528     C                     MOVE A6NBDP    ##D,10                          CEU006
054750200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
054760200528     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
054770200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
054780200528     C                     MOVE *BLANKS   ##D,10                          CEU006
054790200528     C                     ENDSL                                          CEU006
054800200528      *                                                                   CEU006
054810200528      **  Entered Miscellaneous Charge                                    CEU006
054820200528      *                                                                   CEU006
054830200528     C           *LIKE     DEFN DUMA6     #ENTMS                          CEU006
054840200528     C                     Z-ADD0         #ENTMS                          CEU006
054850200528      *                                                                   CEU006
054860200528     C                     SELEC                                          CEU006
054870200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
054880200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
054890200528     C                     Z-ADDDUMA6     #ENTMS                          CEU006
054900200528     C                     MOVELDUMA6     ##D,11                          CEU006
054910200528     C/COPY WNCPYSRC,CG4630C093
054920200528     C                     MOVE A6NBDP    ##D,11                          CEU006
054930200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
054940200528     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
054950200528     C                     MOVE *BLANKS   ##D,11                          CEU006
054960200528     C                     ENDSL                                          CEU006
054970200528      *                                                                   CEU006
054980200528      **  Entered VAT Amount                                              CEU006
054990200528      *                                                                   CEU006
055000200528     C           *LIKE     DEFN PDVATH    #ENTVT                          CEU006
055010200528     C                     Z-ADD0         #ENTVT                          CEU006
055020200528      *                                                                   CEU006
055030200528     C                     SELEC                                          CEU006
055040200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
055050200528     C                     Z-ADDINDUM8    #ENTVT                          CEU006
055060200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
055070200528     C                     Z-ADDOPDUM8    #ENTVT                          CEU006
055080200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
055090200528     C                     Z-ADDPDVATH    #ENTVT                          CEU006
055100200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
055110200528     C**********           Z-ADDDUMA6     #ENTVT                    CEU006137419
055120200528     C                     Z-ADDCCDUM6    #ENTVT                          137419
055130200528     C                     ENDSL                                          CEU006
055140200528      *                                                                   CEU006
055150200528     C                     MOVEL#ENTVT    ##D,12                          CEU006
055160200528     C/COPY WNCPYSRC,CG4630C094
055170200528     C                     MOVE A6NBDP    ##D,12                          CEU006
055180200528      *                                                                   CEU006
055190200528      **  Entered Total Charge                                            CEU006
055200200528      *                                                                   CEU006
055210200528     C           *LIKE     DEFN #W110D    #ENTTT                          CEU006
055220200528     C                     Z-ADD0         #ENTTT                          CEU006
055230200528      *                                                                   CEU006
055240200528     C                     SELEC                                          CEU006
055250200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
055260200528     C                     Z-ADDDUMA1     #ENTTT                          CEU006
055270200528     C           #ENTTT    ADD  INDUM7    #ENTTT                          CEU006
055280200528     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
055290200528     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
055300200528     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
055310200528     C           #ENTTT    ADD  DUMA5     #ENTTT                          CEU006
055320200528     C           #ENTTT    ADD  DUMA6     #ENTTT                          CEU006
055330200528     C           #ENTTT    ADD  INDUM8    #ENTTT                          CEU006
055340200528     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
055350200528     C                     Z-ADDDUMA1     #ENTTT                          CEU006
055360200528     C           #ENTTT    ADD  OPDUM7    #ENTTT                          CEU006
055370200528     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
055380200528     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
055390200528     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
055400200528     C           #ENTTT    ADD  DUMA5     #ENTTT                          CEU006
055410200528     C           #ENTTT    ADD  DUMA6     #ENTTT                          CEU006
055420200528     C           #ENTTT    ADD  OPDUM8    #ENTTT                          CEU006
055430200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
055440200528     C                     Z-ADDDUMA1     #ENTTT                          CEU006
055450200528     C           #ENTTT    ADD  CCDUM5    #ENTTT                          CEU006
055460200528     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
055470200528     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
055480200528     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
055490200528     C********** #ENTTT    ADD  DUMA6     #ENTTT                    CEU006137419
055500200528     C           #ENTTT    ADD  CCDUM6    #ENTTT                          137419
055510200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
055520200528     C                     Z-ADDTRCH      #ENTTT                          CEU006
055530200528     C           #ENTTT    ADD  PDCHCH    #ENTTT                          CEU006
055540200528     C           #ENTTT    ADD  COLH      #ENTTT                          CEU006
055550200528     C           #ENTTT    ADD  CSTH      #ENTTT                          CEU006
055560200528     C           #ENTTT    ADD  PDVATH    #ENTTT                          CEU006
055570200528     C                     ENDSL                                          CEU006
055580200528      *                                                                   CEU006
055590200528     C                     MOVEL#ENTTT    ##D,13                          CEU006
055600200528     C/COPY WNCPYSRC,CG4630C095
055610200528     C                     MOVE A6NBDP    ##D,13                          CEU006
055620200528      *                                                                   CEU006
055630200528      **  Entered Deductions                                              CEU006
055640200528      *                                                                   CEU006
055650200528     C           *LIKE     DEFN #W110D    #ENTDD                          CEU006
055660200528     C                     Z-ADD0         #ENTDD                          CEU006
055670200528      *                                                                   CEU006
055680200528     C           ##FILE    IFEQ 'CQPAC  '                                 CEU006
055690200528      *                                                                   CEU006
055700200528      **** convert DEDS in PCCY to #ENTDD in #CCY                         CEU006
055710200528      *                                                                   CEU006
055720200528     C                     CLEARP#0010                                    CEU006
055730200528     C                     MOVE PCCY      P#FRCY                          CEU006
055740200528     C                     Z-ADDDEDS      P#FRAM                          CEU006
055750200528     C                     EXSR EURAMT                                    CEU006
055760200528     C                     Z-ADDP#TOAM    #ENTDD                          CEU006
055770200528     C                     MOVEL#ENTDD    ##D,14                          CEU006
055780200528     C/COPY WNCPYSRC,CG4630C096
055790200528     C                     MOVE A6NBDP    ##D,14                          CEU006
055800200528     C                     ELSE                                           CEU006
055810200528     C                     MOVE *BLANKS   ##D,14                          CEU006
055820200528     C                     ENDIF                                          CEU006
055830200528      *                                                                   CEU006
055840200528      **  Entered Net Amount                                              CEU006
055850200528      *                                                                   CEU006
055860200528     C           *LIKE     DEFN #NETA     #ENTNT                          CEU006
055870200528     C                     Z-ADD0         #ENTNT                          CEU006
055880200528     C           *LIKE     DEFN SMAM      ##SMAM                          CEU006
055890200528     C           *LIKE     DEFN PYAM      ##PYAM                          CEU006
055900200528     C           *LIKE     DEFN CQAM      ##CQAM                          CEU006
055910200528      *                                                                   CEU006
055920200528     C                     SELEC                                          CEU006
055930200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
055940200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
055950200528     C           ADDC      IFEQ 'A'                                       CEU006
055960200528      *                                                                   CEU006
055970200528      **** convert SMAM in SMCY to ##SMAM in #CCY                         CEU006
055980200528      *                                                                   CEU006
055990200528     C                     CLEARP#0010                                    CEU006
056000200528     C                     MOVE SMCY      P#FRCY                          CEU006
056010200528     C                     Z-ADDSMAM      P#FRAM                          CEU006
056020200528     C                     EXSR EURAMT                                    CEU006
056030200528     C                     Z-ADDP#TOAM    ##SMAM                          CEU006
056040200528     C                     ELSE                                           CEU006
056050200528      *                                                                   CEU006
056060200528      **** convert PYAM in PCCY to ##PYAM in #CCY                         CEU006
056070200528      *                                                                   CEU006
056080200528     C                     CLEARP#0010                                    CEU006
056090200528     C                     MOVE PCCY      P#FRCY                          CEU006
056100200528     C                     Z-ADDPYAM      P#FRAM                          CEU006
056110200528     C                     EXSR EURAMT                                    CEU006
056120200528     C                     Z-ADDP#TOAM    ##PYAM                          CEU006
056130200528     C                     ENDIF                                          CEU006
056140200528     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
056150200528     C           CDRO      IFNE *BLANKS                                                     BUG11679
056160200528     C           ADDC      IFEQ 'A'                                       CEU006
056170200528     C                     Z-ADD##SMAM    #ENTNT                          CEU006
056180200528     C                     ELSE                                           CEU006
056190200528     C                     Z-ADD##PYAM    #ENTNT                          CEU006
056200200528     C                     ENDIF                                          CEU006
056210200528     C                     ELSE                                           CEU006
056220200528     C           ADDC      IFEQ 'A'                                       CEU006
056230200528     C           ##SMAM    ADD  #ENTTT    #ENTNT                          CEU006
056240200528     C                     ELSE                                           CEU006
056250200528     C           ##PYAM    SUB  #ENTTT    #ENTNT                          CEU006
056260200528     C                     ENDIF                                          CEU006
056270200528     C                     ENDIF                                          CEU006
056280200528      *                                                                   CEU006
056290200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
056300200528      *                                                                   CEU006
056310200528      **** convert CQAM in PCCY to ##CQAM in #CCY                         CEU006
056320200528      *                                                                   CEU006
056330200528     C                     CLEARP#0010                                    CEU006
056340200528     C                     MOVE PCCY      P#FRCY                          CEU006
056350200528     C                     Z-ADDCQAM      P#FRAM                          CEU006
056360200528     C                     EXSR EURAMT                                    CEU006
056370200528     C                     Z-ADDP#TOAM    ##CQAM                          CEU006
056380200528     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
056390200528     C           CDRO      IFNE *BLANKS                                                     BUG11679
056400200528     C                     Z-ADD##CQAM    #ENTNT                          CEU006
056410200528     C                     ELSE                                           CEU006
056420200528     C           ##CQAM    ADD  #ENTTT    #ENTNT                          CEU006
056430200528     C                     ENDIF                                          CEU006
056440200528      *                                                                   CEU006
056450200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
056460200528      *                                                                   CEU006
056470200528      **** convert CQAM in SMCY to ##CQAM in #CCY                         CEU006
056480200528      *                                                                   CEU006
056490200528     C                     CLEARP#0010                                    CEU006
056500200528     C                     MOVE SMCY      P#FRCY                          CEU006
056510200528     C                     Z-ADDCQAM      P#FRAM                          CEU006
056520200528     C                     EXSR EURAMT                                    CEU006
056530200528     C                     Z-ADDP#TOAM    ##CQAM                          CEU006
056540200528     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
056550200528     C           CDRO      IFNE *BLANKS                                                     BUG11679
056560200528     C                     Z-ADD##CQAM    #ENTNT                          CEU006
056570200528     C                     ELSE                                           CEU006
056580200528     C           ##CQAM    SUB  #ENTTT    #ENTNT                          CEU006
056590200528     C                     ENDIF                                          CEU006
056600200528     C                     ENDSL                                          CEU006
056610200528      *                                                                   CEU006
056620200528     C                     MOVEL#ENTNT    ##D,15                          CEU006
056630200528     C/COPY WNCPYSRC,CG4630C097
056640200528     C                     MOVE A6NBDP    ##D,15                          CEU006
056650200528      *                                                                   CEU006
056660200528      **  Accumulate RDE's and associated data and output to              CEU006
056670200528      **  PF/CGUDTAPD.                                                    CEU006
056680200528     C                     EXSR SRADTA                                    CEU006
056690200528     C                     EXSR SRODTA                                    CEU006
056700200528      *                                                                   CEU006
056710200528      *................................................................   CEU006
056720200528      *                                                                   CEU006
056730200528     C           EX@ENT    TAG                                            CEU006
056740200528      *                                                                                       CCG015
056750200528     C                     EXSR POPGRS                                                        CCG015
056760200528      *                                                                   CEU006
056770200528      **  Unwind subroutine stack name                                    CEU006
056780200528     C                     MOVEA*BLANKS   @STK,Q                          CEU006
056790200528     C                     SUB  1         Q                               CEU006
056800200528      *                                                                   CEU006
056810200528     C                     ENDSR                                          CEU006
056820200528     C*****************************************************************   CEU006
056830200528     C/SPACE 5                                                            CEU006
056840200528      *****************************************************************   CEU006
056850200528      * Subroutine  :  CHGEUR                                         *   CEU006
056860200528      * Function    :  Calculates Euro charges:                       *   CEU006
056870200528      *                                                               *   CEU006
056880200528      *                Euro Charges are the interim euro amounts      *   CEU006
056890200528      *                resulting during the conversion of entered     *   CEU006
056900200528      *                charges from entry currency to charge currency.*   CEU006
056910200528      *                                                               *   CEU006
056920200528      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
056930200528      * Calls       :  EURAMT                                         *   CEU006
056940200528      *****************************************************************   CEU006
056950200528     C           CHGEUR    BEGSR                                          CEU006
056960200528      *                                                                   CEU006
056970200528      **  Set up subroutine stack name                                    CEU006
056980200528     C                     ADD  1         Q                               CEU006
056990200528     C                     MOVEL'CHGEUR'  @STK,Q                          CEU006
057000200528      *                                                                   CEU006
057010200528      *................................................................   CEU006
057020200528      *                                                                   CEU006
057030200528      **  Retrieve subroutine specific data.                              CEU006
057040200528     C           1         OCUR ##SRDT                                    CEU006
057050200528     C                     MOVEL##SPAT    S#PATH                          CEU006
057060200528      *                                                                   CEU006
057070200528      **  Set up Path.                                                    CEU006
057080200528     C                     MOVEL'\CHGEUR' ##PNAM                          CEU006
057090200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
057100200528      *                                                                                       CCG015
057110200528     C                     EXSR PSHGRS                                                        CCG015
057120200528      *                                                                   CEU006
057130200528      **  Retrieve RDE information for RDEs in group set                  CEU006
057140200528      *                                                                   CEU006
057150200528     C                     MOVEL@STK,Q    ##GRPS                          CEU006
057160200528     C                     Z-ADD1         ##RDEN                          CEU006
057170200528     C                     EXSR SRRRDE                                    CEU006
057180200528      *                                                                   CEU006
057190200528      ** Save Charge currency and its In Currency Indicator.              CEU006
057200200528      *                                                                   CEU006
057210200528     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
057220200528     C           CDRO      IFNE *BLANKS                                                       CFT120
057230200528     C           CFT120    ANDEQ'Y'                                                           CFT120
057240200528     C                     SELEC                                                              CFT120
057250200528      *                                                                                       CFT120
057260200528      ** Incoming payment                                                                     CFT120
057270200528      *                                                                                       CFT120
057280200528     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
057290200528     C           INCDRC    IFEQ *BLANKS                                                       CFT120
057300200528     C                     MOVELBJCYCD    #CCY                                                CFT120
057310200528     C                     ELSE                                                               CFT120
057320200528     C                     MOVELINCDRC    #CCY                                                CFT120
057330200528     C                     ENDIF                                                              CFT120
057340200528      *                                                                                       CFT120
057350200528      ** Outgoing payment                                                                     CFT120
057360200528      *                                                                                       CFT120
057370200528     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
057380200528     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
057390200528     C                     MOVELBJCYCD    #CCY                                                CFT120
057400200528     C                     ELSE                                                               CFT120
057410200528     C                     MOVELOPCDRC    #CCY                                                CFT120
057420200528     C                     ENDIF                                                              CFT120
057430200528     C                     OTHER                                                              CFT120
057440200528     C                     MOVELBJCYCD    #CCY                                                CFT120
057450200528     C                     ENDSL                                                              CFT120
057460200528     C                     ELSE                                                               CFT120
057470200528     C           CDRO      IFNE *BLANKS                                                     BUG11679
057480200528     C                     MOVELBJCYCD    #CCY                            CEU006
057490200528     C                     ELSE                                           CEU006
057500200528      *                                                                   CEU006
057510200528     C                     SELEC                                          CEU006
057520200528     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
057530200528     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
057540200528     C           ADDC      IFEQ 'A'                                       CEU006
057550200528     C                     MOVELSMCY      #CCY                            CEU006
057560200528     C                     ELSE                                           CEU006
057570200528     C                     MOVELPCCY      #CCY                            CEU006
057580200528     C                     ENDIF                                          CEU006
057590200528     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
057600200528     C                     MOVELDRCY      #CCY                            CEU006
057610200528     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
057620200528     C                     MOVELCRCY      #CCY                            CEU006
057630200528     C                     ENDSL                                          CEU006
057640200528     C                     ENDIF                                          CEU006
057650200528     C                     ENDIF                                                              CFT120
057660200528      *                                                                   CEU006
057670200528     C                     CALL 'AOCURRR0'                                CEU006
057680200528     C                     PARM *BLANKS   @RTCD                           CEU006
057690200528     C                     PARM '*KEY   ' @OPTN                           CEU006
057700200528     C                     PARM #CCY      @AJCD                           CEU006
057710200528     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
057720200528      *                                                                   CEU006
057730200528      ** DATABASE ERROR                                                   CEU006
057740200528     C           @RTCD     IFNE *BLANK                                    CEU006
057750200528     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
057760200528     C                     MOVEL#CCY      W0KEY            ***************CEU006
057770200528     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *CEU006
057780200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
057790200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
057800200528     C                     EXSR SRERR                                     CEU006
057810200528     C                     ENDIF                                          CEU006
057820200528      *                                                                   CEU006
057830200528     C                     MOVEL#CCY      #CHGCY  3                       CEU006
057840200528     C                     MOVELA6INCY    #CHGIN  1                       CEU006
057850200528     C           A6TPSD    IFGT W#DATE                                    CEU006
057860200528     C                     MOVE 'N'       #CHGIN                          CEU006
057870200528     C                     ENDIF                                          CEU006
057880200528      *                                                                   CEU006
057890200528      **  Determine the number of decimal places for Euro                 CEU006
057900200528      *                                                                   CEU006
057910200528     C                     CALL 'AOCURRR0'                                CEU006
057920200528     C                     PARM *BLANKS   @RTCD                           CEU006
057930200528     C                     PARM '*KEY   ' @OPTN                           CEU006
057940200528     C                     PARM BKEURO    @AJCD                           CEU006
057950200528     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
057960200528      *                                                                   CEU006
057970200528      ** DATABASE ERROR                                                   CEU006
057980200528     C           @RTCD     IFNE *BLANK                                    CEU006
057990200528     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
058000200528     C                     MOVEL#CCY      W0KEY            ***************CEU006
058010200528     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *CEU006
058020200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
058030200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
058040200528     C                     EXSR SRERR                                     CEU006
058050200528     C                     ENDIF                                          CEU006
058060200528      *                                                                   CEU006
058070200528      ** Calculate the interim Euro amounts resulting from conversion     CEU006
058080200528      ** of charges from Entry Ccy #ENTCY to Charge Ccy #CHGCY.           CEU006
058090200528      **                                                                  CEU006
058100200528      ** First deal with case requiring #ENTCY -> Base -> Euro -> In:     CEU006
058110200528      **  #ENTCY is Out (not Base) and #CHGCY is In (not Base)            CEU006
058120200528      *                                                                   CEU006
058130200528     C                     SELEC                                          CEU006
058140200528      *                                                                   CEU006
058150200528     C           #ENTIN    WHNE 'Y'                                       CEU006
058160200528     C           #ENTCY    ANDNEBJCYCD                                    CEU006
058170200528     C           #CHGIN    ANDEQ'Y'                                       CEU006
058180200528     C           #CHGCY    ANDNEBJCYCD                                    CEU006
058190200528      *                                                                   CEU006
058200200528      ** Euro Currency                                                    CEU006
058210200528     C                     MOVELBKEURO    ##D,1                           CEU006
058220200528      *                                                                   CEU006
058230200528     C           *LIKE     DEFN P#FRAM    W#FRAM                          CEU006
058240200528      *                                                                   CEU006
058250200528      **  Interim Euro Transfer Commission                                CEU006
058260200528      *                                                                   CEU006
058270200528     C                     CLEARP#0010                                    CEU006
058280200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
058290200528     C                     Z-ADD#ENTTF    P#FRAM                          CEU006
058300200528     C                     MOVE BJCYCD    #CCY                            CEU006
058310200528     C                     EXSR EURAMT                                    CEU006
058320200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
058330200528     C                     CLEARP#0010                                    CEU006
058340200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
058350200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
058360200528     C                     MOVE BKEURO    #CCY                            CEU006
058370200528     C                     EXSR EURAMT                                    CEU006
058380200528     C                     MOVELW#TOAM    ##D,2                           CEU006
058390200528     C                     MOVE A6NBDP    ##D,2                           CEU006
058400200528      *                                                                   CEU006
058410200528      **  Interim Euro FX/Charge Commission                               CEU006
058420200528      *                                                                   CEU006
058430200528     C                     CLEARP#0010                                    CEU006
058440200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
058450200528     C                     Z-ADD#ENTFX    P#FRAM                          CEU006
058460200528     C                     MOVE BJCYCD    #CCY                            CEU006
058470200528     C                     EXSR EURAMT                                    CEU006
058480200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
058490200528     C                     CLEARP#0010                                    CEU006
058500200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
058510200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
058520200528     C                     MOVE BKEURO    #CCY                            CEU006
058530200528     C                     EXSR EURAMT                                    CEU006
058540200528     C                     MOVELW#TOAM    ##D,3                           CEU006
058550200528     C                     MOVE A6NBDP    ##D,3                           CEU006
058560200528      *                                                                   CEU006
058570200528      **  Interim Euro Telex Charge                                       CEU006
058580200528      *                                                                   CEU006
058590200528     C                     CLEARP#0010                                    CEU006
058600200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
058610200528     C                     Z-ADD#ENTTX    P#FRAM                          CEU006
058620200528     C                     MOVE BJCYCD    #CCY                            CEU006
058630200528     C                     EXSR EURAMT                                    CEU006
058640200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
058650200528     C                     CLEARP#0010                                    CEU006
058660200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
058670200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
058680200528     C                     MOVE BKEURO    #CCY                            CEU006
058690200528     C                     EXSR EURAMT                                    CEU006
058700200528     C                     MOVELW#TOAM    ##D,4                           CEU006
058710200528     C                     MOVE A6NBDP    ##D,4                           CEU006
058720200528      *                                                                   CEU006
058730200528      **  Interim Euro Cheque Charge                                      CEU006
058740200528      *                                                                   CEU006
058750200528     C                     CLEARP#0010                                    CEU006
058760200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
058770200528     C                     Z-ADD#ENTCQ    P#FRAM                          CEU006
058780200528     C                     MOVE BJCYCD    #CCY                            CEU006
058790200528     C                     EXSR EURAMT                                    CEU006
058800200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
058810200528     C                     CLEARP#0010                                    CEU006
058820200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
058830200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
058840200528     C                     MOVE BKEURO    #CCY                            CEU006
058850200528     C                     EXSR EURAMT                                    CEU006
058860200528     C                     MOVELW#TOAM    ##D,5                           CEU006
058870200528     C                     MOVE A6NBDP    ##D,5                           CEU006
058880200528      *                                                                   CEU006
058890200528      **  Interim Euro Costs Abroad                                       CEU006
058900200528      *                                                                   CEU006
058910200528     C                     CLEARP#0010                                    CEU006
058920200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
058930200528     C                     Z-ADD#ENTCS    P#FRAM                          CEU006
058940200528     C                     MOVE BJCYCD    #CCY                            CEU006
058950200528     C                     EXSR EURAMT                                    CEU006
058960200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
058970200528     C                     CLEARP#0010                                    CEU006
058980200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
058990200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059000200528     C                     MOVE BKEURO    #CCY                            CEU006
059010200528     C                     EXSR EURAMT                                    CEU006
059020200528     C                     MOVELW#TOAM    ##D,6                           CEU006
059030200528     C                     MOVE A6NBDP    ##D,6                           CEU006
059040200528      *                                                                   CEU006
059050200528      **  Interim Euro SWIFT Charge                                       CEU006
059060200528      *                                                                   CEU006
059070200528     C                     CLEARP#0010                                    CEU006
059080200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059090200528     C                     Z-ADD#ENTSW    P#FRAM                          CEU006
059100200528     C                     MOVE BJCYCD    #CCY                            CEU006
059110200528     C                     EXSR EURAMT                                    CEU006
059120200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059130200528     C                     CLEARP#0010                                    CEU006
059140200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059150200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059160200528     C                     MOVE BKEURO    #CCY                            CEU006
059170200528     C                     EXSR EURAMT                                    CEU006
059180200528     C                     MOVELW#TOAM    ##D,7                           CEU006
059190200528     C                     MOVE A6NBDP    ##D,7                           CEU006
059200200528      *                                                                   CEU006
059210200528      **  Interim Euro Collection Charge                                  CEU006
059220200528      *                                                                   CEU006
059230200528     C                     CLEARP#0010                                    CEU006
059240200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059250200528     C                     Z-ADD#ENTCL    P#FRAM                          CEU006
059260200528     C                     MOVE BJCYCD    #CCY                            CEU006
059270200528     C                     EXSR EURAMT                                    CEU006
059280200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059290200528     C                     CLEARP#0010                                    CEU006
059300200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059310200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059320200528     C                     MOVE BKEURO    #CCY                            CEU006
059330200528     C                     EXSR EURAMT                                    CEU006
059340200528     C                     MOVELW#TOAM    ##D,8                           CEU006
059350200528     C                     MOVE A6NBDP    ##D,8                           CEU006
059360200528      *                                                                   CEU006
059370200528      **  Interim Euro Telephone Charge                                   CEU006
059380200528      *                                                                   CEU006
059390200528     C                     CLEARP#0010                                    CEU006
059400200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059410200528     C                     Z-ADD#ENTTP    P#FRAM                          CEU006
059420200528     C                     MOVE BJCYCD    #CCY                            CEU006
059430200528     C                     EXSR EURAMT                                    CEU006
059440200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059450200528     C                     CLEARP#0010                                    CEU006
059460200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059470200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059480200528     C                     MOVE BKEURO    #CCY                            CEU006
059490200528     C                     EXSR EURAMT                                    CEU006
059500200528     C                     MOVELW#TOAM    ##D,9                           CEU006
059510200528     C                     MOVE A6NBDP    ##D,9                           CEU006
059520200528      *                                                                   CEU006
059530200528      **  Interim Euro Advice Charge                                      CEU006
059540200528      *                                                                   CEU006
059550200528     C                     CLEARP#0010                                    CEU006
059560200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059570200528     C                     Z-ADD#ENTAD    P#FRAM                          CEU006
059580200528     C                     MOVE BJCYCD    #CCY                            CEU006
059590200528     C                     EXSR EURAMT                                    CEU006
059600200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059610200528     C                     CLEARP#0010                                    CEU006
059620200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059630200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059640200528     C                     MOVE BKEURO    #CCY                            CEU006
059650200528     C                     EXSR EURAMT                                    CEU006
059660200528     C                     MOVELW#TOAM    ##D,10                          CEU006
059670200528     C                     MOVE A6NBDP    ##D,10                          CEU006
059680200528      *                                                                   CEU006
059690200528      **  Interim Euro Miscellaneous Charge                               CEU006
059700200528      *                                                                   CEU006
059710200528     C                     CLEARP#0010                                    CEU006
059720200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059730200528     C                     Z-ADD#ENTMS    P#FRAM                          CEU006
059740200528     C                     MOVE BJCYCD    #CCY                            CEU006
059750200528     C                     EXSR EURAMT                                    CEU006
059760200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059770200528     C                     CLEARP#0010                                    CEU006
059780200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059790200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059800200528     C                     MOVE BKEURO    #CCY                            CEU006
059810200528     C                     EXSR EURAMT                                    CEU006
059820200528     C                     MOVELW#TOAM    ##D,11                          CEU006
059830200528     C                     MOVE A6NBDP    ##D,11                          CEU006
059840200528      *                                                                   CEU006
059850200528      **  Interim Euro VAT Amount                                         CEU006
059860200528      *                                                                   CEU006
059870200528     C                     CLEARP#0010                                    CEU006
059880200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
059890200528     C                     Z-ADD#ENTVT    P#FRAM                          CEU006
059900200528     C                     MOVE BJCYCD    #CCY                            CEU006
059910200528     C                     EXSR EURAMT                                    CEU006
059920200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
059930200528     C                     CLEARP#0010                                    CEU006
059940200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
059950200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
059960200528     C                     MOVE BKEURO    #CCY                            CEU006
059970200528     C                     EXSR EURAMT                                    CEU006
059980200528     C                     MOVELW#TOAM    ##D,12                          CEU006
059990200528     C                     MOVE A6NBDP    ##D,12                          CEU006
060000200528      *                                                                   CEU006
060010200528      **  Interim Euro Total Charge                                       CEU006
060020200528      *                                                                   CEU006
060030200528     C                     CLEARP#0010                                    CEU006
060040200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060050200528     C                     Z-ADD#ENTTT    P#FRAM                          CEU006
060060200528     C                     MOVE BJCYCD    #CCY                            CEU006
060070200528     C                     EXSR EURAMT                                    CEU006
060080200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
060090200528     C                     CLEARP#0010                                    CEU006
060100200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
060110200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
060120200528     C                     MOVE BKEURO    #CCY                            CEU006
060130200528     C                     EXSR EURAMT                                    CEU006
060140200528     C                     MOVELW#TOAM    ##D,13                          CEU006
060150200528     C                     MOVE A6NBDP    ##D,13                          CEU006
060160200528      *                                                                   CEU006
060170200528      **  Interim Euro Deductions                                         CEU006
060180200528      *                                                                   CEU006
060190200528     C                     CLEARP#0010                                    CEU006
060200200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060210200528     C                     Z-ADD#ENTDD    P#FRAM                          CEU006
060220200528     C                     MOVE BJCYCD    #CCY                            CEU006
060230200528     C                     EXSR EURAMT                                    CEU006
060240200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
060250200528     C                     CLEARP#0010                                    CEU006
060260200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
060270200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
060280200528     C                     MOVE BKEURO    #CCY                            CEU006
060290200528     C                     EXSR EURAMT                                    CEU006
060300200528     C                     MOVELW#TOAM    ##D,14                          CEU006
060310200528     C                     MOVE A6NBDP    ##D,14                          CEU006
060320200528      *                                                                   CEU006
060330200528      **  Interim Euro Net Amount                                         CEU006
060340200528      *                                                                   CEU006
060350200528     C                     CLEARP#0010                                    CEU006
060360200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060370200528     C                     Z-ADD#ENTNT    P#FRAM                          CEU006
060380200528     C                     MOVE BJCYCD    #CCY                            CEU006
060390200528     C                     EXSR EURAMT                                    CEU006
060400200528     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
060410200528     C                     CLEARP#0010                                    CEU006
060420200528     C                     MOVE BJCYCD    P#FRCY                          CEU006
060430200528     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
060440200528     C                     MOVE BKEURO    #CCY                            CEU006
060450200528     C                     EXSR EURAMT                                    CEU006
060460200528     C                     MOVELW#TOAM    ##D,15                          CEU006
060470200528     C                     MOVE A6NBDP    ##D,15                          CEU006
060480200528      *                                                                   CEU006
060490200528      ** Now deal with the other cases, these require #ENTCY -> Euro:     CEU006
060500200528      **  if #ENTCY is In  and #CHGCY is In , and #ENTCY is not #CHGCY;   CEU006
060510200528      **  or #ENTCY is In  and #CHGCY is Out, and #ENTCY is not Base;     CEU006
060520200528      **  or #ENTCY is Out and #CHGCY is In , and #CHGCY is not Base.     CEU006
060530200528      *                                                                   CEU006
060540200528     C           #ENTIN    WHEQ 'Y'                                       CEU006
060550200528     C           #CHGIN    ANDEQ'Y'                                       CEU006
060560200528     C           #ENTCY    ANDNE#CHGCY                                    CEU006
060570200528     C           #ENTIN    OREQ 'Y'                                       CEU006
060580200528     C           #CHGIN    ANDNE'Y'                                       CEU006
060590200528     C           #ENTCY    ANDNEBJCYCD                                    CEU006
060600200528     C           #ENTIN    ORNE 'Y'                                       CEU006
060610200528     C           #CHGIN    ANDEQ'Y'                                       CEU006
060620200528     C           #CHGCY    ANDNEBJCYCD                                    CEU006
060630200528      *                                                                   CEU006
060640200528      **  Set up Euro from GL ICD as currency to convert to.              CEU006
060650200528      *                                                                   CEU006
060660200528     C                     MOVE BKEURO    #CCY                            CEU006
060670200528      *                                                                   CEU006
060680200528      **  Euro Currency                                                   CEU006
060690200528     C                     MOVELBKEURO    ##D,1                           CEU006
060700200528      *                                                                   CEU006
060710200528      **  Interim Euro Transfer Commission                                CEU006
060720200528      *                                                                   CEU006
060730200528     C                     CLEARP#0010                                    CEU006
060740200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060750200528     C                     Z-ADD#ENTTF    P#FRAM                          CEU006
060760200528     C                     EXSR EURAMT                                    CEU006
060770200528     C                     MOVELW#TOAM    ##D,2                           CEU006
060780200528     C                     MOVE A6NBDP    ##D,2                           CEU006
060790200528      *                                                                   CEU006
060800200528      **  Interim Euro FX/Charge Commission                               CEU006
060810200528      *                                                                   CEU006
060820200528     C                     CLEARP#0010                                    CEU006
060830200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060840200528     C                     Z-ADD#ENTFX    P#FRAM                          CEU006
060850200528     C                     EXSR EURAMT                                    CEU006
060860200528     C                     MOVELW#TOAM    ##D,3                           CEU006
060870200528     C                     MOVE A6NBDP    ##D,3                           CEU006
060880200528      *                                                                   CEU006
060890200528      **  Interim Euro Telex Charge                                       CEU006
060900200528      *                                                                   CEU006
060910200528     C                     CLEARP#0010                                    CEU006
060920200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
060930200528     C                     Z-ADD#ENTTX    P#FRAM                          CEU006
060940200528     C                     EXSR EURAMT                                    CEU006
060950200528     C                     MOVELW#TOAM    ##D,4                           CEU006
060960200528     C                     MOVE A6NBDP    ##D,4                           CEU006
060970200528      *                                                                   CEU006
060980200528      **  Interim Euro Cheque Charge                                      CEU006
060990200528      *                                                                   CEU006
061000200528     C                     CLEARP#0010                                    CEU006
061010200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061020200528     C                     Z-ADD#ENTCQ    P#FRAM                          CEU006
061030200528     C                     EXSR EURAMT                                    CEU006
061040200528     C                     MOVELW#TOAM    ##D,5                           CEU006
061050200528     C                     MOVE A6NBDP    ##D,5                           CEU006
061060200528      *                                                                   CEU006
061070200528      **  Interim Euro Costs Abroad                                       CEU006
061080200528      *                                                                   CEU006
061090200528     C                     CLEARP#0010                                    CEU006
061100200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061110200528     C                     Z-ADD#ENTCS    P#FRAM                          CEU006
061120200528     C                     EXSR EURAMT                                    CEU006
061130200528     C                     MOVELW#TOAM    ##D,6                           CEU006
061140200528     C                     MOVE A6NBDP    ##D,6                           CEU006
061150200528      *                                                                   CEU006
061160200528      **  Interim Euro SWIFT Charge                                       CEU006
061170200528      *                                                                   CEU006
061180200528     C                     CLEARP#0010                                    CEU006
061190200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061200200528     C                     Z-ADD#ENTSW    P#FRAM                          CEU006
061210200528     C                     EXSR EURAMT                                    CEU006
061220200528     C                     MOVELW#TOAM    ##D,7                           CEU006
061230200528     C                     MOVE A6NBDP    ##D,7                           CEU006
061240200528      *                                                                   CEU006
061250200528      **  Interim Euro Collection Charge                                  CEU006
061260200528      *                                                                   CEU006
061270200528     C                     CLEARP#0010                                    CEU006
061280200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061290200528     C                     Z-ADD#ENTCL    P#FRAM                          CEU006
061300200528     C                     EXSR EURAMT                                    CEU006
061310200528     C                     MOVELW#TOAM    ##D,8                           CEU006
061320200528     C                     MOVE A6NBDP    ##D,8                           CEU006
061330200528      *                                                                   CEU006
061340200528      **  Interim Euro Telephone Charge                                   CEU006
061350200528      *                                                                   CEU006
061360200528     C                     CLEARP#0010                                    CEU006
061370200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061380200528     C                     Z-ADD#ENTTP    P#FRAM                          CEU006
061390200528     C                     EXSR EURAMT                                    CEU006
061400200528     C                     MOVELW#TOAM    ##D,9                           CEU006
061410200528     C                     MOVE A6NBDP    ##D,9                           CEU006
061420200528      *                                                                   CEU006
061430200528      **  Interim Euro Advice Charge                                      CEU006
061440200528      *                                                                   CEU006
061450200528     C                     CLEARP#0010                                    CEU006
061460200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061470200528     C                     Z-ADD#ENTAD    P#FRAM                          CEU006
061480200528     C                     EXSR EURAMT                                    CEU006
061490200528     C                     MOVELW#TOAM    ##D,10                          CEU006
061500200528     C                     MOVE A6NBDP    ##D,10                          CEU006
061510200528      *                                                                   CEU006
061520200528      **  Interim Euro Miscellaneous Charge                               CEU006
061530200528      *                                                                   CEU006
061540200528     C                     CLEARP#0010                                    CEU006
061550200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061560200528     C                     Z-ADD#ENTMS    P#FRAM                          CEU006
061570200528     C                     EXSR EURAMT                                    CEU006
061580200528     C                     MOVELW#TOAM    ##D,11                          CEU006
061590200528     C                     MOVE A6NBDP    ##D,11                          CEU006
061600200528      *                                                                   CEU006
061610200528      **  Interim Euro VAT Amount                                         CEU006
061620200528      *                                                                   CEU006
061630200528     C                     CLEARP#0010                                    CEU006
061640200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061650200528     C                     Z-ADD#ENTVT    P#FRAM                          CEU006
061660200528     C                     EXSR EURAMT                                    CEU006
061670200528     C                     MOVELW#TOAM    ##D,12                          CEU006
061680200528     C                     MOVE A6NBDP    ##D,12                          CEU006
061690200528      *                                                                   CEU006
061700200528      **  Interim Euro Total Charge                                       CEU006
061710200528      *                                                                   CEU006
061720200528     C                     CLEARP#0010                                    CEU006
061730200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061740200528     C                     Z-ADD#ENTTT    P#FRAM                          CEU006
061750200528     C                     EXSR EURAMT                                    CEU006
061760200528     C                     MOVELW#TOAM    ##D,13                          CEU006
061770200528     C                     MOVE A6NBDP    ##D,13                          CEU006
061780200528      *                                                                   CEU006
061790200528      **  Interim Euro Deductions                                         CEU006
061800200528      *                                                                   CEU006
061810200528     C                     CLEARP#0010                                    CEU006
061820200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061830200528     C                     Z-ADD#ENTDD    P#FRAM                          CEU006
061840200528     C                     EXSR EURAMT                                    CEU006
061850200528     C                     MOVELW#TOAM    ##D,14                          CEU006
061860200528     C                     MOVE A6NBDP    ##D,14                          CEU006
061870200528      *                                                                   CEU006
061880200528      **  Interim Euro Net Amount                                         CEU006
061890200528      *                                                                   CEU006
061900200528     C                     CLEARP#0010                                    CEU006
061910200528     C                     MOVE #ENTCY    P#FRCY                          CEU006
061920200528     C                     Z-ADD#ENTNT    P#FRAM                          CEU006
061930200528     C                     EXSR EURAMT                                    CEU006
061940200528     C                     MOVELW#TOAM    ##D,15                          CEU006
061950200528     C                     MOVE A6NBDP    ##D,15                          CEU006
061960200528      *                                                                   CEU006
061970200528     C                     OTHER                                          CEU006
061980200528     C                     MOVEL*BLANKS   ##D,1                           CEU006
061990200528     C                     MOVEL*BLANKS   ##D,2                           CEU006
062000200528     C                     MOVEL*BLANKS   ##D,3                           CEU006
062010200528     C                     MOVEL*BLANKS   ##D,4                           CEU006
062020200528     C                     MOVEL*BLANKS   ##D,5                           CEU006
062030200528     C                     MOVEL*BLANKS   ##D,6                           CEU006
062040200528     C                     MOVEL*BLANKS   ##D,7                           CEU006
062050200528     C                     MOVEL*BLANKS   ##D,8                           CEU006
062060200528     C                     MOVEL*BLANKS   ##D,9                           CEU006
062070200528     C                     MOVEL*BLANKS   ##D,10                          CEU006
062080200528     C                     MOVEL*BLANKS   ##D,11                          CEU006
062090200528     C                     MOVEL*BLANKS   ##D,12                          CEU006
062100200528     C                     MOVEL*BLANKS   ##D,13                          CEU006
062110200528     C                     MOVEL*BLANKS   ##D,14                          CEU006
062120200528     C                     MOVEL*BLANKS   ##D,15                          CEU006
062130200528     C                     ENDSL                                          CEU006
062140200528      *                                                                   CEU006
062150200528      **  Accumulate RDE's and associated data and output to              CEU006
062160200528      **  PF/CGUDTAPD.                                                    CEU006
062170200528     C                     EXSR SRADTA                                    CEU006
062180200528     C                     EXSR SRODTA                                    CEU006
062190200528      *                                                                   CEU006
062200200528      *................................................................   CEU006
062210200528      *                                                                   CEU006
062220200528     C           EX@EUR    TAG                                            CEU006
062230200528      *                                                                                       CCG015
062240200528     C                     EXSR POPGRS                                                        CCG015
062250200528      *                                                                   CEU006
062260200528      **  Unwind subroutine stack name                                    CEU006
062270200528     C                     MOVEA*BLANKS   @STK,Q                          CEU006
062280200528     C                     SUB  1         Q                               CEU006
062290200528      *                                                                   CEU006
062300200528     C                     ENDSR                                          CEU006
062310200528     C*****************************************************************   CEU006
062320200528     C/SPACE 5                                                            CEU006
062330200528      *****************************************************************   CEU006
062340200528      * Subroutine  :  EURAMT                                         *   CEU006
062350200528      * Function    :  Calculates Currency Amounts for EMU            *   CEU006
062360200528      *                                                               *   CEU006
062370200528      *                Converts P#FRAM in P#FRCY -> P#TOAM in #CCY.   *   CEU006
062380200528      *                                                               *   CEU006
062390200528      * Called by   :  CHGENT, CHGEUR                                 *   CEU006
062400200528      * Calls       :  FT0010 - Midas FT Calculate Currency Amounts   *   CEU006
062410200528      *****************************************************************   CEU006
062420200528     C           EURAMT    BEGSR                                          CEU006
062430200528      *                                                                   CEU006
062440200528     C                     MOVEL#CCY      P#TOCY                          CEU006
062450200528     C                     Z-ADDW#DATE    P#FRDT                          CEU006
062460200528     C                     Z-ADDW#DATE    P#TODT                          CEU006
062470200528      *                                                                   CEU006
062480200528     C                     CALL 'FT0010'                                  CEU006
062490200528     C                     PARM           P#0010                          CEU006
062500200528      *                                                                   CEU006
062510200528      *  Check if database error occurred                                 CEU006
062520200528      *                                                                   CEU006
062530200528     C           P#RTCD    IFNE *BLANKS                                   CEU006
062540200528     C                     MOVEL'FT0010  'W0FILE                          CEU006
062550200528     C                     MOVEL#CCY      W0KEY            ***************CEU006
062560200528     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *CEU006
062570200528     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
062580200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
062590200528     C                     EXSR SRERR                                     CEU006
062600200528     C                     ELSE                                           CEU006
062610200528      *                                                                   CEU006
062620200528     C                     Z-ADDP#TOAM    W#TOAM 170                      CEU006
062630200528     C                     ENDIF                                          CEU006
062640200528      *                                                                   CEU006
062650200528     C                     ENDSR                                          CEU006
062660200528     C*****************************************************************   CEU006
062670200528      /SPACE 5
062680200528      *****************************************************************
062690200528      * Subroutine  :  SRTPSR                                         *
062700200528      * Function    :  Format Settlement Party Subroutine             *
062710200528      *                                                               *
062720200528      * Called by   :                                                 *
062730200528      * Calls       :  -                                              *
062740200528      *****************************************************************
062750200528     C           SRTPSR    BEGSR
062760200528      *
062770200528      **  Set up subroutine stack name
062780200528     C                     ADD  1         Q
062790200528     C                     MOVEL'SRTPSR'  @STK,Q
062800200528      *
062810200528      *................................................................
062820200528      *
062830200528      * Use FT0315 to format text for D address type
062840200528      *
062850200528      *  Set up general parameters
062860200528      *
062870200528     C           *LIKE     DEFN ADCHK1    WPTY1
062880200528     C           *LIKE     DEFN ADCHK1    WPTY2
062890200528      *
062900200528     C                     CLEARW8FT
062910200528     C                     MOVEL*BLANKS   W8STMT
062920200528     C                     MOVELWCCY      W8CCY
062930200528     C                     MOVEL##PGM     W8CPGM
062940200528     C                     MOVEL'*MSG  '  W8ACT
062950200528     C                     Z-ADD5         W8NLIN
062960200528     C                     MOVEL'Y'       W8MADD
062970200528     C                     MOVEL'Y'       W8MTXT
062980200528      *
062990200528      *  Format data to be translated
063000200528      *
063010200528     C                     MOVEL*BLANKS   ADDRSS                          087995
063020200528     C                     MOVELWTYPE     W8TYPE
063030200528     C                     MOVEL*BLANKS   W8LINS
063040200528     C                     MOVELWPTY1     ADCHK1
063050200528     C                     MOVELWPTY2     ADCHK2
063060200528     C                     MOVELWBRCA1    W0BRCA                                           AR1096709
063070200528     C                     MOVEL*BLANKS   WBRCA1                                           AR1096709
063080200528      *
063090200528      *  If partial account and WBRCA is not blank
063100200528      *  substitute into line
063110200528      *
063120200528     C           WTYPE     IFEQ 'P'
063130200528     C           WBRCA     ANDNE*BLANKS
063140200528     C                     MOVELWBRCA     ADPBRC
063150200528     C                     END
063160200528     C                     MOVELADDRSS    W8LINS
063170200528      *
063180200528      * Call expansion program
063190200528      *
063200200528     C                     CALL 'CG4980'               3030
063210200528     C                     PARM           W8RTN   7
063220200528     C                     PARM           W8FT
063230200528     C                     PARM           W8LINS256
063240200528     C                     PARM           W8RPT 256
063250200528     C                     PARM           W8MSG 256
063260200528     C                     PARM           W8SCR 256
063270200528      *
063280200528      *  Check if database error occurred
063290200528      *
063300200528     C           *IN30     IFEQ '1'
063310200528     C           W8RTN     ORNE *BLANKS
063320200528     C                     MOVEL'CG4980  'W0FILE           ***************
063330200528     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 11 *
063340200528     C                     Z-ADD11        W0ERNB           ***************
063350200528     C                     MOVEL'MEM5003' W0MSGD
063360200528     C                     MOVEL'MIDAS  ' W0MSGF
063370200528     C                     EXSR SRERR
063380200528     C                     END
063390200528      *
063400200528     C                     MOVEL'0'       *IN30
063410200528     C                     MOVELW8MSG     ADDRSS
063420200528     C                     MOVELADCHK1    CNA1   35
063430200528     C                     MOVELADCHK2    CNA2   35
063440200528     C                     MOVELADCHK3    CNA3   35
063450200528     C                     MOVELADCHK4    CNA4   35
063460200528     C                     MOVELADCHK5    CNA5   35                       087995
063470200528      *
063480200528      *
063490200528      *................................................................
063500200528      *
063510200528     C           EXTPSR    TAG
063520200528      *
063530200528      **  Unwind subroutine stack name
063540200528     C                     MOVEA*BLANKS   @STK,Q
063550200528     C                     SUB  1         Q
063560200528      *
063570200528     C                     ENDSR
063580200528      *****************************************************************
063590200528      /SPACE 5
063600200528      *****************************************************************
063610200528      * Subroutine  :  SRRRDE                                         *
063620200528      * Function    :  Retrieve RDE information for RDEs in group set *
063630200528      *                                                               *
063640200528      * Called by   :  Simple group set subroutines                   *
063650200528      * Calls       :  -                                              *
063660200528      *****************************************************************
063670200528     C           SRRRDE    BEGSR
063680200528      *
063690200528      **  Set up subroutine stack name
063700200528     C                     ADD  1         Q
063710200528     C                     MOVEL'SRRRDE'  @STK,Q
063720200528      *
063730200528      *................................................................
063740200528      *
063750200528      **  Reset
063760200528     C                     MOVEL*BLANK    ##R
063770200528     C                     MOVEL*BLANK    ##D
063780200528     C                     MOVEL*BLANK    ##S
063790200528      *
063800200528      **  Get information about next 20 RDEs in group set from compile
063810200528      **  time arrays
063820200528     C                     Z-ADD0         #1
063830200528     C           *IN99     DOUEQ'0'
063840200528     C           #1        OREQ 20
063850200528     C                     Z-ADD1         #2
063860200528     C           ##GRPX    LOKUP##GRP,#2                 99*
063870200528     C           *IN99     IFEQ '1'
063880200528     C                     ADD  1         #1
063890200528     C                     MOVEL##RDEA,#2 ##R,#1
063900200528     C                     ADD  1         ##RDEN
063910200528     C                     ENDIF
063920200528     C                     ENDDO
063930200528      *
063940200528      *................................................................
063950200528      *
063960200528     C           EXRRDE    TAG
063970200528      *
063980200528      **  Unwind subroutine stack name
063990200528     C                     MOVEA*BLANKS   @STK,Q
064000200528     C                     SUB  1         Q
064010200528      *
064020200528     C                     ENDSR
064030200528      *****************************************************************
064040200528      /SPACE 5
064050200528      *****************************************************************
064060200528      * Subroutine  :  SRADTA                                         *
064070200528      * Function    :  Accumulate RDEs and associated data for output *
064080200528      *                                                               *
064090200528      * Called by   :  Simple group set subroutines                   *
064100200528      * Calls       :  CG3999 - Format and Pack Data                  *
064110200528      *                SRERR  - Database Error                        *
064120200528      *****************************************************************
064130200528     C           SRADTA    BEGSR
064140200528      *
064150200528      **  Set up subroutine stack name
064160200528     C                     ADD  1         Q
064170200528     C                     MOVEL'SRADTA'  @STK,Q
064180200528      *
064190200528      *................................................................
064200200528      *
064210200528      **  Reformat RDE data
064220200528      *
064230200528     C                     EXSR SRRFMN
064240200528      *                                                                                       CCG015
064250200528     C           CCG015    IFEQ 'Y'                                                           CCG015
064260200528     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
064270200528     C                     MOVELS#PATH    W0SPAT                                              CCG015
064280200528     C                     ELSE                                                               CCG015
064290200528     C                     MOVEL'*PACK   'W0ACT                                               CCG015
064300200528     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
064310200528     C                     ENDIF                                                              CCG015
064320200528      *
064330200528      **  Pack RDEs and associated data into data string
064340200528     C                     CLEAR##SDS
064350200528     C                     CALL 'CG3999'
064360200528     C                     PARM *BLANK    ##RTCD
064370200528     C**********           PARM '*PACK   'W0ACT                                               CCG015
064380200528     C                     PARM           W0ACT                                               CCG015
064390200528     C                     PARM           ##R
064400200528     C                     PARM           ##D
064410200528     C                     PARM           ##S
064420200528     C                     PARM           W0SPAT 70                                           CCG015
064430200528     C                     PARM           ##RN                                                CCG015
064440200528     C                     PARM           ##DN                                                CCG015
064450200528     C                     PARM           ##FM                                                CCG015
064460200528      *
064470200528      **  Database error
064480200528     C           ##RTCD    IFNE *BLANK
064490200528      *
064500200528     C                     MOVEL'CG3999  'W0FILE           ***************
064510200528     C                     MOVEL##RTCD    W0KEY            * DB ERROR 12 *
064520200528     C                     Z-ADD12        W0ERNB           ***************
064530200528     C                     MOVEL'MEM5003' W0MSGD
064540200528     C                     MOVEL'MIDAS  ' W0MSGF
064550200528     C                     EXSR SRERR
064560200528     C                     ENDIF
064570200528     C                     EXSR WRTRDE                                                        CCG015
064580200528      *
064590200528      **  Initialise Write Format Parameter.
064600200528     C                     CLEARW0FMT
064610200528      *
064620200528      **  Set up Control Information.
064630200528     C                     Z-ADD##ITEM    DEITEM
064640200528     C                     ADD  1         ##OSEQ
064650200528     C                     Z-ADD##OSEQ    DEOSEQ
064660200528     C                     Z-ADD1         DEPBIN
064670200528     C                     Z-ADD1         DETBIN
064680200528     C                     MOVE 'FR'      DEFSLI
064690200528     C                     MOVE *BLANKS   W0PATH
064700200528     C                     MOVELS#PATH    W0PATH
064710200528      *
064720200528      **  Append Data from pack routine.
064730200528     C           W0FMT     CAT  ##SDS:0   W0FMT
064740200528      *
064750200528      *................................................................
064760200528      *
064770200528     C           EXADTA    TAG
064780200528      *
064790200528      **  Unwind subroutine stack name
064800200528     C                     MOVEA*BLANKS   @STK,Q
064810200528     C                     SUB  1         Q
064820200528      *
064830200528     C                     ENDSR
064840200528      *****************************************************************
064850200528      /SPACE 5
064860200528      *****************************************************************
064870200528      * Subroutine  :  SRRFMN                                         *
064880200528      * Function    :  Reformat RDE data                              *
064890200528      *                                                               *
064900200528      * Called by   :  SRADTA                                         *
064910200528      * Calls       :                                                 *
064920200528      *****************************************************************
064930200528     C           SRRFMN    BEGSR
064940200528      *
064950200528      **  Set up subroutine stack name
064960200528     C                     ADD  1         Q
064970200528     C                     MOVEL'SRRFMN'  @STK,Q
064980200528      *
064990200528      *................................................................
065000200528      *
065010200528      ** Loop through RDE's and data
065020200528      *
065030200528     C                     Z-ADD0         #1
065040200528     C           #1        DOUEQ20
065050200528     C                     ADD  1         #1
065060200528     C                     MOVEL##R,#1    R#DEFN
065070200528     C                     MOVEL##D,#1    R#DATA
065080200528      *
065090200528      ** If data present and RDE is edited
065100200528      *
065110200528     C           R#DATA    IFNE *BLANK
065120200528     C           ##RDEC    ANDNE*BLANK
065130200528      *
065140200528      * Reformat Amount
065150200528     C                     Z-ADD1         #2
065160200528     C           *BLANK    LOKUP##NUMA,#2                99*
065170200528     C                     Z-ADD20        #3
065180200528     C                     Z-ADD0         ##WNUM
065190200528     C           #2        DOWGT1
065200200528     C           #2        ANDLE20
065210200528     C           #3        ANDGT1
065220200528     C                     SUB  1         #2
065230200528     C                     MOVEL##NUMA,#2 ##W,#3
065240200528     C                     SUB  1         #3
065250200528     C                     ENDDO
065260200528      *
065270200528      * Sign the amount
065280200528     C           ##SIGN    IFEQ '-'
065290200528     C                     Z-SUB##WNUM    ##NUMB
065300200528     C                     ELSE
065310200528     C                     Z-ADD##WNUM    ##NUMB
065320200528     C                     END
065330200528      *
065340200528      * Default Edit Type
065350200528     C           ##EDTT    IFEQ *BLANK
065360200528     C                     MOVEL##RDET    ##EDTT
065370200528     C                     END
065380200528      *
065390200528      * Default Decimal Places
065400200528     C           ##DCPA    IFEQ *BLANK
065410200528     C                     MOVEL##RDED    ##DCPA
065420200528     C                     END
065430200528      * New RDE data
065440200528     C                     MOVELR#DATA    ##D,#1
065450200528     C                     ENDIF
065460200528     C                     ENDDO
065470200528      *
065480200528      *................................................................
065490200528      *
065500200528     C           EXRFMN    TAG
065510200528      *
065520200528      **  Unwind subroutine stack name
065530200528     C                     MOVEA*BLANKS   @STK,Q
065540200528     C                     SUB  1         Q
065550200528      *
065560200528     C                     ENDSR
065570200528      *****************************************************************
065580200528      /SPACE 5
065590200528      *****************************************************************
065600200528      * Subroutine  :  SRODTA                                         *
065610200528      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
065620200528      *                                                               *
065630200528      * Called by   :  Simple group set subroutines                   *
065640200528      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
065650200528      *                SRERR  - Database Error                        *
065660200528      *****************************************************************
065670200528     C           SRODTA    BEGSR
065680200528      *
065690200528      **  Set up subroutine stack name
065700200528     C                     ADD  1         Q
065710200528     C                     MOVEL'SRODTA'  @STK,Q
065720200528      *
065730200528      *................................................................
065740200528      *                                                                                       CCG015
065750200528     C           CCG015    IFEQ 'N'                                                           CCG015
065760200528      *
065770200528      **  Output PF/CGUDTAPD Record.
065780200528     C                     CALL 'CG9020'
065790200528     C                     PARM *BLANK    ##RTCD
065800200528     C                     PARM '*WRITE  'W0ACT
065810200528     C                     PARM           W0PATH256
065820200528     C                     PARM           W0FMT
065830200528     C                     PARM *BLANK    W0TITL  7
065840200528     C                     PARM *BLANK    W0ULIN  7
065850200528     C                     PARM           W0CMT
065860200528      *
065870200528      **  Database error
065880200528     C           ##RTCD    IFNE *BLANK
065890200528      *
065900200528     C                     MOVEL'CG9020  'W0FILE           ***************
065910200528     C                     MOVEL##RTCD    W0KEY            * DB ERROR 13 *
065920200528     C                     Z-ADD13        W0ERNB           ***************
065930200528     C                     MOVEL'MEM5003' W0MSGD
065940200528     C                     MOVEL'MIDAS  ' W0MSGF
065950200528     C                     EXSR SRERR
065960200528     C                     ENDIF
065970200528      *                                                                                       CCG015
065980200528     C                     ENDIF                                                              CCG015
065990200528      *
066000200528      *................................................................
066010200528      *
066020200528     C           EXODTA    TAG
066030200528      *
066040200528      **  Unwind subroutine stack name
066050200528     C                     MOVEA*BLANKS   @STK,Q
066060200528     C                     SUB  1         Q
066070200528      *
066080200528     C                     ENDSR
066090200528     C*****************************************************************
066100200528     C/SPACE 5
066110200528      *****************************************************************
066120200528      * Subroutine  :  SRGENR                                         *
066130200528      * Function    :  Generate reference number                      *
066140200528      *                by writing to PF/CGUDCRPD                      *
066150200528      *                                                               *
066160200528      * Called by   :  SRMAIN - Main Processing                       *
066170200528      * Calls       :  CG9010 - Create reference record               *
066180200528      *****************************************************************
066190200528     C           SRGENR    BEGSR
066200200528      *
066210200528      **  Set up subroutine stack name
066220200528     C                     ADD  1         Q
066230200528     C                     MOVEL'SRGENR'  @STK,Q
066240200528      *
066250200528      *................................................................
066260200528      *
066270200528      **  Generate reference number and check if further processing
066280200528      **  required. Set up all available information in the record
066290200528      **  format before calling.
066300200528      *
066310200528     C                     MOVELBRCA      DRBRCA
066320200528     C                     MOVELORBR      DRORBR
066330200528     C                     MOVEL'FT'      DRMODI
066340200528     C           ##FILE    IFNE 'FT101H  '                                CFT006
066350200528     C           ##FILE    ANDNE'FT102H  '                                CFT008
066360200528     C                     MOVELPREF      DRMTRN
066370200528     C                     ELSE                                           CFT006
066380200528     C                     MOVEL##PREF    DRMTRN                          CFT006
066390200528     C                     ENDIF                                          CFT006
066400200528      *
066410200528      **  Midas Account Identifier
066420200528     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
066430200528     C                     MOVE W0CNUM    ##CNUM                                              CSD027
066440200528     C                     MOVELW#CCY     ##CCY
066450200528     C                     Z-ADDW0ACOD    ##ACOD
066460200528     C                     Z-ADDW0ACSQ    ##ACSQ
066470200528     C                     MOVELBRCA      ##BRC1
066480200528     C                     MOVEL#RETLN    DRMACT
066490200528     C                     MOVEL'N'       DRATRM
066500200528     C                     MOVEL##PTYP    DRPTYP
066510200528     C                     MOVEL##PSTP    DRPSTP
066520200528      *
066530200528     C                     MOVELW0CNUM    ##CUST
066540200528      *                                                                   087994
066550200528      *  Set up cheque number                                             087994
066560200528      *                                                                   087994
066570200528     C                     MOVEL*BLANKS   DRCHQR                          087994
066580200528     C                     SELEC                                          087994
066590200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
066600200528     C                     MOVEL##CQSQ    DRCHQR                          087994
066610200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Col087994
066620200528     C                     MOVEL##CQSQ    DRCHQR                          087994
066630200528     C                     ENDSL                                          087994
066640200528     C/COPY WNCPYSRC,CG4630C099
066650200528      *
066660200528     C                     CALL 'CG9010'
066670200528     C                     PARM           ##RTCD  7
066680200528     C                     PARM '*GEN'    ##MODE 10
066690200528     C                     PARM W0CMT     ##CMT   3
066700200528     C                     PARM           ##CUST  6
066710200528     C                     PARM           ##UDCR
066720200528     C                     PARM           ##ITMA  8
066730200528      *
066740200528      **  Blank return code implies generate correspondence.
066750200528      **  CGD1270 => no error, but suppress output for this transaction.
066760200528      *
066770200528     C           ##RTCD    IFEQ *BLANK
066780200528      *                                                                                       CCG015
066790200528      ** Pass reference as printtype:subtype                                                  CCG015
066800200528     C           DRPTYP    CAT  ':':0     WCOLON 11 P                                         CCG015
066810200528     C           WCOLON    CAT  DRPSTP:0  ##REFR    P                                         CCG015
066820200528     C                     EXSR WRAPRF                                                        CCG015
066830200528      *
066840200528     C                     ELSE
066850200528      *
066860200528     C           ##RTCD    IFNE 'CGD1270'
066870200528     C                     MOVEL'CG9010  'W0FILE
066880200528     C                     MOVEL##RTCD    W0KEY            ***************
066890200528     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
066900200528     C                     MOVEL'CGD1286' W0MSGD           ***************
066910200528     C                     MOVEL'CGUSRMSG'W0MSGF
066920200528     C                     EXSR SRERR
066930200528     C                     ENDIF
066940200528     C                     ENDIF
066950200528      *
066960200528      *................................................................
066970200528      *
066980200528     C           EXGENR    TAG
066990200528      *
067000200528      **  Unwind subroutine stack name
067010200528     C                     MOVEA*BLANKS   @STK,Q
067020200528     C                     SUB  1         Q
067030200528      *
067040200528     C                     ENDSR
067050200528     C*****************************************************************
067060200528     C/SPACE 5
067070200528      *****************************************************************
067080200528      * Subroutine  :  SRINIT                                         *
067090200528      * Function    :  Initial processing - First Call Only           *
067100200528      *                                                               *
067110200528      * Called by   :  Mainline                                       *
067120200528      * Calls       :  None                                           *
067130200528      *****************************************************************
067140200528     C           SRINIT    BEGSR
067150200528      *
067160200528      **  Set up subroutine stack name
067170200528     C                     ADD  1         Q
067180200528     C                     MOVEL'SRINIT'  @STK,Q
067190200528      *
067200200528      *................................................................
067210200528      *
067220200528      ** CALL ACCESS PROGRAM FOR BANK DETAILS
067230200528      *
067240200528     C                     CALL 'AOBANKR0'
067250200528     C                     PARM *BLANKS   ##RTCD  7
067260200528     C                     PARM '*FIRST  '##OPTN  7
067270200528     C           SDBANK    PARM SDBANK    DSFDY
067280200528     C*
067290200528     C           ##RTCD    IFNE *BLANK
067300200528      *
067310200528      ** DATABASE ERROR
067320200528      *
067330200528     C                     MOVEL'AOBANKR0'W0FILE
067340200528     C                     MOVEL'*CALL'   W0KEY            ***************
067350200528     C                     Z-ADD8         W0ERNB           * DB ERROR 08 *
067360200528     C                     MOVEL'MEM5003' W0MSGD           ***************
067370200528     C                     MOVEL'MIDAS  ' W0MSGF
067380200528     C                     EXSR SRERR
067390200528     C                     END
067400200528      *
067410200528      **         IN THE DATAAREA RUNDAT
067420200528      *
067430200528     C           *NAMVAR   DEFN RUNDAT    RUNDT
067440200528     C                     IN   RUNDT
067450200528      *
067460200528     C                     Z-ADD*ZEROS    WCQSQX
067470200528      *                                                                   CEU006
067480200528      ** Access Switchable Features file to check for CEU006              CEU006
067490200528      *                                                                   CEU006
067500200528     C                     CALL 'AOSARDR0'                                CEU006
067510200528     C                     PARM *BLANKS   @RTCD                           CEU006
067520200528     C                     PARM '*VERIFY' @OPTN                           CEU006
067530200528     C                     PARM 'CEU006'  @SARD   6                       CEU006
067540200528     C                     PARM           DSFDY                           CEU006
067550200528     C                     SELEC                                          CEU006
067560200528     C           @RTCD     WHEQ *BLANK                                    CEU006
067570200528     C                     MOVE 'Y'       CEU006  1                       CEU006
067580200528     C           @RTCD     WHEQ '*NRF'                                    CEU006
067590200528     C                     MOVE 'N'       CEU006                          CEU006
067600200528     C                     OTHER                                          CEU006
067610200528      ** DATABASE ERROR                                                   CEU006
067620200528      *                                                                   CEU006
067630200528     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
067640200528     C                     MOVEL@OPTN     W0KEY            ***************CEU006
067650200528     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *CEU006
067660200528     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
067670200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
067680200528     C                     EXSR SRERR                                     CEU006
067690200528     C                     ENDSL                                          CEU006
067700200528      *                                                                   CEU006
067710200528      ** Access GL ICD                                                    CEU006
067720200528      *                                                                   CEU006
067730200528     C**********           CALL 'AOGELRR0'                                             CEU006 CGL029
067740200528     C                     CALL 'AOGELRR1'                                                    CGL029
067750200528     C                     PARM *BLANKS   @RTCD                           CEU006
067760200528     C                     PARM '*FIRST ' @OPTN                           CEU006
067770200528     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU006 CGL029
067780200528     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
067790200528      *                                                                   CEU006
067800200528      ** DATABASE ERROR                                                   CEU006
067810200528      *                                                                   CEU006
067820200528     C           @RTCD     IFNE *BLANKS                                   CEU006
067830200528     C                     MOVEL'SDGELRPD'W0FILE                          CEU006
067840200528     C                     MOVEL@OPTN     W0KEY            ***************CEU006
067850200528     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *CEU006
067860200528     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
067870200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
067880200528     C                     EXSR SRERR                                     CEU006
067890200528     C                     ENDIF                                          CEU006
067900200528      *                                                                   CEU006
067910200528      ** Access FT ICD                                                    CEU006
067920200528      *                                                                   CEU006
067930200528     C                     CALL 'AOFTFRR0'                                CEU006
067940200528     C                     PARM *BLANKS   @RTCD                           CEU006
067950200528     C                     PARM '*FIRST ' @OPTN                           CEU006
067960200528     C           SDFTFR    PARM SDFTFR    DSFDY                           CEU006
067970200528      *                                                                   CEU006
067980200528      ** DATABASE ERROR                                                   CEU006
067990200528      *                                                                   CEU006
068000200528     C           @RTCD     IFNE *BLANKS                                   CEU006
068010200528     C                     MOVEL'SDFTFRPD'W0FILE                          CEU006
068020200528     C                     MOVEL@OPTN     W0KEY            ***************CEU006
068030200528     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *CEU006
068040200528     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
068050200528     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
068060200528     C                     EXSR SRERR                                     CEU006
068070200528     C                     ENDIF                                          CEU006
068080200528      *                                                                   CEU006
068090200528      ** Access Module Details                                            CPB001
068100200528      *                                                                   CPB001
068110200528     C                     CALL 'AOMMODR0'                                CPB001
068120200528     C                     PARM '*MSG  '  @RTCD                           CPB001
068130200528     C                     PARM '*FIRST ' @OPTN                           CPB001
068140200528     C**************       PARM 'CPB001'  @SARD   6                       CPB001              222373
068150200528     C           SDMMOD    PARM SDMMOD    DSFDY                           CPB001
068160200528      *                                                                   CPB001
068170200528      ** DATABASE ERROR                                                   CPB001
068180200528      *                                                                   CPB001
068190200528     C           @RTCD     IFNE *BLANKS                                   CPB001
068200200528     C                     MOVEL'SDMMODPD'W0FILE                          CPB001
068210200528     C                     MOVEL*BLANKS   W0KEY            ***************CPB001
068220200528     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CPB001
068230200528     C                     MOVEL'MEM5003' W0MSGD           ***************CPB001
068240200528     C                     MOVEL'MIDAS  ' W0MSGF                          CPB001
068250200528     C                     EXSR SRERR                                     CPB001
068260200528     C                     ENDIF                                          CPB001
068270200528      *                                                                   CFT014
068280200528      ** Access Switchable Features file to check for CFT014              CFT014
068290200528      *                                                                   CFT014
068300200528     C                     MOVE 'N'       CFT014  1                       CFT014
068310200528     C                     CALL 'AOSARDR0'                                CFT014
068320200528     C                     PARM *BLANKS   PRTCD                           CFT014
068330200528     C                     PARM '*VERIFY' POPTN                           CFT014
068340200528     C                     PARM 'CFT014'  PSARD   6                       CFT014
068350200528     C                     PARM           DSFDY                           CFT014
068360200528     C           PRTCD     IFNE *BLANKS                                   CFT014
068370200528     C           PRTCD     ANDNE'*NRF    '                                CFT014
068380200528     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
068390200528     C                     MOVEL'CFT014'  W0KEY                           CFT014
068400200528     C                     Z-ADD32        W0ERNB                          CFT014
068410200528     C                     MOVEL'MEM5003' W0MSGD                          CFT014
068420200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
068430200528     C                     EXSR SRERR                                     CFT014
068440200528     C                     ENDIF                                          CFT014
068450200528      *                                                                   CFT014
068460200528     C           PRTCD     IFEQ *BLANKS                                   CFT014
068470200528     C                     MOVE 'Y'       CFT014                          CFT014
068480200528     C                     ENDIF                                          CFT014
068490200528      *                                                                   CPB001
068500200528     C/COPY WNCPYSRC,CG4630C004
068510200528      *                                                                   CFT009
068520200528      ** Access Switchable Features file to check for CFT009              CFT009
068530200528      *                                                                   CFT009
068540200528     C                     CALL 'AOSARDR0'                                CFT009
068550200528     C                     PARM *BLANKS   @RTCD                           CFT009
068560200528     C                     PARM '*VERIFY' @OPTN                           CFT009
068570200528     C                     PARM 'CFT009'  @SARD   6                       CFT009
068580200528     C                     PARM           DSFDY                           CFT009
068590200528     C                     SELEC                                          CFT009
068600200528     C           @RTCD     WHEQ *BLANK                                    CFT009
068610200528     C                     MOVE 'Y'       CFT009  1                       CFT009
068620200528     C           @RTCD     WHEQ '*NRF'                                    CFT009
068630200528     C                     MOVE 'N'       CFT009                          CFT009
068640200528     C                     OTHER                                          CFT009
068650200528      ** DATABASE ERROR                                                   CFT009
068660200528      *                                                                   CFT009
068670200528     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
068680200528     C                     MOVEL@OPTN     W0KEY            ***************CFT009
068690200528     C                     Z-ADD42        W0ERNB           * DB ERROR 42 *CFT009
068700200528     C                     MOVEL'MEM5003' W0MSGD           ***************CFT009
068710200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
068720200528     C                     EXSR SRERR                                     CFT009
068730200528     C                     ENDSL                                          CFT009
068740200528      *                                                                   CFT009
068750200528      ** Access Switchable Features file to check for CFT010              CFT009
068760200528      *                                                                   CFT009
068770200528     C                     CALL 'AOSARDR0'                                CFT009
068780200528     C                     PARM *BLANKS   @RTCD                           CFT009
068790200528     C                     PARM '*VERIFY' @OPTN                           CFT009
068800200528     C                     PARM 'CFT010'  @SARD   6                       CFT009
068810200528     C                     PARM           DSFDY                           CFT009
068820200528     C                     SELEC                                          CFT009
068830200528     C           @RTCD     WHEQ *BLANK                                    CFT009
068840200528     C                     MOVE 'Y'       CFT10   1                       CFT009
068850200528     C           @RTCD     WHEQ '*NRF'                                    CFT009
068860200528     C                     MOVE 'N'       CFT10                           CFT009
068870200528     C                     OTHER                                          CFT009
068880200528      ** DATABASE ERROR                                                   CFT009
068890200528      *                                                                   CFT009
068900200528     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
068910200528     C                     MOVEL@OPTN     W0KEY            ***************CFT009
068920200528     C                     Z-ADD43        W0ERNB           * DB ERROR 43 *CFT009
068930200528     C                     MOVEL'MEM5003' W0MSGD           ***************CFT009
068940200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
068950200528     C                     EXSR SRERR                                     CFT009
068960200528     C                     ENDSL                                          CFT009
068970200528     C                     CALL 'SWIF2001'                                                    CSW201
068980200528     C                     PARM *BLANKS   @RTCD   7                                           CSW201
068990200528     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
069000200528     C                     MOVE 'Y'       CSW201  1                                           CSW201
069010200528     C                     ELSE                                                               CSW201
069020200528     C                     MOVE 'N'       CSW201                                              CSW201
069030200528     C                     ENDIF                                                              CSW201
069040200528      *                                                                                       CCG015
069050200528      ** Determine if Correspondence Manager Phase 1 Development                              CCG015
069060200528      ** on iSeries is installed                                                              CCG015
069070200528      *                                                                                       CCG015
069080200528     C                     MOVE 'N'       CCG015  1                                           CCG015
069090200528     C                     CALL 'AOSARDR0'                                                    CCG015
069100200528     C                     PARM *BLANKS   PRTCD                                               CCG015
069110200528     C                     PARM '*VERIFY' POPTN                                               CCG015
069120200528     C                     PARM 'CCG015'  PSARD                                               CCG015
069130200528     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
069140200528     C           PRTCD     IFNE *BLANKS                                                       CCG015
069150200528     C           PRTCD     ANDNE'*NRF    '                                                    CCG015
069160200528     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
069170200528     C                     MOVEL'*CALL '  W0KEY                                               CCG015
069180200528     C                     Z-ADD63        W0ERNB                                              CCG015
069190200528     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
069200200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
069210200528     C                     EXSR SRERR                                                         CCG015
069220200528     C                     ENDIF                                                              CCG015
069230200528      *                                                                                       CCG015
069240200528     C           PRTCD     IFEQ *BLANKS                                                       CCG015
069250200528     C                     MOVE 'Y'       CCG015                                              CCG015
069260200528     C                     ENDIF                                                              CCG015
069270200528      *                                                                                     BUG12648
069280200528     C                     CALL 'SWIF2007'                                                    CSW207
069290200528     C                     PARM *BLANKS   PRTCD                                               CSW207
069300200528      *                                                                                       CSW207
069310200528     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
069320200528     C                     MOVEL'Y'       CSW207  1                                           CSW207
069330200528     C                     ELSE                                                               CSW207
069340200528     C                     MOVEL'N'       CSW207                                              CSW207
069350200528     C                     ENDIF                                                              CSW207
069360200528      *                                                                                       CSW207
069370200528      ** CFT009 for RFT, CCT and Cheques must be disabled                                   BUG12648
069380200528      *                                                                                     BUG12648
069390200528     C                     MOVE 'N'       WALLOW  1                                         BUG12648
069400200528      *
069410200528     C                     CALL 'AOSARDR0'                                                    CER031
069420200528     C                     PARM *BLANKS   @RTCD                                               CER031
069430200528     C                     PARM '*VERIFY' @OPTN                                               CER031
069440200528     C                     PARM 'CER031'  @SARD                                               CER031
069450200528     C                     PARM           DSFDY                                               CER031
069460200528      *                                                                                       CER031
069470200528     C********** PRTCD     IFNE *BLANKS                                              CER031 BUG22563
069480200528     C********** PRTCD     ANDNE'*NRF    '                                           CER031 BUG22563
069490200528     C           @RTCD     IFNE *BLANKS                                                     BUG22563
069500200528     C           @RTCD     ANDNE'*NRF    '                                                  BUG22563
069510200528     C                     MOVEL'SCSARDPD'W0FILE                                              CER031
069520200528     C                     MOVEL'CER031'  W0KEY                                               CER031
069530200528     C                     Z-ADD33        W0ERNB                                              CER031
069540200528     C                     MOVEL'MEM5003' W0MSGD                                              CER031
069550200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CER031
069560200528     C                     EXSR SRERR                                                         CER031
069570200528     C                     ENDIF                                                              CER031
069580200528      *                                                                                       CER031
069590200528     C********** PRTCD     IFEQ *BLANKS                                              CER031 BUG22749
069600200528     C           @RTCD     IFEQ *BLANKS                                                     BUG22749
069610200528     C                     MOVE 'Y'       CER031  1                                           CER031
069620200528     C                     ELSE                                                               CER031
069630200528      *                                                                                       CER031
069640200528     C                     MOVE 'N'       CER031                                              CER031
069650200528     C                     ENDIF                                                              CER031
069660200528      *                                                                                     BUG23445
069670200528      ** Access Switchable Features file and check if CCG015 is                             BUG23445
069680200528      ** installed                                                                          BUG23445
069690200528      *                                                                                     BUG23445
069700200528     C                     CALL 'AOSARDR0'                                                  BUG23445
069710200528     C                     PARM *BLANKS   PRTCD                                             BUG23445
069720200528     C                     PARM '*VERIFY' POPTN                                             BUG23445
069730200528     C                     PARM 'CGL013'  PSARD                                             BUG23445
069740200528      *                                                                                     BUG23445
069750200528     C           PRTCD     IFEQ *BLANK                                                      BUG23445
069760200528     C                     MOVE 'Y'       CGL013  1                                         BUG23445
069770200528     C                     ELSE                                                             BUG23445
069780200528     C                     MOVE 'N'       CGL013                                            BUG23445
069790200528     C           PRTCD     IFNE '*NRF   '                                                   BUG23445
069800200528     C                     MOVEL'SCSARDPD'W0FILE                                            BUG23445
069810200528     C                     MOVEL'*CALL'   W0KEY                                             BUG23445
069820200528     C                     Z-ADD66        W0ERNB                                            BUG23445
069830200528     C                     MOVEL'MEM5003' W0MSGD                                            BUG23445
069840200528     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23445
069850200528     C                     EXSR SRERR                                                       BUG23445
069860200528     C                     ENDIF                                                            BUG23445
069870200528     C                     ENDIF                                                            BUG23445
069880200528      *                                                                                     BUG23445
069890200528      *                                                                                       CFT134
069900200528      ** Access Switchable Features file to check for CFT004                                  CFT134
069910200528      *                                                                                       CFT134
069920200528     C                     MOVE 'N'       CFT004  1                                           CFT134
069930200528     C                     CALL 'AOSARDR0'                                                    CFT134
069940200528     C                     PARM *BLANKS   PRTCD                                               CFT134
069950200528     C                     PARM '*VERIFY' POPTN                                               CFT134
069960200528     C                     PARM 'CFT004'  PSARD                                               CFT134
069970200528     C           SCSARD    PARM SCSARD    DSFDY                                               CFT134
069980200528      *                                                                                       CFT134
069990200528     C           PRTCD     IFNE *BLANKS                                                       CFT134
070000200528     C           PRTCD     ANDNE'*NRF    '                                                    CFT134
070010200528     C                     MOVEL'SCSARDPD'W0FILE                                              CFT134
070020200528     C                     MOVEL'*CALL '  W0KEY                                               CFT134
070030200528     C                     Z-ADD900       W0ERNB                                              CFT134
070040200528     C                     MOVEL'MEM5003' W0MSGD                                              CFT134
070050200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT134
070060200528     C                     EXSR SRERR                                                         CFT134
070070200528     C                     ENDIF                                                              CFT134
070080200528      *                                                                                       CFT134
070090200528     C           PRTCD     IFEQ *BLANKS                                                       CFT134
070100200528     C                     MOVE 'Y'       CFT004                                              CFT134
070110200528     C                     ENDIF                                                              CFT134
070120200528      *                                                                                       CFT134
070130200528      ** Access Switchable Features file to check for CFT134                                  CFT134
070140200528      *                                                                                       CFT134
070150200528     C                     MOVE 'N'       CFT134  1                                           CFT134
070160200528     C                     CALL 'AOSARDR0'                                                    CFT134
070170200528     C                     PARM *BLANKS   PRTCD                                               CFT134
070180200528     C                     PARM '*VERIFY' POPTN                                               CFT134
070190200528     C                     PARM 'CFT134'  PSARD                                               CFT134
070200200528     C           SCSARD    PARM SCSARD    DSFDY                                               CFT134
070210200528      *                                                                                       CFT134
070220200528     C           PRTCD     IFNE *BLANKS                                                       CFT134
070230200528     C           PRTCD     ANDNE'*NRF    '                                                    CFT134
070240200528     C                     MOVEL'SCSARDPD'W0FILE                                              CFT134
070250200528     C                     MOVEL'*CALL '  W0KEY                                               CFT134
070260200528     C                     Z-ADD901       W0ERNB                                              CFT134
070270200528     C                     MOVEL'MEM5003' W0MSGD                                              CFT134
070280200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT134
070290200528     C                     EXSR SRERR                                                         CFT134
070300200528     C                     ENDIF                                                              CFT134
070310200528      *                                                                                       CFT134
070320200528     C           PRTCD     IFEQ *BLANKS                                                       CFT134
070330200528     C                     MOVE 'Y'       CFT134                                              CFT134
070340200528     C                     ENDIF                                                              CFT134
070350200528      *                                                                                       CFT134
070360200528      ***Keylist*for*file**GLNW94L1                                               BUG23445 BUG23445A
070370200528      ** Keylist for file  GLNWACL1                                                        BUG23445A
070380200528      *                                                                                     BUG23445
070390200528     C           KACCT     KLIST                                                            BUG23445
070400200528     C                     KFLD           KNWRK                                             BUG23445
070410200528     C                     KFLD           PBRCA                                             BUG23445
070420200528     C                     KFLD           PCUSNO                                            BUG23445
070430200528     C                     KFLD           PCCY                                              BUG23445
070440200528     C                     KFLD           KACCDX                                            BUG23445
070450200528     C                     KFLD           KACSQX                                            BUG23445
070460200528      *                                                                                       CER049
070470200528      ** Determine if Stamp Tax feature is switched on.                                       CER049
070480200528      *                                                                                       CER049
070490200528     C                     MOVE 'N'       CER049  1                                           CER049
070500200528     C                     CALL 'AOSARDR0'                                                    CER049
070510200528     C                     PARM *BLANKS   PRTCD                                               CER049
070520200528     C                     PARM '*VERIFY' POPTN                                               CER049
070530200528     C                     PARM 'CER049'  PSARD                                               CER049
070540200528     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
070550200528     C           PRTCD     IFNE *BLANKS                                                       CER049
070560200528     C           PRTCD     ANDNE'*NRF    '                                                    CER049
070570200528     C                     MOVEL'SCSARDPD'W0FILE                                              CER049
070580200528     C                     MOVEL'*CALL '  W0KEY                                               CER049
070590200528     C                     Z-ADD67        W0ERNB                                              CER049
070600200528     C                     MOVEL'MEM5003' W0MSGD                                              CER049
070610200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
070620200528     C                     EXSR SRERR                                                         CER049
070630200528     C                     ENDIF                                                              CER049
070640200528      *                                                                                       CER049
070650200528     C           PRTCD     IFEQ *BLANKS                                                       CER049
070660200528     C                     MOVE 'Y'       CER049                                              CER049
070670200528     C                     ENDIF                                                              CER049
070680200528      *                                                                                       CFT120
070690200528      ** Determine if CFT120 is on.                                                           CFT120
070700200528      *                                                                                       CFT120
070710200528     C                     MOVE 'N'       CFT120  1                                           CFT120
070720200528     C                     CALL 'AOSARDR0'                                                    CFT120
070730200528     C                     PARM *BLANKS   PRTCD                                               CFT120
070740200528     C                     PARM '*VERIFY' POPTN                                               CFT120
070750200528     C                     PARM 'CFT120'  PSARD                                               CFT120
070760200528     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
070770200528     C           PRTCD     IFNE *BLANKS                                                       CFT120
070780200528     C           PRTCD     ANDNE'*NRF    '                                                    CFT120
070790200528     C                     MOVEL'SCSARDPD'W0FILE                                              CFT120
070800200528     C                     MOVEL'*CALL '  W0KEY                                               CFT120
070810200528     C                     Z-ADD68        W0ERNB                                              CFT120
070820200528     C                     MOVEL'MEM5003' W0MSGD                                              CFT120
070830200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT120
070840200528     C                     EXSR SRERR                                                         CFT120
070850200528     C                     ENDIF                                                              CFT120
070860200528      *                                                                                       CFT120
070870200528     C           PRTCD     IFEQ *BLANKS                                                       CFT120
070880200528     C                     MOVE 'Y'       CFT120                                              CFT120
070890200528     C                     ENDIF                                                              CFT120
070900200528      *                                                                                       CFT121
070910200528      ** Check if CFT121 is switched on.                                                      CFT121
070920200528      *                                                                                       CFT121
070930200528     C                     MOVE 'N'       CFT121  1                                           CFT121
070940200528     C                     CALL 'AOSARDR0'                                                    CFT121
070950200528     C                     PARM *BLANKS   PRTCD                                               CFT121
070960200528     C                     PARM '*VERIFY' POPTN                                               CFT121
070970200528     C                     PARM 'CFT121'  PSARD                                               CFT121
070980200528     C           SCSARD    PARM SCSARD    DSFDY                                               CFT121
070990200528     C           PRTCD     IFNE *BLANKS                                                       CFT121
071000200528     C           PRTCD     ANDNE'*NRF    '                                                    CFT121
071010200528     C                     MOVEL'SCSARDPD'W0FILE                                              CFT121
071020200528     C                     MOVEL'*CALL '  W0KEY                                               CFT121
071030200528     C                     Z-ADD69        W0ERNB                                              CFT121
071040200528     C                     MOVEL'MEM5003' W0MSGD                                              CFT121
071050200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT121
071060200528     C                     EXSR SRERR                                                         CFT121
071070200528     C                     ENDIF                                                              CFT121
071080200528      *                                                                                       CFT121
071090200528     C           PRTCD     IFEQ *BLANKS                                                       CFT121
071100200528     C                     MOVE 'Y'       CFT121                                              CFT121
071110200528     C                     ENDIF                                                              CFT121
071120200528      *................................................................
071130200528      *
071140200528     C           EXINIT    TAG
071150200528      *
071160200528      **  Unwind subroutine stack name
071170200528     C                     MOVEA*BLANKS   @STK,Q
071180200528     C                     SUB  1         Q
071190200528     C*
071200200528     C                     ENDSR
071210200528     C*****************************************************************
071220200528     C/SPACE 5
071230200528      *****************************************************************
071240200528      * Subroutine  :  SRINZ                                          *
071250200528      * Function    :  Initialise Fields on Program Invocation        *
071260200528      *                                                               *
071270200528      * Called by   :  Mainline                                       *
071280200528      * Calls       :                                                 *
071290200528      *****************************************************************
071300200528     C           SRINZ     BEGSR
071310200528      *
071320200528      **  Set up subroutine stack name
071330200528     C                     ADD  1         Q
071340200528     C                     MOVEL'SRINZ '  @STK,Q
071350200528      *
071360200528      *................................................................
071370200528      *
071380200528      **  Initialise work fields
071390200528     C                     Z-ADD*ZEROS    ##W050  50
071400200528     C                     Z-ADD*ZEROS    ##W150 150
071410200528     C                     Z-ADD*ZEROS    #1      60
071420200528     C                     Z-ADD*ZEROS    #2      60
071430200528     C                     Z-ADD*ZEROS    #3      60
071440200528     C                     MOVE *BLANKS   S#PATH256
071450200528     C*
071460200528     C                     MOVE *BLANKS   ZTABKY 12
071470200528     C                     MOVEL'20'      ZTABKY
071480200528     C                     MOVELPCCY      KEY4    4
071490200528     C                     MOVE '1'       KEY4
071500200528     C                     MOVE KEY4      ZTABKY
071510200528      *
071520200528      **  Initialise output sequence (to CGUDTAPD)
071530200528     C                     Z-ADD*ZEROS    ##OSEQ
071540200528     C**********           Z-ADD*ZEROS    W0CNUM                                              CSD027
071550200528     C                     MOVE *BLANKS   W0CNUM                                              CSD027
071560200528      *
071570200528      **  Attempt to obtain customer number.
071580200528     C                     SELEC
071590200528     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
071600200528     C           ACBK      IFNE *BLANKS
071610200528     C                     MOVE ACBT      WTYPE
071620200528     C                     MOVELACBK      WPTY
071630200528     C                     MOVE PCCY      WCCY
071640200528     C                     MOVELACBK      WPTY1
071650200528     C                     MOVELACBB      WBRCA
071660200528     C                     EXSR SRTPSR
071670200528     C                     ENDIF
071680200528     C********** W0CNUM    IFEQ *ZEROS                                                        CSD027
071690200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
071700200528     C           BNCT      IFNE 'A'
071710200528     C                     MOVE BNCT      WTYPE
071720200528     C                     MOVELBNC1      WPTY
071730200528     C                     MOVE PCCY      WCCY
071740200528     C                     MOVELBNC1      WPTY1
071750200528     C                     MOVELBNC2      WPTY2
071760200528     C                     MOVEL*BLANKS   WBRCA
071770200528     C                     EXSR SRTPSR
071780200528     C                     ENDIF
071790200528     C                     ENDIF
071800200528     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
071810200528     C********** ORBK      IFNE *ZEROS                                                      BUG11679
071820200528     C           ORBK      IFNE *BLANKS                                                     BUG11679
071830200528     C                     MOVE ORBT      WTYPE
071840200528     C                     MOVELORBK      WPTY
071850200528     C                     MOVE SMCY      WCCY
071860200528     C                     MOVELORBK      WPTY1
071870200528     C                     MOVELORBB      WBRCA
071880200528     C                     EXSR SRTPSR
071890200528     C                     ENDIF
071900200528     C********** W0CNUM    IFEQ *ZEROS                                                        CSD027
071910200528     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
071920200528     C           ORCT      IFNE 'A'
071930200528     C                     MOVE ORCT      WTYPE
071940200528     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
071950200528     C           WSLSH     IFEQ '/'                                                           CFT032
071960200528     C           18        SUBSTORC1:2    WPTY                                                CFT032
071970200528     C                     ELSE                                                               CFT032
071980200528     C                     MOVELORC1      WPTY
071990200528     C                     ENDIF                                                              CFT032
072000200528     C                     MOVE SMCY      WCCY
072010200528     C           ORCT      IFEQ 'R'                                                           CFT032
072020200528     C           ORCT      OREQ 'P'                                                           CFT032
072030200528     C           ORCT      OREQ 'I'                                                         BUG15105
072040200528     C           WSLSH     IFEQ '/'                                                         BUG15105
072050200528     C           34        SUBSTORC1:2    WPTY1     P                                         CFT032
072060200528     C                     ELSE                                                               CFT032
072070200528     C                     MOVELORC1      WPTY1
072080200528     C                     ENDIF                                                            BUG15105
072090200528     C                     ELSE                                                             BUG15105
072100200528     C           WSLSH     IFEQ '/'                                                         BUG15105
072110200528     C           34        SUBSTORC1:2    WPTY1     P                                       BUG15105
072120200528     C                     ELSE                                                             BUG15105
072130200528     C                     MOVELORC1      WPTY1                                             BUG15105
072140200528     C                     ENDIF                                                            BUG15105
072150200528     C                     ENDIF                                                              CFT032
072160200528     C                     MOVELORC2      WPTY2
072170200528     C                     MOVEL*BLANKS   WBRCA
072180200528     C                     EXSR SRTPSR
072190200528     C                     ENDIF
072200200528     C                     ENDIF
072210200528     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Collectn
072220200528     C***********ORBK      IFNE *ZEROS                                    087994
072230200528     C***********          MOVE ORBT      WTYPE                           087994
072240200528     C***********          MOVELORBK      WPTY                            087994
072250200528     C***********          MOVE SMCY      WCCY                            087994
072260200528     C***********          MOVELORBK      WPTY1                           087994
072270200528     C***********          MOVELORBB      WBRCA                           087994
072280200528     C                     MOVE CRPT      WTYPE                           087994
072290200528     C                     MOVELCRPY      WPTY                            087994
072300200528     C                     MOVE CRCY      WCCY                            087994
072310200528     C                     MOVELCRPY      WPTY1                           087994
072320200528     C                     MOVELCRBR      WBRCA                           087994
072330200528     C                     EXSR SRTPSR
072340200528     C***********          ENDIF                                          087994
072350200528     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
072360200528      ***********                                                         087994
072370200528     C***********ORCT      IFNE 'A'                                       087994
072380200528     C***********          MOVE ORCT      WTYPE                           087994
072390200528     C***********          MOVELORC1      WPTY                            087994
072400200528     C***********          MOVE SMCY      WCCY                            087994
072410200528     C***********          MOVELORC1      WPTY1                           087994
072420200528     C***********          MOVELORC2      WPTY2                           087994
072430200528     C***********          MOVEL*BLANKS   WBRCA                           087994
072440200528     C                     MOVE DRPT      WTYPE                           087994
072450200528     C                     MOVELDRPY      WPTY                            087994
072460200528     C                     MOVE DRCY      WCCY                            087994
072470200528     C                     MOVELDRPY      WPTY1                           087994
072480200528     C                     MOVELDRBR      WBRCA                           087994
072490200528     C                     EXSR SRTPSR
072500200528     C***********          ENDIF                                          087994
072510200528     C           ##FILE    WHEQ 'FT101H  '                                CFT006
072520200528     C           TOCUS1    IFNE *BLANKS                                   CFT006
072530200528      *                                                                   CFT006
072540200528     C           DCUSTP    IFEQ 'G'                                       CFT006
072550200528     C                     MOVELTOCUS1    NGLACT                          CFT006
072560200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
072570200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
072580200528     C                     MOVE NGLACD    OGLACD                          CFT006
072590200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
072600200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
072610200528     C                     MOVELOGLACT    TOCUS1                          CFT006
072620200528     C                     MOVELTOCUS2    NGLACT                          CFT006
072630200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
072640200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
072650200528     C                     MOVE NGLACD    OGLACD                          CFT006
072660200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
072670200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
072680200528     C                     MOVELOGLACT    TOCUS2                          CFT006
072690200528     C                     ENDIF                                          CFT006
072700200528      *                                                                   CFT006
072710200528     C                     MOVE DCUSTP    WTYPE                           CFT006
072720200528     C                     MOVELTOCUS1    WPTY                            CFT006
072730200528     C                     MOVELTOCUS1    WPTY1                           CFT006
072740200528     C                     MOVELTOCUS2    WPTY2                           CFT006
072750200528     C                     ELSE                                           CFT006
072760200528      *                                                                   CFT006
072770200528     C           CUSTTP    IFEQ 'G'                                       CFT006
072780200528     C                     MOVELHOCUS1    NGLACT                          CFT006
072790200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
072800200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
072810200528     C                     MOVE NGLACD    OGLACD                          CFT006
072820200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
072830200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
072840200528     C                     MOVELOGLACT    HOCUS1                          CFT006
072850200528     C                     MOVELHOCUS2    NGLACT                          CFT006
072860200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
072870200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
072880200528     C                     MOVE NGLACD    OGLACD                          CFT006
072890200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
072900200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
072910200528     C                     MOVELOGLACT    HOCUS2                          CFT006
072920200528     C                     ENDIF                                          CFT006
072930200528      *                                                                   CFT006
072940200528     C                     MOVE CUSTTP    WTYPE                           CFT006
072950200528     C                     MOVELHOCUS1    WPTY                            CFT006
072960200528     C                     MOVELHOCUS1    WPTY1                           CFT006
072970200528     C                     MOVELHOCUS2    WPTY2                           CFT006
072980200528     C                     ENDIF                                          CFT006
072990200528     C                     MOVE TRNCCY    WCCY                            CFT006
073000200528     C                     MOVELBRCA      WBRCA                           CFT006
073010200528     C                     EXSR SRTPSR                                    CFT006
073020200528     C           ##FILE    WHEQ 'FT102H  '                                CFT008
073030200528     C                     SELEC                                          CFT008
073040200528     C           SINSTT    WHNE *BLANKS                                   CFT008
073050200528     C           '/'       SCAN SINSTX                   20               CFT008
073060200528      *                                                                   CFT008
073070200528     C           *IN20     IFEQ *ON                                       CFT008
073080200528     C                     SUBSTSINSTX:2  SINSTX                          CFT008
073090200528     C                     ENDIF                                          CFT008
073100200528      *                                                                   CFT006
073110200528     C           SINSTT    IFEQ 'G'                                       CFT006
073120200528     C                     MOVELSINSTX    NGLACT                          CFT006
073130200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
073140200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
073150200528     C                     MOVE NGLACD    OGLACD                          CFT006
073160200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
073170200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
073180200528     C                     MOVELOGLACT    SINSTX                          CFT006
073190200528     C                     ENDIF                                          CFT006
073200200528      *                                                                   CFT008
073210200528     C                     MOVE SINSTT    WTYPE                           CFT008
073220200528     C                     MOVELSINSTX    WPTY                            CFT008
073230200528     C                     MOVELSINSTX    WPTY1                           CFT008
073240200528     C                     MOVEL*BLANKS   WPTY2                           CFT008
073250200528     C           SNDTYP    WHNE *BLANKS                                   CFT008
073260200528      *                                                                   CFT006
073270200528     C           SNDTYP    IFEQ 'G'                                       CFT006
073280200528     C                     MOVELSNDCOR    NGLACT                          CFT006
073290200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
073300200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
073310200528     C                     MOVE NGLACD    OGLACD                          CFT006
073320200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
073330200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
073340200528     C                     MOVELOGLACT    SNDCOR                          CFT006
073350200528     C                     ENDIF                                          CFT006
073360200528      *                                                                   CFT008
073370200528     C                     MOVE SNDTYP    WTYPE                           CFT008
073380200528     C                     MOVELSNDCOR    WPTY                            CFT008
073390200528     C                     MOVELSNDCOR    WPTY1                           CFT008
073400200528     C                     MOVEL*BLANKS   WPTY2                           CFT008
073410200528     C           RCVTYP    WHNE *BLANKS                                   CFT008
073420200528     C           '/'       SCAN RCVCOR                   20               CFT008
073430200528      *                                                                   CFT008
073440200528     C           *IN20     IFEQ *ON                                       CFT008
073450200528     C                     SUBSTRCVCOR:2  RCVCOR                          CFT008
073460200528     C                     ENDIF                                          CFT008
073470200528      *                                                                   CFT008
073480200528     C           RCVTYP    IFEQ 'G'                                       CFT006
073490200528     C                     MOVELRCVCOR    NGLACT                          CFT006
073500200528     C                     MOVE NGLBRH    OGLBRH                          CFT006
073510200528     C                     MOVE NGLCNM    OGLCNM                          CFT006
073520200528     C                     MOVE NGLACD    OGLACD                          CFT006
073530200528     C                     MOVE NGLCCY    OGLCCY                          CFT006
073540200528     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
073550200528     C                     MOVELOGLACT    RCVCOR                          CFT006
073560200528     C                     ENDIF                                          CFT006
073570200528      *                                                                   CFT008
073580200528     C                     MOVE RCVTYP    WTYPE                           CFT008
073590200528     C                     MOVELRCVCOR    WPTY                            CFT008
073600200528     C                     MOVELRCVCOR    WPTY1                           CFT008
073610200528     C                     MOVEL*BLANKS   WPTY2                           CFT008
073620200528     C                     ENDSL                                          CFT008
073630200528     C                     MOVE CCTCCY    WCCY                            CFT008
073640200528     C                     MOVELBRCA      WBRCA                           CFT008
073650200528     C                     EXSR SRTPSR                                    CFT008
073660200528     C                     ENDSL
073670200528      *                                                                                       CCG015
073680200528      ** Initialize context for new extraction                                                CCG015
073690200528     C                     EXSR INIXML                                                        CCG015
073700200528     C*
073710200528     C/COPY WNCPYSRC,CG4630FCPG
073720200528      *
073730200528     C           EXINZ     TAG
073740200528      *
073750200528      *................................................................
073760200528      *
073770200528      **  Unwind subroutine stack name
073780200528     C                     MOVEA*BLANKS   @STK,Q
073790200528     C                     SUB  1         Q
073800200528      *
073810200528     C                     ENDSR
073820200528      *****************************************************************
073830200528     C/COPY WNCPYSRC,CG4630C007
073840200528     C/SPACE 5
073850200528      *****************************************************************   CFT003
073860200528      * Subroutine  :  DESTIN                                         *   CFT003
073870200528      * Function    :  Destination Institution                        *   CFT003
073880200528      *                                                               *   CFT003
073890200528      * Called by   :                                                 *   CFT003
073900200528      * Calls       :                                                 *   CFT003
073910200528      *****************************************************************   CFT003
073920200528     C           DESTIN    BEGSR                                          CFT003
073930200528      *                                                                   CFT003
073940200528      **  Set up subroutine stack name                                    CFT003
073950200528     C                     ADD  1         Q                               CFT003
073960200528     C                     MOVEL'DESTIN'  @STK,Q                          CFT003
073970200528      *                                                                   CFT003
073980200528      *................................................................   CFT003
073990200528      *                                                                   CFT003
074000200528      **  Retrieve subroutine specific data.                              CFT003
074010200528     C           1         OCUR ##SRDT                                    CFT003
074020200528     C                     MOVEL##SPAT    S#PATH                          CFT003
074030200528      *                                                                   CFT003
074040200528      **  Set up Path.                                                    CFT003
074050200528     C                     MOVEL'\DESTIN' ##PNAM                          CFT003
074060200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT003
074070200528      *                                                                                       CCG015
074080200528     C                     EXSR PSHGRS                                                        CCG015
074090200528      *                                                                   CFT003
074100200528      **  Retrieve RDE information for RDEs in group set                  CFT003
074110200528      *                                                                   CFT003
074120200528     C                     MOVEL'CORDTA'  ##GRPS                          CFT003
074130200528     C                     Z-ADD1         ##RDEN                          CFT003
074140200528     C                     EXSR SRRRDE                                    CFT003
074150200528     C*                                                                   CFT003
074160200528     C                     MOVE *BLANKS   W#ADD1                          CFT003
074170200528     C                     MOVE *BLANKS   W#ADD2                          CFT003
074180200528     C                     MOVE *BLANKS   W#ADD3                          CFT003
074190200528     C                     MOVE *BLANKS   W#ADD4                          CFT003
074200200528     C                     MOVE *BLANKS   W#ADD5                          CFT003
074210200528     C*                                                                   CFT003
074220200528     C           DSTT      IFEQ 'A'                                       CFT003
074230200528     C                     MOVE DST1      W#ADD1                          CFT003
074240200528     C                     MOVE DST2      W#ADD2                          CFT003
074250200528     C                     MOVE DST3      W#ADD3                          CFT003
074260200528     C                     MOVE DST4      W#ADD4                          CFT003
074270200528     C                     ENDIF                                          CFT003
074280200528      *                                                                   CFT003
074290200528     C                     MOVE DSTT      WTYPE                           CFT003
074300200528     C                     MOVE DST1      WPTY1                           CFT003
074310200528     C                     MOVE DST2      WPTY2                           CFT003
074320200528     C                     MOVE *BLANKS   WBRCA                           CFT003
074330200528     C                     MOVE PCCY      WCCY                            CFT003
074340200528      *                                                                   CFT003
074350200528     C                     EXSR SRTPSR                                    CFT003
074360200528      *                                                                   CFT003
074370200528      **  For Outgoing CR Advices                                         CFT003
074380200528      **  Store the customer number of the Destination so that it         CFT003
074390200528      **  can be used as the primary correspondent for the second         CFT003
074400200528      **  call of this program, to produce the second extract record.     CFT003
074410200528      *                                                                   CFT003
074420200528     C           UUDRAD    IFEQ *BLANKS                                   CFT003
074430200528     C                     MOVEL'FT_ADV_D'UUDRAD  9        Too big        CFT003
074440200528     C                     MOVE 'R'       UUDRAD           Too big        CFT003
074450200528     C                     ENDIF                                          CFT003
074460200528      *                                                                   CFT003
074470200528     C           ##PTYP    IFEQ UUDRAD                                    CFT003
074480200528     C           ##PSTP    ANDEQ'OUT_PAY'                                 CFT003
074490200528     C           *LIKE     DEFN W0CNUM    UUCNUM                          CFT003
074500200528     C**********           Z-ADDW0CNUM    UUCNUM                                       CFT003 CSD027
074510200528     C                     MOVE W0CNUM    UUCNUM                                              CSD027
074520200528     C                     ENDIF                                          CFT003
074530200528      *                                                                   CFT003
074540200528      **  Destination Information Type                                    CFT003
074550200528     C                     MOVE *BLANKS   #TYPE                           CFT003
074560200528     C                     MOVELDSTT      #TYPE                           CFT003
074570200528      *                                                                   CFT003
074580200528     C           #TYPE     IFNE 'A'                                       CFT003
074590200528      *                                                                   CFT003
074600200528     C                     MOVE *BLANKS   W#ADDR                          CFT003
074610200528      **  Address line 1                                                  CFT003
074620200528     C                     MOVELCNA1      W#ADD1                          CFT003
074630200528      **  Address line 2                                                  CFT003
074640200528     C                     MOVELCNA2      W#ADD2                          CFT003
074650200528      *                                                                   CFT003
074660200528      **  Address line 3                                                  CFT003
074670200528     C                     MOVELCNA3      W#ADD3                          CFT003
074680200528      *                                                                   CFT003
074690200528      **  Address line 4                                                  CFT003
074700200528     C                     MOVELCNA4      W#ADD4                          CFT003
074710200528      *                                                                   CFT003
074720200528      **  Address line 5                                                  CFT003
074730200528     C                     MOVELCNA5      W#ADD5                          CFT003
074740200528      *                                                                   CFT003
074750200528     C                     ENDIF                                          CFT003
074760200528      *                                                                   CFT003
074770200528     C                     EXSR CORDTA                                    CFT003
074780200528      *                                                                   CFT003
074790200528      **  Accumulate RDE's and associated data and output to              CFT003
074800200528      **  PF/CGUDTAPD.                                                    CFT003
074810200528     C                     EXSR SRADTA                                    CFT003
074820200528     C                     EXSR SRODTA                                    CFT003
074830200528      *                                                                   CFT003
074840200528      *................................................................   CFT003
074850200528      *                                                                   CFT003
074860200528     C           EXDEST    TAG                                            CFT003
074870200528      *                                                                                       CCG015
074880200528     C                     EXSR POPGRS                                                        CCG015
074890200528      *                                                                   CFT003
074900200528      **  Unwind subroutine stack name                                    CFT003
074910200528     C                     MOVEA*BLANKS   @STK,Q                          CFT003
074920200528     C                     SUB  1         Q                               CFT003
074930200528      *                                                                   CFT003
074940200528     C                     ENDSR                                          CFT003
074950200528     C*****************************************************************   CFT003
074960200528     C/SPACE 5                                                            CFT003
074970200528      *****************************************************************   CFT003
074980200528      * Subroutine  :  SEND2                                          *   CFT003
074990200528      * Function    :  Sender Details                                 *   CFT003
075000200528      *                                                               *   CFT003
075010200528      * Called by   :                                                 *   CFT003
075020200528      * Calls       :                                                 *   CFT003
075030200528      *****************************************************************   CFT003
075040200528     C           SEND2     BEGSR                                          CFT003
075050200528      *                                                                   CFT003
075060200528      **  Set up subroutine stack name                                    CFT003
075070200528     C                     ADD  1         Q                               CFT003
075080200528     C                     MOVEL'SENDER'  @STK,Q                          CFT003
075090200528      *                                                                   CFT003
075100200528      *................................................................   CFT003
075110200528      *                                                                   CFT003
075120200528      **  Retrieve subroutine specific data.                              CFT003
075130200528     C           1         OCUR ##SRDT                                    CFT003
075140200528     C                     MOVEL##SPAT    S#PATH                          CFT003
075150200528      *                                                                   CFT003
075160200528      **  Set up Path.                                                    CFT003
075170200528     C                     MOVEL'\SENDER' ##PNAM                          CFT003
075180200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT003
075190200528      *                                                                                       CCG015
075200200528     C                     EXSR PSHGRS                                                        CCG015
075210200528      *                                                                   CFT003
075220200528      **  Retrieve RDE information for RDEs in group set                  CFT003
075230200528      *                                                                   CFT003
075240200528     C                     MOVEL'CORDTA'  ##GRPS                          CFT003
075250200528     C                     Z-ADD1         ##RDEN                          CFT003
075260200528     C                     EXSR SRRRDE                                    CFT003
075270200528      *                                                                   CFT003
075280200528     C                     MOVELSNTP      WTYPE                           CFT003
075290200528     C                     MOVE SMCY      WCCY                            CFT003
075300200528     C                     MOVELSND1      WPTY1                           CFT003
075310200528     C                     MOVELSND2      WPTY2                           CFT003
075320200528     C                     MOVEL*BLANKS   WBRCA                           CFT003
075330200528      *                                                                   CFT003
075340200528      *                                                                   CFT003
075350200528     C                     EXSR SRTPSR                                    CFT003
075360200528      *                                                                   CFT003
075370200528      **  For Incoming DR Advices                                         CFT003
075380200528      **  Store the customer number of the Sender so that it              CFT003
075390200528      **  can be used as the primary correspondent for the second         CFT003
075400200528      **  call of this program, to produce the second extract record.     CFT003
075410200528      *                                                                   CFT003
075420200528     C           UUCRAD    IFEQ *BLANKS                                   CFT003
075430200528     C                     MOVEL'FT_ADV_C'UUCRAD  9        Too big        CFT003
075440200528     C                     MOVE 'R'       UUCRAD           Too big        CFT003
075450200528     C                     ENDIF                                          CFT003
075460200528      *                                                                   CFT003
075470200528     C           ##PTYP    IFEQ UUCRAD                                    CFT003
075480200528     C           ##PSTP    ANDEQ'IN_PAY'                                  CFT003
075490200528     C**********           Z-ADDW0CNUM    UUCNUM                                       CFT003 CSD027
075500200528     C                     MOVE W0CNUM    UUCNUM                                              CSD027
075510200528     C                     ENDIF                                          CFT003
075520200528      *                                                                   CFT003
075530200528      **  Information Type                                                CFT003
075540200528     C                     MOVE *BLANKS   #TYPE                           CFT003
075550200528     C                     MOVELSNTP      #TYPE                           CFT003
075560200528      *                                                                   CFT003
075570200528     C                     MOVE *BLANKS   W#ADDR                          CFT003
075580200528      **  Address line 1                                                  CFT003
075590200528     C                     MOVELCNA1      W#ADD1                          CFT003
075600200528      **  Address line 2                                                  CFT003
075610200528     C                     MOVELCNA2      W#ADD2                          CFT003
075620200528      *                                                                   CFT003
075630200528      **  Address line 3                                                  CFT003
075640200528     C                     MOVELCNA3      W#ADD3                          CFT003
075650200528      *                                                                   CFT003
075660200528      **  Address line 4                                                  CFT003
075670200528     C                     MOVELCNA4      W#ADD4                          CFT003
075680200528      *                                                                   CFT003
075690200528      **  Address line 5                                                  CFT003
075700200528     C                     MOVE *BLANKS   W#ADD5                          CFT003
075710200528      *                                                                   CFT003
075720200528      *   Fill with destination details if an address                     CFT003
075730200528     C           SNTP      IFEQ 'A'                                       CFT003
075740200528      **  Destination Address line 1                                      CFT003
075750200528     C                     MOVELSND1      W#ADD1                          CFT003
075760200528      **  Destination Address line 2                                      CFT003
075770200528     C                     MOVELSND2      W#ADD2                          CFT003
075780200528      *                                                                   CFT003
075790200528      **  Destination Address line 3                                      CFT003
075800200528     C                     MOVELSND3      W#ADD3                          CFT003
075810200528      *                                                                   CFT003
075820200528      **  Destination Address line 4                                      CFT003
075830200528     C                     MOVELSND4      W#ADD4                          CFT003
075840200528      *                                                                   CFT003
075850200528      **  Balnaks in Address line 5                                       CFT003
075860200528     C                     MOVE *BLANKS   W#ADD5                          CFT003
075870200528     C                     ENDIF                                          CFT003
075880200528      *                                                                   CFT003
075890200528     C                     EXSR CORDTA                                    CFT003
075900200528      *                                                                   CFT003
075910200528      **  Accumulate RDE's and associated data and output to              CFT003
075920200528      **  PF/CGUDTAPD.                                                    CFT003
075930200528     C                     EXSR SRADTA                                    CFT003
075940200528     C                     EXSR SRODTA                                    CFT003
075950200528      *                                                                   CFT003
075960200528      *................................................................   CFT003
075970200528      *                                                                   CFT003
075980200528     C           EXSEN2    TAG                                            CFT003
075990200528      *                                                                                       CCG015
076000200528     C                     EXSR POPGRS                                                        CCG015
076010200528      *                                                                   CFT003
076020200528      **  Unwind subroutine stack name                                    CFT003
076030200528     C                     MOVEA*BLANKS   @STK,Q                          CFT003
076040200528     C                     SUB  1         Q                               CFT003
076050200528      *                                                                   CFT003
076060200528     C                     ENDSR                                          CFT003
076070200528     C*****************************************************************   CFT003
076080200528      /SPACE 5                                                            CFT006
076090200528      *****************************************************************   CFT006
076100200528      * Subroutine  :  SRRFT                                          *   CFT006
076110200528      * Function    :  Request for Transfer Details                   *   CFT006
076120200528      *                                                               *   CFT006
076130200528      * Called by   :  DRCR05                                         *   CFT006
076140200528      * Calls       :                                                 *   CFT006
076150200528      *****************************************************************   CFT006
076160200528     C           SRRFT     BEGSR                                          CFT006
076170200528      *                                                                   CFT006
076180200528      **  Set up subroutine stack name                                    CFT006
076190200528     C                     ADD  1         Q                               CFT006
076200200528     C                     MOVEL'FT_RFT'  @STK,Q                          CFT006
076210200528      *                                                                   CFT006
076220200528      *................................................................   CFT006
076230200528      *                                                                   CFT006
076240200528      **  Retrieve subroutine specific data.                              CFT006
076250200528     C           1         OCUR ##SRDT                                    CFT006
076260200528     C                     MOVEL##SPAT    S#PATH                          CFT006
076270200528      *                                                                   CFT006
076280200528      **  Set up Path.                                                    CFT006
076290200528     C                     MOVEL'\FT_RFT' ##PNAM                          CFT006
076300200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
076310200528      *                                                                                       CCG015
076320200528     C                     EXSR PSHGRS                                                        CCG015
076330200528      *                                                                   CFT006
076340200528      **  Retrieve RDE information for RDEs in group set                  CFT006
076350200528      *                                                                   CFT006
076360200528     C                     MOVEL@STK,Q    ##GRPS                          CFT006
076370200528     C                     Z-ADD1         ##RDEN                          CFT006
076380200528     C                     EXSR SRRRDE                                    CFT006
076390200528      *                                                                   CFT006
076400200528     C                     MOVELRFTID     ##D,1                           CFT006
076410200528     C                     MOVELSTID      ##D,2                           CFT006
076420200528     C                     MOVELSNDREF    ##D,3                           CFT006
076430200528     C                     MOVELTRNSID    ##D,4                           CFT006
076440200528     C                     MOVELFXDREF    ##D,5                           CFT006
076450200528     C                     MOVELHINPTY    ##D,6                           CFT006
076460200528     C                     MOVELEXDATE    ##D,7                           CFT006
076470200528     C                     MOVELHANDCY    ##D,8                           CFT006
076480200528      *                                                                   CFT006
076490200528     C           HANDCY    IFNE *BLANKS                                   CFT006
076500200528     C                     CALL 'AOCURRR0'                                CFT006
076510200528     C                     PARM *BLANKS   PRTCD   7                       CFT006
076520200528     C                     PARM '*KEY   ' POPTN   7                       CFT006
076530200528     C                     PARM HANDCY    @AJCD                           CFT006
076540200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
076550200528      *                                                                   CFT006
076560200528     C           PRTCD     IFNE *BLANKS                                   CFT006
076570200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
076580200528     C                     MOVELHANDCY    W0KEY            ***************CFT006
076590200528     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CFT006
076600200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
076610200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
076620200528     C                     EXSR SRERR                                     CFT006
076630200528     C                     ENDIF                                          CFT006
076640200528     C                     MOVE A6NBDP    ##D,9                           CFT006
076650200528     C                     ENDIF                                          CFT006
076660200528      *                                                                   CFT006
076670200528     C                     MOVELHANDCG    ##D,9                           CFT006
076680200528     C                     MOVELHANDAC    ##D,10                          CFT006
076690200528     C                     MOVELAUTHTX    ##D,11                          CFT006
076700200528     C                     MOVELTOCCY     ##D,12                          CFT006
076710200528      *                                                                   CFT006
076720200528     C           TOCCY     IFNE *BLANKS                                   CFT006
076730200528     C                     CALL 'AOCURRR0'                                CFT006
076740200528     C                     PARM *BLANKS   PRTCD                           CFT006
076750200528     C                     PARM '*KEY   ' POPTN                           CFT006
076760200528     C                     PARM TOCCY     @AJCD                           CFT006
076770200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
076780200528      *                                                                   CFT006
076790200528     C           PRTCD     IFNE *BLANKS                                   CFT006
076800200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
076810200528     C                     MOVELTOCCY     W0KEY            ***************CFT006
076820200528     C                     Z-ADD26        W0ERNB           * DB ERROR 26 *CFT006
076830200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
076840200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
076850200528     C                     EXSR SRERR                                     CFT006
076860200528     C                     ENDIF                                          CFT006
076870200528     C                     MOVE A6NBDP    ##D,13                          CFT006
076880200528     C                     ENDIF                                          CFT006
076890200528      *                                                                   CFT006
076900200528     C                     MOVELTOOAMT    ##D,13                          CFT006
076910200528     C                     MOVELINSCA4    ##D,14                          CFT006
076920200528     C                     MOVELINSCB4    ##D,15                          CFT006
076930200528     C                     MOVELINSCC4    ##D,16                          CFT006
076940200528     C                     MOVELINSCD4    ##D,17                          CFT006
076950200528     C                     MOVELINSCE4    ##D,18                          CFT006
076960200528     C                     MOVELINSA31    ##D,19                          CFT006
076970200528     C                     MOVELINSB31    ##D,20                          CFT006
076980200528      *                                                                   CFT006
076990200528      **  Accumulate RDE's and associated data and output to              CFT006
077000200528      **  PF/CGUDTAPD.                                                    CFT006
077010200528      *                                                                   CFT006
077020200528     C                     EXSR SRADTA                                    CFT006
077030200528     C                     EXSR SRODTA                                    CFT006
077040200528      *                                                                                       CCG015
077050200528     C                     EXSR POPGRS                                                        CCG015
077060200528      *                                                                   CFT006
077070200528      *................................................................   CFT006
077080200528      **  Unwind subroutine stack name                                    CFT006
077090200528      *                                                                   CFT006
077100200528     C                     MOVEA*BLANKS   @STK,Q                          CFT006
077110200528     C                     SUB  1         Q                               CFT006
077120200528      *                                                                   CFT006
077130200528     C                     ENDSR                                          CFT006
077140200528      *****************************************************************   CFT006
077150200528      /SPACE 5                                                            CFT006
077160200528      *****************************************************************   CFT006
077170200528      * Subroutine  :  SRRFI                                          *   CFT006
077180200528      * Function    :  Request for Transfer Details II                *   CFT006
077190200528      *                                                               *   CFT006
077200200528      * Called by   :  DRCR05                                         *   CFT006
077210200528      * Calls       :                                                 *   CFT006
077220200528      *****************************************************************   CFT006
077230200528     C           SRRFI     BEGSR                                          CFT006
077240200528      *                                                                   CFT006
077250200528      **  Set up subroutine stack name                                    CFT006
077260200528     C                     ADD  1         Q                               CFT006
077270200528     C                     MOVEL'FT_RFI'  @STK,Q                          CFT006
077280200528      *                                                                   CFT006
077290200528      *................................................................   CFT006
077300200528      *                                                                   CFT006
077310200528      **  Retrieve subroutine specific data.                              CFT006
077320200528     C           1         OCUR ##SRDT                                    CFT006
077330200528     C                     MOVEL##SPAT    S#PATH                          CFT006
077340200528      *                                                                   CFT006
077350200528      **  Set up Path.                                                    CFT006
077360200528     C                     MOVEL'\FT_RFI' ##PNAM                          CFT006
077370200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
077380200528      *                                                                                       CCG015
077390200528     C                     EXSR PSHGRS                                                        CCG015
077400200528      *                                                                   CFT006
077410200528      **  Retrieve RDE information for RDEs in group set                  CFT006
077420200528      *                                                                   CFT006
077430200528     C                     MOVEL@STK,Q    ##GRPS                          CFT006
077440200528     C                     Z-ADD1         ##RDEN                          CFT006
077450200528     C                     EXSR SRRRDE                                    CFT006
077460200528      *                                                                   CFT006
077470200528     C                     MOVELTINST1    ##D,1                           CFT006
077480200528     C                     MOVELTINST2    ##D,2                           CFT006
077490200528     C                     MOVELTINST3    ##D,3                           CFT006
077500200528     C                     MOVELTINST4    ##D,4                           CFT006
077510200528     C                     MOVELTINST5    ##D,5                           CFT006
077520200528     C                     MOVELTINSTA    ##D,6                           CFT006
077530200528     C                     MOVELINTTTP    ##D,7                           CFT006
077540200528     C                     MOVELTACA35    ##D,8                           CFT006
077550200528     C                     MOVELTACB35    ##D,9                           CFT006
077560200528     C                     MOVELTACC35    ##D,10                          CFT006
077570200528     C                     MOVELTACD35    ##D,11                          CFT006
077580200528     C                     MOVELTACE35    ##D,12                          CFT006
077590200528     C                     MOVELTACA11    ##D,13                          CFT006
077600200528     C                     MOVELAWITTP    ##D,14                          CFT006
077610200528     C                     MOVELHACSV1    ##D,15                          CFT006
077620200528     C                     MOVELHACSV2    ##D,16                          CFT006
077630200528      *                                                                   CFT006
077640200528      **  Accumulate RDE's and associated data and output to              CFT006
077650200528      **  PF/CGUDTAPD.                                                    CFT006
077660200528      *                                                                   CFT006
077670200528     C                     EXSR SRADTA                                    CFT006
077680200528     C                     EXSR SRODTA                                    CFT006
077690200528      *                                                                                       CCG015
077700200528     C                     EXSR POPGRS                                                        CCG015
077710200528      *                                                                   CFT006
077720200528      *................................................................   CFT006
077730200528      **  Unwind subroutine stack name                                    CFT006
077740200528      *                                                                   CFT006
077750200528     C                     MOVEA*BLANKS   @STK,Q                          CFT006
077760200528     C                     SUB  1         Q                               CFT006
077770200528      *                                                                   CFT006
077780200528     C                     ENDSR                                          CFT006
077790200528      *****************************************************************   CFT006
077800200528      /SPACE 5                                                            CFT006
077810200528      *****************************************************************   CFT008
077820200528      * Subroutine  :  SRCCT                                          *   CFT008
077830200528      * Function    :  Customer Credit Transfer Details               *   CFT008
077840200528      *                                                               *   CFT008
077850200528      * Called by   :  DRCR06                                         *   CFT008
077860200528      * Calls       :                                                 *   CFT008
077870200528      *****************************************************************   CFT008
077880200528     C           SRCCT     BEGSR                                          CFT008
077890200528      *                                                                   CFT008
077900200528      **  Set up subroutine stack name                                    CFT008
077910200528     C                     ADD  1         Q                               CFT008
077920200528     C                     MOVEL'FT_CCT'  @STK,Q                          CFT008
077930200528      *                                                                   CFT008
077940200528      *................................................................   CFT008
077950200528      *                                                                   CFT008
077960200528      **  Retrieve subroutine specific data.                              CFT008
077970200528     C           1         OCUR ##SRDT                                    CFT008
077980200528     C                     MOVEL##SPAT    S#PATH                          CFT008
077990200528      *                                                                   CFT008
078000200528      **  Set up Path.                                                    CFT008
078010200528     C                     MOVEL'\FT_CCT' ##PNAM                          CFT008
078020200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
078030200528      *                                                                                       CCG015
078040200528     C                     EXSR PSHGRS                                                        CCG015
078050200528      *                                                                   CFT008
078060200528      **  Retrieve RDE information for RDEs in group set                  CFT008
078070200528      *                                                                   CFT008
078080200528     C                     MOVEL@STK,Q    ##GRPS                          CFT008
078090200528     C                     Z-ADD1         ##RDEN                          CFT008
078100200528     C                     EXSR SRRRDE                                    CFT008
078110200528      *                                                                   CFT008
078120200528     C                     MOVELCCTID     ##D,1                           CFT008
078130200528     C                     MOVELFILREF    ##D,2                           CFT008
078140200528     C                     MOVELTRNSID    ##D,3                           CFT008
078150200528     C                     MOVELCCTBOC    ##D,4                           CFT008
078160200528     C                     MOVELCCTDST    ##D,5                           CFT008
078170200528     C                     MOVELTTVDTE    ##D,6                           CFT008
078180200528     C                     MOVELCCTCHG    ##D,7                           CFT008
078190200528     C                     MOVELCCTTYP    ##D,8                           CFT008
078200200528      *                                                                   CFT008
078210200528      **  Accumulate RDE's and associated data and output to              CFT008
078220200528      **  PF/CGUDTAPD.                                                    CFT008
078230200528      *                                                                   CFT008
078240200528     C                     EXSR SRADTA                                    CFT008
078250200528     C                     EXSR SRODTA                                    CFT008
078260200528      *                                                                                       CCG015
078270200528     C                     EXSR POPGRS                                                        CCG015
078280200528      *                                                                   CFT008
078290200528      *................................................................   CFT008
078300200528      **  Unwind subroutine stack name                                    CFT008
078310200528      *                                                                   CFT008
078320200528     C                     MOVEA*BLANKS   @STK,Q                          CFT008
078330200528     C                     SUB  1         Q                               CFT008
078340200528      *                                                                   CFT008
078350200528     C                     ENDSR                                          CFT008
078360200528      *****************************************************************   CFT008
078370200528      /SPACE 5                                                            CFT008
078380200528      *****************************************************************   CFT008
078390200528      * Subroutine  :  SRCCI                                          *   CFT008
078400200528      * Function    :  Customer Credit Transfer Details II            *   CFT008
078410200528      *                                                               *   CFT008
078420200528      * Called by   :  DRCR06                                         *   CFT008
078430200528      * Calls       :                                                 *   CFT008
078440200528      *****************************************************************   CFT008
078450200528     C           SRCCI     BEGSR                                          CFT008
078460200528      *                                                                   CFT008
078470200528      **  Set up subroutine stack name                                    CFT008
078480200528     C                     ADD  1         Q                               CFT008
078490200528     C                     MOVEL'FT_CCI'  @STK,Q                          CFT008
078500200528      *                                                                   CFT008
078510200528      *................................................................   CFT008
078520200528      *                                                                   CFT008
078530200528      **  Retrieve subroutine specific data.                              CFT008
078540200528     C           1         OCUR ##SRDT                                    CFT008
078550200528     C                     MOVEL##SPAT    S#PATH                          CFT008
078560200528      *                                                                   CFT008
078570200528      **  Set up Path.                                                    CFT008
078580200528     C                     MOVEL'\FT_CCI' ##PNAM                          CFT008
078590200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
078600200528      *                                                                                       CCG015
078610200528     C                     EXSR PSHGRS                                                        CCG015
078620200528      *                                                                   CFT008
078630200528      **  Retrieve RDE information for RDEs in group set                  CFT008
078640200528      *                                                                   CFT008
078650200528     C                     MOVEL@STK,Q    ##GRPS                          CFT008
078660200528     C                     Z-ADD1         ##RDEN                          CFT008
078670200528     C                     EXSR SRRRDE                                    CFT008
078680200528      *                                                                   CFT008
078690200528     C                     MOVELSNDCCY    ##D,1                           CFT008
078700200528     C           SNDCCY    IFNE *BLANKS                                   CFT008
078710200528     C                     CALL 'AOCURRR0'                                CFT008
078720200528     C                     PARM *BLANKS   PRTCD                           CFT008
078730200528     C                     PARM '*KEY   ' POPTN                           CFT008
078740200528     C                     PARM SNDCCY    @AJCD                           CFT008
078750200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT008
078760200528      *                                                                   CFT008
078770200528     C           PRTCD     IFNE *BLANKS                                   CFT008
078780200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT008
078790200528     C                     MOVELSNDCCY    W0KEY            ***************CFT008
078800200528     C                     Z-ADD27        W0ERNB           * DB ERROR 27 *CFT008
078810200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT008
078820200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT008
078830200528     C                     EXSR SRERR                                     CFT008
078840200528     C                     ENDIF                                          CFT008
078850200528     C                     MOVE A6NBDP    ##D,2                           CFT008
078860200528     C                     ENDIF                                          CFT008
078870200528      *                                                                   CFT008
078880200528     C                     MOVELSNDCHG    ##D,2                           CFT008
078890200528     C           PAYCCY    IFNE *BLANKS                                   CFT008
078900200528     C                     MOVELSNDOCG    ##D,3                           CFT008
078910200528     C                     MOVE WPDCP     ##D,3                           CFT008
078920200528     C                     ENDIF                                          CFT008
078930200528     C           CCTCCY    IFNE *BLANKS                                   CFT008
078940200528     C                     MOVELSNDCTF    ##D,4                           CFT008
078950200528     C                     MOVE WTCCT     ##D,4                           CFT008
078960200528     C                     MOVELSUMCCT    ##D,5                           CFT008
078970200528     C                     MOVE WTCCT     ##D,5                           CFT008
078980200528     C                     ENDIF                                          CFT008
078990200528     C           CCTCCY    IFNE *BLANKS                                   CFT008
079000200528     C                     MOVE WTCCT     ##D,6                           CFT008
079010200528     C                     ENDIF                                          CFT008
079020200528     C                     MOVELSUMRCH    ##D,6                           CFT008
079030200528     C                     MOVELSNDCOR    ##D,7                           CFT008
079040200528     C                     MOVELRCVCOR    ##D,8                           CFT008
079050200528     C                     MOVELADNLI1    ##D,9                           CFT008
079060200528     C                     MOVELADNLI2    ##D,10                          CFT008
079070200528     C                     MOVELADNLI3    ##D,11                          CFT008
079080200528     C                     MOVELADNLI4    ##D,12                          CFT008
079090200528     C                     MOVELADNLI5    ##D,13                          CFT008
079100200528     C                     MOVELADNLI6    ##D,14                          CFT008
079110200528     C                     MOVELAKDRIP    ##D,15                          CFT008
079120200528     C                     MOVELAKDRDR    ##D,16                          CFT008
079130200528      *                                                                   CFT008
079140200528      **  Accumulate RDE's and associated data and output to              CFT008
079150200528      **  PF/CGUDTAPD.                                                    CFT008
079160200528      *                                                                   CFT008
079170200528     C                     EXSR SRADTA                                    CFT008
079180200528     C                     EXSR SRODTA                                    CFT008
079190200528      *                                                                                       CCG015
079200200528     C                     EXSR POPGRS                                                        CCG015
079210200528      *                                                                   CFT008
079220200528      *................................................................   CFT008
079230200528      **  Unwind subroutine stack name                                    CFT008
079240200528      *                                                                   CFT008
079250200528     C                     MOVEA*BLANKS   @STK,Q                          CFT008
079260200528     C                     SUB  1         Q                               CFT008
079270200528      *                                                                   CFT008
079280200528     C                     ENDSR                                          CFT008
079290200528      *****************************************************************   CFT008
079300200528      /SPACE 5                                                            CFT006
079310200528      *****************************************************************   CFT006
079320200528      * Subroutine  :  SRMT0                                          *   CFT006
079330200528      * Function    :  Messages Information I                         *   CFT006
079340200528      *                                                               *   CFT006
079350200528      * Called by   :  DRCR06                                         *   CFT006
079360200528      * Calls       :                                                 *   CFT006
079370200528      *****************************************************************   CFT006
079380200528     C           SRMT0     BEGSR                                          CFT006
079390200528      *                                                                   CFT006
079400200528      **  Set up subroutine stack name                                    CFT006
079410200528     C                     ADD  1         Q                               CFT006
079420200528     C                     MOVEL'FT_MT0'  @STK,Q                          CFT006
079430200528      *                                                                   CFT006
079440200528      *................................................................   CFT006
079450200528      *                                                                   CFT006
079460200528      **  Retrieve subroutine specific data.                              CFT006
079470200528     C           1         OCUR ##SRDT                                    CFT006
079480200528     C                     MOVEL##SPAT    S#PATH                          CFT006
079490200528      *                                                                   CFT006
079500200528      **  Set up Path.                                                    CFT006
079510200528     C                     MOVEL'\FT_MT0' ##PNAM                          CFT006
079520200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
079530200528      *                                                                                       CCG015
079540200528     C                     EXSR PSHGRS                                                        CCG015
079550200528      *                                                                   CFT006
079560200528      **  Retrieve RDE information for RDEs in group set                  CFT006
079570200528      *                                                                   CFT006
079580200528     C                     MOVEL@STK,Q    ##GRPS                          CFT006
079590200528     C                     Z-ADD1         ##RDEN                          CFT006
079600200528     C                     EXSR SRRRDE                                    CFT006
079610200528      *                                                                   CFT006
079620200528     C                     MOVELBRCA      ##D,3                           CFT006
079630200528     C                     MOVELORBR      ##D,4                           CFT006
079640200528     C                     MOVELXRATE     ##D,6                           CFT006
079650200528     C                     MOVELXRATEO    ##D,7                           CFT006
079660200528     C                     MOVELGOPFLG    ##D,8                           CFT006
079670200528     C                     SELEC                                          CFT006
079680200528     C           ##FILE    WHEQ 'FT101H  '                                CFT006
079690200528     C                     MOVELPYTP      ##D,1                           CFT006
079700200528     C                     MOVELPYST      ##D,2                           CFT006
079710200528     C                     MOVELSINST     ##D,5                           CFT006
079720200528     C                     MOVELTDCHGS    ##D,9                           CFT006
079730200528     C                     MOVELRCHCCY    ##D,10                          CFT006
079740200528      *                                                                   CFT006
079750200528     C           RCHCCY    IFNE *BLANKS                                   CFT006
079760200528     C                     CALL 'AOCURRR0'                                CFT006
079770200528     C                     PARM *BLANKS   PRTCD   7                       CFT006
079780200528     C                     PARM '*KEY   ' POPTN   7                       CFT006
079790200528     C                     PARM RCHCCY    @AJCD                           CFT006
079800200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
079810200528      *                                                                   CFT006
079820200528     C           PRTCD     IFNE *BLANKS                                   CFT006
079830200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
079840200528     C                     MOVELRCHCCY    W0KEY            ***************CFT006
079850200528     C                     Z-ADD28        W0ERNB           * DB ERROR 28 *CFT006
079860200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
079870200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
079880200528     C                     EXSR SRERR                                     CFT006
079890200528     C                     ENDIF                                          CFT006
079900200528     C                     MOVE A6NBDP    ##D,11                          CFT006
079910200528     C                     ENDIF                                          CFT006
079920200528     C                     MOVELRCVCHG    ##D,11                          CFT006
079930200528     C                     MOVELRCPCCY    ##D,12                          CFT006
079940200528     C           RCPCCY    IFNE *BLANKS                                   CFT006
079950200528     C                     CALL 'AOCURRR0'                                CFT006
079960200528     C                     PARM *BLANKS   PRTCD   7                       CFT006
079970200528     C                     PARM '*KEY   ' POPTN   7                       CFT006
079980200528     C                     PARM RCPCCY    @AJCD                           CFT006
079990200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
080000200528      *                                                                   CFT006
080010200528     C           PRTCD     IFNE *BLANKS                                   CFT006
080020200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
080030200528     C                     MOVELRCPCCY    W0KEY            ***************CFT006
080040200528     C                     Z-ADD29        W0ERNB           * DB ERROR 29 *CFT006
080050200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
080060200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
080070200528     C                     EXSR SRERR                                     CFT006
080080200528     C                     ENDIF                                          CFT006
080090200528     C                     MOVE A6NBDP    ##D,13                          CFT006
080100200528     C                     ENDIF                                          CFT006
080110200528     C                     MOVELRCPCHG    ##D,13                          CFT006
080120200528     C                     MOVELRCTCCY    ##D,14                          CFT006
080130200528     C           RCTCCY    IFNE *BLANKS                                   CFT006
080140200528     C                     CALL 'AOCURRR0'                                CFT006
080150200528     C                     PARM *BLANKS   PRTCD   7                       CFT006
080160200528     C                     PARM '*KEY   ' POPTN   7                       CFT006
080170200528     C                     PARM RCTCCY    @AJCD                           CFT006
080180200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
080190200528      *                                                                   CFT006
080200200528     C           PRTCD     IFNE *BLANKS                                   CFT006
080210200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
080220200528     C                     MOVELRCTCCY    W0KEY            ***************CFT006
080230200528     C                     Z-ADD30        W0ERNB           * DB ERROR 30 *CFT006
080240200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
080250200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
080260200528     C                     EXSR SRERR                                     CFT006
080270200528     C                     ENDIF                                          CFT006
080280200528     C                     MOVE A6NBDP    ##D,15                          CFT006
080290200528     C                     ENDIF                                          CFT006
080300200528     C                     MOVELRCTCHG    ##D,15                          CFT006
080310200528     C           ##FILE    WHEQ 'FT102H  '                                CFT008
080320200528     C                     MOVELCCTTYP    ##D,1                           CFT008
080330200528     C                     MOVELCCTTST    ##D,2                           CFT008
080340200528     C                     MOVELSINSTX    ##D,5                           CFT008
080350200528     C                     MOVELCCYCHG    ##D,9                           CFT008
080360200528     C                     MOVELRCVCCY    ##D,10                          CFT008
080370200528     C           RCVCCY    IFNE *BLANKS                                   CFT008
080380200528     C                     CALL 'AOCURRR0'                                CFT008
080390200528     C                     PARM *BLANKS   PRTCD   7                       CFT008
080400200528     C                     PARM '*KEY   ' POPTN   7                       CFT008
080410200528     C                     PARM RCVCCY    @AJCD                           CFT008
080420200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT008
080430200528      *                                                                   CFT008
080440200528     C           PRTCD     IFNE *BLANKS                                   CFT008
080450200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT008
080460200528     C                     MOVELRCVCCY    W0KEY            ***************CFT008
080470200528     C                     Z-ADD31        W0ERNB           * DB ERROR 31 *CFT008
080480200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT008
080490200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT008
080500200528     C                     EXSR SRERR                                     CFT008
080510200528     C                     ENDIF                                          CFT008
080520200528     C                     MOVE A6NBDP    ##D,11                          CFT008
080530200528     C                     ENDIF                                          CFT008
080540200528     C                     MOVELRCVCHG    ##D,11                          CFT008
080550200528     C                     MOVELPAYCCY    ##D,12                          CFT008
080560200528     C           PAYCCY    IFNE *BLANKS                                   CFT008
080570200528     C                     MOVELRCVOCG    ##D,13                          CFT008
080580200528     C                     MOVE WPDCP     ##D,13                          CFT008
080590200528     C                     ENDIF                                          CFT008
080600200528     C                     MOVELCCTCCY    ##D,14                          CFT008
080610200528     C           CCTCCY    IFNE *BLANKS                                   CFT008
080620200528     C                     MOVELRCVCTF    ##D,15                          CFT008
080630200528     C                     MOVE WTCCT     ##D,15                          CFT008
080640200528     C                     ENDIF                                          CFT008
080650200528     C                     ENDSL                                          CFT006
080660200528      *                                                                   CFT006
080670200528      **  Accumulate RDE's and associated data and output to              CFT006
080680200528      **  PF/CGUDTAPD.                                                    CFT006
080690200528      *                                                                   CFT006
080700200528     C                     EXSR SRADTA                                    CFT006
080710200528     C                     EXSR SRODTA                                    CFT006
080720200528      *                                                                                       CCG015
080730200528     C                     EXSR POPGRS                                                        CCG015
080740200528      *                                                                   CFT006
080750200528      *................................................................   CFT006
080760200528      **  Unwind subroutine stack name                                    CFT006
080770200528      *                                                                   CFT006
080780200528     C                     MOVEA*BLANKS   @STK,Q                          CFT006
080790200528     C                     SUB  1         Q                               CFT006
080800200528      *                                                                   CFT006
080810200528     C                     ENDSR                                          CFT006
080820200528      *****************************************************************   CFT006
080830200528      /SPACE 5                                                            CFT006
080840200528      *****************************************************************   CFT006
080850200528      * Subroutine  :  SRMT1                                          *   CFT006
080860200528      * Function    :  Messages Information II                        *   CFT006
080870200528      *                                                               *   CFT006
080880200528      * Called by   :  DRCR06                                         *   CFT006
080890200528      * Calls       :                                                 *   CFT006
080900200528      *****************************************************************   CFT006
080910200528     C           SRMT1     BEGSR                                          CFT006
080920200528      *                                                                   CFT006
080930200528      **  Set up subroutine stack name                                    CFT006
080940200528     C                     ADD  1         Q                               CFT006
080950200528     C                     MOVEL'FT_MT1'  @STK,Q                          CFT006
080960200528      *                                                                   CFT006
080970200528      *................................................................   CFT006
080980200528      *                                                                   CFT006
080990200528      **  Retrieve subroutine specific data.                              CFT006
081000200528     C           1         OCUR ##SRDT                                    CFT006
081010200528     C                     MOVEL##SPAT    S#PATH                          CFT006
081020200528      *                                                                   CFT006
081030200528      **  Set up Path.                                                    CFT006
081040200528     C                     MOVEL'\FT_MT1' ##PNAM                          CFT006
081050200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
081060200528      *                                                                                       CCG015
081070200528     C                     EXSR PSHGRS                                                        CCG015
081080200528      *                                                                   CFT006
081090200528      **  Retrieve RDE information for RDEs in group set                  CFT006
081100200528      *                                                                   CFT006
081110200528     C                     MOVEL@STK,Q    ##GRPS                          CFT006
081120200528     C                     Z-ADD1         ##RDEN                          CFT006
081130200528     C                     EXSR SRRRDE                                    CFT006
081140200528      *                                                                   CFT006
081150200528     C           ##FILE    IFEQ 'FT101H  '                                CFT006
081160200528      *                                                                   CFT006
081170200528     C           TOCUS1    IFNE *BLANKS                                   CFT006
081180200528     C                     MOVELTOCUS1    ##D,1                           CFT006
081190200528     C                     MOVELTOCUS2    ##D,2                           CFT006
081200200528     C                     MOVELTOCUS3    ##D,3                           CFT006
081210200528     C                     MOVELTOCUS4    ##D,4                           CFT006
081220200528     C                     MOVELTOCUS5    ##D,5                           CFT006
081230200528     C                     ELSE                                           CFT006
081240200528     C                     MOVELHOCUS1    ##D,1                           CFT006
081250200528     C                     MOVELHOCUS2    ##D,2                           CFT006
081260200528     C                     MOVELHOCUS3    ##D,3                           CFT006
081270200528     C                     MOVELHOCUS4    ##D,4                           CFT006
081280200528     C                     MOVELHOCUS5    ##D,5                           CFT006
081290200528     C                     ENDIF                                          CFT006
081300200528      *                                                                   CFT006
081310200528     C                     ENDIF                                          CFT006
081320200528      *                                                                   CFT006
081330200528     C           ##FILE    IFEQ 'FT102H  '                                CFT006
081340200528      *                                                                   CFT006
081350200528     C           TOCUS1    IFNE *BLANKS                                   CFT006
081360200528     C                     MOVELTOCUS1    ##D,1                           CFT006
081370200528     C                     MOVELTOCUS2    ##D,2                           CFT006
081380200528     C                     MOVELTOCUS3    ##D,3                           CFT006
081390200528     C                     MOVELTOCUS4    ##D,4                           CFT006
081400200528     C                     MOVEL*BLANKS   ##D,5                           CFT006
081410200528     C           CSW207    IFEQ 'Y'                                                         BUG15105
081420200528     C                     MOVELTOCUS5    ##D,5                                             BUG15105
081430200528     C                     ENDIF                                                            BUG15105
081440200528     C                     ELSE                                           CFT006
081450200528     C                     MOVELORDCU1    ##D,1                           CFT006
081460200528     C                     MOVELORDCU2    ##D,2                           CFT006
081470200528     C                     MOVELORDCU3    ##D,3                           CFT006
081480200528     C                     MOVELORDCU4    ##D,4                           CFT006
081490200528     C                     MOVEL*BLANKS   ##D,5                           CFT006
081500200528     C           CSW207    IFEQ 'Y'                                                           CSW207
081510200528     C                     MOVELORDCU5    ##D,5                                               CSW207
081520200528     C                     ENDIF                                                              CSW207
081530200528     C                     ENDIF                                          CFT006
081540200528      *                                                                   CFT006
081550200528     C                     ENDIF                                          CFT006
081560200528      *                                                                   CFT006
081570200528     C                     SELEC                                          CFT006
081580200528     C           ##FILE    WHEQ 'FT101H  '                                CFT006
081590200528     C                     MOVELDCUSTP    ##D,6                           CFT006
081600200528     C                     MOVELTBNA35    ##D,7                           CFT006
081610200528     C                     MOVELTBNB35    ##D,8                           CFT006
081620200528     C                     MOVELTBNC35    ##D,9                           CFT006
081630200528     C                     MOVELTBND35    ##D,10                          CFT006
081640200528     C                     MOVELTBNE35    ##D,11                          CFT006
081650200528     C                     MOVELBENTTP    ##D,12                          CFT006
081660200528     C                     MOVELTRMA35    ##D,13                          CFT006
081670200528     C                     MOVELTRMB35    ##D,14                          CFT006
081680200528     C                     MOVELTRMC35    ##D,15                          CFT006
081690200528     C                     MOVELTRMD35    ##D,16                          CFT006
081700200528     C                     MOVELTRGA35    ##D,17                          CFT006
081710200528     C                     MOVELTRGB35    ##D,18                          CFT006
081720200528     C                     MOVELTRGC35    ##D,19                          CFT006
081730200528     C           ##FILE    WHEQ 'FT102H  '                                CFT008
081740200528     C                     MOVELCUSTTH    ##D,6                           CFT008
081750200528     C                     MOVELBENF1     ##D,7                           CFT008
081760200528     C                     MOVELBENF2     ##D,8                           CFT008
081770200528     C                     MOVELBENF3     ##D,9                           CFT008
081780200528     C                     MOVELBENF4     ##D,10                          CFT008
081790200528     C                     MOVELBENF5     ##D,11                          CFT008
081800200528     C                     MOVELBENTTD    ##D,12                          CFT008
081810200528     C                     MOVELREMI1     ##D,13                          CFT008
081820200528     C                     MOVELREMI2     ##D,14                          CFT008
081830200528     C                     MOVELREMI3     ##D,15                          CFT008
081840200528     C                     MOVELREMI4     ##D,16                          CFT008
081850200528     C                     MOVELREGRP1    ##D,17                          CFT008
081860200528     C                     MOVELREGRP2    ##D,18                          CFT008
081870200528     C                     MOVELREGRP3    ##D,19                          CFT008
081880200528     C                     ENDSL                                          CFT006
081890200528      *                                                                   CFT006
081900200528      **  Accumulate RDE's and associated data and output to              CFT006
081910200528      **  PF/CGUDTAPD.                                                    CFT006
081920200528      *                                                                   CFT006
081930200528     C                     EXSR SRADTA                                    CFT006
081940200528     C                     EXSR SRODTA                                    CFT006
081950200528      *                                                                                       CCG015
081960200528     C                     EXSR POPGRS                                                        CCG015
081970200528      *                                                                   CFT006
081980200528      *................................................................   CFT006
081990200528      **  Unwind subroutine stack name                                    CFT006
082000200528      *                                                                   CFT006
082010200528     C                     MOVEA*BLANKS   @STK,Q                          CFT006
082020200528     C                     SUB  1         Q                               CFT006
082030200528      *                                                                   CFT006
082040200528     C                     ENDSR                                          CFT006
082050200528      *****************************************************************   CFT006
082060200528      /SPACE 5                                                            CFT006
082070200528      *****************************************************************   CFT006
082080200528      * Subroutine  :  SRMT2                                          *   CFT006
082090200528      * Function    :  Messages Information III                       *   CFT006
082100200528      *                                                               *   CFT006
082110200528      * Called by   :  DRCR06                                         *   CFT006
082120200528      * Calls       :                                                 *   CFT006
082130200528      *****************************************************************   CFT006
082140200528     C           SRMT2     BEGSR                                          CFT006
082150200528      *                                                                   CFT006
082160200528      **  Set up subroutine stack name                                    CFT006
082170200528     C                     ADD  1         Q                               CFT006
082180200528     C                     MOVEL'FT_MT2'  @STK,Q                          CFT006
082190200528      *                                                                   CFT006
082200200528      *................................................................   CFT006
082210200528      *                                                                   CFT006
082220200528      **  Retrieve subroutine specific data.                              CFT006
082230200528     C           1         OCUR ##SRDT                                    CFT006
082240200528     C                     MOVEL##SPAT    S#PATH                          CFT006
082250200528      *                                                                   CFT006
082260200528      **  Set up Path.                                                    CFT006
082270200528     C                     MOVEL'\FT_MT2' ##PNAM                          CFT006
082280200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
082290200528      *                                                                                       CCG015
082300200528     C                     EXSR PSHGRS                                                        CCG015
082310200528      *                                                                   CFT006
082320200528      **  Retrieve RDE information for RDEs in group set                  CFT006
082330200528      *                                                                   CFT006
082340200528     C                     MOVEL@STK,Q    ##GRPS                          CFT006
082350200528     C                     Z-ADD1         ##RDEN                          CFT006
082360200528     C                     EXSR SRRRDE                                    CFT006
082370200528      *                                                                   CFT006
082380200528     C                     MOVELTFTRNT    ##D,1                           CFT006
082390200528     C                     MOVELTFTREF    ##D,2                           CFT006
082400200528     C                     MOVELCQIN      ##D,3                           CFT006
082410200528     C                     MOVELSWPRIO    ##D,4                           CFT006
082420200528     C                     MOVELPYBCQS    ##D,5                           CFT006
082430200528     C                     MOVELINUSER    ##D,6                           CFT006
082440200528     C                     MOVELINDATE    ##D,7                           CFT006
082450200528     C                     MOVELINTIME    ##D,8                           CFT006
082460200528     C                     MOVELUPDUSR    ##D,9                           CFT006
082470200528     C                     MOVELUPDDTE    ##D,10                          CFT006
082480200528     C                     MOVELUPDTIM    ##D,11                          CFT006
082490200528     C                     MOVELAUP1      ##D,12                          CFT006
082500200528     C                     MOVELAUP2      ##D,13                          CFT006
082510200528     C                     MOVELAUIN      ##D,14                          CFT006
082520200528     C                     MOVELBAUTH     ##D,15                          CFT006
082530200528     C                     MOVELADVCRT    ##D,16                          CFT006
082540200528     C                     SELEC                                          CFT006
082550200528     C           ##FILE    WHEQ 'FT101H  '                                CFT006
082560200528     C                     MOVE WTRFT     ##D,17                          CFT006
082570200528     C                     MOVELTOTDBT    ##D,17                          CFT006
082580200528     C           ##FILE    WHEQ 'FT102H  '                                CFT008
082590200528     C                     MOVE WTCCT     ##D,17                          CFT008
082600200528     C                     MOVELCCTTDB    ##D,17                          CFT006
082610200528     C                     ENDSL                                          CFT006
082620200528     C                     MOVELAKEYID    ##D,18                          CFT006
082630200528     C                     MOVELAKEYDD    ##D,19                          CFT006
082640200528     C                     MOVELAKEYCD    ##D,20                          CFT006
082650200528      *                                                                   CFT006
082660200528      **  Accumulate RDE's and associated data and output to              CFT006
082670200528      **  PF/CGUDTAPD.                                                    CFT006
082680200528      *                                                                   CFT006
082690200528     C                     EXSR SRADTA                                    CFT006
082700200528     C                     EXSR SRODTA                                    CFT006
082710200528      *                                                                                       CCG015
082720200528     C                     EXSR POPGRS                                                        CCG015
082730200528      *                                                                   CFT006
082740200528      *................................................................   CFT006
082750200528      **  Unwind subroutine stack name                                    CFT006
082760200528      *                                                                   CFT006
082770200528     C                     MOVEA*BLANKS   @STK,Q                          CFT006
082780200528     C                     SUB  1         Q                               CFT006
082790200528      *                                                                   CFT006
082800200528     C                     ENDSR                                          CFT006
082810200528      *****************************************************************   CFT006
082820200528     C/SPACE 5
082830200528      *****************************************************************   CFT014
082840200528      *                                                               *   CFT014
082850200528      *  PYDRCR - Joins group sets PAYMNT, CR_CCY, and DR_CCY to free *   CFT014
082860200528      *           up 2 group sets.                                    *   CFT014
082870200528      *                                                               *   CFT014
082880200528      *  Called by   :  DRCR01, DRCR02                                *   CFT014
082890200528      *  Calls       :  SRRRDE, AODLSTR0, SRERR, AOCURRR0, AOCCYCV0   *   CFT014
082900200528      *                 SRADTA, SRODTA                                *   CFT014
082910200528      *                                                               *   CFT014
082920200528      *****************************************************************   CFT014
082930200528     C           PYDRCR    BEGSR                                          CFT014
082940200528      *                                                                   CFT014
082950200528      ** Set up subroutine stack name                                     CFT014
082960200528     C                     ADD  1         Q                               CFT014
082970200528     C                     MOVEL'PYDRCR'  @STK,Q                          CFT014
082980200528      *                                                                   CFT014
082990200528      ** Retrieve subroutine specific data.                               CFT014
083000200528     C           1         OCUR ##SRDT                                    CFT014
083010200528     C                     MOVEL##SPAT    S#PATH                          CFT014
083020200528      *                                                                   CFT014
083030200528      ** Set up Path.                                                     CFT014
083040200528     C                     MOVEL'\PYDRCR' ##PNAM                          CFT014
083050200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
083060200528      *                                                                                       CCG015
083070200528     C                     EXSR PSHGRS                                                        CCG015
083080200528      *                                                                   CFT014
083090200528      ** Retrieve RDE information for RDEs in group set                   CFT014
083100200528     C                     MOVEL@STK,Q    ##GRPS                          CFT014
083110200528     C                     Z-ADD1         ##RDEN                          CFT014
083120200528     C                     EXSR SRRRDE                                    CFT014
083130200528      *                                                                   CFT014
083140200528      *************************                                           CFT014
083150200528      ** Payment - Main data **                                           CFT014
083160200528      *************************                                           CFT014
083170200528      *                                                                   CFT014
083180200528      ** Payment Reference                                                CFT014
083190200528     C                     MOVELPREF      ##D,1                           CFT014
083200200528      *                                                                   CFT014
083210200528      ** Value Date                                                       CFT014
083220200528     C                     SELEC                                          CFT014
083230200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
083240200528     C                     MOVELPVDT      ##D,2                           CFT014
083250200528     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
083260200528     C                     MOVELSLDT      ##D,2                           CFT014
083270200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
083280200528     C                     MOVELDRVD      ##D,2                           CFT014
083290200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
083300200528     C                     MOVELCRVD      ##D,2                           CFT014
083310200528     C                     ENDSL                                          CFT014
083320200528      *                                                                   CFT014
083330200528      ** Payment Date                                                     CFT014
083340200528     C                     MOVELBJRDNB    ##D,3                           CFT014
083350200528      *                                                                   CFT014
083360200528      ** Payment Type                                                     CFT014
083370200528     C                     MOVELPYTP      ##D,4                           CFT014
083380200528      *                                                                   CFT014
083390200528      ** Payment Sub-Type                                                 CFT014
083400200528     C                     MOVELPYST      ##D,5                           CFT014
083410200528      *                                                                   CFT014
083420200528      ** Obtain Payment Sub-Type Description                              CFT014
083430200528     C                     CALL 'AODLSTR0'                                CFT014
083440200528     C                     PARM *BLANKS   PRTCD   7                       CFT014
083450200528     C                     PARM '*KEY   ' POPTN   7                       CFT014
083460200528     C                     PARM PYST      PAQCD   3                       CFT014
083470200528     C           SDDLST    PARM SDDLST    DSFDY                           CFT014
083480200528     C           PRTCD     IFNE *BLANK                                    CFT014
083490200528     C                     MOVEL'SDDLSTPD'W0FILE                          CFT014
083500200528     C                     MOVELPYST      W0KEY                           CFT014
083510200528     C                     Z-ADD37        W0ERNB                          CFT014
083520200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
083530200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
083540200528     C                     EXSR SRERR                                     CFT014
083550200528     C                     ENDIF                                          CFT014
083560200528      *                                                                   CFT014
083570200528      ** Payment Sub-Type Description                                     CFT014
083580200528     C                     MOVELASDSTN    ##D,6                           CFT014
083590200528      *                                                                   CFT014
083600200528      ** Set up Settle Method                                             CFT014
083610200528     C                     SELEC                                          CFT014
083620200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
083630200528     C                     MOVEL'00'      ##D,7                           CFT014
083640200528     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
083650200528     C                     MOVELSTMT      ##D,7                           CFT014
083660200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
083670200528     C                     MOVELSTMT      ##D,7                           CFT014
083680200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
083690200528     C                     MOVEL'00'      ##D,7                           CFT014
083700200528     C                     ENDSL                                          CFT014
083710200528      *                                                                   CFT014
083720200528      ****************************                                        CFT014
083730200528      ** Credit Cheque/Currency **                                        CFT014
083740200528      ****************************                                        CFT014
083750200528      *                                                                   CFT014
083760200528     C                     SELEC                                          CFT014
083770200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
083780200528     C                     MOVELCRCY      ##D,8                           CFT014
083790200528     C                     MOVELCRCY      PAJCD                           CFT014
083800200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
083810200528     C           ##FILE    OREQ 'FT102H '                                 CFT014
083820200528     C                     MOVELPAYCCY    ##D,8                           CFT014
083830200528     C                     MOVELPAYCCY    PAJCD                           CFT014
083840200528     C                     OTHER                                          CFT014
083850200528     C                     MOVELPCCY      ##D,8                           CFT014
083860200528     C                     MOVELPCCY      PAJCD                           CFT014
083870200528     C                     ENDSL                                          CFT014
083880200528      *                                                                   CFT014
083890200528      ** Obtain currency details                                          CFT014
083900200528     C                     CALL 'AOCURRR0'                                CFT014
083910200528     C                     PARM *BLANKS   PRTCD                           CFT014
083920200528     C                     PARM '*KEY   ' POPTN                           CFT014
083930200528     C                     PARM           PAJCD   3                       CFT014
083940200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
083950200528     C           PRTCD     IFNE *BLANK                                    CFT014
083960200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
083970200528     C                     MOVELPAJCD     W0KEY                           CFT014
083980200528     C                     Z-ADD38        W0ERNB                          CFT014
083990200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
084000200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
084010200528     C                     EXSR SRERR                                     CFT014
084020200528     C                     ENDIF                                          CFT014
084030200528      *                                                                   CFT014
084040200528      ** Credit/Cheque Currency Name                                      CFT014
084050200528     C                     MOVELA6CYNM    ##D,9                           CFT014
084060200528      *                                                                   CFT014
084070200528      ** Credit/Cheque Amount                                             CFT014
084080200528     C                     SELEC                                          CFT014
084090200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
084100200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
084110200528     C                     MOVELPYAM      ##D,10                          CFT014
084120200528     C                     MOVE A6NBDP    ##D,10                          CFT014
084130200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
084140200528     C                     MOVELCQAM      ##D,10                          CFT014
084150200528     C                     MOVE A6NBDP    ##D,10                          CFT014
084160200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
084170200528      *                                                                   CFT014
084180200528      ** Calculate Credit currency equivalent                             CFT014
084190200528     C           MDIN      IFEQ 0                                         CFT014
084200200528     C                     MOVEL'D'       I#MDIN                          CFT014
084210200528     C                     ELSE                                           CFT014
084220200528     C                     MOVEL'M'       I#MDIN                          CFT014
084230200528     C                     ENDIF                                          CFT014
084240200528     C                     Z-ADDRATE      I#RATE                          CFT014
084250200528     C                     Z-ADDCQAM      D#FAMT                          CFT014
084260200528     C                     MOVELSMCY      D#FCCY                          CFT014
084270200528     C                     MOVELCRCY      D#TCCY                          CFT014
084280200528     C                     CALL 'AOCCYCV0'             9090               CFT014
084290200528     C                     PARM *BLANKS   PRTCD                           CFT014
084300200528     C                     PARM '*F*T*RAT'W0ACT                           CFT014
084310200528     C           D#DTA     PARM D#DTA     O#DTA                           CFT014
084320200528     C           *IN90     IFEQ '1'                                       CFT014
084330200528     C           PRTCD     ORNE *BLANKS                                   CFT014
084340200528     C                     MOVEL'AOCCYCV0'W0FILE                          CFT014
084350200528     C                     MOVEL'*CALL   'W0KEY                           CFT014
084360200528     C                     Z-ADD39        W0ERNB                          CFT014
084370200528     C                     MOVEL'MEM5003' W0MSGD                          CFT014
084380200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
084390200528     C                     EXSR SRERR                                     CFT014
084400200528     C                     ENDIF                                          CFT014
084410200528      *                                                                   CFT014
084420200528     C                     Z-ADDD#TAMT    W#AMT                           CFT014
084430200528     C                     MOVELD#TAMT    ##D,10                          CFT014
084440200528     C                     MOVE A6NBDP    ##D,10                          CFT014
084450200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
084460200528     C           ##FILE    OREQ 'FT102H '                                 CFT014
084470200528     C                     MOVELPAYAMT    ##D,10                          CFT014
084480200528     C                     MOVE A6NBDP    ##D,10                          CFT014
084490200528     C                     Z-ADDA6NBDP    WPDCP   20                      CFT014
084500200528     C                     ENDSL                                          CFT014
084510200528      *                                                                   CFT014
084520200528      ** Cheque Number                                                    CFT014
084530200528     C                     SELEC                                          CFT014
084540200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
084550200528     C           ##FILE    OREQ 'FT102H '                                 CFT014
084560200528     C                     MOVELCHQNUM    ##D,11                          CFT014
084570200528     C                     OTHER                                          CFT014
084580200528     C                     MOVE *BLANKS   ##D,11                          CFT014
084590200528     C                     ENDSL                                          CFT014
084600200528      *                                                                   CFT014
084610200528      ** Cheque Sequence Number                                           CFT014
084620200528     C                     SELEC                                          CFT014
084630200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
084640200528     C           ##FILE    OREQ 'CQPAC  '                                 CFT014
084650200528     C                     MOVELCQSQ      ##D,12                          CFT014
084660200528     C                     OTHER                                          CFT014
084670200528     C                     MOVE *BLANKS   ##D,12                          CFT014
084680200528     C                     ENDSL                                          CFT014
084690200528      *                                                                   CFT014
084700200528      ** Set up Credit Date                                               CFT014
084710200528     C                     SELEC                                          CFT014
084720200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
084730200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
084740200528     C                     MOVELPVDT      ##D,13                          CFT014
084750200528     C                     MOVELPVDT      ##D,13                          CFT014
084760200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
084770200528     C                     MOVELPVDT      ##D,13                          CFT014
084780200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
084790200528     C                     MOVELCRVD      ##D,13                          CFT014
084800200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
084810200528     C           ##FILE    OREQ 'FT102H '                                 CFT014
084820200528     C                     MOVELCRDVDT    ##D,13                          CFT014
084830200528     C                     ENDSL                                          CFT014
084840200528      *                                                                   CFT014
084850200528      ********************                                                CFT014
084860200528      ** Debit Currency **                                                CFT014
084870200528      ********************                                                CFT014
084880200528      *                                                                   CFT014
084890200528     C                     SELEC                                          CFT014
084900200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
084910200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
084920200528     C           ##FILE    OREQ 'CQCOD  '                                 CFT014
084930200528     C                     MOVELSMCY      ##D,14                          CFT014
084940200528     C                     MOVELSMCY      PAJCD                           CFT014
084950200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
084960200528     C                     MOVELDRCY      ##D,14                          CFT014
084970200528     C                     MOVELDRCY      PAJCD                           CFT014
084980200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
084990200528     C                     MOVELTRNCCY    ##D,14                          CFT014
085000200528     C                     MOVELTRNCCY    PAJCD                           CFT014
085010200528     C           ##FILE    WHEQ 'FT102H '                                 CFT014
085020200528     C                     MOVELCCTCCY    ##D,14                          CFT014
085030200528     C                     MOVELCCTCCY    PAJCD                           CFT014
085040200528     C                     ENDSL                                          CFT014
085050200528      *                                                                   CFT014
085060200528      ** Obtain currency details                                          CFT014
085070200528     C                     CALL 'AOCURRR0'                                CFT014
085080200528     C                     PARM *BLANKS   PRTCD                           CFT014
085090200528     C                     PARM '*KEY   ' POPTN                           CFT014
085100200528     C                     PARM           PAJCD                           CFT014
085110200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
085120200528     C           PRTCD     IFNE *BLANK                                    CFT014
085130200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
085140200528     C                     MOVELPAJCD     W0KEY                           CFT014
085150200528     C                     Z-ADD40        W0ERNB                          CFT014
085160200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
085170200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
085180200528     C                     EXSR SRERR                                     CFT014
085190200528     C                     END                                            CFT014
085200200528      *                                                                   CFT014
085210200528      ** Debit Currency Name                                              CFT014
085220200528     C                     MOVELA6CYNM    ##D,15                          CFT014
085230200528      *                                                                   CFT014
085240200528      ** Debit Amount                                                     CFT014
085250200528     C                     SELEC                                          CFT014
085260200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
085270200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
085280200528     C                     MOVELSMAM      ##D,16                          CFT014
085290200528     C                     MOVE A6NBDP    ##D,16                          CFT014
085300200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
085310200528     C                     MOVELCQAM      ##D,16                          CFT014
085320200528     C                     MOVE A6NBDP    ##D,16                          CFT014
085330200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
085340200528      *                                                                   CFT014
085350200528      ** Calculate Debit currency equivalent                              CFT014
085360200528     C           MDIN      IFEQ 0                                         CFT014
085370200528     C                     MOVEL'D'       I#MDIN                          CFT014
085380200528     C                     ELSE                                           CFT014
085390200528     C                     MOVEL'M'       I#MDIN                          CFT014
085400200528     C                     ENDIF                                          CFT014
085410200528     C                     Z-ADDRATE      I#RATE                          CFT014
085420200528     C                     Z-ADDCQAM      D#FAMT                          CFT014
085430200528     C                     MOVELPCCY      D#FCCY                          CFT014
085440200528     C                     MOVELDRCY      D#TCCY                          CFT014
085450200528     C                     CALL 'AOCCYCV0'             9090               CFT014
085460200528     C                     PARM *BLANKS   PRTCD                           CFT014
085470200528     C                     PARM '*F*T*RAT'W0ACT                           CFT014
085480200528     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT014
085490200528     C           *IN90     IFEQ '1'                                       CFT014
085500200528     C           PRTCD     ORNE *BLANKS                                   CFT014
085510200528     C                     MOVEL'*CALL   'W0FILE                          CFT014
085520200528     C                     MOVEL'AOCCYCV0'W0KEY                           CFT014
085530200528     C                     Z-ADD41        W0ERNB                          CFT014
085540200528     C                     MOVEL'MEM5003' W0MSGD                          CFT014
085550200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
085560200528     C                     EXSR SRERR                                     CFT014
085570200528     C                     ENDIF                                          CFT014
085580200528      *                                                                   CFT014
085590200528     C                     Z-ADDD#TAMT    W#AMT  150                      CFT014
085600200528     C                     MOVELD#TAMT    ##D,16                          CFT014
085610200528     C                     MOVE A6NBDP    ##D,16                          CFT014
085620200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
085630200528     C                     MOVELTRNAMT    ##D,16                          CFT014
085640200528     C                     MOVE A6NBDP    ##D,16                          CFT014
085650200528     C                     Z-ADDA6NBDP    WTRFT   20                      CFT014
085660200528     C           ##FILE    WHEQ 'FT102H '                                 CFT014
085670200528     C                     MOVELCCTAMT    ##D,16                          CFT014
085680200528     C                     MOVE A6NBDP    ##D,16                          CFT014
085690200528     C                     Z-ADDA6NBDP    WTCCT   20                      CFT014
085700200528     C                     ENDSL                                          CFT014
085710200528      *                                                                   CFT014
085720200528      ** Set up Debit Date                                                CFT014
085730200528     C                     SELEC                                          CFT014
085740200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
085750200528     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
085760200528     C                     MOVELSLDT      ##D,17                          CFT014
085770200528     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
085780200528     C                     MOVELDRVD      ##D,17                          CFT014
085790200528     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
085800200528     C                     MOVELSLDT      ##D,17                          CFT014
085810200528     C           ##FILE    WHEQ 'FT101H '                                 CFT014
085820200528     C           ##FILE    OREQ 'FT102H '                                 CFT014
085830200528     C                     MOVELDBTVDT    ##D,17                          CFT014
085840200528     C                     ENDSL                                          CFT014
085850200528      *                                                                   CFT014
085860200528      ** Accumulate RDE's and associated data and output to               CFT014
085870200528      ** PF/CGUDTAPD.                                                     CFT014
085880200528     C                     EXSR SRADTA                                    CFT014
085890200528     C                     EXSR SRODTA                                    CFT014
085900200528      *                                                                   CFT014
085910200528      *................................................................   CFT014
085920200528      *                                                                   CFT014
085930200528     C           EXDRCR    TAG                                            CFT014
085940200528      *                                                                                       CCG015
085950200528     C                     EXSR POPGRS                                                        CCG015
085960200528      *                                                                   CFT014
085970200528      ** Unwind subroutine stack name                                     CFT014
085980200528     C                     MOVEA*BLANKS   @STK,Q                          CFT014
085990200528     C                     SUB  1         Q                               CFT014
086000200528      *                                                                   CFT014
086010200528     C                     ENDSR                                          CFT014
086020200528      *****************************************************************   CFT014
086030200528      /EJECT                                                              CFT014
086040200528      *****************************************************************   CFT014
086050200528      *                                                               *   CFT014
086060200528      *  SRSRCH - Extract Receiver's and Sender's charges.            *   CFT014
086070200528      *                                                               *   CFT014
086080200528      *  Called by   :  DRCR01, DRCR02                                *   CFT014
086090200528      *                                                               *   CFT014
086100200528      *  Calls       :  SRRRDE, SRCURR, EURAMT, SRADTA, SRODTA        *   CFT014
086110200528      *                                                               *   CFT014
086120200528      *****************************************************************   CFT014
086130200528     C           SRSRCH    BEGSR                                          CFT014
086140200528      *                                                                   CFT014
086150200528      ** Set up subroutine stack name                                     CFT014
086160200528     C                     ADD  1         Q                               CFT014
086170200528     C                     MOVEL'TRNCHG'  @STK,Q                          CFT014
086180200528      *                                                                   CFT014
086190200528      ** Retrieve subroutine specific data.                               CFT014
086200200528     C           1         OCUR ##SRDT                                    CFT014
086210200528     C                     MOVEL##SPAT    S#PATH                          CFT014
086220200528      *                                                                   CFT014
086230200528      ** Set up Path.                                                     CFT014
086240200528     C                     MOVEL'\TRNCHG' ##PNAM                          CFT014
086250200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
086260200528      *                                                                                       CCG015
086270200528     C                     EXSR PSHGRS                                                        CCG015
086280200528      *                                                                   CFT014
086290200528      ** Retrieve RDE information for RDEs in group set                   CFT014
086300200528     C                     MOVEL@STK,Q    ##GRPS                          CFT014
086310200528     C                     Z-ADD1         ##RDEN                          CFT014
086320200528     C                     EXSR SRRRDE                                    CFT014
086330200528      *                                                                   CFT014
086340200528      ** Receiver's Charge                                                CFT014
086350200528     C                     MOVE *BLANK    WRCHIN  1                       CFT014
086360200528     C                     Z-ADD0         WNBDP0  10                      CFT014
086370200528     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
086380200528     C           DTCH      ANDEQ'OUR'                                     CFT014
086390200528     C           OPRCRM    ANDNE0                                         CFT014
086400200528     C                     MOVE PCCY      P@CCY                           CFT014
086410200528     C                     EXSR SRCURR                                    CFT014
086420200528     C                     MOVELOPRCRM    ##D,1                           CFT014
086430200528     C                     MOVE A6NBDP    ##D,1                           CFT014
086440200528     C                     MOVE A6INCY    WRCHIN                          CFT014
086450200528     C                     Z-ADDA6NBDP    WNBDP0                          CFT014
086460200528     C                     ENDIF                                          CFT014
086470200528      *                                                                   CFT014
086480200528      ** Sender's Charges                                                 CFT014
086490200528     C                     MOVE *BLANK    WSC1IN  1                       CFT014
086500200528     C                     MOVE *BLANK    WSC2IN  1                       CFT014
086510200528     C                     MOVE *BLANK    WSC3IN  1                       CFT014
086520200528     C                     MOVE *BLANK    WSC4IN  1                       CFT014
086530200528     C                     MOVE *BLANK    WSC5IN  1                       CFT014
086540200528     C                     Z-ADD0         WNBDP1  10                      CFT014
086550200528     C                     Z-ADD0         WNBDP2  10                      CFT014
086560200528     C                     Z-ADD0         WNBDP3  10                      CFT014
086570200528     C                     Z-ADD0         WNBDP4  10                      CFT014
086580200528     C                     Z-ADD0         WNBDP5  10                      CFT014
086590200528      *                                                                   CFT014
086600200528     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
086610200528     C           DTCH      ANDEQ'BEN'                                     CFT014
086620200528     C           ##FILE    OREQ 'INPAY  '                                 CFT014
086630200528     C           DTCH      ANDEQ'SHA'                                     CFT014
086640200528      *                                                                   CFT014
086650200528     C           INSCY1    IFNE *BLANKS                                   CFT014
086660200528     C                     MOVE INSCY1    P@CCY                           CFT014
086670200528     C                     EXSR SRCURR                                    CFT014
086680200528     C                     MOVELINSCH1    ##D,2                           CFT014
086690200528     C                     MOVE A6NBDP    ##D,2                           CFT014
086700200528     C                     MOVELINSCY1    ##D,3                           CFT014
086710200528     C                     MOVE A6INCY    WSC1IN                          CFT014
086720200528     C                     Z-ADDA6NBDP    WNBDP1                          CFT014
086730200528     C                     ENDIF                                          CFT014
086740200528      *                                                                   CFT014
086750200528     C           INSCY2    IFNE *BLANKS                                   CFT014
086760200528     C                     MOVE INSCY2    P@CCY                           CFT014
086770200528     C                     EXSR SRCURR                                    CFT014
086780200528     C                     MOVELINSCH2    ##D,4                           CFT014
086790200528     C                     MOVE A6NBDP    ##D,4                           CFT014
086800200528     C                     MOVELINSCY2    ##D,5                           CFT014
086810200528     C                     MOVE A6INCY    WSC2IN                          CFT014
086820200528     C                     Z-ADDA6NBDP    WNBDP2                          CFT014
086830200528     C                     ENDIF                                          CFT014
086840200528      *                                                                   CFT014
086850200528     C           INSCY3    IFNE *BLANKS                                   CFT014
086860200528     C                     MOVE INSCY3    P@CCY                           CFT014
086870200528     C                     EXSR SRCURR                                    CFT014
086880200528     C                     MOVELINSCH3    ##D,6                           CFT014
086890200528     C                     MOVE A6NBDP    ##D,6                           CFT014
086900200528     C                     MOVELINSCY3    ##D,7                           CFT014
086910200528     C                     MOVE A6INCY    WSC3IN                          CFT014
086920200528     C                     Z-ADDA6NBDP    WNBDP3                          CFT014
086930200528     C                     ENDIF                                          CFT014
086940200528      *                                                                   CFT014
086950200528     C           INSCY4    IFNE *BLANKS                                   CFT014
086960200528     C                     MOVE INSCY4    P@CCY                           CFT014
086970200528     C                     EXSR SRCURR                                    CFT014
086980200528     C                     MOVELINSCH4    ##D,8                           CFT014
086990200528     C                     MOVE A6NBDP    ##D,8                           CFT014
087000200528     C                     MOVELINSCY4    ##D,9                           CFT014
087010200528     C                     MOVE A6INCY    WSC4IN                          CFT014
087020200528     C                     Z-ADDA6NBDP    WNBDP4                          CFT014
087030200528     C                     ENDIF                                          CFT014
087040200528      *                                                                   CFT014
087050200528     C           INSCY5    IFNE *BLANKS                                   CFT014
087060200528     C                     MOVE INSCY5    P@CCY                           CFT014
087070200528     C                     EXSR SRCURR                                    CFT014
087080200528     C                     MOVELINSCH5    ##D,10                          CFT014
087090200528     C                     MOVE A6NBDP    ##D,10                          CFT014
087100200528     C                     MOVELINSCY5    ##D,11                          CFT014
087110200528     C                     MOVE A6INCY    WSC5IN                          CFT014
087120200528     C                     Z-ADDA6NBDP    WNBDP5                          CFT014
087130200528     C                     ENDIF                                          CFT014
087140200528      *                                                                   CFT014
087150200528     C                     ENDIF                                          CFT014
087160200528      *                                                                   CFT014
087170200528      ** Receiver's Charges from Receiver's Charges ccy to Euro.          CFT014
087180200528      *                                                                   CFT014
087190200528     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
087200200528     C           DTCH      ANDEQ'OUR'                                     CFT014
087210200528     C           WRCHIN    ANDEQ'Y'                                       CFT014
087220200528     C                     CLEARP#0010                                    CFT014
087230200528     C                     MOVE PCCY      P#FRCY                          CFT014
087240200528     C                     Z-ADDOPRCRM    P#FRAM                          CFT014
087250200528     C                     MOVE BKEURO    #CCY                            CFT014
087260200528     C                     EXSR EURAMT                                    CFT014
087270200528     C                     MOVELW#TOAM    ##D,12                          CFT014
087280200528     C                     MOVE WNBDP0    ##D,12                          CFT014
087290200528     C                     ENDIF                                          CFT014
087300200528      *                                                                   CFT014
087310200528      ** Sender's Charges from Sender's Charges ccy to Euro.              CFT014
087320200528      *                                                                   CFT014
087330200528     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
087340200528     C           DTCH      ANDEQ'BEN'                                     CFT014
087350200528     C           ##FILE    OREQ 'INPAY  '                                 CFT014
087360200528     C           DTCH      ANDEQ'SHA'                                     CFT014
087370200528      *                                                                   CFT014
087380200528     C           INSCY1    IFNE *BLANKS                                   CFT014
087390200528     C           WSC1IN    ANDEQ'Y'                                       CFT014
087400200528     C                     CLEARP#0010                                    CFT014
087410200528     C                     MOVE INSCY1    P#FRCY                          CFT014
087420200528     C                     Z-ADDINSCH1    P#FRAM                          CFT014
087430200528     C                     MOVE BKEURO    #CCY                            CFT014
087440200528     C                     EXSR EURAMT                                    CFT014
087450200528     C                     MOVELW#TOAM    ##D,13                          CFT014
087460200528     C                     MOVE WNBDP1    ##D,13                          CFT014
087470200528     C                     ENDIF                                          CFT014
087480200528      *                                                                   CFT014
087490200528     C           INSCY2    IFNE *BLANKS                                   CFT014
087500200528     C           WSC2IN    ANDEQ'Y'                                       CFT014
087510200528     C                     CLEARP#0010                                    CFT014
087520200528     C                     MOVE INSCY2    P#FRCY                          CFT014
087530200528     C                     Z-ADDINSCH2    P#FRAM                          CFT014
087540200528     C                     MOVE BKEURO    #CCY                            CFT014
087550200528     C                     EXSR EURAMT                                    CFT014
087560200528     C                     MOVELW#TOAM    ##D,14                          CFT014
087570200528     C                     MOVE WNBDP2    ##D,14                          CFT014
087580200528     C                     ENDIF                                          CFT014
087590200528      *                                                                   CFT014
087600200528     C           INSCY3    IFNE *BLANKS                                   CFT014
087610200528     C           WSC3IN    ANDEQ'Y'                                       CFT014
087620200528     C                     CLEARP#0010                                    CFT014
087630200528     C                     MOVE INSCY3    P#FRCY                          CFT014
087640200528     C                     Z-ADDINSCH3    P#FRAM                          CFT014
087650200528     C                     MOVE BKEURO    #CCY                            CFT014
087660200528     C                     EXSR EURAMT                                    CFT014
087670200528     C                     MOVELW#TOAM    ##D,15                          CFT014
087680200528     C                     MOVE WNBDP3    ##D,15                          CFT014
087690200528     C                     ENDIF                                          CFT014
087700200528      *                                                                   CFT014
087710200528     C           INSCY4    IFNE *BLANKS                                   CFT014
087720200528     C           WSC4IN    ANDEQ'Y'                                       CFT014
087730200528     C                     CLEARP#0010                                    CFT014
087740200528     C                     MOVE INSCY4    P#FRCY                          CFT014
087750200528     C                     Z-ADDINSCH4    P#FRAM                          CFT014
087760200528     C                     MOVE BKEURO    #CCY                            CFT014
087770200528     C                     EXSR EURAMT                                    CFT014
087780200528     C                     MOVELW#TOAM    ##D,16                          CFT014
087790200528     C                     MOVE WNBDP4    ##D,16                          CFT014
087800200528     C                     ENDIF                                          CFT014
087810200528      *                                                                   CFT014
087820200528     C           INSCY5    IFNE *BLANKS                                   CFT014
087830200528     C           WSC5IN    ANDEQ'Y'                                       CFT014
087840200528     C                     CLEARP#0010                                    CFT014
087850200528     C                     MOVE INSCY5    P#FRCY                          CFT014
087860200528     C                     Z-ADDINSCH5    P#FRAM                          CFT014
087870200528     C                     MOVE BKEURO    #CCY                            CFT014
087880200528     C                     EXSR EURAMT                                    CFT014
087890200528     C                     MOVELW#TOAM    ##D,17                          CFT014
087900200528     C                     MOVE WNBDP5    ##D,17                          CFT014
087910200528     C                     ENDIF                                          CFT014
087920200528      *                                                                   CFT014
087930200528     C                     ENDIF                                          CFT014
087940200528      *                                                                   CFT014
087950200528      ** Accumulate RDE's and associated data and output to               CFT014
087960200528      ** PF/CGUDTAPD.                                                     CFT014
087970200528     C                     EXSR SRADTA                                    CFT014
087980200528     C                     EXSR SRODTA                                    CFT014
087990200528      *                                                                   CFT014
088000200528      **...............................................................   CFT014
088010200528      *                                                                   CFT014
088020200528     C           EXSRCH    TAG                                            CFT014
088030200528      *                                                                                       CCG015
088040200528     C                     EXSR POPGRS                                                        CCG015
088050200528      *                                                                   CFT014
088060200528      ** Unwind subroutine stack name                                     CFT014
088070200528     C                     MOVEA*BLANKS   @STK,Q                          CFT014
088080200528     C                     SUB  1         Q                               CFT014
088090200528      *                                                                   CFT014
088100200528     C                     ENDSR                                          CFT014
088110200528      *****************************************************************   CFT014
088120200528      /EJECT                                                              CFT014
088130200528      *****************************************************************   CFT014
088140200528      *                                                               *   CFT014
088150200528      *  SRTRIB - Extract Third Reimbursement Institution.            *   CFT014
088160200528      *                                                               *   CFT014
088170200528      *  Called by   :  DRCR01, DRCR02                                *   CFT014
088180200528      *  Calls       :  SRRRDE, SRTPSR, CORDTA, SRADTA, SRODTA        *   CFT014
088190200528      *                                                               *   CFT014
088200200528      *****************************************************************   CFT014
088210200528     C           SRTRIB    BEGSR                                          CFT014
088220200528      *                                                                   CFT014
088230200528      ** Set up subroutine stack name                                     CFT014
088240200528     C                     ADD  1         Q                               CFT014
088250200528     C                     MOVEL'T_REIM'  @STK,Q                          CFT014
088260200528      *                                                                   CFT014
088270200528      ** Retrieve subroutine specific data.                               CFT014
088280200528     C           1         OCUR ##SRDT                                    CFT014
088290200528     C                     MOVEL##SPAT    S#PATH                          CFT014
088300200528      *                                                                   CFT014
088310200528      ** Set up Path.                                                     CFT014
088320200528     C                     MOVEL'\T_REIM' ##PNAM                          CFT014
088330200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
088340200528      *                                                                                       CCG015
088350200528     C                     EXSR PSHGRS                                                        CCG015
088360200528      *                                                                   CFT014
088370200528      ** Retrieve RDE information for RDEs in group set                   CFT014
088380200528     C                     MOVEL'CORDTA'  ##GRPS                          CFT014
088390200528     C                     Z-ADD1         ##RDEN                          CFT014
088400200528     C                     EXSR SRRRDE                                    CFT014
088410200528      *                                                                   CFT014
088420200528     C                     SELEC                                          CFT014
088430200528     C           ##FILE    WHEQ 'INPAY   '                                CFT014
088440200528     C                     MOVELINTRIT    WTYPE                           CFT014
088450200528     C                     MOVELINTRIB    WPTY                            CFT014
088460200528     C                     MOVELINTRIB    WPTY1                           CFT014
088470200528     C                     MOVEL*BLANKS   WBRCA                           CFT014
088480200528      *                                                                   CFT014
088490200528     C           ##FILE    WHEQ 'OTPAY   '                                CFT014
088500200528     C                     MOVELOPTRIT    WTYPE                           CFT014
088510200528     C                     MOVELOPTRI1    WPTY                            CFT014
088520200528     C                     MOVELOPTRI1    WPTY1                           CFT014
088530200528     C                     MOVELOPTRI2    WPTY2                           CFT014
088540200528     C                     MOVEL*BLANKS   WBRCA                           CFT014
088550200528     C                     ENDSL                                          CFT014
088560200528      *                                                                   CFT014
088570200528     C                     EXSR SRTPSR                                    CFT014
088580200528      *                                                                   CFT014
088590200528     C                     MOVEL*BLANKS   W#ADDR                          CFT014
088600200528     C                     SELEC                                          CFT014
088610200528      *                                                                   CFT014
088620200528     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
088630200528     C                     MOVELINTRIT    #TYPE                           CFT014
088640200528     C                     MOVELCNA1      W#ADD1                          CFT014
088650200528     C                     MOVELCNA2      W#ADD2                          CFT014
088660200528     C                     MOVELCNA3      W#ADD3                          CFT014
088670200528     C                     MOVELCNA4      W#ADD4                          CFT014
088680200528     C                     MOVEL*BLANKS   W#ADD5                          CFT014
088690200528      *                                                                   CFT014
088700200528     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
088710200528     C                     MOVELOPTRIT    #TYPE                           CFT014
088720200528     C           OPTRIT    IFEQ 'A'                                       CFT014
088730200528     C                     MOVELOPTRI1    W#ADD1                          CFT014
088740200528     C                     MOVELOPTRI2    W#ADD2                          CFT014
088750200528     C                     MOVELOPTRI3    W#ADD3                          CFT014
088760200528     C                     MOVELOPTRI4    W#ADD4                          CFT014
088770200528     C                     MOVELOPTRI5    W#ADD5                          CFT014
088780200528     C                     ELSE                                           CFT014
088790200528     C                     MOVELCNA1      W#ADD1                          CFT014
088800200528     C                     MOVELCNA2      W#ADD2                          CFT014
088810200528     C                     MOVELCNA3      W#ADD3                          CFT014
088820200528     C                     MOVELCNA4      W#ADD4                          CFT014
088830200528     C                     MOVEL*BLANKS   W#ADD5                          CFT014
088840200528     C                     ENDIF                                          CFT014
088850200528      *                                                                   CFT014
088860200528     C                     ENDSL                                          CFT014
088870200528      *                                                                   CFT014
088880200528     C                     EXSR CORDTA                                    CFT014
088890200528      *                                                                   CFT014
088900200528      **  Accumulate RDE's and associated data and output to              CFT014
088910200528      **  PF/CGUDTAPD.                                                    CFT014
088920200528      *                                                                   CFT014
088930200528     C                     EXSR SRADTA                                    CFT014
088940200528     C                     EXSR SRODTA                                    CFT014
088950200528      *                                                                                       CCG015
088960200528     C                     EXSR POPGRS                                                        CCG015
088970200528      *                                                                   CFT014
088980200528      *................................................................   CFT014
088990200528      **  Unwind subroutine stack name                                    CFT014
089000200528      *                                                                   CFT014
089010200528     C                     MOVEA*BLANKS   @STK,Q                          CFT014
089020200528     C                     SUB  1         Q                               CFT014
089030200528      *                                                                   CFT014
089040200528     C                     ENDSR                                          CFT014
089050200528      *****************************************************************   CFT014
089060200528      /EJECT                                                              CFT014
089070200528      *****************************************************************   CFT014
089080200528      *                                                               *   CFT014
089090200528      *  SRCURR - Retrieve currency details.                          *   CFT014
089100200528      *                                                               *   CFT014
089110200528      *  Called by: Any routine.                                      *   CFT014
089120200528      *  Calls: AOCURRR0                                              *   CFT014
089130200528      *                                                               *   CFT014
089140200528      *****************************************************************   CFT014
089150200528     C           SRCURR    BEGSR                                          CFT014
089160200528      *                                                                   CFT014
089170200528     C                     CALL 'AOCURRR0'                                CFT014
089180200528     C                     PARM *BLANKS   PRTCD                           CFT014
089190200528     C                     PARM '*KEY   ' POPTN                           CFT014
089200200528     C                     PARM           P@CCY   3                       CFT014
089210200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
089220200528     C           PRTCD     IFNE *BLANKS                                   CFT014
089230200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
089240200528     C                     MOVELP@CCY     W0KEY                           CFT014
089250200528     C                     Z-ADD36        W0ERNB                          CFT014
089260200528     C                     MOVEL'MEM5004' W0MSGD                          CFT014
089270200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
089280200528     C                     EXSR SRERR                                     CFT014
089290200528     C                     ENDIF                                          CFT014
089300200528      *                                                                   CFT014
089310200528     C                     ENDSR                                          CFT014
089320200528      *****************************************************************   CFT014
089330200528      /EJECT                                                              CFT014
089340200528      *****************************************************************   CFT014
089350200528      /SPACE 5                                                            CFT009
089360200528      *****************************************************************   CFT009
089370200528      * Subroutine  :  INFEES                                         *   CFT009
089380200528      * Function    :  Fees & Charges Information                     *   CFT009
089390200528      *                                                               *   CFT009
089400200528      * Called by   :  DRCR01                                         *   CFT009
089410200528      * Calls       :                                                 *   CFT009
089420200528      *****************************************************************   CFT009
089430200528     C           INFEES    BEGSR                                          CFT009
089440200528      *                                                                   CFT009
089450200528      **  Set up subroutine stack name                                    CFT009
089460200528     C                     ADD  1         Q                               CFT009
089470200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
089480200528      *                                                                   CFT009
089490200528      *................................................................   CFT009
089500200528      *                                                                   CFT009
089510200528      **  Retrieve subroutine specific data.                              CFT009
089520200528     C           1         OCUR ##SRDT                                    CFT009
089530200528     C                     MOVEL##SPAT    S#PATH                          CFT009
089540200528      *                                                                   CFT009
089550200528      **  Set up Path.                                                    CFT009
089560200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
089570200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
089580200528      *                                                                                       CCG015
089590200528     C                     EXSR PSHGRS                                                        CCG015
089600200528      *                                                                   CFT009
089610200528      **  Retrieve RDE information for RDEs in group set                  CFT009
089620200528      *                                                                   CFT009
089630200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
089640200528     C                     Z-ADD1         ##RDEN                          CFT009
089650200528     C                     EXSR SRRRDE                                    CFT009
089660200528      *                                                                   CFT009
089670200528     C                     MOVEL'Y'       ##D,1                           CFT009
089680200528      *                                                                   CFT009
089690200528      ** Charge code                                                      CFT009
089700200528      *                                                                   CFT009
089710200528     C                     MOVELTFCCCO    ##D,13                          CFT009
089720200528     C                     MOVELFXCHEC    ##D,14                          CFT009
089730200528     C                     MOVELCHCHCD    ##D,3                           CFT009
089740200528     C                     MOVELADCHCD    ##D,15                          CFT009
089750200528     C                     MOVELTLCODE    ##D,2                           CFT009
089760200528     C                     MOVELTLCHCD    ##D,16                          CFT009
089770200528     C                     MOVELMISCH     ##D,7                           CFT009
089780200528     C                     MOVELMSCH1     ##D,8                           CFT009
089790200528     C                     MOVELMSCH2     ##D,9                           CFT009
089800200528     C                     MOVELMSCH3     ##D,10                          CFT009
089810200528     C                     MOVELMSCH4     ##D,11                          CFT009
089820200528     C                     MOVELMSCH5     ##D,12                          CFT009
089830200528      *                                                                   CFT009
089840200528     C           CFT10     IFEQ 'Y'                                       CFT009
089850200528     C                     MOVEL'Y'       ##D,18                          CFT009
089860200528     C                     ENDIF                                          CFT009
089870200528      *                                                                   CFT009
089880200528      ** FX Spread Set                                                    CFT009
089890200528      *                                                                   CFT009
089900200528     C                     MOVELFXSPSC    ##D,19                          CFT009
089910200528      *                                                                   CFT009
089920200528      **  Accumulate RDE's and associated data and output to              CFT009
089930200528      **  PF/CGUDTAPD.                                                    CFT009
089940200528      *                                                                   CFT009
089950200528     C                     EXSR SRADTA                                    CFT009
089960200528     C                     EXSR SRODTA                                    CFT009
089970200528      *                                                                                       CCG015
089980200528     C                     EXSR POPGRS                                                        CCG015
089990200528      *                                                                   CFT009
090000200528      *................................................................   CFT009
090010200528      **  Unwind subroutine stack name                                    CFT009
090020200528      *                                                                   CFT009
090030200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
090040200528     C                     SUB  1         Q                               CFT009
090050200528      *                                                                   CFT009
090060200528     C                     ENDSR                                          CFT009
090070200528      /SPACE 5                                                            CFT009
090080200528      *****************************************************************   CFT009
090090200528      * Subroutine  :  INENTC                                         *   CFT009
090100200528      * Function    :  Entered Charges                                *   CFT009
090110200528      *                                                               *   CFT009
090120200528      * Called by   :  DRCR01                                         *   CFT009
090130200528      * Calls       :                                                 *   CFT009
090140200528      *****************************************************************   CFT009
090150200528     C           INENTC    BEGSR                                          CFT009
090160200528      *                                                                   CFT009
090170200528      **  Set up subroutine stack name                                    CFT009
090180200528     C                     ADD  1         Q                               CFT009
090190200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
090200200528      *                                                                   CFT009
090210200528      *................................................................   CFT009
090220200528      *                                                                   CFT009
090230200528      **  Retrieve subroutine specific data.                              CFT009
090240200528     C           1         OCUR ##SRDT                                    CFT009
090250200528     C                     MOVEL##SPAT    S#PATH                          CFT009
090260200528      *                                                                   CFT009
090270200528      **  Set up Path.                                                    CFT009
090280200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
090290200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
090300200528      *                                                                                       CCG015
090310200528     C                     EXSR PSHGRS                                                        CCG015
090320200528      *                                                                   CFT009
090330200528      **  Retrieve RDE information for RDEs in group set                  CFT009
090340200528      *                                                                   CFT009
090350200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
090360200528     C                     Z-ADD1         ##RDEN                          CFT009
090370200528     C                     EXSR SRRRDE                                    CFT009
090380200528      *                                                                   CFT009
090390200528     C           ADDC      IFEQ 'A'                                       CFT009
090400200528     C                     MOVELSMCY      ##WCCY  3                       CFT009
090410200528     C                     ELSE                                           CFT009
090420200528     C                     MOVELPCCY      ##WCCY                          CFT009
090430200528     C                     ENDIF                                          CFT009
090440200528      *                                                                                    AR1082119
090450200528      **  Get Charge Currency                                                              AR1082119
090460200528      *                                                                                    AR1082119
090470200528     C                     EXSR SR#CCY                                                     AR1082119
090480200528      *                                                                   CFT009
090490200528      **  Charge currency                                                 CFT009
090500200528     C                     MOVEL##WCCY    ##D,1                           CFT009
090510200528      *                                                                   CFT009
090520200528      **  Obtain currency details                                         CFT009
090530200528     C                     CALL 'AOCURRR0'                                CFT009
090540200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
090550200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
090560200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
090570200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
090580200528      *                                                                   CFT009
090590200528      ** DATABASE ERROR                                                   CFT009
090600200528      *                                                                   CFT009
090610200528     C           @RTCD     IFNE *BLANK                                    CFT009
090620200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
090630200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
090640200528     C                     Z-ADD44        W0ERNB           * DB ERROR 44 *CFT009
090650200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
090660200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
090670200528     C                     EXSR SRERR                                     CFT009
090680200528     C                     ENDIF                                          CFT009
090690200528      *                                                                   CFT009
090700200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
090710200528      *                                                                   CFT009
090720200528      ** Amount                                                           CFT009
090730200528      *                                                                   CFT009
090740200528     C                     MOVELTXCH      ##D,4                           CFT009
090750200528     C                     MOVE A6NBDP    ##D,4                           CFT009
090760200528     C                     MOVELADCH      ##D,10                          CFT009
090770200528     C                     MOVE A6NBDP    ##D,10                          CFT009
090780200528     C                     MOVELTRCM      ##D,2                           CFT009
090790200528     C                     MOVE A6NBDP    ##D,2                           CFT009
090800200528     C                     MOVELINCHCM    ##D,3                           CFT009
090810200528     C                     MOVE A6NBDP    ##D,3                           CFT009
090820200528     C                     MOVELCQCH      ##D,5                           CFT009
090830200528     C                     MOVE A6NBDP    ##D,5                           CFT009
090840200528     C                     MOVELTLCH      ##D,9                           CFT009
090850200528     C                     MOVE A6NBDP    ##D,9                           CFT009
090860200528     C                     MOVELMSCH      ##D,11                          CFT009
090870200528     C                     MOVE A6NBDP    ##D,11                          CFT009
090880200528     C                     MOVELMSC01     ##D,17                          CFT009
090890200528     C                     MOVE A6NBDP    ##D,17                          CFT009
090900200528     C                     MOVELMSC02     ##D,18                          CFT009
090910200528     C                     MOVE A6NBDP    ##D,18                          CFT009
090920200528     C                     MOVELMSC03     ##D,19                          CFT009
090930200528     C                     MOVE A6NBDP    ##D,19                          CFT009
090940200528     C                     MOVELMSC04     ##D,20                          CFT009
090950200528     C                     MOVE A6NBDP    ##D,20                          CFT009
090960200528      *                                                                   CFT009
090970200528      **  Accumulate RDE's and associated data and output to              CFT009
090980200528      **  PF/CGUDTAPD.                                                    CFT009
090990200528      *                                                                   CFT009
091000200528     C                     EXSR SRADTA                                    CFT009
091010200528     C                     MOVEL##SDS     ##ADS                           CFT009
091020200528      *                                                                   CFT009
091030200528      **  Retrieve RDE information for RDEs in group set                  CFT009
091040200528      *                                                                   CFT009
091050200528     C                     Z-ADD21        ##RDEN                          CFT009
091060200528     C                     EXSR SRRRDE                                    CFT009
091070200528     C                     MOVELMSC05     ##D,1                           CFT009
091080200528     C                     MOVE A6NBDP    ##D,1                           CFT009
091090200528      *                                                                   CFT009
091100200528      **  Accumulate RDE's and associated data and output to              CFT009
091110200528      **  PF/CGUDTAPD.                                                    CFT009
091120200528     C                     EXSR SRADTA                                    CFT009
091130200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
091140200528      *                                                                   CFT009
091150200528      **  Initialise Write Format Parameter.                              CFT009
091160200528     C                     CLEARW0FMT                                     CFT009
091170200528      *                                                                   CFT009
091180200528      **  Set up Control Information.                                     CFT009
091190200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
091200200528     C                     ADD  1         ##OSEQ                          CFT009
091210200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
091220200528     C                     Z-ADD1         DEPBIN                          CFT009
091230200528     C                     Z-ADD1         DETBIN                          CFT009
091240200528     C                     MOVE 'FR'      DEFSLI                          CFT009
091250200528     C                     MOVE *BLANKS   W0PATH                          CFT009
091260200528     C                     MOVELS#PATH    W0PATH                          CFT009
091270200528      *                                                                   CFT009
091280200528      **  Append Data from pack routine.                                  CFT009
091290200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
091300200528     C                     EXSR SRODTA                                    CFT009
091310200528      *                                                                   CFT009
091320200528      ** Totals                                                           CFT009
091330200528      *                                                                   CFT009
091340200528     C           TRCM      ADD  INCHCM    SUMAMT 150                      CFT009
091350200528     C                     ADD  CQCH      SUMAMT                          CFT009
091360200528     C                     ADD  ADCH      SUMAMT                          CFT009
091370200528     C                     ADD  TXCH      SUMAMT                          CFT009
091380200528     C                     ADD  TLCH      SUMAMT                          CFT009
091390200528     C                     ADD  MSCH      SUMAMT                          CFT009
091400200528     C                     ADD  MSC01     SUMAMT                          CFT009
091410200528     C                     ADD  MSC02     SUMAMT                          CFT009
091420200528     C                     ADD  MSC03     SUMAMT                          CFT009
091430200528     C                     ADD  MSC04     SUMAMT                          CFT009
091440200528     C                     ADD  MSC05     SUMAMT                          CFT009
091450200528      *                                                                                       CCG015
091460200528     C                     EXSR POPGRS                                                        CCG015
091470200528      *                                                                   CFT009
091480200528      *................................................................   CFT009
091490200528      **  Unwind subroutine stack name                                    CFT009
091500200528      *                                                                   CFT009
091510200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
091520200528     C                     SUB  1         Q                               CFT009
091530200528      *                                                                   CFT009
091540200528     C                     ENDSR                                          CFT009
091550200528      /SPACE 5                                                            CFT009
091560200528      *****************************************************************   CFT009
091570200528      * Subroutine  :  INVATA                                         *   CFT009
091580200528      * Function    :  Entered Charges VAT                            *   CFT009
091590200528      *                                                               *   CFT009
091600200528      * Called by   :  DRCR01                                         *   CFT009
091610200528      * Calls       :                                                 *   CFT009
091620200528      *****************************************************************   CFT009
091630200528     C           INVATA    BEGSR                                          CFT009
091640200528      *                                                                   CFT009
091650200528      **  Set up subroutine stack name                                    CFT009
091660200528     C                     ADD  1         Q                               CFT009
091670200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
091680200528      *                                                                   CFT009
091690200528      *................................................................   CFT009
091700200528      *                                                                   CFT009
091710200528      **  Retrieve subroutine specific data.                              CFT009
091720200528     C           1         OCUR ##SRDT                                    CFT009
091730200528     C                     MOVEL##SPAT    S#PATH                          CFT009
091740200528      *                                                                   CFT009
091750200528      **  Set up Path.                                                    CFT009
091760200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
091770200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
091780200528      *                                                                                       CCG015
091790200528     C                     EXSR PSHGRS                                                        CCG015
091800200528      *                                                                   CFT009
091810200528      **  Retrieve RDE information for RDEs in group set                  CFT009
091820200528      *                                                                   CFT009
091830200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
091840200528     C                     Z-ADD1         ##RDEN                          CFT009
091850200528     C                     EXSR SRRRDE                                    CFT009
091860200528      *                                                                   CFT009
091870200528     C                     Z-ADD0         SUMVAT                          CFT009
091880200528      *                                                                   CFT009
091890200528     C           CFT10     IFEQ 'Y'                                       CFT009
091900200528     C           INVAT2    IFEQ 'Y'                                       CFT009
091910200528     C           INVATR    MULT TXCH      VAT       H                     CFT009
091920200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
091930200528     C                     ELSE                                           CFT009
091940200528     C                     Z-ADD0         SUMVAT                          CFT009
091950200528     C                     Z-ADD0         VAT                             CFT009
091960200528     C                     ENDIF                                          CFT009
091970200528      *                                                                   CFT009
091980200528     C                     MOVELVAT       ##D,1                           CFT009
091990200528     C                     MOVE A6NBDP    ##D,1                           CFT009
092000200528      *                                                                   CFT009
092010200528     C           INVAT3    IFEQ 'Y'                                       CFT009
092020200528     C           INVATR    MULT CQCH      VAT       H                     CFT009
092030200528     C                     ELSE                                           CFT009
092040200528     C                     Z-ADD0         VAT                             CFT009
092050200528     C                     ENDIF                                          CFT009
092060200528      *                                                                   CFT009
092070200528     C                     ADD  VAT       SUMVAT                          CFT009
092080200528     C                     MOVELVAT       ##D,2                           CFT009
092090200528     C                     MOVE A6NBDP    ##D,2                           CFT009
092100200528      *                                                                   CFT009
092110200528     C           INVAT1    IFEQ 'Y'                                       CFT009
092120200528     C           INVATR    MULT TRCM      VAT    150H                     CFT009
092130200528     C                     ELSE                                           CFT009
092140200528     C                     Z-ADD0         VAT                             CFT009
092150200528     C                     ENDIF                                          CFT009
092160200528      *                                                                   CFT009
092170200528     C                     ADD  VAT       SUMVAT                          CFT009
092180200528     C                     MOVELVAT       ##D,12                          CFT009
092190200528     C                     MOVE A6NBDP    ##D,12                          CFT009
092200200528      *                                                                   CFT009
092210200528     C           INVAT7    IFEQ 'Y'                                       CFT009
092220200528     C           INVATR    MULT INCHCM    VAT       H                     CFT009
092230200528     C                     ELSE                                           CFT009
092240200528     C                     Z-ADD0         VAT                             CFT009
092250200528     C                     ENDIF                                          CFT009
092260200528      *                                                                   CFT009
092270200528     C                     ADD  VAT       SUMVAT                          CFT009
092280200528     C                     MOVELVAT       ##D,13                          CFT009
092290200528     C                     MOVE A6NBDP    ##D,13                          CFT009
092300200528      *                                                                   CFT009
092310200528     C           INVAT4    IFEQ 'Y'                                       CFT009
092320200528     C           INVATR    MULT ADCH      VAT       H                     CFT009
092330200528     C                     ELSE                                           CFT009
092340200528     C                     Z-ADD0         VAT                             CFT009
092350200528     C                     ENDIF                                          CFT009
092360200528      *                                                                   CFT009
092370200528     C                     ADD  VAT       SUMVAT                          CFT009
092380200528     C                     MOVELVAT       ##D,14                          CFT009
092390200528     C                     MOVE A6NBDP    ##D,14                          CFT009
092400200528      *                                                                   CFT009
092410200528     C           INVAT5    IFEQ 'Y'                                       CFT009
092420200528     C           INVATR    MULT TLCH      VAT       H                     CFT009
092430200528     C                     ELSE                                           CFT009
092440200528     C                     Z-ADD0         VAT                             CFT009
092450200528     C                     ENDIF                                          CFT009
092460200528      *                                                                   CFT009
092470200528     C                     ADD  VAT       SUMVAT                          CFT009
092480200528     C                     MOVELVAT       ##D,15                          CFT009
092490200528     C                     MOVE A6NBDP    ##D,15                          CFT009
092500200528      *                                                                   CFT009
092510200528     C           INVAT6    IFEQ 'Y'                                       CFT009
092520200528     C           INVATR    MULT MSCH      VAT       H                     CFT009
092530200528     C                     ELSE                                           CFT009
092540200528     C                     Z-ADD0         VAT                             CFT009
092550200528     C                     ENDIF                                          CFT009
092560200528      *                                                                   CFT009
092570200528     C                     ADD  VAT       SUMVAT                          CFT009
092580200528     C                     MOVELVAT       ##D,6                           CFT009
092590200528     C                     MOVE A6NBDP    ##D,6                           CFT009
092600200528      *                                                                   CFT009
092610200528     C           VTMIC1    IFEQ 'Y'                                       CFT009
092620200528     C           INVATR    MULT MSC01     VAT       H                     CFT009
092630200528     C                     ELSE                                           CFT009
092640200528     C                     Z-ADD0         VAT                             CFT009
092650200528     C                     ENDIF                                          CFT009
092660200528      *                                                                   CFT009
092670200528     C                     ADD  VAT       SUMVAT                          CFT009
092680200528     C                     MOVELVAT       ##D,7                           CFT009
092690200528     C                     MOVE A6NBDP    ##D,7                           CFT009
092700200528      *                                                                   CFT009
092710200528     C           VTMIC2    IFEQ 'Y'                                       CFT009
092720200528     C           INVATR    MULT MSC02     VAT       H                     CFT009
092730200528     C                     ELSE                                           CFT009
092740200528     C                     Z-ADD0         VAT                             CFT009
092750200528     C                     ENDIF                                          CFT009
092760200528      *                                                                   CFT009
092770200528     C                     ADD  VAT       SUMVAT                          CFT009
092780200528     C                     MOVELVAT       ##D,8                           CFT009
092790200528     C                     MOVE A6NBDP    ##D,8                           CFT009
092800200528      *                                                                   CFT009
092810200528     C           VTMIC3    IFEQ 'Y'                                       CFT009
092820200528     C           INVATR    MULT MSC03     VAT       H                     CFT009
092830200528     C                     ELSE                                           CFT009
092840200528     C                     Z-ADD0         VAT                             CFT009
092850200528     C                     ENDIF                                          CFT009
092860200528      *                                                                   CFT009
092870200528     C                     ADD  VAT       SUMVAT                          CFT009
092880200528     C                     MOVELVAT       ##D,9                           CFT009
092890200528     C                     MOVE A6NBDP    ##D,9                           CFT009
092900200528      *                                                                   CFT009
092910200528     C           VTMIC4    IFEQ 'Y'                                       CFT009
092920200528     C           INVATR    MULT MSC04     VAT       H                     CFT009
092930200528     C                     ELSE                                           CFT009
092940200528     C                     Z-ADD0         VAT                             CFT009
092950200528     C                     ENDIF                                          CFT009
092960200528      *                                                                   CFT009
092970200528     C                     ADD  VAT       SUMVAT                          CFT009
092980200528     C                     MOVELVAT       ##D,10                          CFT009
092990200528     C                     MOVE A6NBDP    ##D,10                          CFT009
093000200528      *                                                                   CFT009
093010200528     C           VTMIC5    IFEQ 'Y'                                       CFT009
093020200528     C           INVATR    MULT MSC05     VAT       H                     CFT009
093030200528     C                     ELSE                                           CFT009
093040200528     C                     Z-ADD0         VAT                             CFT009
093050200528     C                     ENDIF                                          CFT009
093060200528      *                                                                   CFT009
093070200528     C                     ADD  VAT       SUMVAT                          CFT009
093080200528     C                     MOVELVAT       ##D,11                          CFT009
093090200528     C                     MOVE A6NBDP    ##D,11                          CFT009
093100200528      *                                                                   CFT009
093110200528     C                     ENDIF                                          CFT009
093120200528      *                                                                   CFT009
093130200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
093140200528     C                     MOVELSUMCHG    ##D,17                          CFT009
093150200528     C                     MOVE A6NBDP    ##D,17                          CFT009
093160200528      *                                                                   CFT009
093170200528      **  Accumulate RDE's and associated data and output to              CFT009
093180200528      **  PF/CGUDTAPD.                                                    CFT009
093190200528     C                     EXSR SRADTA                                    CFT009
093200200528     C                     EXSR SRODTA                                    CFT009
093210200528      *                                                                                       CCG015
093220200528     C                     EXSR POPGRS                                                        CCG015
093230200528      *                                                                   CFT009
093240200528      *................................................................   CFT009
093250200528      **  Unwind subroutine stack name                                    CFT009
093260200528      *                                                                   CFT009
093270200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
093280200528     C                     SUB  1         Q                               CFT009
093290200528      *                                                                   CFT009
093300200528     C                     ENDSR                                          CFT009
093310200528      /SPACE 5                                                            CFT009
093320200528      *****************************************************************   CFT009
093330200528      * Subroutine  :  INEURC                                         *   CFT009
093340200528      * Function    :  Euro charges                                   *   CFT009
093350200528      *                                                               *   CFT009
093360200528      * Called by   :  DRCR01                                         *   CFT009
093370200528      * Calls       :                                                 *   CFT009
093380200528      *****************************************************************   CFT009
093390200528     C           INEURC    BEGSR                                          CFT009
093400200528      *                                                                   CFT009
093410200528      **  Set up subroutine stack name                                    CFT009
093420200528     C                     ADD  1         Q                               CFT009
093430200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
093440200528      *                                                                   CFT009
093450200528      *................................................................   CFT009
093460200528      *                                                                   CFT009
093470200528      **  Retrieve subroutine specific data.                              CFT009
093480200528     C           1         OCUR ##SRDT                                    CFT009
093490200528     C                     MOVEL##SPAT    S#PATH                          CFT009
093500200528      *                                                                   CFT009
093510200528      **  Set up Path.                                                    CFT009
093520200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
093530200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
093540200528      *                                                                                       CCG015
093550200528     C                     EXSR PSHGRS                                                        CCG015
093560200528      *                                                                   CFT009
093570200528      **  Retrieve RDE information for RDEs in group set                  CFT009
093580200528      *                                                                   CFT009
093590200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
093600200528     C                     Z-ADD1         ##RDEN                          CFT009
093610200528     C                     EXSR SRRRDE                                    CFT009
093620200528      *                                                                   CFT009
093630200528      **  Determine the number of decimal places for Euro                 CFT009
093640200528      *                                                                   CFT009
093650200528     C                     CALL 'AOCURRR0'                                CFT009
093660200528     C                     PARM *BLANKS   @RTCD                           CFT009
093670200528     C                     PARM '*KEY   ' @OPTN                           CFT009
093680200528     C                     PARM BKEURO    @AJCD                           CFT009
093690200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
093700200528      *                                                                   CFT009
093710200528      ** DATABASE ERROR                                                   CFT009
093720200528     C           @RTCD     IFNE *BLANK                                    CFT009
093730200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
093740200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
093750200528     C                     Z-ADD45        W0ERNB           * DB ERROR 45 *CFT009
093760200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
093770200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
093780200528     C                     EXSR SRERR                                     CFT009
093790200528     C                     ENDIF                                          CFT009
093800200528      *                                                                   CFT009
093810200528      ** Euro Currency                                                    CFT009
093820200528     C                     MOVELBKEURO    ##D,1                           CFT009
093830200528     C                     MOVELBKEURO    #CCY                            CFT009
093840200528      *                                                                   CFT009
093850200528     C                     CLEARP#0010                                    CFT009
093860200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
093870200528     C                     Z-ADDTXCH      P#FRAM                          CFT009
093880200528     C                     EXSR EURAMT                                    CFT009
093890200528     C                     MOVELW#TOAM    ##D,4                           CFT009
093900200528     C                     MOVE A6NBDP    ##D,4                           CFT009
093910200528      *                                                                   CFT009
093920200528     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
093930200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
093940200528      *                                                                   CFT009
093950200528     C                     CLEARP#0010                                    CFT009
093960200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
093970200528     C                     Z-ADDADCH      P#FRAM                          CFT009
093980200528     C                     EXSR EURAMT                                    CFT009
093990200528     C                     MOVELW#TOAM    ##D,10                          CFT009
094000200528     C                     MOVE A6NBDP    ##D,10                          CFT009
094010200528      *                                                                   CFT009
094020200528     C                     Z-ADDW#TOAM    VAT14  170                      CFT009
094030200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094040200528      *                                                                   CFT009
094050200528     C                     CLEARP#0010                                    CFT009
094060200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094070200528     C                     Z-ADDMSCH      P#FRAM                          CFT009
094080200528     C                     EXSR EURAMT                                    CFT009
094090200528     C                     MOVELW#TOAM    ##D,11                          CFT009
094100200528     C                     MOVE A6NBDP    ##D,11                          CFT009
094110200528      *                                                                   CFT009
094120200528     C                     Z-ADDW#TOAM    VAT6   170                      CFT009
094130200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094140200528      *                                                                   CFT009
094150200528     C                     CLEARP#0010                                    CFT009
094160200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094170200528     C                     Z-ADDMSC01     P#FRAM                          CFT009
094180200528     C                     EXSR EURAMT                                    CFT009
094190200528     C                     MOVELW#TOAM    ##D,17                          CFT009
094200200528     C                     MOVE A6NBDP    ##D,17                          CFT009
094210200528      *                                                                   CFT009
094220200528     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
094230200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094240200528      *                                                                   CFT009
094250200528     C                     CLEARP#0010                                    CFT009
094260200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094270200528     C                     Z-ADDTRCM      P#FRAM                          CFT009
094280200528     C                     EXSR EURAMT                                    CFT009
094290200528     C                     MOVELW#TOAM    ##D,2                           CFT009
094300200528     C                     MOVE A6NBDP    ##D,2                           CFT009
094310200528      *                                                                   CFT009
094320200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
094330200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094340200528      *                                                                   CFT009
094350200528     C                     CLEARP#0010                                    CFT009
094360200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094370200528     C                     Z-ADDINCHCM    P#FRAM                          CFT009
094380200528     C                     EXSR EURAMT                                    CFT009
094390200528     C                     MOVELW#TOAM    ##D,3                           CFT009
094400200528     C                     MOVE A6NBDP    ##D,3                           CFT009
094410200528      *                                                                   CFT009
094420200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
094430200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094440200528      *                                                                   CFT009
094450200528     C                     CLEARP#0010                                    CFT009
094460200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094470200528     C                     Z-ADDCQCH      P#FRAM                          CFT009
094480200528     C                     EXSR EURAMT                                    CFT009
094490200528     C                     MOVELW#TOAM    ##D,5                           CFT009
094500200528     C                     MOVE A6NBDP    ##D,5                           CFT009
094510200528      *                                                                   CFT009
094520200528     C                     Z-ADDW#TOAM    VAT2   170                      CFT009
094530200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094540200528      *                                                                   CFT009
094550200528     C                     CLEARP#0010                                    CFT009
094560200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094570200528     C                     Z-ADDTLCH      P#FRAM                          CFT009
094580200528     C                     EXSR EURAMT                                    CFT009
094590200528     C                     MOVELW#TOAM    ##D,9                           CFT009
094600200528     C                     MOVE A6NBDP    ##D,9                           CFT009
094610200528      *                                                                   CFT009
094620200528     C                     Z-ADDW#TOAM    VAT15  170                      CFT009
094630200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094640200528      *                                                                   CFT009
094650200528     C                     CLEARP#0010                                    CFT009
094660200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094670200528     C                     Z-ADDMSC02     P#FRAM                          CFT009
094680200528     C                     EXSR EURAMT                                    CFT009
094690200528     C                     MOVELW#TOAM    ##D,18                          CFT009
094700200528     C                     MOVE A6NBDP    ##D,18                          CFT009
094710200528      *                                                                   CFT009
094720200528     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
094730200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094740200528      *                                                                   CFT009
094750200528     C                     CLEARP#0010                                    CFT009
094760200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094770200528     C                     Z-ADDMSC03     P#FRAM                          CFT009
094780200528     C                     EXSR EURAMT                                    CFT009
094790200528     C                     MOVELW#TOAM    ##D,19                          CFT009
094800200528     C                     MOVE A6NBDP    ##D,19                          CFT009
094810200528      *                                                                   CFT009
094820200528     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
094830200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094840200528      *                                                                   CFT009
094850200528     C                     CLEARP#0010                                    CFT009
094860200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
094870200528     C                     Z-ADDMSC04     P#FRAM                          CFT009
094880200528     C                     EXSR EURAMT                                    CFT009
094890200528     C                     MOVELW#TOAM    ##D,20                          CFT009
094900200528     C                     MOVE A6NBDP    ##D,20                          CFT009
094910200528      *                                                                   CFT009
094920200528     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
094930200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
094940200528      *                                                                   CFT009
094950200528      **  Accumulate RDE's and associated data and output to              CFT009
094960200528      **  PF/CGUDTAPD.                                                    CFT009
094970200528      *                                                                   CFT009
094980200528     C                     EXSR SRADTA                                    CFT009
094990200528     C                     MOVEL##SDS     ##ADS                           CFT009
095000200528      *                                                                   CFT009
095010200528      **  Retrieve RDE information for RDEs in group set                  CFT009
095020200528      *                                                                   CFT009
095030200528     C                     Z-ADD21        ##RDEN                          CFT009
095040200528     C                     EXSR SRRRDE                                    CFT009
095050200528      *                                                                   CFT009
095060200528     C                     CLEARP#0010                                    CFT009
095070200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
095080200528     C                     Z-ADDMSC05     P#FRAM                          CFT009
095090200528     C                     EXSR EURAMT                                    CFT009
095100200528     C                     MOVELW#TOAM    ##D,1                           CFT009
095110200528     C                     MOVE A6NBDP    ##D,1                           CFT009
095120200528      *                                                                   CFT009
095130200528     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
095140200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
095150200528      *                                                                   CFT009
095160200528      **  Accumulate RDE's and associated data and output to              CFT009
095170200528      **  PF/CGUDTAPD.                                                    CFT009
095180200528     C                     EXSR SRADTA                                    CFT009
095190200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
095200200528      *                                                                   CFT009
095210200528      **  Initialise Write Format Parameter.                              CFT009
095220200528     C                     CLEARW0FMT                                     CFT009
095230200528      *                                                                   CFT009
095240200528      **  Set up Control Information.                                     CFT009
095250200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
095260200528     C                     ADD  1         ##OSEQ                          CFT009
095270200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
095280200528     C                     Z-ADD1         DEPBIN                          CFT009
095290200528     C                     Z-ADD1         DETBIN                          CFT009
095300200528     C                     MOVE 'FR'      DEFSLI                          CFT009
095310200528     C                     MOVE *BLANKS   W0PATH                          CFT009
095320200528     C                     MOVELS#PATH    W0PATH                          CFT009
095330200528      *                                                                   CFT009
095340200528      **  Append Data from pack routine.                                  CFT009
095350200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
095360200528     C                     EXSR SRODTA                                    CFT009
095370200528      *                                                                                       CCG015
095380200528     C                     EXSR POPGRS                                                        CCG015
095390200528      *                                                                   CFT009
095400200528      *................................................................   CFT009
095410200528      **  Unwind subroutine stack name                                    CFT009
095420200528      *                                                                   CFT009
095430200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
095440200528     C                     SUB  1         Q                               CFT009
095450200528      *                                                                   CFT009
095460200528     C                     ENDSR                                          CFT009
095470200528      *                                                                   CFT009
095480200528      /SPACE 5                                                            CFT009
095490200528      *****************************************************************   CFT009
095500200528      * Subroutine  :  INVATE                                         *   CFT009
095510200528      * Function    :  Euro Charges VAT                               *   CFT009
095520200528      *                                                               *   CFT009
095530200528      * Called by   :  DRCR01                                         *   CFT009
095540200528      * Calls       :                                                 *   CFT009
095550200528      *****************************************************************   CFT009
095560200528     C           INVATE    BEGSR                                          CFT009
095570200528      *                                                                   CFT009
095580200528      **  Set up subroutine stack name                                    CFT009
095590200528     C                     ADD  1         Q                               CFT009
095600200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
095610200528      *                                                                   CFT009
095620200528      *................................................................   CFT009
095630200528      *                                                                   CFT009
095640200528      **  Retrieve subroutine specific data.                              CFT009
095650200528     C           1         OCUR ##SRDT                                    CFT009
095660200528     C                     MOVEL##SPAT    S#PATH                          CFT009
095670200528      *                                                                   CFT009
095680200528      **  Set up Path.                                                    CFT009
095690200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
095700200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
095710200528      *                                                                                       CCG015
095720200528     C                     EXSR PSHGRS                                                        CCG015
095730200528      *                                                                   CFT009
095740200528      **  Retrieve RDE information for RDEs in group set                  CFT009
095750200528      *                                                                   CFT009
095760200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
095770200528     C                     Z-ADD1         ##RDEN                          CFT009
095780200528     C                     EXSR SRRRDE                                    CFT009
095790200528      *                                                                   CFT009
095800200528     C                     Z-ADD0         SUMVAT                          CFT009
095810200528      *                                                                   CFT009
095820200528     C           CFT10     IFEQ 'Y'                                       CFT009
095830200528      *                                                                   CFT009
095840200528     C           INVAT3    IFEQ 'Y'                                       CFT009
095850200528     C           INVATR    MULT VAT14     VAT       H                     CFT009
095860200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
095870200528     C                     ELSE                                           CFT009
095880200528     C                     Z-ADD0         SUMVAT                          CFT009
095890200528     C                     Z-ADD0         VAT                             CFT009
095900200528     C                     ENDIF                                          CFT009
095910200528      *                                                                   CFT009
095920200528     C                     MOVELVAT       ##D,14                          CFT009
095930200528     C                     MOVE A6NBDP    ##D,14                          CFT009
095940200528      *                                                                   CFT009
095950200528     C           INVAT2    IFEQ 'Y'                                       CFT009
095960200528     C           INVATR    MULT VAT1      VAT       H                     CFT009
095970200528     C                     ELSE                                           CFT009
095980200528     C                     Z-ADD0         VAT                             CFT009
095990200528     C                     ENDIF                                          CFT009
096000200528      *                                                                   CFT009
096010200528     C                     ADD  VAT       SUMVAT                          CFT009
096020200528     C                     MOVELVAT       ##D,1                           CFT009
096030200528     C                     MOVE A6NBDP    ##D,1                           CFT009
096040200528      *                                                                   CFT009
096050200528     C           INVAT6    IFEQ 'Y'                                       CFT009
096060200528     C           INVATR    MULT VAT6      VAT       H                     CFT009
096070200528     C                     ELSE                                           CFT009
096080200528     C                     Z-ADD0         VAT                             CFT009
096090200528     C                     ENDIF                                          CFT009
096100200528      *                                                                   CFT009
096110200528     C                     ADD  VAT       SUMVAT                          CFT009
096120200528     C                     MOVELVAT       ##D,6                           CFT009
096130200528     C                     MOVE A6NBDP    ##D,6                           CFT009
096140200528      *                                                                   CFT009
096150200528     C           VTMIC1    IFEQ 'Y'                                       CFT009
096160200528     C           INVATR    MULT VAT7      VAT       H                     CFT009
096170200528     C                     ELSE                                           CFT009
096180200528     C                     Z-ADD0         VAT                             CFT009
096190200528     C                     ENDIF                                          CFT009
096200200528      *                                                                   CFT009
096210200528     C                     ADD  VAT       SUMVAT                          CFT009
096220200528     C                     MOVELVAT       ##D,7                           CFT009
096230200528     C                     MOVE A6NBDP    ##D,7                           CFT009
096240200528      *                                                                   CFT009
096250200528     C           VTMIC2    IFEQ 'Y'                                       CFT009
096260200528     C           INVATR    MULT VAT8      VAT       H                     CFT009
096270200528     C                     ELSE                                           CFT009
096280200528     C                     Z-ADD0         VAT                             CFT009
096290200528     C                     ENDIF                                          CFT009
096300200528      *                                                                   CFT009
096310200528     C                     ADD  VAT       SUMVAT                          CFT009
096320200528     C                     MOVELVAT       ##D,8                           CFT009
096330200528     C                     MOVE A6NBDP    ##D,8                           CFT009
096340200528      *                                                                   CFT009
096350200528     C           VTMIC3    IFEQ 'Y'                                       CFT009
096360200528     C           INVATR    MULT VAT9      VAT       H                     CFT009
096370200528     C                     ELSE                                           CFT009
096380200528     C                     Z-ADD0         VAT                             CFT009
096390200528     C                     ENDIF                                          CFT009
096400200528      *                                                                   CFT009
096410200528     C                     ADD  VAT       SUMVAT                          CFT009
096420200528     C                     MOVELVAT       ##D,9                           CFT009
096430200528     C                     MOVE A6NBDP    ##D,9                           CFT009
096440200528      *                                                                   CFT009
096450200528     C           VTMIC4    IFEQ 'Y'                                       CFT009
096460200528     C           INVATR    MULT VAT10     VAT       H                     CFT009
096470200528     C                     ELSE                                           CFT009
096480200528     C                     Z-ADD0         VAT                             CFT009
096490200528     C                     ENDIF                                          CFT009
096500200528      *                                                                   CFT009
096510200528     C                     ADD  VAT       SUMVAT                          CFT009
096520200528     C                     MOVELVAT       ##D,10                          CFT009
096530200528     C                     MOVE A6NBDP    ##D,10                          CFT009
096540200528      *                                                                   CFT009
096550200528     C           VTMIC5    IFEQ 'Y'                                       CFT009
096560200528     C           INVATR    MULT VAT11     VAT       H                     CFT009
096570200528     C                     ELSE                                           CFT009
096580200528     C                     Z-ADD0         VAT                             CFT009
096590200528     C                     ENDIF                                          CFT009
096600200528      *                                                                   CFT009
096610200528     C                     ADD  VAT       SUMVAT                          CFT009
096620200528     C                     MOVELVAT       ##D,11                          CFT009
096630200528     C                     MOVE A6NBDP    ##D,11                          CFT009
096640200528      *                                                                   CFT009
096650200528     C           INVAT1    IFEQ 'Y'                                       CFT009
096660200528     C           INVATR    MULT VAT12     VAT    150H                     CFT009
096670200528     C                     ELSE                                           CFT009
096680200528     C                     Z-ADD0         VAT                             CFT009
096690200528     C                     ENDIF                                          CFT009
096700200528      *                                                                   CFT009
096710200528     C                     ADD  VAT       SUMVAT                          CFT009
096720200528     C                     MOVELVAT       ##D,12                          CFT009
096730200528     C                     MOVE A6NBDP    ##D,12                          CFT009
096740200528      *                                                                   CFT009
096750200528     C           INVAT7    IFEQ 'Y'                                       CFT009
096760200528     C           INVATR    MULT VAT13     VAT       H                     CFT009
096770200528     C                     ELSE                                           CFT009
096780200528     C                     Z-ADD0         VAT                             CFT009
096790200528     C                     ENDIF                                          CFT009
096800200528      *                                                                   CFT009
096810200528     C                     ADD  VAT       SUMVAT                          CFT009
096820200528     C                     MOVELVAT       ##D,13                          CFT009
096830200528     C                     MOVE A6NBDP    ##D,13                          CFT009
096840200528      *                                                                   CFT009
096850200528     C           INVAT4    IFEQ 'Y'                                       CFT009
096860200528     C           INVATR    MULT VAT2      VAT       H                     CFT009
096870200528     C                     ELSE                                           CFT009
096880200528     C                     Z-ADD0         VAT                             CFT009
096890200528     C                     ENDIF                                          CFT009
096900200528      *                                                                   CFT009
096910200528     C                     ADD  VAT       SUMVAT                          CFT009
096920200528     C                     MOVELVAT       ##D,2                           CFT009
096930200528     C                     MOVE A6NBDP    ##D,2                           CFT009
096940200528      *                                                                   CFT009
096950200528     C           INVAT5    IFEQ 'Y'                                       CFT009
096960200528     C           INVATR    MULT VAT15     VAT       H                     CFT009
096970200528     C                     ELSE                                           CFT009
096980200528     C                     Z-ADD0         VAT                             CFT009
096990200528     C                     ENDIF                                          CFT009
097000200528      *                                                                   CFT009
097010200528     C                     ADD  VAT       SUMVAT                          CFT009
097020200528     C                     MOVELVAT       ##D,15                          CFT009
097030200528     C                     MOVE A6NBDP    ##D,15                          CFT009
097040200528      *                                                                   CFT009
097050200528     C                     ENDIF                                          CFT009
097060200528      *                                                                   CFT009
097070200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
097080200528     C                     MOVELSUMCHG    ##D,17                          CFT009
097090200528     C                     MOVE A6NBDP    ##D,17                          CFT009
097100200528      *                                                                   CFT009
097110200528      **  Accumulate RDE's and associated data and output to              CFT009
097120200528      **  PF/CGUDTAPD.                                                    CFT009
097130200528      *                                                                   CFT009
097140200528     C                     EXSR SRADTA                                    CFT009
097150200528     C                     EXSR SRODTA                                    CFT009
097160200528      *                                                                                       CCG015
097170200528     C                     EXSR POPGRS                                                        CCG015
097180200528      *................................................................   CFT009
097190200528      **  Unwind subroutine stack name                                    CFT009
097200200528      *                                                                   CFT009
097210200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
097220200528     C                     SUB  1         Q                               CFT009
097230200528      *                                                                   CFT009
097240200528     C                     ENDSR                                          CFT009
097250200528      *                                                                   CFT009
097260200528     C/SPACE 5                                                            CFT009
097270200528      *****************************************************************   CFT009
097280200528      * Subroutine  :  BBP                                            *   CFT009
097290200528      * Function    :  Branch, Book, Profit Centre Details            *   CFT009
097300200528      *                                                               *   CFT009
097310200528      * Called by   :  DRCR01                                         *   CFT009
097320200528      * Calls       :                                                 *   CFT009
097330200528      *****************************************************************   CFT009
097340200528     C           BBP       BEGSR                                          CFT009
097350200528      *                                                                   CFT009
097360200528      **  Set up subroutine stack name                                    CFT009
097370200528     C                     ADD  1         Q                               CFT009
097380200528     C                     MOVEL'BBP   '  @STK,Q                          CFT009
097390200528      *                                                                   CFT009
097400200528      *................................................................   CFT009
097410200528      *                                                                   CFT009
097420200528      **  Retrieve subroutine specific data.                              CFT009
097430200528     C           1         OCUR ##SRDT                                    CFT009
097440200528     C                     MOVEL##SPAT    S#PATH                          CFT009
097450200528      *                                                                   CFT009
097460200528      **  Set up Path.                                                    CFT009
097470200528     C                     MOVEL'\BBP   ' ##PNAM                          CFT009
097480200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
097490200528      *                                                                                       CCG015
097500200528     C                     EXSR PSHGRS                                                        CCG015
097510200528      *                                                                   CFT009
097520200528      **  Retrieve RDE information for RDEs in group set                  CFT009
097530200528      *                                                                   CFT009
097540200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
097550200528     C                     Z-ADD1         ##RDEN                          CFT009
097560200528     C                     EXSR SRRRDE                                    CFT009
097570200528      *                                                                   CFT009
097580200528      ** Get Branch Details                                               CFT009
097590200528      *                                                                   CFT009
097600200528     C**********           CALL 'AOBRCHR0'                                             CFT009 CGL029
097610200528     C                     CALL 'AOBRCHR1'                                                    CGL029
097620200528     C                     PARM '*MSG    '##RTCD                          CFT009
097630200528     C                     PARM '*KEY    '##OPTN                          CFT009
097640200528     C                     PARM BRCA      ##BRCD  3                       CFT009
097650200528     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CFT009 CGL029
097660200528     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
097670200528      *                                                                   CFT009
097680200528      ** DATABASE ERROR                                                   CFT009
097690200528      *                                                                   CFT009
097700200528     C           ##RTCD    IFNE *BLANK                                    CFT009
097710200528     C                     MOVEL'SDBRCHPD'W0FILE                          CFT009
097720200528     C                     MOVELBRCA      W0KEY            ***************CFT009
097730200528     C                     Z-ADD46        W0ERNB           * DB ERROR 46 *CFT009
097740200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
097750200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
097760200528     C                     EXSR SRERR                                     CFT009
097770200528     C                     END                                            CFT009
097780200528     C/COPY WNCPYSRC,CG4630C012                                           CFT009
097790200528      *                                                                   CFT009
097800200528      ** Branch                                                           CFT009
097810200528     C                     MOVELA8BRCD    ##D,1                           CFT009
097820200528      *                                                                   CFT009
097830200528      ** Branch Name                                                      CFT009
097840200528     C                     MOVELA8BRNM    ##D,2                           CFT009
097850200528      *                                                                   CFT009
097860200528     C/COPY WNCPYSRC,CG4630C013                                           CFT009
097870200528      *                                                                   CFT009
097880200528      ** Get Book Details                                                 CFT009
097890200528     C           BOKC      IFNE *BLANKS                                                     AR850312
097900200528     C                     CALL 'AOBOOKR0'                                CFT009
097910200528     C                     PARM *BLANKS   @RTCD                           CFT009
097920200528     C                     PARM '*KEY   ' @OPTN                           CFT009
097930200528     C                     PARM BOKC      @BOKC   2                       CFT009
097940200528     C           SDBOOK    PARM SDBOOK    DSFDY                           CFT009
097950200528      *                                                                   CFT009
097960200528      ** DATABASE ERROR                                                   CFT009
097970200528      *                                                                   CFT009
097980200528     C           @RTCD     IFNE *BLANK                                    CFT009
097990200528     C                     MOVEL'SDBOOKPD'W0FILE                          CFT009
098000200528     C                     MOVELBOKC      W0KEY            ***************CFT009
098010200528     C                     Z-ADD47        W0ERNB           * DB ERROR 47 *CFT009
098020200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
098030200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
098040200528     C                     EXSR SRERR                                     CFT009
098050200528     C                     END                                            CFT009
098060200528     C                     ENDIF                                                            AR850312
098070200528      *                                                                   CFT009
098080200528      ** Book Code                                                        CFT009
098090200528     C                     MOVELBOKC      ##D,3                           CFT009
098100200528      *                                                                   CFT009
098110200528      ** Book Description                                                 CFT009
098120200528     C                     MOVELBDBKD     ##D,4                           CFT009
098130200528      *                                                                   CFT009
098140200528      **  Bypass if profit center blank.                                  CFT009
098150200528     C           PRFC      IFEQ *BLANKS                                   CFT009
098160200528     C                     GOTO EXOF@2                                    CFT009
098170200528     C                     ENDIF                                          CFT009
098180200528      *                                                                   CFT009
098190200528      **  Obtain Profit Centre details                                    CFT009
098200200528     C                     CALL 'AOPRFCR0'                                CFT009
098210200528     C                     PARM *BLANKS   @RTCD                           CFT009
098220200528     C                     PARM '*KEY   ' @OPTN                           CFT009
098230200528     C                     PARM PRFC      @KEY    4                       CFT009
098240200528     C           SDPRFC    PARM SDPRFC    DSFDY                           CFT009
098250200528      *                                                                   CFT009
098260200528      ** DATABASE ERROR                                                   CFT009
098270200528      *                                                                   CFT009
098280200528     C           @RTCD     IFNE *BLANK                                    CFT009
098290200528     C                     MOVEL'SDPRFCPD'W0FILE                          CFT009
098300200528     C                     MOVELPRFC      W0KEY            ***************CFT009
098310200528     C                     Z-ADD48        W0ERNB           * DB ERROR 48 *CFT009
098320200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
098330200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
098340200528     C                     EXSR SRERR                                     CFT009
098350200528     C                     END                                            CFT009
098360200528      *                                                                   CFT009
098370200528      ** Profit Centre                                                    CFT009
098380200528     C                     MOVELPRFC      ##D,5                           CFT009
098390200528      *                                                                   CFT009
098400200528      ** Profit Centre Description                                        CFT009
098410200528     C                     MOVELDSPCDS    ##D,6                           CFT009
098420200528      *                                                                   CFT009
098430200528     C           EXOF@2    TAG                                            CFT009
098440200528      *                                                                   CFT009
098450200528      **  Accumulate RDE's and associated data and output to              CFT009
098460200528      **  PF/CGUDTAPD.                                                    CFT009
098470200528     C                     EXSR SRADTA                                    CFT009
098480200528     C                     EXSR SRODTA                                    CFT009
098490200528      *                                                                                       CCG015
098500200528     C                     EXSR POPGRS                                                        CCG015
098510200528      *                                                                   CFT009
098520200528      *................................................................   CFT009
098530200528      *                                                                   CFT009
098540200528      **  Unwind subroutine stack name                                    CFT009
098550200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
098560200528     C                     SUB  1         Q                               CFT009
098570200528      *                                                                   CFT009
098580200528     C                     ENDSR                                          CFT009
098590200528      /SPACE 5                                                            CFT009
098600200528      *****************************************************************   CFT009
098610200528      * Subroutine  :  OTFEES                                         *   CFT009
098620200528      * Function    :  Fees & Charges Information                     *   CFT009
098630200528      *                                                               *   CFT009
098640200528      * Called by   :  DRCR02                                         *   CFT009
098650200528      * Calls       :                                                 *   CFT009
098660200528      *****************************************************************   CFT009
098670200528     C           OTFEES    BEGSR                                          CFT009
098680200528      *                                                                   CFT009
098690200528      **  Set up subroutine stack name                                    CFT009
098700200528     C                     ADD  1         Q                               CFT009
098710200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
098720200528      *                                                                   CFT009
098730200528      *................................................................   CFT009
098740200528      *                                                                   CFT009
098750200528      **  Retrieve subroutine specific data.                              CFT009
098760200528     C           1         OCUR ##SRDT                                    CFT009
098770200528     C                     MOVEL##SPAT    S#PATH                          CFT009
098780200528      *                                                                   CFT009
098790200528      **  Set up Path.                                                    CFT009
098800200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
098810200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
098820200528      *                                                                                       CCG015
098830200528     C                     EXSR PSHGRS                                                        CCG015
098840200528      *                                                                   CFT009
098850200528      **  Retrieve RDE information for RDEs in group set                  CFT009
098860200528      *                                                                   CFT009
098870200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
098880200528     C                     Z-ADD1         ##RDEN                          CFT009
098890200528     C                     EXSR SRRRDE                                    CFT009
098900200528      *                                                                   CFT009
098910200528     C                     MOVEL'Y'       ##D,1                           CFT009
098920200528      *                                                                   CFT009
098930200528      ** Charge code                                                      CFT009
098940200528      *                                                                   CFT009
098950200528     C                     MOVELTFCCCD    ##D,13                          CFT009
098960200528     C                     MOVELFXCACC    ##D,14                          CFT009
098970200528     C                     MOVELCHQCHC    ##D,3                           CFT009
098980200528     C                     MOVELCACHCD    ##D,4                           CFT009
098990200528     C                     MOVELTLXCDE    ##D,2                           CFT009
099000200528     C                     MOVELSPRCCD    ##D,6                           CFT009
099010200528     C                     MOVELSSTCCD    ##D,5                           CFT009
099020200528     C                     MOVELMSCHC     ##D,7                           CFT009
099030200528     C                     MOVELMSCHC1    ##D,8                           CFT009
099040200528     C                     MOVELMSCHC2    ##D,9                           CFT009
099050200528     C                     MOVELMSCHC3    ##D,10                          CFT009
099060200528     C                     MOVELMSCHC4    ##D,11                          CFT009
099070200528     C                     MOVELMSCHC5    ##D,12                          CFT009
099080200528      *                                                                   CFT009
099090200528     C           CFT10     IFEQ 'Y'                                       CFT009
099100200528     C                     MOVEL'Y'       ##D,18                          CFT009
099110200528     C                     ENDIF                                          CFT009
099120200528      *                                                                   CFT009
099130200528      ** FX Spread Set                                                    CFT009
099140200528      *                                                                   CFT009
099150200528     C                     MOVELFXSRSC    ##D,19                          CFT009
099160200528      *                                                                   CFT009
099170200528      **  Accumulate RDE's and associated data and output to              CFT009
099180200528      **  PF/CGUDTAPD.                                                    CFT009
099190200528      *                                                                   CFT009
099200200528     C                     EXSR SRADTA                                    CFT009
099210200528     C                     EXSR SRODTA                                    CFT009
099220200528      *                                                                                       CCG015
099230200528     C                     EXSR POPGRS                                                        CCG015
099240200528      *                                                                   CFT009
099250200528      *................................................................   CFT009
099260200528      **  Unwind subroutine stack name                                    CFT009
099270200528      *                                                                   CFT009
099280200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
099290200528     C                     SUB  1         Q                               CFT009
099300200528      *                                                                   CFT009
099310200528     C                     ENDSR                                          CFT009
099320200528      /SPACE 5                                                            CFT009
099330200528      *****************************************************************   CFT009
099340200528      * Subroutine  :  OTENTC                                         *   CFT009
099350200528      * Function    :  Entered Charges                                *   CFT009
099360200528      *                                                               *   CFT009
099370200528      * Called by   :  DRCR02                                         *   CFT009
099380200528      * Calls       :                                                 *   CFT009
099390200528      *****************************************************************   CFT009
099400200528     C           OTENTC    BEGSR                                          CFT009
099410200528      *                                                                   CFT009
099420200528      **  Set up subroutine stack name                                    CFT009
099430200528     C                     ADD  1         Q                               CFT009
099440200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
099450200528      *                                                                   CFT009
099460200528      *................................................................   CFT009
099470200528      *                                                                   CFT009
099480200528      **  Retrieve subroutine specific data.                              CFT009
099490200528     C           1         OCUR ##SRDT                                    CFT009
099500200528     C                     MOVEL##SPAT    S#PATH                          CFT009
099510200528      *                                                                   CFT009
099520200528      **  Set up Path.                                                    CFT009
099530200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
099540200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
099550200528      *                                                                                       CCG015
099560200528     C                     EXSR PSHGRS                                                        CCG015
099570200528      *                                                                   CFT009
099580200528      **  Retrieve RDE information for RDEs in group set                  CFT009
099590200528      *                                                                   CFT009
099600200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
099610200528     C                     Z-ADD1         ##RDEN                          CFT009
099620200528     C                     EXSR SRRRDE                                    CFT009
099630200528      *                                                                   CFT009
099640200528     C           ADDC      IFEQ 'A'                                       CFT009
099650200528     C                     MOVELSMCY      ##WCCY  3                       CFT009
099660200528     C                     ELSE                                           CFT009
099670200528     C                     MOVELPCCY      ##WCCY                          CFT009
099680200528     C                     ENDIF                                          CFT009
099690200528      *                                                                                    AR1082119
099700200528      **  Get Charge Currency                                                              AR1082119
099710200528      *                                                                                    AR1082119
099720200528     C                     EXSR SR#CCY                                                     AR1082119
099730200528      *                                                                   CFT009
099740200528      **  Charge currency                                                 CFT009
099750200528     C                     MOVEL##WCCY    ##D,1                           CFT009
099760200528      *                                                                   CFT009
099770200528      **  Obtain currency details                                         CFT009
099780200528     C                     CALL 'AOCURRR0'                                CFT009
099790200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
099800200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
099810200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
099820200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
099830200528      *                                                                   CFT009
099840200528      ** DATABASE ERROR                                                   CFT009
099850200528      *                                                                   CFT009
099860200528     C           @RTCD     IFNE *BLANK                                    CFT009
099870200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
099880200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
099890200528     C                     Z-ADD49        W0ERNB           * DB ERROR 49 *CFT009
099900200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
099910200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
099920200528     C                     EXSR SRERR                                     CFT009
099930200528     C                     ENDIF                                          CFT009
099940200528      *                                                                   CFT009
099950200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
099960200528      *                                                                   CFT009
099970200528      ** Amount                                                           CFT009
099980200528      *                                                                   CFT009
099990200528     C                     MOVELTRCM      ##D,2                           CFT009
100000200528     C                     MOVE A6NBDP    ##D,2                           CFT009
100010200528     C                     MOVELOPCHCM    ##D,3                           CFT009
100020200528     C                     MOVE A6NBDP    ##D,3                           CFT009
100030200528     C                     MOVELCQCH      ##D,5                           CFT009
100040200528     C                     MOVE A6NBDP    ##D,5                           CFT009
100050200528     C                     MOVELCSTA      ##D,6                           CFT009
100060200528     C                     MOVE A6NBDP    ##D,6                           CFT009
100070200528     C                     MOVELTXCH      ##D,4                           CFT009
100080200528     C                     MOVE A6NBDP    ##D,4                           CFT009
100090200528     C                     MOVELSPCH      ##D,16                          CFT009
100100200528     C                     MOVE A6NBDP    ##D,16                          CFT009
100110200528     C                     MOVELSWSCHG    ##D,7                           CFT009
100120200528     C                     MOVE A6NBDP    ##D,7                           CFT009
100130200528     C                     MOVELMSCH      ##D,11                          CFT009
100140200528     C                     MOVE A6NBDP    ##D,11                          CFT009
100150200528     C                     MOVELMISC01    ##D,17                          CFT009
100160200528     C                     MOVE A6NBDP    ##D,17                          CFT009
100170200528     C                     MOVELMISC02    ##D,18                          CFT009
100180200528     C                     MOVE A6NBDP    ##D,18                          CFT009
100190200528     C                     MOVELMISC03    ##D,19                          CFT009
100200200528     C                     MOVE A6NBDP    ##D,19                          CFT009
100210200528     C                     MOVELMISC04    ##D,20                          CFT009
100220200528     C                     MOVE A6NBDP    ##D,20                          CFT009
100230200528      *                                                                   CFT009
100240200528      **  Accumulate RDE's and associated data and output to              CFT009
100250200528      **  PF/CGUDTAPD.                                                    CFT009
100260200528      *                                                                   CFT009
100270200528     C                     EXSR SRADTA                                    CFT009
100280200528     C                     MOVEL##SDS     ##ADS                           CFT009
100290200528      *                                                                   CFT009
100300200528      **  Retrieve RDE information for RDEs in group set                  CFT009
100310200528      *                                                                   CFT009
100320200528     C                     Z-ADD21        ##RDEN                          CFT009
100330200528     C                     EXSR SRRRDE                                    CFT009
100340200528     C                     MOVELMISC05    ##D,1                           CFT009
100350200528     C                     MOVE A6NBDP    ##D,1                           CFT009
100360200528      *                                                                   CFT009
100370200528      **  Accumulate RDE's and associated data and output to              CFT009
100380200528      **  PF/CGUDTAPD.                                                    CFT009
100390200528     C                     EXSR SRADTA                                    CFT009
100400200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
100410200528      *                                                                   CFT009
100420200528      **  Initialise Write Format Parameter.                              CFT009
100430200528     C                     CLEARW0FMT                                     CFT009
100440200528      *                                                                   CFT009
100450200528      **  Set up Control Information.                                     CFT009
100460200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
100470200528     C                     ADD  1         ##OSEQ                          CFT009
100480200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
100490200528     C                     Z-ADD1         DEPBIN                          CFT009
100500200528     C                     Z-ADD1         DETBIN                          CFT009
100510200528     C                     MOVE 'FR'      DEFSLI                          CFT009
100520200528     C                     MOVE *BLANKS   W0PATH                          CFT009
100530200528     C                     MOVELS#PATH    W0PATH                          CFT009
100540200528      *                                                                   CFT009
100550200528      **  Append Data from pack routine.                                  CFT009
100560200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
100570200528     C                     EXSR SRODTA                                    CFT009
100580200528      *                                                                   CFT009
100590200528      ** Totals                                                           CFT009
100600200528      *                                                                   CFT009
100610200528     C           TRCM      ADD  OPCHCM    SUMAMT 150                      CFT009
100620200528     C                     ADD  CQCH      SUMAMT                          CFT009
100630200528     C                     ADD  CSTA      SUMAMT                          CFT009
100640200528     C                     ADD  TXCH      SUMAMT                          CFT009
100650200528     C                     ADD  SPCH      SUMAMT                          CFT009
100660200528     C                     ADD  SWSCHG    SUMAMT                          CFT009
100670200528     C                     ADD  MSCH      SUMAMT                          CFT009
100680200528     C                     ADD  MISC01    SUMAMT                          CFT009
100690200528     C                     ADD  MISC02    SUMAMT                          CFT009
100700200528     C                     ADD  MISC03    SUMAMT                          CFT009
100710200528     C                     ADD  MISC04    SUMAMT                          CFT009
100720200528     C                     ADD  MISC05    SUMAMT                          CFT009
100730200528      *                                                                                       CCG015
100740200528     C                     EXSR POPGRS                                                        CCG015
100750200528      *                                                                   CFT009
100760200528      *................................................................   CFT009
100770200528      **  Unwind subroutine stack name                                    CFT009
100780200528      *                                                                   CFT009
100790200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
100800200528     C                     SUB  1         Q                               CFT009
100810200528      *                                                                   CFT009
100820200528     C                     ENDSR                                          CFT009
100830200528      /SPACE 5                                                            CFT009
100840200528      *****************************************************************   CFT009
100850200528      * Subroutine  :  OTVATA                                         *   CFT009
100860200528      * Function    :  Entered Charges VAT                            *   CFT009
100870200528      *                                                               *   CFT009
100880200528      * Called by   :  DRCR02                                         *   CFT009
100890200528      * Calls       :                                                 *   CFT009
100900200528      *****************************************************************   CFT009
100910200528     C           OTVATA    BEGSR                                          CFT009
100920200528      *                                                                   CFT009
100930200528      **  Set up subroutine stack name                                    CFT009
100940200528     C                     ADD  1         Q                               CFT009
100950200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
100960200528      *                                                                   CFT009
100970200528      *................................................................   CFT009
100980200528      *                                                                   CFT009
100990200528      **  Retrieve subroutine specific data.                              CFT009
101000200528     C           1         OCUR ##SRDT                                    CFT009
101010200528     C                     MOVEL##SPAT    S#PATH                          CFT009
101020200528      *                                                                   CFT009
101030200528      **  Set up Path.                                                    CFT009
101040200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
101050200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
101060200528      *                                                                                       CCG015
101070200528     C                     EXSR PSHGRS                                                        CCG015
101080200528      *                                                                   CFT009
101090200528      **  Retrieve RDE information for RDEs in group set                  CFT009
101100200528      *                                                                   CFT009
101110200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
101120200528     C                     Z-ADD1         ##RDEN                          CFT009
101130200528     C                     EXSR SRRRDE                                    CFT009
101140200528      *                                                                   CFT009
101150200528     C                     Z-ADD0         SUMVAT                          CFT009
101160200528      *                                                                   CFT009
101170200528     C           CFT10     IFEQ 'Y'                                       CFT009
101180200528      *                                                                   CFT009
101190200528     C           OPVAT1    IFEQ 'Y'                                       CFT009
101200200528     C           OPVATR    MULT TRCM      VAT    150H                     CFT009
101210200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
101220200528     C                     ELSE                                           CFT009
101230200528     C                     Z-ADD0         VAT                             CFT009
101240200528     C                     Z-ADD0         SUMVAT                          CFT009
101250200528     C                     ENDIF                                          CFT009
101260200528      *                                                                   CFT009
101270200528     C                     MOVELVAT       ##D,12                          CFT009
101280200528     C                     MOVE A6NBDP    ##D,12                          CFT009
101290200528      *                                                                   CFT009
101300200528     C           OPVAT7    IFEQ 'Y'                                       CFT009
101310200528     C           OPVATR    MULT OPCHCM    VAT       H                     CFT009
101320200528     C                     ELSE                                           CFT009
101330200528     C                     Z-ADD0         VAT                             CFT009
101340200528     C                     ENDIF                                          CFT009
101350200528      *                                                                   CFT009
101360200528     C                     ADD  VAT       SUMVAT                          CFT009
101370200528     C                     MOVELVAT       ##D,13                          CFT009
101380200528     C                     MOVE A6NBDP    ##D,13                          CFT009
101390200528      *                                                                   CFT009
101400200528     C           OPVAT3    IFEQ 'Y'                                       CFT009
101410200528     C           OPVATR    MULT CQCH      VAT       H                     CFT009
101420200528     C                     ELSE                                           CFT009
101430200528     C                     Z-ADD0         VAT                             CFT009
101440200528     C                     ENDIF                                          CFT009
101450200528      *                                                                   CFT009
101460200528     C                     ADD  VAT       SUMVAT                          CFT009
101470200528     C                     MOVELVAT       ##D,2                           CFT009
101480200528     C                     MOVE A6NBDP    ##D,2                           CFT009
101490200528      *                                                                   CFT009
101500200528     C           OPVAT4    IFEQ 'Y'                                       CFT009
101510200528     C           OPVATR    MULT CSTA      VAT       H                     CFT009
101520200528     C                     ELSE                                           CFT009
101530200528     C                     Z-ADD0         VAT                             CFT009
101540200528     C                     ENDIF                                          CFT009
101550200528      *                                                                   CFT009
101560200528     C                     ADD  VAT       SUMVAT                          CFT009
101570200528     C                     MOVELVAT       ##D,3                           CFT009
101580200528     C                     MOVE A6NBDP    ##D,3                           CFT009
101590200528      *                                                                   CFT009
101600200528     C           OPVAT2    IFEQ 'Y'                                       CFT009
101610200528     C           OPVATR    MULT TXCH      VAT       H                     CFT009
101620200528     C                     ELSE                                           CFT009
101630200528     C                     Z-ADD0         VAT                             CFT009
101640200528     C                     ENDIF                                          CFT009
101650200528      *                                                                   CFT009
101660200528     C                     ADD  VAT       SUMVAT                          CFT009
101670200528     C                     MOVELVAT       ##D,1                           CFT009
101680200528     C                     MOVE A6NBDP    ##D,1                           CFT009
101690200528      *                                                                   CFT009
101700200528     C           OPVAT5    IFEQ 'Y'                                       CFT009
101710200528     C           OPVATR    MULT SPCH      VAT       H                     CFT009
101720200528     C                     ELSE                                           CFT009
101730200528     C                     Z-ADD0         VAT                             CFT009
101740200528     C                     ENDIF                                          CFT009
101750200528      *                                                                   CFT009
101760200528     C                     ADD  VAT       SUMVAT                          CFT009
101770200528     C                     MOVELVAT       ##D,5                           CFT009
101780200528     C                     MOVE A6NBDP    ##D,5                           CFT009
101790200528      *                                                                   CFT009
101800200528     C           VTSWSC    IFEQ 'Y'                                       CFT009
101810200528     C           OPVATR    MULT SWSCHG    VAT       H                     CFT009
101820200528     C                     ELSE                                           CFT009
101830200528     C                     Z-ADD0         VAT                             CFT009
101840200528     C                     ENDIF                                          CFT009
101850200528      *                                                                   CFT009
101860200528     C                     ADD  VAT       SUMVAT                          CFT009
101870200528     C                     MOVELVAT       ##D,4                           CFT009
101880200528     C                     MOVE A6NBDP    ##D,4                           CFT009
101890200528      *                                                                   CFT009
101900200528     C           OPVAT6    IFEQ 'Y'                                       CFT009
101910200528     C           OPVATR    MULT MSCH      VAT       H                     CFT009
101920200528     C                     ELSE                                           CFT009
101930200528     C                     Z-ADD0         VAT                             CFT009
101940200528     C                     ENDIF                                          CFT009
101950200528      *                                                                   CFT009
101960200528     C                     ADD  VAT       SUMVAT                          CFT009
101970200528     C                     MOVELVAT       ##D,6                           CFT009
101980200528     C                     MOVE A6NBDP    ##D,6                           CFT009
101990200528      *                                                                   CFT009
102000200528     C           VMIC1     IFEQ 'Y'                                       CFT009
102010200528     C           OPVATR    MULT MISC01    VAT       H                     CFT009
102020200528     C                     ELSE                                           CFT009
102030200528     C                     Z-ADD0         VAT                             CFT009
102040200528     C                     ENDIF                                          CFT009
102050200528      *                                                                   CFT009
102060200528     C                     ADD  VAT       SUMVAT                          CFT009
102070200528     C                     MOVELVAT       ##D,7                           CFT009
102080200528     C                     MOVE A6NBDP    ##D,7                           CFT009
102090200528      *                                                                   CFT009
102100200528     C           VMIC2     IFEQ 'Y'                                       CFT009
102110200528     C           OPVATR    MULT MISC02    VAT       H                     CFT009
102120200528     C                     ELSE                                           CFT009
102130200528     C                     Z-ADD0         VAT                             CFT009
102140200528     C                     ENDIF                                          CFT009
102150200528      *                                                                   CFT009
102160200528     C                     ADD  VAT       SUMVAT                          CFT009
102170200528     C                     MOVELVAT       ##D,8                           CFT009
102180200528     C                     MOVE A6NBDP    ##D,8                           CFT009
102190200528      *                                                                   CFT009
102200200528     C           VMIC3     IFEQ 'Y'                                       CFT009
102210200528     C           OPVATR    MULT MISC03    VAT       H                     CFT009
102220200528     C                     ELSE                                           CFT009
102230200528     C                     Z-ADD0         VAT                             CFT009
102240200528     C                     ENDIF                                          CFT009
102250200528      *                                                                   CFT009
102260200528     C                     ADD  VAT       SUMVAT                          CFT009
102270200528     C                     MOVELVAT       ##D,9                           CFT009
102280200528     C                     MOVE A6NBDP    ##D,9                           CFT009
102290200528      *                                                                   CFT009
102300200528     C           VMIC4     IFEQ 'Y'                                       CFT009
102310200528     C           OPVATR    MULT MISC04    VAT       H                     CFT009
102320200528     C                     ELSE                                           CFT009
102330200528     C                     Z-ADD0         VAT                             CFT009
102340200528     C                     ENDIF                                          CFT009
102350200528      *                                                                   CFT009
102360200528     C                     ADD  VAT       SUMVAT                          CFT009
102370200528     C                     MOVELVAT       ##D,10                          CFT009
102380200528     C                     MOVE A6NBDP    ##D,10                          CFT009
102390200528      *                                                                   CFT009
102400200528     C           VMIC5     IFEQ 'Y'                                       CFT009
102410200528     C           OPVATR    MULT MISC05    VAT       H                     CFT009
102420200528     C                     ELSE                                           CFT009
102430200528     C                     Z-ADD0         VAT                             CFT009
102440200528     C                     ENDIF                                          CFT009
102450200528      *                                                                   CFT009
102460200528     C                     ADD  VAT       SUMVAT                          CFT009
102470200528     C                     MOVELVAT       ##D,11                          CFT009
102480200528     C                     MOVE A6NBDP    ##D,11                          CFT009
102490200528      *                                                                   CFT009
102500200528     C                     ENDIF                                          CFT009
102510200528      *                                                                   CFT009
102520200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
102530200528     C                     MOVELSUMCHG    ##D,17                          CFT009
102540200528     C                     MOVE A6NBDP    ##D,17                          CFT009
102550200528      *                                                                   CFT009
102560200528      **  Accumulate RDE's and associated data and output to              CFT009
102570200528      **  PF/CGUDTAPD.                                                    CFT009
102580200528     C                     EXSR SRADTA                                    CFT009
102590200528     C                     EXSR SRODTA                                    CFT009
102600200528      *                                                                                       CCG015
102610200528     C                     EXSR POPGRS                                                        CCG015
102620200528      *                                                                   CFT009
102630200528      *................................................................   CFT009
102640200528      **  Unwind subroutine stack name                                    CFT009
102650200528      *                                                                   CFT009
102660200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
102670200528     C                     SUB  1         Q                               CFT009
102680200528      *                                                                   CFT009
102690200528     C                     ENDSR                                          CFT009
102700200528      /SPACE 5                                                            CFT009
102710200528      *****************************************************************   CFT009
102720200528      * Subroutine  :  OTEURC                                         *   CFT009
102730200528      * Function    :  Euro charges                                   *   CFT009
102740200528      *                                                               *   CFT009
102750200528      * Called by   :  DRCR02                                         *   CFT009
102760200528      * Calls       :                                                 *   CFT009
102770200528      *****************************************************************   CFT009
102780200528     C           OTEURC    BEGSR                                          CFT009
102790200528      *                                                                   CFT009
102800200528      **  Set up subroutine stack name                                    CFT009
102810200528     C                     ADD  1         Q                               CFT009
102820200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
102830200528      *                                                                   CFT009
102840200528      *................................................................   CFT009
102850200528      *                                                                   CFT009
102860200528      **  Retrieve subroutine specific data.                              CFT009
102870200528     C           1         OCUR ##SRDT                                    CFT009
102880200528     C                     MOVEL##SPAT    S#PATH                          CFT009
102890200528      *                                                                   CFT009
102900200528      **  Set up Path.                                                    CFT009
102910200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
102920200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
102930200528      *                                                                                       CCG015
102940200528     C                     EXSR PSHGRS                                                        CCG015
102950200528      *                                                                   CFT009
102960200528      **  Retrieve RDE information for RDEs in group set                  CFT009
102970200528      *                                                                   CFT009
102980200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
102990200528     C                     Z-ADD1         ##RDEN                          CFT009
103000200528     C                     EXSR SRRRDE                                    CFT009
103010200528      *                                                                   CFT009
103020200528      **  Determine the number of decimal places for Euro                 CFT009
103030200528      *                                                                   CFT009
103040200528     C                     CALL 'AOCURRR0'                                CFT009
103050200528     C                     PARM *BLANKS   @RTCD                           CFT009
103060200528     C                     PARM '*KEY   ' @OPTN                           CFT009
103070200528     C                     PARM BKEURO    @AJCD                           CFT009
103080200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
103090200528      *                                                                   CFT009
103100200528      ** DATABASE ERROR                                                   CFT009
103110200528     C           @RTCD     IFNE *BLANK                                    CFT009
103120200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
103130200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
103140200528     C                     Z-ADD50        W0ERNB           * DB ERROR 50 *CFT009
103150200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
103160200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
103170200528     C                     EXSR SRERR                                     CFT009
103180200528     C                     ENDIF                                          CFT009
103190200528      *                                                                   CFT009
103200200528      ** Euro Currency                                                    CFT009
103210200528     C                     MOVELBKEURO    ##D,1                           CFT009
103220200528     C                     MOVELBKEURO    #CCY                            CFT009
103230200528      *                                                                   CFT009
103240200528     C                     CLEARP#0010                                    CFT009
103250200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103260200528     C                     Z-ADDTRCM      P#FRAM                          CFT009
103270200528     C                     EXSR EURAMT                                    CFT009
103280200528     C                     MOVELW#TOAM    ##D,2                           CFT009
103290200528     C                     MOVE A6NBDP    ##D,2                           CFT009
103300200528      *                                                                   CFT009
103310200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
103320200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
103330200528      *                                                                   CFT009
103340200528     C                     CLEARP#0010                                    CFT009
103350200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103360200528     C                     Z-ADDOPCHCM    P#FRAM                          CFT009
103370200528     C                     EXSR EURAMT                                    CFT009
103380200528     C                     MOVELW#TOAM    ##D,3                           CFT009
103390200528     C                     MOVE A6NBDP    ##D,3                           CFT009
103400200528      *                                                                   CFT009
103410200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
103420200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103430200528      *                                                                   CFT009
103440200528     C                     CLEARP#0010                                    CFT009
103450200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103460200528     C                     Z-ADDCQCH      P#FRAM                          CFT009
103470200528     C                     EXSR EURAMT                                    CFT009
103480200528     C                     MOVELW#TOAM    ##D,5                           CFT009
103490200528     C                     MOVE A6NBDP    ##D,5                           CFT009
103500200528      *                                                                   CFT009
103510200528     C                     Z-ADDW#TOAM    VAT2   170                      CFT009
103520200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103530200528      *                                                                   CFT009
103540200528     C                     CLEARP#0010                                    CFT009
103550200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103560200528     C                     Z-ADDCSTA      P#FRAM                          CFT009
103570200528     C                     EXSR EURAMT                                    CFT009
103580200528     C                     MOVELW#TOAM    ##D,6                           CFT009
103590200528     C                     MOVE A6NBDP    ##D,6                           CFT009
103600200528      *                                                                   CFT009
103610200528     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
103620200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103630200528      *                                                                   CFT009
103640200528     C                     CLEARP#0010                                    CFT009
103650200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103660200528     C                     Z-ADDTXCH      P#FRAM                          CFT009
103670200528     C                     EXSR EURAMT                                    CFT009
103680200528     C                     MOVELW#TOAM    ##D,4                           CFT009
103690200528     C                     MOVE A6NBDP    ##D,4                           CFT009
103700200528      *                                                                   CFT009
103710200528     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
103720200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103730200528      *                                                                   CFT009
103740200528     C                     CLEARP#0010                                    CFT009
103750200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103760200528     C                     Z-ADDSPCH      P#FRAM                          CFT009
103770200528     C                     EXSR EURAMT                                    CFT009
103780200528     C                     MOVELW#TOAM    ##D,16                          CFT009
103790200528     C                     MOVE A6NBDP    ##D,16                          CFT009
103800200528      *                                                                   CFT009
103810200528     C                     Z-ADDW#TOAM    VAT5   170                      CFT009
103820200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103830200528      *                                                                   CFT009
103840200528     C                     CLEARP#0010                                    CFT009
103850200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103860200528     C                     Z-ADDSWSCHG    P#FRAM                          CFT009
103870200528     C                     EXSR EURAMT                                    CFT009
103880200528     C                     MOVELW#TOAM    ##D,7                           CFT009
103890200528     C                     MOVE A6NBDP    ##D,7                           CFT009
103900200528      *                                                                   CFT009
103910200528     C                     Z-ADDW#TOAM    VAT4   170                      CFT009
103920200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
103930200528      *                                                                   CFT009
103940200528     C                     CLEARP#0010                                    CFT009
103950200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
103960200528     C                     Z-ADDMSCH      P#FRAM                          CFT009
103970200528     C                     EXSR EURAMT                                    CFT009
103980200528     C                     MOVELW#TOAM    ##D,11                          CFT009
103990200528     C                     MOVE A6NBDP    ##D,11                          CFT009
104000200528      *                                                                   CFT009
104010200528     C                     Z-ADDW#TOAM    VAT6   170                      CFT009
104020200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104030200528      *                                                                   CFT009
104040200528     C                     CLEARP#0010                                    CFT009
104050200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
104060200528     C                     Z-ADDMISC01    P#FRAM                          CFT009
104070200528     C                     EXSR EURAMT                                    CFT009
104080200528     C                     MOVELW#TOAM    ##D,17                          CFT009
104090200528     C                     MOVE A6NBDP    ##D,17                          CFT009
104100200528      *                                                                   CFT009
104110200528     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
104120200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104130200528      *                                                                   CFT009
104140200528     C                     CLEARP#0010                                    CFT009
104150200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
104160200528     C                     Z-ADDMISC02    P#FRAM                          CFT009
104170200528     C                     EXSR EURAMT                                    CFT009
104180200528     C                     MOVELW#TOAM    ##D,18                          CFT009
104190200528     C                     MOVE A6NBDP    ##D,18                          CFT009
104200200528      *                                                                   CFT009
104210200528     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
104220200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104230200528      *                                                                   CFT009
104240200528     C                     CLEARP#0010                                    CFT009
104250200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
104260200528     C                     Z-ADDMISC03    P#FRAM                          CFT009
104270200528     C                     EXSR EURAMT                                    CFT009
104280200528     C                     MOVELW#TOAM    ##D,19                          CFT009
104290200528     C                     MOVE A6NBDP    ##D,19                          CFT009
104300200528      *                                                                   CFT009
104310200528     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
104320200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104330200528      *                                                                   CFT009
104340200528     C                     CLEARP#0010                                    CFT009
104350200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
104360200528     C                     Z-ADDMISC04    P#FRAM                          CFT009
104370200528     C                     EXSR EURAMT                                    CFT009
104380200528     C                     MOVELW#TOAM    ##D,20                          CFT009
104390200528     C                     MOVE A6NBDP    ##D,20                          CFT009
104400200528      *                                                                   CFT009
104410200528     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
104420200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104430200528      *                                                                   CFT009
104440200528      **  Accumulate RDE's and associated data and output to              CFT009
104450200528      **  PF/CGUDTAPD.                                                    CFT009
104460200528      *                                                                   CFT009
104470200528     C                     EXSR SRADTA                                    CFT009
104480200528     C                     MOVEL##SDS     ##ADS                           CFT009
104490200528      *                                                                   CFT009
104500200528      **  Retrieve RDE information for RDEs in group set                  CFT009
104510200528      *                                                                   CFT009
104520200528     C                     Z-ADD21        ##RDEN                          CFT009
104530200528     C                     EXSR SRRRDE                                    CFT009
104540200528      *                                                                   CFT009
104550200528     C                     CLEARP#0010                                    CFT009
104560200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
104570200528     C                     Z-ADDMISC05    P#FRAM                          CFT009
104580200528     C                     EXSR EURAMT                                    CFT009
104590200528     C                     MOVELW#TOAM    ##D,1                           CFT009
104600200528     C                     MOVE A6NBDP    ##D,1                           CFT009
104610200528      *                                                                   CFT009
104620200528     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
104630200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
104640200528      *                                                                   CFT009
104650200528      **  Accumulate RDE's and associated data and output to              CFT009
104660200528      **  PF/CGUDTAPD.                                                    CFT009
104670200528     C                     EXSR SRADTA                                    CFT009
104680200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
104690200528      *                                                                   CFT009
104700200528      **  Initialise Write Format Parameter.                              CFT009
104710200528     C                     CLEARW0FMT                                     CFT009
104720200528      *                                                                   CFT009
104730200528      **  Set up Control Information.                                     CFT009
104740200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
104750200528     C                     ADD  1         ##OSEQ                          CFT009
104760200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
104770200528     C                     Z-ADD1         DEPBIN                          CFT009
104780200528     C                     Z-ADD1         DETBIN                          CFT009
104790200528     C                     MOVE 'FR'      DEFSLI                          CFT009
104800200528     C                     MOVE *BLANKS   W0PATH                          CFT009
104810200528     C                     MOVELS#PATH    W0PATH                          CFT009
104820200528      *                                                                   CFT009
104830200528      **  Append Data from pack routine.                                  CFT009
104840200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
104850200528     C                     EXSR SRODTA                                    CFT009
104860200528      *                                                                                       CCG015
104870200528     C                     EXSR POPGRS                                                        CCG015
104880200528      *                                                                   CFT009
104890200528      *................................................................   CFT009
104900200528      **  Unwind subroutine stack name                                    CFT009
104910200528      *                                                                   CFT009
104920200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
104930200528     C                     SUB  1         Q                               CFT009
104940200528      *                                                                   CFT009
104950200528     C                     ENDSR                                          CFT009
104960200528      *                                                                   CFT009
104970200528      /SPACE 5                                                            CFT009
104980200528      *****************************************************************   CFT009
104990200528      * Subroutine  :  OTVATE                                         *   CFT009
105000200528      * Function    :  Euro Charges VAT                               *   CFT009
105010200528      *                                                               *   CFT009
105020200528      * Called by   :  DRCR02                                         *   CFT009
105030200528      * Calls       :                                                 *   CFT009
105040200528      *****************************************************************   CFT009
105050200528     C           OTVATE    BEGSR                                          CFT009
105060200528      *                                                                   CFT009
105070200528      **  Set up subroutine stack name                                    CFT009
105080200528     C                     ADD  1         Q                               CFT009
105090200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
105100200528      *                                                                   CFT009
105110200528      *................................................................   CFT009
105120200528      *                                                                   CFT009
105130200528      **  Retrieve subroutine specific data.                              CFT009
105140200528     C           1         OCUR ##SRDT                                    CFT009
105150200528     C                     MOVEL##SPAT    S#PATH                          CFT009
105160200528      *                                                                   CFT009
105170200528      **  Set up Path.                                                    CFT009
105180200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
105190200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
105200200528      *                                                                                       CCG015
105210200528     C                     EXSR PSHGRS                                                        CCG015
105220200528      *                                                                   CFT009
105230200528      **  Retrieve RDE information for RDEs in group set                  CFT009
105240200528      *                                                                   CFT009
105250200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
105260200528     C                     Z-ADD1         ##RDEN                          CFT009
105270200528     C                     EXSR SRRRDE                                    CFT009
105280200528      *                                                                   CFT009
105290200528     C                     Z-ADD0         SUMVAT                          CFT009
105300200528      *                                                                   CFT009
105310200528     C           CFT10     IFEQ 'Y'                                       CFT009
105320200528      *                                                                   CFT009
105330200528     C           OPVAT1    IFEQ 'Y'                                       CFT009
105340200528     C           OPVATR    MULT VAT12     VAT    150H                     CFT009
105350200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
105360200528     C                     ELSE                                           CFT009
105370200528     C                     Z-ADD0         VAT                             CFT009
105380200528     C                     Z-ADD0         SUMVAT                          CFT009
105390200528     C                     ENDIF                                          CFT009
105400200528      *                                                                   CFT009
105410200528     C                     MOVELVAT       ##D,12                          CFT009
105420200528     C                     MOVE A6NBDP    ##D,12                          CFT009
105430200528      *                                                                   CFT009
105440200528     C           OPVAT7    IFEQ 'Y'                                       CFT009
105450200528     C           OPVATR    MULT VAT13     VAT       H                     CFT009
105460200528     C                     ELSE                                           CFT009
105470200528     C                     Z-ADD0         VAT                             CFT009
105480200528     C                     ENDIF                                          CFT009
105490200528      *                                                                   CFT009
105500200528     C                     ADD  VAT       SUMVAT                          CFT009
105510200528     C                     MOVELVAT       ##D,13                          CFT009
105520200528     C                     MOVE A6NBDP    ##D,13                          CFT009
105530200528      *                                                                   CFT009
105540200528     C           OPVAT3    IFEQ 'Y'                                       CFT009
105550200528     C           OPVATR    MULT VAT2      VAT       H                     CFT009
105560200528     C                     ELSE                                           CFT009
105570200528     C                     Z-ADD0         VAT                             CFT009
105580200528     C                     ENDIF                                          CFT009
105590200528      *                                                                   CFT009
105600200528     C                     ADD  VAT       SUMVAT                          CFT009
105610200528     C                     MOVELVAT       ##D,2                           CFT009
105620200528     C                     MOVE A6NBDP    ##D,2                           CFT009
105630200528      *                                                                   CFT009
105640200528     C           OPVAT4    IFEQ 'Y'                                       CFT009
105650200528     C           OPVATR    MULT VAT3      VAT       H                     CFT009
105660200528     C                     ELSE                                           CFT009
105670200528     C                     Z-ADD0         VAT                             CFT009
105680200528     C                     ENDIF                                          CFT009
105690200528      *                                                                   CFT009
105700200528     C                     ADD  VAT       SUMVAT                          CFT009
105710200528     C                     MOVELVAT       ##D,3                           CFT009
105720200528     C                     MOVE A6NBDP    ##D,3                           CFT009
105730200528      *                                                                   CFT009
105740200528     C           OPVAT2    IFEQ 'Y'                                       CFT009
105750200528     C           OPVATR    MULT VAT1      VAT       H                     CFT009
105760200528     C                     ELSE                                           CFT009
105770200528     C                     Z-ADD0         VAT                             CFT009
105780200528     C                     ENDIF                                          CFT009
105790200528      *                                                                   CFT009
105800200528     C                     ADD  VAT       SUMVAT                          CFT009
105810200528     C                     MOVELVAT       ##D,1                           CFT009
105820200528     C                     MOVE A6NBDP    ##D,1                           CFT009
105830200528      *                                                                   CFT009
105840200528     C           OPVAT5    IFEQ 'Y'                                       CFT009
105850200528     C           OPVATR    MULT VAT5      VAT       H                     CFT009
105860200528     C                     ELSE                                           CFT009
105870200528     C                     Z-ADD0         VAT                             CFT009
105880200528     C                     ENDIF                                          CFT009
105890200528      *                                                                   CFT009
105900200528     C                     ADD  VAT       SUMVAT                          CFT009
105910200528     C                     MOVELVAT       ##D,5                           CFT009
105920200528     C                     MOVE A6NBDP    ##D,5                           CFT009
105930200528      *                                                                   CFT009
105940200528     C           VTSWSC    IFEQ 'Y'                                       CFT009
105950200528     C           OPVATR    MULT VAT4      VAT       H                     CFT009
105960200528     C                     ELSE                                           CFT009
105970200528     C                     Z-ADD0         VAT                             CFT009
105980200528     C                     ENDIF                                          CFT009
105990200528      *                                                                   CFT009
106000200528     C                     ADD  VAT       SUMVAT                          CFT009
106010200528     C                     MOVELVAT       ##D,4                           CFT009
106020200528     C                     MOVE A6NBDP    ##D,4                           CFT009
106030200528      *                                                                   CFT009
106040200528     C           OPVAT6    IFEQ 'Y'                                       CFT009
106050200528     C           OPVATR    MULT VAT6      VAT       H                     CFT009
106060200528     C                     ELSE                                           CFT009
106070200528     C                     Z-ADD0         VAT                             CFT009
106080200528     C                     ENDIF                                          CFT009
106090200528      *                                                                   CFT009
106100200528     C                     ADD  VAT       SUMVAT                          CFT009
106110200528     C                     MOVELVAT       ##D,6                           CFT009
106120200528     C                     MOVE A6NBDP    ##D,6                           CFT009
106130200528      *                                                                   CFT009
106140200528     C           VMIC1     IFEQ 'Y'                                       CFT009
106150200528     C           OPVATR    MULT VAT7      VAT       H                     CFT009
106160200528     C                     ELSE                                           CFT009
106170200528     C                     Z-ADD0         VAT                             CFT009
106180200528     C                     ENDIF                                          CFT009
106190200528      *                                                                   CFT009
106200200528     C                     ADD  VAT       SUMVAT                          CFT009
106210200528     C                     MOVELVAT       ##D,7                           CFT009
106220200528     C                     MOVE A6NBDP    ##D,7                           CFT009
106230200528      *                                                                   CFT009
106240200528     C           VMIC2     IFEQ 'Y'                                       CFT009
106250200528     C           OPVATR    MULT VAT8      VAT       H                     CFT009
106260200528     C                     ELSE                                           CFT009
106270200528     C                     Z-ADD0         VAT                             CFT009
106280200528     C                     ENDIF                                          CFT009
106290200528      *                                                                   CFT009
106300200528     C                     ADD  VAT       SUMVAT                          CFT009
106310200528     C                     MOVELVAT       ##D,8                           CFT009
106320200528     C                     MOVE A6NBDP    ##D,8                           CFT009
106330200528      *                                                                   CFT009
106340200528     C           VMIC3     IFEQ 'Y'                                       CFT009
106350200528     C           OPVATR    MULT VAT9      VAT       H                     CFT009
106360200528     C                     ELSE                                           CFT009
106370200528     C                     Z-ADD0         VAT                             CFT009
106380200528     C                     ENDIF                                          CFT009
106390200528      *                                                                   CFT009
106400200528     C                     ADD  VAT       SUMVAT                          CFT009
106410200528     C                     MOVELVAT       ##D,9                           CFT009
106420200528     C                     MOVE A6NBDP    ##D,9                           CFT009
106430200528      *                                                                   CFT009
106440200528     C           VMIC4     IFEQ 'Y'                                       CFT009
106450200528     C           OPVATR    MULT VAT10     VAT       H                     CFT009
106460200528     C                     ELSE                                           CFT009
106470200528     C                     Z-ADD0         VAT                             CFT009
106480200528     C                     ENDIF                                          CFT009
106490200528      *                                                                   CFT009
106500200528     C                     ADD  VAT       SUMVAT                          CFT009
106510200528     C                     MOVELVAT       ##D,10                          CFT009
106520200528     C                     MOVE A6NBDP    ##D,10                          CFT009
106530200528      *                                                                   CFT009
106540200528     C           VMIC5     IFEQ 'Y'                                       CFT009
106550200528     C           OPVATR    MULT VAT11     VAT       H                     CFT009
106560200528     C                     ELSE                                           CFT009
106570200528     C                     Z-ADD0         VAT                             CFT009
106580200528     C                     ENDIF                                          CFT009
106590200528      *                                                                   CFT009
106600200528     C                     ADD  VAT       SUMVAT                          CFT009
106610200528     C                     MOVELVAT       ##D,11                          CFT009
106620200528     C                     MOVE A6NBDP    ##D,11                          CFT009
106630200528      *                                                                   CFT009
106640200528     C                     ENDIF                                          CFT009
106650200528      *                                                                   CFT009
106660200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
106670200528     C                     MOVELSUMCHG    ##D,17                          CFT009
106680200528     C                     MOVE A6NBDP    ##D,17                          CFT009
106690200528      *                                                                   CFT009
106700200528      **  Accumulate RDE's and associated data and output to              CFT009
106710200528      **  PF/CGUDTAPD.                                                    CFT009
106720200528      *                                                                   CFT009
106730200528     C                     EXSR SRADTA                                    CFT009
106740200528     C                     EXSR SRODTA                                    CFT009
106750200528      *                                                                                       CCG015
106760200528     C                     EXSR POPGRS                                                        CCG015
106770200528      *................................................................   CFT009
106780200528      **  Unwind subroutine stack name                                    CFT009
106790200528      *                                                                   CFT009
106800200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
106810200528     C                     SUB  1         Q                               CFT009
106820200528      *                                                                   CFT009
106830200528     C                     ENDSR                                          CFT009
106840200528      *                                                                   CFT009
106850200528      /SPACE 5                                                            CFT009
106860200528      *****************************************************************   CFT009
106870200528      * Subroutine  :  CPFEES                                         *   CFT009
106880200528      * Function    :  Fees & Charges Information                     *   CFT009
106890200528      *                                                               *   CFT009
106900200528      * Called by   :  DRCR03                                         *   CFT009
106910200528      * Calls       :                                                 *   CFT009
106920200528      *****************************************************************   CFT009
106930200528     C           CPFEES    BEGSR                                          CFT009
106940200528      *                                                                   CFT009
106950200528      **  Set up subroutine stack name                                    CFT009
106960200528     C                     ADD  1         Q                               CFT009
106970200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
106980200528      *                                                                   CFT009
106990200528      *................................................................   CFT009
107000200528      *                                                                   CFT009
107010200528      **  Retrieve subroutine specific data.                              CFT009
107020200528     C           1         OCUR ##SRDT                                    CFT009
107030200528     C                     MOVEL##SPAT    S#PATH                          CFT009
107040200528      *                                                                   CFT009
107050200528      **  Set up Path.                                                    CFT009
107060200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
107070200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
107080200528      *                                                                                       CCG015
107090200528     C                     EXSR PSHGRS                                                        CCG015
107100200528      *                                                                   CFT009
107110200528      **  Retrieve RDE information for RDEs in group set                  CFT009
107120200528      *                                                                   CFT009
107130200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
107140200528     C                     Z-ADD1         ##RDEN                          CFT009
107150200528     C                     EXSR SRRRDE                                    CFT009
107160200528      *                                                                   CFT009
107170200528     C                     MOVEL'Y'       ##D,1                           CFT009
107180200528      *                                                                   CFT009
107190200528      ** Charge code                                                      CFT009
107200200528      *                                                                   CFT009
107210200528     C                     MOVELTFCMCC    ##D,13                          CFT009
107220200528     C                     MOVELFCHCCC    ##D,14                          CFT009
107230200528     C                     MOVELCSTACD    ##D,4                           CFT009
107240200528     C                     MOVELCOLCGC    ##D,17                          CFT009
107250200528      *                                                                   CFT009
107260200528     C           CFT10     IFEQ 'Y'                                       CFT009
107270200528     C                     MOVEL'Y'       ##D,18                          CFT009
107280200528     C                     ENDIF                                          CFT009
107290200528      *                                                                   CFT009
107300200528      ** FX Spread Set                                                    CFT009
107310200528      *                                                                   CFT009
107320200528     C                     MOVELFXSSET    ##D,19                          CFT009
107330200528      *                                                                   CFT009
107340200528      **  Accumulate RDE's and associated data and output to              CFT009
107350200528      **  PF/CGUDTAPD.                                                    CFT009
107360200528      *                                                                   CFT009
107370200528     C                     EXSR SRADTA                                    CFT009
107380200528     C                     EXSR SRODTA                                    CFT009
107390200528      *                                                                                       CCG015
107400200528     C                     EXSR POPGRS                                                        CCG015
107410200528      *                                                                   CFT009
107420200528      *................................................................   CFT009
107430200528      **  Unwind subroutine stack name                                    CFT009
107440200528      *                                                                   CFT009
107450200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
107460200528     C                     SUB  1         Q                               CFT009
107470200528      *                                                                   CFT009
107480200528     C                     ENDSR                                          CFT009
107490200528      /SPACE 5                                                            CFT009
107500200528      *****************************************************************   CFT009
107510200528      * Subroutine  :  CPENTC                                         *   CFT009
107520200528      * Function    :  Entered Charges                                *   CFT009
107530200528      *                                                               *   CFT009
107540200528      * Called by   :  DRCR03                                         *   CFT009
107550200528      * Calls       :                                                 *   CFT009
107560200528      *****************************************************************   CFT009
107570200528     C           CPENTC    BEGSR                                          CFT009
107580200528      *                                                                   CFT009
107590200528      **  Set up subroutine stack name                                    CFT009
107600200528     C                     ADD  1         Q                               CFT009
107610200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
107620200528      *                                                                   CFT009
107630200528      *................................................................   CFT009
107640200528      *                                                                   CFT009
107650200528      **  Retrieve subroutine specific data.                              CFT009
107660200528     C           1         OCUR ##SRDT                                    CFT009
107670200528     C                     MOVEL##SPAT    S#PATH                          CFT009
107680200528      *                                                                   CFT009
107690200528      **  Set up Path.                                                    CFT009
107700200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
107710200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
107720200528      *                                                                                       CCG015
107730200528     C                     EXSR PSHGRS                                                        CCG015
107740200528      *                                                                   CFT009
107750200528      **  Retrieve RDE information for RDEs in group set                  CFT009
107760200528      *                                                                   CFT009
107770200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
107780200528     C                     Z-ADD1         ##RDEN                          CFT009
107790200528     C                     EXSR SRRRDE                                    CFT009
107800200528      *                                                                   CFT009
107810200528     C                     MOVELDRCY      ##WCCY  3                       CFT009
107820200528      *                                                                   CFT009
107830200528      **  Charge currency                                                 CFT009
107840200528     C                     MOVEL##WCCY    ##D,1                           CFT009
107850200528      *                                                                   CFT009
107860200528      **  Obtain currency details                                         CFT009
107870200528     C                     CALL 'AOCURRR0'                                CFT009
107880200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
107890200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
107900200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
107910200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
107920200528      *                                                                   CFT009
107930200528      ** DATABASE ERROR                                                   CFT009
107940200528      *                                                                   CFT009
107950200528     C           @RTCD     IFNE *BLANK                                    CFT009
107960200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
107970200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
107980200528     C                     Z-ADD51        W0ERNB           * DB ERROR 51 *CFT009
107990200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
108000200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
108010200528     C                     EXSR SRERR                                     CFT009
108020200528     C                     ENDIF                                          CFT009
108030200528      *                                                                   CFT009
108040200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
108050200528      *                                                                   CFT009
108060200528      ** Amount                                                           CFT009
108070200528      *                                                                   CFT009
108080200528     C                     MOVELTRCM      ##D,2                           CFT009
108090200528     C                     MOVE A6NBDP    ##D,2                           CFT009
108100200528     C                     MOVELPDCHCM    ##D,3                           CFT009
108110200528     C                     MOVE A6NBDP    ##D,3                           CFT009
108120200528     C                     MOVELCSTA      ##D,6                           CFT009
108130200528     C                     MOVE A6NBDP    ##D,6                           CFT009
108140200528     C                     MOVELCOLL      ##D,8                           CFT009
108150200528     C                     MOVE A6NBDP    ##D,8                           CFT009
108160200528      *                                                                   CFT009
108170200528      **  Accumulate RDE's and associated data and output to              CFT009
108180200528      **  PF/CGUDTAPD.                                                    CFT009
108190200528      *                                                                   CFT009
108200200528     C                     EXSR SRADTA                                    CFT009
108210200528     C                     EXSR SRODTA                                    CFT009
108220200528      *                                                                   CFT009
108230200528      ** Totals                                                           CFT009
108240200528      *                                                                   CFT009
108250200528     C           TRCM      ADD  PDCHCM    SUMAMT 150                      CFT009
108260200528     C                     ADD  CSTA      SUMAMT                          CFT009
108270200528     C                     ADD  COLL      SUMAMT                          CFT009
108280200528      *                                                                                       CCG015
108290200528     C                     EXSR POPGRS                                                        CCG015
108300200528      *                                                                   CFT009
108310200528      *................................................................   CFT009
108320200528      **  Unwind subroutine stack name                                    CFT009
108330200528      *                                                                   CFT009
108340200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
108350200528     C                     SUB  1         Q                               CFT009
108360200528      *                                                                   CFT009
108370200528     C                     ENDSR                                          CFT009
108380200528      /SPACE 5                                                            CFT009
108390200528      *****************************************************************   CFT009
108400200528      * Subroutine  :  CPVATA                                         *   CFT009
108410200528      * Function    :  Entered Charges VAT                            *   CFT009
108420200528      *                                                               *   CFT009
108430200528      * Called by   :  DRCR03                                         *   CFT009
108440200528      * Calls       :                                                 *   CFT009
108450200528      *****************************************************************   CFT009
108460200528     C           CPVATA    BEGSR                                          CFT009
108470200528      *                                                                   CFT009
108480200528      **  Set up subroutine stack name                                    CFT009
108490200528     C                     ADD  1         Q                               CFT009
108500200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
108510200528      *                                                                   CFT009
108520200528      *................................................................   CFT009
108530200528      *                                                                   CFT009
108540200528      **  Retrieve subroutine specific data.                              CFT009
108550200528     C           1         OCUR ##SRDT                                    CFT009
108560200528     C                     MOVEL##SPAT    S#PATH                          CFT009
108570200528      *                                                                   CFT009
108580200528      **  Set up Path.                                                    CFT009
108590200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
108600200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
108610200528      *                                                                                       CCG015
108620200528     C                     EXSR PSHGRS                                                        CCG015
108630200528      *                                                                   CFT009
108640200528      **  Retrieve RDE information for RDEs in group set                  CFT009
108650200528      *                                                                   CFT009
108660200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
108670200528     C                     Z-ADD1         ##RDEN                          CFT009
108680200528     C                     EXSR SRRRDE                                    CFT009
108690200528      *                                                                   CFT009
108700200528     C                     Z-ADD0         SUMVAT                          CFT009
108710200528      *                                                                   CFT009
108720200528     C           CFT10     IFEQ 'Y'                                       CFT009
108730200528      *                                                                   CFT009
108740200528     C           PDVAT1    IFEQ 'Y'                                       CFT009
108750200528     C           PDVATR    MULT TRCM      VAT    150H                     CFT009
108760200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
108770200528     C                     ELSE                                           CFT009
108780200528     C                     Z-ADD0         VAT                             CFT009
108790200528     C                     Z-ADD0         SUMVAT                          CFT009
108800200528     C                     ENDIF                                          CFT009
108810200528      *                                                                   CFT009
108820200528     C                     MOVELVAT       ##D,12                          CFT009
108830200528     C                     MOVE A6NBDP    ##D,12                          CFT009
108840200528      *                                                                   CFT009
108850200528     C           PDVAT4    IFEQ 'Y'                                       CFT009
108860200528     C           PDVATR    MULT PDCHCM    VAT       H                     CFT009
108870200528     C                     ELSE                                           CFT009
108880200528     C                     Z-ADD0         VAT                             CFT009
108890200528     C                     ENDIF                                          CFT009
108900200528      *                                                                   CFT009
108910200528     C                     ADD  VAT       SUMVAT                          CFT009
108920200528     C                     MOVELVAT       ##D,13                          CFT009
108930200528     C                     MOVE A6NBDP    ##D,13                          CFT009
108940200528      *                                                                   CFT009
108950200528     C           PDVAT3    IFEQ 'Y'                                       CFT009
108960200528     C           PDVATR    MULT CSTA      VAT       H                     CFT009
108970200528     C                     ELSE                                           CFT009
108980200528     C                     Z-ADD0         VAT                             CFT009
108990200528     C                     ENDIF                                          CFT009
109000200528      *                                                                   CFT009
109010200528     C                     ADD  VAT       SUMVAT                          CFT009
109020200528     C                     MOVELVAT       ##D,3                           CFT009
109030200528     C                     MOVE A6NBDP    ##D,3                           CFT009
109040200528      *                                                                   CFT009
109050200528     C           PDVAT2    IFEQ 'Y'                                       CFT009
109060200528     C           PDVATR    MULT COLL      VAT       H                     CFT009
109070200528     C                     ELSE                                           CFT009
109080200528     C                     Z-ADD0         VAT                             CFT009
109090200528     C                     ENDIF                                          CFT009
109100200528      *                                                                   CFT009
109110200528     C                     ADD  VAT       SUMVAT                          CFT009
109120200528     C                     MOVELVAT       ##D,16                          CFT009
109130200528     C                     MOVE A6NBDP    ##D,16                          CFT009
109140200528      *                                                                   CFT009
109150200528     C                     ENDIF                                          CFT009
109160200528      *                                                                   CFT009
109170200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
109180200528     C                     MOVELSUMCHG    ##D,17                          CFT009
109190200528     C                     MOVE A6NBDP    ##D,17                          CFT009
109200200528      *                                                                   CFT009
109210200528      **  Accumulate RDE's and associated data and output to              CFT009
109220200528      **  PF/CGUDTAPD.                                                    CFT009
109230200528     C                     EXSR SRADTA                                    CFT009
109240200528     C                     EXSR SRODTA                                    CFT009
109250200528      *                                                                                       CCG015
109260200528     C                     EXSR POPGRS                                                        CCG015
109270200528      *                                                                   CFT009
109280200528      *................................................................   CFT009
109290200528      **  Unwind subroutine stack name                                    CFT009
109300200528      *                                                                   CFT009
109310200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
109320200528     C                     SUB  1         Q                               CFT009
109330200528      *                                                                   CFT009
109340200528     C                     ENDSR                                          CFT009
109350200528      /SPACE 5                                                            CFT009
109360200528      *****************************************************************   CFT009
109370200528      * Subroutine  :  CPEURC                                         *   CFT009
109380200528      * Function    :  Euro charges                                   *   CFT009
109390200528      *                                                               *   CFT009
109400200528      * Called by   :  DRCR03                                         *   CFT009
109410200528      * Calls       :                                                 *   CFT009
109420200528      *****************************************************************   CFT009
109430200528     C           CPEURC    BEGSR                                          CFT009
109440200528      *                                                                   CFT009
109450200528      **  Set up subroutine stack name                                    CFT009
109460200528     C                     ADD  1         Q                               CFT009
109470200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
109480200528      *                                                                   CFT009
109490200528      *................................................................   CFT009
109500200528      *                                                                   CFT009
109510200528      **  Retrieve subroutine specific data.                              CFT009
109520200528     C           1         OCUR ##SRDT                                    CFT009
109530200528     C                     MOVEL##SPAT    S#PATH                          CFT009
109540200528      *                                                                   CFT009
109550200528      **  Set up Path.                                                    CFT009
109560200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
109570200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
109580200528      *                                                                                       CCG015
109590200528     C                     EXSR PSHGRS                                                        CCG015
109600200528      *                                                                   CFT009
109610200528      **  Retrieve RDE information for RDEs in group set                  CFT009
109620200528      *                                                                   CFT009
109630200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
109640200528     C                     Z-ADD1         ##RDEN                          CFT009
109650200528     C                     EXSR SRRRDE                                    CFT009
109660200528      *                                                                   CFT009
109670200528      **  Determine the number of decimal places for Euro                 CFT009
109680200528      *                                                                   CFT009
109690200528     C                     CALL 'AOCURRR0'                                CFT009
109700200528     C                     PARM *BLANKS   @RTCD                           CFT009
109710200528     C                     PARM '*KEY   ' @OPTN                           CFT009
109720200528     C                     PARM BKEURO    @AJCD                           CFT009
109730200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
109740200528      *                                                                   CFT009
109750200528      ** DATABASE ERROR                                                   CFT009
109760200528     C           @RTCD     IFNE *BLANK                                    CFT009
109770200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
109780200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
109790200528     C                     Z-ADD52        W0ERNB           * DB ERROR 52 *CFT009
109800200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
109810200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
109820200528     C                     EXSR SRERR                                     CFT009
109830200528     C                     ENDIF                                          CFT009
109840200528      *                                                                   CFT009
109850200528      ** Euro Currency                                                    CFT009
109860200528     C                     MOVELBKEURO    ##D,1                           CFT009
109870200528     C                     MOVELBKEURO    #CCY                            CFT009
109880200528      *                                                                   CFT009
109890200528     C                     CLEARP#0010                                    CFT009
109900200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
109910200528     C                     Z-ADDTRCM      P#FRAM                          CFT009
109920200528     C                     EXSR EURAMT                                    CFT009
109930200528     C                     MOVELW#TOAM    ##D,2                           CFT009
109940200528     C                     MOVE A6NBDP    ##D,2                           CFT009
109950200528      *                                                                   CFT009
109960200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
109970200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
109980200528      *                                                                   CFT009
109990200528     C                     CLEARP#0010                                    CFT009
110000200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
110010200528     C                     Z-ADDPDCHCM    P#FRAM                          CFT009
110020200528     C                     EXSR EURAMT                                    CFT009
110030200528     C                     MOVELW#TOAM    ##D,3                           CFT009
110040200528     C                     MOVE A6NBDP    ##D,3                           CFT009
110050200528      *                                                                   CFT009
110060200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
110070200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
110080200528      *                                                                   CFT009
110090200528     C                     CLEARP#0010                                    CFT009
110100200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
110110200528     C                     Z-ADDCSTA      P#FRAM                          CFT009
110120200528     C                     EXSR EURAMT                                    CFT009
110130200528     C                     MOVELW#TOAM    ##D,6                           CFT009
110140200528     C                     MOVE A6NBDP    ##D,6                           CFT009
110150200528      *                                                                   CFT009
110160200528     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
110170200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
110180200528      *                                                                   CFT009
110190200528     C                     CLEARP#0010                                    CFT009
110200200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
110210200528     C                     Z-ADDCOLL      P#FRAM                          CFT009
110220200528     C                     EXSR EURAMT                                    CFT009
110230200528     C                     MOVELW#TOAM    ##D,8                           CFT009
110240200528     C                     MOVE A6NBDP    ##D,8                           CFT009
110250200528      *                                                                   CFT009
110260200528     C                     Z-ADDW#TOAM    VAT16  170                      CFT009
110270200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
110280200528      *                                                                   CFT009
110290200528      **  Accumulate RDE's and associated data and output to              CFT009
110300200528      **  PF/CGUDTAPD.                                                    CFT009
110310200528      *                                                                   CFT009
110320200528     C                     EXSR SRADTA                                    CFT009
110330200528     C                     EXSR SRODTA                                    CFT009
110340200528      *                                                                                       CCG015
110350200528     C                     EXSR POPGRS                                                        CCG015
110360200528      *                                                                   CFT009
110370200528      *................................................................   CFT009
110380200528      **  Unwind subroutine stack name                                    CFT009
110390200528      *                                                                   CFT009
110400200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
110410200528     C                     SUB  1         Q                               CFT009
110420200528      *                                                                   CFT009
110430200528     C                     ENDSR                                          CFT009
110440200528      *                                                                   CFT009
110450200528      /SPACE 5                                                            CFT009
110460200528      *****************************************************************   CFT009
110470200528      * Subroutine  :  CPVATE                                         *   CFT009
110480200528      * Function    :  Euro Charges VAT                               *   CFT009
110490200528      *                                                               *   CFT009
110500200528      * Called by   :  DRCR03                                         *   CFT009
110510200528      * Calls       :                                                 *   CFT009
110520200528      *****************************************************************   CFT009
110530200528     C           CPVATE    BEGSR                                          CFT009
110540200528      *                                                                   CFT009
110550200528      **  Set up subroutine stack name                                    CFT009
110560200528     C                     ADD  1         Q                               CFT009
110570200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
110580200528      *                                                                   CFT009
110590200528      *................................................................   CFT009
110600200528      *                                                                   CFT009
110610200528      **  Retrieve subroutine specific data.                              CFT009
110620200528     C           1         OCUR ##SRDT                                    CFT009
110630200528     C                     MOVEL##SPAT    S#PATH                          CFT009
110640200528      *                                                                   CFT009
110650200528      **  Set up Path.                                                    CFT009
110660200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
110670200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
110680200528      *                                                                                       CCG015
110690200528     C                     EXSR PSHGRS                                                        CCG015
110700200528      *                                                                   CFT009
110710200528      **  Retrieve RDE information for RDEs in group set                  CFT009
110720200528      *                                                                   CFT009
110730200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
110740200528     C                     Z-ADD1         ##RDEN                          CFT009
110750200528     C                     EXSR SRRRDE                                    CFT009
110760200528      *                                                                   CFT009
110770200528     C                     Z-ADD0         SUMVAT                          CFT009
110780200528      *                                                                   CFT009
110790200528     C           CFT10     IFEQ 'Y'                                       CFT009
110800200528      *                                                                   CFT009
110810200528     C           PDVAT1    IFEQ 'Y'                                       CFT009
110820200528     C           PDVATR    MULT VAT12     VAT    150H                     CFT009
110830200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
110840200528     C                     ELSE                                           CFT009
110850200528     C                     Z-ADD0         VAT                             CFT009
110860200528     C                     Z-ADD0         SUMVAT                          CFT009
110870200528     C                     ENDIF                                          CFT009
110880200528      *                                                                   CFT009
110890200528     C                     MOVELVAT       ##D,12                          CFT009
110900200528     C                     MOVE A6NBDP    ##D,12                          CFT009
110910200528      *                                                                   CFT009
110920200528     C           PDVAT4    IFEQ 'Y'                                       CFT009
110930200528     C           PDVATR    MULT VAT13     VAT       H                     CFT009
110940200528     C                     ELSE                                           CFT009
110950200528     C                     Z-ADD0         VAT                             CFT009
110960200528     C                     ENDIF                                          CFT009
110970200528      *                                                                   CFT009
110980200528     C                     ADD  VAT       SUMVAT                          CFT009
110990200528     C                     MOVELVAT       ##D,13                          CFT009
111000200528     C                     MOVE A6NBDP    ##D,13                          CFT009
111010200528      *                                                                   CFT009
111020200528     C           PDVAT3    IFEQ 'Y'                                       CFT009
111030200528     C           PDVATR    MULT VAT3      VAT       H                     CFT009
111040200528     C                     ELSE                                           CFT009
111050200528     C                     Z-ADD0         VAT                             CFT009
111060200528     C                     ENDIF                                          CFT009
111070200528      *                                                                   CFT009
111080200528     C                     ADD  VAT       SUMVAT                          CFT009
111090200528     C                     MOVELVAT       ##D,3                           CFT009
111100200528     C                     MOVE A6NBDP    ##D,3                           CFT009
111110200528      *                                                                   CFT009
111120200528     C           PDVAT2    IFEQ 'Y'                                       CFT009
111130200528     C           PDVATR    MULT VAT16     VAT       H                     CFT009
111140200528     C                     ELSE                                           CFT009
111150200528     C                     Z-ADD0         VAT                             CFT009
111160200528     C                     ENDIF                                          CFT009
111170200528      *                                                                   CFT009
111180200528     C                     ADD  VAT       SUMVAT                          CFT009
111190200528     C                     MOVELVAT       ##D,16                          CFT009
111200200528     C                     MOVE A6NBDP    ##D,16                          CFT009
111210200528      *                                                                   CFT009
111220200528     C                     ENDIF                                          CFT009
111230200528      *                                                                   CFT009
111240200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
111250200528     C                     MOVELSUMCHG    ##D,17                          CFT009
111260200528     C                     MOVE A6NBDP    ##D,17                          CFT009
111270200528      *                                                                   CFT009
111280200528      **  Accumulate RDE's and associated data and output to              CFT009
111290200528      **  PF/CGUDTAPD.                                                    CFT009
111300200528      *                                                                   CFT009
111310200528     C                     EXSR SRADTA                                    CFT009
111320200528     C                     EXSR SRODTA                                    CFT009
111330200528      *                                                                                       CCG015
111340200528     C                     EXSR POPGRS                                                        CCG015
111350200528      *................................................................   CFT009
111360200528      **  Unwind subroutine stack name                                    CFT009
111370200528      *                                                                   CFT009
111380200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
111390200528     C                     SUB  1         Q                               CFT009
111400200528      *                                                                   CFT009
111410200528     C                     ENDSR                                          CFT009
111420200528      *                                                                   CFT009
111430200528      /SPACE 5                                                            CFT009
111440200528      *****************************************************************   CFT009
111450200528      * Subroutine  :  CCFEES                                         *   CFT009
111460200528      * Function    :  Fees & Charges Information                     *   CFT009
111470200528      *                                                               *   CFT009
111480200528      * Called by   :  DRCR04                                         *   CFT009
111490200528      * Calls       :                                                 *   CFT009
111500200528      *****************************************************************   CFT009
111510200528     C           CCFEES    BEGSR                                          CFT009
111520200528      *                                                                   CFT009
111530200528      **  Set up subroutine stack name                                    CFT009
111540200528     C                     ADD  1         Q                               CFT009
111550200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
111560200528      *                                                                   CFT009
111570200528      *................................................................   CFT009
111580200528      *                                                                   CFT009
111590200528      **  Retrieve subroutine specific data.                              CFT009
111600200528     C           1         OCUR ##SRDT                                    CFT009
111610200528     C                     MOVEL##SPAT    S#PATH                          CFT009
111620200528      *                                                                   CFT009
111630200528      **  Set up Path.                                                    CFT009
111640200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
111650200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
111660200528      *                                                                                       CCG015
111670200528     C                     EXSR PSHGRS                                                        CCG015
111680200528      *                                                                   CFT009
111690200528      **  Retrieve RDE information for RDEs in group set                  CFT009
111700200528      *                                                                   CFT009
111710200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
111720200528     C                     Z-ADD1         ##RDEN                          CFT009
111730200528     C                     EXSR SRRRDE                                    CFT009
111740200528      *                                                                   CFT009
111750200528     C                     MOVEL'Y'       ##D,1                           CFT009
111760200528      *                                                                   CFT009
111770200528      ** Charge code                                                      CFT009
111780200528      *                                                                   CFT009
111790200528     C                     MOVELTRCMCC    ##D,13                          CFT009
111800200528     C                     MOVELFXCCCC    ##D,14                          CFT009
111810200528     C                     MOVELCABCCD    ##D,4                           CFT009
111820200528     C                     MOVELCOCHCD    ##D,17                          CFT009
111830200528     C                     MOVELTLXCHD    ##D,2                           CFT009
111840200528      *                                                                   CFT009
111850200528     C           CFT10     IFEQ 'Y'                                       CFT009
111860200528     C                     MOVEL'Y'       ##D,18                          CFT009
111870200528     C                     ENDIF                                          CFT009
111880200528      *                                                                   CFT009
111890200528      ** FX Spread Set                                                    CFT009
111900200528      *                                                                   CFT009
111910200528     C                     MOVELFXSPDS    ##D,19                          CFT009
111920200528      *                                                                   CFT009
111930200528      **  Accumulate RDE's and associated data and output to              CFT009
111940200528      **  PF/CGUDTAPD.                                                    CFT009
111950200528      *                                                                   CFT009
111960200528     C                     EXSR SRADTA                                    CFT009
111970200528     C                     EXSR SRODTA                                    CFT009
111980200528      *                                                                                       CCG015
111990200528     C                     EXSR POPGRS                                                        CCG015
112000200528      *                                                                   CFT009
112010200528      *................................................................   CFT009
112020200528      **  Unwind subroutine stack name                                    CFT009
112030200528      *                                                                   CFT009
112040200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
112050200528     C                     SUB  1         Q                               CFT009
112060200528      *                                                                   CFT009
112070200528     C                     ENDSR                                          CFT009
112080200528      /SPACE 5                                                            CFT009
112090200528      *****************************************************************   CFT009
112100200528      * Subroutine  :  CCENTC                                         *   CFT009
112110200528      * Function    :  Entered Charges                                *   CFT009
112120200528      *                                                               *   CFT009
112130200528      * Called by   :  DRCR04                                         *   CFT009
112140200528      * Calls       :                                                 *   CFT009
112150200528      *****************************************************************   CFT009
112160200528     C           CCENTC    BEGSR                                          CFT009
112170200528      *                                                                   CFT009
112180200528      **  Set up subroutine stack name                                    CFT009
112190200528     C                     ADD  1         Q                               CFT009
112200200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
112210200528      *                                                                   CFT009
112220200528      *................................................................   CFT009
112230200528      *                                                                   CFT009
112240200528      **  Retrieve subroutine specific data.                              CFT009
112250200528     C           1         OCUR ##SRDT                                    CFT009
112260200528     C                     MOVEL##SPAT    S#PATH                          CFT009
112270200528      *                                                                   CFT009
112280200528      **  Set up Path.                                                    CFT009
112290200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
112300200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
112310200528      *                                                                                       CCG015
112320200528     C                     EXSR PSHGRS                                                        CCG015
112330200528      *                                                                   CFT009
112340200528      **  Retrieve RDE information for RDEs in group set                  CFT009
112350200528      *                                                                   CFT009
112360200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
112370200528     C                     Z-ADD1         ##RDEN                          CFT009
112380200528     C                     EXSR SRRRDE                                    CFT009
112390200528      *                                                                   CFT009
112400200528     C                     MOVELCRCY      ##WCCY  3                       CFT009
112410200528      *                                                                   CFT009
112420200528      **  Charge currency                                                 CFT009
112430200528     C                     MOVEL##WCCY    ##D,1                           CFT009
112440200528      *                                                                   CFT009
112450200528      **  Obtain currency details                                         CFT009
112460200528     C                     CALL 'AOCURRR0'                                CFT009
112470200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
112480200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
112490200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
112500200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
112510200528      *                                                                   CFT009
112520200528      ** DATABASE ERROR                                                   CFT009
112530200528      *                                                                   CFT009
112540200528     C           @RTCD     IFNE *BLANK                                    CFT009
112550200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
112560200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
112570200528     C                     Z-ADD53        W0ERNB           * DB ERROR 53 *CFT009
112580200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
112590200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
112600200528     C                     EXSR SRERR                                     CFT009
112610200528     C                     ENDIF                                          CFT009
112620200528      *                                                                   CFT009
112630200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
112640200528      *                                                                   CFT009
112650200528      ** Amount                                                           CFT009
112660200528      *                                                                   CFT009
112670200528     C                     MOVELTRCM      ##D,2                           CFT009
112680200528     C                     MOVE A6NBDP    ##D,2                           CFT009
112690200528     C                     MOVELCCCHCM    ##D,3                           CFT009
112700200528     C                     MOVE A6NBDP    ##D,3                           CFT009
112710200528     C                     MOVELCSTA      ##D,6                           CFT009
112720200528     C                     MOVE A6NBDP    ##D,6                           CFT009
112730200528     C                     MOVELCOLL      ##D,8                           CFT009
112740200528     C                     MOVE A6NBDP    ##D,8                           CFT009
112750200528     C                     MOVELTXCH      ##D,4                           CFT009
112760200528     C                     MOVE A6NBDP    ##D,4                           CFT009
112770200528      *                                                                   CFT009
112780200528      **  Accumulate RDE's and associated data and output to              CFT009
112790200528      **  PF/CGUDTAPD.                                                    CFT009
112800200528      *                                                                   CFT009
112810200528     C                     EXSR SRADTA                                    CFT009
112820200528     C                     EXSR SRODTA                                    CFT009
112830200528      *                                                                   CFT009
112840200528      ** Totals                                                           CFT009
112850200528      *                                                                   CFT009
112860200528     C           TRCM      ADD  CCCHCM    SUMAMT 150                      CFT009
112870200528     C                     ADD  CSTA      SUMAMT                          CFT009
112880200528     C                     ADD  COLL      SUMAMT                          CFT009
112890200528     C                     ADD  TXCH      SUMAMT                          CFT009
112900200528      *                                                                                       CCG015
112910200528     C                     EXSR POPGRS                                                        CCG015
112920200528      *                                                                   CFT009
112930200528      *................................................................   CFT009
112940200528      **  Unwind subroutine stack name                                    CFT009
112950200528      *                                                                   CFT009
112960200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
112970200528     C                     SUB  1         Q                               CFT009
112980200528      *                                                                   CFT009
112990200528     C                     ENDSR                                          CFT009
113000200528      /SPACE 5                                                            CFT009
113010200528      *****************************************************************   CFT009
113020200528      * Subroutine  :  CCVATA                                         *   CFT009
113030200528      * Function    :  Entered Charges VAT                            *   CFT009
113040200528      *                                                               *   CFT009
113050200528      * Called by   :  DRCR04                                         *   CFT009
113060200528      * Calls       :                                                 *   CFT009
113070200528      *****************************************************************   CFT009
113080200528     C           CCVATA    BEGSR                                          CFT009
113090200528      *                                                                   CFT009
113100200528      **  Set up subroutine stack name                                    CFT009
113110200528     C                     ADD  1         Q                               CFT009
113120200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
113130200528      *                                                                   CFT009
113140200528      *................................................................   CFT009
113150200528      *                                                                   CFT009
113160200528      **  Retrieve subroutine specific data.                              CFT009
113170200528     C           1         OCUR ##SRDT                                    CFT009
113180200528     C                     MOVEL##SPAT    S#PATH                          CFT009
113190200528      *                                                                   CFT009
113200200528      **  Set up Path.                                                    CFT009
113210200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
113220200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
113230200528      *                                                                                       CCG015
113240200528     C                     EXSR PSHGRS                                                        CCG015
113250200528      *                                                                   CFT009
113260200528      **  Retrieve RDE information for RDEs in group set                  CFT009
113270200528      *                                                                   CFT009
113280200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
113290200528     C                     Z-ADD1         ##RDEN                          CFT009
113300200528     C                     EXSR SRRRDE                                    CFT009
113310200528      *                                                                   CFT009
113320200528     C                     Z-ADD0         SUMVAT                          CFT009
113330200528      *                                                                   CFT009
113340200528     C           CFT10     IFEQ 'Y'                                       CFT009
113350200528      *                                                                   CFT009
113360200528     C           CCVAT1    IFEQ 'Y'                                       CFT009
113370200528     C           CCVATR    MULT TRCM      VAT    150H                     CFT009
113380200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
113390200528     C                     ELSE                                           CFT009
113400200528     C                     Z-ADD0         VAT                             CFT009
113410200528     C                     Z-ADD0         SUMVAT                          CFT009
113420200528     C                     ENDIF                                          CFT009
113430200528      *                                                                   CFT009
113440200528     C                     MOVELVAT       ##D,12                          CFT009
113450200528     C                     MOVE A6NBDP    ##D,12                          CFT009
113460200528      *                                                                   CFT009
113470200528     C           CCVAT5    IFEQ 'Y'                                       CFT009
113480200528     C           CCVATR    MULT CCCHCM    VAT       H                     CFT009
113490200528     C                     ELSE                                           CFT009
113500200528     C                     Z-ADD0         VAT                             CFT009
113510200528     C                     ENDIF                                          CFT009
113520200528      *                                                                   CFT009
113530200528     C                     ADD  VAT       SUMVAT                          CFT009
113540200528     C                     MOVELVAT       ##D,13                          CFT009
113550200528     C                     MOVE A6NBDP    ##D,13                          CFT009
113560200528      *                                                                   CFT009
113570200528     C           CCVAT3    IFEQ 'Y'                                       CFT009
113580200528     C           CCVATR    MULT CSTA      VAT       H                     CFT009
113590200528     C                     ELSE                                           CFT009
113600200528     C                     Z-ADD0         VAT                             CFT009
113610200528     C                     ENDIF                                          CFT009
113620200528      *                                                                   CFT009
113630200528     C                     ADD  VAT       SUMVAT                          CFT009
113640200528     C                     MOVELVAT       ##D,3                           CFT009
113650200528     C                     MOVE A6NBDP    ##D,3                           CFT009
113660200528      *                                                                   CFT009
113670200528     C           CCVAT2    IFEQ 'Y'                                       CFT009
113680200528     C           CCVATR    MULT COLL      VAT       H                     CFT009
113690200528     C                     ELSE                                           CFT009
113700200528     C                     Z-ADD0         VAT                             CFT009
113710200528     C                     ENDIF                                          CFT009
113720200528      *                                                                   CFT009
113730200528     C                     ADD  VAT       SUMVAT                          CFT009
113740200528     C                     MOVELVAT       ##D,16                          CFT009
113750200528     C                     MOVE A6NBDP    ##D,16                          CFT009
113760200528      *                                                                   CFT009
113770200528     C           CCVAT4    IFEQ 'Y'                                       CFT009
113780200528     C           CCVATR    MULT TXCH      VAT       H                     CFT009
113790200528     C                     ELSE                                           CFT009
113800200528     C                     Z-ADD0         VAT                             CFT009
113810200528     C                     ENDIF                                          CFT009
113820200528      *                                                                   CFT009
113830200528     C                     ADD  VAT       SUMVAT                          CFT009
113840200528     C                     MOVELVAT       ##D,1                           CFT009
113850200528     C                     MOVE A6NBDP    ##D,1                           CFT009
113860200528      *                                                                   CFT009
113870200528     C                     ENDIF                                          CFT009
113880200528      *                                                                   CFT009
113890200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
113900200528     C                     MOVELSUMCHG    ##D,17                          CFT009
113910200528     C                     MOVE A6NBDP    ##D,17                          CFT009
113920200528      *                                                                   CFT009
113930200528      **  Accumulate RDE's and associated data and output to              CFT009
113940200528      **  PF/CGUDTAPD.                                                    CFT009
113950200528     C                     EXSR SRADTA                                    CFT009
113960200528     C                     EXSR SRODTA                                    CFT009
113970200528      *                                                                                       CCG015
113980200528     C                     EXSR POPGRS                                                        CCG015
113990200528      *                                                                   CFT009
114000200528      *................................................................   CFT009
114010200528      **  Unwind subroutine stack name                                    CFT009
114020200528      *                                                                   CFT009
114030200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
114040200528     C                     SUB  1         Q                               CFT009
114050200528      *                                                                   CFT009
114060200528     C                     ENDSR                                          CFT009
114070200528      /SPACE 5                                                            CFT009
114080200528      *****************************************************************   CFT009
114090200528      * Subroutine  :  CCEURC                                         *   CFT009
114100200528      * Function    :  Euro charges                                   *   CFT009
114110200528      *                                                               *   CFT009
114120200528      * Called by   :  DRCR04                                         *   CFT009
114130200528      * Calls       :                                                 *   CFT009
114140200528      *****************************************************************   CFT009
114150200528     C           CCEURC    BEGSR                                          CFT009
114160200528      *                                                                   CFT009
114170200528      **  Set up subroutine stack name                                    CFT009
114180200528     C                     ADD  1         Q                               CFT009
114190200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
114200200528      *                                                                   CFT009
114210200528      *................................................................   CFT009
114220200528      *                                                                   CFT009
114230200528      **  Retrieve subroutine specific data.                              CFT009
114240200528     C           1         OCUR ##SRDT                                    CFT009
114250200528     C                     MOVEL##SPAT    S#PATH                          CFT009
114260200528      *                                                                   CFT009
114270200528      **  Set up Path.                                                    CFT009
114280200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
114290200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
114300200528      *                                                                                       CCG015
114310200528     C                     EXSR PSHGRS                                                        CCG015
114320200528      *                                                                   CFT009
114330200528      **  Retrieve RDE information for RDEs in group set                  CFT009
114340200528      *                                                                   CFT009
114350200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
114360200528     C                     Z-ADD1         ##RDEN                          CFT009
114370200528     C                     EXSR SRRRDE                                    CFT009
114380200528      *                                                                   CFT009
114390200528      **  Determine the number of decimal places for Euro                 CFT009
114400200528      *                                                                   CFT009
114410200528     C                     CALL 'AOCURRR0'                                CFT009
114420200528     C                     PARM *BLANKS   @RTCD                           CFT009
114430200528     C                     PARM '*KEY   ' @OPTN                           CFT009
114440200528     C                     PARM BKEURO    @AJCD                           CFT009
114450200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
114460200528      *                                                                   CFT009
114470200528      ** DATABASE ERROR                                                   CFT009
114480200528     C           @RTCD     IFNE *BLANK                                    CFT009
114490200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
114500200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
114510200528     C                     Z-ADD54        W0ERNB           * DB ERROR 54 *CFT009
114520200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
114530200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
114540200528     C                     EXSR SRERR                                     CFT009
114550200528     C                     ENDIF                                          CFT009
114560200528      *                                                                   CFT009
114570200528      ** Euro Currency                                                    CFT009
114580200528     C                     MOVELBKEURO    ##D,1                           CFT009
114590200528     C                     MOVELBKEURO    #CCY                            CFT009
114600200528      *                                                                   CFT009
114610200528     C                     CLEARP#0010                                    CFT009
114620200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
114630200528     C                     Z-ADDTRCM      P#FRAM                          CFT009
114640200528     C                     EXSR EURAMT                                    CFT009
114650200528     C                     MOVELW#TOAM    ##D,2                           CFT009
114660200528     C                     MOVE A6NBDP    ##D,2                           CFT009
114670200528      *                                                                   CFT009
114680200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
114690200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
114700200528      *                                                                   CFT009
114710200528     C                     CLEARP#0010                                    CFT009
114720200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
114730200528     C                     Z-ADDCCCHCM    P#FRAM                          CFT009
114740200528     C                     EXSR EURAMT                                    CFT009
114750200528     C                     MOVELW#TOAM    ##D,3                           CFT009
114760200528     C                     MOVE A6NBDP    ##D,3                           CFT009
114770200528      *                                                                   CFT009
114780200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
114790200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
114800200528      *                                                                   CFT009
114810200528     C                     CLEARP#0010                                    CFT009
114820200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
114830200528     C                     Z-ADDCSTA      P#FRAM                          CFT009
114840200528     C                     EXSR EURAMT                                    CFT009
114850200528     C                     MOVELW#TOAM    ##D,6                           CFT009
114860200528     C                     MOVE A6NBDP    ##D,6                           CFT009
114870200528      *                                                                   CFT009
114880200528     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
114890200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
114900200528      *                                                                   CFT009
114910200528     C                     CLEARP#0010                                    CFT009
114920200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
114930200528     C                     Z-ADDCOLL      P#FRAM                          CFT009
114940200528     C                     EXSR EURAMT                                    CFT009
114950200528     C                     MOVELW#TOAM    ##D,8                           CFT009
114960200528     C                     MOVE A6NBDP    ##D,8                           CFT009
114970200528      *                                                                   CFT009
114980200528     C                     Z-ADDW#TOAM    VAT16  170                      CFT009
114990200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
115000200528      *                                                                   CFT009
115010200528     C                     CLEARP#0010                                    CFT009
115020200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
115030200528     C                     Z-ADDTXCH      P#FRAM                          CFT009
115040200528     C                     EXSR EURAMT                                    CFT009
115050200528     C                     MOVELW#TOAM    ##D,4                           CFT009
115060200528     C                     MOVE A6NBDP    ##D,4                           CFT009
115070200528      *                                                                   CFT009
115080200528     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
115090200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
115100200528      *                                                                   CFT009
115110200528      **  Accumulate RDE's and associated data and output to              CFT009
115120200528      **  PF/CGUDTAPD.                                                    CFT009
115130200528      *                                                                   CFT009
115140200528     C                     EXSR SRADTA                                    CFT009
115150200528     C                     EXSR SRODTA                                    CFT009
115160200528      *                                                                                       CCG015
115170200528     C                     EXSR POPGRS                                                        CCG015
115180200528      *                                                                   CFT009
115190200528      *................................................................   CFT009
115200200528      **  Unwind subroutine stack name                                    CFT009
115210200528      *                                                                   CFT009
115220200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
115230200528     C                     SUB  1         Q                               CFT009
115240200528      *                                                                   CFT009
115250200528     C                     ENDSR                                          CFT009
115260200528      *                                                                   CFT009
115270200528      /SPACE 5                                                            CFT009
115280200528      *****************************************************************   CFT009
115290200528      * Subroutine  :  CCVATE                                         *   CFT009
115300200528      * Function    :  Euro Charges VAT                               *   CFT009
115310200528      *                                                               *   CFT009
115320200528      * Called by   :  DRCR04                                         *   CFT009
115330200528      * Calls       :                                                 *   CFT009
115340200528      *****************************************************************   CFT009
115350200528     C           CCVATE    BEGSR                                          CFT009
115360200528      *                                                                   CFT009
115370200528      **  Set up subroutine stack name                                    CFT009
115380200528     C                     ADD  1         Q                               CFT009
115390200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
115400200528      *                                                                   CFT009
115410200528      *................................................................   CFT009
115420200528      *                                                                   CFT009
115430200528      **  Retrieve subroutine specific data.                              CFT009
115440200528     C           1         OCUR ##SRDT                                    CFT009
115450200528     C                     MOVEL##SPAT    S#PATH                          CFT009
115460200528      *                                                                   CFT009
115470200528      **  Set up Path.                                                    CFT009
115480200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
115490200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
115500200528      *                                                                                       CCG015
115510200528     C                     EXSR PSHGRS                                                        CCG015
115520200528      *                                                                   CFT009
115530200528      **  Retrieve RDE information for RDEs in group set                  CFT009
115540200528      *                                                                   CFT009
115550200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
115560200528     C                     Z-ADD1         ##RDEN                          CFT009
115570200528     C                     EXSR SRRRDE                                    CFT009
115580200528      *                                                                   CFT009
115590200528     C                     Z-ADD0         SUMVAT                          CFT009
115600200528      *                                                                   CFT009
115610200528     C           CFT10     IFEQ 'Y'                                       CFT009
115620200528      *                                                                   CFT009
115630200528     C           CCVAT1    IFEQ 'Y'                                       CFT009
115640200528     C           CCVATR    MULT VAT12     VAT    150H                     CFT009
115650200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
115660200528     C                     ELSE                                           CFT009
115670200528     C                     Z-ADD0         VAT                             CFT009
115680200528     C                     Z-ADD0         SUMVAT                          CFT009
115690200528     C                     ENDIF                                          CFT009
115700200528      *                                                                   CFT009
115710200528     C                     MOVELVAT       ##D,12                          CFT009
115720200528     C                     MOVE A6NBDP    ##D,12                          CFT009
115730200528      *                                                                   CFT009
115740200528     C           CCVAT5    IFEQ 'Y'                                       CFT009
115750200528     C           CCVATR    MULT VAT13     VAT       H                     CFT009
115760200528     C                     ELSE                                           CFT009
115770200528     C                     Z-ADD0         VAT                             CFT009
115780200528     C                     ENDIF                                          CFT009
115790200528      *                                                                   CFT009
115800200528     C                     ADD  VAT       SUMVAT                          CFT009
115810200528     C                     MOVELVAT       ##D,13                          CFT009
115820200528     C                     MOVE A6NBDP    ##D,13                          CFT009
115830200528      *                                                                   CFT009
115840200528     C           CCVAT3    IFEQ 'Y'                                       CFT009
115850200528     C           CCVATR    MULT VAT3      VAT       H                     CFT009
115860200528     C                     ELSE                                           CFT009
115870200528     C                     Z-ADD0         VAT                             CFT009
115880200528     C                     ENDIF                                          CFT009
115890200528      *                                                                   CFT009
115900200528     C                     ADD  VAT       SUMVAT                          CFT009
115910200528     C                     MOVELVAT       ##D,3                           CFT009
115920200528     C                     MOVE A6NBDP    ##D,3                           CFT009
115930200528      *                                                                   CFT009
115940200528     C           CCVAT2    IFEQ 'Y'                                       CFT009
115950200528     C           CCVATR    MULT VAT16     VAT       H                     CFT009
115960200528     C                     ELSE                                           CFT009
115970200528     C                     Z-ADD0         VAT                             CFT009
115980200528     C                     ENDIF                                          CFT009
115990200528      *                                                                   CFT009
116000200528     C                     ADD  VAT       SUMVAT                          CFT009
116010200528     C                     MOVELVAT       ##D,16                          CFT009
116020200528     C                     MOVE A6NBDP    ##D,16                          CFT009
116030200528      *                                                                   CFT009
116040200528     C           CCVAT4    IFEQ 'Y'                                       CFT009
116050200528     C           CCVATR    MULT VAT1      VAT       H                     CFT009
116060200528     C                     ELSE                                           CFT009
116070200528     C                     Z-ADD0         VAT                             CFT009
116080200528     C                     ENDIF                                          CFT009
116090200528      *                                                                   CFT009
116100200528     C                     ADD  VAT       SUMVAT                          CFT009
116110200528     C                     MOVELVAT       ##D,1                           CFT009
116120200528     C                     MOVE A6NBDP    ##D,1                           CFT009
116130200528      *                                                                   CFT009
116140200528     C                     ENDIF                                          CFT009
116150200528      *                                                                   CFT009
116160200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
116170200528     C                     MOVELSUMCHG    ##D,17                          CFT009
116180200528     C                     MOVE A6NBDP    ##D,17                          CFT009
116190200528      *                                                                   CFT009
116200200528      **  Accumulate RDE's and associated data and output to              CFT009
116210200528      **  PF/CGUDTAPD.                                                    CFT009
116220200528      *                                                                   CFT009
116230200528     C                     EXSR SRADTA                                    CFT009
116240200528     C                     EXSR SRODTA                                    CFT009
116250200528      *                                                                                       CCG015
116260200528     C                     EXSR POPGRS                                                        CCG015
116270200528      *................................................................   CFT009
116280200528      **  Unwind subroutine stack name                                    CFT009
116290200528      *                                                                   CFT009
116300200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
116310200528     C                     SUB  1         Q                               CFT009
116320200528      *                                                                   CFT009
116330200528     C                     ENDSR                                          CFT009
116340200528      *                                                                   CFT009
116350200528      /SPACE 5                                                            CFT009
116360200528      *****************************************************************   CFT009
116370200528      * Subroutine  :  RFFEES                                         *   CFT009
116380200528      * Function    :  Fees & Charges Information                     *   CFT009
116390200528      *                                                               *   CFT009
116400200528      * Called by   :  DRCR05                                         *   CFT009
116410200528      * Calls       :                                                 *   CFT009
116420200528      *****************************************************************   CFT009
116430200528     C           RFFEES    BEGSR                                          CFT009
116440200528      *                                                                   CFT009
116450200528      **  Set up subroutine stack name                                    CFT009
116460200528     C                     ADD  1         Q                               CFT009
116470200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
116480200528      *                                                                   CFT009
116490200528      *................................................................   CFT009
116500200528      *                                                                   CFT009
116510200528      **  Retrieve subroutine specific data.                              CFT009
116520200528     C           1         OCUR ##SRDT                                    CFT009
116530200528     C                     MOVEL##SPAT    S#PATH                          CFT009
116540200528      *                                                                   CFT009
116550200528      **  Set up Path.                                                    CFT009
116560200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
116570200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
116580200528      *                                                                                       CCG015
116590200528     C                     EXSR PSHGRS                                                        CCG015
116600200528      *                                                                   CFT009
116610200528      **  Retrieve RDE information for RDEs in group set                  CFT009
116620200528      *                                                                   CFT009
116630200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
116640200528     C                     Z-ADD1         ##RDEN                          CFT009
116650200528     C                     EXSR SRRRDE                                    CFT009
116660200528      *                                                                   CFT009
116670200528     C                     MOVEL'Y'       ##D,1                           CFT009
116680200528      *                                                                   CFT009
116690200528      ** Charge code                                                      CFT009
116700200528      *                                                                   CFT009
116710200528     C                     MOVELTFCOCC    ##D,13                          CFT009
116720200528     C                     MOVELFXCCCD    ##D,14                          CFT009
116730200528     C                     MOVELIMICC1    ##D,8                           CFT009
116740200528     C                     MOVELIMICC2    ##D,9                           CFT009
116750200528     C                     MOVELIMICC3    ##D,10                          CFT009
116760200528     C                     MOVELIMICC4    ##D,11                          CFT009
116770200528     C                     MOVELIMICC5    ##D,12                          CFT009
116780200528      *                                                                   CFT009
116790200528     C           CFT10     IFEQ 'Y'                                       CFT009
116800200528     C                     MOVEL'Y'       ##D,18                          CFT009
116810200528     C                     ENDIF                                          CFT009
116820200528      *                                                                   CFT009
116830200528      ** FX Spread Set                                                    CFT009
116840200528      *                                                                   CFT009
116850200528     C                     MOVELFXSRST    ##D,19                          CFT009
116860200528      *                                                                   CFT009
116870200528      **  Accumulate RDE's and associated data and output to              CFT009
116880200528      **  PF/CGUDTAPD.                                                    CFT009
116890200528      *                                                                   CFT009
116900200528     C                     EXSR SRADTA                                    CFT009
116910200528     C                     EXSR SRODTA                                    CFT009
116920200528      *                                                                                       CCG015
116930200528     C                     EXSR POPGRS                                                        CCG015
116940200528      *                                                                   CFT009
116950200528      *................................................................   CFT009
116960200528      **  Unwind subroutine stack name                                    CFT009
116970200528      *                                                                   CFT009
116980200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
116990200528     C                     SUB  1         Q                               CFT009
117000200528      *                                                                   CFT009
117010200528     C                     ENDSR                                          CFT009
117020200528      /SPACE 5                                                            CFT009
117030200528      *****************************************************************   CFT009
117040200528      * Subroutine  :  RFENTC                                         *   CFT009
117050200528      * Function    :  Entered Charges                                *   CFT009
117060200528      *                                                               *   CFT009
117070200528      * Called by   :  DRCR05                                         *   CFT009
117080200528      * Calls       :                                                 *   CFT009
117090200528      *****************************************************************   CFT009
117100200528     C           RFENTC    BEGSR                                          CFT009
117110200528      *                                                                   CFT009
117120200528      **  Set up subroutine stack name                                    CFT009
117130200528     C                     ADD  1         Q                               CFT009
117140200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
117150200528      *                                                                   CFT009
117160200528      *................................................................   CFT009
117170200528      *                                                                   CFT009
117180200528      **  Retrieve subroutine specific data.                              CFT009
117190200528     C           1         OCUR ##SRDT                                    CFT009
117200200528     C                     MOVEL##SPAT    S#PATH                          CFT009
117210200528      *                                                                   CFT009
117220200528      **  Set up Path.                                                    CFT009
117230200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
117240200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
117250200528      *                                                                                       CCG015
117260200528     C                     EXSR PSHGRS                                                        CCG015
117270200528      *                                                                   CFT009
117280200528      **  Retrieve RDE information for RDEs in group set                  CFT009
117290200528      *                                                                   CFT009
117300200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
117310200528     C                     Z-ADD1         ##RDEN                          CFT009
117320200528     C                     EXSR SRRRDE                                    CFT009
117330200528      *                                                                   CFT009
117340200528     C                     MOVELM1CHGC    ##WCCY  3                       CFT009
117350200528      *                                                                   CFT009
117360200528      **  Charge currency                                                 CFT009
117370200528     C                     MOVEL##WCCY    ##D,1                           CFT009
117380200528      *                                                                   CFT009
117390200528      **  Obtain currency details                                         CFT009
117400200528     C           ##WCCY    IFNE *BLANKS                                                     BUG15265
117410200528     C                     CALL 'AOCURRR0'                                CFT009
117420200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
117430200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
117440200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
117450200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
117460200528      *                                                                   CFT009
117470200528      ** DATABASE ERROR                                                   CFT009
117480200528      *                                                                   CFT009
117490200528     C           @RTCD     IFNE *BLANK                                    CFT009
117500200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
117510200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
117520200528     C                     Z-ADD55        W0ERNB           * DB ERROR 55 *CFT009
117530200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
117540200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
117550200528     C                     EXSR SRERR                                     CFT009
117560200528     C                     ENDIF                                          CFT009
117570200528      *                                                                   CFT009
117580200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
117590200528     C                     ENDIF                                                            BUG15265
117600200528      *                                                                   CFT009
117610200528      ** Amount                                                           CFT009
117620200528      *                                                                   CFT009
117630200528     C                     MOVELTRCHCC    ##D,2                           CFT009
117640200528     C                     MOVE A6NBDP    ##D,2                           CFT009
117650200528     C                     MOVELFXCHGC    ##D,3                           CFT009
117660200528     C                     MOVE A6NBDP    ##D,3                           CFT009
117670200528     C                     MOVELIMICH1    ##D,17                          CFT009
117680200528     C                     MOVE A6NBDP    ##D,17                          CFT009
117690200528     C                     MOVELIMICH2    ##D,18                          CFT009
117700200528     C                     MOVE A6NBDP    ##D,18                          CFT009
117710200528     C                     MOVELIMICH3    ##D,19                          CFT009
117720200528     C                     MOVE A6NBDP    ##D,19                          CFT009
117730200528     C                     MOVELIMICH4    ##D,20                          CFT009
117740200528     C                     MOVE A6NBDP    ##D,20                          CFT009
117750200528      *                                                                   CFT009
117760200528      **  Accumulate RDE's and associated data and output to              CFT009
117770200528      **  PF/CGUDTAPD.                                                    CFT009
117780200528      *                                                                   CFT009
117790200528     C                     EXSR SRADTA                                    CFT009
117800200528     C                     MOVEL##SDS     ##ADS                           CFT009
117810200528      *                                                                   CFT009
117820200528      **  Retrieve RDE information for RDEs in group set                  CFT009
117830200528      *                                                                   CFT009
117840200528     C                     Z-ADD21        ##RDEN                          CFT009
117850200528     C                     EXSR SRRRDE                                    CFT009
117860200528     C                     MOVELIMICH5    ##D,1                           CFT009
117870200528     C                     MOVE A6NBDP    ##D,1                           CFT009
117880200528      *                                                                   CFT009
117890200528      **  Accumulate RDE's and associated data and output to              CFT009
117900200528      **  PF/CGUDTAPD.                                                    CFT009
117910200528     C                     EXSR SRADTA                                    CFT009
117920200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
117930200528      *                                                                   CFT009
117940200528      **  Initialise Write Format Parameter.                              CFT009
117950200528     C                     CLEARW0FMT                                     CFT009
117960200528      *                                                                   CFT009
117970200528      **  Set up Control Information.                                     CFT009
117980200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
117990200528     C                     ADD  1         ##OSEQ                          CFT009
118000200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
118010200528     C                     Z-ADD1         DEPBIN                          CFT009
118020200528     C                     Z-ADD1         DETBIN                          CFT009
118030200528     C                     MOVE 'FR'      DEFSLI                          CFT009
118040200528     C                     MOVE *BLANKS   W0PATH                          CFT009
118050200528     C                     MOVELS#PATH    W0PATH                          CFT009
118060200528      *                                                                   CFT009
118070200528      **  Append Data from pack routine.                                  CFT009
118080200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
118090200528     C                     EXSR SRODTA                                    CFT009
118100200528      *                                                                   CFT009
118110200528      ** Totals                                                           CFT009
118120200528      *                                                                   CFT009
118130200528     C           TRCHCC    ADD  FXCHGC    SUMAMT 150                      CFT009
118140200528     C                     ADD  IMICH1    SUMAMT                          CFT009
118150200528     C                     ADD  IMICH2    SUMAMT                          CFT009
118160200528     C                     ADD  IMICH3    SUMAMT                          CFT009
118170200528     C                     ADD  IMICH4    SUMAMT                          CFT009
118180200528     C                     ADD  IMICH5    SUMAMT                          CFT009
118190200528      *                                                                                       CCG015
118200200528     C                     EXSR POPGRS                                                        CCG015
118210200528      *                                                                   CFT009
118220200528      *................................................................   CFT009
118230200528      **  Unwind subroutine stack name                                    CFT009
118240200528      *                                                                   CFT009
118250200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
118260200528     C                     SUB  1         Q                               CFT009
118270200528      *                                                                   CFT009
118280200528     C                     ENDSR                                          CFT009
118290200528      /SPACE 5                                                            CFT009
118300200528      *****************************************************************   CFT009
118310200528      * Subroutine  :  RFVATA                                         *   CFT009
118320200528      * Function    :  Entered Charges VAT                            *   CFT009
118330200528      *                                                               *   CFT009
118340200528      * Called by   :  DRCR05                                         *   CFT009
118350200528      * Calls       :                                                 *   CFT009
118360200528      *****************************************************************   CFT009
118370200528     C           RFVATA    BEGSR                                          CFT009
118380200528      *                                                                   CFT009
118390200528      **  Set up subroutine stack name                                    CFT009
118400200528     C                     ADD  1         Q                               CFT009
118410200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
118420200528      *                                                                   CFT009
118430200528      *................................................................   CFT009
118440200528      *                                                                   CFT009
118450200528      **  Retrieve subroutine specific data.                              CFT009
118460200528     C           1         OCUR ##SRDT                                    CFT009
118470200528     C                     MOVEL##SPAT    S#PATH                          CFT009
118480200528      *                                                                   CFT009
118490200528      **  Set up Path.                                                    CFT009
118500200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
118510200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
118520200528      *                                                                                       CCG015
118530200528     C                     EXSR PSHGRS                                                        CCG015
118540200528      *                                                                   CFT009
118550200528      **  Retrieve RDE information for RDEs in group set                  CFT009
118560200528      *                                                                   CFT009
118570200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
118580200528     C                     Z-ADD1         ##RDEN                          CFT009
118590200528     C                     EXSR SRRRDE                                    CFT009
118600200528      *                                                                   CFT009
118610200528     C                     Z-ADD0         SUMVAT                          CFT009
118620200528      *                                                                   CFT009
118630200528     C           CFT10     IFEQ 'Y'                                       CFT009
118640200528      *                                                                   CFT009
118650200528     C           VTCOCH    IFEQ 'Y'                                       CFT009
118660200528     C           VATRAT    MULT TRCHCC    VAT    150H                     CFT009
118670200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
118680200528     C                     ELSE                                           CFT009
118690200528     C                     Z-ADD0         VAT                             CFT009
118700200528     C                     Z-ADD0         SUMVAT                          CFT009
118710200528     C                     ENDIF                                          CFT009
118720200528      *                                                                   CFT009
118730200528     C                     MOVELVAT       ##D,12                          CFT009
118740200528     C                     MOVE A6NBDP    ##D,12                          CFT009
118750200528      *                                                                   CFT009
118760200528     C           VTFCCC    IFEQ 'Y'                                       CFT009
118770200528     C           VATRAT    MULT FXCHGC    VAT       H                     CFT009
118780200528     C                     ELSE                                           CFT009
118790200528     C                     Z-ADD0         VAT                             CFT009
118800200528     C                     ENDIF                                          CFT009
118810200528      *                                                                   CFT009
118820200528     C                     ADD  VAT       SUMVAT                          CFT009
118830200528     C                     MOVELVAT       ##D,13                          CFT009
118840200528     C                     MOVE A6NBDP    ##D,13                          CFT009
118850200528      *                                                                   CFT009
118860200528     C           VIMIC1    IFEQ 'Y'                                       CFT009
118870200528     C           VATRAT    MULT IMICH1    VAT       H                     CFT009
118880200528     C                     ELSE                                           CFT009
118890200528     C                     Z-ADD0         VAT                             CFT009
118900200528     C                     ENDIF                                          CFT009
118910200528      *                                                                   CFT009
118920200528     C                     ADD  VAT       SUMVAT                          CFT009
118930200528     C                     MOVELVAT       ##D,7                           CFT009
118940200528     C                     MOVE A6NBDP    ##D,7                           CFT009
118950200528      *                                                                   CFT009
118960200528     C           VIMIC2    IFEQ 'Y'                                       CFT009
118970200528     C           VATRAT    MULT IMICH2    VAT       H                     CFT009
118980200528     C                     ELSE                                           CFT009
118990200528     C                     Z-ADD0         VAT                             CFT009
119000200528     C                     ENDIF                                          CFT009
119010200528      *                                                                   CFT009
119020200528     C                     ADD  VAT       SUMVAT                          CFT009
119030200528     C                     MOVELVAT       ##D,8                           CFT009
119040200528     C                     MOVE A6NBDP    ##D,8                           CFT009
119050200528      *                                                                   CFT009
119060200528     C           VIMIC3    IFEQ 'Y'                                       CFT009
119070200528     C           VATRAT    MULT IMICH3    VAT       H                     CFT009
119080200528     C                     ELSE                                           CFT009
119090200528     C                     Z-ADD0         VAT                             CFT009
119100200528     C                     ENDIF                                          CFT009
119110200528      *                                                                   CFT009
119120200528     C                     ADD  VAT       SUMVAT                          CFT009
119130200528     C                     MOVELVAT       ##D,9                           CFT009
119140200528     C                     MOVE A6NBDP    ##D,9                           CFT009
119150200528      *                                                                   CFT009
119160200528     C           VIMIC4    IFEQ 'Y'                                       CFT009
119170200528     C           VATRAT    MULT IMICH4    VAT       H                     CFT009
119180200528     C                     ELSE                                           CFT009
119190200528     C                     Z-ADD0         VAT                             CFT009
119200200528     C                     ENDIF                                          CFT009
119210200528      *                                                                   CFT009
119220200528     C                     ADD  VAT       SUMVAT                          CFT009
119230200528     C                     MOVELVAT       ##D,10                          CFT009
119240200528     C                     MOVE A6NBDP    ##D,10                          CFT009
119250200528      *                                                                   CFT009
119260200528     C           VIMIC5    IFEQ 'Y'                                       CFT009
119270200528     C           VATRAT    MULT IMICH5    VAT       H                     CFT009
119280200528     C                     ELSE                                           CFT009
119290200528     C                     Z-ADD0         VAT                             CFT009
119300200528     C                     ENDIF                                          CFT009
119310200528      *                                                                   CFT009
119320200528     C                     ADD  VAT       SUMVAT                          CFT009
119330200528     C                     MOVELVAT       ##D,11                          CFT009
119340200528     C                     MOVE A6NBDP    ##D,11                          CFT009
119350200528      *                                                                   CFT009
119360200528     C                     ENDIF                                          CFT009
119370200528      *                                                                   CFT009
119380200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
119390200528     C                     MOVELSUMCHG    ##D,17                          CFT009
119400200528     C                     MOVE A6NBDP    ##D,17                          CFT009
119410200528      *                                                                   CFT009
119420200528      **  Accumulate RDE's and associated data and output to              CFT009
119430200528      **  PF/CGUDTAPD.                                                    CFT009
119440200528     C                     EXSR SRADTA                                    CFT009
119450200528     C                     EXSR SRODTA                                    CFT009
119460200528      *                                                                                       CCG015
119470200528     C                     EXSR POPGRS                                                        CCG015
119480200528      *                                                                   CFT009
119490200528      *................................................................   CFT009
119500200528      **  Unwind subroutine stack name                                    CFT009
119510200528      *                                                                   CFT009
119520200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
119530200528     C                     SUB  1         Q                               CFT009
119540200528      *                                                                   CFT009
119550200528     C                     ENDSR                                          CFT009
119560200528      /SPACE 5                                                            CFT009
119570200528      *****************************************************************   CFT009
119580200528      * Subroutine  :  RFEURC                                         *   CFT009
119590200528      * Function    :  Euro charges                                   *   CFT009
119600200528      *                                                               *   CFT009
119610200528      * Called by   :  DRCR05                                         *   CFT009
119620200528      * Calls       :                                                 *   CFT009
119630200528      *****************************************************************   CFT009
119640200528     C           RFEURC    BEGSR                                          CFT009
119650200528      *                                                                   CFT009
119660200528      **  Set up subroutine stack name                                    CFT009
119670200528     C                     ADD  1         Q                               CFT009
119680200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
119690200528      *                                                                   CFT009
119700200528      *................................................................   CFT009
119710200528      *                                                                   CFT009
119720200528      **  Retrieve subroutine specific data.                              CFT009
119730200528     C           1         OCUR ##SRDT                                    CFT009
119740200528     C                     MOVEL##SPAT    S#PATH                          CFT009
119750200528      *                                                                   CFT009
119760200528      **  Set up Path.                                                    CFT009
119770200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
119780200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
119790200528      *                                                                                       CCG015
119800200528     C                     EXSR PSHGRS                                                        CCG015
119810200528      *                                                                   CFT009
119820200528      **  Retrieve RDE information for RDEs in group set                  CFT009
119830200528      *                                                                   CFT009
119840200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
119850200528     C                     Z-ADD1         ##RDEN                          CFT009
119860200528     C                     EXSR SRRRDE                                    CFT009
119870200528      *                                                                   CFT009
119880200528      **  Determine the number of decimal places for Euro                 CFT009
119890200528      *                                                                   CFT009
119900200528     C                     CALL 'AOCURRR0'                                CFT009
119910200528     C                     PARM *BLANKS   @RTCD                           CFT009
119920200528     C                     PARM '*KEY   ' @OPTN                           CFT009
119930200528     C                     PARM BKEURO    @AJCD                           CFT009
119940200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
119950200528      *                                                                   CFT009
119960200528      ** DATABASE ERROR                                                   CFT009
119970200528     C           @RTCD     IFNE *BLANK                                    CFT009
119980200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
119990200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
120000200528     C                     Z-ADD56        W0ERNB           * DB ERROR 56 *CFT009
120010200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
120020200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
120030200528     C                     EXSR SRERR                                     CFT009
120040200528     C                     ENDIF                                          CFT009
120050200528      *                                                                   CFT009
120060200528      ** Euro Currency                                                    CFT009
120070200528     C                     MOVELBKEURO    ##D,1                           CFT009
120080200528     C                     MOVELBKEURO    #CCY                            CFT009
120090200528      *                                                                   CFT009
120100200528     C                     CLEARP#0010                                    CFT009
120110200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120120200528     C                     Z-ADDTRCHCC    P#FRAM                          CFT009
120130200528     C                     EXSR EURAMT                                    CFT009
120140200528     C                     MOVELW#TOAM    ##D,2                           CFT009
120150200528     C                     MOVE A6NBDP    ##D,2                           CFT009
120160200528      *                                                                   CFT009
120170200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
120180200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
120190200528      *                                                                   CFT009
120200200528     C                     CLEARP#0010                                    CFT009
120210200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120220200528     C                     Z-ADDFXCHGC    P#FRAM                          CFT009
120230200528     C                     EXSR EURAMT                                    CFT009
120240200528     C                     MOVELW#TOAM    ##D,3                           CFT009
120250200528     C                     MOVE A6NBDP    ##D,3                           CFT009
120260200528      *                                                                   CFT009
120270200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
120280200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120290200528      *                                                                   CFT009
120300200528     C                     CLEARP#0010                                    CFT009
120310200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120320200528     C                     Z-ADDIMICH1    P#FRAM                          CFT009
120330200528     C                     EXSR EURAMT                                    CFT009
120340200528     C                     MOVELW#TOAM    ##D,17                          CFT009
120350200528     C                     MOVE A6NBDP    ##D,17                          CFT009
120360200528      *                                                                   CFT009
120370200528     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
120380200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120390200528      *                                                                   CFT009
120400200528     C                     CLEARP#0010                                    CFT009
120410200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120420200528     C                     Z-ADDIMICH2    P#FRAM                          CFT009
120430200528     C                     EXSR EURAMT                                    CFT009
120440200528     C                     MOVELW#TOAM    ##D,18                          CFT009
120450200528     C                     MOVE A6NBDP    ##D,18                          CFT009
120460200528      *                                                                   CFT009
120470200528     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
120480200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120490200528      *                                                                   CFT009
120500200528     C                     CLEARP#0010                                    CFT009
120510200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120520200528     C                     Z-ADDIMICH3    P#FRAM                          CFT009
120530200528     C                     EXSR EURAMT                                    CFT009
120540200528     C                     MOVELW#TOAM    ##D,19                          CFT009
120550200528     C                     MOVE A6NBDP    ##D,19                          CFT009
120560200528      *                                                                   CFT009
120570200528     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
120580200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120590200528      *                                                                   CFT009
120600200528     C                     CLEARP#0010                                    CFT009
120610200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120620200528     C                     Z-ADDIMICH4    P#FRAM                          CFT009
120630200528     C                     EXSR EURAMT                                    CFT009
120640200528     C                     MOVELW#TOAM    ##D,20                          CFT009
120650200528     C                     MOVE A6NBDP    ##D,20                          CFT009
120660200528      *                                                                   CFT009
120670200528     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
120680200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120690200528      *                                                                   CFT009
120700200528      **  Accumulate RDE's and associated data and output to              CFT009
120710200528      **  PF/CGUDTAPD.                                                    CFT009
120720200528      *                                                                   CFT009
120730200528     C                     EXSR SRADTA                                    CFT009
120740200528     C                     MOVEL##SDS     ##ADS                           CFT009
120750200528      *                                                                   CFT009
120760200528      **  Retrieve RDE information for RDEs in group set                  CFT009
120770200528      *                                                                   CFT009
120780200528     C                     Z-ADD21        ##RDEN                          CFT009
120790200528     C                     EXSR SRRRDE                                    CFT009
120800200528      *                                                                   CFT009
120810200528     C                     CLEARP#0010                                    CFT009
120820200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
120830200528     C                     Z-ADDIMICH5    P#FRAM                          CFT009
120840200528     C                     EXSR EURAMT                                    CFT009
120850200528     C                     MOVELW#TOAM    ##D,1                           CFT009
120860200528     C                     MOVE A6NBDP    ##D,1                           CFT009
120870200528      *                                                                   CFT009
120880200528     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
120890200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
120900200528      *                                                                   CFT009
120910200528      **  Accumulate RDE's and associated data and output to              CFT009
120920200528      **  PF/CGUDTAPD.                                                    CFT009
120930200528     C                     EXSR SRADTA                                    CFT009
120940200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
120950200528      *                                                                   CFT009
120960200528      **  Initialise Write Format Parameter.                              CFT009
120970200528     C                     CLEARW0FMT                                     CFT009
120980200528      *                                                                   CFT009
120990200528      **  Set up Control Information.                                     CFT009
121000200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
121010200528     C                     ADD  1         ##OSEQ                          CFT009
121020200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
121030200528     C                     Z-ADD1         DEPBIN                          CFT009
121040200528     C                     Z-ADD1         DETBIN                          CFT009
121050200528     C                     MOVE 'FR'      DEFSLI                          CFT009
121060200528     C                     MOVE *BLANKS   W0PATH                          CFT009
121070200528     C                     MOVELS#PATH    W0PATH                          CFT009
121080200528      *                                                                   CFT009
121090200528      **  Append Data from pack routine.                                  CFT009
121100200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
121110200528     C                     EXSR SRODTA                                    CFT009
121120200528      *                                                                                       CCG015
121130200528     C                     EXSR POPGRS                                                        CCG015
121140200528      *                                                                   CFT009
121150200528      *................................................................   CFT009
121160200528      **  Unwind subroutine stack name                                    CFT009
121170200528      *                                                                   CFT009
121180200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
121190200528     C                     SUB  1         Q                               CFT009
121200200528      *                                                                   CFT009
121210200528     C                     ENDSR                                          CFT009
121220200528      *                                                                   CFT009
121230200528      /SPACE 5                                                            CFT009
121240200528      *****************************************************************   CFT009
121250200528      * Subroutine  :  RFVATE                                         *   CFT009
121260200528      * Function    :  Euro Charges VAT                               *   CFT009
121270200528      *                                                               *   CFT009
121280200528      * Called by   :  DRCR05                                         *   CFT009
121290200528      * Calls       :                                                 *   CFT009
121300200528      *****************************************************************   CFT009
121310200528     C           RFVATE    BEGSR                                          CFT009
121320200528      *                                                                   CFT009
121330200528      **  Set up subroutine stack name                                    CFT009
121340200528     C                     ADD  1         Q                               CFT009
121350200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
121360200528      *                                                                   CFT009
121370200528      *................................................................   CFT009
121380200528      *                                                                   CFT009
121390200528      **  Retrieve subroutine specific data.                              CFT009
121400200528     C           1         OCUR ##SRDT                                    CFT009
121410200528     C                     MOVEL##SPAT    S#PATH                          CFT009
121420200528      *                                                                   CFT009
121430200528      **  Set up Path.                                                    CFT009
121440200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
121450200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
121460200528      *                                                                                       CCG015
121470200528     C                     EXSR PSHGRS                                                        CCG015
121480200528      *                                                                   CFT009
121490200528      **  Retrieve RDE information for RDEs in group set                  CFT009
121500200528      *                                                                   CFT009
121510200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
121520200528     C                     Z-ADD1         ##RDEN                          CFT009
121530200528     C                     EXSR SRRRDE                                    CFT009
121540200528      *                                                                   CFT009
121550200528     C                     Z-ADD0         SUMVAT                          CFT009
121560200528      *                                                                   CFT009
121570200528     C           CFT10     IFEQ 'Y'                                       CFT009
121580200528      *                                                                   CFT009
121590200528     C           VTCOCH    IFEQ 'Y'                                       CFT009
121600200528     C           VATRAT    MULT VAT12     VAT    150H                     CFT009
121610200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
121620200528     C                     ELSE                                           CFT009
121630200528     C                     Z-ADD0         VAT                             CFT009
121640200528     C                     Z-ADD0         SUMVAT                          CFT009
121650200528     C                     ENDIF                                          CFT009
121660200528      *                                                                   CFT009
121670200528     C                     MOVELVAT       ##D,12                          CFT009
121680200528     C                     MOVE A6NBDP    ##D,12                          CFT009
121690200528      *                                                                   CFT009
121700200528     C           VTFCCC    IFEQ 'Y'                                       CFT009
121710200528     C           VATRAT    MULT VAT13     VAT       H                     CFT009
121720200528     C                     ELSE                                           CFT009
121730200528     C                     Z-ADD0         VAT                             CFT009
121740200528     C                     ENDIF                                          CFT009
121750200528      *                                                                   CFT009
121760200528     C                     ADD  VAT       SUMVAT                          CFT009
121770200528     C                     MOVELVAT       ##D,13                          CFT009
121780200528     C                     MOVE A6NBDP    ##D,13                          CFT009
121790200528      *                                                                   CFT009
121800200528     C           VIMIC1    IFEQ 'Y'                                       CFT009
121810200528     C           VATRAT    MULT VAT7      VAT       H                     CFT009
121820200528     C                     ELSE                                           CFT009
121830200528     C                     Z-ADD0         VAT                             CFT009
121840200528     C                     ENDIF                                          CFT009
121850200528      *                                                                   CFT009
121860200528     C                     ADD  VAT       SUMVAT                          CFT009
121870200528     C                     MOVELVAT       ##D,7                           CFT009
121880200528     C                     MOVE A6NBDP    ##D,7                           CFT009
121890200528      *                                                                   CFT009
121900200528     C           VIMIC2    IFEQ 'Y'                                       CFT009
121910200528     C           VATRAT    MULT VAT8      VAT       H                     CFT009
121920200528     C                     ELSE                                           CFT009
121930200528     C                     Z-ADD0         VAT                             CFT009
121940200528     C                     ENDIF                                          CFT009
121950200528      *                                                                   CFT009
121960200528     C                     ADD  VAT       SUMVAT                          CFT009
121970200528     C                     MOVELVAT       ##D,8                           CFT009
121980200528     C                     MOVE A6NBDP    ##D,8                           CFT009
121990200528      *                                                                   CFT009
122000200528     C           VIMIC3    IFEQ 'Y'                                       CFT009
122010200528     C           VATRAT    MULT VAT9      VAT       H                     CFT009
122020200528     C                     ELSE                                           CFT009
122030200528     C                     Z-ADD0         VAT                             CFT009
122040200528     C                     ENDIF                                          CFT009
122050200528      *                                                                   CFT009
122060200528     C                     ADD  VAT       SUMVAT                          CFT009
122070200528     C                     MOVELVAT       ##D,9                           CFT009
122080200528     C                     MOVE A6NBDP    ##D,9                           CFT009
122090200528      *                                                                   CFT009
122100200528     C           VIMIC4    IFEQ 'Y'                                       CFT009
122110200528     C           VATRAT    MULT VAT10     VAT       H                     CFT009
122120200528     C                     ELSE                                           CFT009
122130200528     C                     Z-ADD0         VAT                             CFT009
122140200528     C                     ENDIF                                          CFT009
122150200528      *                                                                   CFT009
122160200528     C                     ADD  VAT       SUMVAT                          CFT009
122170200528     C                     MOVELVAT       ##D,10                          CFT009
122180200528     C                     MOVE A6NBDP    ##D,10                          CFT009
122190200528      *                                                                   CFT009
122200200528     C           VIMIC5    IFEQ 'Y'                                       CFT009
122210200528     C           VATRAT    MULT VAT11     VAT       H                     CFT009
122220200528     C                     ELSE                                           CFT009
122230200528     C                     Z-ADD0         VAT                             CFT009
122240200528     C                     ENDIF                                          CFT009
122250200528      *                                                                   CFT009
122260200528     C                     ADD  VAT       SUMVAT                          CFT009
122270200528     C                     MOVELVAT       ##D,11                          CFT009
122280200528     C                     MOVE A6NBDP    ##D,11                          CFT009
122290200528      *                                                                   CFT009
122300200528     C                     ENDIF                                          CFT009
122310200528      *                                                                   CFT009
122320200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
122330200528     C                     MOVELSUMCHG    ##D,17                          CFT009
122340200528     C                     MOVE A6NBDP    ##D,17                          CFT009
122350200528      *                                                                   CFT009
122360200528      **  Accumulate RDE's and associated data and output to              CFT009
122370200528      **  PF/CGUDTAPD.                                                    CFT009
122380200528      *                                                                   CFT009
122390200528     C                     EXSR SRADTA                                    CFT009
122400200528     C                     EXSR SRODTA                                    CFT009
122410200528      *                                                                                       CCG015
122420200528     C                     EXSR POPGRS                                                        CCG015
122430200528      *................................................................   CFT009
122440200528      **  Unwind subroutine stack name                                    CFT009
122450200528      *                                                                   CFT009
122460200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
122470200528     C                     SUB  1         Q                               CFT009
122480200528      *                                                                   CFT009
122490200528     C                     ENDSR                                          CFT009
122500200528      *                                                                   CFT009
122510200528      /SPACE 5                                                            CFT009
122520200528      *****************************************************************   CFT009
122530200528      * Subroutine  :  CTFEES                                         *   CFT009
122540200528      * Function    :  Fees & Charges Information                     *   CFT009
122550200528      *                                                               *   CFT009
122560200528      * Called by   :  DRCR06                                         *   CFT009
122570200528      * Calls       :                                                 *   CFT009
122580200528      *****************************************************************   CFT009
122590200528     C           CTFEES    BEGSR                                          CFT009
122600200528      *                                                                   CFT009
122610200528      **  Set up subroutine stack name                                    CFT009
122620200528     C                     ADD  1         Q                               CFT009
122630200528     C                     MOVEL'CFT009'  @STK,Q                          CFT009
122640200528      *                                                                   CFT009
122650200528      *................................................................   CFT009
122660200528      *                                                                   CFT009
122670200528      **  Retrieve subroutine specific data.                              CFT009
122680200528     C           1         OCUR ##SRDT                                    CFT009
122690200528     C                     MOVEL##SPAT    S#PATH                          CFT009
122700200528      *                                                                   CFT009
122710200528      **  Set up Path.                                                    CFT009
122720200528     C                     MOVEL'\CFT009' ##PNAM                          CFT009
122730200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
122740200528      *                                                                                       CCG015
122750200528     C                     EXSR PSHGRS                                                        CCG015
122760200528      *                                                                   CFT009
122770200528      **  Retrieve RDE information for RDEs in group set                  CFT009
122780200528      *                                                                   CFT009
122790200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
122800200528     C                     Z-ADD1         ##RDEN                          CFT009
122810200528     C                     EXSR SRRRDE                                    CFT009
122820200528      *                                                                   CFT009
122830200528     C                     MOVEL'Y'       ##D,1                           CFT009
122840200528      *                                                                   CFT009
122850200528      ** Charge code                                                      CFT009
122860200528      *                                                                   CFT009
122870200528     C                     MOVELTRCOCC    ##D,13                          CFT009
122880200528     C                     MOVELFXCCC     ##D,14                          CFT009
122890200528     C                     MOVELMICCD1    ##D,8                           CFT009
122900200528     C                     MOVELMICCD2    ##D,9                           CFT009
122910200528     C                     MOVELMICCD3    ##D,10                          CFT009
122920200528     C                     MOVELMICCD4    ##D,11                          CFT009
122930200528     C                     MOVELMICCD5    ##D,12                          CFT009
122940200528      *                                                                   CFT009
122950200528     C           CFT10     IFEQ 'Y'                                       CFT009
122960200528     C                     MOVEL'Y'       ##D,18                          CFT009
122970200528     C                     ENDIF                                          CFT009
122980200528      *                                                                   CFT009
122990200528      ** FX Spread Set                                                    CFT009
123000200528      *                                                                   CFT009
123010200528     C                     MOVELFXSSCD    ##D,19                          CFT009
123020200528      *                                                                   CFT009
123030200528      **  Accumulate RDE's and associated data and output to              CFT009
123040200528      **  PF/CGUDTAPD.                                                    CFT009
123050200528      *                                                                   CFT009
123060200528     C                     EXSR SRADTA                                    CFT009
123070200528     C                     EXSR SRODTA                                    CFT009
123080200528      *                                                                                       CCG015
123090200528     C                     EXSR POPGRS                                                        CCG015
123100200528      *                                                                   CFT009
123110200528      *................................................................   CFT009
123120200528      **  Unwind subroutine stack name                                    CFT009
123130200528      *                                                                   CFT009
123140200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
123150200528     C                     SUB  1         Q                               CFT009
123160200528      *                                                                   CFT009
123170200528     C                     ENDSR                                          CFT009
123180200528      /SPACE 5                                                            CFT009
123190200528      *****************************************************************   CFT009
123200200528      * Subroutine  :  CTENTC                                         *   CFT009
123210200528      * Function    :  Entered Charges                                *   CFT009
123220200528      *                                                               *   CFT009
123230200528      * Called by   :  DRCR06                                         *   CFT009
123240200528      * Calls       :                                                 *   CFT009
123250200528      *****************************************************************   CFT009
123260200528     C           CTENTC    BEGSR                                          CFT009
123270200528      *                                                                   CFT009
123280200528      **  Set up subroutine stack name                                    CFT009
123290200528     C                     ADD  1         Q                               CFT009
123300200528     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
123310200528      *                                                                   CFT009
123320200528      *................................................................   CFT009
123330200528      *                                                                   CFT009
123340200528      **  Retrieve subroutine specific data.                              CFT009
123350200528     C           1         OCUR ##SRDT                                    CFT009
123360200528     C                     MOVEL##SPAT    S#PATH                          CFT009
123370200528      *                                                                   CFT009
123380200528      **  Set up Path.                                                    CFT009
123390200528     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
123400200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
123410200528      *                                                                                       CCG015
123420200528     C                     EXSR PSHGRS                                                        CCG015
123430200528      *                                                                   CFT009
123440200528      **  Retrieve RDE information for RDEs in group set                  CFT009
123450200528      *                                                                   CFT009
123460200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
123470200528     C                     Z-ADD1         ##RDEN                          CFT009
123480200528     C                     EXSR SRRRDE                                    CFT009
123490200528      *                                                                   CFT009
123500200528     C                     MOVELM2CHGC    ##WCCY  3                       CFT009
123510200528      *                                                                   CFT009
123520200528      **  Charge currency                                                 CFT009
123530200528     C                     MOVEL##WCCY    ##D,1                           CFT009
123540200528      *                                                                   CFT009
123550200528      **  Obtain currency details                                         CFT009
123560200528     C           ##WCCY    IFNE *BLANKS                                                     BUG15265
123570200528     C           M2CHGC    IFNE *BLANKS                                                     BUG12827
123580200528     C                     CALL 'AOCURRR0'                                CFT009
123590200528     C                     PARM *BLANKS   @RTCD   7                       CFT009
123600200528     C                     PARM '*KEY   ' @OPTN   7                       CFT009
123610200528     C                     PARM ##WCCY    @AJCD   3                       CFT009
123620200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
123630200528      *                                                                   CFT009
123640200528      ** DATABASE ERROR                                                   CFT009
123650200528      *                                                                   CFT009
123660200528     C           @RTCD     IFNE *BLANK                                    CFT009
123670200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
123680200528     C                     MOVEL##WCCY    W0KEY            ***************CFT009
123690200528     C                     Z-ADD57        W0ERNB           * DB ERROR 57 *CFT009
123700200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
123710200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
123720200528     C                     EXSR SRERR                                     CFT009
123730200528     C                     ENDIF                                          CFT009
123740200528     C                     ENDIF                                                            BUG12827
123750200528      *                                                                   CFT009
123760200528     C                     MOVELA6INCY    WCHGIN  1                       CFT009
123770200528     C                     ENDIF                                                            BUG15265
123780200528      *                                                                   CFT009
123790200528      ** Amount                                                           CFT009
123800200528      *                                                                   CFT009
123810200528     C                     MOVELTRCOCH    ##D,2                           CFT009
123820200528     C                     MOVE A6NBDP    ##D,2                           CFT009
123830200528     C                     MOVELFXCHAC    ##D,3                           CFT009
123840200528     C                     MOVE A6NBDP    ##D,3                           CFT009
123850200528     C                     MOVELMICH1     ##D,17                          CFT009
123860200528     C                     MOVE A6NBDP    ##D,17                          CFT009
123870200528     C                     MOVELMICH2     ##D,18                          CFT009
123880200528     C                     MOVE A6NBDP    ##D,18                          CFT009
123890200528     C                     MOVELMICH3     ##D,19                          CFT009
123900200528     C                     MOVE A6NBDP    ##D,19                          CFT009
123910200528     C                     MOVELMICH4     ##D,20                          CFT009
123920200528     C                     MOVE A6NBDP    ##D,20                          CFT009
123930200528      *                                                                   CFT009
123940200528      **  Accumulate RDE's and associated data and output to              CFT009
123950200528      **  PF/CGUDTAPD.                                                    CFT009
123960200528      *                                                                   CFT009
123970200528     C                     EXSR SRADTA                                    CFT009
123980200528     C                     MOVEL##SDS     ##ADS                           CFT009
123990200528      *                                                                   CFT009
124000200528      **  Retrieve RDE information for RDEs in group set                  CFT009
124010200528      *                                                                   CFT009
124020200528     C                     Z-ADD21        ##RDEN                          CFT009
124030200528     C                     EXSR SRRRDE                                    CFT009
124040200528     C                     MOVELMICH5     ##D,1                           CFT009
124050200528     C                     MOVE A6NBDP    ##D,1                           CFT009
124060200528      *                                                                   CFT009
124070200528      **  Accumulate RDE's and associated data and output to              CFT009
124080200528      **  PF/CGUDTAPD.                                                    CFT009
124090200528     C                     EXSR SRADTA                                    CFT009
124100200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
124110200528      *                                                                   CFT009
124120200528      **  Initialise Write Format Parameter.                              CFT009
124130200528     C                     CLEARW0FMT                                     CFT009
124140200528      *                                                                   CFT009
124150200528      **  Set up Control Information.                                     CFT009
124160200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
124170200528     C                     ADD  1         ##OSEQ                          CFT009
124180200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
124190200528     C                     Z-ADD1         DEPBIN                          CFT009
124200200528     C                     Z-ADD1         DETBIN                          CFT009
124210200528     C                     MOVE 'FR'      DEFSLI                          CFT009
124220200528     C                     MOVE *BLANKS   W0PATH                          CFT009
124230200528     C                     MOVELS#PATH    W0PATH                          CFT009
124240200528      *                                                                   CFT009
124250200528      **  Append Data from pack routine.                                  CFT009
124260200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
124270200528     C                     EXSR SRODTA                                    CFT009
124280200528      *                                                                   CFT009
124290200528      ** Totals                                                           CFT009
124300200528      *                                                                   CFT009
124310200528     C           TRCOCH    ADD  FXCHAC    SUMAMT 150                      CFT009
124320200528     C                     ADD  MICH1     SUMAMT                          CFT009
124330200528     C                     ADD  MICH2     SUMAMT                          CFT009
124340200528     C                     ADD  MICH3     SUMAMT                          CFT009
124350200528     C                     ADD  MICH4     SUMAMT                          CFT009
124360200528     C                     ADD  MICH5     SUMAMT                          CFT009
124370200528      *                                                                                       CCG015
124380200528     C                     EXSR POPGRS                                                        CCG015
124390200528      *                                                                   CFT009
124400200528      *................................................................   CFT009
124410200528      **  Unwind subroutine stack name                                    CFT009
124420200528      *                                                                   CFT009
124430200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
124440200528     C                     SUB  1         Q                               CFT009
124450200528      *                                                                   CFT009
124460200528     C                     ENDSR                                          CFT009
124470200528      /SPACE 5                                                            CFT009
124480200528      *****************************************************************   CFT009
124490200528      * Subroutine  :  CTVATA                                         *   CFT009
124500200528      * Function    :  Entered Charges VAT                            *   CFT009
124510200528      *                                                               *   CFT009
124520200528      * Called by   :  DRCR06                                         *   CFT009
124530200528      * Calls       :                                                 *   CFT009
124540200528      *****************************************************************   CFT009
124550200528     C           CTVATA    BEGSR                                          CFT009
124560200528      *                                                                   CFT009
124570200528      **  Set up subroutine stack name                                    CFT009
124580200528     C                     ADD  1         Q                               CFT009
124590200528     C                     MOVEL'VATA  '  @STK,Q                          CFT009
124600200528      *                                                                   CFT009
124610200528      *................................................................   CFT009
124620200528      *                                                                   CFT009
124630200528      **  Retrieve subroutine specific data.                              CFT009
124640200528     C           1         OCUR ##SRDT                                    CFT009
124650200528     C                     MOVEL##SPAT    S#PATH                          CFT009
124660200528      *                                                                   CFT009
124670200528      **  Set up Path.                                                    CFT009
124680200528     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
124690200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
124700200528      *                                                                                       CCG015
124710200528     C                     EXSR PSHGRS                                                        CCG015
124720200528      *                                                                   CFT009
124730200528      **  Retrieve RDE information for RDEs in group set                  CFT009
124740200528      *                                                                   CFT009
124750200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
124760200528     C                     Z-ADD1         ##RDEN                          CFT009
124770200528     C                     EXSR SRRRDE                                    CFT009
124780200528      *                                                                   CFT009
124790200528     C                     Z-ADD0         SUMVAT                          CFT009
124800200528      *                                                                   CFT009
124810200528     C           CFT10     IFEQ 'Y'                                       CFT009
124820200528      *                                                                   CFT009
124830200528     C           VTRCC     IFEQ 'Y'                                       CFT009
124840200528     C           VARATE    MULT TRCOCH    VAT    150H                     CFT009
124850200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
124860200528     C                     ELSE                                           CFT009
124870200528     C                     Z-ADD0         VAT                             CFT009
124880200528     C                     Z-ADD0         SUMVAT                          CFT009
124890200528     C                     ENDIF                                          CFT009
124900200528      *                                                                   CFT009
124910200528     C                     MOVELVAT       ##D,12                          CFT009
124920200528     C                     MOVE A6NBDP    ##D,12                          CFT009
124930200528      *                                                                   CFT009
124940200528     C           VAFCCC    IFEQ 'Y'                                       CFT009
124950200528     C           VARATE    MULT FXCHAC    VAT       H                     CFT009
124960200528     C                     ELSE                                           CFT009
124970200528     C                     Z-ADD0         VAT                             CFT009
124980200528     C                     ENDIF                                          CFT009
124990200528      *                                                                   CFT009
125000200528     C                     ADD  VAT       SUMVAT                          CFT009
125010200528     C                     MOVELVAT       ##D,13                          CFT009
125020200528     C                     MOVE A6NBDP    ##D,13                          CFT009
125030200528      *                                                                   CFT009
125040200528     C           VMICH1    IFEQ 'Y'                                       CFT009
125050200528     C           VARATE    MULT MICH1     VAT       H                     CFT009
125060200528     C                     ELSE                                           CFT009
125070200528     C                     Z-ADD0         VAT                             CFT009
125080200528     C                     ENDIF                                          CFT009
125090200528      *                                                                   CFT009
125100200528     C                     ADD  VAT       SUMVAT                          CFT009
125110200528     C                     MOVELVAT       ##D,7                           CFT009
125120200528     C                     MOVE A6NBDP    ##D,7                           CFT009
125130200528      *                                                                   CFT009
125140200528     C           VMICH2    IFEQ 'Y'                                       CFT009
125150200528     C           VARATE    MULT MICH2     VAT       H                     CFT009
125160200528     C                     ELSE                                           CFT009
125170200528     C                     Z-ADD0         VAT                             CFT009
125180200528     C                     ENDIF                                          CFT009
125190200528      *                                                                   CFT009
125200200528     C                     ADD  VAT       SUMVAT                          CFT009
125210200528     C                     MOVELVAT       ##D,8                           CFT009
125220200528     C                     MOVE A6NBDP    ##D,8                           CFT009
125230200528      *                                                                   CFT009
125240200528     C           VMICH3    IFEQ 'Y'                                       CFT009
125250200528     C           VARATE    MULT MICH3     VAT       H                     CFT009
125260200528     C                     ELSE                                           CFT009
125270200528     C                     Z-ADD0         VAT                             CFT009
125280200528     C                     ENDIF                                          CFT009
125290200528      *                                                                   CFT009
125300200528     C                     ADD  VAT       SUMVAT                          CFT009
125310200528     C                     MOVELVAT       ##D,9                           CFT009
125320200528     C                     MOVE A6NBDP    ##D,9                           CFT009
125330200528      *                                                                   CFT009
125340200528     C           VMICH4    IFEQ 'Y'                                       CFT009
125350200528     C           VARATE    MULT MICH4     VAT       H                     CFT009
125360200528     C                     ELSE                                           CFT009
125370200528     C                     Z-ADD0         VAT                             CFT009
125380200528     C                     ENDIF                                          CFT009
125390200528      *                                                                   CFT009
125400200528     C                     ADD  VAT       SUMVAT                          CFT009
125410200528     C                     MOVELVAT       ##D,10                          CFT009
125420200528     C                     MOVE A6NBDP    ##D,10                          CFT009
125430200528      *                                                                   CFT009
125440200528     C           VMICH5    IFEQ 'Y'                                       CFT009
125450200528     C           VARATE    MULT MICH5     VAT       H                     CFT009
125460200528     C                     ELSE                                           CFT009
125470200528     C                     Z-ADD0         VAT                             CFT009
125480200528     C                     ENDIF                                          CFT009
125490200528      *                                                                   CFT009
125500200528     C                     ADD  VAT       SUMVAT                          CFT009
125510200528     C                     MOVELVAT       ##D,11                          CFT009
125520200528     C                     MOVE A6NBDP    ##D,11                          CFT009
125530200528      *                                                                   CFT009
125540200528     C                     ENDIF                                          CFT009
125550200528      *                                                                   CFT009
125560200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
125570200528     C                     MOVELSUMCHG    ##D,17                          CFT009
125580200528     C                     MOVE A6NBDP    ##D,17                          CFT009
125590200528      *                                                                   CFT009
125600200528      **  Accumulate RDE's and associated data and output to              CFT009
125610200528      **  PF/CGUDTAPD.                                                    CFT009
125620200528     C                     EXSR SRADTA                                    CFT009
125630200528     C                     EXSR SRODTA                                    CFT009
125640200528      *                                                                                       CCG015
125650200528     C                     EXSR POPGRS                                                        CCG015
125660200528      *                                                                   CFT009
125670200528      *................................................................   CFT009
125680200528      **  Unwind subroutine stack name                                    CFT009
125690200528      *                                                                   CFT009
125700200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
125710200528     C                     SUB  1         Q                               CFT009
125720200528      *                                                                   CFT009
125730200528     C                     ENDSR                                          CFT009
125740200528      /SPACE 5                                                            CFT009
125750200528      *****************************************************************   CFT009
125760200528      * Subroutine  :  CTEURC                                         *   CFT009
125770200528      * Function    :  Euro charges                                   *   CFT009
125780200528      *                                                               *   CFT009
125790200528      * Called by   :  DRCR06                                         *   CFT009
125800200528      * Calls       :                                                 *   CFT009
125810200528      *****************************************************************   CFT009
125820200528     C           CTEURC    BEGSR                                          CFT009
125830200528      *                                                                   CFT009
125840200528      **  Set up subroutine stack name                                    CFT009
125850200528     C                     ADD  1         Q                               CFT009
125860200528     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
125870200528      *                                                                   CFT009
125880200528      *................................................................   CFT009
125890200528      *                                                                   CFT009
125900200528      **  Retrieve subroutine specific data.                              CFT009
125910200528     C           1         OCUR ##SRDT                                    CFT009
125920200528     C                     MOVEL##SPAT    S#PATH                          CFT009
125930200528      *                                                                   CFT009
125940200528      **  Set up Path.                                                    CFT009
125950200528     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
125960200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
125970200528      *                                                                                       CCG015
125980200528     C                     EXSR PSHGRS                                                        CCG015
125990200528      *                                                                   CFT009
126000200528      **  Retrieve RDE information for RDEs in group set                  CFT009
126010200528      *                                                                   CFT009
126020200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
126030200528     C                     Z-ADD1         ##RDEN                          CFT009
126040200528     C                     EXSR SRRRDE                                    CFT009
126050200528      *                                                                   CFT009
126060200528      **  Determine the number of decimal places for Euro                 CFT009
126070200528      *                                                                   CFT009
126080200528     C                     CALL 'AOCURRR0'                                CFT009
126090200528     C                     PARM *BLANKS   @RTCD                           CFT009
126100200528     C                     PARM '*KEY   ' @OPTN                           CFT009
126110200528     C                     PARM BKEURO    @AJCD                           CFT009
126120200528     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
126130200528      *                                                                   CFT009
126140200528      ** DATABASE ERROR                                                   CFT009
126150200528     C           @RTCD     IFNE *BLANK                                    CFT009
126160200528     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
126170200528     C                     MOVEL#CCY      W0KEY            ***************CFT009
126180200528     C                     Z-ADD58        W0ERNB           * DB ERROR 58 *CFT009
126190200528     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
126200200528     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
126210200528     C                     EXSR SRERR                                     CFT009
126220200528     C                     ENDIF                                          CFT009
126230200528      *                                                                   CFT009
126240200528      ** Euro Currency                                                    CFT009
126250200528     C                     MOVELBKEURO    ##D,1                           CFT009
126260200528     C                     MOVELBKEURO    #CCY                            CFT009
126270200528      *                                                                   CFT009
126280200528     C                     CLEARP#0010                                    CFT009
126290200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126300200528     C                     Z-ADDTRCOCH    P#FRAM                          CFT009
126310200528     C                     EXSR EURAMT                                    CFT009
126320200528     C                     MOVELW#TOAM    ##D,2                           CFT009
126330200528     C                     MOVE A6NBDP    ##D,2                           CFT009
126340200528      *                                                                   CFT009
126350200528     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
126360200528     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
126370200528      *                                                                   CFT009
126380200528     C                     CLEARP#0010                                    CFT009
126390200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126400200528     C                     Z-ADDFXCHAC    P#FRAM                          CFT009
126410200528     C                     EXSR EURAMT                                    CFT009
126420200528     C                     MOVELW#TOAM    ##D,3                           CFT009
126430200528     C                     MOVE A6NBDP    ##D,3                           CFT009
126440200528      *                                                                   CFT009
126450200528     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
126460200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
126470200528      *                                                                   CFT009
126480200528     C                     CLEARP#0010                                    CFT009
126490200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126500200528     C                     Z-ADDMICH1     P#FRAM                          CFT009
126510200528     C                     EXSR EURAMT                                    CFT009
126520200528     C                     MOVELW#TOAM    ##D,17                          CFT009
126530200528     C                     MOVE A6NBDP    ##D,17                          CFT009
126540200528      *                                                                   CFT009
126550200528     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
126560200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
126570200528      *                                                                   CFT009
126580200528     C                     CLEARP#0010                                    CFT009
126590200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126600200528     C                     Z-ADDMICH2     P#FRAM                          CFT009
126610200528     C                     EXSR EURAMT                                    CFT009
126620200528     C                     MOVELW#TOAM    ##D,18                          CFT009
126630200528     C                     MOVE A6NBDP    ##D,18                          CFT009
126640200528      *                                                                   CFT009
126650200528     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
126660200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
126670200528      *                                                                   CFT009
126680200528     C                     CLEARP#0010                                    CFT009
126690200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126700200528     C                     Z-ADDMICH3     P#FRAM                          CFT009
126710200528     C                     EXSR EURAMT                                    CFT009
126720200528     C                     MOVELW#TOAM    ##D,19                          CFT009
126730200528     C                     MOVE A6NBDP    ##D,19                          CFT009
126740200528      *                                                                   CFT009
126750200528     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
126760200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
126770200528      *                                                                   CFT009
126780200528     C                     CLEARP#0010                                    CFT009
126790200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
126800200528     C                     Z-ADDMICH4     P#FRAM                          CFT009
126810200528     C                     EXSR EURAMT                                    CFT009
126820200528     C                     MOVELW#TOAM    ##D,20                          CFT009
126830200528     C                     MOVE A6NBDP    ##D,20                          CFT009
126840200528      *                                                                   CFT009
126850200528     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
126860200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
126870200528      *                                                                   CFT009
126880200528      **  Accumulate RDE's and associated data and output to              CFT009
126890200528      **  PF/CGUDTAPD.                                                    CFT009
126900200528      *                                                                   CFT009
126910200528     C                     EXSR SRADTA                                    CFT009
126920200528     C                     MOVEL##SDS     ##ADS                           CFT009
126930200528      *                                                                   CFT009
126940200528      **  Retrieve RDE information for RDEs in group set                  CFT009
126950200528      *                                                                   CFT009
126960200528     C                     Z-ADD21        ##RDEN                          CFT009
126970200528     C                     EXSR SRRRDE                                    CFT009
126980200528      *                                                                   CFT009
126990200528     C                     CLEARP#0010                                    CFT009
127000200528     C                     MOVE ##WCCY    P#FRCY                          CFT009
127010200528     C                     Z-ADDMICH5     P#FRAM                          CFT009
127020200528     C                     EXSR EURAMT                                    CFT009
127030200528     C                     MOVELW#TOAM    ##D,1                           CFT009
127040200528     C                     MOVE A6NBDP    ##D,1                           CFT009
127050200528      *                                                                   CFT009
127060200528     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
127070200528     C                     ADD  W#TOAM    SUMAMT                          CFT009
127080200528      *                                                                   CFT009
127090200528      **  Accumulate RDE's and associated data and output to              CFT009
127100200528      **  PF/CGUDTAPD.                                                    CFT009
127110200528     C                     EXSR SRADTA                                    CFT009
127120200528     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
127130200528      *                                                                   CFT009
127140200528      **  Initialise Write Format Parameter.                              CFT009
127150200528     C                     CLEARW0FMT                                     CFT009
127160200528      *                                                                   CFT009
127170200528      **  Set up Control Information.                                     CFT009
127180200528     C                     Z-ADD##ITEM    DEITEM                          CFT009
127190200528     C                     ADD  1         ##OSEQ                          CFT009
127200200528     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
127210200528     C                     Z-ADD1         DEPBIN                          CFT009
127220200528     C                     Z-ADD1         DETBIN                          CFT009
127230200528     C                     MOVE 'FR'      DEFSLI                          CFT009
127240200528     C                     MOVE *BLANKS   W0PATH                          CFT009
127250200528     C                     MOVELS#PATH    W0PATH                          CFT009
127260200528      *                                                                   CFT009
127270200528      **  Append Data from pack routine.                                  CFT009
127280200528     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
127290200528     C                     EXSR SRODTA                                    CFT009
127300200528      *                                                                                       CCG015
127310200528     C                     EXSR POPGRS                                                        CCG015
127320200528      *                                                                   CFT009
127330200528      *................................................................   CFT009
127340200528      **  Unwind subroutine stack name                                    CFT009
127350200528      *                                                                   CFT009
127360200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
127370200528     C                     SUB  1         Q                               CFT009
127380200528      *                                                                   CFT009
127390200528     C                     ENDSR                                          CFT009
127400200528      *                                                                   CFT009
127410200528      /SPACE 5                                                            CFT009
127420200528      *****************************************************************   CFT009
127430200528      * Subroutine  :  CTVATE                                         *   CFT009
127440200528      * Function    :  Euro Charges VAT                               *   CFT009
127450200528      *                                                               *   CFT009
127460200528      * Called by   :  DRCR06                                         *   CFT009
127470200528      * Calls       :                                                 *   CFT009
127480200528      *****************************************************************   CFT009
127490200528     C           CTVATE    BEGSR                                          CFT009
127500200528      *                                                                   CFT009
127510200528      **  Set up subroutine stack name                                    CFT009
127520200528     C                     ADD  1         Q                               CFT009
127530200528     C                     MOVEL'VATE  '  @STK,Q                          CFT009
127540200528      *                                                                   CFT009
127550200528      *................................................................   CFT009
127560200528      *                                                                   CFT009
127570200528      **  Retrieve subroutine specific data.                              CFT009
127580200528     C           1         OCUR ##SRDT                                    CFT009
127590200528     C                     MOVEL##SPAT    S#PATH                          CFT009
127600200528      *                                                                   CFT009
127610200528      **  Set up Path.                                                    CFT009
127620200528     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
127630200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
127640200528      *                                                                                       CCG015
127650200528     C                     EXSR PSHGRS                                                        CCG015
127660200528      *                                                                   CFT009
127670200528      **  Retrieve RDE information for RDEs in group set                  CFT009
127680200528      *                                                                   CFT009
127690200528     C                     MOVEL@STK,Q    ##GRPS                          CFT009
127700200528     C                     Z-ADD1         ##RDEN                          CFT009
127710200528     C                     EXSR SRRRDE                                    CFT009
127720200528      *                                                                   CFT009
127730200528     C                     Z-ADD0         SUMVAT                          CFT009
127740200528      *                                                                   CFT009
127750200528     C           CFT10     IFEQ 'Y'                                       CFT009
127760200528      *                                                                   CFT009
127770200528     C           VTRCC     IFEQ 'Y'                                       CFT009
127780200528     C           VARATE    MULT VAT12     VAT    150H                     CFT009
127790200528     C                     Z-ADDVAT       SUMVAT 150                      CFT009
127800200528     C                     ELSE                                           CFT009
127810200528     C                     Z-ADD0         VAT                             CFT009
127820200528     C                     Z-ADD0         SUMVAT                          CFT009
127830200528     C                     ENDIF                                          CFT009
127840200528      *                                                                   CFT009
127850200528     C                     MOVELVAT       ##D,12                          CFT009
127860200528     C                     MOVE A6NBDP    ##D,12                          CFT009
127870200528      *                                                                   CFT009
127880200528     C           VAFCCC    IFEQ 'Y'                                       CFT009
127890200528     C           VARATE    MULT VAT13     VAT       H                     CFT009
127900200528     C                     ELSE                                           CFT009
127910200528     C                     Z-ADD0         VAT                             CFT009
127920200528     C                     ENDIF                                          CFT009
127930200528      *                                                                   CFT009
127940200528     C                     ADD  VAT       SUMVAT                          CFT009
127950200528     C                     MOVELVAT       ##D,13                          CFT009
127960200528     C                     MOVE A6NBDP    ##D,13                          CFT009
127970200528      *                                                                   CFT009
127980200528     C           VMICH1    IFEQ 'Y'                                       CFT009
127990200528     C           VARATE    MULT VAT7      VAT       H                     CFT009
128000200528     C                     ELSE                                           CFT009
128010200528     C                     Z-ADD0         VAT                             CFT009
128020200528     C                     ENDIF                                          CFT009
128030200528      *                                                                   CFT009
128040200528     C                     ADD  VAT       SUMVAT                          CFT009
128050200528     C                     MOVELVAT       ##D,7                           CFT009
128060200528     C                     MOVE A6NBDP    ##D,7                           CFT009
128070200528      *                                                                   CFT009
128080200528     C           VMICH2    IFEQ 'Y'                                       CFT009
128090200528     C           VARATE    MULT VAT8      VAT       H                     CFT009
128100200528     C                     ELSE                                           CFT009
128110200528     C                     Z-ADD0         VAT                             CFT009
128120200528     C                     ENDIF                                          CFT009
128130200528      *                                                                   CFT009
128140200528     C                     ADD  VAT       SUMVAT                          CFT009
128150200528     C                     MOVELVAT       ##D,8                           CFT009
128160200528     C                     MOVE A6NBDP    ##D,8                           CFT009
128170200528      *                                                                   CFT009
128180200528     C           VMICH3    IFEQ 'Y'                                       CFT009
128190200528     C           VARATE    MULT VAT9      VAT       H                     CFT009
128200200528     C                     ELSE                                           CFT009
128210200528     C                     Z-ADD0         VAT                             CFT009
128220200528     C                     ENDIF                                          CFT009
128230200528      *                                                                   CFT009
128240200528     C                     ADD  VAT       SUMVAT                          CFT009
128250200528     C                     MOVELVAT       ##D,9                           CFT009
128260200528     C                     MOVE A6NBDP    ##D,9                           CFT009
128270200528      *                                                                   CFT009
128280200528     C           VMICH4    IFEQ 'Y'                                       CFT009
128290200528     C           VARATE    MULT VAT10     VAT       H                     CFT009
128300200528     C                     ELSE                                           CFT009
128310200528     C                     Z-ADD0         VAT                             CFT009
128320200528     C                     ENDIF                                          CFT009
128330200528      *                                                                   CFT009
128340200528     C                     ADD  VAT       SUMVAT                          CFT009
128350200528     C                     MOVELVAT       ##D,10                          CFT009
128360200528     C                     MOVE A6NBDP    ##D,10                          CFT009
128370200528      *                                                                   CFT009
128380200528     C           VMICH5    IFEQ 'Y'                                       CFT009
128390200528     C           VARATE    MULT VAT11     VAT       H                     CFT009
128400200528     C                     ELSE                                           CFT009
128410200528     C                     Z-ADD0         VAT                             CFT009
128420200528     C                     ENDIF                                          CFT009
128430200528      *                                                                   CFT009
128440200528     C                     ADD  VAT       SUMVAT                          CFT009
128450200528     C                     MOVELVAT       ##D,11                          CFT009
128460200528     C                     MOVE A6NBDP    ##D,11                          CFT009
128470200528      *                                                                   CFT009
128480200528     C                     ENDIF                                          CFT009
128490200528      *                                                                   CFT009
128500200528     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
128510200528     C                     MOVELSUMCHG    ##D,17                          CFT009
128520200528     C                     MOVE A6NBDP    ##D,17                          CFT009
128530200528      *                                                                   CFT009
128540200528      **  Accumulate RDE's and associated data and output to              CFT009
128550200528      **  PF/CGUDTAPD.                                                    CFT009
128560200528      *                                                                   CFT009
128570200528     C                     EXSR SRADTA                                    CFT009
128580200528     C                     EXSR SRODTA                                    CFT009
128590200528      *                                                                                       CCG015
128600200528     C                     EXSR POPGRS                                                        CCG015
128610200528      *................................................................   CFT009
128620200528      **  Unwind subroutine stack name                                    CFT009
128630200528      *                                                                   CFT009
128640200528     C                     MOVEA*BLANKS   @STK,Q                          CFT009
128650200528     C                     SUB  1         Q                               CFT009
128660200528      *                                                                   CFT009
128670200528     C                     ENDSR                                          CFT009
128680200528      /SPACE 5                                                                                CSW201
128690200528      *****************************************************************                       CSW201
128700200528      *                                                               *                       CSW201
128710200528      *  SRSCGH - CCT Sender Charges Subroutine                       *                       CSW201
128720200528      *                                                               *                       CSW201
128730200528      *  Called by: DRCR06 - Customer Credit Transfer                 *                       CSW201
128740200528      *  Calls: None                                                  *                       CSW201
128750200528      *                                                               *                       CSW201
128760200528      *****************************************************************                       CSW201
128770200528     C           SRSCGH    BEGSR                                                              CSW201
128780200528      ** Set up subroutine stack name                                                         CSW201
128790200528     C                     ADD  1         Q                                                   CSW201
128800200528     C                     MOVEL'FT_SCH'  @STK,Q                                              CSW201
128810200528      ** Retrieve subroutine specific data                                                    CSW201
128820200528     C           1         OCUR ##SRDT                                                        CSW201
128830200528     C                     MOVEL##SPAT    S#PATH                                              CSW201
128840200528      ** Setup Path                                                                           CSW201
128850200528     C                     MOVEL'\FT_SCH' ##PNAM                                              CSW201
128860200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CSW201
128870200528      *                                                                                       CCG015
128880200528     C                     EXSR PSHGRS                                                        CCG015
128890200528      ** Retrieve RDE information for RDEs in group set                                       CSW201
128900200528     C                     MOVEL@STK,Q    ##GRPS                                              CSW201
128910200528     C                     Z-ADD1         ##RDEN                                              CSW201
128920200528     C                     EXSR SRRRDE                                                        CSW201
128930200528      ** Set up fields                                                                        CSW201
128940200528     C                     MOVELSDCCY2    ##D,1                                               CSW201
128950200528     C           SDCCY2    IFNE *BLANKS                                                       CSW201
128960200528     C                     CALL 'AOCURRR0'                                                    CSW201
128970200528     C                     PARM *BLANKS   PRTCD                                               CSW201
128980200528     C                     PARM '*KEY   ' POPTN                                               CSW201
128990200528     C                     PARM SDCCY2    @AJCD                                               CSW201
129000200528     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
129010200528     C           PRTCD     IFNE *BLANKS                                                       CSW201
129020200528     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
129030200528     C                     MOVELSDCCY2    W0KEY            ************                       CSW201
129040200528     C                     Z-ADD59        W0ERNB           * DBERR 59 *                       CSW201
129050200528     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
129060200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
129070200528     C                     EXSR SRERR                                                         CSW201
129080200528     C                     ENDIF                                                              CSW201
129090200528     C                     MOVE A6NBDP    ##D,2                                               CSW201
129100200528     C                     ENDIF                                                              CSW201
129110200528     C                     MOVELSDCHG2    ##D,2                                               CSW201
129120200528     C           PAYCCY    IFNE *BLANKS                                                       CSW201
129130200528     C                     MOVELSDOCG2    ##D,3                                               CSW201
129140200528     C                     MOVE WPDCP     ##D,3                                               CSW201
129150200528     C                     ENDIF                                                              CSW201
129160200528     C           CCTCCY    IFNE *BLANKS                                                       CSW201
129170200528     C                     MOVELSDCTF2    ##D,4                                               CSW201
129180200528     C                     MOVE WTCCT     ##D,4                                               CSW201
129190200528     C                     ENDIF                                                              CSW201
129200200528     C                     MOVELSDCCY3    ##D,5                                               CSW201
129210200528     C           SDCCY3    IFNE *BLANKS                                                       CSW201
129220200528     C                     CALL 'AOCURRR0'                                                    CSW201
129230200528     C                     PARM *BLANKS   PRTCD                                               CSW201
129240200528     C                     PARM '*KEY   ' POPTN                                               CSW201
129250200528     C                     PARM SDCCY3    @AJCD                                               CSW201
129260200528     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
129270200528     C           PRTCD     IFNE *BLANKS                                                       CSW201
129280200528     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
129290200528     C                     MOVELSDCCY3    W0KEY            ************                       CSW201
129300200528     C                     Z-ADD60        W0ERNB           * DBERR 60 *                       CSW201
129310200528     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
129320200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
129330200528     C                     EXSR SRERR                                                         CSW201
129340200528     C                     ENDIF                                                              CSW201
129350200528     C                     MOVE A6NBDP    ##D,6                                               CSW201
129360200528     C                     ENDIF                                                              CSW201
129370200528     C                     MOVELSDCHG3    ##D,6                                               CSW201
129380200528     C           PAYCCY    IFNE *BLANKS                                                       CSW201
129390200528     C                     MOVELSDOCG3    ##D,7                                               CSW201
129400200528     C                     MOVE WPDCP     ##D,7                                               CSW201
129410200528     C                     ENDIF                                                              CSW201
129420200528     C           CCTCCY    IFNE *BLANKS                                                       CSW201
129430200528     C                     MOVELSDCTF3    ##D,8                                               CSW201
129440200528     C                     MOVE WTCCT     ##D,8                                               CSW201
129450200528     C                     ENDIF                                                              CSW201
129460200528     C                     MOVELSDCCY4    ##D,9                                               CSW201
129470200528     C           SDCCY4    IFNE *BLANKS                                                       CSW201
129480200528     C                     CALL 'AOCURRR0'                                                    CSW201
129490200528     C                     PARM *BLANKS   PRTCD                                               CSW201
129500200528     C                     PARM '*KEY   ' POPTN                                               CSW201
129510200528     C                     PARM SDCCY4    @AJCD                                               CSW201
129520200528     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
129530200528     C           PRTCD     IFNE *BLANKS                                                       CSW201
129540200528     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
129550200528     C                     MOVELSDCCY4    W0KEY            ************                       CSW201
129560200528     C                     Z-ADD61        W0ERNB           * DBERR 61 *                       CSW201
129570200528     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
129580200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
129590200528     C                     EXSR SRERR                                                         CSW201
129600200528     C                     ENDIF                                                              CSW201
129610200528     C                     MOVE A6NBDP    ##D,10                                              CSW201
129620200528     C                     ENDIF                                                              CSW201
129630200528     C                     MOVELSDCHG4    ##D,10                                              CSW201
129640200528     C           PAYCCY    IFNE *BLANKS                                                       CSW201
129650200528     C                     MOVELSDOCG4    ##D,11                                              CSW201
129660200528     C                     MOVE WPDCP     ##D,11                                              CSW201
129670200528     C                     ENDIF                                                              CSW201
129680200528     C           CCTCCY    IFNE *BLANKS                                                       CSW201
129690200528     C                     MOVELSDCTF4    ##D,12                                              CSW201
129700200528     C                     MOVE WTCCT     ##D,12                                              CSW201
129710200528     C                     ENDIF                                                              CSW201
129720200528     C                     MOVELSDCCY5    ##D,13                                              CSW201
129730200528     C           SDCCY5    IFNE *BLANKS                                                       CSW201
129740200528     C                     CALL 'AOCURRR0'                                                    CSW201
129750200528     C                     PARM *BLANKS   PRTCD                                               CSW201
129760200528     C                     PARM '*KEY   ' POPTN                                               CSW201
129770200528     C                     PARM SDCCY5    @AJCD                                               CSW201
129780200528     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
129790200528     C           PRTCD     IFNE *BLANKS                                                       CSW201
129800200528     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
129810200528     C                     MOVELSDCCY5    W0KEY            ************                       CSW201
129820200528     C                     Z-ADD62        W0ERNB           * DBERR 62 *                       CSW201
129830200528     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
129840200528     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
129850200528     C                     EXSR SRERR                                                         CSW201
129860200528     C                     ENDIF                                                              CSW201
129870200528     C                     MOVE A6NBDP    ##D,14                                              CSW201
129880200528     C                     ENDIF                                                              CSW201
129890200528     C                     MOVELSDCHG5    ##D,14                                              CSW201
129900200528     C           PAYCCY    IFNE *BLANKS                                                       CSW201
129910200528     C                     MOVELSDOCG5    ##D,15                                              CSW201
129920200528     C                     MOVE WPDCP     ##D,15                                              CSW201
129930200528     C                     ENDIF                                                              CSW201
129940200528     C           CCTCCY    IFNE *BLANKS                                                       CSW201
129950200528     C                     MOVELSDCTF5    ##D,16                                              CSW201
129960200528     C                     MOVE WTCCT     ##D,16                                              CSW201
129970200528     C                     ENDIF                                                              CSW201
129980200528      ** Accumulate RDE's and associated data and output to                                   CSW201
129990200528      ** PF/CGUDTAPD.                                                                         CSW201
130000200528     C                     EXSR SRADTA                                                        CSW201
130010200528     C                     EXSR SRODTA                                                        CSW201
130020200528      *                                                                                       CCG015
130030200528     C                     EXSR POPGRS                                                        CCG015
130040200528      *................................................................                       CSW201
130050200528      ** Unwind subroutine stack name                                                         CSW201
130060200528     C                     MOVEA*BLANKS   @STK,Q                                              CSW201
130070200528     C                     SUB  1         Q                                                   CSW201
130080200528     C                     ENDSR                                                              CSW201
130090200528      *****************************************************************                       CFT032
130100200528     C/EJECT                                                                                  CFT032
130110200528      *****************************************************************                       CFT032
130120200528      *                                                               *                       CFT032
130130200528      *  SRIBAN - Retrieve Account Information for IBAN               *                       CFT032
130140200528      *                                                               *                       CFT032
130150200528      *  Called By: CORDTA, O@CUST Subroutine                         *                       CFT032
130160200528      *                                                               *                       CFT032
130170200528      *  Calls: AOIBANR4                                              *                       CFT032
130180200528      *                                                               *                       CFT032
130190200528      *****************************************************************                       CFT032
130200200528      *                                                                                       CFT032
130210200528     C           SRIBAN    BEGSR                                                              CFT032
130220200528      *                                                                                       CFT032
130230200528     C                     CALL 'AOIBANR4'                                                    CFT032
130240200528     C                     PARM *BLANKS   @RTCD                                               CFT032
130250200528     C                     PARM '*KEY   ' @OPTN                                               CFT032
130260200528     C                     PARM           WIBAN                                               CFT032
130270200528     C           SDACCT    PARM           DSSDY                                               CFT032
130280200528      *                                                                                       CFT032
130290200528     C                     ENDSR                                                              CFT032
130300200528      *****************************************************************                       CSW201
130310200528      /EJECT                                                                                  CSW201
130320200528      *****************************************************************                       CSW201
130330200528      *                                                               *                       CER031
130340200528      *  SRIPNR    - Retrieve Extended Narratives for Incoming        *                       CER031
130350200528      *              Payments                                         *                       CER031
130360200528      *                                                               *                       CER031
130370200528      *  Called By - DRCR01                                           *                       CER031
130380200528      *                                                               *                       CER031
130390200528      *  Calls     - None                                             *                       CER031
130400200528      *                                                               *                       CER031
130410200528      *****************************************************************                       CER031
130420200528      *                                                                                       CER031
130430200528     C           SRIPNR    BEGSR                                                              CER031
130440200528      *                                                                                       CER031
130450200528      ** Set up subroutine stack name                                                         CER031
130460200528      *                                                                                       CER031
130470200528     C                     ADD  1         Q                                                   CER031
130480200528     C                     MOVEL'SRIPNR ' @STK,Q                                              CER031
130490200528      *                                                                                       CER031
130500200528      ** Setup Account information fields (Beneficiary Customer)                              CER031
130510200528      *                                                                                       CER031
130520200528     C                     MOVE BNCT      WTYPE                                               CER031
130530200528     C                     MOVE PCCY      WCCY                                                CER031
130540200528     C                     MOVE BNC1      WPTY1                                               CER031
130550200528     C                     MOVE BNC2      WPTY2                                               CER031
130560200528     C                     MOVE *BLANKS   WBRCA                                               CER031
130570200528     C                     EXSR SRTPSR                                                        CER031
130580200528      *                                                                                       CER031
130590200528     C                     MOVE W0BRCA    PBRCA   3                                           CER031
130600200528     C**********           MOVE W0CNUM    PCUSNO  60                                   CER031 CER059
130610200528     C                     MOVE W0CNUM    PCUSNO  6                                           CER059
130620200528     C                     MOVE W#CCY     PCUCD   3                                           CER031
130630200528     C                     MOVE W0ACOD    PACCD                                               CER031
130640200528     C                     MOVE W0ACSQ    PACSQ                                               CER031
130650200528      *                                                                                       CER031
130660200528      ** Extract Credit Narratives                                                            CER031
130670200528      *                                                                                       CER031
130680200528     C                     MOVELIEXT1     PNARR1                                              CER031
130690200528     C                     MOVELIEXT2     PNARR2                                              CER031
130700200528     C                     MOVELIEXT3     PNARR3                                              CER031
130710200528     C                     MOVELIEXT4     PNARR4                                              CER031
130720200528     C                     MOVELIEXT5     PNARR5                                              CER031
130730200528     C                     MOVELIEXT6     PNARR6                                              CER031
130740200528     C                     EXSR CEXNAR                                                        CER031
130750200528      *                                                                                       CER031
130760200528     C                     MOVE *BLANKS   @STK,Q                                              CER031
130770200528     C                     SUB  1         Q                                                   CER031
130780200528      *                                                                                       CER031
130790200528     C                     ENDSR                                                              CER031
130800200528      *****************************************************************                       CER031
130810200528     C/EJECT                                                                                  CER031
130820200528      *****************************************************************                       CER031
130830200528      *                                                               *                       CER031
130840200528      *  SROPNR    - Retrieve Extended Narratives for Outgoing        *                       CER031
130850200528      *              Payments                                         *                       CER031
130860200528      *                                                               *                       CER031
130870200528      *  Called By - DRCR02                                           *                       CER031
130880200528      *                                                               *                       CER031
130890200528      *  Calls     - None                                             *                       CER031
130900200528      *                                                               *                       CER031
130910200528      *****************************************************************                       CER031
130920200528      *                                                                                       CER031
130930200528     C           SROPNR    BEGSR                                                              CER031
130940200528      *                                                                                       CER031
130950200528      ** Set up subroutine stack name                                                         CER031
130960200528      *                                                                                       CER031
130970200528     C                     ADD  1         Q                                                   CER031
130980200528     C                     MOVEL'SROPNR ' @STK,Q                                              CER031
130990200528      *                                                                                       CER031
131000200528      ** Setup Account information fields (Ordering Customer)                                 CER031
131010200528      *                                                                                       CER031
131020200528     C                     MOVE ORCT      WTYPE                                               CER031
131030200528     C           1         SUBSTORC1:1    WSLSH     P                                         CER031
131040200528      *                                                                                       CER031
131050200528     C           WSLSH     IFEQ '/'                                                           CER031
131060200528     C           18        SUBSTORC1:2    WPTY                                                CER031
131070200528      *                                                                                       CER031
131080200528     C           ORCT      IFEQ 'R'                                                           CER031
131090200528     C           ORCT      OREQ 'P'                                                           CER031
131100200528     C           ORCT      OREQ 'I'                                                           CER031
131110200528     C           34        SUBSTORC1:2    WPTY1     P                                         CER031
131120200528     C                     ELSE                                                               CER031
131130200528      *                                                                                       CER031
131140200528     C                     MOVE ORC2      WPTY1                                               CER031
131150200528     C                     ENDIF                                                              CER031
131160200528     C                     ELSE                                                               CER031
131170200528      *                                                                                       CER031
131180200528     C                     MOVELORC1      WPTY                                                CER031
131190200528     C                     MOVELORC1      WPTY1                                               CER031
131200200528     C                     ENDIF                                                              CER031
131210200528      *                                                                                       CER031
131220200528     C                     MOVE SMCY      WCCY                                                CER031
131230200528     C                     MOVE ORC2      WPTY2                                               CER031
131240200528     C                     MOVE *BLANKS   WBRCA                                               CER031
131250200528     C                     EXSR SRTPSR                                                        CER031
131260200528      *                                                                                       CER031
131270200528     C                     MOVE W0BRCA    PBRCA                                               CER031
131280200528     C                     MOVE W0CNUM    PCUSNO                                              CER031
131290200528     C                     MOVE W#CCY     PCUCD                                               CER031
131300200528     C                     MOVE W0ACOD    PACCD                                               CER031
131310200528     C                     MOVE W0ACSQ    PACSQ                                               CER031
131320200528      *                                                                                       CER031
131330200528      ** Extract Debit Narratives                                                             CER031
131340200528      *                                                                                       CER031
131350200528     C                     MOVELOPEXT1    PNARR1                                              CER031
131360200528     C                     MOVELOPEXT2    PNARR2                                              CER031
131370200528     C                     MOVELOPEXT3    PNARR3                                              CER031
131380200528     C                     MOVELOPEXT4    PNARR4                                              CER031
131390200528     C                     MOVELOPEXT5    PNARR5                                              CER031
131400200528     C                     MOVELOPEXT6    PNARR6                                              CER031
131410200528     C                     EXSR DEXNAR                                                        CER031
131420200528      *                                                                                       CER031
131430200528      ** Setup Account information fields (Destination Customer)                              CER031
131440200528      *                                                                                       CER031
131450200528     C                     MOVE DSTT      WTYPE                                               CER031
131460200528     C                     MOVE PCCY      WCCY                                                CER031
131470200528     C                     MOVE DST1      WPTY1                                               CER031
131480200528     C                     MOVE DST2      WPTY2                                               CER031
131490200528     C                     MOVE *BLANKS   WBRCA                                               CER031
131500200528     C                     EXSR SRTPSR                                                        CER031
131510200528      *                                                                                       CER031
131520200528     C                     MOVE W0BRCA    PBRCA                                               CER031
131530200528     C                     MOVE W0CNUM    PCUSNO                                              CER031
131540200528     C                     MOVE W#CCY     PCUCD                                               CER031
131550200528     C                     MOVE W0ACOD    PACCD                                               CER031
131560200528     C                     MOVE W0ACSQ    PACSQ                                               CER031
131570200528      *                                                                                       CER031
131580200528      ** Extract Credit Narratives                                                            CER031
131590200528      *                                                                                       CER031
131600200528     C                     MOVELOPEXC1    PNARR1                                              CER031
131610200528     C                     MOVELOPEXC2    PNARR2                                              CER031
131620200528     C                     MOVELOPEXC3    PNARR3                                              CER031
131630200528     C                     MOVELOPEXC4    PNARR4                                              CER031
131640200528     C                     MOVELOPEXC5    PNARR5                                              CER031
131650200528     C                     MOVELOPEXC6    PNARR6                                              CER031
131660200528     C                     EXSR CEXNAR                                                        CER031
131670200528      *                                                                                       CER031
131680200528     C                     MOVE *BLANKS   @STK,Q                                              CER031
131690200528     C                     SUB  1         Q                                                   CER031
131700200528      *                                                                                       CER031
131710200528     C                     ENDSR                                                              CER031
131720200528      *****************************************************************                       CER031
131730200528     C/EJECT                                                                                  CER031
131740200528      *****************************************************************                       CER031
131750200528      *                                                               *                       CER031
131760200528      *  DEXNAR    - Extract Extended Debit Narrative                 *                       CER031
131770200528      *                                                               *                       CER031
131780200528      *  Called By - SrOPNr                                           *                       CER031
131790200528      *                                                               *                       CER031
131800200528      *  Calls     - None                                             *                       CER031
131810200528      *                                                               *                       CER031
131820200528      *****************************************************************                       CER031
131830200528      *                                                                                       CER031
131840200528     C           DEXNAR    BEGSR                                                              CER031
131850200528      *                                                                                       CER031
131860200528      ** Set up subroutine stack name                                                         CER031
131870200528      *                                                                                       CER031
131880200528     C                     ADD  1         Q                                                   CER031
131890200528     C                     MOVEL'DEXNAR  '@STK,Q                                              CER031
131900200528      *                                                                                       CER031
131910200528      ** Retrieve subroutine specific data                                                    CER031
131920200528      *                                                                                       CER031
131930200528     C           1         OCUR ##SRDT                                                        CER031
131940200528     C                     MOVEL##SPAT    S#PATH                                              CER031
131950200528      *                                                                                       CER031
131960200528      ** Setup path                                                                           CER031
131970200528      *                                                                                       CER031
131980200528     C                     MOVEL'\DEXNAR' ##PNAM                                              CER031
131990200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
132000200528     C                     EXSR PSHGRS                                                        CER031
132010200528      *                                                                                       CER031
132020200528      ** Retrieve RDE info                                                                    CER031
132030200528      *                                                                                       CER031
132040200528     C                     MOVEL@STK,Q    ##GRPS                                              CER031
132050200528     C                     Z-ADD1         ##RDEN                                              CER031
132060200528     C                     EXSR SRRRDE                                                        CER031
132070200528      *                                                                                       CER031
132080200528      ** Format Narrative fields                                                              CER031
132090200528      *                                                                                       CER031
132100200528     C                     MOVE '*FORMAT' POPTN                                               CER031
132110200528      *                                                                                     BUG23445
132120200528      ** Format according to network Paper if Account is linked                             BUG23445
132130200528      *                                                                                     BUG23445
132140200528     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
132150200528     C           CGL013    IFEQ 'Y'                                                         BUG23445
132160200528     C                     MOVEL'PAPER'   KNWRK   6                                         BUG23445
132170200528     C                     MOVE PACCD     KACCDX 100                                        BUG23445
132180200528     C                     MOVE PACSQ     KACSQX  20                                        BUG23445
132190200528     C********** KACCT     CHAINGLNW94L1             95                           BUG23445 BUG23445A
132200200528     C           KACCT     CHAINGLNWACL1             95                                    BUG23445A
132210200528     C           *IN95     IFEQ *OFF                                                        BUG23445
132220200528     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
132230200528     C                     MOVELNANWRK    PNTWK                                            BUG23445A
132240200528     C                     ENDIF                                                            BUG23445
132250200528     C                     ENDIF                                                            BUG23445
132260200528      *                                                                                       CER031
132270200528      ** Call the MG001900 access object to format the extended                               CER031
132280200528      ** narratives                                                                           CER031
132290200528      *                                                                                       CER031
132300200528     C                     CALL 'MG001900'                                                    CER031
132310200528     C                     PARM           PRTCD2 10                                           CER031
132320200528     C                     PARM           POPTN   7                                           CER031
132330200528     C                     PARM           PNTWK   6                                           CER031
132340200528     C                     PARM           PMGTYP  3                                           CER031
132350200528     C                     PARM           PBRCA                                               CER031
132360200528     C                     PARM           PCUSNO                                              CER031
132370200528     C                     PARM           PCUCD                                               CER031
132380200528     C                     PARM           PACCD                                               CER031
132390200528     C                     PARM           PACSQ                                               CER031
132400200528     C                     PARM           PDCIN   1                                           CER031
132410200528     C                     PARM           PTRTP   5                                           CER031
132420200528     C                     PARM           PNARR1 65                                           CER031
132430200528     C                     PARM           PNARR2 65                                           CER031
132440200528     C                     PARM           PNARR3 65                                           CER031
132450200528     C                     PARM           PNARR4 65                                           CER031
132460200528     C                     PARM           PNARR5 65                                           CER031
132470200528     C                     PARM           PNARR6 65                                           CER031
132480200528     C**********           PARM           PRTF1  70                                  CER031 BUG23197
132490200528     C**********           PARM           PRTF2  70                                  CER031 BUG23197
132500200528     C**********           PARM           PRTF3  70                                  CER031 BUG23197
132510200528     C**********           PARM           PRTF4  70                                  CER031 BUG23197
132520200528     C**********           PARM           PRTF5  70                                  CER031 BUG23197
132530200528     C**********           PARM           PRTF6  70                                  CER031 BUG23197
132540200528     C**********           PARM           PRTF7  70                                  CER031 BUG23197
132550200528     C**********           PARM           PRTF8  70                                  CER031 BUG23197
132560200528     C**********           PARM           PRTF9  70                                  CER031 BUG23197
132570200528     C**********           PARM           PRTF10 70                                  CER031 BUG23197
132580200528     C**********           PARM           PRTF11 70                                  CER031 BUG23197
132590200528     C**********           PARM           PRTF12 70                                  CER031 BUG23197
132600200528     C**********           PARM           PRTF13 70                                  CER031 BUG23197
132610200528     C**********           PARM           PRTF14 70                                  CER031 BUG23197
132620200528     C**********           PARM           PRTF15 70                                  CER031 BUG23197
132630200528     C**********           PARM           PRTF16 70                                  CER031 BUG23197
132640200528     C**********           PARM           PRTF17 70                                  CER031 BUG23197
132650200528     C**********           PARM           PRTF18 70                                  CER031 BUG23197
132660200528     C**********           PARM           PRTF19 70                                  CER031 BUG23197
132670200528     C**********           PARM           PRTF20 70                                  CER031 BUG23197
132680200528     C                     PARM *BLANKS   PRTF1  70                                         BUG23197
132690200528     C                     PARM *BLANKS   PRTF2  70                                         BUG23197
132700200528     C                     PARM *BLANKS   PRTF3  70                                         BUG23197
132710200528     C                     PARM *BLANKS   PRTF4  70                                         BUG23197
132720200528     C                     PARM *BLANKS   PRTF5  70                                         BUG23197
132730200528     C                     PARM *BLANKS   PRTF6  70                                         BUG23197
132740200528     C                     PARM *BLANKS   PRTF7  70                                         BUG23197
132750200528     C                     PARM *BLANKS   PRTF8  70                                         BUG23197
132760200528     C                     PARM *BLANKS   PRTF9  70                                         BUG23197
132770200528     C                     PARM *BLANKS   PRTF10 70                                         BUG23197
132780200528     C                     PARM *BLANKS   PRTF11 70                                         BUG23197
132790200528     C                     PARM *BLANKS   PRTF12 70                                         BUG23197
132800200528     C                     PARM *BLANKS   PRTF13 70                                         BUG23197
132810200528     C                     PARM *BLANKS   PRTF14 70                                         BUG23197
132820200528     C                     PARM *BLANKS   PRTF15 70                                         BUG23197
132830200528     C                     PARM *BLANKS   PRTF16 70                                         BUG23197
132840200528     C                     PARM *BLANKS   PRTF17 70                                         BUG23197
132850200528     C                     PARM *BLANKS   PRTF18 70                                         BUG23197
132860200528     C                     PARM *BLANKS   PRTF19 70                                         BUG23197
132870200528     C                     PARM *BLANKS   PRTF20 70                                         BUG23197
132880200528     C                     PARM           IDX     30                                          CER031
132890200528     C                     PARM           FLDNAM                                              CER031
132900200528     C                     PARM           MSGID                                               CER031
132910200528     C                     PARM           MSGDTA                                              CER031
132920200528     C                     PARM           WFLDNM                                              CER031
132930200528     C                     PARM           WMGID                                               CER031
132940200528     C                     PARM           WMGDTA                                              CER031
132950200528      *                                                                                       CER031
132960200528     C           PRTCD2    IFEQ *BLANKS                                                       CER031
132970200528     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
132980200528     C                     MOVELPRTF1     ##D,1                                               CER031
132990200528     C                     MOVELPRTF2     ##D,2                                               CER031
133000200528     C                     MOVELPRTF3     ##D,3                                               CER031
133010200528     C                     MOVELPRTF4     ##D,4                                               CER031
133020200528     C                     MOVELPRTF5     ##D,5                                               CER031
133030200528     C                     MOVELPRTF6     ##D,6                                               CER031
133040200528     C                     MOVELPRTF7     ##D,7                                               CER031
133050200528     C                     MOVELPRTF8     ##D,8                                               CER031
133060200528     C                     MOVELPRTF9     ##D,9                                               CER031
133070200528     C                     MOVELPRTF10    ##D,10                                              CER031
133080200528     C                     MOVELPRTF11    ##D,11                                              CER031
133090200528     C                     MOVELPRTF12    ##D,12                                              CER031
133100200528     C                     MOVELPRTF13    ##D,13                                              CER031
133110200528     C                     MOVELPRTF14    ##D,14                                              CER031
133120200528     C                     MOVELPRTF15    ##D,15                                              CER031
133130200528     C                     MOVELPRTF16    ##D,16                                              CER031
133140200528     C                     MOVELPRTF17    ##D,17                                              CER031
133150200528     C                     MOVELPRTF18    ##D,18                                              CER031
133160200528     C                     MOVELPRTF19    ##D,19                                              CER031
133170200528     C                     MOVELPRTF20    ##D,20                                              CER031
133180200528      *                                                                                       CER031
133190200528     C                     ELSE                                                               CER031
133200200528     C                     MOVE 'MG001900'W0FILE                                              CER031
133210200528     C                     MOVE PNARR1    W0KEY                                               CER031
133220200528     C                     MOVE 64        W0ERNB                                              CER031
133230200528     C                     MOVE 'MEM5003' W0MSGD                                              CER031
133240200528     C                     MOVE 'MIDAS'   W0MSGF                                              CER031
133250200528     C                     EXSR SRERR                                                         CER031
133260200528     C                     ENDIF                                                              CER031
133270200528      *                                                                                       CER031
133280200528      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CER031
133290200528      *                                                                                       CER031
133300200528     C                     EXSR SRADTA                                                        CER031
133310200528     C                     EXSR SRODTA                                                        CER031
133320200528     C           EXDBNR    TAG                                                                CER031
133330200528      *                                                                                       CER031
133340200528      ** Unwind subroutine stack name                                                         CER031
133350200528      *                                                                                       CER031
133360200528     C                     EXSR POPGRS                                                        CER031
133370200528     C                     MOVEA*BLANKS   @STK,Q                                              CER031
133380200528     C                     SUB  1         Q                                                   CER031
133390200528      *                                                                                       CER031
133400200528     C                     ENDSR                                                              CER031
133410200528      *****************************************************************                       CER031
133420200528     C/EJECT                                                                                  CER031
133430200528      *****************************************************************                       CER031
133440200528      *                                                               *                       CER031
133450200528      *  CEXNAR    - Extract Extended Credit Narrative                *                       CER031
133460200528      *                                                               *                       CER031
133470200528      *  Called By - SrOPNr                                           *                       CER031
133480200528      *                                                               *                       CER031
133490200528      *  Calls     - None                                             *                       CER031
133500200528      *                                                               *                       CER031
133510200528      *****************************************************************                       CER031
133520200528      *                                                                                       CER031
133530200528     C           CEXNAR    BEGSR                                                              CER031
133540200528      *                                                                                       CER031
133550200528      ** Set up subroutine stack name                                                         CER031
133560200528      *                                                                                       CER031
133570200528     C                     ADD  1         Q                                                   CER031
133580200528     C                     MOVEL'CEXNAR  '@STK,Q                                              CER031
133590200528      *                                                                                       CER031
133600200528      ** Retrieve subroutine specific data                                                    CER031
133610200528      *                                                                                       CER031
133620200528     C           1         OCUR ##SRDT                                                        CER031
133630200528     C                     MOVEL##SPAT    S#PATH                                              CER031
133640200528      *                                                                                       CER031
133650200528      ** Setup path                                                                           CER031
133660200528      *                                                                                       CER031
133670200528     C                     MOVEL'\CEXNAR' ##PNAM                                              CER031
133680200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
133690200528     C                     EXSR PSHGRS                                                        CER031
133700200528      *                                                                                       CER031
133710200528      ** Retrieve RDE info                                                                    CER031
133720200528      *                                                                                       CER031
133730200528     C                     MOVEL@STK,Q    ##GRPS                                              CER031
133740200528     C                     Z-ADD1         ##RDEN                                              CER031
133750200528     C                     EXSR SRRRDE                                                        CER031
133760200528      *                                                                                       CER031
133770200528      ** Format Narrative fields                                                              CER031
133780200528      *                                                                                       CER031
133790200528     C                     MOVE '*FORMAT' POPTN                                               CER031
133800200528      *                                                                                     BUG23445
133810200528      ** Format according to network Paper if Account is linked                             BUG23445
133820200528      *                                                                                     BUG23445
133830200528     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
133840200528     C           CGL013    IFEQ 'Y'                                                         BUG23445
133850200528     C                     MOVEL'PAPER'   KNWRK                                             BUG23445
133860200528     C                     MOVE PACCD     KACCDX                                            BUG23445
133870200528     C                     MOVE PACSQ     KACSQX                                            BUG23445
133880200528     C********** KACCT     CHAINGLNW94L1             95                           BUG23445 BUG23445A
133890200528     C           KACCT     CHAINGLNWACL1             95                                    BUG23445A
133900200528     C           *IN95     IFEQ *OFF                                                        BUG23445
133910200528     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
133920200528     C                     MOVELNANWRK    PNTWK                                            BUG23445A
133930200528     C                     ENDIF                                                            BUG23445
133940200528     C                     ENDIF                                                            BUG23445
133950200528      *                                                                                       CER031
133960200528      ** Call the MG001900 access object to format the extended                               CER031
133970200528      ** narratives                                                                           CER031
133980200528      *                                                                                       CER031
133990200528     C                     CALL 'MG001900'                                                    CER031
134000200528     C                     PARM           PRTCD2                                              CER031
134010200528     C                     PARM           POPTN                                               CER031
134020200528     C                     PARM           PNTWK                                               CER031
134030200528     C                     PARM           PMGTYP                                              CER031
134040200528     C                     PARM           PBRCA                                               CER031
134050200528     C                     PARM           PCUSNO                                              CER031
134060200528     C                     PARM           PCUCD                                               CER031
134070200528     C                     PARM           PACCD                                               CER031
134080200528     C                     PARM           PACSQ                                               CER031
134090200528     C                     PARM           PDCIN                                               CER031
134100200528     C                     PARM           PTRTP                                               CER031
134110200528     C                     PARM           PNARR1                                              CER031
134120200528     C                     PARM           PNARR2                                              CER031
134130200528     C                     PARM           PNARR3                                              CER031
134140200528     C                     PARM           PNARR4                                              CER031
134150200528     C                     PARM           PNARR5                                              CER031
134160200528     C                     PARM           PNARR6                                              CER031
134170200528     C**********           PARM           PRTF1                                      CER031 BUG23197
134180200528     C**********           PARM           PRTF2                                      CER031 BUG23197
134190200528     C**********           PARM           PRTF3                                      CER031 BUG23197
134200200528     C**********           PARM           PRTF4                                      CER031 BUG23197
134210200528     C**********           PARM           PRTF5                                      CER031 BUG23197
134220200528     C**********           PARM           PRTF6                                      CER031 BUG23197
134230200528     C**********           PARM           PRTF7                                      CER031 BUG23197
134240200528     C**********           PARM           PRTF8                                      CER031 BUG23197
134250200528     C**********           PARM           PRTF9                                      CER031 BUG23197
134260200528     C**********           PARM           PRTF10                                     CER031 BUG23197
134270200528     C**********           PARM           PRTF11                                     CER031 BUG23197
134280200528     C**********           PARM           PRTF12                                     CER031 BUG23197
134290200528     C**********           PARM           PRTF13                                     CER031 BUG23197
134300200528     C**********           PARM           PRTF14                                     CER031 BUG23197
134310200528     C**********           PARM           PRTF15                                     CER031 BUG23197
134320200528     C**********           PARM           PRTF16                                     CER031 BUG23197
134330200528     C**********           PARM           PRTF17                                     CER031 BUG23197
134340200528     C**********           PARM           PRTF18                                     CER031 BUG23197
134350200528     C**********           PARM           PRTF19                                     CER031 BUG23197
134360200528     C**********           PARM           PRTF20                                     CER031 BUG23197
134370200528     C                     PARM *BLANKS   PRTF1                                             BUG23197
134380200528     C                     PARM *BLANKS   PRTF2                                             BUG23197
134390200528     C                     PARM *BLANKS   PRTF3                                             BUG23197
134400200528     C                     PARM *BLANKS   PRTF4                                             BUG23197
134410200528     C                     PARM *BLANKS   PRTF5                                             BUG23197
134420200528     C                     PARM *BLANKS   PRTF6                                             BUG23197
134430200528     C                     PARM *BLANKS   PRTF7                                             BUG23197
134440200528     C                     PARM *BLANKS   PRTF8                                             BUG23197
134450200528     C                     PARM *BLANKS   PRTF9                                             BUG23197
134460200528     C                     PARM *BLANKS   PRTF10                                            BUG23197
134470200528     C                     PARM *BLANKS   PRTF11                                            BUG23197
134480200528     C                     PARM *BLANKS   PRTF12                                            BUG23197
134490200528     C                     PARM *BLANKS   PRTF13                                            BUG23197
134500200528     C                     PARM *BLANKS   PRTF14                                            BUG23197
134510200528     C                     PARM *BLANKS   PRTF15                                            BUG23197
134520200528     C                     PARM *BLANKS   PRTF16                                            BUG23197
134530200528     C                     PARM *BLANKS   PRTF17                                            BUG23197
134540200528     C                     PARM *BLANKS   PRTF18                                            BUG23197
134550200528     C                     PARM *BLANKS   PRTF19                                            BUG23197
134560200528     C                     PARM *BLANKS   PRTF20                                            BUG23197
134570200528     C                     PARM           IDX                                                 CER031
134580200528     C                     PARM           FLDNAM                                              CER031
134590200528     C                     PARM           MSGID                                               CER031
134600200528     C                     PARM           MSGDTA                                              CER031
134610200528     C                     PARM           WFLDNM                                              CER031
134620200528     C                     PARM           WMGID                                               CER031
134630200528     C                     PARM           WMGDTA                                              CER031
134640200528      *                                                                                       CER031
134650200528     C           PRTCD2    IFEQ *BLANKS                                                       CER031
134660200528     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
134670200528     C                     MOVELPRTF1     ##D,1                                               CER031
134680200528     C                     MOVELPRTF2     ##D,2                                               CER031
134690200528     C                     MOVELPRTF3     ##D,3                                               CER031
134700200528     C                     MOVELPRTF4     ##D,4                                               CER031
134710200528     C                     MOVELPRTF5     ##D,5                                               CER031
134720200528     C                     MOVELPRTF6     ##D,6                                               CER031
134730200528     C                     MOVELPRTF7     ##D,7                                               CER031
134740200528     C                     MOVELPRTF8     ##D,8                                               CER031
134750200528     C                     MOVELPRTF9     ##D,9                                               CER031
134760200528     C                     MOVELPRTF10    ##D,10                                              CER031
134770200528     C                     MOVELPRTF11    ##D,11                                              CER031
134780200528     C                     MOVELPRTF12    ##D,12                                              CER031
134790200528     C                     MOVELPRTF13    ##D,13                                              CER031
134800200528     C                     MOVELPRTF14    ##D,14                                              CER031
134810200528     C                     MOVELPRTF15    ##D,15                                              CER031
134820200528     C                     MOVELPRTF16    ##D,16                                              CER031
134830200528     C                     MOVELPRTF17    ##D,17                                              CER031
134840200528     C                     MOVELPRTF18    ##D,18                                              CER031
134850200528     C                     MOVELPRTF19    ##D,19                                              CER031
134860200528     C                     MOVELPRTF20    ##D,20                                              CER031
134870200528      *                                                                                       CER031
134880200528     C                     ELSE                                                               CER031
134890200528     C                     MOVE 'MG001900'W0FILE                                              CER031
134900200528     C                     MOVE PNARR1    W0KEY                                               CER031
134910200528     C                     MOVE 65        W0ERNB                                              CER031
134920200528     C                     MOVE 'MEM5003' W0MSGD                                              CER031
134930200528     C                     MOVE 'MIDAS'   W0MSGF                                              CER031
134940200528     C                     EXSR SRERR                                                         CER031
134950200528     C                     ENDIF                                                              CER031
134960200528      *                                                                                       CER031
134970200528      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CER031
134980200528      *                                                                                       CER031
134990200528     C                     EXSR SRADTA                                                        CER031
135000200528     C                     EXSR SRODTA                                                        CER031
135010200528     C           EXCRNR    TAG                                                                CER031
135020200528      *                                                                                       CER031
135030200528      ** Unwind subroutine stack name                                                         CER031
135040200528      *                                                                                       CER031
135050200528     C                     EXSR POPGRS                                                        CER031
135060200528     C                     MOVEA*BLANKS   @STK,Q                                              CER031
135070200528     C                     SUB  1         Q                                                   CER031
135080200528      *                                                                                       CER031
135090200528     C                     ENDSR                                                              CER031
135100200528     C/EJECT                                                                                  CFT134
135110200528      *****************************************************************                       CFT134
135120200528      *                                                               *                       CFT134
135130200528      *  SRGTIB - Get IBAN for Incoming and Outgoing Payments         *                       CFT134
135140200528      *                                                               *                       CFT134
135150200528      *  Called By: DRCR01, DRCR02 Subroutine                         *                       CFT134
135160200528      *             (If CFT004 and CFT134 are switched on)            *                       CFT134
135170200528      *                                                               *                       CFT134
135180200528      *  Calls: AOIBANR3                                              *                       CFT134
135190200528      *                                                               *                       CFT134
135200200528      *****************************************************************                       CFT134
135210200528      *                                                                                       CFT134
135220200528     C           SRGTIB    BEGSR                                                              CFT134
135230200528      *                                                                                       CFT134
135240200528      **  Set up subroutine stack name                                                        CFT134
135250200528     C                     ADD  1         Q                                                   CFT134
135260200528     C                     MOVEL'CFT134'  @STK,Q                                              CFT134
135270200528      *                                                                                       CFT134
135280200528      **  Retrieve subroutine specific data.                                                  CFT134
135290200528     C           1         OCUR ##SRDT                                                        CFT134
135300200528     C                     MOVEL##SPAT    S#PATH                                              CFT134
135310200528      *                                                                                       CFT134
135320200528      **  Set up Path.                                                                        CFT134
135330200528     C                     MOVEL'\CFT134' ##PNAM                                              CFT134
135340200528     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CFT134
135350200528      *                                                                                       CFT134
135360200528     C                     EXSR PSHGRS                                                        CFT134
135370200528      *                                                                                       CFT134
135380200528      **  Retrieve RDE information for RDEs in group set                                      CFT134
135390200528      *                                                                                       CFT134
135400200528     C                     MOVEL@STK,Q    ##GRPS                                              CFT134
135410200528     C                     Z-ADD1         ##RDEN                                              CFT134
135420200528     C                     EXSR SRRRDE                                                        CFT134
135430200528      *                                                                                       CFT134
135440200528     C                     MOVEL*BLANKS   KRACN                                               CFT134
135450200528     C                     MOVEL*BLANKS   KCNUM                                               CFT134
135460200528     C                     MOVEL*BLANKS   KCCY                                                CFT134
135470200528     C                     MOVEL*BLANKS   KACOD                                               CFT134
135480200528     C                     MOVEL*BLANKS   KACSQ                                               CFT134
135490200528     C                     MOVEL*BLANKS   KBRCA                                               CFT134
135500200528     C                     MOVEL'N'       FIBAN   1                                           CFT134
135510200528     C                     MOVEL*BLANKS   P1IBAN 47                                           CFT134
135520200528     C                     MOVEL*BLANKS   P@IBAN 34                                           CFT134
135530200528      *                                                                                       CFT134
135540200528      **  Get IBAN for Incoming Payments                                                      CFT134
135550200528      *                                                                                       CFT134
135560200528     C           ##FILE    IFEQ 'INPAY  '                                                     CFT134
135570200528      *                                                                                       CFT134
135580200528     C           ACBT      IFEQ 'R'                                                           CFT134
135590200528     C           ACBT      OREQ 'N'                                                           CFT134
135600200528     C           ACBT      OREQ 'P'                                                           CFT134
135610200528      *                                                                                       CFT134
135620200528     C           ACBT      IFEQ 'R'                                                           CFT134
135630200528     C                     MOVELACBK      KRACN                                               CFT134
135640200528     C                     ELSE                                                               CFT134
135650200528      *                                                                                       CFT134
135660200528     C           ACBT      IFEQ 'N'                                                           CFT134
135670200528     C                     MOVELACBK      @NONB   2                                           CFT134
135680200528     C                     CALL 'AONOSTR0'                                                    CFT134
135690200528     C                     PARM *BLANKS   @RTCD                                               CFT134
135700200528     C                     PARM '*KEY   ' @OPTN                                               CFT134
135710200528     C                     PARM           KCNUM                                               CFT134
135720200528     C                     PARM           PCCY                                                CFT134
135730200528     C                     PARM           KACOD                                               CFT134
135740200528     C                     PARM           KACSQ                                               CFT134
135750200528     C                     PARM           @NONB                                               CFT134
135760200528     C                     PARM           KBRCA                                               CFT134
135770200528     C                     PARM *BLANKS   @CSSN  10                                           CFT134
135780200528     C                     PARM *BLANKS   @PNOI   1                                           CFT134
135790200528     C           SDNOST    PARM *BLANKS   DSFDY                                               CFT134
135800200528      *                                                                                       CFT134
135810200528     C           @RTCD     IFEQ *BLANKS                                                       CFT134
135820200528     C                     MOVELA7CUST    KCNUM                                               CFT134
135830200528     C                     MOVELA7CYCD    KCCY                                                CFT134
135840200528     C                     MOVELA7ACCD    KACOD                                               CFT134
135850200528     C                     MOVELA7ACSN    KACSQ                                               CFT134
135860200528     C                     MOVELA7BRCD    KBRCA                                               CFT134
135870200528     C                     ENDIF                                                              CFT134
135880200528      *                                                                                       CFT134
135890200528     C                     ELSE                                                               CFT134
135900200528      *                                                                                       CFT134
135910200528     C           ACBT      IFEQ 'P'                                                           CFT134
135920200528     C                     MOVELACBK      WORC1                                               CFT134
135930200528     C                     MOVELPCCY      KCCY                                                CFT134
135940200528     C                     MOVELACBB      KBRCA                                               CFT134
135950200528     C                     ENDIF                                                              CFT134
135960200528      *                                                                                       CFT134
135970200528     C                     ENDIF                                                              CFT134
135980200528     C                     ENDIF                                                              CFT134
135990200528      *                                                                                       CFT134
136000200528     C                     EXSR GTIBAN                                                        CFT134
136010200528     C           FOIBAN    IFNE *BLANKS                                                       CFT134
136020200528     C                     MOVELFOIBAN    P1IBAN                                              CFT134
136030200528     C                     MOVEL'Y'       FIBAN                                               CFT134
136040200528     C                     ENDIF                                                              CFT134
136050200528      *                                                                                       CFT134
136060200528     C                     ELSE                                                               CFT134
136070200528     C           BNCT      IFEQ 'R'                                                           CFT134
136080200528     C           BNCT      OREQ 'P'                                                           CFT134
136090200528     C           BNCT      OREQ 'I'                                                           CFT134
136100200528      *                                                                                       CFT134
136110200528     C           BNCT      IFEQ 'I'                                                           CFT134
136120200528     C           34        SUBSTBNC1:2    PIBAN                                               CFT134
136130200528      *                                                                                       CFT134
136140200528     C                     CALL 'AOIBANR3'                                                    CFT134
136150200528     C                     PARM           WRTCD                                               CFT134
136160200528     C                     PARM           PIBAN  47                                           CFT134
136170200528     C                     PARM           POWITH 47                                           CFT134
136180200528     C                     PARM           PONOBL 34                                           CFT134
136190200528      *                                                                                       CFT134
136200200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
136210200528     C                     MOVELPOWITH    FOIBAN                                              CFT134
136220200528     C                     ENDIF                                                              CFT134
136230200528      *                                                                                       CFT134
136240200528     C                     ELSE                                                               CFT134
136250200528      *                                                                                       CFT134
136260200528     C           BNCT      IFEQ 'P'                                                           CFT134
136270200528     C                     MOVELBNC1      WORC1                                               CFT134
136280200528     C                     MOVELPCCY      KCCY                                                CFT134
136290200528     C                     EXSR GTIBAN                                                        CFT134
136300200528     C                     ELSE                                                               CFT134
136310200528      *                                                                                       CFT134
136320200528     C           BNCT      IFEQ 'R'                                                           CFT134
136330200528     C                     MOVELBNC1      KRACN                                               CFT134
136340200528     C                     EXSR GTIBAN                                                        CFT134
136350200528     C                     ENDIF                                                              CFT134
136360200528      *                                                                                       CFT134
136370200528     C                     ENDIF                                                              CFT134
136380200528     C                     ENDIF                                                              CFT134
136390200528      *                                                                                       CFT134
136400200528     C           FOIBAN    IFNE *BLANKS                                                       CFT134
136410200528     C                     MOVELFOIBAN    P1IBAN                                              CFT134
136420200528     C                     MOVEL'Y'       FIBAN                                               CFT134
136430200528     C                     ENDIF                                                              CFT134
136440200528      *                                                                                       CFT134
136450200528     C                     END                                                                CFT134
136460200528     C                     END                                                                CFT134
136470200528      *                                                                                       CFT134
136480200528      ** At this point, P1IBAN could contain an IBAN or not.  If                              CFT134
136490200528      ** not an IBAN, if Beneficiary is an address, it can contain                            CFT134
136500200528      ** the IBAN.                                                                            CFT134
136510200528      *                                                                                       CFT134
136520200528     C           CFT014    IFEQ 'Y'                                                           CFT134
136530200528     C           FIBAN     ANDEQ'N'                        NO IBAN RETRIEVED                  CFT134
136540200528      *                                                                                       CFT134
136550200528     C           BNCT      IFEQ 'A'                                                           CFT134
136560200528     C           1         SUBSTBNC1:1    BCSL    1                                           CFT134
136570200528      *                                                                                       CFT134
136580200528     C           BCSL      IFEQ '/'                                                           CFT134
136590200528     C           34        SUBSTBNC1:2    PIBAN                                               CFT134
136600200528     C                     ELSE                                                               CFT134
136610200528     C                     MOVELBNC1      PIBAN                                               CFT134
136620200528     C                     ENDIF                                                              CFT134
136630200528      *                                                                                       CFT134
136640200528     C                     CALL 'AOIBANR3'                                                    CFT134
136650200528     C                     PARM           WRTCD                                               CFT134
136660200528     C                     PARM           PIBAN                                               CFT134
136670200528     C                     PARM           POWITH                                              CFT134
136680200528     C           P@IBAN    PARM           PONOBL                                              CFT134
136690200528      *                                                                                       CFT134
136700200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
136710200528      *                                                                                       CFT134
136720200528     C                     MOVELWRTCD     @RTCD                                               CFT134
136730200528     C                     MOVELP@IBAN    WIBAN                                               CFT134
136740200528     C                     EXSR SRIBAN                                                        CFT134
136750200528      *                                                                                       CFT134
136760200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
136770200528     C                     MOVELPOWITH    P1IBAN                                              CFT134
136780200528     C                     MOVEL'Y'       FIBAN                                               CFT134
136790200528     C                     ENDIF                                                              CFT134
136800200528     C                     ENDIF                                                              CFT134
136810200528     C                     ENDIF                                                              CFT134
136820200528     C                     ENDIF                                                              CFT134
136830200528      *                                                                                       CFT134
136840200528     C                     ENDIF                                                              CFT134
136850200528      *                                                                                       CFT134
136860200528      **  Get IBAN for Outgoing Payments                                                      CFT134
136870200528      *                                                                                       CFT134
136880200528     C           ##FILE    IFEQ 'OTPAY  '                                                     CFT134
136890200528      *                                                                                       CFT134
136900200528     C           ORBT      IFEQ 'R'                                                           CFT134
136910200528     C           ORBT      OREQ 'N'                                                           CFT134
136920200528     C           ORBT      OREQ 'P'                                                           CFT134
136930200528      *                                                                                       CFT134
136940200528     C           ORBT      IFEQ 'R'                                                           CFT134
136950200528     C                     MOVELORBK      KRACN                                               CFT134
136960200528     C                     ELSE                                                               CFT134
136970200528      *                                                                                       CFT134
136980200528     C           ORBT      IFEQ 'N'                                                           CFT134
136990200528     C                     MOVELORBK      @NONB                                               CFT134
137000200528     C                     CALL 'AONOSTR0'                                                    CFT134
137010200528     C                     PARM *BLANKS   @RTCD                                               CFT134
137020200528     C                     PARM '*KEY   ' @OPTN                                               CFT134
137030200528     C                     PARM           KCNUM                                               CFT134
137040200528     C                     PARM           SMCY                                                CFT134
137050200528     C                     PARM           KACOD                                               CFT134
137060200528     C                     PARM           KACSQ                                               CFT134
137070200528     C                     PARM           @NONB                                               CFT134
137080200528     C                     PARM           KBRCA                                               CFT134
137090200528     C                     PARM *BLANKS   @CSSN                                               CFT134
137100200528     C                     PARM *BLANKS   @PNOI                                               CFT134
137110200528     C           SDNOST    PARM *BLANKS   DSFDY                                               CFT134
137120200528      *                                                                                       CFT134
137130200528     C           @RTCD     IFEQ *BLANKS                                                       CFT134
137140200528     C                     MOVELA7CUST    KCNUM                                               CFT134
137150200528     C                     MOVELA7CYCD    KCCY                                                CFT134
137160200528     C                     MOVELA7ACCD    KACOD                                               CFT134
137170200528     C                     MOVELA7ACSN    KACSQ                                               CFT134
137180200528     C                     MOVELA7BRCD    KBRCA                                               CFT134
137190200528     C                     ENDIF                                                              CFT134
137200200528      *                                                                                       CFT134
137210200528     C                     ELSE                                                               CFT134
137220200528      *                                                                                       CFT134
137230200528     C           ORBT      IFEQ 'P'                                                           CFT134
137240200528     C                     MOVELORBK      WORC1                                               CFT134
137250200528     C                     MOVELSMCY      KCCY                                                CFT134
137260200528     C                     MOVELORBB      KBRCA                                               CFT134
137270200528     C                     ENDIF                                                              CFT134
137280200528      *                                                                                       CFT134
137290200528     C                     ENDIF                                                              CFT134
137300200528     C                     ENDIF                                                              CFT134
137310200528      *                                                                                       CFT134
137320200528     C                     EXSR GTIBAN                                                        CFT134
137330200528     C           FOIBAN    IFNE *BLANKS                                                       CFT134
137340200528     C                     MOVELFOIBAN    P1IBAN                                              CFT134
137350200528     C                     MOVEL'Y'       FIBAN                                               CFT134
137360200528     C                     ENDIF                                                              CFT134
137370200528      *                                                                                       CFT134
137380200528     C                     ELSE                                                               CFT134
137390200528     C           ORCT      IFEQ 'R'                                                           CFT134
137400200528     C           ORCT      OREQ 'P'                                                           CFT134
137410200528      *                                                                                       CFT134
137420200528     C           ORCT      IFEQ 'P'                                                           CFT134
137430200528     C                     MOVELORC1      WORC1                                               CFT134
137440200528     C                     MOVELSMCY      KCCY                                                CFT134
137450200528     C                     ELSE                                                               CFT134
137460200528      *                                                                                       CFT134
137470200528     C           ORCT      IFEQ 'R'                                                           CFT134
137480200528     C           1         SUBSTORC1:1    WSLSH                                               CFT134
137490200528     C           WSLSH     IFEQ '/'                                                           CFT134
137500200528     C           10        SUBSTORC1:2    KRACN                                               CFT134
137510200528     C                     ELSE                                                               CFT134
137520200528     C                     MOVELORC1      KRACN                                               CFT134
137530200528     C                     ENDIF                                                              CFT134
137540200528     C                     ENDIF                                                              CFT134
137550200528     C                     ENDIF                                                              CFT134
137560200528      *                                                                                       CFT134
137570200528     C                     EXSR GTIBAN                                                        CFT134
137580200528     C           FOIBAN    IFNE *BLANKS                                                       CFT134
137590200528     C                     MOVELFOIBAN    P1IBAN                                              CFT134
137600200528     C                     MOVEL'Y'       FIBAN                                               CFT134
137610200528     C                     ENDIF                                                              CFT134
137620200528     C*                                                                                       CFT134
137630200528     C                     END                                                                CFT134
137640200528     C                     END                                                                CFT134
137650200528      *                                                                                       CFT134
137660200528      ** At this point, P1IBAN could contain an IBAN or not.  If                              CFT134
137670200528      ** not an IBAN, if ord customer is an address, it may contain                           CFT134
137680200528      ** the IBAN.                                                                            CFT134
137690200528      *                                                                                       CFT134
137700200528     C           CFT014    IFEQ 'Y'                                                           CFT134
137710200528     C           FIBAN     ANDEQ'N'                                                           CFT134
137720200528      *                                                                                       CFT134
137730200528     C           ORCT      IFEQ 'A'                                                           CFT134
137740200528     C           1         SUBSTORC1:1    BCSL    1                                           CFT134
137750200528      *                                                                                       CFT134
137760200528     C           BCSL      IFEQ '/'                                                           CFT134
137770200528     C           34        SUBSTORC1:2    PIBAN                                               CFT134
137780200528     C                     ELSE                                                               CFT134
137790200528     C                     MOVELORC1      PIBAN                                               CFT134
137800200528     C                     ENDIF                                                              CFT134
137810200528      *                                                                                       CFT134
137820200528     C                     CALL 'AOIBANR3'                                                    CFT134
137830200528     C                     PARM           WRTCD                                               CFT134
137840200528     C                     PARM           PIBAN                                               CFT134
137850200528     C                     PARM           POWITH                                              CFT134
137860200528     C           P@IBAN    PARM           PONOBL                                              CFT134
137870200528      *                                                                                       CFT134
137880200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
137890200528      *                                                                                       CFT134
137900200528     C                     MOVELWRTCD     @RTCD                                               CFT134
137910200528     C                     MOVELP@IBAN    WIBAN                                               CFT134
137920200528     C                     EXSR SRIBAN                                                        CFT134
137930200528      *                                                                                       CFT134
137940200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
137950200528     C                     MOVELPOWITH    P1IBAN                                              CFT134
137960200528     C                     MOVEL'Y'       FIBAN                                               CFT134
137970200528     C                     ENDIF                                                              CFT134
137980200528     C                     ENDIF                                                              CFT134
137990200528     C                     ENDIF                                                              CFT134
138000200528     C                     ENDIF                                                              CFT134
138010200528      *                                                                                       CFT134
138020200528     C                     ENDIF                                                              CFT134
138030200528      *                                                                                       CFT134
138040200528     C           FIBAN     IFEQ 'Y'                                                           CFT134
138050200528     C                     MOVELP1IBAN    ##D,1                                               CFT134
138060200528     C                     ENDIF                                                              CFT134
138070200528      *                                                                                       CFT134
138080200528      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CFT134
138090200528      *                                                                                       CFT134
138100200528     C                     EXSR SRADTA                                                        CFT134
138110200528     C                     EXSR SRODTA                                                        CFT134
138120200528      *                                                                                       CFT134
138130200528     C           EXGTIB    TAG                                                                CFT134
138140200528      *                                                                                       CFT134
138150200528     C                     EXSR POPGRS                                                        CFT134
138160200528      *                                                                                       CFT134
138170200528      **  Unwind subroutine stack name                                                        CFT134
138180200528      *                                                                                       CFT134
138190200528     C                     MOVEA*BLANKS   @STK,Q                                              CFT134
138200200528     C                     SUB  1         Q                                                   CFT134
138210200528      *                                                                                       CFT134
138220200528     C                     ENDSR                                                              CFT134
138230200528      *****************************************************************                       CFT134
138240200528     C/EJECT                                                                                  CFT134
138250200528      *****************************************************************                       CFT134
138260200528      *                                                               *                       CFT134
138270200528      *  GTIBAN - Get IBAN of retail account                          *                       CFT134
138280200528      *                                                               *                       CFT134
138290200528      *  Called By: SRGTIB                                            *                       CFT134
138300200528      *                                                               *                       CFT134
138310200528      *  Calls: AOACCTR0, AOIBANR3                                    *                       CFT134
138320200528      *                                                               *                       CFT134
138330200528      *****************************************************************                       CFT134
138340200528      *                                                                                       CFT134
138350200528     C           GTIBAN    BEGSR                                                              CFT134
138360200528      *                                                                                       CFT134
138370200528     C                     MOVEL*BLANKS   FOIBAN 47                                           CFT134
138380200528      *                                                                                       CFT134
138390200528     C                     CALL 'AOACCTR0'                                                    CFT134
138400200528     C                     PARM *BLANKS   WRTCD   7                                           CFT134
138410200528     C                     PARM '*KEY    'WOPTN   7                                           CFT134
138420200528     C                     PARM           KRACN                                               CFT134
138430200528     C                     PARM           KCNUM                                               CFT134
138440200528     C                     PARM           KCCY                                                CFT134
138450200528     C                     PARM           KACOD                                               CFT134
138460200528     C                     PARM           KACSQ                                               CFT134
138470200528     C                     PARM           KBRCA                                               CFT134
138480200528     C           SDACCT    PARM SDACCT    DSSDY                                               CFT134
138490200528      *                                                                                       CFT134
138500200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
138510200528     C           IBAN      IFNE *BLANKS                                                       CFT134
138520200528     C                     MOVELIBAN      PIBAN                                               CFT134
138530200528     C                     CALL 'AOIBANR3'                                                    CFT134
138540200528     C                     PARM           WRTCD                                               CFT134
138550200528     C                     PARM           PIBAN                                               CFT134
138560200528     C                     PARM           POWITH                                              CFT134
138570200528     C                     PARM           PONOBL                                              CFT134
138580200528      *                                                                                       CFT134
138590200528     C           WRTCD     IFEQ *BLANKS                                                       CFT134
138600200528     C                     MOVELPOWITH    FOIBAN                                              CFT134
138610200528     C                     ENDIF                                                              CFT134
138620200528     C                     ENDIF                                                              CFT134
138630200528      *                                                                                       CFT134
138640200528     C                     ENDIF                                                              CFT134
138650200528      *                                                                                       CFT134
138660200528     C                     ENDSR                                                              CFT134
138670200528      *                                                                                       CFT134
138680200528     C/EJECT                                                                               AR1082119
138690200528      *****************************************************************                    AR1082119
138700200528      *                                                               *                    AR1082119
138710200528      *  SR#CCY    - Get the Charge Currency                          *                    AR1082119
138720200528      *                                                               *                    AR1082119
138730200528      *  Called By - INENTC, OTENTC                                   *                    AR1082119
138740200528      *                                                               *                    AR1082119
138750200528      *  Calls     - None                                             *                    AR1082119
138760200528      *                                                               *                    AR1082119
138770200528      *****************************************************************                    AR1082119
138780200528      *                                                                                    AR1082119
138790200528     C           SR#CCY    BEGSR                                                           AR1082119
138800200528      *                                                                                    AR1082119
138810200528     C                     SELEC                                                           AR1082119
138820200528     C           CDRO      WHNE *BLANKS                                                    AR1082119
138830200528     C           CFT120    ANDEQ'Y'                                                        AR1082119
138840200528      *                                                                                    AR1082119
138850200528      ** Incoming Payment                                                                  AR1082119
138860200528      *                                                                                    AR1082119
138870200528     C           ##FILE    IFEQ 'INPAY  '                                                  AR1082119
138880200528     C           INCDRC    IFEQ *BLANKS                                                    AR1082119
138890200528     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
138900200528     C                     ELSE                                                            AR1082119
138910200528     C                     MOVELINCDRC    ##WCCY                                           AR1082119
138920200528     C                     ENDIF                                                           AR1082119
138930200528     C                     ENDIF                                                           AR1082119
138940200528      *                                                                                    AR1082119
138950200528      ** Outgoing Payment                                                                  AR1082119
138960200528      *                                                                                    AR1082119
138970200528     C           ##FILE    IFEQ 'OTPAY  '                                                  AR1082119
138980200528     C           OPCDRC    IFEQ *BLANKS                                                    AR1082119
138990200528     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
139000200528     C                     ELSE                                                            AR1082119
139010200528     C                     MOVELOPCDRC    ##WCCY                                           AR1082119
139020200528     C                     ENDIF                                                           AR1082119
139030200528     C                     ENDIF                                                           AR1082119
139040200528      *                                                                                    AR1082119
139050200528     C           CDRO      WHNE *BLANKS                                                    AR1082119
139060200528     C           CFT120    ANDEQ'N'                                                        AR1082119
139070200528      *                                                                                    AR1082119
139080200528     C**********           SELEC                                                AR1082119 AR1082119A
139090200528     C********** BTCHCY    WHEQ 'B'                                             AR1082119 AR1082119A
139100200528     C********** BTCHCY    OREQ 'B'                                             AR1082119A AR1097394
139110200528     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
139120200528     C********** BTCHCY    WHEQ 'L'                                              AR1082119 AR1097394
139130200528     C**********           MOVELBJLCCY    ##WCCY                                 AR1082119 AR1097394
139140200528     C********** BTCHCY    WHEQ 'C'                                              AR1082119 AR1097394
139150200528     C           CDRO      WHEQ *BLANKS                                                    AR1097394
139160200528     C           ADDC      ANDEQ'A'                                                        AR1082119
139170200528     C                     MOVELSMCY      ##WCCY                                           AR1082119
139180200528     C********** BTCHCY    WHEQ 'C'                                              AR1082119 AR1097394
139190200528     C           CDRO      WHEQ *BLANKS                                                    AR1097394
139200200528     C           ADDC      ANDEQ'D'                                                        AR1082119
139210200528     C                     MOVELPCCY      ##WCCY                                           AR1082119
139220200528     C********** BTCHCY    WHEQ 'F'                                              AR1082119 AR1097394
139230200528     C**********           MOVELFCHCCY    ##WCCY                                 AR1082119 AR1097394
139240200528     C**********           ENDSL                                                AR1082119 AR1082119A
139250200528     C                     ENDSL                                                           AR1082119
139260200528     C                     ENDSR                                                           AR1082119
139270200528      *****************************************************************                       CER031
139280200528     C/EJECT                                                                                  CER031
139290200528      *****************************************************************                       CER031
139300200528      *                                                                   CFT009
139310200528     C/COPY CGCPYSRC,SRERRPSSR
139320200528     C/SPACE 5
139330200528     C/COPY CGCPYSRC,SRERRC
139340200528      /EJECT                                                                                  CCG015
139350200528     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
139360200528** ##GRP/##RDE
139370200528BRANCH0001 BRANCH
139380200528BRANCH0002 BRANCH NAM
139390200528BOOK  0001 BOOK_CODE
139400200528BOOK  0002 BOOK_DESC
139410200528PROF_C0001 PROF_CENT
139420200528PROF_C0002 PROF_C_DSC
139430200528FT_USR0001 USR_INP_1
139440200528FT_USR0002 USR_INP_2
139450200528FT_USR0003 USR_AUT_1
139460200528FT_USR0004 USR_AUT_2
139470200528FT_USR0005 UINP1_DESC
139480200528FT_USR0006 UINP2_DESC
139490200528FT_USR0007 UAUT1_DESC
139500200528FT_USR0008 UAUT2_DESC
139510200528PAYMNT0001 PAY_REF
139520200528PAYMNT0002 VALUE DATE Date
139530200528PAYMNT0003 PRINT_DATE Date
139540200528PAYMNT0004 PAY_TYPE
139550200528PAYMNT0005 PAY_S_TYPE
139560200528PAYMNT0006 PAY_ST_DSC
139570200528PAYMNT0007 SETTLEMOD                                                      095577
139580200528PAY_II0001 PAY_RATE   Xrate L8
139590200528PAY_II0002 CHG_CCY
139600200528PAY_II0003 ADD/DEDUCT
139610200528PAY_II0004 TFR_COMM   AmountL
139620200528PAY_II0005 FX/CHG_COM AmountL
139630200528PAY_II0006 TELEX_CHG  AmountL
139640200528PAY_II0007 CHEQUE_CHG AmountL
139650200528PAY_II0008 COST_ABRD  AmountL
139660200528PAY_II0009 SWIFT_CHG  AmountL
139670200528PAY_II0010 MISC_CHG   AmountL
139680200528PAY_II0011 VAT_AMOUNT AmountL
139690200528PAY_II0012 TOT_CHG    AmountL
139700200528PAY_II0013 NET_AMOUNT AmountL
139710200528PAY_II0014 CHG_DETL
139720200528PAY_II0015 REL_REF
139730200528PAY_II0016 COLL_CHG   AmountL
139740200528PAY_II0017 TELEPH_CHG AmountL
139750200528PAY_II0018 ADVICE_CHG AmountL
139760200528PAY_II0019 DEDUCTIONS AmountL
139770200528FTSTAX0001 ZSTAXFLG                                                                           CER049
139780200528FTSTAX0002 Z_TAX_AMT  AmountL                                                                 CER049
139790200528CR_CCY0001 CR_CCY
139800200528CR_CCY0002 CR_CCY_NAM
139810200528CR_CCY0003 CR_AMOUNT  AmountL
139820200528CR_CCY0004 CHQ_NUMBER
139830200528CR_CCY0005 CHQ_SEQ_NO
139840200528CR_CCY0006 CR DATE    Date                                                095577
139850200528DR_CCY0001 DR_CCY
139860200528DR_CCY0002 DR_CCY_NAM
139870200528DR_CCY0003 DR_AMOUNT  AmountL
139880200528DR_CCY0004 DR DATE    Date                                                095577
139890200528PAYDET0001 PAY_DETL_1
139900200528PAYDET0002 PAY_DETL_2
139910200528PAYDET0003 PAY_DETL_3
139920200528PAYDET0004 PAY_DETL_4
139930200528NARR  0001 NARRAT_1
139940200528NARR  0002 NARRAT_2
139950200528NARR  0003 NARRAT_3
139960200528NARR  0004 NARRAT_4
139970200528NARR  0005 NARRAT_5
139980200528NARR  0006 NARRAT_6
139990200528CORDTA0001 COR_TYPE                      Information Type
140000200528CORDTA0002 COR_CUST                      Customer
140010200528CORDTA0003 COR_CUSNAM                    Customer Name
140020200528CORDTA0004 COR_CUSTWN                    Customer Town
140030200528CORDTA0005 COR_AC_LIN                    Account line
140040200528CORDTA0006 COR_RET_NO                    Retail AC No.
140050200528CORDTA0007 COR_ACCT                      Midas Account Identifier
140060200528CORDTA0008 COR_AC_NAM                    Account name
140070200528CORDTA0009 COR_SWIFT                     SWIFT ID
140080200528CORDTA0010 COR_ADDR_1                    Address line 1
140090200528CORDTA0011 COR_ADDR_2                    Address line 2
140100200528CORDTA0012 COR_ADDR_3                    Address line 3
140110200528CORDTA0013 COR_ADDR_4                    Address line 4
140120200528CORDTA0014 COR_ADDR_5                    Address line 5
140130200528CORDTA0015 COR_PTFR                      Portfolio Reference              CPB001
140140200528CORDTA0016 CFT121F                       CFT121 Switchable Feature Flag                       CFT121
140150200528CORDTA0017 CFT120F                       CFT120 Switchable Feature Flag                       CFT120
140160200528CORDTA0018 COR_CCY                       Charge to the Debit A/c ccy                          CFT120
140170200528FT_DLV0001 NTF_DLVCCY                                                     CEU006
140180200528FT_DLV0002 NTF_DLVAMT AmountL                                             CEU006
140190200528FT_DLV0003 PAY_DLVCCY                                                     CEU006
140200200528FT_DLV0004 PAY_DLVAMT AmountL                                             CEU006
140210200528CHGENT0001 ENT_CURRCY                                                     CEU006
140220200528CHGENT0002 ENT_TFRCOM AmountL                                             CEU006
140230200528CHGENT0003 ENT_FX/CHG AmountL                                             CEU006
140240200528CHGENT0004 ENT_TELEX  AmountL                                             CEU006
140250200528CHGENT0005 ENT_CHEQUE AmountL                                             CEU006
140260200528CHGENT0006 ENT_COSTAB AmountL                                             CEU006
140270200528CHGENT0007 ENT_SWIFT  AmountL                                             CEU006
140280200528CHGENT0008 ENT_COLLEC AmountL                                             CEU006
140290200528CHGENT0009 ENT_TELEPH AmountL                                             CEU006
140300200528CHGENT0010 ENT_ADVICE AmountL                                             CEU006
140310200528CHGENT0011 ENT_MISC   AmountL                                             CEU006
140320200528CHGENT0012 ENT_VATAMT AmountL                                             CEU006
140330200528CHGENT0013 ENT_TOTCHG AmountL                                             CEU006
140340200528CHGENT0014 ENT_DEDUCT AmountL                                             CEU006
140350200528CHGENT0015 ENT_NETAMT AmountL                                             CEU006
140360200528CHGENT0016 ENT_SWFTP  AmountL                                             CFT009
140370200528CHGENT0017 ENT_MISC1  AmountL                                             CFT009
140380200528CHGENT0018 ENT_MISC2  AmountL                                             CFT009
140390200528CHGENT0019 ENT_MISC3  AmountL                                             CFT009
140400200528CHGENT0020 ENT_MISC4  AmountL                                             CFT009
140410200528CHGENT0021 ENT_MISC5  AmountL                                             CFT009
140420200528CHGEUR0001 EUR_CURRCY                                                     CEU006
140430200528CHGEUR0002 EUR_TFRCOM AmountL                                             CEU006
140440200528CHGEUR0003 EUR_FX/CHG AmountL                                             CEU006
140450200528CHGEUR0004 EUR_TELEX  AmountL                                             CEU006
140460200528CHGEUR0005 EUR_CHEQUE AmountL                                             CEU006
140470200528CHGEUR0006 EUR_COSTAB AmountL                                             CEU006
140480200528CHGEUR0007 EUR_SWIFT  AmountL                                             CEU006
140490200528CHGEUR0008 EUR_COLLEC AmountL                                             CEU006
140500200528CHGEUR0009 EUR_TELEPH AmountL                                             CEU006
140510200528CHGEUR0010 EUR_ADVICE AmountL                                             CEU006
140520200528CHGEUR0011 EUR_MISC   AmountL                                             CEU006
140530200528CHGEUR0012 EUR_VATAMT AmountL                                             CEU006
140540200528CHGEUR0013 EUR_TOTCHG AmountL                                             CEU006
140550200528CHGEUR0014 EUR_DEDUCT AmountL                                             CEU006
140560200528CHGEUR0015 EUR_NETAMT AmountL                                             CEU006
140570200528CHGEUR0016 EUR_SWFTP  AmountL                                             CFT009
140580200528CHGEUR0017 EUR_MISC1  AmountL                                             CFT009
140590200528CHGEUR0018 EUR_MISC2  AmountL                                             CFT009
140600200528CHGEUR0019 EUR_MISC3  AmountL                                             CFT009
140610200528CHGEUR0020 EUR_MISC4  AmountL                                             CFT009
140620200528CHGEUR0021 EUR_MISC5  AmountL                                             CFT009
140630200528FT_RFT0001 RFTID                                                          CFT006
140640200528FT_RFT0002 SNDR_ID                                                        CFT006
140650200528FT_RFT0003 SNDR_REF                                                       CFT006
140660200528FT_RFT0004 TRN_DTL_RF                                                     CFT006
140670200528FT_RFT0005 FX_DL_REF                                                      CFT006
140680200528FT_RFT0006 INST_PARTY                                                     CFT006
140690200528FT_RFT0007 RQST_EXDAT Date                                                CFT006
140700200528FT_RFT0008 HAND_CCY                                                       CFT006
140710200528FT_RFT0009 HAND_CHRG  AmountL                                             CFT006
140720200528FT_RFT0010 CHRG_DR                                                        CFT006
140730200528FT_RFT0011 AUTH                                                           CFT006
140740200528FT_RFT0012 ORG_CCY                                                        CFT006
140750200528FT_RFT0013 ORG_AMT    AmountL                                             CFT006
140760200528FT_RFT0014 INST_CODE1                                                     CFT006
140770200528FT_RFT0015 INST_CODE2                                                     CFT006
140780200528FT_RFT0016 INST_CODE3                                                     CFT006
140790200528FT_RFT0017 INST_CODE4                                                     CFT006
140800200528FT_RFT0018 INST_CODE5                                                     CFT006
140810200528FT_RFT0019 INST_CODE6                                                     CFT006
140820200528FT_RFT0020 INST_CODE7                                                     CFT006
140830200528FT_RFI0001 INTERMED1                                                      CFT006
140840200528FT_RFI0002 INTERMED2                                                      CFT006
140850200528FT_RFI0003 INTERMED3                                                      CFT006
140860200528FT_RFI0004 INTERMED4                                                      CFT006
140870200528FT_RFI0005 INTERMED5                                                      CFT006
140880200528FT_RFI0006 INTERMED6                                                      CFT006
140890200528FT_RFI0007 INTER_TYPE                                                     CFT006
140900200528FT_RFI0008 ACNTINST1                                                      CFT006
140910200528FT_RFI0009 ACNTINST2                                                      CFT006
140920200528FT_RFI0010 ACNTINST3                                                      CFT006
140930200528FT_RFI0011 ACNTINST4                                                      CFT006
140940200528FT_RFI0012 ACNTINST5                                                      CFT006
140950200528FT_RFI0013 ACNTINST6                                                      CFT006
140960200528FT_RFI0014 ACNT_TYPE                                                      CFT006
140970200528FT_RFI0015 ACNTSRVIN1                                                     CFT006
140980200528FT_RFI0016 ACNTSRVIN2                                                     CFT006
140990200528FT_CCT0001 CCTID                                                          CFT008
141000200528FT_CCT0002 FILE_REF                                                       CFT008
141010200528FT_CCT0003 TRAN_REF                                                       CFT008
141020200528FT_CCT0004 BANK_OPCDE                                                     CFT008
141030200528FT_CCT0005 DESTIN                                                         CFT008
141040200528FT_CCT0006 TOT_VALDAT Date                                                CFT008
141050200528FT_CCT0007 CHARGE                                                         CFT008
141060200528FT_CCT0008 TRAN_TYPCD                                                     CFT008
141070200528FT_CCI0001 SCHG_CCY                                                       CFT008
141080200528FT_CCI0002 SCHG       AmountL                                             CFT008
141090200528FT_CCI0003 SCHG_PCCY  AmountL                                             CFT008
141100200528FT_CCI0004 SCHG_TCCY  AmountL                                             CFT008
141110200528FT_CCI0005 SUM_AMTS   AmountL                                             CFT008
141120200528FT_CCI0006 SUM_RCHG   AmountL8                                            CFT008
141130200528FT_CCI0007 SDR_CORR                                                       CFT008
141140200528FT_CCI0008 RCV_CORR                                                       CFT008
141150200528FT_CCI0009 ADD_INFO1                                                      CFT008
141160200528FT_CCI0010 ADD_INFO2                                                      CFT008
141170200528FT_CCI0011 ADD_INFO3                                                      CFT008
141180200528FT_CCI0012 ADD_INFO4                                                      CFT008
141190200528FT_CCI0013 ADD_INFO5                                                      CFT008
141200200528FT_CCI0014 ADD_INFO6                                                      CFT008
141210200528FT_CCI0015 DR_INPAKY                                                      CFT008
141220200528FT_CCI0016 DR_DRAKY                                                       CFT008
141230200528FT_SCH0001 SCHG_CCY2                                                                          CSW201
141240200528FT_SCH0002 SCHG2      AmountL                                                                 CSW201
141250200528FT_SCH0003 SCHG_PCCY2 AmountL                                                                 CSW201
141260200528FT_SCH0004 SCHG_TCCY2 AmountL                                                                 CSW201
141270200528FT_SCH0005 SCHG_CCY3                                                                          CSW201
141280200528FT_SCH0006 SCHG3      AmountL                                                                 CSW201
141290200528FT_SCH0007 SCHG_PCCY3 AmountL                                                                 CSW201
141300200528FT_SCH0008 SCHG_TCCY3 AmountL                                                                 CSW201
141310200528FT_SCH0009 SCHG_CCY4                                                                          CSW201
141320200528FT_SCH0010 SCHG4      AmountL                                                                 CSW201
141330200528FT_SCH0011 SCHG_PCCY4 AmountL                                                                 CSW201
141340200528FT_SCH0012 SCHG_TCCY4 AmountL                                                                 CSW201
141350200528FT_SCH0013 SCHG_CCY5                                                                          CSW201
141360200528FT_SCH0014 SCHG5      AmountL                                                                 CSW201
141370200528FT_SCH0015 SCHG_PCCY5 AmountL                                                                 CSW201
141380200528FT_SCH0016 SCHG_TCCY5 AmountL                                                                 CSW201
141390200528FT_MT00001 TRAN_TYPE                                                      CFT006
141400200528FT_MT00002 TRAN_STYPE                                                     CFT006
141410200528FT_MT00003 BOOK_BRCH                                                      CFT006
141420200528FT_MT00004 ORIG_BRCH                                                      CFT006
141430200528FT_MT00005 SND_INST                                                       CFT006
141440200528FT_MT00006 EXRATE     Xrate L8                                            CFT006
141450200528FT_MT00007 EXRATE_IND                                                     CFT006
141460200528FT_MT00008 OUT_PAYFL                                                      CFT006
141470200528FT_MT00009 DTL_CHRG                                                       CFT006
141480200528FT_MT00010 RCHG_CCY                                                       CFT006
141490200528FT_MT00011 RCHG       AmountL                                             CFT006
141500200528FT_MT00012 RCHG_PCCY                                                      CFT006
141510200528FT_MT00013 RCHG_PCHG  AmountL                                             CFT006
141520200528FT_MT00014 RCHG_TCCY                                                      CFT006
141530200528FT_MT00015 RCHG_TCHG  AmountL                                             CFT006
141540200528FT_MT10001 ORD_CUST1                                                      CFT006
141550200528FT_MT10002 ORD_CUST2                                                      CFT006
141560200528FT_MT10003 ORD_CUST3                                                      CFT006
141570200528FT_MT10004 ORD_CUST4                                                      CFT006
141580200528FT_MT10005 ORD_CUST5                                                      CFT006
141590200528FT_MT10006 ORD_CUSTTP                                                     CFT006
141600200528FT_MT10007 BENEFICI1                                                      CFT006
141610200528FT_MT10008 BENEFICI2                                                      CFT006
141620200528FT_MT10009 BENEFICI3                                                      CFT006
141630200528FT_MT10010 BENEFICI4                                                      CFT006
141640200528FT_MT10011 BENEFICI5                                                      CFT006
141650200528FT_MT10012 BENE_TYPE                                                      CFT006
141660200528FT_MT10013 REM_INFO1                                                      CFT006
141670200528FT_MT10014 REM_INFO2                                                      CFT006
141680200528FT_MT10015 REM_INFO3                                                      CFT006
141690200528FT_MT10016 REM_INFO4                                                      CFT006
141700200528FT_MT10017 REG_RPT1                                                       CFT006
141710200528FT_MT10018 REG_RPT2                                                       CFT006
141720200528FT_MT10019 REG_RPT3                                                       CFT006
141730200528FT_MT20001 FTRN_TYPE                                                      CFT006
141740200528FT_MT20002 FTRN_REF                                                       CFT006
141750200528FT_MT20003 CHQ_PRNT                                                       CFT006
141760200528FT_MT20004 SWIFT_PTY                                                      CFT006
141770200528FT_MT20005 BASE_RATE  Xrate L3                                            CFT006
141780200528FT_MT20006 INP_USER                                                       CFT006
141790200528FT_MT20007 INP_DATE   Date                                                CFT006
141800200528FT_MT20008 INP_TIME                                                       CFT006
141810200528FT_MT20009 UPD_USER                                                       CFT006
141820200528FT_MT20010 UPD_DATE   Date                                                CFT006
141830200528FT_MT20011 UPD_TIME                                                       CFT006
141840200528FT_MT20012 AUT_USR1                                                       CFT006
141850200528FT_MT20013 AUT_USR2                                                       CFT006
141860200528FT_MT20014 AUTH_IND                                                       CFT006
141870200528FT_MT20015 BATCH_NO                                                       CFT006
141880200528FT_MT20016 ADV_CRT                                                        CFT006
141890200528FT_MT20017 TOT_CRTRN  AmountL                                             CFT006
141900200528FT_MT20018 AKEY_INDT                                                      CFT006
141910200528FT_MT20019 AKEY_DRDT                                                      CFT006
141920200528FT_MT20020 AKEY_CRDT                                                      CFT006
141930200528PYDRCR0001 PAY_REF                                                        CFT014
141940200528PYDRCR0002 VALUE DATE Date                                                CFT014
141950200528PYDRCR0003 PRINT_DATE Date                                                CFT014
141960200528PYDRCR0004 PAY_TYPE                                                       CFT014
141970200528PYDRCR0005 PAY_S_TYPE                                                     CFT014
141980200528PYDRCR0006 PAY_ST_DSC                                                     CFT014
141990200528PYDRCR0007 SETTLEMOD                                                      CFT014
142000200528PYDRCR0008 CR_CCY                                                         CFT014
142010200528PYDRCR0009 CR_CCY_NAM                                                     CFT014
142020200528PYDRCR0010 CR_AMOUNT  AmountL                                             CFT014
142030200528PYDRCR0011 CHQ_NUMBER                                                     CFT014
142040200528PYDRCR0012 CHQ_SEQ_NO                                                     CFT014
142050200528PYDRCR0013 CR DATE    Date                                                CFT014
142060200528PYDRCR0014 DR_CCY                                                         CFT014
142070200528PYDRCR0015 DR_CCY_NAM                                                     CFT014
142080200528PYDRCR0016 DR_AMOUNT  AmountL                                             CFT014
142090200528PYDRCR0017 DR DATE    Date                                                CFT014
142100200528TRNCHG0001 RCV_CHGS   AmountL                                             CFT014
142110200528TRNCHG0002 SNDR_CHG1  AmountL                                             CFT014
142120200528TRNCHG0003 SNDR_CCY1                                                      CFT014
142130200528TRNCHG0004 SNDR_CHG2  AmountL                                             CFT014
142140200528TRNCHG0005 SNDR_CCY2                                                      CFT014
142150200528TRNCHG0006 SNDR_CHG3  AmountL                                             CFT014
142160200528TRNCHG0007 SNDR_CCY3                                                      CFT014
142170200528TRNCHG0008 SNDR_CHG4  AmountL                                             CFT014
142180200528TRNCHG0009 SNDR_CCY4                                                      CFT014
142190200528TRNCHG0010 SNDR_CHG5  AmountL                                             CFT014
142200200528TRNCHG0011 SNDR_CCY5                                                      CFT014
142210200528TRNCHG0012 EUR_RCHG   AmountL                                             CFT014
142220200528TRNCHG0013 EUR_SCHG1  AmountL                                             CFT014
142230200528TRNCHG0014 EUR_SCHG2  AmountL                                             CFT014
142240200528TRNCHG0015 EUR_SCHG3  AmountL                                             CFT014
142250200528TRNCHG0016 EUR_SCHG4  AmountL                                             CFT014
142260200528TRNCHG0017 EUR_SCHG5  AmountL                                             CFT014
142270200528CFT0090001 CFT009                                                         CFT009
142280200528CFT0090002 CODE_TELEX                                                     CFT009
142290200528CFT0090003 CODE_CHQ                                                       CFT009
142300200528CFT0090004 CODE_COSTA                                                     CFT009
142310200528CFT0090005 CODE_SWFTS                                                     CFT009
142320200528CFT0090006 CODE_SWFTP                                                     CFT009
142330200528CFT0090007 CODE_MISC0                                                     CFT009
142340200528CFT0090008 CODE_MISC1                                                     CFT009
142350200528CFT0090009 CODE_MISC2                                                     CFT009
142360200528CFT0090010 CODE_MISC3                                                     CFT009
142370200528CFT0090011 CODE_MISC4                                                     CFT009
142380200528CFT0090012 CODE_MISC5                                                     CFT009
142390200528CFT0090013 CODE_TRAN                                                      CFT009
142400200528CFT0090014 CODE_FX                                                        CFT009
142410200528CFT0090015 CODE_ADVIC                                                     CFT009
142420200528CFT0090016 CODE_TELEP                                                     CFT009
142430200528CFT0090017 CODE_COLL                                                      CFT009
142440200528CFT0090018 CFT010                                                         CFT009
142450200528CFT0090019 FXSPREAD                                                       CFT009
142460200528VATA  0001 VATA_TELEX AmountL                                             CFT009
142470200528VATA  0002 VATA_CHQ   AmountL                                             CFT009
142480200528VATA  0003 VATA_COSTA AmountL                                             CFT009
142490200528VATA  0004 VATA_SWFTS AmountL                                             CFT009
142500200528VATA  0005 VATA_SWFTP AmountL                                             CFT009
142510200528VATA  0006 VATA_MISC0 AmountL                                             CFT009
142520200528VATA  0007 VATA_MISC1 AmountL                                             CFT009
142530200528VATA  0008 VATA_MISC2 AmountL                                             CFT009
142540200528VATA  0009 VATA_MISC3 AmountL                                             CFT009
142550200528VATA  0010 VATA_MISC4 AmountL                                             CFT009
142560200528VATA  0011 VATA_MISC5 AmountL                                             CFT009
142570200528VATA  0012 VATA_TRAN  AmountL                                             CFT009
142580200528VATA  0013 VATA_FX    AmountL                                             CFT009
142590200528VATA  0014 VATA_ADVIC AmountL                                             CFT009
142600200528VATA  0015 VATA_TELEP AmountL                                             CFT009
142610200528VATA  0016 VATA_COLL  AmountL                                             CFT009
142620200528VATA  0017 ENT_TOTCHG AmountL                                             CFT009
142630200528VATE  0001 VATE_TELEX AmountL                                             CFT009
142640200528VATE  0002 VATE_CHQ   AmountL                                             CFT009
142650200528VATE  0003 VATE_COSTA AmountL                                             CFT009
142660200528VATE  0004 VATE_SWFTS AmountL                                             CFT009
142670200528VATE  0005 VATE_SWFTP AmountL                                             CFT009
142680200528VATE  0006 VATE_MISC0 AmountL                                             CFT009
142690200528VATE  0007 VATE_MISC1 AmountL                                             CFT009
142700200528VATE  0008 VATE_MISC2 AmountL                                             CFT009
142710200528VATE  0009 VATE_MISC3 AmountL                                             CFT009
142720200528VATE  0010 VATE_MISC4 AmountL                                             CFT009
142730200528VATE  0011 VATE_MISC5 AmountL                                             CFT009
142740200528VATE  0012 VATE_TRAN  AmountL                                             CFT009
142750200528VATE  0013 VATE_FX    AmountL                                             CFT009
142760200528VATE  0014 VATE_ADVIC AmountL                                             CFT009
142770200528VATE  0015 VATE_TELEP AmountL                                             CFT009
142780200528VATE  0016 VATE_COLL  AmountL                                             CFT009
142790200528VATE  0017 EUR_TOTCHG AmountL                                             CFT009
142800200528BBP   0001 BRANCH                                                         CFT009
142810200528BBP   0002 BRANCH NAM                                                     CFT009
142820200528BBP   0003 BOOK_CODE                                                      CFT009
142830200528BBP   0004 BOOK_DESC                                                      CFT009
142840200528BBP   0005 PROF_CENT                                                      CFT009
142850200528BBP   0006 PROF_C_DSC                                                     CFT009
142860200528DEXNAR0001 DEX_NARR01                    Extended Narrative 1                                 CER031
142870200528DEXNAR0002 DEX_NARR02                    Extended Narrative 2                                 CER031
142880200528DEXNAR0003 DEX_NARR03                    Extended Narrative 3                                 CER031
142890200528DEXNAR0004 DEX_NARR04                    Extended Narrative 4                                 CER031
142900200528DEXNAR0005 DEX_NARR05                    Extended Narrative 5                                 CER031
142910200528DEXNAR0006 DEX_NARR06                    Extended Narrative 6                                 CER031
142920200528DEXNAR0007 DEX_NARR07                    Extended Narrative 7                                 CER031
142930200528DEXNAR0008 DEX_NARR08                    Extended Narrative 8                                 CER031
142940200528DEXNAR0009 DEX_NARR09                    Extended Narrative 9                                 CER031
142950200528DEXNAR0010 DEX_NARR10                    Extended Narrative 10                                CER031
142960200528DEXNAR0011 DEX_NARR11                    Extended Narrative 11                                CER031
142970200528DEXNAR0012 DEX_NARR12                    Extended Narrative 12                                CER031
142980200528DEXNAR0013 DEX_NARR13                    Extended Narrative 13                                CER031
142990200528DEXNAR0014 DEX_NARR14                    Extended Narrative 14                                CER031
143000200528DEXNAR0015 DEX_NARR15                    Extended Narrative 15                                CER031
143010200528DEXNAR0016 DEX_NARR16                    Extended Narrative 16                                CER031
143020200528DEXNAR0017 DEX_NARR17                    Extended Narrative 17                                CER031
143030200528DEXNAR0018 DEX_NARR18                    Extended Narrative 18                                CER031
143040200528DEXNAR0019 DEX_NARR19                    Extended Narrative 19                                CER031
143050200528DEXNAR0020 DEX_NARR20                    Extended Narrative 20                                CER031
143060200528CEXNAR0001 CEX_NARR01                    Extended Narrative 1 Crd                             CER031
143070200528CEXNAR0002 CEX_NARR02                    Extended Narrative 2 Crd                             CER031
143080200528CEXNAR0003 CEX_NARR03                    Extended Narrative 3 Crd                             CER031
143090200528CEXNAR0004 CEX_NARR04                    Extended Narrative 4 Crd                             CER031
143100200528CEXNAR0005 CEX_NARR05                    Extended Narrative 5 Crd                             CER031
143110200528CEXNAR0006 CEX_NARR06                    Extended Narrative 6 Crd                             CER031
143120200528CEXNAR0007 CEX_NARR07                    Extended Narrative 7 Crd                             CER031
143130200528CEXNAR0008 CEX_NARR08                    Extended Narrative 8 Crd                             CER031
143140200528CEXNAR0009 CEX_NARR09                    Extended Narrative 9 Crd                             CER031
143150200528CEXNAR0010 CEX_NARR10                    Extended Narrative 10 Crd                            CER031
143160200528CEXNAR0011 CEX_NARR11                    Extended Narrative 11 Crd                            CER031
143170200528CEXNAR0012 CEX_NARR12                    Extended Narrative 12 Crd                            CER031
143180200528CEXNAR0013 CEX_NARR13                    Extended Narrative 13 Crd                            CER031
143190200528CEXNAR0014 CEX_NARR14                    Extended Narrative 14 Crd                            CER031
143200200528CEXNAR0015 CEX_NARR15                    Extended Narrative 15 Crd                            CER031
143210200528CEXNAR0016 CEX_NARR16                    Extended Narrative 16 Crd                            CER031
143220200528CEXNAR0017 CEX_NARR17                    Extended Narrative 17 Crd                            CER031
143230200528CEXNAR0018 CEX_NARR18                    Extended Narrative 18 Crd                            CER031
143240200528CEXNAR0019 CEX_NARR19                    Extended Narrative 19 Crd                            CER031
143250200528CEXNAR0020 CEX_NARR20                    Extended Narrative 20 Crd                            CER031
143260200528CFT1340001 IBAN                                                                               CFT134
143270200528** ##CPY  **      OBJECT COPYRIGHT
143280200528(c) Finastra International Limited 2001
