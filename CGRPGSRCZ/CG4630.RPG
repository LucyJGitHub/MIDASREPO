     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG FT DR/CR advices generation extract')         *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4630 - FT Extract Program                                  *
     F*                                                               *
     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*  (phase(s))                                                   *
     F*                                                               *
     F*  Called By: mmCnnnn - (program name)                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 MD038960           Date 08Jun16               *
      *                 CFT134             Date 13Feb12               *
      *                 AR1097394          Date 02Apr13               *
      *                 AR1096709A         Date 02Apr13               *
      *                 AR1096709          Date 20Mar13               *
      *                 AR1082119A         Date 18Mar13               *
      *                 AR1096097          Date 15Mar13               *
      *                 AR1082119          Date 29Jan13               *
      *                 CFT121             Date 28Sep12               *
      *                 CFT120             Date 28Sep12               *
      *                 AR850312           Date 18Nov10               *
      *                 CER049             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23445A          Date 19Apr09               *
      *                 BUG23445           Date 17Mar09               *
      *                 BUG23197           Date 03Mar09               *
      *                 BUG22749           Date 07Feb09               *
      *                 BUG22563           Date 30Jan09               *
      *                 CER031             Date 19May08               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15265           Date 06Nov07               *
      *                 BUG15105           Date 23Oct07               *
      *                 CSW207             Date 06Dec06               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12827           Date 06Dec06               *
      *                 BUG12648           Date 14Nov06               *
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 05Jul06               *
      *                 BUG11679           Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9646            Date 20Dec05               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222373             Date 03Nov03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 203663             Date 17Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CSW201             Date 02May01               *
      *                 192761             Date 18May01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      *                 152149             DATE 30Jan01               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CFT014             Date 25May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CFT008             Date 04Jan00               *
      *                 CFT006             Date 01Oct99               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CPB001             Date 20Sep99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFT003             Date 18Nov98               *
      *                 137419             Date 19Jun98               *
     F*                 CEU006             DATE 02APR98               *
     F*                 096419             DATE 09NOV95               *
     F*                 095577             DATE 07NOV95               *
     F*                 089214             DATE 16JUN95               *
     F*                 087994             DATE 17MAY95               *
     F*                 087995             DATE 11MAY95               *
     F*                 086382             DATE 18APR95               *
     F*                 085775             DATE 05APR95               *
     F*                 086177             DATE 30MAR95               *
     F*                 S01522             DATE 25JAN95               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *           (Recompile)                                         *
      *  MD046248 - Finastra Rebranding                               *
      *  MD038960 - Program dump because CER049 has been switched on  *
      *             but Effective Date has not been reached yet. Fix  *
      *             is to not extract Stamp Tax details instead.      *
      *           - Applied for MD039263                              *
      *  CFT134 - Add IBAN to DR/CR Advices                           *
      *  AR1097394 - Charges currency must be shown in the Credit     *
      *              advice instead of charge currency ind setting in *
      *              the FT ICD                                       *
      *  AR1096709A - If the Charge to the DR of A/c is Partial       *
      *               account data of the said field is missing in the*
      *               Credit and Debit advice                         *
      *  AR1096709 - If the Charge to the DR of A/c is Partial account*
      *              data of the said field is missing in the Credit  *
      *              and Debit advice                                 *
      *  AR1082119A - In the debit advice, entered currency generated *
      *              is EUR. The currency of the charge to debit ac   *
      *              is USD.                                          *
      *  AR1096097 - If Charges to the DR of Account is Nostro, data  *
      *              of the mentioned field is missing in the 1st and *
      *              2nd Advices.                                     *
      *  AR1082119 - In the debit advice, entered currency generated  *
      *              is EUR. The currency of the charge to debit ac   *
      *              is USD.                                          *
      *  CFT121 - FT IN/OP - Separate DR Advice for Charges           *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  AR850312 - Error on program CG4630, record not found in      *
      *             SDBOOKPD                                          *
      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23445A - Paper statements were not reformatted based on   *
      *              network *PAPER                                   *
      *  BUG23445 - Format network according to network Paper if      *
      *             Account is linked                                 *
      *  BUG23197 - Pass blank parameter to the MG001900(Output       *
      *             parameter)                                        *
      *  BUG22749 - Component failed due to DB Error SCSARDPD         *
      *             (Partially fixed by BUG22563)                     *
      *  BUG22563 - Component CGC2050 failed due to DB Error SCSARDPD *
      *  CER031 - FT/GL Extended Narrative German Features            *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  BUG15265 - Component CGC2050 failed due to DB Error AOCURRR0 *
      *  BUG15105 - Missing Process for SWIFT 2007                    *
      *  CSW207 - SWIFT 2007 Changes                                  *
      *  BUG12827 - Blank M2CHGC caused CGC2050 component to fail     *
      *  BUG12648 - Blank M1CHGC caused CGC2050 component to fail     *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG11679 - Additional Conversion of Customer Number to Alpha.*
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222373 - Correct parameters on program calls                 *
      *  203663 - 'Charges to the Debit of Account No.' is not set up *
      *           correctly.                                          *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  CSW201 - SWIFT 2001 Standards Update                         *
      *  192761 - Some parts of CFT014 are not switchable.            *
      *  CFT009 - FT Fees and Charge Development                      *
     F*  152149 - PAY_DLVCCY & PAY_DLVAMT not appearing for CP's      *
      *  CFT014 - Stright-through Processing Phase 2                  *
      *           MT103 Messages Generation for FT                    *
      *  CFT008 - Funds Transfer/Swift Messages MT102                 *
      *  CFT006 - Funds Transfer/Swift Messages MT101                 *
     F*  CPB001 - 'Private Banking' Module                            *
     F*  CFT003 - Settlment Method '14'                               *
     F*  137419 - Vat not extracted for cheques for collection.       *
     F*  CEU006 - EMU Funds Transfer Payments and Settlements:        *
     F*           added 3 new group sets FT_DLV, CHGENT and CHGEUR    *
     F*           to existing group sets DRCR01,DRCR02,DRCR03,DRCR04. *
     F*  096419 - Place destination in Account with Bank if latter blk*
     F*  095577 - Add new RDEs                                        *
     F*           CR DATE Credit Date                                 *
     F*           DR DATE Dedit Date                                  *
     F*           SETTLE MOD Settlement Method                        *
     F*  089214 - Add in telex amount for collections                 *
     F*           Correct A/c with bank address                       *
     F*  087994 - Various formatting errors                           *
     F*  087995 - Remove *DBERR from AOCURRR0 call                    *
     F*           Correct Currency as parameter                       *
     F*           Use cheque sequence number to get information       *
     F*  086382 - Do not call A0PRFCR0 if profit center blank.        *
     F*  085775 - Change customer report town from 10A to 35A         *
     F*  086177 - Move generation so not print can be set             *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*                                                               *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     F/SPACE 5
     FCQCOD   IF  E           K        DISK
     FCQPAC   IF  E           K        DISK
     FINPAY   IF  E           K        DISK
     FOTPAY   IF  E           K        DISK
     FFT101HL3IF  E           K        DISK                               CFT006
     FFT102HL3IF  E           K        DISK                               CFT008
     FFT101DL0IF  E           K        DISK                               CFT006
     FFT102DL0IF  E           K        DISK                               CFT008
     FMUSER   IF  E           K        DISK
     FINPAYXL0IF  E           K        DISK                               CFT014
     FOTPAYXL0IF  E           K        DISK                               CFT014
      *                                                                                       CER049
      ** Midas FT Incoming Payments Extension Detail                                          CER049
      *                                                                                       CER049
     FINPAYQL0IF  E           K        DISK                                                   CER049
      *                                                                                       CER049
      ** Midas FT Outgoing Payments Extension Detail                                          CER049
      *                                                                                       CER049
     FOTPAYQL0IF  E           K        DISK                                                   CER049
      *                                                                                       CER049
      ** Midas FT Cheques to be Paid Extension File                                           CER049
      *                                                                                       CER049
     FCQPACQL0IF  E           K        DISK                                                   CER049
      *                                                                                       CER049
      ** Midas FT Cheques for Collection Extension File                                       CER049
      *                                                                                       CER049
     FCQCOCQL0IF  E           K        DISK                                                   CER049
      *                                                                                     BUG23445
      ** Midas GL Network accounts - MT94x - retrieval                                      BUG23445
      *                                                                                     BUG23445
     F*GLNW94L1IF  E           K        DISK                                      BUG23445 BUG23445A
     FGLNWACL1IF  E           K        DISK                                                BUG23445A
      *                                                                                     BUG23445
     F/COPY WNCPYSRC,CG4630F001
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E***********         ##GRP   1  71 10   ##RDEA 22                    095577
     E/COPY WNCPYSRC,CG4630E001
     E***********         ##GRP   1  74 10   ##RDEA 22              095577CEU006
     E***********         ##GRP   1 108 10   ##RDEA 22              CEU006CPB001
     E******************* ##GRP   1 109 10   ##RDEA 22              CPB001CFT006
     E***********         ##GRP   1 224 10   ##RDEA 22             CFT006 CFT014
     E********************##GRP   1 258 10   ##RDEA 22              CFT014CFT009
     E**********          ##GRP   1 350 10   ##RDEA 22                                 CFT009 CSW201
     E**********          ##GRP   1 366 10   ##RDEA 22                                 CSW201 CER031
     E**********          ##GRP   1 406 10   ##RDEA 22                                 CER031 CER049
     E**********          ##GRP   1 408 10   ##RDEA 22                                 CER049 CFT121
     E**********          ##GRP   1 409 10   ##RDEA 22                                 CFT121 CFT120
     E**********          ##GRP   1 411 10   ##RDEA 22                                 CFT120 CFT134
     E                    ##GRP   1 412 10   ##RDEA 22                                        CFT134
     E/COPY WNCPYSRC,CG4630E002
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
      *                                                                   CFT008
     E                    FLDNAM     40 10                                                    CER031
     E                    MSGID      40  7                                                    CER031
     E                    MSGDTA     40 45                                                    CER031
     E                    WFLDNM     40 10                                                    CER031
     E                    WMGID      40  7                                                    CER031
     E                    WMGDTA     40 45                                                    CER031
      *                                                                                       CER031
     IFT102HD0                                                            CFT008
     I              SINST                           SINSTX                CFT008
     I*
     I            DS
     I                                    B   1   20##OSEQ
     I**  Convert Ouput Sequence between Numeric and Binary
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9646
     I                                        15632 ##S                                      BUG9646
     I##ADS       DS                           5120                       CFT009
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I*
     I#RETLN      DS
     I**********                              1   60##CNUM                                    CSD027
     I                                        1   6 ##CNUM                                    CSD027
     I                                        7   9 ##CCY
     I**********                             10  130##ACOD                                    CGL029
     I**********                             14  150##ACSQ                                    CGL029
     I**********                             16  18 ##BRC1                                    CGL029
     I                                       10  190##ACOD                                    CGL029
     I                                       20  210##ACSQ                                    CGL029
     I                                       12  24 ##BRC1                                    CGL029
      *                                                                   CPB001
     I            DS                                                      CPB001
     I                                        1   6 KCNUM                 CPB001
     I**********                              7  10 KACOD                              CPB001 CGL029
     I**********                             11  12 KACSQ                              CPB001 CGL029
     I**********                             13  15 KBRCA                              CPB001 CGL029
     I**********                              1  15 WORC1                              CPB001 CGL029
     I                                        7  16 KACOD                                     CGL029
     I                                       17  18 KACSQ                                     CGL029
     I                                       19  21 KBRCA                                     CGL029
     I                                        1  21 WORC1                                     CGL029
     I            DS
      *
      * Data Structure redefining Address fields
      *
     I                                        1 210 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
     I                                      176 210 ADCHK6
      *
      * Blank Line Analysis data structure
      *
     I                                       36 210 ADCH26
     I                                       71 210 ADCH36
      *
      * SWIFT Address Analysis data structure
      *
     I                                        1   1 ADSLSH
     I                                        1  11 ADSWFT
     I                                       12  35 ADEXSW
     I                                       36  36 ADSLS2
     I                                       36  46 ADSWF2
     I                                       47  70 ADEXS2
      *
      * Customer Analysis data structure
      *
     I                                        1  10 ADCUST
     I                                       11  35 ADEXCS
     I                                        1   6 ADCNUM
     I                                        7  35 ADEXCN
     I                                       36  45 ADCUS2
     I                                       46  70 ADXCS2
     I                                       36  41 ADCNM2
     I                                       42  70 ADXCN2
      *
      * Account Analysis data structure FULL Account
      *
     I                                        1   6 ADGCNM
     I                                        7   9 ADGCCY
     I**********                             10  13 ADGACD                                    CGL029
     I**********                             14  15 ADGASQ                                    CGL029
     I**********                             16  18 ADGBRC                                    CGL029
     I**********                             16  35 ADEXG1                                    CGL029
     I**********                             19  35 ADEXGL                                    CGL029
     I                                       10  19 ADGACD                                    CGL029
     I                                       20  21 ADGASQ                                    CGL029
     I                                       22  24 ADGBRC                                    CGL029
     I                                       22  35 ADEXG1                                    CGL029
     I                                       25  35 ADEXGL                                    CGL029
      *
      * Partial Account Analysis data structure
      *
     I                                        1   6 ADPCNM
     I**********                              7  10 ADPACD                                    CGL029
     I**********                             11  12 ADPASQ                                    CGL029
     I**********                             13  15 ADPBRC                                    CGL029
     I**********                             13  35 ADEXP1                                    CGL029
     I**********                             16  35 ADEXPA                                    CGL029
     I                                        7  16 ADPACD                                    CGL029
     I                                       17  18 ADPASQ                                    CGL029
     I                                       19  21 ADPBRC                                    CGL029
     I                                       19  35 ADEXP1                                    CGL029
     I                                       22  35 ADEXPA                                    CGL029
      *
      * Nostro Number Account Analysis data structure
      *
     I                                        1   2 ADNOSN
     I                                        3  35 ADEXNN
      *
      * Nostro Account Analysis data structure
      *
     I                                        1   5 ADFNOS
     I                                        1   3 ADFCCY
     I                                        4   5 ADFNNB
     I                                        6  35 ADFNEX
      *
      * Retail Account Analysis data structure
      *
     I                                        1  10 ADACNO
     I                                       11  35 ADEXAC
      *
     I            DS
      *
      * Data Structure redefining Partial Account
      *
     I**********                              1  12 PTACCT                                    CGL029
     I                                        1  18 PTACCT                                    CGL029
     I                                        1   6 PTCNUM
     I**********                              7  10 PTACOD                                    CGL029
     I**********                             11  12 PTACSQ                                    CGL029
     I                                        7  16 PTACOD                                    CGL029
     I                                       17  18 PTACSQ                                    CGL029
     I            DS
      *
      * Data Structure for address work fields.
      *
     I                                        1  35 W#ADD1
     I                                       36  70 W#ADD2
     I                                       71 105 W#ADD3
     I                                      106 140 W#ADD4
     I                                      141 175 W#ADD5
     I                                        1 175 W#ADDR
     I*                                                                   CFT006
     I** Data area for redefining GL account (OLD)                        CFT006
     I*                                                                   CFT006
     I            DS                                                      CFT006
     I**********                              1  18 OGLACT                             CFT006 CGL029
     I                                        1  24 OGLACT                                    CGL029
     I                                        1   6 OGLCNM                CFT006
     I                                        7   9 OGLCCY                CFT006
     I**********                             10  13 OGLACD                             CFT006 CGL029
     I**********                             14  15 OGLSEQ                             CFT006 CGL029
     I**********                             16  18 OGLBRH                             CFT006 CGL029
     I                                       10  19 OGLACD                                    CGL029
     I                                       20  21 OGLSEQ                                    CGL029
     I                                       22  24 OGLBRH                                    CGL029
     I*                                                                   CFT006
     I** Data area for redefining GL account (NEW)                        CFT006
     I*                                                                   CFT006
     I            DS                                                      CFT006
     I**********                              1  18 NGLACT                             CFT006 CGL029
     I                                        1  24 NGLACT                                    CGL029
     I                                        1   3 NGLBRH                CFT006
     I                                        4   9 NGLCNM                CFT006
     I                                       10  12 NGLCCY                CFT006
     I**********                             13  16 NGLACD                             CFT006 CGL029
     I**********                             17  18 NGLSEQ                             CFT006 CGL029
     I                                       13  22 NGLACD                                    CGL029
     I                                       23  24 NGLSEQ                                    CGL029
      *                                                                   087994
      *  Calling parameter data structure for AOCCYCV0                    087994
      *                                                                   087994
     ID#DTA       DS                            256                       087994
      *                                       From Currency & amount      087994
     I                                        1   3 D#FCCY                087994
     I                                    P   4  110D#FAMT                087994
      *                                       To Currency & amount        087994
     I                                       12  14 D#TCCY                087994
     I                                    P  15  220D#TAMT                087994
      *                                       Rate and multi/div ind.     087994
     I                                       23  23 I#MDIN                087994
     I                                    P  24  368I#RATE                087994
      *                            Output     Rate and multi/div ind.     087994
      *                                       If no in rate               087994
     I                                       37  37 O#MDIN                087994
     I                                    P  38  508O#RATE                087994
      *
     IDSSDY     E DSDSSDY
     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     ISDCURR    E DSSDCURRPD
     I* DS FOR CURRENCIES DETAILS
     ISDBRCH    E DSSDBRCHPD
     I* DS FOR BRANCH DETAILS
     ISDBANK    E DSSDBANKPD
     I* DS FOR BANK DETAILS
     ISDMMOD    E DSSDMMODPD                                              CPB001
     I* DS FOR MODULE DETAILS                                             CPB001
     IDSFDY     E DSDSFDY
     I*
     ISDBOOK    E DSSDBOOKPD
     I*
     ISDPRFC    E DSSDPRFCPD
     I* DS FOR PROFIT CENTRE DETAILS
     I*                                                                                       CFT134
     ISDNOST    E DSSDNOSTPD                                                                  CFT134
     I* DS FOR NOSTRO DETAILS                                                                 CFT134
     I*
     I** RECORD FORMATS FOR ACCESS TO BOOK DETAILS
     I*
     ISDGELR    E DSSDGELRPD                                              CEU006
     I              QQACCD                          QQACCX                                  BUG23445
     I* DS for GL ICD Details                                             CEU006
     I*                                                                   CEU006
     ISDFTFR    E DSSDFTFRPD                                              CEU006
     I* DS for FT ICD Details                                             CEU006
     I*                                                                   CEU006
     ISDDLST    E DSSDDLSTPD
     I* DS FOR DEAL SUBTYPE DETAILS
      *                                                                                       CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
      ** DS for SAR details                                                                   CCG015
     I              LCD                             WSCLCD                                    CCG015
      *                                                                                       CCG015
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
     ISDACCT    E DSACCNTAB                                               CPB001
     I              PRFC                            APRFC                 CPB001
     I              BRCA                            ABRCA                 CPB001
     I              LCD                             ALCD                  CPB001
     I/COPY WNCPYSRC,CG4630I001
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
      *
      *    STANDARD LOCAL DATA AREA FIELDS
      *
     IRUNDT       DS
      *  DATA AREA RUNDAT
      *
      *
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     IW8FT        DS                            256
      *
      * Address data structure
      *
      * Currency
     I                                        1   3 W8CCY
      * Settlement Type
     I                                        4   5 W8STMT
      * Mandatory Text - convert BIC identifiers
     I                                        6   6 W8MTXT
      * Message Tag
     I                                        7  11 W8MTAG
      * Construct of data in field
     I                                       12  12 W8TYPE
      * Number of Lines available
     I                                       13  140W8NLIN
      * Network and Message Type
     I                                       15  20 W8NWRK
     I                                       21  23 W8MTPY
      * Calling Program
     I                                       24  33 W8CPGM
      * Action *PRINT/*ENQ/*MSG GEN
     I                                       34  41 W8ACT
      * Critical reporting - Database error if 'Y'
      * If no BIC directory and BIC entered no error
     I                                       42  42 W8CRIT
      * Force Midas Address - where possible
     I                                       43  43 W8MADD
      * If Retail get first address from account
     I                                       44  44 W8RTAD
      * Alternative Address
     I                                       45  45 W8ALTN
      * Address type selected in W0MSG
     I                                       46  46 W8ADTP
      * Customer number
     I**********                             47  520W0CNUM                                    CSD027
     I                                       47  52 W0CNUM                                    CSD027
      * Retail Account number
     I                                       53  620W0ACNO
      * Currency
     I*****************                      63  650W#CCY                 087995
     I                                       63  65 W#CCY                 087995
      * Account Code
     I**********                             66  690W0ACOD                                    CER031
     I                                       66  690QQACOD                                    CER031
      * Account Sequence
     I                                       70  710W0ACSQ
      * Account Name
     I                                       72 101 W0ANAM
      * Branch
     I                                      102 104 W0BRCA
      * Customer name
     I                                      105 124 W0CRNM
      * Customer SWIFT I.D
     I                                      125 136 W0CSID
      * Customer account line
     I                                      137 171 W0ACLN
      * Customer report town
     I************                          172 181 W0RTWN                085775
     I                                      172 206 W0RTWN                085775
      *                                                                                       CER031
     I                                      207 2160W0ACOD                                    CER031
     I**DSPAR1      DS                                                    087995
     IDSPAR1      DS                            256                       087995
      *
      ** Print Item Type
     I                                        1  10 ##PTYP
      *
      ** Print Item Sub-Type
     I                                       11  20 ##PSTP
      *
      ** File containing document data
     I                                       21  27 ##FILE
      *
      ** Branch
     I                                       28  30 ##BRCA
      *
      ** Payment type
     I                                       31  32 ##PYTP
      *
      ** Payment Reference
     I                                       33  47 ##PREF
      *
      ** Commit (YES/NO )
     I                                       48  50 W0CMT
      *
      ** Update files (YES/NO )
     I                                       51  53 W0UPF
      *
      ** Item suppressed
     I                                       54  56 ##ISUP
      *
      ** Cheque Number
     I                                       57  650##CQNM
      *
      ** Number of cheques 'extracted'
     I                                       66  700##RECU
      *                                                                   087995
      ** Cheques sequence number                                          087995
     I                                       71  720##CQSQ                087995
      *                                                                   CEU006
     I/COPY FTCPYSRC,FT0010I001                                           CEU006
      **  Input/output parameters for call to FT0010.                     CEU006
      *
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     I            DS                                                                          CER031
     I                                        1  100PACCD                                     CER031
      *                                                                                       CER031
     I                                       11  120PACSQ                                     CER031
      *                                                                                       CER049
      ** Midas SD Stamp Tax Defaults by Business Type Data Structure                          CER049
      *                                                                                       CER049
     ISDSTPD    E DSSDSTPDPD                                                                  CER049
     I*---------------------------------------------------------------------
     I/COPY CGCPYSRC,SRERRI
     I/COPY WNCPYSRC,CG4630I002
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C***********          PARM           DSPARM 70                       087995
     C                     PARM           DSPARM256                       087995
      *
     C                     MOVELDSPARM    DSPAR1
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      **  Initial processing - Once Only
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      **  Obtain data from the relevant file
     C                     EXSR SRMDTA
     C                     MOVE 'Y'       WRPT    1                       CFT006
     C           ##FILE    IFEQ 'FT101H'                                  CFT006
     C           ##PREF    CHAINFT101DL0             10                   CFT006
     C                     ENDIF                                          CFT006
     C           ##FILE    IFEQ 'FT102H'                                  CFT008
     C           ##PREF    CHAINFT102DL0             10                   CFT008
     C                     ENDIF                                          CFT008
      *                                                                   CFT014
      ** Access Incoming Payments Extension File                          CFT014
     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C           ##FILE    OREQ 'INPAY  '                                 CFT009
     C           CFT009    ANDEQ'Y'                                       CFT009
     C           ##PREF    CHAININPAYXL0             10                   CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C                     MOVEL'INPAYXL0'W0FILE                          CFT014
     C                     MOVEL##PREF    W0KEY                           CFT014
     C                     Z-ADD34        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Access Outgoing Payments Extension File                          CFT014
     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT009
     C           CFT009    ANDEQ'Y'                                       CFT009
     C           ##PREF    CHAINOTPAYXL0             10                   CFT014
      *                                                                   CFT014
     C           *IN10     IFEQ *ON                                       CFT014
     C                     MOVEL'OTPAYXL0'W0FILE                          CFT014
     C                     MOVEL##PREF    W0KEY                           CFT014
     C                     Z-ADD35        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          CFT014
      *
      **  Initialisation processing
     C           WRPT      DOWEQ'Y'                                       CFT006
     C           ##FILE    IFNE 'FT101H  '                                CFT006
     C           ##FILE    ANDNE'FT102H  '                                CFT008
     C                     MOVE 'N'       WRPT                            CFT006
     C                     ENDIF                                          CFT006
     C                     EXSR SRINZ
      *
     C* Try to generate record if customer                                086177
     C********** W0CNUM    IFNE *ZEROS                                                 086177 CSD027
     C           W0CNUM    IFNE *BLANKS                                                       CSD027
     C/COPY WNCPYSRC,CG4630C005
      *     Add processing to produce a credit advice if                  CFT003
      *     settlement type 14 for Outgoing Payments.                     CFT003
      *     If an outgoing payment and the settlement type is 14,         CFT003
      *     (Print type/Subtype FT_ADV_CR/OUT_PAY) then this              CFT003
      *     program will be called twice for the same extract             CFT003
      *     record so that a CR advice can be produced along              CFT003
      *     with the existing DR advice.                                  CFT003
      *     For FT_ADV_CR/OUT_PAY the primary correspondent is            CFT003
      *     set to the value of the customer number of the retail         CFT003
      *     account entered in the Destination field. This value          CFT003
      *     was captured in the first call to the program (DR             CFT003
      *     advice) in the subroutine #DETIN                              CFT003
      *****************************************************************   CFT003
      *                                                                   CFT003
     C           UUCRAD    IFEQ *BLANKS                                   CFT003
     C                     MOVEL'FT_ADV_C'UUCRAD  9        Too big        CFT003
     C                     MOVE 'R'       UUCRAD           Too big        CFT003
     C                     ENDIF                                          CFT003
      *
      **  If CR advice to be produced.                                    CFT003
     C           ##PTYP    IFEQ UUCRAD                                    CFT003
     C           ##PSTP    ANDEQ'OUT_PAY'                                 CFT003
      *                                                                   CFT003
      *  Get Destination Customer                                         CFT003
      *                                                                   CFT003
     C********** SNCO      IFNE *ZEROS                                               CFT003 BUG11679
     C           SNCO      IFNE *BLANKS                                                     BUG11679
     C                     MOVE SNCT      WTYPE                           CFT003
     C                     MOVELSNCO      WPTY                            CFT003
     C                     MOVE PCCY      WCCY                            CFT003
     C                     MOVELSNCO      WPTY1                           CFT003
     C                     MOVEL*BLANKS   WBRCA                           CFT003
     C                     EXSR SRTPSR                                    CFT003
     C                     ENDIF                                          CFT003
     C********** W0CNUM    IFEQ *ZEROS                                                 CFT003 CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
     C           DSTT      IFNE 'A'                                       CFT003
     C                     MOVE DSTT      WTYPE                           CFT003
     C                     MOVELDST1      WPTY                            CFT003
     C                     MOVE PCCY      WCCY                            CFT003
     C                     MOVELDST1      WPTY1                           CFT003
     C                     MOVELDST2      WPTY2                           CFT003
     C                     MOVEL*BLANKS   WBRCA                           CFT003
     C                     EXSR SRTPSR                                    CFT003
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT003
     C           ##PTYP    IFEQ UUCRAD                                    CFT006
     C           ##PSTP    ANDEQ'FT_RFT '                                 CFT006
     C           BENTTP    ANDNE'A'                                       CFT006
      *                                                                   CFT006
     C           BENTTP    IFEQ 'G'                                       CFT006
     C                     MOVELTBNA35    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    TBNA35                          CFT006
     C                     MOVELTBNB35    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    TBNB35                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE BENTTP    WTYPE                           CFT006
     C                     MOVELTBNA35    WPTY                            CFT006
     C                     MOVE PAYCCY    WCCY                            CFT006
     C                     MOVELTBNA35    WPTY1                           CFT006
     C                     MOVELTBNB35    WPTY2                           CFT006
     C                     MOVELBRCA      WBRCA                           CFT006
     C                     EXSR SRTPSR                                    CFT006
     C                     ENDIF                                          CFT006
     C           ##PTYP    IFEQ UUCRAD                                    CFT008
     C           ##PSTP    ANDEQ'FT_CCT '                                 CFT008
     C           BENTTD    ANDNE'A'                                       CFT008
      *                                                                   CFT006
     C           BENTTD    IFEQ 'G'                                       CFT006
     C                     MOVELBENF1     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    BENF1                           CFT006
     C                     MOVELBENF2     NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    BENF2                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE BENTTD    WTYPE                           CFT008
     C                     MOVELBENF1     WPTY                            CFT008
     C                     MOVE PAYCCY    WCCY                            CFT008
     C                     MOVELBENF1     WPTY1                           CFT008
     C                     MOVELBENF2     WPTY2                           CFT008
     C                     MOVELBRCA      WBRCA                           CFT008
     C                     EXSR SRTPSR                                    CFT008
     C                     ENDIF                                          CFT008
      *                                                                   CFT003
     C           UUDRAD    IFEQ *BLANKS                                   CFT003
     C                     MOVEL'FT_ADV_D'UUDRAD  9        Too big        CFT003
     C                     MOVE 'R'       UUDRAD           Too big        CFT003
     C                     ENDIF                                          CFT003
      *
      **  If DR advice to be produced.                                    CFT003
     C           ##PTYP    IFEQ UUDRAD                                    CFT003
     C           ##PSTP    ANDEQ'IN_PAY'                                  CFT003
      *                                                                   CFT014
      ** Third Reimbursement Institution precedes the Receiver's          CFT014
      ** Correspondent and the Sender.                                    CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           INTRIT    ANDNE*BLANK                                    CFT014
     C                     MOVELINTRIT    WTYPE                           CFT014
     C                     MOVELINTRIB    WPTY                            CFT014
     C                     MOVELSMCY      WCCY                            CFT014
     C                     MOVELINTRIB    WPTY1                           CFT014
     C                     MOVEL*BLANKS   WBRCA                           CFT014
     C                     EXSR SRTPSR                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       192761
     C********** W0CNUM    IFEQ *ZERO                                                  CFT014 CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
      *                                                                   CFT014
     C***********RCCO      IFNE *ZERO                              CFT003 CFT014
     C***********          MOVE RCRT      WTYPE                    CFT003 CFT014
     C***********          MOVELRCCO      WPTY                     CFT003 CFT014
     C           INRCRT    IFNE 'A'                                       CFT014
     C                     MOVELINRCRT    WTYPE                           CFT014
     C                     MOVELINRCO1    WPTY                            CFT014
     C                     MOVE SMCY      WCCY                            CFT003
     C***********          MOVELRCCO      WPTY1                    CFT003 CFT014
     C                     MOVELINRCO1    WPTY1                           CFT014
     C                     MOVELINRCO2    WPTY2                           CFT014
     C                     MOVEL*BLANKS   WBRCA                           CFT003
     C                     EXSR SRTPSR                                    CFT003
     C                     ENDIF                                          CFT003
     C********** W0CNUM    IFEQ *ZEROS                                                 CFT003 CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
     C           SNTP      IFNE 'A'                                       CFT003
     C                     MOVE SNTP      WTYPE                           CFT003
     C                     MOVELSND1      WPTY                            CFT003
     C                     MOVE SMCY      WCCY                            CFT003
     C                     MOVELSND1      WPTY1                           CFT003
     C                     MOVELSND2      WPTY2                           CFT003
     C                     MOVEL*BLANKS   WBRCA                           CFT003
     C                     EXSR SRTPSR                                    CFT003
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT003
     C                     ENDIF                                          CFT014
     C                     ELSE                                           192761
     C********** RCCO      IFNE *ZERO                                                192761 BUG11679
     C           RCCO      IFNE *BLANKS                                                     BUG11679
     C                     MOVE RCRT      WTYPE                           192761
     C                     MOVELRCCO      WPTY                            192761
     C                     MOVE SMCY      WCCY                            192761
     C                     MOVELRCCO      WPTY1                           192761
     C                     MOVEL*BLANKS   WBRCA                           192761
     C                     EXSR SRTPSR                                    192761
     C                     ENDIF                                          192761
     C********** W0CNUM    IFEQ *ZEROS                                                 192761 CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
     C           SNTP      IFNE 'A'                                       192761
     C                     MOVE SNTP      WTYPE                           192761
     C                     MOVELSND1      WPTY                            192761
     C                     MOVE SMCY      WCCY                            192761
     C                     MOVELSND1      WPTY1                           192761
     C                     MOVELSND2      WPTY2                           192761
     C                     MOVEL*BLANKS   WBRCA                           192761
     C                     EXSR SRTPSR                                    192761
     C                     ENDIF                                          192761
     C                     ENDIF                                          192761
     C                     ENDIF                                          192761
     C                     ENDIF                                          CFT003
     C                     EXSR SRGENR                                    086177
     C                     ENDIF                                          086177
      *
      **  Main processing
     C********** W0CNUM    IFNE *ZEROS                                                        CSD027
     C           W0CNUM    IFNE *BLANKS                                                       CSD027
     C           ##RTCD    ANDNE'CGD1270'                                 086177
     C                     EXSR SRMAIN
     C                     ELSE
     C                     MOVEL'*NOPRNT' W0RTN
     C                     ENDIF
      *                                                                   CFT006
     C           ##FILE    IFEQ 'FT101H  '                                CFT006
     C           ##FILE    OREQ 'FT102H  '                                CFT008
     C           ##FILE    IFEQ 'FT101H  '                                CFT006
     C           ##PREF    READEFT101DL0                 10               CFT006
     C                     ELSE                                           CFT008
     C           ##PREF    READEFT102DL0                 10               CFT008
     C                     ENDIF                                          CFT006
     C           *IN10     IFEQ '1'                                       CFT006
     C                     MOVE 'N'       WRPT                            CFT006
     C                     ENDIF                                          CFT006
     C                     ENDIF                                          CFT006
     C                     ENDDO                                          CFT006
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
      *
     C***********          EXSR SRGENR                                    086177
      *
     C/COPY WNCPYSRC,CG4630C018
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C                     EXSR DRCR01
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C                     EXSR DRCR02
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C                     EXSR DRCR03
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Collectn
     C                     EXSR DRCR04
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C                     EXSR DRCR05                                    CFT006
     C           ##FILE    WHEQ 'FT102H '                                 CFT008
     C                     EXSR DRCR06                                    CFT008
     C                     ENDSL
     C/COPY WNCPYSRC,CG4630C019
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMDTA                                         *
      * Function    :  Obtain data from relevant file                 *
      *                                                               *
      * Called by   :  Main processing                                *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMDTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMDTA'  @STK,Q
      *
      *................................................................
      *
     C           KKEY01    KLIST
     C                     KFLD           ##PREF
     C                     KFLD           WCQSQX  20
      *
     C                     SELEC
     C           ##FILE    WHEQ 'CQCOD  '
     C                     Z-ADD0         WCQSQX                          087995
     C           KKEY01    CHAINCQCOD                98
     C                     Z-ADD##CQSQ    WCQSQX                          087995
     C           KKEY01    CHAINCQCOD                98                   087995
     C           ##FILE    WHEQ 'CQPAC  '
     C                     Z-ADD0         WCQSQX                          087995
     C           KKEY01    CHAINCQPAC                98
     C                     Z-ADD##CQSQ    WCQSQX                          087995
     C           KKEY01    CHAINCQPAC                98                   087995
     C           ##FILE    WHEQ 'INPAY  '
     C           ##PREF    CHAININPAY                98
     C           ##FILE    WHEQ 'OTPAY  '
     C           ##PREF    CHAINOTPAY                98
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##PREF    CHAINFT101HL3             98                   CFT006
     C           ##FILE    WHEQ 'FT102H '                                 CFT008
     C           ##PREF    CHAINFT102HL3             98                   CFT008
     C                     ENDSL
     C/COPY WNCPYSRC,CG4630C014
      *
      ** DATABASE ERROR
      *
     C           *IN98     IFEQ *ON
     C                     MOVEL##PREF    W#PREF 17
     C           ##FILE    IFEQ 'CQCOD  '
     C           ##FILE    OREQ 'CQPAC  '
     C                     MOVE '00'      W#PREF
     C                     ENDIF
      *
     C                     MOVEL##FILE    W0FILE
     C                     MOVELW#PREF    W0KEY            ***************
     C                     Z-ADD5         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      *................................................................
      *
     C           EXMDTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DRCR01                                         *
      * Function    :  Incoming payments - DR Advices                 *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           DRCR01    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DRCR01'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\DRCR01' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ****Branch*Details**************                                    CFT009
     C*********************EXSR BRANCH                                    CFT009
      ********************************                                    CFT009
      ****Book*Details****************                                    CFT009
     C*********************EXSR BOOK                                      CFT009
      ********************************                                    CFT009
      ****Profit*Centre*Details*******                                    CFT009
     C*********************EXSR PROF@C                                    CFT009
      *                                                                   CFT009
      *   Branch, Book, Profit Centre Details                             CFT009
     C                     EXSR BBP                                       CFT009
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      ***********                                                         CFT014
      ****Payment*Main*Data********************************************   CFT014
     C***********          EXSR PAYMNT                                    CFT014
      **********                                                          087994
      ****Payment Secondary data                                          087994
     C**********           EXSR PAY@II                                    087994
      ***********                                                         CFT014
      ****Credit/Cheque*Currency***************************************   CFT014
     C***********          EXSR CR@CCY                                    CFT014
      ***********                                                         CFT014
      ****Debit*Currency***********************************************   CFT014
     C***********          EXSR DR@CCY                                    CFT014
     C           CFT014    IFEQ 'Y'                                       192761
      *                                                                   CFT014
      ** Payment Main data, Credit/Cheque currency, Debit Currency        CFT014
     C                     EXSR PYDRCR                                    CFT014
     C                     ELSE                                           192761
      *                                                                   192761
      **  Payment Main Data                                               192761
     C                     EXSR PAYMNT                                    192761
      *                                                                   192761
      **  Credit/Cheque Currency                                          192761
     C                     EXSR CR@CCY                                    192761
      *                                                                   192761
      **  Debit Currency                                                  192761
     C                     EXSR DR@CCY                                    192761
     C                     ENDIF                                          192761
      *                                                                   087994
      **  Payment Secondary data                                          087994
     C                     EXSR PAY@II                                    087994
      *                                                                                       CER049
      ** Stamp Tax data (if feature is switched on)                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR FTSTAX                                                        CER049
     C                     ENDIF                                                              CER049
      *                                                                   CFT014
      **  Third Reimbursement Institution                                 CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           INTRIT    ANDNE*BLANK                                    CFT014
     C                     EXSR SRTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *
      **  Receiver's Correspondant
     C                     EXSR RECEVR
      *
      **  Ordering Institution
     C                     EXSR O@INST
      *
      **  Ordering Customer Details
     C                     EXSR O@CUST
      *
      **  Account with bank
     C                     EXSR AC@W@B
      *
      **  Beneficiary Details
     C                     EXSR BENEF
      *
      **  Details of Payment
     C                     EXSR PAYDET
      *
      **  Charges to the debit of
     C                     EXSR CG@DAC
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
      **  (Only if CFT009 is off)                                         CFT009
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
      *                                                                   CEU006
      **  Funds Transfer Delivery Details                                 CEU006
     C                     EXSR FT@DLV                                    CEU006
      *                                                                   CEU006
      **  Entered Charges                                                 CEU006
     C                     EXSR CHGENT                                    CEU006
      *                                                                   CEU006
      **  Euro Charges                                                    CEU006
     C                     EXSR CHGEUR                                    CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4630C008
      *                                                                   CFT014
      ** Charge Transparency fields                                       CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRSRCH                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT003
      **  Sender                                                          CFT003
     C                     EXSR SEND2                                     CFT003
      *................................................................
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      **  Funds Transfer Delivery Details                                 CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C                     EXSR FT@DLV                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     EXSR INFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR INENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR INVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR INEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR INVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *
     C           CER031    IFEQ 'Y'                                                           CER031
     C                     EXSR SRIPNR                                                        CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
     C           CFT004    IFEQ 'Y'                                                           CFT134
     C           CFT134    ANDEQ'Y'                                                           CFT134
     C                     EXSR SRGTIB                                                        CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           EXCR01    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DRCR02                                         *
      * Function    :  Outgoing payments - DR Advices                 *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           DRCR02    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DRCR02'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\DRCR02' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      ****Branch*Details**************                                    CFT009
     C*********************EXSR BRANCH                                    CFT009
      ********************************                                    CFT009
      ****Book*Details****************                                    CFT009
     C*********************EXSR BOOK                                      CFT009
      ********************************                                    CFT009
      ****Profit*Centre*Details*******                                    CFT009
     C*********************EXSR PROF@C                                    CFT009
      *                                                                   CFT009
      *   Branch, Book, Profit Centre Details                             CFT009
     C                     EXSR BBP                                       CFT009
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      ***********                                                         CFT014
      ****Payment*Main*Data********************************************   CFT014
     C***********          EXSR PAYMNT                                    CFT014
      **********                                                          087994
      ****Payment Secondary data                                          087994
     C**********           EXSR PAY@II                                    087994
      ***********                                                         CFT014
      ****Credit/Cheque*Currency***************************************   CFT014
     C***********          EXSR CR@CCY                                    CFT014
      ***********                                                         CFT014
      ****Debit*Currency***********************************************   CFT014
     C***********          EXSR DR@CCY                                    CFT014
     C           CFT014    IFEQ 'Y'                                       192761
      *                                                                   CFT014
      ** Payment Main data, Credit/Cheque currency, Debit Currency        CFT014
     C                     EXSR PYDRCR                                    CFT014
     C                     ELSE                                           192761
      *                                                                   192761
      **  Payment Main Data                                               192761
     C                     EXSR PAYMNT                                    192761
      *                                                                   192761
      **  Credit/Cheque Currency                                          192761
     C                     EXSR CR@CCY                                    192761
      *                                                                   192761
      **  Debit Currency                                                  192761
     C                     EXSR DR@CCY                                    192761
     C                     ENDIF                                          192761
      *                                                                   087994
      **  Payment Secondary data                                          087994
     C                     EXSR PAY@II                                    087994
      *                                                                                       CER049
      ** Stamp Tax data (if feature is switched on)                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR FTSTAX                                                        CER049
     C                     ENDIF                                                              CER049
      *                                                                   CFT014
      **  Third Reimbursement Institution                                 CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           OPTRIT    ANDNE*BLANK                                    CFT014
     C                     EXSR SRTRIB                                    CFT014
     C                     ENDIF                                          CFT014
      *
      **  Sender's Correspondant
     C                     EXSR SENDER
      *
      **  Ordering Institution
     C                     EXSR O@INST
      *
      **  Ordering Customer Details
     C                     EXSR O@CUST
     C/COPY WNCPYSRC,CG4630C006
      *
      **  Account with bank
     C                     EXSR AC@W@B
      *
      **  Beneficiary Details
     C                     EXSR BENEF
      *
      **  Details of Payment
     C                     EXSR PAYDET
      *
      **  Charges to the debit of
     C                     EXSR CG@DAC
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
      **  (Only if CFT009 is off)                                         CFT009
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
      *                                                                   CEU006
      **  Funds Transfer Delivery Details                                 CEU006
     C                     EXSR FT@DLV                                    CEU006
      *                                                                   CEU006
      **  Entered Charges                                                 CEU006
     C                     EXSR CHGENT                                    CEU006
      *                                                                   CEU006
      **  Euro Charges                                                    CEU006
     C                     EXSR CHGEUR                                    CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4630C009
      *                                                                   CFT014
      ** Charge Transparency fields                                       CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C                     EXSR SRSRCH                                    CFT014
     C                     ENDIF                                          CFT014
      *                                                                   EAH010
      **  Destination                                                     EAH010
     C                     EXSR DESTIN                                    EAH010
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
      **  Funds Transfer Delivery Details                                 CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C                     EXSR FT@DLV                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     EXSR OTFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR OTENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR OTVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR OTEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR OTVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *................................................................
      *
     C           CER031    IFEQ 'Y'                                                           CER031
     C                     EXSR SROPNR                                                        CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
     C           CFT004    IFEQ 'Y'                                                           CFT134
     C           CFT134    ANDEQ'Y'                                                           CFT134
     C                     EXSR SRGTIB                                                        CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           EXCR02    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DRCR03                                         *
      * Function    :  Cheques to be paid                             *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           DRCR03    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DRCR03'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\DRCR03' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      **  Branch Details
     C                     EXSR BRANCH
      *
      **  Book Details
     C                     EXSR BOOK
      *
      **  Profit Centre Details
     C                     EXSR PROF@C
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      *
      **  Payment Main Data
     C                     EXSR PAYMNT
      **********                                                          087994
      ****Payment Secondary data                                          087994
     C**********           EXSR PAY@II                                    087994
      *
      **  Credit/Cheque Currency
     C                     EXSR CR@CCY
      *
      **  Debit Currency
     C                     EXSR DR@CCY
      *                                                                   087994
      **  Payment Secondary data                                          087994
     C                     EXSR PAY@II                                    087994
      *                                                                                       CER049
      ** Stamp Tax data (if feature is switched on)                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR FTSTAX                                                        CER049
     C                     ENDIF                                                              CER049
      *
      **  Sender's Correspondant
     C                     EXSR SENDER
      *
      **  Remit
     C                     EXSR REMIT
      *
      **  Debit Party
     C                     EXSR DR@PTY
      *
      **  Charges to the debit of
     C                     EXSR CG@DAC
     C/COPY WNCPYSRC,CG4630C016
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
      **  (Only if CFT009 is off)                                         CFT009
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
     C           CEU006    OREQ 'Y'                                                         BUG12648
     C           CFT009    ANDEQ'Y'                                                         BUG12648
     C           WALLOW    ANDEQ'N'                                                         BUG12648
      *                                                                   CEU006
      **  Funds Transfer Delivery Details                                 CEU006
     C                     EXSR FT@DLV                                    CEU006
      *                                                                   CEU006
      **  Entered Charges                                                 CEU006
     C                     EXSR CHGENT                                    CEU006
      *                                                                   CEU006
      **  Euro Charges                                                    CEU006
     C                     EXSR CHGEUR                                    CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4630C022
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           WALLOW    ANDEQ'Y'                                                         BUG12648
      *                                                                   CFT009
      **  Funds Transfer Delivery Details                                 CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C                     EXSR FT@DLV                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     EXSR CPFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR CPENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR CPVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR CPEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR CPVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *................................................................
      *
     C           EXCR03    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DRCR04                                         *
      * Function    :  Cheques for collection - Cr Advices            *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           DRCR04    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DRCR04'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\DRCR04' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      **  Branch Details
     C                     EXSR BRANCH
      *
      **  Book Details
     C                     EXSR BOOK
      *
      **  Profit Centre Details
     C                     EXSR PROF@C
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      *
      **  Payment Main Data
     C                     EXSR PAYMNT
      **********                                                          087994
      ****Payment Secondary data                                          087994
     C**********           EXSR PAY@II                                    087994
      *
      **  Credit/Cheque Currency
     C                     EXSR CR@CCY
      *
      **  Debit Currency
     C                     EXSR DR@CCY
      *                                                                   087994
      **  Payment Secondary data                                          087994
     C                     EXSR PAY@II                                    087994
      *                                                                                       CER049
      ** Stamp Tax data (if feature is switched on)                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR FTSTAX                                                        CER049
     C                     ENDIF                                                              CER049
      *
      **  Receiver's Correspondant
     C                     EXSR RECEVR
      *
      **  Collecting Institution
     C                     EXSR C@INST
      *
      **  Credit Party
     C                     EXSR CR@PTY
      *
      **  Narrative
     C                     EXSR NARR
      *
      **  Charges to the debit of
     C                     EXSR CG@DAC
     C/COPY WNCPYSRC,CG4630C021
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process FT_DLV, CHGENT and CHGEUR group sets.              CEU006
      **  (Only if CFT009 is off)                                         CFT009
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C           CFT009    ANDEQ'N'                                       CFT009
     C           CEU006    OREQ 'Y'                                                         BUG12648
     C           CFT009    ANDEQ'Y'                                                         BUG12648
     C           WALLOW    ANDEQ'N'                                                         BUG12648
      *                                                                   CEU006
      **  Funds Transfer Delivery Details                                 CEU006
     C                     EXSR FT@DLV                                    CEU006
      *                                                                   CEU006
      **  Entered Charges                                                 CEU006
     C                     EXSR CHGENT                                    CEU006
      *                                                                   CEU006
      **  Euro Charges                                                    CEU006
     C                     EXSR CHGEUR                                    CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4630C023
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           WALLOW    ANDEQ'Y'                                                         BUG12648
      *                                                                   CFT009
      **  Funds Transfer Delivery Details                                 CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C                     EXSR FT@DLV                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     EXSR CCFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR CCENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR CCVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR CCEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR CCVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      *................................................................
      *
     C           EXCR04    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  DRCR05                                         *   CFT006
      * Function    :  Request for Transfer                           *   CFT006
      *                                                               *   CFT006
      * Called by   :  SRMAIN - Main Processing                       *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           DRCR05    BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'DRCR05'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\DRCR05' ##PNAM  7                       CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Store Path                                                      CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVELS#PATH    ##SPAT                          CFT006
      *                                                                   CFT006
      ** Request for Transfer Details                                     CFT006
      *                                                                   CFT006
     C                     EXSR SRRFT                                     CFT006
     C                     EXSR SRRFI                                     CFT006
     C                     EXSR DR@CCY                                    CFT006
     C                     EXSR CR@CCY                                    CFT006
      *                                                                   CFT006
      ** Book Details                                                     CFT006
      *                                                                   CFT006
     C                     EXSR BOOK                                      CFT006
      *                                                                   CFT006
      ** Profit Centre Details                                            CFT006
      *                                                                   CFT006
     C                     EXSR PROF@C                                    CFT006
     C                     EXSR SRMT0                                     CFT006
     C                     EXSR SRMT1                                     CFT006
     C                     EXSR SRMT2                                     CFT006
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           WALLOW    ANDEQ'Y'                                                         BUG12648
     C                     EXSR RFFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR RFENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR RFVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR RFEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR RFVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT008
      * Subroutine  :  DRCR06                                         *   CFT008
      * Function    :  Customer Credit Transfer                       *   CFT008
      *                                                               *   CFT008
      * Called by   :  SRMAIN - Main Processing                       *   CFT008
      * Calls       :                                                 *   CFT008
      *****************************************************************   CFT008
     C           DRCR06    BEGSR                                          CFT008
      *                                                                   CFT008
      **  Set up subroutine stack name                                    CFT008
     C                     ADD  1         Q                               CFT008
     C                     MOVEL'DRCR06'  @STK,Q                          CFT008
      *                                                                   CFT008
      *................................................................   CFT008
      *                                                                   CFT008
      **  Set up Path.                                                    CFT008
     C                     MOVEL'\DRCR06' ##PNAM  7                       CFT008
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT008
      **  Store Path                                                      CFT008
     C           1         OCUR ##SRDT                                    CFT008
     C                     MOVELS#PATH    ##SPAT                          CFT008
      *                                                                   CFT008
      ** Customer Credit Transfer                                         CFT008
      *                                                                   CFT008
     C                     EXSR SRCCT                                     CFT008
     C                     EXSR DR@CCY                                    CFT008
     C                     EXSR CR@CCY                                    CFT008
     C                     EXSR SRCCI                                     CFT008
      ** Include 4 new Sender's Charges if CSW201 is on                                       CSW201
     C           CSW201    IFEQ 'Y'                                                           CSW201
     C                     EXSR SRSCGH                                                        CSW201
     C                     ENDIF                                                              CSW201
      *                                                                   CFT008
      ** Book Details                                                     CFT008
      *                                                                   CFT008
     C                     EXSR BOOK                                      CFT008
      *                                                                   CFT008
      ** Profit Centre Details                                            CFT008
      *                                                                   CFT008
     C                     EXSR PROF@C                                    CFT008
     C                     EXSR SRMT0                                     CFT008
     C                     EXSR SRMT1                                     CFT008
     C                     EXSR SRMT2                                     CFT008
      *                                                                   CFT009
      ** Fees and charges                                                 CFT009
      *                                                                   CFT009
     C           CFT009    IFEQ 'Y'                                       CFT009
     C           WALLOW    ANDEQ'Y'                                                         BUG12648
     C                     EXSR CTFEES                                    CFT009
      *                                                                   CFT009
      **  Entered Charges                                                 CFT009
     C                     EXSR CTENTC                                    CFT009
      *                                                                   CFT009
      **  Entered Charges VAT                                             CFT009
     C                     EXSR CTVATA                                    CFT009
      *                                                                   CFT009
     C           CEU006    IFEQ 'Y'                                       CFT009
     C           WCHGIN    ANDEQ'Y'                                       CFT009
      *                                                                   CFT009
      **  Euro Charges                                                    CFT009
     C                     EXSR CTEURC                                    CFT009
      *                                                                   CFT009
      **  Euro Charges VAT                                                CFT009
     C                     EXSR CTVATE                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT008
     C                     ENDSR                                          CFT008
      *****************************************************************   CFT008
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4630C012
      *
      ** Branch
     C                     MOVELA8BRCD    ##D,1
      *
      ** Branch Name
     C                     MOVELA8BRNM    ##D,2
      *
     C/COPY WNCPYSRC,CG4630C013
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BOOK                                           *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BOOK      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BOOK  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BOOK  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Book Details
     C           BOKC      IFNE *BLANKS                                                     AR850312
     C                     CALL 'AOBOOKR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM BOKC      @BOKC   2
     C           SDBOOK    PARM SDBOOK    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBOOKPD'W0FILE
     C                     MOVELBOKC      W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C                     ENDIF                                                            AR850312
      *
      ** Book Code
     C                     MOVELBOKC      ##D,1
      *
      ** Book Description
     C                     MOVELBDBKD     ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOK      TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PROF@C                                         *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PROF@C    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PROF_C'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PROF_C' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *                                                                   086382
      **  Bypass if profit center blank.                                  086382
     C           PRFC      IFEQ *BLANKS                                   086382
     C                     GOTO EXOF@C                                    086382
     C                     ENDIF                                          086382
      *
      **  Obtain Profit Centre details
     C                     CALL 'AOPRFCR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PRFC      @KEY    4
     C           SDPRFC    PARM SDPRFC    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDPRFCPD'W0FILE
     C                     MOVELPRFC      W0KEY            ***************
     C                     Z-ADD3         W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Profit Centre
     C                     MOVELPRFC      ##D,1
      *
      ** Profit Centre Description
     C                     MOVELDSPCDS    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOF@C    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  FT@USR                                         *
      * Function    :  FT Transaction Users                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           FT@USR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'FT_USR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\FT_USR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Input User 1
     C                     MOVELINUSR1    ##D,1
      *
      ** Input User 2
     C                     MOVELINUSR2    ##D,2
      *
      ** Authorising User 1
     C                     MOVELAUP1      ##D,3
      *
      ** Authorising User 2
     C                     MOVELAUP2      ##D,4
      *
      ** Input User 1 Description.
     C           INUSR1    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,5
     C                     ENDIF
      *
      ** Input User 2 Description.
     C           INUSR1    IFNE INUSR2
     C           INUSR2    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,7
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      IFNE AUP2
     C           AUP2      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@USR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAYMNT                                         *
      * Function    :  Payment - Main data                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAYMNT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAYMNT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAYMNT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Payment Reference
     C                     MOVELPREF      ##D,1
      *
      **  Value Date
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Ingoing  Payments
     C***********##FILE    OREQ 'OTPAY  '                  Outgoing Paymen087994
     C                     MOVELPVDT      ##D,2
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087994
     C                     MOVELSLDT      ##D,2                           087994
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C                     MOVELDRVD      ##D,2
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
     C                     MOVELCRVD      ##D,2
     C                     ENDSL
      *
      **  Payment Date
     C                     MOVELBJRDNB    ##D,3
      *
      **  Payment Type
     C                     MOVELPYTP      ##D,4
      *
      **  Payment Sub-Type
     C                     MOVELPYST      ##D,5
      *
      **  Obtain Payment Sub-Type Description
     C                     CALL 'AODLSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PYST      @AQCD   3
     C           SDDLST    PARM SDDLST    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDDLSTPD'W0FILE
     C                     MOVELPYST      W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **  Payment Sub-Type Description
     C                     MOVELASDSTN    ##D,6
      *                                                                   095577
      * Set up Settle Method                                              095577
      *                                                                   095577
     C                     SELEC                                          095577
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
     C                     MOVEL'00'      ##D,7                           095577
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen095577
     C                     MOVELSTMT      ##D,7                           095577
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
     C                     MOVELSTMT      ##D,7                           095577
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
     C                     MOVEL'00'      ##D,7                           095577
     C                     ENDSL                                          095577
     C/COPY WNCPYSRC,CG4630C015
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXYMNT    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAY@II                                         *
      * Function    :  Payment - Secondary Data                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAY@II    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAY_II'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAY_II' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Payment Exchange rate
     C                     MOVELRATE      ##D,1
      *
      **  Ascertain the correct currency code.
     C           *LIKE     DEFN ##CCY     #CCY
     C********** CDRO      IFNE *ZEROS                                                      BUG11679
     C           CDRO      IFNE *BLANKS                                                     BUG11679
     C           CFT120    IFEQ 'Y'                                                           CFT120
     C                     SELEC                                                              CFT120
      *                                                                                       CFT120
      ** Incoming payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
     C           INCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELINCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Outgoing payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     OTHER                                                              CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ENDSL                                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELBJCYCD    #CCY
     C                     ENDIF                                                              CFT120
     C                     ELSE
      *                                                                   087994
      * Set charge currency depending on file being processed             087994
      *                                                                   087994
     C                     SELEC                                          087994
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
     C           ##FILE    OREQ 'OTPAY  '                                 087994
     C           ADDC      IFEQ 'A'                                       087994
     C                     MOVELSMCY      #CCY                            087994
     C                     ELSE                                           087994
     C                     MOVELPCCY      #CCY                            087994
     C                     ENDIF                                          087994
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
     C                     MOVELDRCY      #CCY                            087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
     C                     MOVELCRCY      #CCY                            087994
     C                     ENDSL                                          087994
     C                     ENDIF
      *
      **  Charge currency
     C                     MOVEL#CCY      ##D,2
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM #CCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVEL#CCY      W0KEY            ***************
     C                     Z-ADD9         W0ERNB           * DB ERROR 09 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4630C001
      *
      **  Add/Deduct Flag
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '
     C                     MOVELADDC      ##D,3
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVEL'D'       ##D,3
     C                     ENDSL
      *
      **  Transfer Commission
     C/COPY WNCPYSRC,CG4630C024
     C                     MOVELTRCM      ##D,4
     C/COPY WNCPYSRC,CG4630C025
     C                     MOVE A6NBDP    ##D,4
      *
      **  FX/Charge Commission
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C/COPY WNCPYSRC,CG4630C026
     C                     MOVELINCHCM    ##D,5
     C/COPY WNCPYSRC,CG4630C027
     C                     MOVE A6NBDP    ##D,5
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C028
     C                     MOVELOPCHCM    ##D,5
     C/COPY WNCPYSRC,CG4630C029
     C                     MOVE A6NBDP    ##D,5
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C/COPY WNCPYSRC,CG4630C030
     C                     MOVELPDCHCM    ##D,5
     C/COPY WNCPYSRC,CG4630C031
     C                     MOVE A6NBDP    ##D,5
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
     C/COPY WNCPYSRC,CG4630C032
     C                     MOVELCCCHCM    ##D,5
     C/COPY WNCPYSRC,CG4630C033
     C                     MOVE A6NBDP    ##D,5
     C                     ENDSL
      *
      **  Telex Charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C/COPY WNCPYSRC,CG4630C034
     C                     MOVELTXCH      ##D,6
     C/COPY WNCPYSRC,CG4630C035
     C                     MOVE A6NBDP    ##D,6
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C                     MOVE *BLANKS   ##D,6
     C                     ENDSL
      *
      **  Cheque Charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C036
     C                     MOVELCQCH      ##D,7
     C/COPY WNCPYSRC,CG4630C037
     C                     MOVE A6NBDP    ##D,7
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVEL*BLANKS   ##D,7
     C                     ENDSL
      *
      **  Costs Abroad
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C                     MOVE *BLANKS   ##D,8
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C/COPY WNCPYSRC,CG4630C038
     C                     MOVELCSTA      ##D,8
     C/COPY WNCPYSRC,CG4630C039
     C                     MOVE A6NBDP    ##D,8
     C                     ENDSL
      *
      **  SWIFT priority charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,9
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C040
     C                     MOVELSPCH      ##D,9
     C/COPY WNCPYSRC,CG4630C041
     C                     MOVE A6NBDP    ##D,9
     C                     ENDSL
      *
      **  Miscellaneous charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C042
     C                     MOVELMSCH      ##D,10
     C/COPY WNCPYSRC,CG4630C043
     C                     MOVE A6NBDP    ##D,10
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,10
     C                     ENDSL
      *
      **  VAT
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C/COPY WNCPYSRC,CG4630C044
     C                     MOVELINVATT    ##D,11
     C/COPY WNCPYSRC,CG4630C045
     C                     MOVE A6NBDP    ##D,11
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C046
     C                     MOVELOPVATT    ##D,11
     C/COPY WNCPYSRC,CG4630C047
     C                     MOVE A6NBDP    ##D,11
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C/COPY WNCPYSRC,CG4630C048
     C                     MOVELPDVATT    ##D,11
     C/COPY WNCPYSRC,CG4630C049
     C                     MOVE A6NBDP    ##D,11
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
     C/COPY WNCPYSRC,CG4630C050
     C                     MOVELCCVATT    ##D,11
     C/COPY WNCPYSRC,CG4630C051
     C                     MOVE A6NBDP    ##D,11
     C                     ENDSL
      *
      **  Total Charge
     C           *LIKE     DEFN TXCH      #W110A
     C           *LIKE     DEFN TXCH      #W110B
     C           *LIKE     DEFN TXCH      #W110C
     C           *LIKE     DEFN TXCH      #W110D
     C           *LIKE     DEFN TXCH      #W110E
     C                     Z-ADD*ZEROS    #W110A
     C                     Z-ADD*ZEROS    #W110B
     C                     Z-ADD*ZEROS    #W110C
     C                     Z-ADD*ZEROS    #W110D
     C                     Z-ADD*ZEROS    #W110E
     C***********ADCH      ADD  TLCH      #W110E                          087994
     C***********TRCM      ADD  OPCHCM    #W110A                          087994
     C***********TXCH      ADD  CQCH      #W110B                          087994
     C***********CSTA      ADD  SPCH      #W110C                          087994
     C***********#W110C    ADD  MSCH      #W110C                          087994
      *                                                                   087994
      * Set charges depending on transaction type                         087994
      *                                                                   087994
     C                     SELEC                                          087994
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
     C                     Z-ADDTRCM      #W110D                          087994
     C           #W110D    ADD  INCHCM    #W110D                          087994
     C           #W110D    ADD  TXCH      #W110D                          087994
     C           #W110D    ADD  CQCH      #W110D                          087994
     C           #W110D    ADD  ADCH      #W110D                          087994
     C           #W110D    ADD  TLCH      #W110D                          087994
     C           #W110D    ADD  MSCH      #W110D                          087994
     C           #W110D    ADD  INVATT    #W110D                          087994
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087994
     C                     Z-ADDTRCM      #W110D                          087994
     C           #W110D    ADD  OPCHCM    #W110D                          087994
     C           #W110D    ADD  TXCH      #W110D                          087994
     C           #W110D    ADD  CQCH      #W110D                          087994
     C           #W110D    ADD  CSTA      #W110D                          087994
     C           #W110D    ADD  SPCH      #W110D                          087994
     C           #W110D    ADD  MSCH      #W110D                          087994
     C           #W110D    ADD  OPVATT    #W110D                          087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
     C                     Z-ADDTRCM      #W110D                          087994
     C           #W110D    ADD  CCCHCM    #W110D                          087994
     C           #W110D    ADD  COLL      #W110D                          087994
     C           #W110D    ADD  CSTA      #W110D                          087994
     C           #W110D    ADD  TXCH      #W110D                          089214
     C           #W110D    ADD  CCVATT    #W110D                          087994
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
     C                     Z-ADDTRCM      #W110D                          087994
     C           #W110D    ADD  PDCHCM    #W110D                          087994
     C           #W110D    ADD  COLL      #W110D                          087994
     C           #W110D    ADD  CSTA      #W110D                          087994
     C           #W110D    ADD  PDVATT    #W110D                          087994
     C                     ENDSL                                          087994
      *                                                                   087994
      * Calculate total charges                                           087994
      *                                                                   087994
      ***********                                                         087994
     C***********#W110A    ADD  #W110B    #W110D                          087994
     C***********#W110D    ADD  #W110C    #W110D                          087994
     C***********#W110D    ADD  #W110E    #W110D                          087994
     C/COPY WNCPYSRC,CG4630C052
     C                     MOVEL#W110D    ##D,12
     C/COPY WNCPYSRC,CG4630C053
     C                     MOVE A6NBDP    ##D,12
      *
      **  Net Amount
     C           *LIKE     DEFN #W110D    #NETA
     C                     Z-ADD*ZEROS    #NETA
      *
      * Set up net amount depending on file being processed               087994
      *                                                                   087994
     C                     SELEC                                          087994
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087994
     C           ##FILE    OREQ 'OTPAY  '                                 087994
     C********** CDRO      IFNE *ZEROS                     B1                               BUG11679
     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
     C           ADDC      IFEQ 'A'                        B*2
     C                     Z-ADDSMAM      #NETA
     C                     ELSE                            X*2
     C                     Z-ADDPYAM      #NETA
     C                     ENDIF                           E*2
     C                     ELSE                            X1
     C           ADDC      IFEQ 'A'                        B*2
     C           SMAM      ADD  #W110D    #NETA
     C                     ELSE                            X*2
     C           PYAM      SUB  #W110D    #NETA
     C                     ENDIF                           E*2
     C                     ENDIF                           E1
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
     C********** CDRO      IFNE *ZEROS                     B1                        087944 BUG11679
     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
     C                     Z-ADDW#AMT     #NETA                           087994
     C                     ELSE                            X1             087994
     C           W#AMT     ADD  #W110D    #NETA                           087994
     C                     ENDIF                           X1             087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
     C********** CDRO      IFNE *ZEROS                     B1                        087944 BUG11679
     C           CDRO      IFNE *BLANKS                    B1                               BUG11679
     C                     Z-ADDW#AMT     #NETA                           087994
     C                     ELSE                            X1             087994
     C           W#AMT     SUB  #W110D    #NETA                           087994
     C                     ENDIF                           X1             087994
     C                     ENDSL                                          087994
      *
     C/COPY WNCPYSRC,CG4630C054
     C                     MOVEL#NETA     ##D,13
     C/COPY WNCPYSRC,CG4630C055
     C                     MOVE A6NBDP    ##D,13
      *
      **  Details of charges
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C                     MOVELDTCH      ##D,14
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,14
     C                     ENDSL
      *
      **  Related Reference
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C                     MOVELRLPR      ##D,15
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,15
     C                     ENDSL
      *
      **  Collection Charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C                     MOVE *BLANKS   ##D,16
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C/COPY WNCPYSRC,CG4630C056
     C                     MOVELCOLL      ##D,16
     C/COPY WNCPYSRC,CG4630C057
     C                     MOVE A6NBDP    ##D,16
     C                     ENDSL
      *
      **  Telephone Charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C/COPY WNCPYSRC,CG4630C058
     C                     MOVELTLCH      ##D,17
     C/COPY WNCPYSRC,CG4630C059
     C                     MOVE A6NBDP    ##D,17
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQPAC  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,17
     C                     ENDSL
      *
      **  Advice Charge
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C/COPY WNCPYSRC,CG4630C060
     C                     MOVELADCH      ##D,18
     C/COPY WNCPYSRC,CG4630C061
     C                     MOVE A6NBDP    ##D,18
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQPAC  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVE *BLANKS   ##D,18
     C                     ENDSL
      *
      **  Deductions
     C           ##FILE    IFEQ 'CQPAC  '                  Cheques to be paid
     C/COPY WNCPYSRC,CG4630C062
     C                     MOVELDEDS      ##D,19
     C/COPY WNCPYSRC,CG4630C063
     C                     MOVE A6NBDP    ##D,19
     C                     ELSE
     C                     MOVE *BLANKS   ##D,19
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXY@II    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5                                                                                CER049
      *****************************************************************                       CER049
      * Subroutine  :  FTSTAX                                         *                       CER049
      * Function    :  Extract Stamp Tax information                  *                       CER049
      *                                                               *                       CER049
      * Called by   : DRCR01, DRCR02, DRCR03. DRCR04                  *                       CER049
      * Calls       :                                                 *                       CER049
      *****************************************************************                       CER049
     C           FTSTAX    BEGSR                                                              CER049
      *                                                                                       CER049
      ** Set up subroutine stack name                                                         CER049
      *                                                                                       CER049
     C                     ADD  1         Q                                                   CER049
     C                     MOVEL'FTSTAX'  @STK,Q                                              CER049
      *                                                                                       CER049
      *................................................................                       CER049
      *                                                                                       CER049
      ** Retrieve subroutine specific data.                                                   CER049
      *                                                                                       CER049
     C           1         OCUR ##SRDT                                                        CER049
     C                     MOVEL##SPAT    S#PATH                                              CER049
      *                                                                                       CER049
      ** Set up Path.                                                                         CER049
      *                                                                                       CER049
     C                     MOVEL'\FTSTAX' ##PNAM                                              CER049
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER049
      *                                                                                       CER049
     C                     EXSR PSHGRS                                                        CER049
      *                                                                                       CER049
      ** Retrieve RDE information for RDEs in group set                                       CER049
      *                                                                                       CER049
     C                     MOVEL@STK,Q    ##GRPS                                              CER049
     C                     Z-ADD1         ##RDEN                                              CER049
     C                     EXSR SRRRDE                                                        CER049
      *                                                                                       CER049
      ** Set up key for Stamp Tax file                                                        CER049
      *                                                                                       CER049
     C           *LIKE     DEFN QCPREF    K1PREF                                              CER049
     C           *LIKE     DEFN QCCQSQ    K1CQSQ                                              CER049
      *                                                                                       CER049
     C           STKEY     KLIST                                                              CER049
     C                     KFLD           K1PREF                                              CER049
     C                     KFLD           K1CQSQ                                              CER049
      *                                                                                       CER049
     C                     MOVE ##PREF    K1PREF                                              CER049
     C                     MOVE ##CQSQ    K1CQSQ                                              CER049
     C                     SETON                     98                                       CER049
      *                                                                                       CER049
     C                     SELEC                                                              CER049
     C           ##FILE    WHEQ 'INPAY  '                                                     CER049
     C                     MOVEL'I/OPAY'  U#ORGN                                              CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C           K1PREF    CHAININPAYQL0             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELIPTAX     ##D,1                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELIPSTAF    ##D,2                                               CER049
      *                                                                                       CER049
     C                     MOVE IPCDTE    U#DATE                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           ##FILE    WHEQ 'OTPAY  '                                                     CER049
     C                     MOVEL'I/OPAY'  U#ORGN                                              CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C           K1PREF    CHAINOTPAYQL0             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELOTTAX     ##D,1                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELOTSTAF    ##D,2                                               CER049
      *                                                                                       CER049
     C                     MOVE OTCDTE    U#DATE                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           ##FILE    WHEQ 'CQPAC  '                                                     CER049
     C                     MOVEL'I/OCHEQ' U#ORGN                                              CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C           STKEY     CHAINCQPACQL0             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELQPTAX     ##D,1                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELQPSTAF    ##D,2                                               CER049
      *                                                                                       CER049
     C                     MOVE QPCDTE    U#DATE                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           ##FILE    WHEQ 'CQCOD  '                                                     CER049
     C                     MOVEL'I/OCHEQ' U#ORGN                                              CER049
      *                                                                                       CER049
      ** Retrieve the FT Payments record                                                      CER049
      *                                                                                       CER049
     C           STKEY     CHAINCQCOCQL0             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     MOVELQCTAX     ##D,1                                               CER049
      *                                                                                       CER049
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     MOVELQCSTAF    ##D,2                                               CER049
      *                                                                                       CER049
     C                     MOVE QCCDTE    U#DATE                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDSL                                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
     C                     CALL 'SD008141'                                                    CER049
     C                     PARM           U#DATE  50                                          CER049
     C                     PARM           U#ORGN 10                                           CER049
     C                     PARM *BLANKS   ##TYPE  4                                           CER049
     C                     PARM           U#CTAX 138                                          CER049
     C                     PARM           U#MTAX 138                                          CER049
     C                     PARM           U#CCCY  3                                           CER049
     C                     PARM           U#MCCY  3                                           CER049
     C                     PARM           U#CSCC  2                                           CER049
     C                     PARM           U#MSCC  2                                           CER049
     C                     PARM           U#TXTY  1                                           CER049
     C                     PARM           SDSTPD                                              CER049
      *                                                                                       CER049
      ** If there is a default for the Module use this tax rate and ccy                       CER049
      ** otherwise use the ICD Control defaults.                                              CER049
      *                                                                                       CER049
     C           U#MTAX    IFNE *ZEROS                                                        CER049
     C                     MOVE U#MCCY    U#SCCY  3                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE U#CCCY    U#SCCY                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** If currencies are blank, Stamp Tax feature may be on but not yet active            MD038960
     C           U#SCCY    IFEQ *BLANKS                                                     MD038960
     C                     MOVEL*BLANKS   ##D,1                                             MD038960
     C                     MOVEL*BLANKS   ##D,2                                             MD038960
     C                     ELSE                                                             MD038960
      *                                                                                     MD038960
      ** Stamp Tax Amount                                                                     CER049
      *                                                                                       CER049
     C                     CALL 'AOCURRR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*KEY   ' @OPTN                                               CER049
     C                     PARM           U#SCCY                                              CER049
     C           SDCURR    PARM SDCURR    DSSDY                                               CER049
      *                                                                                       CER049
      ** DATABASE ERROR                                                                       CER049
      *                                                                                       CER049
     C           @RTCD     IFNE *BLANK                                                        CER049
     C                     MOVEL'SDCURRPD'W0FILE                                              CER049
     C                     MOVELU#SCCY    W0KEY            ***************                    CER049
     C                     Z-ADD68        W0ERNB           * DB ERROR 68 *                    CER049
     C                     MOVEL'MEM5004' W0MSGD           ***************                    CER049
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     MOVE A6NBDP    ##D,2                                               CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                            MD038960
      *                                                                                       CER049
      ** Accumulate RDE's and associated data and output to                                   CER049
      ** PF/CGUDTAPD.                                                                         CER049
      *                                                                                       CER049
     C                     EXSR SRADTA                                                        CER049
     C                     EXSR SRODTA                                                        CER049
      *                                                                                       CER049
      *................................................................                       CER049
      *                                                                                       CER049
     C           EXSTAX    TAG                                                                CER049
      *                                                                                       CER049
     C                     EXSR POPGRS                                                        CER049
      *                                                                                       CER049
      **  Unwind subroutine stack name                                                        CER049
      *                                                                                       CER049
     C                     MOVEA*BLANKS   @STK,Q                                              CER049
     C                     SUB  1         Q                                                   CER049
      *                                                                                       CER049
     C                     ENDSR                                                              CER049
      *****************************************************************                       CER049
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CR@CCY                                         *
      * Function    :  Credit/Cheque Currency                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CR@CCY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CR_CCY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CR_CCY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Credit Cheque/Currency
     C                     SELEC
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
     C                     MOVELCRCY      ##D,1
     C                     MOVELCRCY      @AJCD
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##FILE    OREQ 'FT102H '                                 CFT008
     C                     MOVELPAYCCY    ##D,1                           CFT006
     C                     MOVELPAYCCY    @AJCD                           CFT006
     C                     OTHER
     C                     MOVELPCCY      ##D,1
     C                     MOVELPCCY      @AJCD
     C                     ENDSL
      *
      **  Obtain currency details
     C           @AJCD     IFNE *BLANKS                                                     BUG15265
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELPCCY      W0KEY            ***************
     C                     Z-ADD10        W0ERNB           * DB ERROR 10 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4630C002
      *
      **  Credit/Cheque Currency Name
     C                     MOVELA6CYNM    ##D,2
     C                     ENDIF                                                            BUG15265
      *
      **  Credit/Cheque Amount
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C064
     C                     MOVELPYAM      ##D,3
     C/COPY WNCPYSRC,CG4630C065
     C                     MOVE A6NBDP    ##D,3
     C           ##FILE    WHEQ 'CQPAC  '
     C/COPY WNCPYSRC,CG4630C066
     C                     MOVELCQAM      ##D,3
     C/COPY WNCPYSRC,CG4630C067
     C                     MOVE A6NBDP    ##D,3                           087994
     C***********##FILE    OREQ 'CQCOD  '                  Cheques for col087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
     C***********          MOVELCQAM      ##D,3                           087994
      *                                                                   087994
      * Calculate Credit currency equivalent                              087994
      *                                                                   087994
     C           MDIN      IFEQ 0                                         087994
     C                     MOVEL'D'       I#MDIN                          087994
     C                     ELSE                                           087994
     C                     MOVEL'M'       I#MDIN                          087994
     C                     END                                            087994
     C                     Z-ADDRATE      I#RATE                          087994
     C                     Z-ADDCQAM      D#FAMT                          087994
     C                     MOVELSMCY      D#FCCY                          087994
     C                     MOVELCRCY      D#TCCY                          087994
     C                     CALL 'AOCCYCV0'             9090               087994
     C           R#RTN     PARM *BLANKS   O#RTN   7                       087994
     C                     PARM '*F*T*RAT'W0ACT   8                       087994
     C           D#DTA     PARM D#DTA     O#DTA 256                       087994
      *                                                                   087994
     C           *IN90     IFEQ '1'                                       087994
     C           R#RTN     ORNE *BLANKS                                   087994
     C                     MOVEL'*CALL   'W0FILE                          087994
     C                     MOVEL'AOCCYCV0'W0KEY            ***************087994
     C                     Z-ADD15        W0ERNB           * DB ERROR 15 *087994
     C                     MOVEL'MEM5003' W0MSGD           ***************087994
     C                     MOVEL'MIDAS  ' W0MSGF                          087994
     C                     EXSR SRERR                                     087994
     C                     END                                            087994
      *                                                                   087994
     C                     Z-ADDD#TAMT    W#AMT                           087994
     C/COPY WNCPYSRC,CG4630C068
     C                     MOVELD#TAMT    ##D,3                           087994
     C/COPY WNCPYSRC,CG4630C069
     C                     MOVE A6NBDP    ##D,3
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##FILE    OREQ 'FT102H '                                 CFT008
     C                     MOVELPAYAMT    ##D,3                           CFT006
     C                     MOVE A6NBDP    ##D,3                           CFT006
     C                     Z-ADDA6NBDP    WPDCP   20                      CFT006
     C                     ENDSL
      *
      **  Cheque Number
     C                     SELEC                                          CFT006
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##FILE    OREQ 'FT102H '                                 CFT008
     C                     MOVELCHQNUM    ##D,4                           CFT006
     C                     OTHER                                          CFT006
     C                     MOVE *BLANKS   ##D,4
     C                     ENDSL                                          CFT006
      *
      **  Cheque Sequence Number
     C                     SELEC
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for coll
     C           ##FILE    OREQ 'CQPAC  '                  Cheques for Pai087994
     C                     MOVELCQSQ      ##D,5
     C                     OTHER
     C                     MOVE *BLANKS   ##D,5
     C                     ENDSL
      *                                                                   095577
      * Set up Credit Date                                                095577
      *                                                                   095577
     C                     SELEC                                          095577
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Paymen095577
     C                     MOVELPVDT      ##D,6                           095577
     C                     MOVELPVDT      ##D,6                           095577
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
     C                     MOVELPVDT      ##D,6                           095577
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
     C                     MOVELCRVD      ##D,6                           095577
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##FILE    OREQ 'FT102H '                                 CFT008
     C                     MOVELCRDVDT    ##D,6                           CFT006
     C                     ENDSL                                          095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@CCY    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DR@CCY                                         *
      * Function    :  Debit Currency                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           DR@CCY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DR_CCY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\DR_CCY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Debit Currency
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C                     MOVELSMCY      ##D,1
     C                     MOVELSMCY      @AJCD
     C           ##FILE    WHEQ 'CQPAC  '
     C                     MOVELDRCY      ##D,1
     C                     MOVELDRCY      @AJCD
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C                     MOVELTRNCCY    ##D,1                           CFT006
     C                     MOVELTRNCCY    @AJCD                           CFT006
     C           ##FILE    WHEQ 'FT102H '                                 CFT008
     C                     MOVELCCTCCY    ##D,1                           CFT008
     C                     MOVELCCTCCY    @AJCD                           CFT008
     C                     ENDSL
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELSMCY      W0KEY            ***************
     C                     Z-ADD6         W0ERNB           * DB ERROR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4630C003
      *
      **  Debit Currency Name
     C                     MOVELA6CYNM    ##D,2
      *
      **  Debit Amount
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Payments
     C/COPY WNCPYSRC,CG4630C070
     C                     MOVELSMAM      ##D,3
     C/COPY WNCPYSRC,CG4630C071
     C                     MOVE A6NBDP    ##D,3
     C***********##FILE    WHEQ 'CQPAC  '                                 087994
     C***********##FILE    OREQ 'CQCOD  '                  Cheques for col087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col087994
     C/COPY WNCPYSRC,CG4630C072
     C                     MOVELCQAM      ##D,3
     C/COPY WNCPYSRC,CG4630C073
     C                     MOVE A6NBDP    ##D,3
     C           ##FILE    WHEQ 'CQPAC  '                                 087994
      *                                                                   087994
      * Calculate Debit currency equivalent                               087994
      *                                                                   087994
     C           MDIN      IFEQ 0                                         087994
     C                     MOVEL'D'       I#MDIN                          087994
     C                     ELSE                                           087994
     C                     MOVEL'M'       I#MDIN                          087994
     C                     END                                            087994
     C                     Z-ADDRATE      I#RATE                          087994
     C                     Z-ADDCQAM      D#FAMT                          087994
     C                     MOVELPCCY      D#FCCY                          087994
     C                     MOVELDRCY      D#TCCY                          087994
     C                     CALL 'AOCCYCV0'             9090               087994
     C           R#RTN     PARM *BLANKS   O#RTN   7                       087994
     C                     PARM '*F*T*RAT'W0ACT   8                       087994
     C           D#DTA     PARM D#DTA     O#DTA 256                       087994
      *                                                                   087994
     C           *IN90     IFEQ '1'                                       087994
     C           R#RTN     ORNE *BLANKS                                   087994
     C                     MOVEL'*CALL   'W0FILE                          087994
     C                     MOVEL'AOCCYCV0'W0KEY            ***************087994
     C                     Z-ADD14        W0ERNB           * DB ERROR 14 *087994
     C                     MOVEL'MEM5003' W0MSGD           ***************087994
     C                     MOVEL'MIDAS  ' W0MSGF                          087994
     C           *LIKE     DEFN O#RTN     R#RTN                           087994
     C                     EXSR SRERR                                     087994
     C                     END                                            087994
      *                                                                   087994
     C                     Z-ADDD#TAMT    W#AMT  150                      087994
     C/COPY WNCPYSRC,CG4630C074
     C                     MOVELD#TAMT    ##D,3                           087994
     C/COPY WNCPYSRC,CG4630C075
     C                     MOVE A6NBDP    ##D,3                           087994
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C                     MOVELTRNAMT    ##D,3                           CFT006
     C                     MOVE A6NBDP    ##D,3                           CFT006
     C                     Z-ADDA6NBDP    WTRFT   20                      CFT006
     C           ##FILE    WHEQ 'FT102H '                                 CFT008
     C                     MOVELCCTAMT    ##D,3                           CFT008
     C                     MOVE A6NBDP    ##D,3                           CFT008
     C                     Z-ADDA6NBDP    WTCCT   20                      CFT008
     C                     ENDSL
      *                                                                   095577
      * Set up Dedit Date                                                 095577
      *                                                                   095577
     C                     SELEC                                          095577
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen095577
     C           ##FILE    OREQ 'OTPAY  '                  Outgoing Paymen095577
     C                     MOVELSLDT      ##D,4                           095577
     C                     MOVELSLDT      ##D,4                           095577
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques for Pai095577
     C                     MOVELDRVD      ##D,4                           095577
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for col095577
     C                     MOVELSLDT      ##D,4                           095577
     C           ##FILE    WHEQ 'FT101H '                                 CFT006
     C           ##FILE    OREQ 'FT102H '                                 CFT008
     C                     MOVELDBTVDT    ##D,4                           CFT006
     C                     ENDSL                                          095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@CC1    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CORDTA                                         *
      * Function    :  Correspondent data                             *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           CORDTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CORDTA'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\CORDTA' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Correspondent type.
     C                     MOVEL#TYPE     ##D,1
      *
      **  Customer.
     C                     MOVELW0CNUM    ##D,2
      *
      **  Customer name.
     C                     MOVELW0CRNM    ##D,3
      *
      **  Customer town.
     C                     MOVELW0RTWN    ##D,4
      *
      **  Account line.
     C                     MOVELW0ACLN    ##D,5
      *
      **  Retail account no.
     C                     MOVELW0ACNO    ##D,6
      *
      **  Midas account number.
     C                     CLEAR#RETLN
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRC1
     C/COPY WNCPYSRC,CG4630C020
     C***********          MOVEL#RETLN    ##D,5                           087995
     C                     MOVEL#RETLN    ##D,7                           087995
      *
      **  Account name.
     C                     MOVELW0ANAM    ##D,8
      *
      **  SWIFT ID.
     C                     MOVELW0CSID    ##D,9
      *
      **  Address line 1.
     C                     MOVELW#ADD1    ##D,10
      *
      **  Address line 2.
     C                     MOVELW#ADD2    ##D,11
      *
      **  Address line 3.
     C                     MOVELW#ADD3    ##D,12
      *
      **  Address line 4.
     C                     MOVELW#ADD4    ##D,13
      *
      **  Address line 5.
     C                     MOVELW#ADD5    ##D,14
      *                                                                   CPB001
      **  Portfolio Reference                                             CPB001
     C                     MOVE *BLANKS   ##D,15                          CPB001
      *                                                                   CPB001
     C           BGN4ST    IFEQ 'Y'                                       CPB001
      *                                                                   CPB001
     C           ##FILE    IFEQ 'OTPAY  '                                 CPB001
     C           ORC1      ANDNE*BLANKS                                   CPB001
     C           ##FILE    OREQ 'INPAY  '                                 CPB001
     C           BNC1      ANDNE*BLANKS                                   CPB001
     C                     MOVEL*BLANKS   KRACN                           CPB001
     C                     MOVEL*BLANKS   KCNUM                           CPB001
     C                     MOVEL*BLANKS   KCCY                            CPB001
     C                     MOVEL*BLANKS   KACOD                           CPB001
     C                     MOVEL*BLANKS   KACSQ                           CPB001
     C                     MOVEL*BLANKS   KBRCA                           CPB001
      *                                                                   CPB001
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           ORCT      IFEQ 'R'                                       CPB001
     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           10        SUBSTORC1:2    KRACN                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      KRACN                           CPB001
     C                     ENDIF                                                              CFT032
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C           ORCT      IFEQ 'P'                                       CPB001
     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           21        SUBSTORC1:2    WORC1                                               CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      WORC1                           CPB001
     C                     ENDIF                                                              CFT032
     C                     MOVELSMCY      KCCY                            CPB001
     C                     ENDIF                                          CPB001
      *                                                                                       CFT032
     C           ORCT      IFEQ 'I'                                                           CFT032
     C           ##FILE    ANDEQ'OTPAY  '                                                     CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           34        SUBSTORC1:2    WIBAN  34                                           CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      WIBAN                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     EXSR SRIBAN                                                        CFT032
     C                     ENDIF                                                              CFT032
      *                                                                   CPB001
     C           BNCT      IFEQ 'R'                                       CPB001
     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
     C                     MOVELBNC1      KRACN                           CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C           BNCT      IFEQ 'P'                                       CPB001
     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
     C                     MOVELBNC1      WORC1                           CPB001
     C                     MOVELSMCY      KCCY                            CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
      ** Get Account details                                              CPB001
     C           ORCT      IFEQ 'R'                                       CPB001
     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
     C           ORCT      OREQ 'P'                                       CPB001
     C           ##FILE    ANDEQ'OTPAY  '                                 CPB001
     C           BNCT      OREQ 'R'                                       CPB001
     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
     C           BNCT      OREQ 'P'                                       CPB001
     C           ##FILE    ANDEQ'INPAY  '                                 CPB001
     C                     CALL 'AOACCTR0'                                CPB001
     C                     PARM *BLANKS   WRTCD   7                       CPB001
     C                     PARM '*KEY    'WOPTN   7                       CPB001
     C                     PARM           KRACN  10                       CPB001
     C                     PARM           KCNUM   6                       CPB001
     C                     PARM           KCCY    3                       CPB001
     C**********           PARM           KACOD   4                                    CPB001 CGL029
     C                     PARM           KACOD  10                                           CGL029
     C                     PARM           KACSQ   2                       CPB001
     C                     PARM           KBRCA   3                       CPB001
     C           SDACCT    PARM SDACCT    DSSDY                           CPB001
      *                                                                   CPB001
     C                     MOVE PTFR      WPTFR   3                       CPB001
     C                     MOVELWPTFR     ##D,15                          CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CPB001
     C                     ENDIF                                          CPB001
      *                                                                                       CFT121
      **  CFT121 Flag                                                                         CFT121
      *                                                                                       CFT121
     C           CFT121    IFEQ 'Y'                                                           CFT121
     C                     MOVEL'Y'       ##D,16                                              CFT121
     C                     ENDIF                                                              CFT121
      *                                                                                       CFT120
      **  CFT120 Flag                                                                         CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'N'                                                           CFT120
     C                     MOVEL'N'       ##D,17                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVEL'Y'       ##D,17                                              CFT120
      *                                                                                       CFT120
      **  Charge to the Debit of Account Currency                                             CFT120
      *                                                                                       CFT120
     C                     SELEC                                                              CFT120
      *                                                                                       CFT120
      ** Incoming payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
     C           INCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    ##D,18                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELINCDRC    ##D,18                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Outgoing payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    ##D,18                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    ##D,18                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDSL                                                              CFT120
     C                     ENDIF                                                              CFT120
      *
     C/COPY WNCPYSRC,CG4630C010
      *................................................................
      *
     C           EXRDTA    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  RECEVR                                         *
      * Function    :  Receiver's Correspondant                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           RECEVR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'RECEVR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\RECEVR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C           CFT014    IFEQ 'Y'                                       192761
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C***********RCRT      ANDNE*BLANKS                            087995 CFT014
     C           INRCRT    ANDNE*BLANKS                                   CFT014
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for coll
     C           RCRT      ANDNE*BLANKS                                   087995
     C*
     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
     C                     MOVELINRCRT    WTYPE                           CFT014
     C                     MOVELINRCO1    WPTY                            CFT014
     C                     MOVELINRCO1    WPTY1                           CFT014
     C                     MOVELINRCO2    WPTY2                           CFT014
     C                     ELSE                                           CFT014
     C                     MOVE RCRT      WTYPE   1
     C**********           MOVELRCCO      WPTY   12                                           CGL029
     C                     MOVELRCCO      WPTY   18                                           CGL029
     C                     MOVELRCCO      WPTY1                           CFT014
     C                     ENDIF                                          CFT014
     C                     MOVE SMCY      WCCY    3
     C***********          MOVELRCCO      WPTY1                           CFT014
     C                     MOVEL*BLANKS   WBRCA   3
      *
     C                     EXSR SRTPSR
      *
      *
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C           SNCT      ANDNE*BLANKS                                   087995
     C                     MOVE SNCT      WTYPE
     C                     MOVELSNCO      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELSNCO      WPTY1
     C                     MOVEL*BLANKS   WBRCA
      *
     C                     EXSR SRTPSR
      *
      * If no data exit                                                   087995
      *                                                                   087995
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087995
     C           SNCT      ANDEQ*BLANKS                                   087995
     C           ##FILE    OREQ 'INPAY  '                  Incoming Paymen087995
     C***********RCRT      ANDEQ*BLANKS                            087995 CFT014
     C           INRCRT    ANDEQ*BLANKS                                   CFT014
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col087995
     C           RCRT      ANDEQ*BLANKS                                   087995
     C                     GOTO EXCEVR                                    087995
      *                                                                   087995
     C                     ENDSL
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C           *LIKE     DEFN RCRT      #TYPE
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C***********          MOVELRCRT      #TYPE                           CFT014
     C                     MOVELINRCRT    #TYPE                           CFT014
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C                     MOVELSNCT      #TYPE
     C                     ENDSL
     C                     ELSE                                           192761
     C                     SELEC                                          192761
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen192761
     C           RCRT      ANDNE*BLANKS                                   192761
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col192761
     C           RCRT      ANDNE*BLANKS                                   192761
     C*                                                                   192761
     C                     MOVE RCRT      WTYPE   1                       192761
     C**********           MOVELRCCO      WPTY   12                                    192761 CGL029
     C                     MOVELRCCO      WPTY   18                                           CGL029
     C                     MOVE SMCY      WCCY    3                       192761
     C                     MOVELRCCO      WPTY1                           192761
     C                     MOVEL*BLANKS   WBRCA   3                       192761
      *                                                                   192761
     C                     EXSR SRTPSR                                    192761
      *                                                                   192761
      *                                                                   192761
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
     C           SNCT      ANDNE*BLANKS                                   192761
     C                     MOVE SNCT      WTYPE                           192761
     C                     MOVELSNCO      WPTY                            192761
     C                     MOVE PCCY      WCCY                            192761
     C                     MOVELSNCO      WPTY1                           192761
     C                     MOVEL*BLANKS   WBRCA                           192761
      *                                                                   192761
     C                     EXSR SRTPSR                                    192761
      *                                                                   192761
      * If no data exit                                                   192761
      *                                                                   192761
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
     C           SNCT      ANDEQ*BLANKS                                   192761
     C           ##FILE    OREQ 'INPAY  '                  Incoming Paymen192761
     C           RCRT      ANDEQ*BLANKS                                   192761
     C           ##FILE    OREQ 'CQCOD  '                  Cheques for col192761
     C           RCRT      ANDEQ*BLANKS                                   192761
     C                     GOTO EXCEVR                                    192761
      *                                                                   192761
     C                     ENDSL                                          192761
      *                                                                   192761
      **  Information Type                                                192761
     C                     MOVE *BLANKS   #TYPE                           192761
     C                     SELEC                                          192761
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen192761
     C                     MOVELRCRT      #TYPE                           192761
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen192761
     C                     MOVELSNCT      #TYPE                           192761
     C                     ENDSL                                          192761
     C                     ENDIF                                          192761
     C***********          MOVELW0CSID    ##D,7
      *
     C                     MOVE *BLANKS   W#ADDR
      *                                                                   CFT014
     C           ##FILE    IFEQ 'INPAY   '                                CFT014
     C           INRCRT    ANDEQ'A'                                       CFT014
     C           CFT014    ANDEQ'Y'                                       CFT014
      *                                                                   CFT014
     C                     MOVELINRCO1    W#ADD1                          CFT014
     C                     MOVELINRCO2    W#ADD2                          CFT014
     C                     MOVELINRCO3    W#ADD3                          CFT014
     C                     MOVELINRCO4    W#ADD4                          CFT014
     C                     MOVELINRCO5    W#ADD5                          CFT014
      *                                                                   CFT014
     C                     ELSE                                           CFT014
      **  Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Address line 5
     C                     MOVE *BLANKS   W#ADD5
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *
     C/COPY WNCPYSRC,CG4630C011
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCEVR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SENDER                                         *
      * Function    :  Sender's Correspondant                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SENDER    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SENDER'  @STK,Q
      *
      *................................................................
      *
      * If no data exixt                                                  087995
      *                                                                   087995
     C           SNCT      IFEQ *BLANKS                                   087995
     C                     GOTO EXNDER                                    087995
     C                     ENDIF                                          087995
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\SENDER' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE SNCT      WTYPE
     C                     MOVELSNCO      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELSNCO      WPTY1
     C                     MOVEL*BLANKS   WBRCA
     C**************       MOVELCDBR      WBRCA1  3                             AR1096709 AR1096709A
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELSNCT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
      **  Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Address line 5
     C                     MOVE *BLANKS   W#ADD5
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
     C           EXNDER    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  O@INST                                         *
      * Function    :  Ordering Institution                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           O@INST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'O_INST'  @STK,Q
      *
      *................................................................
      *
      * If no data exixt                                                  087995
      *                                                                   087995
     C           ORBT      IFEQ *BLANKS                                   087995
     C                     GOTO EXINST                                    087995
     C                     ENDIF                                          087995
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\O_INST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C           ##FILE    IFEQ 'INPAY  '                  Incoming Payments
     C                     MOVE ORBT      WTYPE
     C                     MOVE SMCY      WCCY
     C                     MOVE *BLANKS   WBRCA
     C                     MOVELORB1      WPTY1                           087995
     C                     MOVELORB2      WPTY2                           087995
     C                     ENDIF
      *
     C           ##FILE    IFEQ 'OTPAY  '                  Outgoing Payments
     C                     MOVE ORBT      WTYPE
     C                     MOVELORBK      WPTY
     C                     MOVE SMCY      WCCY
     C                     MOVELORBK      WPTY1
     C                     MOVELORBB      WBRCA
     C                     ENDIF
      *
     C                     EXSR SRTPSR
      *
      **  Ordering Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELORBT      #TYPE
      *
      **  Ordering customer Address line 1
     C                     MOVE *BLANKS   W#ADDR
     C           ORBT      IFEQ 'A'                                       087995
     C                     MOVELORB1      W#ADD1
      *
      **  Ordering customer Address line 2
     C                     MOVELORB2      W#ADD2
      *
      **  Ordering customer Address line 3
     C                     MOVELORB3      W#ADD3
      *
      **  Ordering customer Address line 4
     C                     MOVELORB4      W#ADD4
      *
      **  Ordering customer Address line 5
     C                     MOVELORB5      W#ADD5
     C                     ELSE                                           087995
      **  Address line 1                                                  087995
     C                     MOVELCNA1      W#ADD1                          087995
      **  Address line 2                                                  087995
     C                     MOVELCNA2      W#ADD2                          087995
      *                                                                   087995
      **  Address line 3                                                  087995
     C                     MOVELCNA3      W#ADD3                          087995
      *                                                                   087995
      **  Address line 4                                                  087995
     C                     MOVELCNA4      W#ADD4                          087995
      *                                                                   087995
      **  Address line 5                                                  087995
     C                     MOVE *BLANKS   W#ADD5                          087995
     C                     ENDIF                                          087995
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
     C           EXINST    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  O@CUST                                         *
      * Function    :  Ordering Customer Details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           O@CUST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'O_CUST'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\O_CUST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********ORCT      IFNE 'A'                        B1             087995
     C*
     C                     MOVE ORCT      WTYPE
      *                                                                                       CFT032
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           18        SUBSTORC1:2    WPTY                                                CFT032
     C           ORCT      IFEQ 'R'                                                           CFT032
     C           ORCT      OREQ 'P'                                                           CFT032
     C           ORCT      OREQ 'I'                                                         BUG15105
     C           34        SUBSTORC1:2    WPTY1     P                                         CFT032
     C                     ELSE                                                               CFT032
     C**********           MOVELORC1      WPTY1                                      CFT032 BUg15105
     C                     MOVELORC2      WPTY1                                             BUG15105
     C                     ENDIF                                                              CFT032
     C                     ELSE                                                               CFT032
      *                                                                                       CFT032
     C                     MOVELORC1      WPTY
     C                     MOVELORC1      WPTY1                                               CFT032
     C                     ENDIF                                                              CFT032
     C                     MOVE SMCY      WCCY
     C**********           MOVELORC1      WPTY1                                               CFT032
     C                     MOVELORC2      WPTY2
     C                     MOVEL*BLANKS   WBRCA
     C                     EXSR SRTPSR
     C***********          ENDIF                           E1             087995
      *
      **  Ordering Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELORCT      #TYPE
     C                     MOVE *BLANKS   W#ADDR
      *
      ***********                                                         087995
     C***********          SELEC                                          087995
     C***********##FILE    WHEQ 'INPAY  '                  Incoming PaymentsBXXX
      ***********                                                         087995
      ****Ordering customer Address line 1                                087995
     C***********          MOVELORC1      W#ADD1                          087995
      ***********                                                         087995
      ****Ordering customer Address line 2                                087995
     C***********          MOVELORC2      W#ADD2                          087995
      ***********                                                         087995
      ****Ordering customer Address line 3                                087995
     C***********          MOVELORC3      W#ADD3                          087995
      ***********                                                         087995
      ****Ordering customer Address line 4                                087995
     C***********          MOVELORC4      W#ADD4                          087995
      ***********                                                         087995
     C***********##FILE    WHEQ 'OTPAY  '                  Incoming PaymentsBXXX
     C***********ORCT      IFNE 'A'                                       087995
      ***********                                                         087995
      ****Ordering customer Address line 1                                087995
     C***********          MOVELBNC1      W#ADD1                          087995
      ***********                                                         087995
      ****Ordering customer Address line 2                                087995
     C***********          MOVELBNC2      W#ADD2                          087995
      ***********                                                         087995
      ****Ordering customer Address line 3                                087995
     C***********          MOVELBNC3      W#ADD3                          087995
      ***********                                                         087995
      ****Ordering customer Address line 4                                087995
     C***********          MOVELBNC4      W#ADD4                          087995
      ***********                                                         087995
     C***********          ELSE                                           087995
      ***********                                                         087995
      ****Ordering customer Address line 1                                087995
     C***********          MOVELORC1      W#ADD1                          087995
      ***********                                                         087995
      ****Ordering customer Address line 2                                087995
     C***********          MOVELORC2      W#ADD2                          087995
      ***********                                                         087995
      ****Ordering customer Address line 3                                087995
     C***********          MOVELORC3      W#ADD3                          087995
      ***********                                                         087995
      ****Ordering customer Address line 4                                087995
     C***********          MOVELORC4      W#ADD4                          087995
     C***********          ENDIF                                          087995
      ***********                                                         087995
     C***********          ENDSL                                          087995
     C           ORCT      IFEQ 'A'                        B1             087995
      *   Ordering customer Address line 1                                087995
     C                     MOVELORC1      W#ADD1                          087995
      *                                                                   087995
      *   Ordering customer Address line 2                                087995
     C                     MOVELORC2      W#ADD2                          087995
      *                                                                   087995
      *   Ordering customer Address line 3                                087995
     C                     MOVELORC3      W#ADD3                          087995
      *                                                                   087995
      *   Ordering customer Address line 4                                087995
     C                     MOVELORC4      W#ADD4                          087995
      *                                                                                       CFT032
      **  Ordering customer Address line 5                                                    CFT032
     C                     MOVELORC5      W#ADD5                                              CFT032
     C                     ELSE                                           087995
      **  Address line 1                                                  087995
     C                     MOVELCNA1      W#ADD1                          087995
      **  Address line 2                                                  087995
     C                     MOVELCNA2      W#ADD2                          087995
      *                                                                   087995
      **  Address line 3                                                  087995
     C                     MOVELCNA3      W#ADD3                          087995
      *                                                                   087995
      **  Address line 4                                                  087995
     C                     MOVELCNA4      W#ADD4                          087995
      *                                                                   087995
      **  Address line 5                                                  087995
     C                     MOVE *BLANKS   W#ADD5                          087995
     C                     ENDIF                                          087995
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCUST    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  AC@W@B                                         *
      * Function    :  Account with Bank details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           AC@W@B    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'AC_W_B'  @STK,Q
      *
      *................................................................
      *
      * If no data exixt                                                  087995
      *                                                                   087995
     C           ACBT      IFEQ *BLANKS                                   087995
     C           ##FILE    ANDNE'OTPAY'                                   096419
     C                     GOTO EX@W@B                                    087995
     C                     ENDIF                                          087995
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\AC_W_B' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********ACBK      IFNE *BLANKS                                   087995
     C                     SELEC                                          087995
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Paymen087995
     C                     MOVE ACBT      WTYPE
     C                     MOVELACBK      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELACBK      WPTY1
     C                     MOVELACBB      WBRCA
      *                                                                   087995
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Paymen087995
      *                                                                   096419
      * If Account with bank not used then use destination                096419
      *                                                                   096419
     C           ACBT      IFNE *BLANKS                                   096419
     C                     MOVE ACBT      WTYPE                           087995
     C                     MOVELACBK      WPTY                            087995
     C                     MOVE PCCY      WCCY                            087995
     C                     MOVELACB1      WPTY1                           087995
     C                     MOVELACB2      WPTY2                           087995
     C                     MOVEL*BLANKS   WBRCA                           087995
      *                                                                   096419
     C                     ELSE                                           096419
     C                     MOVELDSTT      WTYPE                           087995
     C                     MOVE PCCY      WCCY                            087995
     C                     MOVELDST1      WPTY1                           087995
     C                     MOVELDST2      WPTY2                           087995
     C                     MOVEL*BLANKS   WBRCA                           087995
     C                     ENDIF                                          096419
      *                                                                   096419
     C                     ENDSL                                          087995
     C***********          ELSE                                           087995
     C***********BNCT      IFNE 'A'                                       087995
     C***********##FILE    ANDEQ'INPAY  '                  Incoming PaymentsBXXX
     C***********          MOVE BNCT      WTYPE                           087995
     C***********          MOVELBNC1      WPTY                            087995
     C***********          MOVE PCCY      WCCY                            087995
     C***********          MOVELBNC1      WPTY1                           S01435
     C***********          MOVELBNC2      WPTY2                           S01435
     C***********          MOVEL*BLANKS   WBRCA                           S01435
     C***********          ENDIF                                          087995
     C***********          ENDIF                                          087995
      *
     C                     EXSR SRTPSR
      *
      **  Account with bank Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELACBT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
      **  Account with bank Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Account with bank Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Account with bank Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Account with bank Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Account with bank Address line 5
     C                     MOVE *BLANKS   W#ADD5
      *
     C           ##FILE    WHEQ 'OTPAY  '                              ments
     C***********ACBT      ANDEQ'A'                                 087995089214
      *                                                                   096419
      * If Account with bank not used then use destination                096419
      *                                                                   096419
     C                     SELEC                                          096419
     C           ACBT      WHEQ 'A'                                       096419
     C***********ACBT      IFEQ 'A'                                 089214096419
      **  Account with bank Address line 1
     C                     MOVELACB1      W#ADD1
      **  Account with bank Address line 2
     C                     MOVELACB2      W#ADD2
      *
      **  Account with bank Address line 3
     C                     MOVELACB3      W#ADD3
      *
      **  Account with bank Address line 4
     C                     MOVELACB4      W#ADD4
      *
      **  Account with bank Address line 5
     C***********          MOVE *BLANKS   W#ADD5                          089214
     C                     MOVELACB5      W#ADD5                          089214
      *
      *   Fill with destination details if an address                     096419
     C           DSTT      WHEQ 'A'                                       096419
     C           ACBT      ANDEQ*BLANKS                                   096419
      **  Destination Address line 1                                      096419
     C                     MOVELDST1      W#ADD1                          096419
      **  Destination Address line 2                                      096419
     C                     MOVELDST2      W#ADD2                          096419
      *                                                                   096419
      **  Destination Address line 3                                      096419
     C                     MOVELDST3      W#ADD3                          096419
      *                                                                   096419
      **  Destination Address line 4                                      096419
     C                     MOVELDST4      W#ADD4                          096419
      *                                                                   096419
      **  Balnaks in Address line 5                                       096419
     C                     MOVE *BLANKS   W#ADD5                          096419
     C                     OTHER                                          096419
     C**********           ELSE                                     089214096419
     C**  Account with bankEAddress line 1                                089214
     C                     MOVELCNA1      W#ADD1                          089214
     C**  Account with bankEAddress line 2                                089214
     C                     MOVELCNA2      W#ADD2                          089214
     C*                                                                   089214
     C**  Account with bankEAddress line 3                                089214
     C                     MOVELCNA3      W#ADD3                          089214
     C*                                                                   089214
     C**  Account with bankEAddress line 4                                089214
     C                     MOVELCNA4      W#ADD4                          089214
     C*                                                                   089214
     C**  Account with bankEAddress line 5                                089214
     C                     MOVELCNA5      W#ADD5                          089214
     C                     ENDSL                                          096419
     C*********            ENDIF                                    089214096419
     C                     ENDSL
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
     C           EX@W@B    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BENEF                                          *
      * Function    :  Beneficiary Details                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BENEF     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BENEF '  @STK,Q
      *
      *................................................................
      *
      * If no data exixt                                                  087995
      *                                                                   087995
     C           BNCT      IFEQ *BLANKS                                   087995
     C                     GOTO EXNEF                                     087995
     C                     ENDIF                                          087995
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BENEF ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********BNCT      IFNE 'A'                                       087995
      *
     C                     MOVE BNCT      WTYPE
     C                     MOVE PCCY      WCCY
     C                     MOVELBNC1      WPTY1                           087995
     C                     MOVELBNC2      WPTY2                           087995
     C                     MOVEL*BLANKS   WBRCA
      *
     C                     EXSR SRTPSR
     C***********          ENDIF                                          087995
      *
      **  Beneficiary Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELBNCT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
     C           BNCT      IFEQ 'A'                                       087995
      **  Beneficiary Address line 1
     C                     MOVELBNC1      W#ADD1
      **  Beneficiary Address line 2
     C                     MOVELBNC2      W#ADD2
      *
      **  Beneficiary Address line 3
     C                     MOVELBNC3      W#ADD3
      *
      **  Beneficiary Address line 4
     C                     MOVELBNC4      W#ADD4
      *
      **  Beneficiary Address line 5
     C                     MOVELBNC5      W#ADD5
     C                     ELSE                                           087995
      **  Address line 1                                                  087995
     C                     MOVELCNA1      W#ADD1                          087995
      **  Address line 2                                                  087995
     C                     MOVELCNA2      W#ADD2                          087995
      *                                                                   087995
      **  Address line 3                                                  087995
     C                     MOVELCNA3      W#ADD3                          087995
      *                                                                   087995
      **  Address line 4                                                  087995
     C                     MOVELCNA4      W#ADD4                          087995
      *                                                                   087995
      **  Address line 5                                                  087995
     C                     MOVE *BLANKS   W#ADD5                          087995
     C                     ENDIF                                          087995
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
     C           EXNEF     TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAYDET                                         *
      * Function    :  Details of Payment                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAYDET    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAYDET'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAYDET' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Details of payment - 1
     C                     MOVELDTP1      ##D,1
      *
      **  Details of payment - 2
     C                     MOVELDTP2      ##D,2
      *
      **  Details of payment - 3
     C                     MOVELDTP3      ##D,3
      *
      **  Details of payment - 4
     C                     MOVELDTP4      ##D,4
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXYDET    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CG@DAC                                         *
      * Function    :  Charges to the debit of                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CG@DAC    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CG_DAC'  @STK,Q
      *
      *................................................................
      *
      * If no data exixt                                                  087995
      *                                                                   087995
     C           CDRT      IFEQ *BLANKS                                   087995
     C                     GOTO EX@DAC                                    087995
     C                     ENDIF                                          087995
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CG_DAC' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE CDRT      WTYPE   1
     C**********           MOVELCDRO      WPTY   12                                           CGL029
     C                     MOVELCDRO      WPTY   18                                           CGL029
     C           CFT120    IFEQ 'N'                                                        AR1096097
     C                     MOVE SMCY      WCCY    3
     C                     ELSE                                                            AR1096097
     C                     SELEC                                                           AR1096097
     C           ##FILE    WHEQ 'INPAY  '                                                  AR1096097
     C                     MOVE INCDRC    WCCY                                             AR1096097
     C           ##FILE    WHEQ 'OTPAY  '                                                  AR1096097
     C                     MOVE OPCDRC    WCCY                                             AR1096097
     C                     ENDSL                                                           AR1096097
     C                     ENDIF                                                           AR1096097
     C                     MOVELCDRO      WPTY1                                               203663
     C                     MOVEL*BLANKS   WBRCA   3
     C                     MOVELCDBR      WBRCA1  3                                       AR1096709A
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELCDRT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
      **  Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Address line 5
     C                     MOVEL*BLANKS   W#ADD5
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      *................................................................
      *
     C           EX@DAC    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/COPY WNCPYSRC,CG4630C017
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  REMIT                                          *
      * Function    :  Remitting Party                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           REMIT     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'REMIT '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\REMIT ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********RBKT      IFNE 'A'                                       087995
      *
     C                     MOVE RBKT      WTYPE
     C                     MOVELRBK1      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELRBK1      WPTY1
     C                     MOVELRBK2      WPTY2
     C                     MOVEL*BLANKS   WBRCA
      *
     C                     EXSR SRTPSR
      *
     C***********          ENDIF                                          087995
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELRBKT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
     C           RBKT      IFEQ 'A'                                       087995
      **  Address line 1
     C                     MOVELRBK1      W#ADD1
      **  Address line 2
     C                     MOVELRBK2      W#ADD2
      *
      **  Address line 3
     C                     MOVELRBK3      W#ADD3
      *
      **  Address line 4
     C                     MOVELRBK4      W#ADD4
      *
      **  Address line 5
     C                     MOVE *BLANKS   W#ADD5
     C                     ELSE                                           087995
      **  Address line 1                                                  087995
     C                     MOVELCNA1      W#ADD1                          087995
      **  Address line 2                                                  087995
     C                     MOVELCNA2      W#ADD2                          087995
      *                                                                   087995
      **  Address line 3                                                  087995
     C                     MOVELCNA3      W#ADD3                          087995
      *                                                                   087995
      **  Address line 4                                                  087995
     C                     MOVELCNA4      W#ADD4                          087995
      *                                                                   087995
      **  Address line 5                                                  087995
     C                     MOVE CNA5      W#ADD5                          087995
     C                     ENDIF                                          087995
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXMIT     TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DR@PTY                                         *
      * Function    :  Debit Party                                    *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           DR@PTY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DR@PTY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\DR_PTY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE DRPT      WTYPE
     C                     MOVELDRPY      WPTY
     C                     MOVE DRCY      WCCY
     C                     MOVELDRPY      WPTY1
     C                     MOVELDRBR      WBRCA
      *
     C                     EXSR SRTPSR
      *
      **  Debit Party Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELDRPT      #TYPE
      *
     C                     MOVE *BLANKS   W#ADDR
      **  Debit Party Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Debit Party Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Debit Party Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Debit Party Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Debit Party Address line 5
     C                     MOVE *BLANKS   W#ADD5
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@PTY    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  C@INST                                         *
      * Function    :  Collecting Institution                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           C@INST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'C@INST'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\C_INST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C***********COBT      IFNE 'A'                                       087995
     C*
     C                     MOVE COBT      WTYPE   1
     C**********           MOVELCOB1      WPTY   12                                           CGL029
     C                     MOVELCOB1      WPTY   18                                           CGL029
     C                     MOVE SMCY      WCCY    3
     C                     MOVELCOB1      WPTY1
     C                     MOVELCOB2      WPTY2
     C                     MOVEL*BLANKS   WBRCA   3
      *
     C                     EXSR SRTPSR
      *
     C***********          ENDIF                                          087995
      *
      **  Collecting Inst. Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELCOBT      #TYPE
     C                     MOVE *BLANKS   W#ADDR
     C           COBT      IFEQ 'A'                                       087995
      **  Collecting Inst. Address line 1
     C                     MOVELCOB1      W#ADD1
      **  Collecting Inst. Address line 2
     C                     MOVELCOB2      W#ADD2
      *
      **  Collecting Inst. Address line 3
     C                     MOVELCOB3      W#ADD3
      *
      **  Collecting Inst. Address line 4
     C                     MOVELCOB4      W#ADD4
     C                     ELSE                                           087995
      **  Address line 1                                                  087995
     C                     MOVELCNA1      W#ADD1                          087995
      **  Address line 2                                                  087995
     C                     MOVELCNA2      W#ADD2                          087995
      *                                                                   087995
      **  Address line 3                                                  087995
     C                     MOVELCNA3      W#ADD3                          087995
      *                                                                   087995
      **  Address line 4                                                  087995
     C                     MOVELCNA4      W#ADD4                          087995
      *                                                                   087995
      **  Address line 5                                                  087995
     C                     MOVE CNA5      W#ADD5                          087995
     C                     ENDIF                                          087995
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXINS1    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CR@PTY                                         *
      * Function    :  Credit Party                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CR@PTY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CR@PTY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CR_PTY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE CRPT      WTYPE
     C                     MOVELCRPY      WPTY
     C                     MOVE CRCY      WCCY
     C                     MOVELCRPY      WPTY1
     C                     MOVELCRBR      WBRCA
      *
     C                     EXSR SRTPSR
      *
      **  Credit party  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELCRPT      ##D,1
      *
     C                     MOVE *BLANKS   W#ADDR
      **  Credit Party Address line 1
     C                     MOVELCNA1      W#ADD1
      **  Credit Party Address line 2
     C                     MOVELCNA2      W#ADD2
      *
      **  Credit Party Address line 3
     C                     MOVELCNA3      W#ADD3
      *
      **  Credit Party Address line 4
     C                     MOVELCNA4      W#ADD4
      *
      **  Credit Party Address line 4
     C                     MOVE *BLANKS   W#ADD5
      *                                                                   087994
     C                     EXSR CORDTA                                    087994
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@PT1    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  NARR                                           *
      * Function    :  Narrative                                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           NARR      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'NARR  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\NARR  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
      *
     C                     EXSR SRRRDE
      *
      ** Narrative field - 1
     C                     MOVELNAR1      ##D,1
      *
      ** Narrative field - 2
     C                     MOVELNAR2      ##D,2
      *
      ** Narrative field - 3
     C                     MOVELNAR3      ##D,3
      *
      ** Narrative field - 4
     C                     MOVELNAR4      ##D,4
      *
      ** Narrative field - 5
     C                     MOVELNAR5      ##D,5
      *
      ** Narrative field - 6
     C                     MOVELNAR6      ##D,6
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXRR      TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  FT@DLV                                         *   CEU006
      * Function    :  Funds Transfer Delivery Details                *   CEU006
      *                                                               *   CEU006
      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
      * Calls       :                                                 *   CEU006
      *****************************************************************   CEU006
     C           FT@DLV    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'FT_DLV'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Retrieve subroutine specific data.                              CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\FT_DLV' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      **  Notified Delivery Currency                                      CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           NDCY      WHEQ *BLANKS                                   CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVEL*BLANKS   ##D,1                           CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
      *                                                                   CEU006
     C           CFT014    IFEQ 'Y'                                       192761
     C                     MOVE *BLANK    WNINCY  1                       CFT014
     C                     Z-ADD0         WNTPSD  50                      CFT014
     C                     ENDIF                                          192761
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM NDCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELNDCY      W0KEY            ***************CEU006
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ELSE                                           CFT014
     C           CFT014    IFEQ 'Y'                                       192761
     C                     MOVE A6INCY    WNINCY                          CFT014
     C                     Z-ADDA6TPSD    WNTPSD                          CFT014
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          192761
     C/COPY WNCPYSRC,CG4630C076
      *                                                                   CFT014
      ** Access Settlement Currency's details                             CFT014
     C           CFT014    IFEQ 'Y'                                       192761
     C                     MOVE *BLANK    WSINCY  1                       CFT014
     C                     Z-ADD0         WSTPSD  50                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
     C                     MOVE SMCY      P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVE A6INCY    WSINCY                          CFT014
     C                     Z-ADDA6TPSD    WSTPSD                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CEU006
      ** If CFT014 and Incoming payment,                                  CFT014
      ** output only if both of them involve Euro currencies              CFT014
     C           CFT014    IFEQ 'N'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'CQPAC  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
     C           WNINCY    ANDEQ'Y'                                       CFT014
     C           WNTPSD    ANDLESLDT                                      CFT014
     C           SMCY      ANDEQBKEURO                                    CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
     C           WSINCY    ANDEQ'Y'                                       CFT014
     C           WSTPSD    ANDLESLDT                                      CFT014
     C           NDCY      ANDEQBKEURO                                    CFT014
     C                     MOVELNDCY      ##D,1                           CEU006
     C                     ENDIF                                          CFT014
     C                     ELSE                                           192761
     C                     MOVELNDCY      ##D,1                           192761
     C                     ENDIF                                          192761
      *                                                                   CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Notified Delivery Amount                                        CEU006
     C                     SELEC                                          CEU006
     C           NDCY      WHEQ *BLANKS                                   CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVEL*BLANKS   ##D,2                           CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
     C           CFT014    IFEQ 'Y'                                       192761
      ** If CFT014, output only if both of them involve Euro currencies   CFT014
     C           CFT014    IFEQ 'N'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'CQPAC  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
     C           WNINCY    ANDEQ'Y'                                       CFT014
     C           WNTPSD    ANDLESLDT                                      CFT014
     C           SMCY      ANDEQBKEURO                                    CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'INPAY  '                                 CFT014
     C           WSINCY    ANDEQ'Y'                                       CFT014
     C           WSTPSD    ANDLESLDT                                      CFT014
     C           NDCY      ANDEQBKEURO                                    CFT014
     C                     MOVELNDAM      ##D,2                           CEU006
     C/COPY WNCPYSRC,CG4630C077
     C                     MOVE A6NBDP    ##D,2                           CEU006
     C                     ENDIF                                          CFT014
     C                     ELSE                                           192761
     C                     MOVELNDAM      ##D,2                           192761
     C                     MOVE A6NBDP    ##D,2                           192761
     C                     ENDIF                                          192761
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Pay Delivery Currency                                           CEU006
     C                     SELEC                                          CEU006
     C           PDCY      WHEQ *BLANKS                                   CEU006
     C           ##FILE    OREQ 'INPAY  '                                 CEU006
     C***********##FILE    OREQ 'CQPAC  '                           CEU006152149
     C                     MOVEL*BLANKS   ##D,3                           CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 152149
      *                                                                   CEU006
     C           CFT014    IFEQ 'Y'                                       192761
     C                     MOVE *BLANK    WNINCY                          CFT014
     C                     Z-ADD0         WNTPSD                          CFT014
     C                     ENDIF                                          192761
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM PDCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELPDCY      W0KEY            ***************CEU006
     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ELSE                                           CFT014
     C           CFT014    IFEQ 'Y'                                       192761
     C                     MOVE A6INCY    WNINCY                          CFT014
     C                     Z-ADDA6TPSD    WNTPSD                          CFT014
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          192761
     C/COPY WNCPYSRC,CG4630C078
      *                                                                   CFT014
     C           CFT014    IFEQ 'Y'                                       192761
      ** Access Pay Currency's details                                    CFT014
     C                     MOVE *BLANK    WPINCY  1                       CFT014
     C                     Z-ADD0         WPTPSD  50                      CFT014
     C           CFT014    IFEQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C                     MOVE PCCY      P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVE A6INCY    WPINCY                          CFT014
     C                     Z-ADDA6TPSD    WPTPSD                          CFT014
     C                     ENDIF                                          CFT014
     C                     ENDIF                                          192761
      *                                                                   CEU006
      ** If CFT014, output only if both of them involve Euro currencies   CFT014
     C           CFT014    IFEQ 'Y'                                       192761
     C           CFT014    IFEQ 'N'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'CQCOD  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           WNINCY    ANDEQ'Y'                                       CFT014
     C           WNTPSD    ANDLEPVDT                                      CFT014
     C           PCCY      ANDEQBKEURO                                    CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           WPINCY    ANDEQ'Y'                                       CFT014
     C           WPTPSD    ANDLEPVDT                                      CFT014
     C           PDCY      ANDEQBKEURO                                    CFT014
     C                     MOVELPDCY      ##D,3                           CEU006
     C                     ENDIF                                          CFT014
     C                     ELSE                                           192761
     C                     MOVELPDCY      ##D,3                           192761
     C                     ENDIF                                          192761
      *                                                                   CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Pay Delivery Amount                                             CEU006
     C                     SELEC                                          CEU006
     C           PDCY      WHEQ *BLANKS                                   CEU006
     C           ##FILE    OREQ 'INPAY  '                                 CEU006
     C***********##FILE    OREQ 'CQPAC  '                           CEU006152149
     C                     MOVEL*BLANKS   ##D,4                           CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 152149
     C           CFT014    IFEQ 'Y'                                       192761
      ** If CFT014, output only if both of them involve Euro currencies   CFT014
     C           CFT014    IFEQ 'N'                                       CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'CQCOD  '                                 CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           WNINCY    ANDEQ'Y'                                       CFT014
     C           WNTPSD    ANDLEPVDT                                      CFT014
     C           PCCY      ANDEQBKEURO                                    CFT014
     C           CFT014    OREQ 'Y'                                       CFT014
     C           ##FILE    ANDEQ'OTPAY  '                                 CFT014
     C           WPINCY    ANDEQ'Y'                                       CFT014
     C           WPTPSD    ANDLEPVDT                                      CFT014
     C           PDCY      ANDEQBKEURO                                    CFT014
     C                     MOVELPDAM      ##D,4                           CEU006
     C/COPY WNCPYSRC,CG4630C079
     C                     MOVE A6NBDP    ##D,4                           CEU006
     C                     ENDIF                                          CFT014
     C                     ELSE                                           192761
     C                     MOVELPDAM      ##D,4                           192761
     C                     MOVE A6NBDP    ##D,4                           192761
     C                     ENDIF                                          192761
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4630C098
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@DLV    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  CHGENT                                         *   CEU006
      * Function    :  Entered Charges                                *   CEU006
      *                                                               *   CEU006
      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
      * Calls       :  EURAMT                                         *   CEU006
      *****************************************************************   CEU006
     C           CHGENT    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'CHGENT'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Retrieve subroutine specific data.                              CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\CHGENT' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      **  Entered Currency                                                CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN SLDT      W#DATE                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C                     SELEC                                          CEU006
     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      WHNE *BLANKS                                                     BUG11679
     C           CFT120    ANDEQ'Y'                                                           CFT120
      *                                                                                       CFT120
      ** Incoming Payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    IFEQ 'INPAY  '                                                     CFT120
     C           INCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELINCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Outgoing Payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    IFEQ 'OTPAY  '                                                     CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C           CDRO      WHNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'N'                                                           CFT120
     C********** BTCHCY    OREQ 'B'                                                 CEU006 AR1082119
     C           BTCHCY    OREQ 'B'                                                       AR1082119A
     C**********           SELEC                                                AR1082119 AR1082119A
     C********** BTCHCY    WHEQ 'B'                                             AR1082119 AR1082119A
     C                     MOVELBJCYCD    #CCY                            CEU006
     C           BTCHCY    WHEQ 'L'                                       CEU006
     C                     MOVELBJLCCY    #CCY                            CEU006
     C           BTCHCY    WHEQ 'C'                                       CEU006
     C           ADDC      ANDEQ'A'                                       CEU006
     C                     MOVELSMCY      #CCY                            CEU006
     C********** BTCHCY    WHEQ 'C'                                             AR1082119 AR1082119A
     C********** ADDC      ANDEQ'D'                                             AR1082119 AR1082119A
     C**********           OTHER                                                    CEU006 AR1082119
     C**********           MOVELPCCY      #CCY                                     CEU006 AR1082119A
     C           BTCHCY    WHEQ 'F'                                                        AR1082119
     C                     MOVELFCHCCY    #CCY                                             AR1082119
     C                     OTHER                                                          AR1082119A
     C                     MOVELPCCY      #CCY                                            AR1082119A
     C**********           ENDSL                                                AR1082119 AR1082119A
     C                     ENDSL                                          CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     Z-ADDSLDT      W#DATE                          CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADDPVDT      W#DATE                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     SELEC                                          CEU006
     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      WHNE *BLANKS                                                     BUG11679
     C           CFT120    ANDEQ'N'                                                           CFT120
     C           BTCHCY    OREQ 'B'                                       CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C           BTCHCY    WHEQ 'L'                                       CEU006
     C                     MOVE BJLCCY    #CCY                            CEU006
     C           BTCHCY    WHEQ 'C'                                       CEU006
     C                     MOVE DRCY      #CCY                            CEU006
     C                     ENDSL                                          CEU006
     C                     Z-ADDDRVD      W#DATE                          CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     SELEC                                          CEU006
     C********** CDRO      WHNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      WHNE *BLANKS                                                     BUG11679
     C           BTCHCY    OREQ 'B'                                       CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C           BTCHCY    WHEQ 'L'                                       CEU006
     C                     MOVE BJLCCY    #CCY                            CEU006
     C           BTCHCY    WHEQ 'C'                                       CEU006
     C                     MOVE CRCY      #CCY                            CEU006
     C                     ENDSL                                          CEU006
     C                     Z-ADDCRVD      W#DATE                          CEU006
      *                                                                   CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM #CCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD19        W0ERNB           * DB ERROR 19 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4630C080
      *                                                                   CEU006
      ** save entry currency as #ENTCY and In Ccy Indicator as #ENTIN     CEU006
      ** for use in subroutine CHGEUR.                                    CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      #ENTCY  3                       CEU006
     C                     MOVELA6INCY    #ENTIN  1                       CEU006
     C           A6TPSD    IFGT W#DATE                                    CEU006
     C                     MOVE 'N'       #ENTIN                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      ##D,1                           CEU006
      *                                                                   CEU006
      **  Entered Transfer Commission                                     CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN TRCH      #ENTTF                          CEU006
     C                     Z-ADD0         #ENTTF                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     Z-ADDDUMA1     #ENTTF                          CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDTRCH      #ENTTF                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#ENTTF    ##D,2                           CEU006
     C/COPY WNCPYSRC,CG4630C081
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Entered FX/Charge Commission                                    CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN PDCHCH    #ENTFX                          CEU006
     C                     Z-ADD0         #ENTFX                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     Z-ADDINDUM7    #ENTFX                          CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C                     Z-ADDOPDUM7    #ENTFX                          CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDPDCHCH    #ENTFX                          CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     Z-ADDCCDUM5    #ENTFX                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#ENTFX    ##D,3                           CEU006
     C/COPY WNCPYSRC,CG4630C082
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Entered Telex Charge                                            CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA2     #ENTTX                          CEU006
     C                     Z-ADD0         #ENTTX                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     Z-ADDDUMA2     #ENTTX                          CEU006
     C                     MOVELDUMA2     ##D,4                           CEU006
     C/COPY WNCPYSRC,CG4630C083
     C                     MOVE A6NBDP    ##D,4                           CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     MOVE *BLANKS   ##D,4                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Cheque Charge                                           CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA3     #ENTCQ                          CEU006
     C                     Z-ADD0         #ENTCQ                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C                     Z-ADDDUMA3     #ENTCQ                          CEU006
     C                     MOVELDUMA3     ##D,5                           CEU006
     C/COPY WNCPYSRC,CG4630C084
     C                     MOVE A6NBDP    ##D,5                           CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVEL*BLANKS   ##D,5                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Costs Abroad                                            CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN CSTH      #ENTCS                          CEU006
     C                     Z-ADD0         #ENTCS                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     MOVE *BLANKS   ##D,6                           CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C                     Z-ADDDUMA4     #ENTCS                          CEU006
     C                     MOVELDUMA4     ##D,6                           CEU006
     C/COPY WNCPYSRC,CG4630C085
     C                     MOVE A6NBDP    ##D,6                           CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDCSTH      #ENTCS                          CEU006
     C                     MOVELCSTH      ##D,6                           CEU006
     C/COPY WNCPYSRC,CG4630C086
     C                     MOVE A6NBDP    ##D,6                           CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     Z-ADDDUMA3     #ENTCS                          CEU006
     C                     MOVELDUMA3     ##D,6                           CEU006
     C/COPY WNCPYSRC,CG4630C087
     C                     MOVE A6NBDP    ##D,6                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered SWIFT Charge                                            CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA5     #ENTSW                          CEU006
     C                     Z-ADD0         #ENTSW                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVE *BLANKS   ##D,7                           CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C                     Z-ADDDUMA5     #ENTSW                          CEU006
     C                     MOVELDUMA5     ##D,7                           CEU006
     C/COPY WNCPYSRC,CG4630C088
     C                     MOVE A6NBDP    ##D,7                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Collection Charge                                       CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN COLH      #ENTCL                          CEU006
     C                     Z-ADD0         #ENTCL                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C                     MOVE *BLANKS   ##D,8                           CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDCOLH      #ENTCL                          CEU006
     C                     MOVELCOLH      ##D,8                           CEU006
     C/COPY WNCPYSRC,CG4630C089
     C                     MOVE A6NBDP    ##D,8                           CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     Z-ADDDUMA4     #ENTCL                          CEU006
     C                     MOVELDUMA4     ##D,8                           CEU006
     C/COPY WNCPYSRC,CG4630C090
     C                     MOVE A6NBDP    ##D,8                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Telephone Charge                                        CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA5     #ENTTP                          CEU006
     C                     Z-ADD0         #ENTTP                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     Z-ADDDUMA5     #ENTTP                          CEU006
     C                     MOVELDUMA5     ##D,9                           CEU006
     C/COPY WNCPYSRC,CG4630C091
     C                     MOVE A6NBDP    ##D,9                           CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVE *BLANKS   ##D,9                           CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Advice Charge                                           CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA4     #ENTAD                          CEU006
     C                     Z-ADD0         #ENTAD                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     Z-ADDDUMA4     #ENTAD                          CEU006
     C                     MOVELDUMA4     ##D,10                          CEU006
     C/COPY WNCPYSRC,CG4630C092
     C                     MOVE A6NBDP    ##D,10                          CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C           ##FILE    OREQ 'CQPAC  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVE *BLANKS   ##D,10                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered Miscellaneous Charge                                    CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN DUMA6     #ENTMS                          CEU006
     C                     Z-ADD0         #ENTMS                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C                     Z-ADDDUMA6     #ENTMS                          CEU006
     C                     MOVELDUMA6     ##D,11                          CEU006
     C/COPY WNCPYSRC,CG4630C093
     C                     MOVE A6NBDP    ##D,11                          CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C           ##FILE    OREQ 'CQCOD  '                                 CEU006
     C                     MOVE *BLANKS   ##D,11                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Entered VAT Amount                                              CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN PDVATH    #ENTVT                          CEU006
     C                     Z-ADD0         #ENTVT                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     Z-ADDINDUM8    #ENTVT                          CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C                     Z-ADDOPDUM8    #ENTVT                          CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDPDVATH    #ENTVT                          CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C**********           Z-ADDDUMA6     #ENTVT                    CEU006137419
     C                     Z-ADDCCDUM6    #ENTVT                          137419
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#ENTVT    ##D,12                          CEU006
     C/COPY WNCPYSRC,CG4630C094
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Entered Total Charge                                            CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN #W110D    #ENTTT                          CEU006
     C                     Z-ADD0         #ENTTT                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C                     Z-ADDDUMA1     #ENTTT                          CEU006
     C           #ENTTT    ADD  INDUM7    #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA5     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA6     #ENTTT                          CEU006
     C           #ENTTT    ADD  INDUM8    #ENTTT                          CEU006
     C           ##FILE    WHEQ 'OTPAY  '                                 CEU006
     C                     Z-ADDDUMA1     #ENTTT                          CEU006
     C           #ENTTT    ADD  OPDUM7    #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA5     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA6     #ENTTT                          CEU006
     C           #ENTTT    ADD  OPDUM8    #ENTTT                          CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     Z-ADDDUMA1     #ENTTT                          CEU006
     C           #ENTTT    ADD  CCDUM5    #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA2     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA3     #ENTTT                          CEU006
     C           #ENTTT    ADD  DUMA4     #ENTTT                          CEU006
     C********** #ENTTT    ADD  DUMA6     #ENTTT                    CEU006137419
     C           #ENTTT    ADD  CCDUM6    #ENTTT                          137419
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     Z-ADDTRCH      #ENTTT                          CEU006
     C           #ENTTT    ADD  PDCHCH    #ENTTT                          CEU006
     C           #ENTTT    ADD  COLH      #ENTTT                          CEU006
     C           #ENTTT    ADD  CSTH      #ENTTT                          CEU006
     C           #ENTTT    ADD  PDVATH    #ENTTT                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#ENTTT    ##D,13                          CEU006
     C/COPY WNCPYSRC,CG4630C095
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Entered Deductions                                              CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN #W110D    #ENTDD                          CEU006
     C                     Z-ADD0         #ENTDD                          CEU006
      *                                                                   CEU006
     C           ##FILE    IFEQ 'CQPAC  '                                 CEU006
      *                                                                   CEU006
      **** convert DEDS in PCCY to #ENTDD in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE PCCY      P#FRCY                          CEU006
     C                     Z-ADDDEDS      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    #ENTDD                          CEU006
     C                     MOVEL#ENTDD    ##D,14                          CEU006
     C/COPY WNCPYSRC,CG4630C096
     C                     MOVE A6NBDP    ##D,14                          CEU006
     C                     ELSE                                           CEU006
     C                     MOVE *BLANKS   ##D,14                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Entered Net Amount                                              CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN #NETA     #ENTNT                          CEU006
     C                     Z-ADD0         #ENTNT                          CEU006
     C           *LIKE     DEFN SMAM      ##SMAM                          CEU006
     C           *LIKE     DEFN PYAM      ##PYAM                          CEU006
     C           *LIKE     DEFN CQAM      ##CQAM                          CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
      *                                                                   CEU006
      **** convert SMAM in SMCY to ##SMAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE SMCY      P#FRCY                          CEU006
     C                     Z-ADDSMAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##SMAM                          CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
      **** convert PYAM in PCCY to ##PYAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE PCCY      P#FRCY                          CEU006
     C                     Z-ADDPYAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##PYAM                          CEU006
     C                     ENDIF                                          CEU006
     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      IFNE *BLANKS                                                     BUG11679
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     Z-ADD##SMAM    #ENTNT                          CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADD##PYAM    #ENTNT                          CEU006
     C                     ENDIF                                          CEU006
     C                     ELSE                                           CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C           ##SMAM    ADD  #ENTTT    #ENTNT                          CEU006
     C                     ELSE                                           CEU006
     C           ##PYAM    SUB  #ENTTT    #ENTNT                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
      *                                                                   CEU006
      **** convert CQAM in PCCY to ##CQAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE PCCY      P#FRCY                          CEU006
     C                     Z-ADDCQAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##CQAM                          CEU006
     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      IFNE *BLANKS                                                     BUG11679
     C                     Z-ADD##CQAM    #ENTNT                          CEU006
     C                     ELSE                                           CEU006
     C           ##CQAM    ADD  #ENTTT    #ENTNT                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
      *                                                                   CEU006
      **** convert CQAM in SMCY to ##CQAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE SMCY      P#FRCY                          CEU006
     C                     Z-ADDCQAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##CQAM                          CEU006
     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      IFNE *BLANKS                                                     BUG11679
     C                     Z-ADD##CQAM    #ENTNT                          CEU006
     C                     ELSE                                           CEU006
     C           ##CQAM    SUB  #ENTTT    #ENTNT                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#ENTNT    ##D,15                          CEU006
     C/COPY WNCPYSRC,CG4630C097
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@ENT    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  CHGEUR                                         *   CEU006
      * Function    :  Calculates Euro charges:                       *   CEU006
      *                                                               *   CEU006
      *                Euro Charges are the interim euro amounts      *   CEU006
      *                resulting during the conversion of entered     *   CEU006
      *                charges from entry currency to charge currency.*   CEU006
      *                                                               *   CEU006
      * Called by   :  DRCR01, DRCR02, DRCR03, DRCR04                 *   CEU006
      * Calls       :  EURAMT                                         *   CEU006
      *****************************************************************   CEU006
     C           CHGEUR    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'CHGEUR'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Retrieve subroutine specific data.                              CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\CHGEUR' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      ** Save Charge currency and its In Currency Indicator.              CEU006
      *                                                                   CEU006
     C********** CDRO      IFNE *ZEROS                                               CEU006 BUG11679
     C           CDRO      IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     SELEC                                                              CFT120
      *                                                                                       CFT120
      ** Incoming payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'INPAY  '                                                     CFT120
     C           INCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELINCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
      ** Outgoing payment                                                                     CFT120
      *                                                                                       CFT120
     C           ##FILE    WHEQ 'OTPAY  '                                                     CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     OTHER                                                              CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ENDSL                                                              CFT120
     C                     ELSE                                                               CFT120
     C           CDRO      IFNE *BLANKS                                                     BUG11679
     C                     MOVELBJCYCD    #CCY                            CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C           ##FILE    WHEQ 'INPAY  '                                 CEU006
     C           ##FILE    OREQ 'OTPAY  '                                 CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     MOVELSMCY      #CCY                            CEU006
     C                     ELSE                                           CEU006
     C                     MOVELPCCY      #CCY                            CEU006
     C                     ENDIF                                          CEU006
     C           ##FILE    WHEQ 'CQPAC  '                                 CEU006
     C                     MOVELDRCY      #CCY                            CEU006
     C           ##FILE    WHEQ 'CQCOD  '                                 CEU006
     C                     MOVELCRCY      #CCY                            CEU006
     C                     ENDSL                                          CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                                              CFT120
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM #CCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      #CHGCY  3                       CEU006
     C                     MOVELA6INCY    #CHGIN  1                       CEU006
     C           A6TPSD    IFGT W#DATE                                    CEU006
     C                     MOVE 'N'       #CHGIN                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Determine the number of decimal places for Euro                 CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM BKEURO    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      ** Calculate the interim Euro amounts resulting from conversion     CEU006
      ** of charges from Entry Ccy #ENTCY to Charge Ccy #CHGCY.           CEU006
      **                                                                  CEU006
      ** First deal with case requiring #ENTCY -> Base -> Euro -> In:     CEU006
      **  #ENTCY is Out (not Base) and #CHGCY is In (not Base)            CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
      *                                                                   CEU006
     C           #ENTIN    WHNE 'Y'                                       CEU006
     C           #ENTCY    ANDNEBJCYCD                                    CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #CHGCY    ANDNEBJCYCD                                    CEU006
      *                                                                   CEU006
      ** Euro Currency                                                    CEU006
     C                     MOVELBKEURO    ##D,1                           CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN P#FRAM    W#FRAM                          CEU006
      *                                                                   CEU006
      **  Interim Euro Transfer Commission                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTF    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,2                           CEU006
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Interim Euro FX/Charge Commission                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTFX    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,3                           CEU006
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telex Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTX    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,4                           CEU006
     C                     MOVE A6NBDP    ##D,4                           CEU006
      *                                                                   CEU006
      **  Interim Euro Cheque Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCQ    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,5                           CEU006
     C                     MOVE A6NBDP    ##D,5                           CEU006
      *                                                                   CEU006
      **  Interim Euro Costs Abroad                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCS    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,6                           CEU006
     C                     MOVE A6NBDP    ##D,6                           CEU006
      *                                                                   CEU006
      **  Interim Euro SWIFT Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTSW    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,7                           CEU006
     C                     MOVE A6NBDP    ##D,7                           CEU006
      *                                                                   CEU006
      **  Interim Euro Collection Charge                                  CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCL    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,8                           CEU006
     C                     MOVE A6NBDP    ##D,8                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telephone Charge                                   CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTP    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,9                           CEU006
     C                     MOVE A6NBDP    ##D,9                           CEU006
      *                                                                   CEU006
      **  Interim Euro Advice Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTAD    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,10                          CEU006
     C                     MOVE A6NBDP    ##D,10                          CEU006
      *                                                                   CEU006
      **  Interim Euro Miscellaneous Charge                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTMS    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,11                          CEU006
     C                     MOVE A6NBDP    ##D,11                          CEU006
      *                                                                   CEU006
      **  Interim Euro VAT Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTVT    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,12                          CEU006
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Interim Euro Total Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTT    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,13                          CEU006
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Interim Euro Deductions                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTDD    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,14                          CEU006
     C                     MOVE A6NBDP    ##D,14                          CEU006
      *                                                                   CEU006
      **  Interim Euro Net Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTNT    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,15                          CEU006
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
      ** Now deal with the other cases, these require #ENTCY -> Euro:     CEU006
      **  if #ENTCY is In  and #CHGCY is In , and #ENTCY is not #CHGCY;   CEU006
      **  or #ENTCY is In  and #CHGCY is Out, and #ENTCY is not Base;     CEU006
      **  or #ENTCY is Out and #CHGCY is In , and #CHGCY is not Base.     CEU006
      *                                                                   CEU006
     C           #ENTIN    WHEQ 'Y'                                       CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #ENTCY    ANDNE#CHGCY                                    CEU006
     C           #ENTIN    OREQ 'Y'                                       CEU006
     C           #CHGIN    ANDNE'Y'                                       CEU006
     C           #ENTCY    ANDNEBJCYCD                                    CEU006
     C           #ENTIN    ORNE 'Y'                                       CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #CHGCY    ANDNEBJCYCD                                    CEU006
      *                                                                   CEU006
      **  Set up Euro from GL ICD as currency to convert to.              CEU006
      *                                                                   CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
      *                                                                   CEU006
      **  Euro Currency                                                   CEU006
     C                     MOVELBKEURO    ##D,1                           CEU006
      *                                                                   CEU006
      **  Interim Euro Transfer Commission                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTF    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,2                           CEU006
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Interim Euro FX/Charge Commission                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTFX    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,3                           CEU006
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telex Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTX    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,4                           CEU006
     C                     MOVE A6NBDP    ##D,4                           CEU006
      *                                                                   CEU006
      **  Interim Euro Cheque Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCQ    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,5                           CEU006
     C                     MOVE A6NBDP    ##D,5                           CEU006
      *                                                                   CEU006
      **  Interim Euro Costs Abroad                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCS    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,6                           CEU006
     C                     MOVE A6NBDP    ##D,6                           CEU006
      *                                                                   CEU006
      **  Interim Euro SWIFT Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTSW    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,7                           CEU006
     C                     MOVE A6NBDP    ##D,7                           CEU006
      *                                                                   CEU006
      **  Interim Euro Collection Charge                                  CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTCL    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,8                           CEU006
     C                     MOVE A6NBDP    ##D,8                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telephone Charge                                   CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTP    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,9                           CEU006
     C                     MOVE A6NBDP    ##D,9                           CEU006
      *                                                                   CEU006
      **  Interim Euro Advice Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTAD    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,10                          CEU006
     C                     MOVE A6NBDP    ##D,10                          CEU006
      *                                                                   CEU006
      **  Interim Euro Miscellaneous Charge                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTMS    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,11                          CEU006
     C                     MOVE A6NBDP    ##D,11                          CEU006
      *                                                                   CEU006
      **  Interim Euro VAT Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTVT    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,12                          CEU006
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Interim Euro Total Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTTT    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,13                          CEU006
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Interim Euro Deductions                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTDD    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,14                          CEU006
     C                     MOVE A6NBDP    ##D,14                          CEU006
      *                                                                   CEU006
      **  Interim Euro Net Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#ENTNT    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,15                          CEU006
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
     C                     OTHER                                          CEU006
     C                     MOVEL*BLANKS   ##D,1                           CEU006
     C                     MOVEL*BLANKS   ##D,2                           CEU006
     C                     MOVEL*BLANKS   ##D,3                           CEU006
     C                     MOVEL*BLANKS   ##D,4                           CEU006
     C                     MOVEL*BLANKS   ##D,5                           CEU006
     C                     MOVEL*BLANKS   ##D,6                           CEU006
     C                     MOVEL*BLANKS   ##D,7                           CEU006
     C                     MOVEL*BLANKS   ##D,8                           CEU006
     C                     MOVEL*BLANKS   ##D,9                           CEU006
     C                     MOVEL*BLANKS   ##D,10                          CEU006
     C                     MOVEL*BLANKS   ##D,11                          CEU006
     C                     MOVEL*BLANKS   ##D,12                          CEU006
     C                     MOVEL*BLANKS   ##D,13                          CEU006
     C                     MOVEL*BLANKS   ##D,14                          CEU006
     C                     MOVEL*BLANKS   ##D,15                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@EUR    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  EURAMT                                         *   CEU006
      * Function    :  Calculates Currency Amounts for EMU            *   CEU006
      *                                                               *   CEU006
      *                Converts P#FRAM in P#FRCY -> P#TOAM in #CCY.   *   CEU006
      *                                                               *   CEU006
      * Called by   :  CHGENT, CHGEUR                                 *   CEU006
      * Calls       :  FT0010 - Midas FT Calculate Currency Amounts   *   CEU006
      *****************************************************************   CEU006
     C           EURAMT    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      P#TOCY                          CEU006
     C                     Z-ADDW#DATE    P#FRDT                          CEU006
     C                     Z-ADDW#DATE    P#TODT                          CEU006
      *                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *                                                                   CEU006
      *  Check if database error occurred                                 CEU006
      *                                                                   CEU006
     C           P#RTCD    IFNE *BLANKS                                   CEU006
     C                     MOVEL'FT0010  'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C                     Z-ADDP#TOAM    W#TOAM 170                      CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRTPSR                                         *
      * Function    :  Format Settlement Party Subroutine             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRTPSR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRTPSR'  @STK,Q
      *
      *................................................................
      *
      * Use FT0315 to format text for D address type
      *
      *  Set up general parameters
      *
     C           *LIKE     DEFN ADCHK1    WPTY1
     C           *LIKE     DEFN ADCHK1    WPTY2
      *
     C                     CLEARW8FT
     C                     MOVEL*BLANKS   W8STMT
     C                     MOVELWCCY      W8CCY
     C                     MOVEL##PGM     W8CPGM
     C                     MOVEL'*MSG  '  W8ACT
     C                     Z-ADD5         W8NLIN
     C                     MOVEL'Y'       W8MADD
     C                     MOVEL'Y'       W8MTXT
      *
      *  Format data to be translated
      *
     C                     MOVEL*BLANKS   ADDRSS                          087995
     C                     MOVELWTYPE     W8TYPE
     C                     MOVEL*BLANKS   W8LINS
     C                     MOVELWPTY1     ADCHK1
     C                     MOVELWPTY2     ADCHK2
     C                     MOVELWBRCA1    W0BRCA                                           AR1096709
     C                     MOVEL*BLANKS   WBRCA1                                           AR1096709
      *
      *  If partial account and WBRCA is not blank
      *  substitute into line
      *
     C           WTYPE     IFEQ 'P'
     C           WBRCA     ANDNE*BLANKS
     C                     MOVELWBRCA     ADPBRC
     C                     END
     C                     MOVELADDRSS    W8LINS
      *
      * Call expansion program
      *
     C                     CALL 'CG4980'               3030
     C                     PARM           W8RTN   7
     C                     PARM           W8FT
     C                     PARM           W8LINS256
     C                     PARM           W8RPT 256
     C                     PARM           W8MSG 256
     C                     PARM           W8SCR 256
      *
      *  Check if database error occurred
      *
     C           *IN30     IFEQ '1'
     C           W8RTN     ORNE *BLANKS
     C                     MOVEL'CG4980  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 11 *
     C                     Z-ADD11        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C                     MOVEL'0'       *IN30
     C                     MOVELW8MSG     ADDRSS
     C                     MOVELADCHK1    CNA1   35
     C                     MOVELADCHK2    CNA2   35
     C                     MOVELADCHK3    CNA3   35
     C                     MOVELADCHK4    CNA4   35
     C                     MOVELADCHK5    CNA5   35                       087995
      *
      *
      *................................................................
      *
     C           EXTPSR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 12 *
     C                     Z-ADD12        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD1         DEPBIN
     C                     Z-ADD1         DETBIN
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *                                                                                       CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
      *
      **  Output PF/CGUDTAPD Record.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 13 *
     C                     Z-ADD13        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
     C                     ENDIF                                                              CCG015
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELBRCA      DRBRCA
     C                     MOVELORBR      DRORBR
     C                     MOVEL'FT'      DRMODI
     C           ##FILE    IFNE 'FT101H  '                                CFT006
     C           ##FILE    ANDNE'FT102H  '                                CFT008
     C                     MOVELPREF      DRMTRN
     C                     ELSE                                           CFT006
     C                     MOVEL##PREF    DRMTRN                          CFT006
     C                     ENDIF                                          CFT006
      *
      **  Midas Account Identifier
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRC1
     C                     MOVEL#RETLN    DRMACT
     C                     MOVEL'N'       DRATRM
     C                     MOVEL##PTYP    DRPTYP
     C                     MOVEL##PSTP    DRPSTP
      *
     C                     MOVELW0CNUM    ##CUST
      *                                                                   087994
      *  Set up cheque number                                             087994
      *                                                                   087994
     C                     MOVEL*BLANKS   DRCHQR                          087994
     C                     SELEC                                          087994
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be p087994
     C                     MOVEL##CQSQ    DRCHQR                          087994
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Col087994
     C                     MOVEL##CQSQ    DRCHQR                          087994
     C                     ENDSL                                          087994
     C/COPY WNCPYSRC,CG4630C099
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *                                                                                       CCG015
      ** Pass reference as printtype:subtype                                                  CCG015
     C           DRPTYP    CAT  ':':0     WCOLON 11 P                                         CCG015
     C           WCOLON    CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD8         W0ERNB           * DB ERROR 08 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **         IN THE DATAAREA RUNDAT
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
      *
     C                     Z-ADD*ZEROS    WCQSQX
      *                                                                   CEU006
      ** Access Switchable Features file to check for CEU006              CEU006
      *                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C                     PARM           DSFDY                           CEU006
     C                     SELEC                                          CEU006
     C           @RTCD     WHEQ *BLANK                                    CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C           @RTCD     WHEQ '*NRF'                                    CEU006
     C                     MOVE 'N'       CEU006                          CEU006
     C                     OTHER                                          CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      ** Access GL ICD                                                    CEU006
      *                                                                   CEU006
     C**********           CALL 'AOGELRR0'                                             CEU006 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*FIRST ' @OPTN                           CEU006
     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU006 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C           @RTCD     IFNE *BLANKS                                   CEU006
     C                     MOVEL'SDGELRPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      ** Access FT ICD                                                    CEU006
      *                                                                   CEU006
     C                     CALL 'AOFTFRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*FIRST ' @OPTN                           CEU006
     C           SDFTFR    PARM SDFTFR    DSFDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C           @RTCD     IFNE *BLANKS                                   CEU006
     C                     MOVEL'SDFTFRPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      ** Access Module Details                                            CPB001
      *                                                                   CPB001
     C                     CALL 'AOMMODR0'                                CPB001
     C                     PARM '*MSG  '  @RTCD                           CPB001
     C                     PARM '*FIRST ' @OPTN                           CPB001
     C**************       PARM 'CPB001'  @SARD   6                       CPB001              222373
     C           SDMMOD    PARM SDMMOD    DSFDY                           CPB001
      *                                                                   CPB001
      ** DATABASE ERROR                                                   CPB001
      *                                                                   CPB001
     C           @RTCD     IFNE *BLANKS                                   CPB001
     C                     MOVEL'SDMMODPD'W0FILE                          CPB001
     C                     MOVEL*BLANKS   W0KEY            ***************CPB001
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CPB001
     C                     MOVEL'MEM5003' W0MSGD           ***************CPB001
     C                     MOVEL'MIDAS  ' W0MSGF                          CPB001
     C                     EXSR SRERR                                     CPB001
     C                     ENDIF                                          CPB001
      *                                                                   CFT014
      ** Access Switchable Features file to check for CFT014              CFT014
      *                                                                   CFT014
     C                     MOVE 'N'       CFT014  1                       CFT014
     C                     CALL 'AOSARDR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*VERIFY' POPTN                           CFT014
     C                     PARM 'CFT014'  PSARD   6                       CFT014
     C                     PARM           DSFDY                           CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C           PRTCD     ANDNE'*NRF    '                                CFT014
     C                     MOVEL'SCSARDPD'W0FILE                          CFT014
     C                     MOVEL'CFT014'  W0KEY                           CFT014
     C                     Z-ADD32        W0ERNB                          CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           PRTCD     IFEQ *BLANKS                                   CFT014
     C                     MOVE 'Y'       CFT014                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CPB001
     C/COPY WNCPYSRC,CG4630C004
      *                                                                   CFT009
      ** Access Switchable Features file to check for CFT009              CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT009'  @SARD   6                       CFT009
     C                     PARM           DSFDY                           CFT009
     C                     SELEC                                          CFT009
     C           @RTCD     WHEQ *BLANK                                    CFT009
     C                     MOVE 'Y'       CFT009  1                       CFT009
     C           @RTCD     WHEQ '*NRF'                                    CFT009
     C                     MOVE 'N'       CFT009                          CFT009
     C                     OTHER                                          CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     MOVEL@OPTN     W0KEY            ***************CFT009
     C                     Z-ADD42        W0ERNB           * DB ERROR 42 *CFT009
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDSL                                          CFT009
      *                                                                   CFT009
      ** Access Switchable Features file to check for CFT010              CFT009
      *                                                                   CFT009
     C                     CALL 'AOSARDR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*VERIFY' @OPTN                           CFT009
     C                     PARM 'CFT010'  @SARD   6                       CFT009
     C                     PARM           DSFDY                           CFT009
     C                     SELEC                                          CFT009
     C           @RTCD     WHEQ *BLANK                                    CFT009
     C                     MOVE 'Y'       CFT10   1                       CFT009
     C           @RTCD     WHEQ '*NRF'                                    CFT009
     C                     MOVE 'N'       CFT10                           CFT009
     C                     OTHER                                          CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C                     MOVEL'SCSARDPD'W0FILE                          CFT009
     C                     MOVEL@OPTN     W0KEY            ***************CFT009
     C                     Z-ADD43        W0ERNB           * DB ERROR 43 *CFT009
     C                     MOVEL'MEM5003' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDSL                                          CFT009
     C                     CALL 'SWIF2001'                                                    CSW201
     C                     PARM *BLANKS   @RTCD   7                                           CSW201
     C           @RTCD     IFEQ 'CSW2001'                                                     CSW201
     C                     MOVE 'Y'       CSW201  1                                           CSW201
     C                     ELSE                                                               CSW201
     C                     MOVE 'N'       CSW201                                              CSW201
     C                     ENDIF                                                              CSW201
      *                                                                                       CCG015
      ** Determine if Correspondence Manager Phase 1 Development                              CCG015
      ** on iSeries is installed                                                              CCG015
      *                                                                                       CCG015
     C                     MOVE 'N'       CCG015  1                                           CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD                                               CCG015
     C                     PARM '*VERIFY' POPTN                                               CCG015
     C                     PARM 'CCG015'  PSARD                                               CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
     C           PRTCD     IFNE *BLANKS                                                       CCG015
     C           PRTCD     ANDNE'*NRF    '                                                    CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL '  W0KEY                                               CCG015
     C                     Z-ADD63        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C           PRTCD     IFEQ *BLANKS                                                       CCG015
     C                     MOVE 'Y'       CCG015                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                     BUG12648
     C                     CALL 'SWIF2007'                                                    CSW207
     C                     PARM *BLANKS   PRTCD                                               CSW207
      *                                                                                       CSW207
     C           PRTCD     IFEQ 'CSW2007'                                                     CSW207
     C                     MOVEL'Y'       CSW207  1                                           CSW207
     C                     ELSE                                                               CSW207
     C                     MOVEL'N'       CSW207                                              CSW207
     C                     ENDIF                                                              CSW207
      *                                                                                       CSW207
      ** CFT009 for RFT, CCT and Cheques must be disabled                                   BUG12648
      *                                                                                     BUG12648
     C                     MOVE 'N'       WALLOW  1                                         BUG12648
      *
     C                     CALL 'AOSARDR0'                                                    CER031
     C                     PARM *BLANKS   @RTCD                                               CER031
     C                     PARM '*VERIFY' @OPTN                                               CER031
     C                     PARM 'CER031'  @SARD                                               CER031
     C                     PARM           DSFDY                                               CER031
      *                                                                                       CER031
     C********** PRTCD     IFNE *BLANKS                                              CER031 BUG22563
     C********** PRTCD     ANDNE'*NRF    '                                           CER031 BUG22563
     C           @RTCD     IFNE *BLANKS                                                     BUG22563
     C           @RTCD     ANDNE'*NRF    '                                                  BUG22563
     C                     MOVEL'SCSARDPD'W0FILE                                              CER031
     C                     MOVEL'CER031'  W0KEY                                               CER031
     C                     Z-ADD33        W0ERNB                                              CER031
     C                     MOVEL'MEM5003' W0MSGD                                              CER031
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER031
     C                     EXSR SRERR                                                         CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
     C********** PRTCD     IFEQ *BLANKS                                              CER031 BUG22749
     C           @RTCD     IFEQ *BLANKS                                                     BUG22749
     C                     MOVE 'Y'       CER031  1                                           CER031
     C                     ELSE                                                               CER031
      *                                                                                       CER031
     C                     MOVE 'N'       CER031                                              CER031
     C                     ENDIF                                                              CER031
      *                                                                                     BUG23445
      ** Access Switchable Features file and check if CCG015 is                             BUG23445
      ** installed                                                                          BUG23445
      *                                                                                     BUG23445
     C                     CALL 'AOSARDR0'                                                  BUG23445
     C                     PARM *BLANKS   PRTCD                                             BUG23445
     C                     PARM '*VERIFY' POPTN                                             BUG23445
     C                     PARM 'CGL013'  PSARD                                             BUG23445
      *                                                                                     BUG23445
     C           PRTCD     IFEQ *BLANK                                                      BUG23445
     C                     MOVE 'Y'       CGL013  1                                         BUG23445
     C                     ELSE                                                             BUG23445
     C                     MOVE 'N'       CGL013                                            BUG23445
     C           PRTCD     IFNE '*NRF   '                                                   BUG23445
     C                     MOVEL'SCSARDPD'W0FILE                                            BUG23445
     C                     MOVEL'*CALL'   W0KEY                                             BUG23445
     C                     Z-ADD66        W0ERNB                                            BUG23445
     C                     MOVEL'MEM5003' W0MSGD                                            BUG23445
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23445
     C                     EXSR SRERR                                                       BUG23445
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                     BUG23445
      *                                                                                       CFT134
      ** Access Switchable Features file to check for CFT004                                  CFT134
      *                                                                                       CFT134
     C                     MOVE 'N'       CFT004  1                                           CFT134
     C                     CALL 'AOSARDR0'                                                    CFT134
     C                     PARM *BLANKS   PRTCD                                               CFT134
     C                     PARM '*VERIFY' POPTN                                               CFT134
     C                     PARM 'CFT004'  PSARD                                               CFT134
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT134
      *                                                                                       CFT134
     C           PRTCD     IFNE *BLANKS                                                       CFT134
     C           PRTCD     ANDNE'*NRF    '                                                    CFT134
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT134
     C                     MOVEL'*CALL '  W0KEY                                               CFT134
     C                     Z-ADD900       W0ERNB                                              CFT134
     C                     MOVEL'MEM5003' W0MSGD                                              CFT134
     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT134
     C                     EXSR SRERR                                                         CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           PRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVE 'Y'       CFT004                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
      ** Access Switchable Features file to check for CFT134                                  CFT134
      *                                                                                       CFT134
     C                     MOVE 'N'       CFT134  1                                           CFT134
     C                     CALL 'AOSARDR0'                                                    CFT134
     C                     PARM *BLANKS   PRTCD                                               CFT134
     C                     PARM '*VERIFY' POPTN                                               CFT134
     C                     PARM 'CFT134'  PSARD                                               CFT134
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT134
      *                                                                                       CFT134
     C           PRTCD     IFNE *BLANKS                                                       CFT134
     C           PRTCD     ANDNE'*NRF    '                                                    CFT134
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT134
     C                     MOVEL'*CALL '  W0KEY                                               CFT134
     C                     Z-ADD901       W0ERNB                                              CFT134
     C                     MOVEL'MEM5003' W0MSGD                                              CFT134
     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT134
     C                     EXSR SRERR                                                         CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           PRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVE 'Y'       CFT134                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
      ***Keylist*for*file**GLNW94L1                                               BUG23445 BUG23445A
      ** Keylist for file  GLNWACL1                                                        BUG23445A
      *                                                                                     BUG23445
     C           KACCT     KLIST                                                            BUG23445
     C                     KFLD           KNWRK                                             BUG23445
     C                     KFLD           PBRCA                                             BUG23445
     C                     KFLD           PCUSNO                                            BUG23445
     C                     KFLD           PCCY                                              BUG23445
     C                     KFLD           KACCDX                                            BUG23445
     C                     KFLD           KACSQX                                            BUG23445
      *                                                                                       CER049
      ** Determine if Stamp Tax feature is switched on.                                       CER049
      *                                                                                       CER049
     C                     MOVE 'N'       CER049  1                                           CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   PRTCD                                               CER049
     C                     PARM '*VERIFY' POPTN                                               CER049
     C                     PARM 'CER049'  PSARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
     C           PRTCD     IFNE *BLANKS                                                       CER049
     C           PRTCD     ANDNE'*NRF    '                                                    CER049
     C                     MOVEL'SCSARDPD'W0FILE                                              CER049
     C                     MOVEL'*CALL '  W0KEY                                               CER049
     C                     Z-ADD67        W0ERNB                                              CER049
     C                     MOVEL'MEM5003' W0MSGD                                              CER049
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C           PRTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CFT120
      ** Determine if CFT120 is on.                                                           CFT120
      *                                                                                       CFT120
     C                     MOVE 'N'       CFT120  1                                           CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD                                               CFT120
     C                     PARM '*VERIFY' POPTN                                               CFT120
     C                     PARM 'CFT120'  PSARD                                               CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
     C           PRTCD     IFNE *BLANKS                                                       CFT120
     C           PRTCD     ANDNE'*NRF    '                                                    CFT120
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT120
     C                     MOVEL'*CALL '  W0KEY                                               CFT120
     C                     Z-ADD68        W0ERNB                                              CFT120
     C                     MOVEL'MEM5003' W0MSGD                                              CFT120
     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT120
     C                     EXSR SRERR                                                         CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     ENDIF                                                              CFT120
      *                                                                                       CFT121
      ** Check if CFT121 is switched on.                                                      CFT121
      *                                                                                       CFT121
     C                     MOVE 'N'       CFT121  1                                           CFT121
     C                     CALL 'AOSARDR0'                                                    CFT121
     C                     PARM *BLANKS   PRTCD                                               CFT121
     C                     PARM '*VERIFY' POPTN                                               CFT121
     C                     PARM 'CFT121'  PSARD                                               CFT121
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT121
     C           PRTCD     IFNE *BLANKS                                                       CFT121
     C           PRTCD     ANDNE'*NRF    '                                                    CFT121
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT121
     C                     MOVEL'*CALL '  W0KEY                                               CFT121
     C                     Z-ADD69        W0ERNB                                              CFT121
     C                     MOVEL'MEM5003' W0MSGD                                              CFT121
     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT121
     C                     EXSR SRERR                                                         CFT121
     C                     ENDIF                                                              CFT121
      *                                                                                       CFT121
     C           PRTCD     IFEQ *BLANKS                                                       CFT121
     C                     MOVE 'Y'       CFT121                                              CFT121
     C                     ENDIF                                                              CFT121
      *................................................................
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C*
     C                     MOVE *BLANKS   ZTABKY 12
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      KEY4    4
     C                     MOVE '1'       KEY4
     C                     MOVE KEY4      ZTABKY
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
     C**********           Z-ADD*ZEROS    W0CNUM                                              CSD027
     C                     MOVE *BLANKS   W0CNUM                                              CSD027
      *
      **  Attempt to obtain customer number.
     C                     SELEC
     C           ##FILE    WHEQ 'INPAY  '                  Incoming Payments
     C           ACBK      IFNE *BLANKS
     C                     MOVE ACBT      WTYPE
     C                     MOVELACBK      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELACBK      WPTY1
     C                     MOVELACBB      WBRCA
     C                     EXSR SRTPSR
     C                     ENDIF
     C********** W0CNUM    IFEQ *ZEROS                                                        CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
     C           BNCT      IFNE 'A'
     C                     MOVE BNCT      WTYPE
     C                     MOVELBNC1      WPTY
     C                     MOVE PCCY      WCCY
     C                     MOVELBNC1      WPTY1
     C                     MOVELBNC2      WPTY2
     C                     MOVEL*BLANKS   WBRCA
     C                     EXSR SRTPSR
     C                     ENDIF
     C                     ENDIF
     C           ##FILE    WHEQ 'OTPAY  '                  Outgoing Payments
     C********** ORBK      IFNE *ZEROS                                                      BUG11679
     C           ORBK      IFNE *BLANKS                                                     BUG11679
     C                     MOVE ORBT      WTYPE
     C                     MOVELORBK      WPTY
     C                     MOVE SMCY      WCCY
     C                     MOVELORBK      WPTY1
     C                     MOVELORBB      WBRCA
     C                     EXSR SRTPSR
     C                     ENDIF
     C********** W0CNUM    IFEQ *ZEROS                                                        CSD027
     C           W0CNUM    IFEQ *BLANKS                                                       CSD027
     C           ORCT      IFNE 'A'
     C                     MOVE ORCT      WTYPE
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           18        SUBSTORC1:2    WPTY                                                CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      WPTY
     C                     ENDIF                                                              CFT032
     C                     MOVE SMCY      WCCY
     C           ORCT      IFEQ 'R'                                                           CFT032
     C           ORCT      OREQ 'P'                                                           CFT032
     C           ORCT      OREQ 'I'                                                         BUG15105
     C           WSLSH     IFEQ '/'                                                         BUG15105
     C           34        SUBSTORC1:2    WPTY1     P                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVELORC1      WPTY1
     C                     ENDIF                                                            BUG15105
     C                     ELSE                                                             BUG15105
     C           WSLSH     IFEQ '/'                                                         BUG15105
     C           34        SUBSTORC1:2    WPTY1     P                                       BUG15105
     C                     ELSE                                                             BUG15105
     C                     MOVELORC1      WPTY1                                             BUG15105
     C                     ENDIF                                                            BUG15105
     C                     ENDIF                                                              CFT032
     C                     MOVELORC2      WPTY2
     C                     MOVEL*BLANKS   WBRCA
     C                     EXSR SRTPSR
     C                     ENDIF
     C                     ENDIF
     C           ##FILE    WHEQ 'CQCOD  '                  Cheques for Collectn
     C***********ORBK      IFNE *ZEROS                                    087994
     C***********          MOVE ORBT      WTYPE                           087994
     C***********          MOVELORBK      WPTY                            087994
     C***********          MOVE SMCY      WCCY                            087994
     C***********          MOVELORBK      WPTY1                           087994
     C***********          MOVELORBB      WBRCA                           087994
     C                     MOVE CRPT      WTYPE                           087994
     C                     MOVELCRPY      WPTY                            087994
     C                     MOVE CRCY      WCCY                            087994
     C                     MOVELCRPY      WPTY1                           087994
     C                     MOVELCRBR      WBRCA                           087994
     C                     EXSR SRTPSR
     C***********          ENDIF                                          087994
     C           ##FILE    WHEQ 'CQPAC  '                  Cheques to be paid
      ***********                                                         087994
     C***********ORCT      IFNE 'A'                                       087994
     C***********          MOVE ORCT      WTYPE                           087994
     C***********          MOVELORC1      WPTY                            087994
     C***********          MOVE SMCY      WCCY                            087994
     C***********          MOVELORC1      WPTY1                           087994
     C***********          MOVELORC2      WPTY2                           087994
     C***********          MOVEL*BLANKS   WBRCA                           087994
     C                     MOVE DRPT      WTYPE                           087994
     C                     MOVELDRPY      WPTY                            087994
     C                     MOVE DRCY      WCCY                            087994
     C                     MOVELDRPY      WPTY1                           087994
     C                     MOVELDRBR      WBRCA                           087994
     C                     EXSR SRTPSR
     C***********          ENDIF                                          087994
     C           ##FILE    WHEQ 'FT101H  '                                CFT006
     C           TOCUS1    IFNE *BLANKS                                   CFT006
      *                                                                   CFT006
     C           DCUSTP    IFEQ 'G'                                       CFT006
     C                     MOVELTOCUS1    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    TOCUS1                          CFT006
     C                     MOVELTOCUS2    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    TOCUS2                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE DCUSTP    WTYPE                           CFT006
     C                     MOVELTOCUS1    WPTY                            CFT006
     C                     MOVELTOCUS1    WPTY1                           CFT006
     C                     MOVELTOCUS2    WPTY2                           CFT006
     C                     ELSE                                           CFT006
      *                                                                   CFT006
     C           CUSTTP    IFEQ 'G'                                       CFT006
     C                     MOVELHOCUS1    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    HOCUS1                          CFT006
     C                     MOVELHOCUS2    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    HOCUS2                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVE CUSTTP    WTYPE                           CFT006
     C                     MOVELHOCUS1    WPTY                            CFT006
     C                     MOVELHOCUS1    WPTY1                           CFT006
     C                     MOVELHOCUS2    WPTY2                           CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE TRNCCY    WCCY                            CFT006
     C                     MOVELBRCA      WBRCA                           CFT006
     C                     EXSR SRTPSR                                    CFT006
     C           ##FILE    WHEQ 'FT102H  '                                CFT008
     C                     SELEC                                          CFT008
     C           SINSTT    WHNE *BLANKS                                   CFT008
     C           '/'       SCAN SINSTX                   20               CFT008
      *                                                                   CFT008
     C           *IN20     IFEQ *ON                                       CFT008
     C                     SUBSTSINSTX:2  SINSTX                          CFT008
     C                     ENDIF                                          CFT008
      *                                                                   CFT006
     C           SINSTT    IFEQ 'G'                                       CFT006
     C                     MOVELSINSTX    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    SINSTX                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT008
     C                     MOVE SINSTT    WTYPE                           CFT008
     C                     MOVELSINSTX    WPTY                            CFT008
     C                     MOVELSINSTX    WPTY1                           CFT008
     C                     MOVEL*BLANKS   WPTY2                           CFT008
     C           SNDTYP    WHNE *BLANKS                                   CFT008
      *                                                                   CFT006
     C           SNDTYP    IFEQ 'G'                                       CFT006
     C                     MOVELSNDCOR    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    SNDCOR                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT008
     C                     MOVE SNDTYP    WTYPE                           CFT008
     C                     MOVELSNDCOR    WPTY                            CFT008
     C                     MOVELSNDCOR    WPTY1                           CFT008
     C                     MOVEL*BLANKS   WPTY2                           CFT008
     C           RCVTYP    WHNE *BLANKS                                   CFT008
     C           '/'       SCAN RCVCOR                   20               CFT008
      *                                                                   CFT008
     C           *IN20     IFEQ *ON                                       CFT008
     C                     SUBSTRCVCOR:2  RCVCOR                          CFT008
     C                     ENDIF                                          CFT008
      *                                                                   CFT008
     C           RCVTYP    IFEQ 'G'                                       CFT006
     C                     MOVELRCVCOR    NGLACT                          CFT006
     C                     MOVE NGLBRH    OGLBRH                          CFT006
     C                     MOVE NGLCNM    OGLCNM                          CFT006
     C                     MOVE NGLACD    OGLACD                          CFT006
     C                     MOVE NGLCCY    OGLCCY                          CFT006
     C                     MOVE NGLSEQ    OGLSEQ                          CFT006
     C                     MOVELOGLACT    RCVCOR                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT008
     C                     MOVE RCVTYP    WTYPE                           CFT008
     C                     MOVELRCVCOR    WPTY                            CFT008
     C                     MOVELRCVCOR    WPTY1                           CFT008
     C                     MOVEL*BLANKS   WPTY2                           CFT008
     C                     ENDSL                                          CFT008
     C                     MOVE CCTCCY    WCCY                            CFT008
     C                     MOVELBRCA      WBRCA                           CFT008
     C                     EXSR SRTPSR                                    CFT008
     C                     ENDSL
      *                                                                                       CCG015
      ** Initialize context for new extraction                                                CCG015
     C                     EXSR INIXML                                                        CCG015
     C*
     C/COPY WNCPYSRC,CG4630FCPG
      *
     C           EXINZ     TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/COPY WNCPYSRC,CG4630C007
     C/SPACE 5
      *****************************************************************   CFT003
      * Subroutine  :  DESTIN                                         *   CFT003
      * Function    :  Destination Institution                        *   CFT003
      *                                                               *   CFT003
      * Called by   :                                                 *   CFT003
      * Calls       :                                                 *   CFT003
      *****************************************************************   CFT003
     C           DESTIN    BEGSR                                          CFT003
      *                                                                   CFT003
      **  Set up subroutine stack name                                    CFT003
     C                     ADD  1         Q                               CFT003
     C                     MOVEL'DESTIN'  @STK,Q                          CFT003
      *                                                                   CFT003
      *................................................................   CFT003
      *                                                                   CFT003
      **  Retrieve subroutine specific data.                              CFT003
     C           1         OCUR ##SRDT                                    CFT003
     C                     MOVEL##SPAT    S#PATH                          CFT003
      *                                                                   CFT003
      **  Set up Path.                                                    CFT003
     C                     MOVEL'\DESTIN' ##PNAM                          CFT003
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT003
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT003
      **  Retrieve RDE information for RDEs in group set                  CFT003
      *                                                                   CFT003
     C                     MOVEL'CORDTA'  ##GRPS                          CFT003
     C                     Z-ADD1         ##RDEN                          CFT003
     C                     EXSR SRRRDE                                    CFT003
     C*                                                                   CFT003
     C                     MOVE *BLANKS   W#ADD1                          CFT003
     C                     MOVE *BLANKS   W#ADD2                          CFT003
     C                     MOVE *BLANKS   W#ADD3                          CFT003
     C                     MOVE *BLANKS   W#ADD4                          CFT003
     C                     MOVE *BLANKS   W#ADD5                          CFT003
     C*                                                                   CFT003
     C           DSTT      IFEQ 'A'                                       CFT003
     C                     MOVE DST1      W#ADD1                          CFT003
     C                     MOVE DST2      W#ADD2                          CFT003
     C                     MOVE DST3      W#ADD3                          CFT003
     C                     MOVE DST4      W#ADD4                          CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     MOVE DSTT      WTYPE                           CFT003
     C                     MOVE DST1      WPTY1                           CFT003
     C                     MOVE DST2      WPTY2                           CFT003
     C                     MOVE *BLANKS   WBRCA                           CFT003
     C                     MOVE PCCY      WCCY                            CFT003
      *                                                                   CFT003
     C                     EXSR SRTPSR                                    CFT003
      *                                                                   CFT003
      **  For Outgoing CR Advices                                         CFT003
      **  Store the customer number of the Destination so that it         CFT003
      **  can be used as the primary correspondent for the second         CFT003
      **  call of this program, to produce the second extract record.     CFT003
      *                                                                   CFT003
     C           UUDRAD    IFEQ *BLANKS                                   CFT003
     C                     MOVEL'FT_ADV_D'UUDRAD  9        Too big        CFT003
     C                     MOVE 'R'       UUDRAD           Too big        CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C           ##PTYP    IFEQ UUDRAD                                    CFT003
     C           ##PSTP    ANDEQ'OUT_PAY'                                 CFT003
     C           *LIKE     DEFN W0CNUM    UUCNUM                          CFT003
     C**********           Z-ADDW0CNUM    UUCNUM                                       CFT003 CSD027
     C                     MOVE W0CNUM    UUCNUM                                              CSD027
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
      **  Destination Information Type                                    CFT003
     C                     MOVE *BLANKS   #TYPE                           CFT003
     C                     MOVELDSTT      #TYPE                           CFT003
      *                                                                   CFT003
     C           #TYPE     IFNE 'A'                                       CFT003
      *                                                                   CFT003
     C                     MOVE *BLANKS   W#ADDR                          CFT003
      **  Address line 1                                                  CFT003
     C                     MOVELCNA1      W#ADD1                          CFT003
      **  Address line 2                                                  CFT003
     C                     MOVELCNA2      W#ADD2                          CFT003
      *                                                                   CFT003
      **  Address line 3                                                  CFT003
     C                     MOVELCNA3      W#ADD3                          CFT003
      *                                                                   CFT003
      **  Address line 4                                                  CFT003
     C                     MOVELCNA4      W#ADD4                          CFT003
      *                                                                   CFT003
      **  Address line 5                                                  CFT003
     C                     MOVELCNA5      W#ADD5                          CFT003
      *                                                                   CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     EXSR CORDTA                                    CFT003
      *                                                                   CFT003
      **  Accumulate RDE's and associated data and output to              CFT003
      **  PF/CGUDTAPD.                                                    CFT003
     C                     EXSR SRADTA                                    CFT003
     C                     EXSR SRODTA                                    CFT003
      *                                                                   CFT003
      *................................................................   CFT003
      *                                                                   CFT003
     C           EXDEST    TAG                                            CFT003
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT003
      **  Unwind subroutine stack name                                    CFT003
     C                     MOVEA*BLANKS   @STK,Q                          CFT003
     C                     SUB  1         Q                               CFT003
      *                                                                   CFT003
     C                     ENDSR                                          CFT003
     C*****************************************************************   CFT003
     C/SPACE 5                                                            CFT003
      *****************************************************************   CFT003
      * Subroutine  :  SEND2                                          *   CFT003
      * Function    :  Sender Details                                 *   CFT003
      *                                                               *   CFT003
      * Called by   :                                                 *   CFT003
      * Calls       :                                                 *   CFT003
      *****************************************************************   CFT003
     C           SEND2     BEGSR                                          CFT003
      *                                                                   CFT003
      **  Set up subroutine stack name                                    CFT003
     C                     ADD  1         Q                               CFT003
     C                     MOVEL'SENDER'  @STK,Q                          CFT003
      *                                                                   CFT003
      *................................................................   CFT003
      *                                                                   CFT003
      **  Retrieve subroutine specific data.                              CFT003
     C           1         OCUR ##SRDT                                    CFT003
     C                     MOVEL##SPAT    S#PATH                          CFT003
      *                                                                   CFT003
      **  Set up Path.                                                    CFT003
     C                     MOVEL'\SENDER' ##PNAM                          CFT003
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT003
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT003
      **  Retrieve RDE information for RDEs in group set                  CFT003
      *                                                                   CFT003
     C                     MOVEL'CORDTA'  ##GRPS                          CFT003
     C                     Z-ADD1         ##RDEN                          CFT003
     C                     EXSR SRRRDE                                    CFT003
      *                                                                   CFT003
     C                     MOVELSNTP      WTYPE                           CFT003
     C                     MOVE SMCY      WCCY                            CFT003
     C                     MOVELSND1      WPTY1                           CFT003
     C                     MOVELSND2      WPTY2                           CFT003
     C                     MOVEL*BLANKS   WBRCA                           CFT003
      *                                                                   CFT003
      *                                                                   CFT003
     C                     EXSR SRTPSR                                    CFT003
      *                                                                   CFT003
      **  For Incoming DR Advices                                         CFT003
      **  Store the customer number of the Sender so that it              CFT003
      **  can be used as the primary correspondent for the second         CFT003
      **  call of this program, to produce the second extract record.     CFT003
      *                                                                   CFT003
     C           UUCRAD    IFEQ *BLANKS                                   CFT003
     C                     MOVEL'FT_ADV_C'UUCRAD  9        Too big        CFT003
     C                     MOVE 'R'       UUCRAD           Too big        CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C           ##PTYP    IFEQ UUCRAD                                    CFT003
     C           ##PSTP    ANDEQ'IN_PAY'                                  CFT003
     C**********           Z-ADDW0CNUM    UUCNUM                                       CFT003 CSD027
     C                     MOVE W0CNUM    UUCNUM                                              CSD027
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
      **  Information Type                                                CFT003
     C                     MOVE *BLANKS   #TYPE                           CFT003
     C                     MOVELSNTP      #TYPE                           CFT003
      *                                                                   CFT003
     C                     MOVE *BLANKS   W#ADDR                          CFT003
      **  Address line 1                                                  CFT003
     C                     MOVELCNA1      W#ADD1                          CFT003
      **  Address line 2                                                  CFT003
     C                     MOVELCNA2      W#ADD2                          CFT003
      *                                                                   CFT003
      **  Address line 3                                                  CFT003
     C                     MOVELCNA3      W#ADD3                          CFT003
      *                                                                   CFT003
      **  Address line 4                                                  CFT003
     C                     MOVELCNA4      W#ADD4                          CFT003
      *                                                                   CFT003
      **  Address line 5                                                  CFT003
     C                     MOVE *BLANKS   W#ADD5                          CFT003
      *                                                                   CFT003
      *   Fill with destination details if an address                     CFT003
     C           SNTP      IFEQ 'A'                                       CFT003
      **  Destination Address line 1                                      CFT003
     C                     MOVELSND1      W#ADD1                          CFT003
      **  Destination Address line 2                                      CFT003
     C                     MOVELSND2      W#ADD2                          CFT003
      *                                                                   CFT003
      **  Destination Address line 3                                      CFT003
     C                     MOVELSND3      W#ADD3                          CFT003
      *                                                                   CFT003
      **  Destination Address line 4                                      CFT003
     C                     MOVELSND4      W#ADD4                          CFT003
      *                                                                   CFT003
      **  Balnaks in Address line 5                                       CFT003
     C                     MOVE *BLANKS   W#ADD5                          CFT003
     C                     ENDIF                                          CFT003
      *                                                                   CFT003
     C                     EXSR CORDTA                                    CFT003
      *                                                                   CFT003
      **  Accumulate RDE's and associated data and output to              CFT003
      **  PF/CGUDTAPD.                                                    CFT003
     C                     EXSR SRADTA                                    CFT003
     C                     EXSR SRODTA                                    CFT003
      *                                                                   CFT003
      *................................................................   CFT003
      *                                                                   CFT003
     C           EXSEN2    TAG                                            CFT003
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT003
      **  Unwind subroutine stack name                                    CFT003
     C                     MOVEA*BLANKS   @STK,Q                          CFT003
     C                     SUB  1         Q                               CFT003
      *                                                                   CFT003
     C                     ENDSR                                          CFT003
     C*****************************************************************   CFT003
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  SRRFT                                          *   CFT006
      * Function    :  Request for Transfer Details                   *   CFT006
      *                                                               *   CFT006
      * Called by   :  DRCR05                                         *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           SRRFT     BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'FT_RFT'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Retrieve subroutine specific data.                              CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVEL##SPAT    S#PATH                          CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\FT_RFT' ##PNAM                          CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Retrieve RDE information for RDEs in group set                  CFT006
      *                                                                   CFT006
     C                     MOVEL@STK,Q    ##GRPS                          CFT006
     C                     Z-ADD1         ##RDEN                          CFT006
     C                     EXSR SRRRDE                                    CFT006
      *                                                                   CFT006
     C                     MOVELRFTID     ##D,1                           CFT006
     C                     MOVELSTID      ##D,2                           CFT006
     C                     MOVELSNDREF    ##D,3                           CFT006
     C                     MOVELTRNSID    ##D,4                           CFT006
     C                     MOVELFXDREF    ##D,5                           CFT006
     C                     MOVELHINPTY    ##D,6                           CFT006
     C                     MOVELEXDATE    ##D,7                           CFT006
     C                     MOVELHANDCY    ##D,8                           CFT006
      *                                                                   CFT006
     C           HANDCY    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   PRTCD   7                       CFT006
     C                     PARM '*KEY   ' POPTN   7                       CFT006
     C                     PARM HANDCY    @AJCD                           CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           PRTCD     IFNE *BLANKS                                   CFT006
     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
     C                     MOVELHANDCY    W0KEY            ***************CFT006
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CFT006
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERR                                     CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE A6NBDP    ##D,9                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELHANDCG    ##D,9                           CFT006
     C                     MOVELHANDAC    ##D,10                          CFT006
     C                     MOVELAUTHTX    ##D,11                          CFT006
     C                     MOVELTOCCY     ##D,12                          CFT006
      *                                                                   CFT006
     C           TOCCY     IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   PRTCD                           CFT006
     C                     PARM '*KEY   ' POPTN                           CFT006
     C                     PARM TOCCY     @AJCD                           CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           PRTCD     IFNE *BLANKS                                   CFT006
     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
     C                     MOVELTOCCY     W0KEY            ***************CFT006
     C                     Z-ADD26        W0ERNB           * DB ERROR 26 *CFT006
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERR                                     CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE A6NBDP    ##D,13                          CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     MOVELTOOAMT    ##D,13                          CFT006
     C                     MOVELINSCA4    ##D,14                          CFT006
     C                     MOVELINSCB4    ##D,15                          CFT006
     C                     MOVELINSCC4    ##D,16                          CFT006
     C                     MOVELINSCD4    ##D,17                          CFT006
     C                     MOVELINSCE4    ##D,18                          CFT006
     C                     MOVELINSA31    ##D,19                          CFT006
     C                     MOVELINSB31    ##D,20                          CFT006
      *                                                                   CFT006
      **  Accumulate RDE's and associated data and output to              CFT006
      **  PF/CGUDTAPD.                                                    CFT006
      *                                                                   CFT006
     C                     EXSR SRADTA                                    CFT006
     C                     EXSR SRODTA                                    CFT006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
      *................................................................   CFT006
      **  Unwind subroutine stack name                                    CFT006
      *                                                                   CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  SRRFI                                          *   CFT006
      * Function    :  Request for Transfer Details II                *   CFT006
      *                                                               *   CFT006
      * Called by   :  DRCR05                                         *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           SRRFI     BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'FT_RFI'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Retrieve subroutine specific data.                              CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVEL##SPAT    S#PATH                          CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\FT_RFI' ##PNAM                          CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Retrieve RDE information for RDEs in group set                  CFT006
      *                                                                   CFT006
     C                     MOVEL@STK,Q    ##GRPS                          CFT006
     C                     Z-ADD1         ##RDEN                          CFT006
     C                     EXSR SRRRDE                                    CFT006
      *                                                                   CFT006
     C                     MOVELTINST1    ##D,1                           CFT006
     C                     MOVELTINST2    ##D,2                           CFT006
     C                     MOVELTINST3    ##D,3                           CFT006
     C                     MOVELTINST4    ##D,4                           CFT006
     C                     MOVELTINST5    ##D,5                           CFT006
     C                     MOVELTINSTA    ##D,6                           CFT006
     C                     MOVELINTTTP    ##D,7                           CFT006
     C                     MOVELTACA35    ##D,8                           CFT006
     C                     MOVELTACB35    ##D,9                           CFT006
     C                     MOVELTACC35    ##D,10                          CFT006
     C                     MOVELTACD35    ##D,11                          CFT006
     C                     MOVELTACE35    ##D,12                          CFT006
     C                     MOVELTACA11    ##D,13                          CFT006
     C                     MOVELAWITTP    ##D,14                          CFT006
     C                     MOVELHACSV1    ##D,15                          CFT006
     C                     MOVELHACSV2    ##D,16                          CFT006
      *                                                                   CFT006
      **  Accumulate RDE's and associated data and output to              CFT006
      **  PF/CGUDTAPD.                                                    CFT006
      *                                                                   CFT006
     C                     EXSR SRADTA                                    CFT006
     C                     EXSR SRODTA                                    CFT006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
      *................................................................   CFT006
      **  Unwind subroutine stack name                                    CFT006
      *                                                                   CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT008
      * Subroutine  :  SRCCT                                          *   CFT008
      * Function    :  Customer Credit Transfer Details               *   CFT008
      *                                                               *   CFT008
      * Called by   :  DRCR06                                         *   CFT008
      * Calls       :                                                 *   CFT008
      *****************************************************************   CFT008
     C           SRCCT     BEGSR                                          CFT008
      *                                                                   CFT008
      **  Set up subroutine stack name                                    CFT008
     C                     ADD  1         Q                               CFT008
     C                     MOVEL'FT_CCT'  @STK,Q                          CFT008
      *                                                                   CFT008
      *................................................................   CFT008
      *                                                                   CFT008
      **  Retrieve subroutine specific data.                              CFT008
     C           1         OCUR ##SRDT                                    CFT008
     C                     MOVEL##SPAT    S#PATH                          CFT008
      *                                                                   CFT008
      **  Set up Path.                                                    CFT008
     C                     MOVEL'\FT_CCT' ##PNAM                          CFT008
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT008
      **  Retrieve RDE information for RDEs in group set                  CFT008
      *                                                                   CFT008
     C                     MOVEL@STK,Q    ##GRPS                          CFT008
     C                     Z-ADD1         ##RDEN                          CFT008
     C                     EXSR SRRRDE                                    CFT008
      *                                                                   CFT008
     C                     MOVELCCTID     ##D,1                           CFT008
     C                     MOVELFILREF    ##D,2                           CFT008
     C                     MOVELTRNSID    ##D,3                           CFT008
     C                     MOVELCCTBOC    ##D,4                           CFT008
     C                     MOVELCCTDST    ##D,5                           CFT008
     C                     MOVELTTVDTE    ##D,6                           CFT008
     C                     MOVELCCTCHG    ##D,7                           CFT008
     C                     MOVELCCTTYP    ##D,8                           CFT008
      *                                                                   CFT008
      **  Accumulate RDE's and associated data and output to              CFT008
      **  PF/CGUDTAPD.                                                    CFT008
      *                                                                   CFT008
     C                     EXSR SRADTA                                    CFT008
     C                     EXSR SRODTA                                    CFT008
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT008
      *................................................................   CFT008
      **  Unwind subroutine stack name                                    CFT008
      *                                                                   CFT008
     C                     MOVEA*BLANKS   @STK,Q                          CFT008
     C                     SUB  1         Q                               CFT008
      *                                                                   CFT008
     C                     ENDSR                                          CFT008
      *****************************************************************   CFT008
      /SPACE 5                                                            CFT008
      *****************************************************************   CFT008
      * Subroutine  :  SRCCI                                          *   CFT008
      * Function    :  Customer Credit Transfer Details II            *   CFT008
      *                                                               *   CFT008
      * Called by   :  DRCR06                                         *   CFT008
      * Calls       :                                                 *   CFT008
      *****************************************************************   CFT008
     C           SRCCI     BEGSR                                          CFT008
      *                                                                   CFT008
      **  Set up subroutine stack name                                    CFT008
     C                     ADD  1         Q                               CFT008
     C                     MOVEL'FT_CCI'  @STK,Q                          CFT008
      *                                                                   CFT008
      *................................................................   CFT008
      *                                                                   CFT008
      **  Retrieve subroutine specific data.                              CFT008
     C           1         OCUR ##SRDT                                    CFT008
     C                     MOVEL##SPAT    S#PATH                          CFT008
      *                                                                   CFT008
      **  Set up Path.                                                    CFT008
     C                     MOVEL'\FT_CCI' ##PNAM                          CFT008
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT008
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT008
      **  Retrieve RDE information for RDEs in group set                  CFT008
      *                                                                   CFT008
     C                     MOVEL@STK,Q    ##GRPS                          CFT008
     C                     Z-ADD1         ##RDEN                          CFT008
     C                     EXSR SRRRDE                                    CFT008
      *                                                                   CFT008
     C                     MOVELSNDCCY    ##D,1                           CFT008
     C           SNDCCY    IFNE *BLANKS                                   CFT008
     C                     CALL 'AOCURRR0'                                CFT008
     C                     PARM *BLANKS   PRTCD                           CFT008
     C                     PARM '*KEY   ' POPTN                           CFT008
     C                     PARM SNDCCY    @AJCD                           CFT008
     C           SDCURR    PARM SDCURR    DSSDY                           CFT008
      *                                                                   CFT008
     C           PRTCD     IFNE *BLANKS                                   CFT008
     C                     MOVEL'SDCURRPD'W0FILE                          CFT008
     C                     MOVELSNDCCY    W0KEY            ***************CFT008
     C                     Z-ADD27        W0ERNB           * DB ERROR 27 *CFT008
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT008
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT008
     C                     EXSR SRERR                                     CFT008
     C                     ENDIF                                          CFT008
     C                     MOVE A6NBDP    ##D,2                           CFT008
     C                     ENDIF                                          CFT008
      *                                                                   CFT008
     C                     MOVELSNDCHG    ##D,2                           CFT008
     C           PAYCCY    IFNE *BLANKS                                   CFT008
     C                     MOVELSNDOCG    ##D,3                           CFT008
     C                     MOVE WPDCP     ##D,3                           CFT008
     C                     ENDIF                                          CFT008
     C           CCTCCY    IFNE *BLANKS                                   CFT008
     C                     MOVELSNDCTF    ##D,4                           CFT008
     C                     MOVE WTCCT     ##D,4                           CFT008
     C                     MOVELSUMCCT    ##D,5                           CFT008
     C                     MOVE WTCCT     ##D,5                           CFT008
     C                     ENDIF                                          CFT008
     C           CCTCCY    IFNE *BLANKS                                   CFT008
     C                     MOVE WTCCT     ##D,6                           CFT008
     C                     ENDIF                                          CFT008
     C                     MOVELSUMRCH    ##D,6                           CFT008
     C                     MOVELSNDCOR    ##D,7                           CFT008
     C                     MOVELRCVCOR    ##D,8                           CFT008
     C                     MOVELADNLI1    ##D,9                           CFT008
     C                     MOVELADNLI2    ##D,10                          CFT008
     C                     MOVELADNLI3    ##D,11                          CFT008
     C                     MOVELADNLI4    ##D,12                          CFT008
     C                     MOVELADNLI5    ##D,13                          CFT008
     C                     MOVELADNLI6    ##D,14                          CFT008
     C                     MOVELAKDRIP    ##D,15                          CFT008
     C                     MOVELAKDRDR    ##D,16                          CFT008
      *                                                                   CFT008
      **  Accumulate RDE's and associated data and output to              CFT008
      **  PF/CGUDTAPD.                                                    CFT008
      *                                                                   CFT008
     C                     EXSR SRADTA                                    CFT008
     C                     EXSR SRODTA                                    CFT008
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT008
      *................................................................   CFT008
      **  Unwind subroutine stack name                                    CFT008
      *                                                                   CFT008
     C                     MOVEA*BLANKS   @STK,Q                          CFT008
     C                     SUB  1         Q                               CFT008
      *                                                                   CFT008
     C                     ENDSR                                          CFT008
      *****************************************************************   CFT008
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  SRMT0                                          *   CFT006
      * Function    :  Messages Information I                         *   CFT006
      *                                                               *   CFT006
      * Called by   :  DRCR06                                         *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           SRMT0     BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'FT_MT0'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Retrieve subroutine specific data.                              CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVEL##SPAT    S#PATH                          CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\FT_MT0' ##PNAM                          CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Retrieve RDE information for RDEs in group set                  CFT006
      *                                                                   CFT006
     C                     MOVEL@STK,Q    ##GRPS                          CFT006
     C                     Z-ADD1         ##RDEN                          CFT006
     C                     EXSR SRRRDE                                    CFT006
      *                                                                   CFT006
     C                     MOVELBRCA      ##D,3                           CFT006
     C                     MOVELORBR      ##D,4                           CFT006
     C                     MOVELXRATE     ##D,6                           CFT006
     C                     MOVELXRATEO    ##D,7                           CFT006
     C                     MOVELGOPFLG    ##D,8                           CFT006
     C                     SELEC                                          CFT006
     C           ##FILE    WHEQ 'FT101H  '                                CFT006
     C                     MOVELPYTP      ##D,1                           CFT006
     C                     MOVELPYST      ##D,2                           CFT006
     C                     MOVELSINST     ##D,5                           CFT006
     C                     MOVELTDCHGS    ##D,9                           CFT006
     C                     MOVELRCHCCY    ##D,10                          CFT006
      *                                                                   CFT006
     C           RCHCCY    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   PRTCD   7                       CFT006
     C                     PARM '*KEY   ' POPTN   7                       CFT006
     C                     PARM RCHCCY    @AJCD                           CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           PRTCD     IFNE *BLANKS                                   CFT006
     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
     C                     MOVELRCHCCY    W0KEY            ***************CFT006
     C                     Z-ADD28        W0ERNB           * DB ERROR 28 *CFT006
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERR                                     CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE A6NBDP    ##D,11                          CFT006
     C                     ENDIF                                          CFT006
     C                     MOVELRCVCHG    ##D,11                          CFT006
     C                     MOVELRCPCCY    ##D,12                          CFT006
     C           RCPCCY    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   PRTCD   7                       CFT006
     C                     PARM '*KEY   ' POPTN   7                       CFT006
     C                     PARM RCPCCY    @AJCD                           CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           PRTCD     IFNE *BLANKS                                   CFT006
     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
     C                     MOVELRCPCCY    W0KEY            ***************CFT006
     C                     Z-ADD29        W0ERNB           * DB ERROR 29 *CFT006
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERR                                     CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE A6NBDP    ##D,13                          CFT006
     C                     ENDIF                                          CFT006
     C                     MOVELRCPCHG    ##D,13                          CFT006
     C                     MOVELRCTCCY    ##D,14                          CFT006
     C           RCTCCY    IFNE *BLANKS                                   CFT006
     C                     CALL 'AOCURRR0'                                CFT006
     C                     PARM *BLANKS   PRTCD   7                       CFT006
     C                     PARM '*KEY   ' POPTN   7                       CFT006
     C                     PARM RCTCCY    @AJCD                           CFT006
     C           SDCURR    PARM SDCURR    DSSDY                           CFT006
      *                                                                   CFT006
     C           PRTCD     IFNE *BLANKS                                   CFT006
     C                     MOVEL'SDCURRPD'W0FILE                          CFT006
     C                     MOVELRCTCCY    W0KEY            ***************CFT006
     C                     Z-ADD30        W0ERNB           * DB ERROR 30 *CFT006
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT006
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT006
     C                     EXSR SRERR                                     CFT006
     C                     ENDIF                                          CFT006
     C                     MOVE A6NBDP    ##D,15                          CFT006
     C                     ENDIF                                          CFT006
     C                     MOVELRCTCHG    ##D,15                          CFT006
     C           ##FILE    WHEQ 'FT102H  '                                CFT008
     C                     MOVELCCTTYP    ##D,1                           CFT008
     C                     MOVELCCTTST    ##D,2                           CFT008
     C                     MOVELSINSTX    ##D,5                           CFT008
     C                     MOVELCCYCHG    ##D,9                           CFT008
     C                     MOVELRCVCCY    ##D,10                          CFT008
     C           RCVCCY    IFNE *BLANKS                                   CFT008
     C                     CALL 'AOCURRR0'                                CFT008
     C                     PARM *BLANKS   PRTCD   7                       CFT008
     C                     PARM '*KEY   ' POPTN   7                       CFT008
     C                     PARM RCVCCY    @AJCD                           CFT008
     C           SDCURR    PARM SDCURR    DSSDY                           CFT008
      *                                                                   CFT008
     C           PRTCD     IFNE *BLANKS                                   CFT008
     C                     MOVEL'SDCURRPD'W0FILE                          CFT008
     C                     MOVELRCVCCY    W0KEY            ***************CFT008
     C                     Z-ADD31        W0ERNB           * DB ERROR 31 *CFT008
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT008
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT008
     C                     EXSR SRERR                                     CFT008
     C                     ENDIF                                          CFT008
     C                     MOVE A6NBDP    ##D,11                          CFT008
     C                     ENDIF                                          CFT008
     C                     MOVELRCVCHG    ##D,11                          CFT008
     C                     MOVELPAYCCY    ##D,12                          CFT008
     C           PAYCCY    IFNE *BLANKS                                   CFT008
     C                     MOVELRCVOCG    ##D,13                          CFT008
     C                     MOVE WPDCP     ##D,13                          CFT008
     C                     ENDIF                                          CFT008
     C                     MOVELCCTCCY    ##D,14                          CFT008
     C           CCTCCY    IFNE *BLANKS                                   CFT008
     C                     MOVELRCVCTF    ##D,15                          CFT008
     C                     MOVE WTCCT     ##D,15                          CFT008
     C                     ENDIF                                          CFT008
     C                     ENDSL                                          CFT006
      *                                                                   CFT006
      **  Accumulate RDE's and associated data and output to              CFT006
      **  PF/CGUDTAPD.                                                    CFT006
      *                                                                   CFT006
     C                     EXSR SRADTA                                    CFT006
     C                     EXSR SRODTA                                    CFT006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
      *................................................................   CFT006
      **  Unwind subroutine stack name                                    CFT006
      *                                                                   CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  SRMT1                                          *   CFT006
      * Function    :  Messages Information II                        *   CFT006
      *                                                               *   CFT006
      * Called by   :  DRCR06                                         *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           SRMT1     BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'FT_MT1'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Retrieve subroutine specific data.                              CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVEL##SPAT    S#PATH                          CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\FT_MT1' ##PNAM                          CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Retrieve RDE information for RDEs in group set                  CFT006
      *                                                                   CFT006
     C                     MOVEL@STK,Q    ##GRPS                          CFT006
     C                     Z-ADD1         ##RDEN                          CFT006
     C                     EXSR SRRRDE                                    CFT006
      *                                                                   CFT006
     C           ##FILE    IFEQ 'FT101H  '                                CFT006
      *                                                                   CFT006
     C           TOCUS1    IFNE *BLANKS                                   CFT006
     C                     MOVELTOCUS1    ##D,1                           CFT006
     C                     MOVELTOCUS2    ##D,2                           CFT006
     C                     MOVELTOCUS3    ##D,3                           CFT006
     C                     MOVELTOCUS4    ##D,4                           CFT006
     C                     MOVELTOCUS5    ##D,5                           CFT006
     C                     ELSE                                           CFT006
     C                     MOVELHOCUS1    ##D,1                           CFT006
     C                     MOVELHOCUS2    ##D,2                           CFT006
     C                     MOVELHOCUS3    ##D,3                           CFT006
     C                     MOVELHOCUS4    ##D,4                           CFT006
     C                     MOVELHOCUS5    ##D,5                           CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C           ##FILE    IFEQ 'FT102H  '                                CFT006
      *                                                                   CFT006
     C           TOCUS1    IFNE *BLANKS                                   CFT006
     C                     MOVELTOCUS1    ##D,1                           CFT006
     C                     MOVELTOCUS2    ##D,2                           CFT006
     C                     MOVELTOCUS3    ##D,3                           CFT006
     C                     MOVELTOCUS4    ##D,4                           CFT006
     C                     MOVEL*BLANKS   ##D,5                           CFT006
     C           CSW207    IFEQ 'Y'                                                         BUG15105
     C                     MOVELTOCUS5    ##D,5                                             BUG15105
     C                     ENDIF                                                            BUG15105
     C                     ELSE                                           CFT006
     C                     MOVELORDCU1    ##D,1                           CFT006
     C                     MOVELORDCU2    ##D,2                           CFT006
     C                     MOVELORDCU3    ##D,3                           CFT006
     C                     MOVELORDCU4    ##D,4                           CFT006
     C                     MOVEL*BLANKS   ##D,5                           CFT006
     C           CSW207    IFEQ 'Y'                                                           CSW207
     C                     MOVELORDCU5    ##D,5                                               CSW207
     C                     ENDIF                                                              CSW207
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     ENDIF                                          CFT006
      *                                                                   CFT006
     C                     SELEC                                          CFT006
     C           ##FILE    WHEQ 'FT101H  '                                CFT006
     C                     MOVELDCUSTP    ##D,6                           CFT006
     C                     MOVELTBNA35    ##D,7                           CFT006
     C                     MOVELTBNB35    ##D,8                           CFT006
     C                     MOVELTBNC35    ##D,9                           CFT006
     C                     MOVELTBND35    ##D,10                          CFT006
     C                     MOVELTBNE35    ##D,11                          CFT006
     C                     MOVELBENTTP    ##D,12                          CFT006
     C                     MOVELTRMA35    ##D,13                          CFT006
     C                     MOVELTRMB35    ##D,14                          CFT006
     C                     MOVELTRMC35    ##D,15                          CFT006
     C                     MOVELTRMD35    ##D,16                          CFT006
     C                     MOVELTRGA35    ##D,17                          CFT006
     C                     MOVELTRGB35    ##D,18                          CFT006
     C                     MOVELTRGC35    ##D,19                          CFT006
     C           ##FILE    WHEQ 'FT102H  '                                CFT008
     C                     MOVELCUSTTH    ##D,6                           CFT008
     C                     MOVELBENF1     ##D,7                           CFT008
     C                     MOVELBENF2     ##D,8                           CFT008
     C                     MOVELBENF3     ##D,9                           CFT008
     C                     MOVELBENF4     ##D,10                          CFT008
     C                     MOVELBENF5     ##D,11                          CFT008
     C                     MOVELBENTTD    ##D,12                          CFT008
     C                     MOVELREMI1     ##D,13                          CFT008
     C                     MOVELREMI2     ##D,14                          CFT008
     C                     MOVELREMI3     ##D,15                          CFT008
     C                     MOVELREMI4     ##D,16                          CFT008
     C                     MOVELREGRP1    ##D,17                          CFT008
     C                     MOVELREGRP2    ##D,18                          CFT008
     C                     MOVELREGRP3    ##D,19                          CFT008
     C                     ENDSL                                          CFT006
      *                                                                   CFT006
      **  Accumulate RDE's and associated data and output to              CFT006
      **  PF/CGUDTAPD.                                                    CFT006
      *                                                                   CFT006
     C                     EXSR SRADTA                                    CFT006
     C                     EXSR SRODTA                                    CFT006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
      *................................................................   CFT006
      **  Unwind subroutine stack name                                    CFT006
      *                                                                   CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
      /SPACE 5                                                            CFT006
      *****************************************************************   CFT006
      * Subroutine  :  SRMT2                                          *   CFT006
      * Function    :  Messages Information III                       *   CFT006
      *                                                               *   CFT006
      * Called by   :  DRCR06                                         *   CFT006
      * Calls       :                                                 *   CFT006
      *****************************************************************   CFT006
     C           SRMT2     BEGSR                                          CFT006
      *                                                                   CFT006
      **  Set up subroutine stack name                                    CFT006
     C                     ADD  1         Q                               CFT006
     C                     MOVEL'FT_MT2'  @STK,Q                          CFT006
      *                                                                   CFT006
      *................................................................   CFT006
      *                                                                   CFT006
      **  Retrieve subroutine specific data.                              CFT006
     C           1         OCUR ##SRDT                                    CFT006
     C                     MOVEL##SPAT    S#PATH                          CFT006
      *                                                                   CFT006
      **  Set up Path.                                                    CFT006
     C                     MOVEL'\FT_MT2' ##PNAM                          CFT006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT006
      **  Retrieve RDE information for RDEs in group set                  CFT006
      *                                                                   CFT006
     C                     MOVEL@STK,Q    ##GRPS                          CFT006
     C                     Z-ADD1         ##RDEN                          CFT006
     C                     EXSR SRRRDE                                    CFT006
      *                                                                   CFT006
     C                     MOVELTFTRNT    ##D,1                           CFT006
     C                     MOVELTFTREF    ##D,2                           CFT006
     C                     MOVELCQIN      ##D,3                           CFT006
     C                     MOVELSWPRIO    ##D,4                           CFT006
     C                     MOVELPYBCQS    ##D,5                           CFT006
     C                     MOVELINUSER    ##D,6                           CFT006
     C                     MOVELINDATE    ##D,7                           CFT006
     C                     MOVELINTIME    ##D,8                           CFT006
     C                     MOVELUPDUSR    ##D,9                           CFT006
     C                     MOVELUPDDTE    ##D,10                          CFT006
     C                     MOVELUPDTIM    ##D,11                          CFT006
     C                     MOVELAUP1      ##D,12                          CFT006
     C                     MOVELAUP2      ##D,13                          CFT006
     C                     MOVELAUIN      ##D,14                          CFT006
     C                     MOVELBAUTH     ##D,15                          CFT006
     C                     MOVELADVCRT    ##D,16                          CFT006
     C                     SELEC                                          CFT006
     C           ##FILE    WHEQ 'FT101H  '                                CFT006
     C                     MOVE WTRFT     ##D,17                          CFT006
     C                     MOVELTOTDBT    ##D,17                          CFT006
     C           ##FILE    WHEQ 'FT102H  '                                CFT008
     C                     MOVE WTCCT     ##D,17                          CFT008
     C                     MOVELCCTTDB    ##D,17                          CFT006
     C                     ENDSL                                          CFT006
     C                     MOVELAKEYID    ##D,18                          CFT006
     C                     MOVELAKEYDD    ##D,19                          CFT006
     C                     MOVELAKEYCD    ##D,20                          CFT006
      *                                                                   CFT006
      **  Accumulate RDE's and associated data and output to              CFT006
      **  PF/CGUDTAPD.                                                    CFT006
      *                                                                   CFT006
     C                     EXSR SRADTA                                    CFT006
     C                     EXSR SRODTA                                    CFT006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT006
      *................................................................   CFT006
      **  Unwind subroutine stack name                                    CFT006
      *                                                                   CFT006
     C                     MOVEA*BLANKS   @STK,Q                          CFT006
     C                     SUB  1         Q                               CFT006
      *                                                                   CFT006
     C                     ENDSR                                          CFT006
      *****************************************************************   CFT006
     C/SPACE 5
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  PYDRCR - Joins group sets PAYMNT, CR_CCY, and DR_CCY to free *   CFT014
      *           up 2 group sets.                                    *   CFT014
      *                                                               *   CFT014
      *  Called by   :  DRCR01, DRCR02                                *   CFT014
      *  Calls       :  SRRRDE, AODLSTR0, SRERR, AOCURRR0, AOCCYCV0   *   CFT014
      *                 SRADTA, SRODTA                                *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           PYDRCR    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'PYDRCR'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Retrieve subroutine specific data.                               CFT014
     C           1         OCUR ##SRDT                                    CFT014
     C                     MOVEL##SPAT    S#PATH                          CFT014
      *                                                                   CFT014
      ** Set up Path.                                                     CFT014
     C                     MOVEL'\PYDRCR' ##PNAM                          CFT014
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT014
      ** Retrieve RDE information for RDEs in group set                   CFT014
     C                     MOVEL@STK,Q    ##GRPS                          CFT014
     C                     Z-ADD1         ##RDEN                          CFT014
     C                     EXSR SRRRDE                                    CFT014
      *                                                                   CFT014
      *************************                                           CFT014
      ** Payment - Main data **                                           CFT014
      *************************                                           CFT014
      *                                                                   CFT014
      ** Payment Reference                                                CFT014
     C                     MOVELPREF      ##D,1                           CFT014
      *                                                                   CFT014
      ** Value Date                                                       CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C                     MOVELPVDT      ##D,2                           CFT014
     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
     C                     MOVELSLDT      ##D,2                           CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELDRVD      ##D,2                           CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVELCRVD      ##D,2                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Payment Date                                                     CFT014
     C                     MOVELBJRDNB    ##D,3                           CFT014
      *                                                                   CFT014
      ** Payment Type                                                     CFT014
     C                     MOVELPYTP      ##D,4                           CFT014
      *                                                                   CFT014
      ** Payment Sub-Type                                                 CFT014
     C                     MOVELPYST      ##D,5                           CFT014
      *                                                                   CFT014
      ** Obtain Payment Sub-Type Description                              CFT014
     C                     CALL 'AODLSTR0'                                CFT014
     C                     PARM *BLANKS   PRTCD   7                       CFT014
     C                     PARM '*KEY   ' POPTN   7                       CFT014
     C                     PARM PYST      PAQCD   3                       CFT014
     C           SDDLST    PARM SDDLST    DSFDY                           CFT014
     C           PRTCD     IFNE *BLANK                                    CFT014
     C                     MOVEL'SDDLSTPD'W0FILE                          CFT014
     C                     MOVELPYST      W0KEY                           CFT014
     C                     Z-ADD37        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Payment Sub-Type Description                                     CFT014
     C                     MOVELASDSTN    ##D,6                           CFT014
      *                                                                   CFT014
      ** Set up Settle Method                                             CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C                     MOVEL'00'      ##D,7                           CFT014
     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
     C                     MOVELSTMT      ##D,7                           CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELSTMT      ##D,7                           CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVEL'00'      ##D,7                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ****************************                                        CFT014
      ** Credit Cheque/Currency **                                        CFT014
      ****************************                                        CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVELCRCY      ##D,8                           CFT014
     C                     MOVELCRCY      PAJCD                           CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C           ##FILE    OREQ 'FT102H '                                 CFT014
     C                     MOVELPAYCCY    ##D,8                           CFT014
     C                     MOVELPAYCCY    PAJCD                           CFT014
     C                     OTHER                                          CFT014
     C                     MOVELPCCY      ##D,8                           CFT014
     C                     MOVELPCCY      PAJCD                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Obtain currency details                                          CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM           PAJCD   3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           PRTCD     IFNE *BLANK                                    CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     MOVELPAJCD     W0KEY                           CFT014
     C                     Z-ADD38        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Credit/Cheque Currency Name                                      CFT014
     C                     MOVELA6CYNM    ##D,9                           CFT014
      *                                                                   CFT014
      ** Credit/Cheque Amount                                             CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
     C                     MOVELPYAM      ##D,10                          CFT014
     C                     MOVE A6NBDP    ##D,10                          CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELCQAM      ##D,10                          CFT014
     C                     MOVE A6NBDP    ##D,10                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
      *                                                                   CFT014
      ** Calculate Credit currency equivalent                             CFT014
     C           MDIN      IFEQ 0                                         CFT014
     C                     MOVEL'D'       I#MDIN                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'M'       I#MDIN                          CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDRATE      I#RATE                          CFT014
     C                     Z-ADDCQAM      D#FAMT                          CFT014
     C                     MOVELSMCY      D#FCCY                          CFT014
     C                     MOVELCRCY      D#TCCY                          CFT014
     C                     CALL 'AOCCYCV0'             9090               CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*F*T*RAT'W0ACT                           CFT014
     C           D#DTA     PARM D#DTA     O#DTA                           CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           PRTCD     ORNE *BLANKS                                   CFT014
     C                     MOVEL'AOCCYCV0'W0FILE                          CFT014
     C                     MOVEL'*CALL   'W0KEY                           CFT014
     C                     Z-ADD39        W0ERNB                          CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDD#TAMT    W#AMT                           CFT014
     C                     MOVELD#TAMT    ##D,10                          CFT014
     C                     MOVE A6NBDP    ##D,10                          CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C           ##FILE    OREQ 'FT102H '                                 CFT014
     C                     MOVELPAYAMT    ##D,10                          CFT014
     C                     MOVE A6NBDP    ##D,10                          CFT014
     C                     Z-ADDA6NBDP    WPDCP   20                      CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Cheque Number                                                    CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C           ##FILE    OREQ 'FT102H '                                 CFT014
     C                     MOVELCHQNUM    ##D,11                          CFT014
     C                     OTHER                                          CFT014
     C                     MOVE *BLANKS   ##D,11                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Cheque Sequence Number                                           CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C           ##FILE    OREQ 'CQPAC  '                                 CFT014
     C                     MOVELCQSQ      ##D,12                          CFT014
     C                     OTHER                                          CFT014
     C                     MOVE *BLANKS   ##D,12                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Set up Credit Date                                               CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
     C                     MOVELPVDT      ##D,13                          CFT014
     C                     MOVELPVDT      ##D,13                          CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELPVDT      ##D,13                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVELCRVD      ##D,13                          CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C           ##FILE    OREQ 'FT102H '                                 CFT014
     C                     MOVELCRDVDT    ##D,13                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ********************                                                CFT014
      ** Debit Currency **                                                CFT014
      ********************                                                CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
     C           ##FILE    OREQ 'CQCOD  '                                 CFT014
     C                     MOVELSMCY      ##D,14                          CFT014
     C                     MOVELSMCY      PAJCD                           CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELDRCY      ##D,14                          CFT014
     C                     MOVELDRCY      PAJCD                           CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C                     MOVELTRNCCY    ##D,14                          CFT014
     C                     MOVELTRNCCY    PAJCD                           CFT014
     C           ##FILE    WHEQ 'FT102H '                                 CFT014
     C                     MOVELCCTCCY    ##D,14                          CFT014
     C                     MOVELCCTCCY    PAJCD                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Obtain currency details                                          CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM           PAJCD                           CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           PRTCD     IFNE *BLANK                                    CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     MOVELPAJCD     W0KEY                           CFT014
     C                     Z-ADD40        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     END                                            CFT014
      *                                                                   CFT014
      ** Debit Currency Name                                              CFT014
     C                     MOVELA6CYNM    ##D,15                          CFT014
      *                                                                   CFT014
      ** Debit Amount                                                     CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
     C                     MOVELSMAM      ##D,16                          CFT014
     C                     MOVE A6NBDP    ##D,16                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVELCQAM      ##D,16                          CFT014
     C                     MOVE A6NBDP    ##D,16                          CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
      *                                                                   CFT014
      ** Calculate Debit currency equivalent                              CFT014
     C           MDIN      IFEQ 0                                         CFT014
     C                     MOVEL'D'       I#MDIN                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVEL'M'       I#MDIN                          CFT014
     C                     ENDIF                                          CFT014
     C                     Z-ADDRATE      I#RATE                          CFT014
     C                     Z-ADDCQAM      D#FAMT                          CFT014
     C                     MOVELPCCY      D#FCCY                          CFT014
     C                     MOVELDRCY      D#TCCY                          CFT014
     C                     CALL 'AOCCYCV0'             9090               CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*F*T*RAT'W0ACT                           CFT014
     C           D#DTA     PARM D#DTA     O#DTA 256                       CFT014
     C           *IN90     IFEQ '1'                                       CFT014
     C           PRTCD     ORNE *BLANKS                                   CFT014
     C                     MOVEL'*CALL   'W0FILE                          CFT014
     C                     MOVEL'AOCCYCV0'W0KEY                           CFT014
     C                     Z-ADD41        W0ERNB                          CFT014
     C                     MOVEL'MEM5003' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     Z-ADDD#TAMT    W#AMT  150                      CFT014
     C                     MOVELD#TAMT    ##D,16                          CFT014
     C                     MOVE A6NBDP    ##D,16                          CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C                     MOVELTRNAMT    ##D,16                          CFT014
     C                     MOVE A6NBDP    ##D,16                          CFT014
     C                     Z-ADDA6NBDP    WTRFT   20                      CFT014
     C           ##FILE    WHEQ 'FT102H '                                 CFT014
     C                     MOVELCCTAMT    ##D,16                          CFT014
     C                     MOVE A6NBDP    ##D,16                          CFT014
     C                     Z-ADDA6NBDP    WTCCT   20                      CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Set up Debit Date                                                CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C           ##FILE    OREQ 'OTPAY  '                                 CFT014
     C                     MOVELSLDT      ##D,17                          CFT014
     C           ##FILE    WHEQ 'CQPAC  '                                 CFT014
     C                     MOVELDRVD      ##D,17                          CFT014
     C           ##FILE    WHEQ 'CQCOD  '                                 CFT014
     C                     MOVELSLDT      ##D,17                          CFT014
     C           ##FILE    WHEQ 'FT101H '                                 CFT014
     C           ##FILE    OREQ 'FT102H '                                 CFT014
     C                     MOVELDBTVDT    ##D,17                          CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
      ** Accumulate RDE's and associated data and output to               CFT014
      ** PF/CGUDTAPD.                                                     CFT014
     C                     EXSR SRADTA                                    CFT014
     C                     EXSR SRODTA                                    CFT014
      *                                                                   CFT014
      *................................................................   CFT014
      *                                                                   CFT014
     C           EXDRCR    TAG                                            CFT014
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRSRCH - Extract Receiver's and Sender's charges.            *   CFT014
      *                                                               *   CFT014
      *  Called by   :  DRCR01, DRCR02                                *   CFT014
      *                                                               *   CFT014
      *  Calls       :  SRRRDE, SRCURR, EURAMT, SRADTA, SRODTA        *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRSRCH    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'TRNCHG'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Retrieve subroutine specific data.                               CFT014
     C           1         OCUR ##SRDT                                    CFT014
     C                     MOVEL##SPAT    S#PATH                          CFT014
      *                                                                   CFT014
      ** Set up Path.                                                     CFT014
     C                     MOVEL'\TRNCHG' ##PNAM                          CFT014
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT014
      ** Retrieve RDE information for RDEs in group set                   CFT014
     C                     MOVEL@STK,Q    ##GRPS                          CFT014
     C                     Z-ADD1         ##RDEN                          CFT014
     C                     EXSR SRRRDE                                    CFT014
      *                                                                   CFT014
      ** Receiver's Charge                                                CFT014
     C                     MOVE *BLANK    WRCHIN  1                       CFT014
     C                     Z-ADD0         WNBDP0  10                      CFT014
     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
     C           DTCH      ANDEQ'OUR'                                     CFT014
     C           OPRCRM    ANDNE0                                         CFT014
     C                     MOVE PCCY      P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELOPRCRM    ##D,1                           CFT014
     C                     MOVE A6NBDP    ##D,1                           CFT014
     C                     MOVE A6INCY    WRCHIN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP0                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges                                                 CFT014
     C                     MOVE *BLANK    WSC1IN  1                       CFT014
     C                     MOVE *BLANK    WSC2IN  1                       CFT014
     C                     MOVE *BLANK    WSC3IN  1                       CFT014
     C                     MOVE *BLANK    WSC4IN  1                       CFT014
     C                     MOVE *BLANK    WSC5IN  1                       CFT014
     C                     Z-ADD0         WNBDP1  10                      CFT014
     C                     Z-ADD0         WNBDP2  10                      CFT014
     C                     Z-ADD0         WNBDP3  10                      CFT014
     C                     Z-ADD0         WNBDP4  10                      CFT014
     C                     Z-ADD0         WNBDP5  10                      CFT014
      *                                                                   CFT014
     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
     C           DTCH      ANDEQ'BEN'                                     CFT014
     C           ##FILE    OREQ 'INPAY  '                                 CFT014
     C           DTCH      ANDEQ'SHA'                                     CFT014
      *                                                                   CFT014
     C           INSCY1    IFNE *BLANKS                                   CFT014
     C                     MOVE INSCY1    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELINSCH1    ##D,2                           CFT014
     C                     MOVE A6NBDP    ##D,2                           CFT014
     C                     MOVELINSCY1    ##D,3                           CFT014
     C                     MOVE A6INCY    WSC1IN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP1                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFNE *BLANKS                                   CFT014
     C                     MOVE INSCY2    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELINSCH2    ##D,4                           CFT014
     C                     MOVE A6NBDP    ##D,4                           CFT014
     C                     MOVELINSCY2    ##D,5                           CFT014
     C                     MOVE A6INCY    WSC2IN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP2                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFNE *BLANKS                                   CFT014
     C                     MOVE INSCY3    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELINSCH3    ##D,6                           CFT014
     C                     MOVE A6NBDP    ##D,6                           CFT014
     C                     MOVELINSCY3    ##D,7                           CFT014
     C                     MOVE A6INCY    WSC3IN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP3                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFNE *BLANKS                                   CFT014
     C                     MOVE INSCY4    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELINSCH4    ##D,8                           CFT014
     C                     MOVE A6NBDP    ##D,8                           CFT014
     C                     MOVELINSCY4    ##D,9                           CFT014
     C                     MOVE A6INCY    WSC4IN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP4                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFNE *BLANKS                                   CFT014
     C                     MOVE INSCY5    P@CCY                           CFT014
     C                     EXSR SRCURR                                    CFT014
     C                     MOVELINSCH5    ##D,10                          CFT014
     C                     MOVE A6NBDP    ##D,10                          CFT014
     C                     MOVELINSCY5    ##D,11                          CFT014
     C                     MOVE A6INCY    WSC5IN                          CFT014
     C                     Z-ADDA6NBDP    WNBDP5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Receiver's Charges from Receiver's Charges ccy to Euro.          CFT014
      *                                                                   CFT014
     C           ##FILE    IFEQ 'OTPAY  '                                 CFT014
     C           DTCH      ANDEQ'OUR'                                     CFT014
     C           WRCHIN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE PCCY      P#FRCY                          CFT014
     C                     Z-ADDOPRCRM    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,12                          CFT014
     C                     MOVE WNBDP0    ##D,12                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Sender's Charges from Sender's Charges ccy to Euro.              CFT014
      *                                                                   CFT014
     C           ##FILE    IFEQ 'INPAY  '                                 CFT014
     C           DTCH      ANDEQ'BEN'                                     CFT014
     C           ##FILE    OREQ 'INPAY  '                                 CFT014
     C           DTCH      ANDEQ'SHA'                                     CFT014
      *                                                                   CFT014
     C           INSCY1    IFNE *BLANKS                                   CFT014
     C           WSC1IN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE INSCY1    P#FRCY                          CFT014
     C                     Z-ADDINSCH1    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,13                          CFT014
     C                     MOVE WNBDP1    ##D,13                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY2    IFNE *BLANKS                                   CFT014
     C           WSC2IN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE INSCY2    P#FRCY                          CFT014
     C                     Z-ADDINSCH2    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,14                          CFT014
     C                     MOVE WNBDP2    ##D,14                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY3    IFNE *BLANKS                                   CFT014
     C           WSC3IN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE INSCY3    P#FRCY                          CFT014
     C                     Z-ADDINSCH3    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,15                          CFT014
     C                     MOVE WNBDP3    ##D,15                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY4    IFNE *BLANKS                                   CFT014
     C           WSC4IN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE INSCY4    P#FRCY                          CFT014
     C                     Z-ADDINSCH4    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,16                          CFT014
     C                     MOVE WNBDP4    ##D,16                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C           INSCY5    IFNE *BLANKS                                   CFT014
     C           WSC5IN    ANDEQ'Y'                                       CFT014
     C                     CLEARP#0010                                    CFT014
     C                     MOVE INSCY5    P#FRCY                          CFT014
     C                     Z-ADDINSCH5    P#FRAM                          CFT014
     C                     MOVE BKEURO    #CCY                            CFT014
     C                     EXSR EURAMT                                    CFT014
     C                     MOVELW#TOAM    ##D,17                          CFT014
     C                     MOVE WNBDP5    ##D,17                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
      ** Accumulate RDE's and associated data and output to               CFT014
      ** PF/CGUDTAPD.                                                     CFT014
     C                     EXSR SRADTA                                    CFT014
     C                     EXSR SRODTA                                    CFT014
      *                                                                   CFT014
      **...............................................................   CFT014
      *                                                                   CFT014
     C           EXSRCH    TAG                                            CFT014
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT014
      ** Unwind subroutine stack name                                     CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRTRIB - Extract Third Reimbursement Institution.            *   CFT014
      *                                                               *   CFT014
      *  Called by   :  DRCR01, DRCR02                                *   CFT014
      *  Calls       :  SRRRDE, SRTPSR, CORDTA, SRADTA, SRODTA        *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRTRIB    BEGSR                                          CFT014
      *                                                                   CFT014
      ** Set up subroutine stack name                                     CFT014
     C                     ADD  1         Q                               CFT014
     C                     MOVEL'T_REIM'  @STK,Q                          CFT014
      *                                                                   CFT014
      ** Retrieve subroutine specific data.                               CFT014
     C           1         OCUR ##SRDT                                    CFT014
     C                     MOVEL##SPAT    S#PATH                          CFT014
      *                                                                   CFT014
      ** Set up Path.                                                     CFT014
     C                     MOVEL'\T_REIM' ##PNAM                          CFT014
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT014
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT014
      ** Retrieve RDE information for RDEs in group set                   CFT014
     C                     MOVEL'CORDTA'  ##GRPS                          CFT014
     C                     Z-ADD1         ##RDEN                          CFT014
     C                     EXSR SRRRDE                                    CFT014
      *                                                                   CFT014
     C                     SELEC                                          CFT014
     C           ##FILE    WHEQ 'INPAY   '                                CFT014
     C                     MOVELINTRIT    WTYPE                           CFT014
     C                     MOVELINTRIB    WPTY                            CFT014
     C                     MOVELINTRIB    WPTY1                           CFT014
     C                     MOVEL*BLANKS   WBRCA                           CFT014
      *                                                                   CFT014
     C           ##FILE    WHEQ 'OTPAY   '                                CFT014
     C                     MOVELOPTRIT    WTYPE                           CFT014
     C                     MOVELOPTRI1    WPTY                            CFT014
     C                     MOVELOPTRI1    WPTY1                           CFT014
     C                     MOVELOPTRI2    WPTY2                           CFT014
     C                     MOVEL*BLANKS   WBRCA                           CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     EXSR SRTPSR                                    CFT014
      *                                                                   CFT014
     C                     MOVEL*BLANKS   W#ADDR                          CFT014
     C                     SELEC                                          CFT014
      *                                                                   CFT014
     C           ##FILE    WHEQ 'INPAY  '                                 CFT014
     C                     MOVELINTRIT    #TYPE                           CFT014
     C                     MOVELCNA1      W#ADD1                          CFT014
     C                     MOVELCNA2      W#ADD2                          CFT014
     C                     MOVELCNA3      W#ADD3                          CFT014
     C                     MOVELCNA4      W#ADD4                          CFT014
     C                     MOVEL*BLANKS   W#ADD5                          CFT014
      *                                                                   CFT014
     C           ##FILE    WHEQ 'OTPAY  '                                 CFT014
     C                     MOVELOPTRIT    #TYPE                           CFT014
     C           OPTRIT    IFEQ 'A'                                       CFT014
     C                     MOVELOPTRI1    W#ADD1                          CFT014
     C                     MOVELOPTRI2    W#ADD2                          CFT014
     C                     MOVELOPTRI3    W#ADD3                          CFT014
     C                     MOVELOPTRI4    W#ADD4                          CFT014
     C                     MOVELOPTRI5    W#ADD5                          CFT014
     C                     ELSE                                           CFT014
     C                     MOVELCNA1      W#ADD1                          CFT014
     C                     MOVELCNA2      W#ADD2                          CFT014
     C                     MOVELCNA3      W#ADD3                          CFT014
     C                     MOVELCNA4      W#ADD4                          CFT014
     C                     MOVEL*BLANKS   W#ADD5                          CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSL                                          CFT014
      *                                                                   CFT014
     C                     EXSR CORDTA                                    CFT014
      *                                                                   CFT014
      **  Accumulate RDE's and associated data and output to              CFT014
      **  PF/CGUDTAPD.                                                    CFT014
      *                                                                   CFT014
     C                     EXSR SRADTA                                    CFT014
     C                     EXSR SRODTA                                    CFT014
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT014
      *................................................................   CFT014
      **  Unwind subroutine stack name                                    CFT014
      *                                                                   CFT014
     C                     MOVEA*BLANKS   @STK,Q                          CFT014
     C                     SUB  1         Q                               CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      *                                                               *   CFT014
      *  SRCURR - Retrieve currency details.                          *   CFT014
      *                                                               *   CFT014
      *  Called by: Any routine.                                      *   CFT014
      *  Calls: AOCURRR0                                              *   CFT014
      *                                                               *   CFT014
      *****************************************************************   CFT014
     C           SRCURR    BEGSR                                          CFT014
      *                                                                   CFT014
     C                     CALL 'AOCURRR0'                                CFT014
     C                     PARM *BLANKS   PRTCD                           CFT014
     C                     PARM '*KEY   ' POPTN                           CFT014
     C                     PARM           P@CCY   3                       CFT014
     C           SDCURR    PARM SDCURR    DSSDY                           CFT014
     C           PRTCD     IFNE *BLANKS                                   CFT014
     C                     MOVEL'SDCURRPD'W0FILE                          CFT014
     C                     MOVELP@CCY     W0KEY                           CFT014
     C                     Z-ADD36        W0ERNB                          CFT014
     C                     MOVEL'MEM5004' W0MSGD                          CFT014
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT014
     C                     EXSR SRERR                                     CFT014
     C                     ENDIF                                          CFT014
      *                                                                   CFT014
     C                     ENDSR                                          CFT014
      *****************************************************************   CFT014
      /EJECT                                                              CFT014
      *****************************************************************   CFT014
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  INFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           INFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTFCCCO    ##D,13                          CFT009
     C                     MOVELFXCHEC    ##D,14                          CFT009
     C                     MOVELCHCHCD    ##D,3                           CFT009
     C                     MOVELADCHCD    ##D,15                          CFT009
     C                     MOVELTLCODE    ##D,2                           CFT009
     C                     MOVELTLCHCD    ##D,16                          CFT009
     C                     MOVELMISCH     ##D,7                           CFT009
     C                     MOVELMSCH1     ##D,8                           CFT009
     C                     MOVELMSCH2     ##D,9                           CFT009
     C                     MOVELMSCH3     ##D,10                          CFT009
     C                     MOVELMSCH4     ##D,11                          CFT009
     C                     MOVELMSCH5     ##D,12                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSPSC    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  INENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           INENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     MOVELSMCY      ##WCCY  3                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVELPCCY      ##WCCY                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                    AR1082119
      **  Get Charge Currency                                                              AR1082119
      *                                                                                    AR1082119
     C                     EXSR SR#CCY                                                     AR1082119
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD44        W0ERNB           * DB ERROR 44 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTXCH      ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
     C                     MOVELADCH      ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
     C                     MOVELTRCM      ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELINCHCM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELCQCH      ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
     C                     MOVELTLCH      ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
     C                     MOVELMSCH      ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
     C                     MOVELMSC01     ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
     C                     MOVELMSC02     ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
     C                     MOVELMSC03     ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
     C                     MOVELMSC04     ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
     C                     MOVELMSC05     ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  INCHCM    SUMAMT 150                      CFT009
     C                     ADD  CQCH      SUMAMT                          CFT009
     C                     ADD  ADCH      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
     C                     ADD  TLCH      SUMAMT                          CFT009
     C                     ADD  MSCH      SUMAMT                          CFT009
     C                     ADD  MSC01     SUMAMT                          CFT009
     C                     ADD  MSC02     SUMAMT                          CFT009
     C                     ADD  MSC03     SUMAMT                          CFT009
     C                     ADD  MSC04     SUMAMT                          CFT009
     C                     ADD  MSC05     SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  INVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           INVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C           INVAT2    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT TXCH      VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C           INVAT3    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT CQCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C           INVAT1    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT TRCM      VAT    150H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           INVAT7    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT INCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           INVAT4    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT ADCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,14                          CFT009
     C                     MOVE A6NBDP    ##D,14                          CFT009
      *                                                                   CFT009
     C           INVAT5    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT TLCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,15                          CFT009
     C                     MOVE A6NBDP    ##D,15                          CFT009
      *                                                                   CFT009
     C           INVAT6    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C           VTMIC1    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSC01     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VTMIC2    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSC02     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VTMIC3    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSC03     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VTMIC4    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSC04     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VTMIC5    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT MSC05     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  INEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           INEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD45        W0ERNB           * DB ERROR 45 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTXCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDADCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT14  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT6   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSC01     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCM      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDINCHCM    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCQCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT2   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTLCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT15  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSC02     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSC03     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSC04     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSC05     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  INVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           INVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           INVAT3    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT14     VAT       H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,14                          CFT009
     C                     MOVE A6NBDP    ##D,14                          CFT009
      *                                                                   CFT009
     C           INVAT2    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT1      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C           INVAT6    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT6      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C           VTMIC1    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT7      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VTMIC2    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT8      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VTMIC3    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT9      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VTMIC4    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT10     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VTMIC5    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT11     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C           INVAT1    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT12     VAT    150H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           INVAT7    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           INVAT4    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT2      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C           INVAT5    IFEQ 'Y'                                       CFT009
     C           INVATR    MULT VAT15     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,15                          CFT009
     C                     MOVE A6NBDP    ##D,15                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
     C/SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  BBP                                            *   CFT009
      * Function    :  Branch, Book, Profit Centre Details            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR01                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           BBP       BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'BBP   '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\BBP   ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      ** Get Branch Details                                               CFT009
      *                                                                   CFT009
     C**********           CALL 'AOBRCHR0'                                             CFT009 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD                          CFT009
     C                     PARM '*KEY    '##OPTN                          CFT009
     C                     PARM BRCA      ##BRCD  3                       CFT009
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        CFT009 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           ##RTCD    IFNE *BLANK                                    CFT009
     C                     MOVEL'SDBRCHPD'W0FILE                          CFT009
     C                     MOVELBRCA      W0KEY            ***************CFT009
     C                     Z-ADD46        W0ERNB           * DB ERROR 46 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     END                                            CFT009
     C/COPY WNCPYSRC,CG4630C012                                           CFT009
      *                                                                   CFT009
      ** Branch                                                           CFT009
     C                     MOVELA8BRCD    ##D,1                           CFT009
      *                                                                   CFT009
      ** Branch Name                                                      CFT009
     C                     MOVELA8BRNM    ##D,2                           CFT009
      *                                                                   CFT009
     C/COPY WNCPYSRC,CG4630C013                                           CFT009
      *                                                                   CFT009
      ** Get Book Details                                                 CFT009
     C           BOKC      IFNE *BLANKS                                                     AR850312
     C                     CALL 'AOBOOKR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BOKC      @BOKC   2                       CFT009
     C           SDBOOK    PARM SDBOOK    DSFDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDBOOKPD'W0FILE                          CFT009
     C                     MOVELBOKC      W0KEY            ***************CFT009
     C                     Z-ADD47        W0ERNB           * DB ERROR 47 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     END                                            CFT009
     C                     ENDIF                                                            AR850312
      *                                                                   CFT009
      ** Book Code                                                        CFT009
     C                     MOVELBOKC      ##D,3                           CFT009
      *                                                                   CFT009
      ** Book Description                                                 CFT009
     C                     MOVELBDBKD     ##D,4                           CFT009
      *                                                                   CFT009
      **  Bypass if profit center blank.                                  CFT009
     C           PRFC      IFEQ *BLANKS                                   CFT009
     C                     GOTO EXOF@2                                    CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      **  Obtain Profit Centre details                                    CFT009
     C                     CALL 'AOPRFCR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM PRFC      @KEY    4                       CFT009
     C           SDPRFC    PARM SDPRFC    DSFDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDPRFCPD'W0FILE                          CFT009
     C                     MOVELPRFC      W0KEY            ***************CFT009
     C                     Z-ADD48        W0ERNB           * DB ERROR 48 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     END                                            CFT009
      *                                                                   CFT009
      ** Profit Centre                                                    CFT009
     C                     MOVELPRFC      ##D,5                           CFT009
      *                                                                   CFT009
      ** Profit Centre Description                                        CFT009
     C                     MOVELDSPCDS    ##D,6                           CFT009
      *                                                                   CFT009
     C           EXOF@2    TAG                                            CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Unwind subroutine stack name                                    CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  OTFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR02                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           OTFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTFCCCD    ##D,13                          CFT009
     C                     MOVELFXCACC    ##D,14                          CFT009
     C                     MOVELCHQCHC    ##D,3                           CFT009
     C                     MOVELCACHCD    ##D,4                           CFT009
     C                     MOVELTLXCDE    ##D,2                           CFT009
     C                     MOVELSPRCCD    ##D,6                           CFT009
     C                     MOVELSSTCCD    ##D,5                           CFT009
     C                     MOVELMSCHC     ##D,7                           CFT009
     C                     MOVELMSCHC1    ##D,8                           CFT009
     C                     MOVELMSCHC2    ##D,9                           CFT009
     C                     MOVELMSCHC3    ##D,10                          CFT009
     C                     MOVELMSCHC4    ##D,11                          CFT009
     C                     MOVELMSCHC5    ##D,12                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSRSC    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  OTENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR02                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           OTENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C           ADDC      IFEQ 'A'                                       CFT009
     C                     MOVELSMCY      ##WCCY  3                       CFT009
     C                     ELSE                                           CFT009
     C                     MOVELPCCY      ##WCCY                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                                    AR1082119
      **  Get Charge Currency                                                              AR1082119
      *                                                                                    AR1082119
     C                     EXSR SR#CCY                                                     AR1082119
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD49        W0ERNB           * DB ERROR 49 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTRCM      ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELOPCHCM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELCQCH      ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
     C                     MOVELCSTA      ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
     C                     MOVELTXCH      ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
     C                     MOVELSPCH      ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
     C                     MOVELSWSCHG    ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
     C                     MOVELMSCH      ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
     C                     MOVELMISC01    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
     C                     MOVELMISC02    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
     C                     MOVELMISC03    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
     C                     MOVELMISC04    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
     C                     MOVELMISC05    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  OPCHCM    SUMAMT 150                      CFT009
     C                     ADD  CQCH      SUMAMT                          CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
     C                     ADD  SPCH      SUMAMT                          CFT009
     C                     ADD  SWSCHG    SUMAMT                          CFT009
     C                     ADD  MSCH      SUMAMT                          CFT009
     C                     ADD  MISC01    SUMAMT                          CFT009
     C                     ADD  MISC02    SUMAMT                          CFT009
     C                     ADD  MISC03    SUMAMT                          CFT009
     C                     ADD  MISC04    SUMAMT                          CFT009
     C                     ADD  MISC05    SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  OTVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR02                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           OTVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           OPVAT1    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           OPVAT7    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT OPCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           OPVAT3    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT CQCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C           OPVAT4    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT CSTA      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           OPVAT2    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT TXCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C           OPVAT5    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT SPCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
      *                                                                   CFT009
     C           VTSWSC    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT SWSCHG    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
     C           OPVAT6    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MSCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C           VMIC1     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MISC01    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VMIC2     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MISC02    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VMIC3     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MISC03    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VMIC4     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MISC04    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VMIC5     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT MISC05    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  OTEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR02                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           OTEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD50        W0ERNB           * DB ERROR 50 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCM      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDOPCHCM    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCQCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT2   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCSTA      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTXCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDSPCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT5   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDSWSCHG    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT4   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMSCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT6   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMISC01    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMISC02    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMISC03    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMISC04    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMISC05    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  OTVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR02                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           OTVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           OPVAT1    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT12     VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           OPVAT7    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           OPVAT3    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT2      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C           OPVAT4    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT3      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           OPVAT2    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT1      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C           OPVAT5    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT5      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,5                           CFT009
     C                     MOVE A6NBDP    ##D,5                           CFT009
      *                                                                   CFT009
     C           VTSWSC    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT4      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
     C           OPVAT6    IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT6      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C           VMIC1     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT7      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VMIC2     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT8      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VMIC3     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT9      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VMIC4     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT10     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VMIC5     IFEQ 'Y'                                       CFT009
     C           OPVATR    MULT VAT11     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CPFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR03                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CPFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTFCMCC    ##D,13                          CFT009
     C                     MOVELFCHCCC    ##D,14                          CFT009
     C                     MOVELCSTACD    ##D,4                           CFT009
     C                     MOVELCOLCGC    ##D,17                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSSET    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CPENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR03                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CPENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVELDRCY      ##WCCY  3                       CFT009
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD51        W0ERNB           * DB ERROR 51 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTRCM      ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELPDCHCM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELCSTA      ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
     C                     MOVELCOLL      ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  PDCHCM    SUMAMT 150                      CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  COLL      SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CPVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR03                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CPVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           PDVAT1    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           PDVAT4    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT PDCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           PDVAT3    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT CSTA      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           PDVAT2    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT COLL      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CPEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR03                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CPEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD52        W0ERNB           * DB ERROR 52 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCM      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDPDCHCM    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCSTA      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCOLL      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT16  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CPVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR03                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CPVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           PDVAT1    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT VAT12     VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           PDVAT4    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           PDVAT3    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT VAT3      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           PDVAT2    IFEQ 'Y'                                       CFT009
     C           PDVATR    MULT VAT16     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CCFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR04                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CCFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTRCMCC    ##D,13                          CFT009
     C                     MOVELFXCCCC    ##D,14                          CFT009
     C                     MOVELCABCCD    ##D,4                           CFT009
     C                     MOVELCOCHCD    ##D,17                          CFT009
     C                     MOVELTLXCHD    ##D,2                           CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSPDS    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CCENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR04                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CCENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVELCRCY      ##WCCY  3                       CFT009
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD53        W0ERNB           * DB ERROR 53 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTRCM      ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELCCCHCM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELCSTA      ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
     C                     MOVELCOLL      ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
     C                     MOVELTXCH      ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCM      ADD  CCCHCM    SUMAMT 150                      CFT009
     C                     ADD  CSTA      SUMAMT                          CFT009
     C                     ADD  COLL      SUMAMT                          CFT009
     C                     ADD  TXCH      SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CCVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR04                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CCVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           CCVAT1    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT TRCM      VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           CCVAT5    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT CCCHCM    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           CCVAT3    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT CSTA      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           CCVAT2    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT COLL      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
      *                                                                   CFT009
     C           CCVAT4    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT TXCH      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CCEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR04                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CCEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD54        W0ERNB           * DB ERROR 54 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCM      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCCCHCM    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCSTA      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,6                           CFT009
     C                     MOVE A6NBDP    ##D,6                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT3   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDCOLL      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT16  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTXCH      P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,4                           CFT009
     C                     MOVE A6NBDP    ##D,4                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT1   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CCVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR04                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CCVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           CCVAT1    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT VAT12     VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           CCVAT5    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           CCVAT3    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT VAT3      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C           CCVAT2    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT VAT16     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,16                          CFT009
     C                     MOVE A6NBDP    ##D,16                          CFT009
      *                                                                   CFT009
     C           CCVAT4    IFEQ 'Y'                                       CFT009
     C           CCVATR    MULT VAT1      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  RFFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR05                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           RFFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTFCOCC    ##D,13                          CFT009
     C                     MOVELFXCCCD    ##D,14                          CFT009
     C                     MOVELIMICC1    ##D,8                           CFT009
     C                     MOVELIMICC2    ##D,9                           CFT009
     C                     MOVELIMICC3    ##D,10                          CFT009
     C                     MOVELIMICC4    ##D,11                          CFT009
     C                     MOVELIMICC5    ##D,12                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSRST    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  RFENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR05                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           RFENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVELM1CHGC    ##WCCY  3                       CFT009
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C           ##WCCY    IFNE *BLANKS                                                     BUG15265
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD55        W0ERNB           * DB ERROR 55 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
     C                     ENDIF                                                            BUG15265
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTRCHCC    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELFXCHGC    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELIMICH1    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
     C                     MOVELIMICH2    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
     C                     MOVELIMICH3    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
     C                     MOVELIMICH4    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
     C                     MOVELIMICH5    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCHCC    ADD  FXCHGC    SUMAMT 150                      CFT009
     C                     ADD  IMICH1    SUMAMT                          CFT009
     C                     ADD  IMICH2    SUMAMT                          CFT009
     C                     ADD  IMICH3    SUMAMT                          CFT009
     C                     ADD  IMICH4    SUMAMT                          CFT009
     C                     ADD  IMICH5    SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  RFVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR05                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           RFVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           VTCOCH    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT TRCHCC    VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           VTFCCC    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT FXCHGC    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           VIMIC1    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT IMICH1    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VIMIC2    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT IMICH2    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VIMIC3    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT IMICH3    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VIMIC4    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT IMICH4    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VIMIC5    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT IMICH5    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  RFEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR05                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           RFEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD56        W0ERNB           * DB ERROR 56 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCHCC    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDFXCHGC    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDIMICH1    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDIMICH2    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDIMICH3    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDIMICH4    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDIMICH5    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  RFVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR05                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           RFVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           VTCOCH    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT12     VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           VTFCCC    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           VIMIC1    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT7      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VIMIC2    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT8      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VIMIC3    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT9      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VIMIC4    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT10     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VIMIC5    IFEQ 'Y'                                       CFT009
     C           VATRAT    MULT VAT11     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CTFEES                                         *   CFT009
      * Function    :  Fees & Charges Information                     *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR06                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CTFEES    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CFT009'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CFT009' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVEL'Y'       ##D,1                           CFT009
      *                                                                   CFT009
      ** Charge code                                                      CFT009
      *                                                                   CFT009
     C                     MOVELTRCOCC    ##D,13                          CFT009
     C                     MOVELFXCCC     ##D,14                          CFT009
     C                     MOVELMICCD1    ##D,8                           CFT009
     C                     MOVELMICCD2    ##D,9                           CFT009
     C                     MOVELMICCD3    ##D,10                          CFT009
     C                     MOVELMICCD4    ##D,11                          CFT009
     C                     MOVELMICCD5    ##D,12                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
     C                     MOVEL'Y'       ##D,18                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** FX Spread Set                                                    CFT009
      *                                                                   CFT009
     C                     MOVELFXSSCD    ##D,19                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CTENTC                                         *   CFT009
      * Function    :  Entered Charges                                *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR06                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CTENTC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGENT'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGENT' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     MOVELM2CHGC    ##WCCY  3                       CFT009
      *                                                                   CFT009
      **  Charge currency                                                 CFT009
     C                     MOVEL##WCCY    ##D,1                           CFT009
      *                                                                   CFT009
      **  Obtain currency details                                         CFT009
     C           ##WCCY    IFNE *BLANKS                                                     BUG15265
     C           M2CHGC    IFNE *BLANKS                                                     BUG12827
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD   7                       CFT009
     C                     PARM '*KEY   ' @OPTN   7                       CFT009
     C                     PARM ##WCCY    @AJCD   3                       CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
      *                                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL##WCCY    W0KEY            ***************CFT009
     C                     Z-ADD57        W0ERNB           * DB ERROR 57 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
     C                     ENDIF                                                            BUG12827
      *                                                                   CFT009
     C                     MOVELA6INCY    WCHGIN  1                       CFT009
     C                     ENDIF                                                            BUG15265
      *                                                                   CFT009
      ** Amount                                                           CFT009
      *                                                                   CFT009
     C                     MOVELTRCOCH    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
     C                     MOVELFXCHAC    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
     C                     MOVELMICH1     ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
     C                     MOVELMICH2     ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
     C                     MOVELMICH3     ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
     C                     MOVELMICH4     ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
     C                     MOVELMICH5     ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                   CFT009
      ** Totals                                                           CFT009
      *                                                                   CFT009
     C           TRCOCH    ADD  FXCHAC    SUMAMT 150                      CFT009
     C                     ADD  MICH1     SUMAMT                          CFT009
     C                     ADD  MICH2     SUMAMT                          CFT009
     C                     ADD  MICH3     SUMAMT                          CFT009
     C                     ADD  MICH4     SUMAMT                          CFT009
     C                     ADD  MICH5     SUMAMT                          CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CTVATA                                         *   CFT009
      * Function    :  Entered Charges VAT                            *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR06                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CTVATA    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATA  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATA  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           VTRCC     IFEQ 'Y'                                       CFT009
     C           VARATE    MULT TRCOCH    VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           VAFCCC    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT FXCHAC    VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           VMICH1    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT MICH1     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VMICH2    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT MICH2     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VMICH3    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT MICH3     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VMICH4    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT MICH4     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VMICH5    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT MICH5     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CTEURC                                         *   CFT009
      * Function    :  Euro charges                                   *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR06                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CTEURC    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'CHGEUR'  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\CHGEUR' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
      **  Determine the number of decimal places for Euro                 CFT009
      *                                                                   CFT009
     C                     CALL 'AOCURRR0'                                CFT009
     C                     PARM *BLANKS   @RTCD                           CFT009
     C                     PARM '*KEY   ' @OPTN                           CFT009
     C                     PARM BKEURO    @AJCD                           CFT009
     C           SDCURR    PARM SDCURR    DSSDY                           CFT009
      *                                                                   CFT009
      ** DATABASE ERROR                                                   CFT009
     C           @RTCD     IFNE *BLANK                                    CFT009
     C                     MOVEL'SDCURRPD'W0FILE                          CFT009
     C                     MOVEL#CCY      W0KEY            ***************CFT009
     C                     Z-ADD58        W0ERNB           * DB ERROR 58 *CFT009
     C                     MOVEL'MEM5004' W0MSGD           ***************CFT009
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT009
     C                     EXSR SRERR                                     CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
      ** Euro Currency                                                    CFT009
     C                     MOVELBKEURO    ##D,1                           CFT009
     C                     MOVELBKEURO    #CCY                            CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDTRCOCH    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,2                           CFT009
     C                     MOVE A6NBDP    ##D,2                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT12  170                      CFT009
     C                     Z-ADDW#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDFXCHAC    P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,3                           CFT009
     C                     MOVE A6NBDP    ##D,3                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT13  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMICH1     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT7   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMICH2     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,18                          CFT009
     C                     MOVE A6NBDP    ##D,18                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT8   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMICH3     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,19                          CFT009
     C                     MOVE A6NBDP    ##D,19                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT9   170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMICH4     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,20                          CFT009
     C                     MOVE A6NBDP    ##D,20                          CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT10  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     MOVEL##SDS     ##ADS                           CFT009
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     Z-ADD21        ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     CLEARP#0010                                    CFT009
     C                     MOVE ##WCCY    P#FRCY                          CFT009
     C                     Z-ADDMICH5     P#FRAM                          CFT009
     C                     EXSR EURAMT                                    CFT009
     C                     MOVELW#TOAM    ##D,1                           CFT009
     C                     MOVE A6NBDP    ##D,1                           CFT009
      *                                                                   CFT009
     C                     Z-ADDW#TOAM    VAT11  170                      CFT009
     C                     ADD  W#TOAM    SUMAMT                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
     C                     EXSR SRADTA                                    CFT009
     C           ##SDS     CAT  ##ADS:0   ##SDS                           CFT009
      *                                                                   CFT009
      **  Initialise Write Format Parameter.                              CFT009
     C                     CLEARW0FMT                                     CFT009
      *                                                                   CFT009
      **  Set up Control Information.                                     CFT009
     C                     Z-ADD##ITEM    DEITEM                          CFT009
     C                     ADD  1         ##OSEQ                          CFT009
     C                     Z-ADD##OSEQ    DEOSEQ                          CFT009
     C                     Z-ADD1         DEPBIN                          CFT009
     C                     Z-ADD1         DETBIN                          CFT009
     C                     MOVE 'FR'      DEFSLI                          CFT009
     C                     MOVE *BLANKS   W0PATH                          CFT009
     C                     MOVELS#PATH    W0PATH                          CFT009
      *                                                                   CFT009
      **  Append Data from pack routine.                                  CFT009
     C           W0FMT     CAT  ##SDS:0   W0FMT                           CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CFT009
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      *                                                                   CFT009
      /SPACE 5                                                            CFT009
      *****************************************************************   CFT009
      * Subroutine  :  CTVATE                                         *   CFT009
      * Function    :  Euro Charges VAT                               *   CFT009
      *                                                               *   CFT009
      * Called by   :  DRCR06                                         *   CFT009
      * Calls       :                                                 *   CFT009
      *****************************************************************   CFT009
     C           CTVATE    BEGSR                                          CFT009
      *                                                                   CFT009
      **  Set up subroutine stack name                                    CFT009
     C                     ADD  1         Q                               CFT009
     C                     MOVEL'VATE  '  @STK,Q                          CFT009
      *                                                                   CFT009
      *................................................................   CFT009
      *                                                                   CFT009
      **  Retrieve subroutine specific data.                              CFT009
     C           1         OCUR ##SRDT                                    CFT009
     C                     MOVEL##SPAT    S#PATH                          CFT009
      *                                                                   CFT009
      **  Set up Path.                                                    CFT009
     C                     MOVEL'\VATE  ' ##PNAM                          CFT009
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CFT009
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CFT009
      **  Retrieve RDE information for RDEs in group set                  CFT009
      *                                                                   CFT009
     C                     MOVEL@STK,Q    ##GRPS                          CFT009
     C                     Z-ADD1         ##RDEN                          CFT009
     C                     EXSR SRRRDE                                    CFT009
      *                                                                   CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
      *                                                                   CFT009
     C           CFT10     IFEQ 'Y'                                       CFT009
      *                                                                   CFT009
     C           VTRCC     IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT12     VAT    150H                     CFT009
     C                     Z-ADDVAT       SUMVAT 150                      CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     Z-ADD0         SUMVAT                          CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     MOVELVAT       ##D,12                          CFT009
     C                     MOVE A6NBDP    ##D,12                          CFT009
      *                                                                   CFT009
     C           VAFCCC    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT13     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,13                          CFT009
     C                     MOVE A6NBDP    ##D,13                          CFT009
      *                                                                   CFT009
     C           VMICH1    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT7      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,7                           CFT009
     C                     MOVE A6NBDP    ##D,7                           CFT009
      *                                                                   CFT009
     C           VMICH2    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT8      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,8                           CFT009
     C                     MOVE A6NBDP    ##D,8                           CFT009
      *                                                                   CFT009
     C           VMICH3    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT9      VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,9                           CFT009
     C                     MOVE A6NBDP    ##D,9                           CFT009
      *                                                                   CFT009
     C           VMICH4    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT10     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,10                          CFT009
     C                     MOVE A6NBDP    ##D,10                          CFT009
      *                                                                   CFT009
     C           VMICH5    IFEQ 'Y'                                       CFT009
     C           VARATE    MULT VAT11     VAT       H                     CFT009
     C                     ELSE                                           CFT009
     C                     Z-ADD0         VAT                             CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C                     ADD  VAT       SUMVAT                          CFT009
     C                     MOVELVAT       ##D,11                          CFT009
     C                     MOVE A6NBDP    ##D,11                          CFT009
      *                                                                   CFT009
     C                     ENDIF                                          CFT009
      *                                                                   CFT009
     C           SUMAMT    ADD  SUMVAT    SUMCHG 150                      CFT009
     C                     MOVELSUMCHG    ##D,17                          CFT009
     C                     MOVE A6NBDP    ##D,17                          CFT009
      *                                                                   CFT009
      **  Accumulate RDE's and associated data and output to              CFT009
      **  PF/CGUDTAPD.                                                    CFT009
      *                                                                   CFT009
     C                     EXSR SRADTA                                    CFT009
     C                     EXSR SRODTA                                    CFT009
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................   CFT009
      **  Unwind subroutine stack name                                    CFT009
      *                                                                   CFT009
     C                     MOVEA*BLANKS   @STK,Q                          CFT009
     C                     SUB  1         Q                               CFT009
      *                                                                   CFT009
     C                     ENDSR                                          CFT009
      /SPACE 5                                                                                CSW201
      *****************************************************************                       CSW201
      *                                                               *                       CSW201
      *  SRSCGH - CCT Sender Charges Subroutine                       *                       CSW201
      *                                                               *                       CSW201
      *  Called by: DRCR06 - Customer Credit Transfer                 *                       CSW201
      *  Calls: None                                                  *                       CSW201
      *                                                               *                       CSW201
      *****************************************************************                       CSW201
     C           SRSCGH    BEGSR                                                              CSW201
      ** Set up subroutine stack name                                                         CSW201
     C                     ADD  1         Q                                                   CSW201
     C                     MOVEL'FT_SCH'  @STK,Q                                              CSW201
      ** Retrieve subroutine specific data                                                    CSW201
     C           1         OCUR ##SRDT                                                        CSW201
     C                     MOVEL##SPAT    S#PATH                                              CSW201
      ** Setup Path                                                                           CSW201
     C                     MOVEL'\FT_SCH' ##PNAM                                              CSW201
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CSW201
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      ** Retrieve RDE information for RDEs in group set                                       CSW201
     C                     MOVEL@STK,Q    ##GRPS                                              CSW201
     C                     Z-ADD1         ##RDEN                                              CSW201
     C                     EXSR SRRRDE                                                        CSW201
      ** Set up fields                                                                        CSW201
     C                     MOVELSDCCY2    ##D,1                                               CSW201
     C           SDCCY2    IFNE *BLANKS                                                       CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   PRTCD                                               CSW201
     C                     PARM '*KEY   ' POPTN                                               CSW201
     C                     PARM SDCCY2    @AJCD                                               CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
     C           PRTCD     IFNE *BLANKS                                                       CSW201
     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
     C                     MOVELSDCCY2    W0KEY            ************                       CSW201
     C                     Z-ADD59        W0ERNB           * DBERR 59 *                       CSW201
     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVE A6NBDP    ##D,2                                               CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCHG2    ##D,2                                               CSW201
     C           PAYCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDOCG2    ##D,3                                               CSW201
     C                     MOVE WPDCP     ##D,3                                               CSW201
     C                     ENDIF                                                              CSW201
     C           CCTCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDCTF2    ##D,4                                               CSW201
     C                     MOVE WTCCT     ##D,4                                               CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCCY3    ##D,5                                               CSW201
     C           SDCCY3    IFNE *BLANKS                                                       CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   PRTCD                                               CSW201
     C                     PARM '*KEY   ' POPTN                                               CSW201
     C                     PARM SDCCY3    @AJCD                                               CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
     C           PRTCD     IFNE *BLANKS                                                       CSW201
     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
     C                     MOVELSDCCY3    W0KEY            ************                       CSW201
     C                     Z-ADD60        W0ERNB           * DBERR 60 *                       CSW201
     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVE A6NBDP    ##D,6                                               CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCHG3    ##D,6                                               CSW201
     C           PAYCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDOCG3    ##D,7                                               CSW201
     C                     MOVE WPDCP     ##D,7                                               CSW201
     C                     ENDIF                                                              CSW201
     C           CCTCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDCTF3    ##D,8                                               CSW201
     C                     MOVE WTCCT     ##D,8                                               CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCCY4    ##D,9                                               CSW201
     C           SDCCY4    IFNE *BLANKS                                                       CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   PRTCD                                               CSW201
     C                     PARM '*KEY   ' POPTN                                               CSW201
     C                     PARM SDCCY4    @AJCD                                               CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
     C           PRTCD     IFNE *BLANKS                                                       CSW201
     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
     C                     MOVELSDCCY4    W0KEY            ************                       CSW201
     C                     Z-ADD61        W0ERNB           * DBERR 61 *                       CSW201
     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVE A6NBDP    ##D,10                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCHG4    ##D,10                                              CSW201
     C           PAYCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDOCG4    ##D,11                                              CSW201
     C                     MOVE WPDCP     ##D,11                                              CSW201
     C                     ENDIF                                                              CSW201
     C           CCTCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDCTF4    ##D,12                                              CSW201
     C                     MOVE WTCCT     ##D,12                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCCY5    ##D,13                                              CSW201
     C           SDCCY5    IFNE *BLANKS                                                       CSW201
     C                     CALL 'AOCURRR0'                                                    CSW201
     C                     PARM *BLANKS   PRTCD                                               CSW201
     C                     PARM '*KEY   ' POPTN                                               CSW201
     C                     PARM SDCCY5    @AJCD                                               CSW201
     C           SDCURR    PARM SDCURR    DSSDY                                               CSW201
     C           PRTCD     IFNE *BLANKS                                                       CSW201
     C                     MOVEL'SDCURRPD'W0FILE                                              CSW201
     C                     MOVELSDCCY5    W0KEY            ************                       CSW201
     C                     Z-ADD62        W0ERNB           * DBERR 62 *                       CSW201
     C                     MOVEL'MEM5004' W0MSGD           ************                       CSW201
     C                     MOVEL'MIDAS  ' W0MSGF                                              CSW201
     C                     EXSR SRERR                                                         CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVE A6NBDP    ##D,14                                              CSW201
     C                     ENDIF                                                              CSW201
     C                     MOVELSDCHG5    ##D,14                                              CSW201
     C           PAYCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDOCG5    ##D,15                                              CSW201
     C                     MOVE WPDCP     ##D,15                                              CSW201
     C                     ENDIF                                                              CSW201
     C           CCTCCY    IFNE *BLANKS                                                       CSW201
     C                     MOVELSDCTF5    ##D,16                                              CSW201
     C                     MOVE WTCCT     ##D,16                                              CSW201
     C                     ENDIF                                                              CSW201
      ** Accumulate RDE's and associated data and output to                                   CSW201
      ** PF/CGUDTAPD.                                                                         CSW201
     C                     EXSR SRADTA                                                        CSW201
     C                     EXSR SRODTA                                                        CSW201
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *................................................................                       CSW201
      ** Unwind subroutine stack name                                                         CSW201
     C                     MOVEA*BLANKS   @STK,Q                                              CSW201
     C                     SUB  1         Q                                                   CSW201
     C                     ENDSR                                                              CSW201
      *****************************************************************                       CFT032
     C/EJECT                                                                                  CFT032
      *****************************************************************                       CFT032
      *                                                               *                       CFT032
      *  SRIBAN - Retrieve Account Information for IBAN               *                       CFT032
      *                                                               *                       CFT032
      *  Called By: CORDTA, O@CUST Subroutine                         *                       CFT032
      *                                                               *                       CFT032
      *  Calls: AOIBANR4                                              *                       CFT032
      *                                                               *                       CFT032
      *****************************************************************                       CFT032
      *                                                                                       CFT032
     C           SRIBAN    BEGSR                                                              CFT032
      *                                                                                       CFT032
     C                     CALL 'AOIBANR4'                                                    CFT032
     C                     PARM *BLANKS   @RTCD                                               CFT032
     C                     PARM '*KEY   ' @OPTN                                               CFT032
     C                     PARM           WIBAN                                               CFT032
     C           SDACCT    PARM           DSSDY                                               CFT032
      *                                                                                       CFT032
     C                     ENDSR                                                              CFT032
      *****************************************************************                       CSW201
      /EJECT                                                                                  CSW201
      *****************************************************************                       CSW201
      *                                                               *                       CER031
      *  SRIPNR    - Retrieve Extended Narratives for Incoming        *                       CER031
      *              Payments                                         *                       CER031
      *                                                               *                       CER031
      *  Called By - DRCR01                                           *                       CER031
      *                                                               *                       CER031
      *  Calls     - None                                             *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
      *                                                                                       CER031
     C           SRIPNR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'SRIPNR ' @STK,Q                                              CER031
      *                                                                                       CER031
      ** Setup Account information fields (Beneficiary Customer)                              CER031
      *                                                                                       CER031
     C                     MOVE BNCT      WTYPE                                               CER031
     C                     MOVE PCCY      WCCY                                                CER031
     C                     MOVE BNC1      WPTY1                                               CER031
     C                     MOVE BNC2      WPTY2                                               CER031
     C                     MOVE *BLANKS   WBRCA                                               CER031
     C                     EXSR SRTPSR                                                        CER031
      *                                                                                       CER031
     C                     MOVE W0BRCA    PBRCA   3                                           CER031
     C**********           MOVE W0CNUM    PCUSNO  60                                   CER031 CER059
     C                     MOVE W0CNUM    PCUSNO  6                                           CER059
     C                     MOVE W#CCY     PCUCD   3                                           CER031
     C                     MOVE W0ACOD    PACCD                                               CER031
     C                     MOVE W0ACSQ    PACSQ                                               CER031
      *                                                                                       CER031
      ** Extract Credit Narratives                                                            CER031
      *                                                                                       CER031
     C                     MOVELIEXT1     PNARR1                                              CER031
     C                     MOVELIEXT2     PNARR2                                              CER031
     C                     MOVELIEXT3     PNARR3                                              CER031
     C                     MOVELIEXT4     PNARR4                                              CER031
     C                     MOVELIEXT5     PNARR5                                              CER031
     C                     MOVELIEXT6     PNARR6                                              CER031
     C                     EXSR CEXNAR                                                        CER031
      *                                                                                       CER031
     C                     MOVE *BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
      *****************************************************************                       CER031
     C/EJECT                                                                                  CER031
      *****************************************************************                       CER031
      *                                                               *                       CER031
      *  SROPNR    - Retrieve Extended Narratives for Outgoing        *                       CER031
      *              Payments                                         *                       CER031
      *                                                               *                       CER031
      *  Called By - DRCR02                                           *                       CER031
      *                                                               *                       CER031
      *  Calls     - None                                             *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
      *                                                                                       CER031
     C           SROPNR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'SROPNR ' @STK,Q                                              CER031
      *                                                                                       CER031
      ** Setup Account information fields (Ordering Customer)                                 CER031
      *                                                                                       CER031
     C                     MOVE ORCT      WTYPE                                               CER031
     C           1         SUBSTORC1:1    WSLSH     P                                         CER031
      *                                                                                       CER031
     C           WSLSH     IFEQ '/'                                                           CER031
     C           18        SUBSTORC1:2    WPTY                                                CER031
      *                                                                                       CER031
     C           ORCT      IFEQ 'R'                                                           CER031
     C           ORCT      OREQ 'P'                                                           CER031
     C           ORCT      OREQ 'I'                                                           CER031
     C           34        SUBSTORC1:2    WPTY1     P                                         CER031
     C                     ELSE                                                               CER031
      *                                                                                       CER031
     C                     MOVE ORC2      WPTY1                                               CER031
     C                     ENDIF                                                              CER031
     C                     ELSE                                                               CER031
      *                                                                                       CER031
     C                     MOVELORC1      WPTY                                                CER031
     C                     MOVELORC1      WPTY1                                               CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
     C                     MOVE SMCY      WCCY                                                CER031
     C                     MOVE ORC2      WPTY2                                               CER031
     C                     MOVE *BLANKS   WBRCA                                               CER031
     C                     EXSR SRTPSR                                                        CER031
      *                                                                                       CER031
     C                     MOVE W0BRCA    PBRCA                                               CER031
     C                     MOVE W0CNUM    PCUSNO                                              CER031
     C                     MOVE W#CCY     PCUCD                                               CER031
     C                     MOVE W0ACOD    PACCD                                               CER031
     C                     MOVE W0ACSQ    PACSQ                                               CER031
      *                                                                                       CER031
      ** Extract Debit Narratives                                                             CER031
      *                                                                                       CER031
     C                     MOVELOPEXT1    PNARR1                                              CER031
     C                     MOVELOPEXT2    PNARR2                                              CER031
     C                     MOVELOPEXT3    PNARR3                                              CER031
     C                     MOVELOPEXT4    PNARR4                                              CER031
     C                     MOVELOPEXT5    PNARR5                                              CER031
     C                     MOVELOPEXT6    PNARR6                                              CER031
     C                     EXSR DEXNAR                                                        CER031
      *                                                                                       CER031
      ** Setup Account information fields (Destination Customer)                              CER031
      *                                                                                       CER031
     C                     MOVE DSTT      WTYPE                                               CER031
     C                     MOVE PCCY      WCCY                                                CER031
     C                     MOVE DST1      WPTY1                                               CER031
     C                     MOVE DST2      WPTY2                                               CER031
     C                     MOVE *BLANKS   WBRCA                                               CER031
     C                     EXSR SRTPSR                                                        CER031
      *                                                                                       CER031
     C                     MOVE W0BRCA    PBRCA                                               CER031
     C                     MOVE W0CNUM    PCUSNO                                              CER031
     C                     MOVE W#CCY     PCUCD                                               CER031
     C                     MOVE W0ACOD    PACCD                                               CER031
     C                     MOVE W0ACSQ    PACSQ                                               CER031
      *                                                                                       CER031
      ** Extract Credit Narratives                                                            CER031
      *                                                                                       CER031
     C                     MOVELOPEXC1    PNARR1                                              CER031
     C                     MOVELOPEXC2    PNARR2                                              CER031
     C                     MOVELOPEXC3    PNARR3                                              CER031
     C                     MOVELOPEXC4    PNARR4                                              CER031
     C                     MOVELOPEXC5    PNARR5                                              CER031
     C                     MOVELOPEXC6    PNARR6                                              CER031
     C                     EXSR CEXNAR                                                        CER031
      *                                                                                       CER031
     C                     MOVE *BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
      *****************************************************************                       CER031
     C/EJECT                                                                                  CER031
      *****************************************************************                       CER031
      *                                                               *                       CER031
      *  DEXNAR    - Extract Extended Debit Narrative                 *                       CER031
      *                                                               *                       CER031
      *  Called By - SrOPNr                                           *                       CER031
      *                                                               *                       CER031
      *  Calls     - None                                             *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
      *                                                                                       CER031
     C           DEXNAR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'DEXNAR  '@STK,Q                                              CER031
      *                                                                                       CER031
      ** Retrieve subroutine specific data                                                    CER031
      *                                                                                       CER031
     C           1         OCUR ##SRDT                                                        CER031
     C                     MOVEL##SPAT    S#PATH                                              CER031
      *                                                                                       CER031
      ** Setup path                                                                           CER031
      *                                                                                       CER031
     C                     MOVEL'\DEXNAR' ##PNAM                                              CER031
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
     C                     EXSR PSHGRS                                                        CER031
      *                                                                                       CER031
      ** Retrieve RDE info                                                                    CER031
      *                                                                                       CER031
     C                     MOVEL@STK,Q    ##GRPS                                              CER031
     C                     Z-ADD1         ##RDEN                                              CER031
     C                     EXSR SRRRDE                                                        CER031
      *                                                                                       CER031
      ** Format Narrative fields                                                              CER031
      *                                                                                       CER031
     C                     MOVE '*FORMAT' POPTN                                               CER031
      *                                                                                     BUG23445
      ** Format according to network Paper if Account is linked                             BUG23445
      *                                                                                     BUG23445
     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
     C           CGL013    IFEQ 'Y'                                                         BUG23445
     C                     MOVEL'PAPER'   KNWRK   6                                         BUG23445
     C                     MOVE PACCD     KACCDX 100                                        BUG23445
     C                     MOVE PACSQ     KACSQX  20                                        BUG23445
     C********** KACCT     CHAINGLNW94L1             95                           BUG23445 BUG23445A
     C           KACCT     CHAINGLNWACL1             95                                    BUG23445A
     C           *IN95     IFEQ *OFF                                                        BUG23445
     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
     C                     MOVELNANWRK    PNTWK                                            BUG23445A
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                       CER031
      ** Call the MG001900 access object to format the extended                               CER031
      ** narratives                                                                           CER031
      *                                                                                       CER031
     C                     CALL 'MG001900'                                                    CER031
     C                     PARM           PRTCD2 10                                           CER031
     C                     PARM           POPTN   7                                           CER031
     C                     PARM           PNTWK   6                                           CER031
     C                     PARM           PMGTYP  3                                           CER031
     C                     PARM           PBRCA                                               CER031
     C                     PARM           PCUSNO                                              CER031
     C                     PARM           PCUCD                                               CER031
     C                     PARM           PACCD                                               CER031
     C                     PARM           PACSQ                                               CER031
     C                     PARM           PDCIN   1                                           CER031
     C                     PARM           PTRTP   5                                           CER031
     C                     PARM           PNARR1 65                                           CER031
     C                     PARM           PNARR2 65                                           CER031
     C                     PARM           PNARR3 65                                           CER031
     C                     PARM           PNARR4 65                                           CER031
     C                     PARM           PNARR5 65                                           CER031
     C                     PARM           PNARR6 65                                           CER031
     C**********           PARM           PRTF1  70                                  CER031 BUG23197
     C**********           PARM           PRTF2  70                                  CER031 BUG23197
     C**********           PARM           PRTF3  70                                  CER031 BUG23197
     C**********           PARM           PRTF4  70                                  CER031 BUG23197
     C**********           PARM           PRTF5  70                                  CER031 BUG23197
     C**********           PARM           PRTF6  70                                  CER031 BUG23197
     C**********           PARM           PRTF7  70                                  CER031 BUG23197
     C**********           PARM           PRTF8  70                                  CER031 BUG23197
     C**********           PARM           PRTF9  70                                  CER031 BUG23197
     C**********           PARM           PRTF10 70                                  CER031 BUG23197
     C**********           PARM           PRTF11 70                                  CER031 BUG23197
     C**********           PARM           PRTF12 70                                  CER031 BUG23197
     C**********           PARM           PRTF13 70                                  CER031 BUG23197
     C**********           PARM           PRTF14 70                                  CER031 BUG23197
     C**********           PARM           PRTF15 70                                  CER031 BUG23197
     C**********           PARM           PRTF16 70                                  CER031 BUG23197
     C**********           PARM           PRTF17 70                                  CER031 BUG23197
     C**********           PARM           PRTF18 70                                  CER031 BUG23197
     C**********           PARM           PRTF19 70                                  CER031 BUG23197
     C**********           PARM           PRTF20 70                                  CER031 BUG23197
     C                     PARM *BLANKS   PRTF1  70                                         BUG23197
     C                     PARM *BLANKS   PRTF2  70                                         BUG23197
     C                     PARM *BLANKS   PRTF3  70                                         BUG23197
     C                     PARM *BLANKS   PRTF4  70                                         BUG23197
     C                     PARM *BLANKS   PRTF5  70                                         BUG23197
     C                     PARM *BLANKS   PRTF6  70                                         BUG23197
     C                     PARM *BLANKS   PRTF7  70                                         BUG23197
     C                     PARM *BLANKS   PRTF8  70                                         BUG23197
     C                     PARM *BLANKS   PRTF9  70                                         BUG23197
     C                     PARM *BLANKS   PRTF10 70                                         BUG23197
     C                     PARM *BLANKS   PRTF11 70                                         BUG23197
     C                     PARM *BLANKS   PRTF12 70                                         BUG23197
     C                     PARM *BLANKS   PRTF13 70                                         BUG23197
     C                     PARM *BLANKS   PRTF14 70                                         BUG23197
     C                     PARM *BLANKS   PRTF15 70                                         BUG23197
     C                     PARM *BLANKS   PRTF16 70                                         BUG23197
     C                     PARM *BLANKS   PRTF17 70                                         BUG23197
     C                     PARM *BLANKS   PRTF18 70                                         BUG23197
     C                     PARM *BLANKS   PRTF19 70                                         BUG23197
     C                     PARM *BLANKS   PRTF20 70                                         BUG23197
     C                     PARM           IDX     30                                          CER031
     C                     PARM           FLDNAM                                              CER031
     C                     PARM           MSGID                                               CER031
     C                     PARM           MSGDTA                                              CER031
     C                     PARM           WFLDNM                                              CER031
     C                     PARM           WMGID                                               CER031
     C                     PARM           WMGDTA                                              CER031
      *                                                                                       CER031
     C           PRTCD2    IFEQ *BLANKS                                                       CER031
     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
     C                     MOVELPRTF1     ##D,1                                               CER031
     C                     MOVELPRTF2     ##D,2                                               CER031
     C                     MOVELPRTF3     ##D,3                                               CER031
     C                     MOVELPRTF4     ##D,4                                               CER031
     C                     MOVELPRTF5     ##D,5                                               CER031
     C                     MOVELPRTF6     ##D,6                                               CER031
     C                     MOVELPRTF7     ##D,7                                               CER031
     C                     MOVELPRTF8     ##D,8                                               CER031
     C                     MOVELPRTF9     ##D,9                                               CER031
     C                     MOVELPRTF10    ##D,10                                              CER031
     C                     MOVELPRTF11    ##D,11                                              CER031
     C                     MOVELPRTF12    ##D,12                                              CER031
     C                     MOVELPRTF13    ##D,13                                              CER031
     C                     MOVELPRTF14    ##D,14                                              CER031
     C                     MOVELPRTF15    ##D,15                                              CER031
     C                     MOVELPRTF16    ##D,16                                              CER031
     C                     MOVELPRTF17    ##D,17                                              CER031
     C                     MOVELPRTF18    ##D,18                                              CER031
     C                     MOVELPRTF19    ##D,19                                              CER031
     C                     MOVELPRTF20    ##D,20                                              CER031
      *                                                                                       CER031
     C                     ELSE                                                               CER031
     C                     MOVE 'MG001900'W0FILE                                              CER031
     C                     MOVE PNARR1    W0KEY                                               CER031
     C                     MOVE 64        W0ERNB                                              CER031
     C                     MOVE 'MEM5003' W0MSGD                                              CER031
     C                     MOVE 'MIDAS'   W0MSGF                                              CER031
     C                     EXSR SRERR                                                         CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CER031
      *                                                                                       CER031
     C                     EXSR SRADTA                                                        CER031
     C                     EXSR SRODTA                                                        CER031
     C           EXDBNR    TAG                                                                CER031
      *                                                                                       CER031
      ** Unwind subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     EXSR POPGRS                                                        CER031
     C                     MOVEA*BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
      *****************************************************************                       CER031
     C/EJECT                                                                                  CER031
      *****************************************************************                       CER031
      *                                                               *                       CER031
      *  CEXNAR    - Extract Extended Credit Narrative                *                       CER031
      *                                                               *                       CER031
      *  Called By - SrOPNr                                           *                       CER031
      *                                                               *                       CER031
      *  Calls     - None                                             *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
      *                                                                                       CER031
     C           CEXNAR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'CEXNAR  '@STK,Q                                              CER031
      *                                                                                       CER031
      ** Retrieve subroutine specific data                                                    CER031
      *                                                                                       CER031
     C           1         OCUR ##SRDT                                                        CER031
     C                     MOVEL##SPAT    S#PATH                                              CER031
      *                                                                                       CER031
      ** Setup path                                                                           CER031
      *                                                                                       CER031
     C                     MOVEL'\CEXNAR' ##PNAM                                              CER031
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
     C                     EXSR PSHGRS                                                        CER031
      *                                                                                       CER031
      ** Retrieve RDE info                                                                    CER031
      *                                                                                       CER031
     C                     MOVEL@STK,Q    ##GRPS                                              CER031
     C                     Z-ADD1         ##RDEN                                              CER031
     C                     EXSR SRRRDE                                                        CER031
      *                                                                                       CER031
      ** Format Narrative fields                                                              CER031
      *                                                                                       CER031
     C                     MOVE '*FORMAT' POPTN                                               CER031
      *                                                                                     BUG23445
      ** Format according to network Paper if Account is linked                             BUG23445
      *                                                                                     BUG23445
     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
     C           CGL013    IFEQ 'Y'                                                         BUG23445
     C                     MOVEL'PAPER'   KNWRK                                             BUG23445
     C                     MOVE PACCD     KACCDX                                            BUG23445
     C                     MOVE PACSQ     KACSQX                                            BUG23445
     C********** KACCT     CHAINGLNW94L1             95                           BUG23445 BUG23445A
     C           KACCT     CHAINGLNWACL1             95                                    BUG23445A
     C           *IN95     IFEQ *OFF                                                        BUG23445
     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
     C                     MOVELNANWRK    PNTWK                                            BUG23445A
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                       CER031
      ** Call the MG001900 access object to format the extended                               CER031
      ** narratives                                                                           CER031
      *                                                                                       CER031
     C                     CALL 'MG001900'                                                    CER031
     C                     PARM           PRTCD2                                              CER031
     C                     PARM           POPTN                                               CER031
     C                     PARM           PNTWK                                               CER031
     C                     PARM           PMGTYP                                              CER031
     C                     PARM           PBRCA                                               CER031
     C                     PARM           PCUSNO                                              CER031
     C                     PARM           PCUCD                                               CER031
     C                     PARM           PACCD                                               CER031
     C                     PARM           PACSQ                                               CER031
     C                     PARM           PDCIN                                               CER031
     C                     PARM           PTRTP                                               CER031
     C                     PARM           PNARR1                                              CER031
     C                     PARM           PNARR2                                              CER031
     C                     PARM           PNARR3                                              CER031
     C                     PARM           PNARR4                                              CER031
     C                     PARM           PNARR5                                              CER031
     C                     PARM           PNARR6                                              CER031
     C**********           PARM           PRTF1                                      CER031 BUG23197
     C**********           PARM           PRTF2                                      CER031 BUG23197
     C**********           PARM           PRTF3                                      CER031 BUG23197
     C**********           PARM           PRTF4                                      CER031 BUG23197
     C**********           PARM           PRTF5                                      CER031 BUG23197
     C**********           PARM           PRTF6                                      CER031 BUG23197
     C**********           PARM           PRTF7                                      CER031 BUG23197
     C**********           PARM           PRTF8                                      CER031 BUG23197
     C**********           PARM           PRTF9                                      CER031 BUG23197
     C**********           PARM           PRTF10                                     CER031 BUG23197
     C**********           PARM           PRTF11                                     CER031 BUG23197
     C**********           PARM           PRTF12                                     CER031 BUG23197
     C**********           PARM           PRTF13                                     CER031 BUG23197
     C**********           PARM           PRTF14                                     CER031 BUG23197
     C**********           PARM           PRTF15                                     CER031 BUG23197
     C**********           PARM           PRTF16                                     CER031 BUG23197
     C**********           PARM           PRTF17                                     CER031 BUG23197
     C**********           PARM           PRTF18                                     CER031 BUG23197
     C**********           PARM           PRTF19                                     CER031 BUG23197
     C**********           PARM           PRTF20                                     CER031 BUG23197
     C                     PARM *BLANKS   PRTF1                                             BUG23197
     C                     PARM *BLANKS   PRTF2                                             BUG23197
     C                     PARM *BLANKS   PRTF3                                             BUG23197
     C                     PARM *BLANKS   PRTF4                                             BUG23197
     C                     PARM *BLANKS   PRTF5                                             BUG23197
     C                     PARM *BLANKS   PRTF6                                             BUG23197
     C                     PARM *BLANKS   PRTF7                                             BUG23197
     C                     PARM *BLANKS   PRTF8                                             BUG23197
     C                     PARM *BLANKS   PRTF9                                             BUG23197
     C                     PARM *BLANKS   PRTF10                                            BUG23197
     C                     PARM *BLANKS   PRTF11                                            BUG23197
     C                     PARM *BLANKS   PRTF12                                            BUG23197
     C                     PARM *BLANKS   PRTF13                                            BUG23197
     C                     PARM *BLANKS   PRTF14                                            BUG23197
     C                     PARM *BLANKS   PRTF15                                            BUG23197
     C                     PARM *BLANKS   PRTF16                                            BUG23197
     C                     PARM *BLANKS   PRTF17                                            BUG23197
     C                     PARM *BLANKS   PRTF18                                            BUG23197
     C                     PARM *BLANKS   PRTF19                                            BUG23197
     C                     PARM *BLANKS   PRTF20                                            BUG23197
     C                     PARM           IDX                                                 CER031
     C                     PARM           FLDNAM                                              CER031
     C                     PARM           MSGID                                               CER031
     C                     PARM           MSGDTA                                              CER031
     C                     PARM           WFLDNM                                              CER031
     C                     PARM           WMGID                                               CER031
     C                     PARM           WMGDTA                                              CER031
      *                                                                                       CER031
     C           PRTCD2    IFEQ *BLANKS                                                       CER031
     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
     C                     MOVELPRTF1     ##D,1                                               CER031
     C                     MOVELPRTF2     ##D,2                                               CER031
     C                     MOVELPRTF3     ##D,3                                               CER031
     C                     MOVELPRTF4     ##D,4                                               CER031
     C                     MOVELPRTF5     ##D,5                                               CER031
     C                     MOVELPRTF6     ##D,6                                               CER031
     C                     MOVELPRTF7     ##D,7                                               CER031
     C                     MOVELPRTF8     ##D,8                                               CER031
     C                     MOVELPRTF9     ##D,9                                               CER031
     C                     MOVELPRTF10    ##D,10                                              CER031
     C                     MOVELPRTF11    ##D,11                                              CER031
     C                     MOVELPRTF12    ##D,12                                              CER031
     C                     MOVELPRTF13    ##D,13                                              CER031
     C                     MOVELPRTF14    ##D,14                                              CER031
     C                     MOVELPRTF15    ##D,15                                              CER031
     C                     MOVELPRTF16    ##D,16                                              CER031
     C                     MOVELPRTF17    ##D,17                                              CER031
     C                     MOVELPRTF18    ##D,18                                              CER031
     C                     MOVELPRTF19    ##D,19                                              CER031
     C                     MOVELPRTF20    ##D,20                                              CER031
      *                                                                                       CER031
     C                     ELSE                                                               CER031
     C                     MOVE 'MG001900'W0FILE                                              CER031
     C                     MOVE PNARR1    W0KEY                                               CER031
     C                     MOVE 65        W0ERNB                                              CER031
     C                     MOVE 'MEM5003' W0MSGD                                              CER031
     C                     MOVE 'MIDAS'   W0MSGF                                              CER031
     C                     EXSR SRERR                                                         CER031
     C                     ENDIF                                                              CER031
      *                                                                                       CER031
      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CER031
      *                                                                                       CER031
     C                     EXSR SRADTA                                                        CER031
     C                     EXSR SRODTA                                                        CER031
     C           EXCRNR    TAG                                                                CER031
      *                                                                                       CER031
      ** Unwind subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     EXSR POPGRS                                                        CER031
     C                     MOVEA*BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
     C/EJECT                                                                                  CFT134
      *****************************************************************                       CFT134
      *                                                               *                       CFT134
      *  SRGTIB - Get IBAN for Incoming and Outgoing Payments         *                       CFT134
      *                                                               *                       CFT134
      *  Called By: DRCR01, DRCR02 Subroutine                         *                       CFT134
      *             (If CFT004 and CFT134 are switched on)            *                       CFT134
      *                                                               *                       CFT134
      *  Calls: AOIBANR3                                              *                       CFT134
      *                                                               *                       CFT134
      *****************************************************************                       CFT134
      *                                                                                       CFT134
     C           SRGTIB    BEGSR                                                              CFT134
      *                                                                                       CFT134
      **  Set up subroutine stack name                                                        CFT134
     C                     ADD  1         Q                                                   CFT134
     C                     MOVEL'CFT134'  @STK,Q                                              CFT134
      *                                                                                       CFT134
      **  Retrieve subroutine specific data.                                                  CFT134
     C           1         OCUR ##SRDT                                                        CFT134
     C                     MOVEL##SPAT    S#PATH                                              CFT134
      *                                                                                       CFT134
      **  Set up Path.                                                                        CFT134
     C                     MOVEL'\CFT134' ##PNAM                                              CFT134
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CFT134
      *                                                                                       CFT134
     C                     EXSR PSHGRS                                                        CFT134
      *                                                                                       CFT134
      **  Retrieve RDE information for RDEs in group set                                      CFT134
      *                                                                                       CFT134
     C                     MOVEL@STK,Q    ##GRPS                                              CFT134
     C                     Z-ADD1         ##RDEN                                              CFT134
     C                     EXSR SRRRDE                                                        CFT134
      *                                                                                       CFT134
     C                     MOVEL*BLANKS   KRACN                                               CFT134
     C                     MOVEL*BLANKS   KCNUM                                               CFT134
     C                     MOVEL*BLANKS   KCCY                                                CFT134
     C                     MOVEL*BLANKS   KACOD                                               CFT134
     C                     MOVEL*BLANKS   KACSQ                                               CFT134
     C                     MOVEL*BLANKS   KBRCA                                               CFT134
     C                     MOVEL'N'       FIBAN   1                                           CFT134
     C                     MOVEL*BLANKS   P1IBAN 47                                           CFT134
     C                     MOVEL*BLANKS   P@IBAN 34                                           CFT134
      *                                                                                       CFT134
      **  Get IBAN for Incoming Payments                                                      CFT134
      *                                                                                       CFT134
     C           ##FILE    IFEQ 'INPAY  '                                                     CFT134
      *                                                                                       CFT134
     C           ACBT      IFEQ 'R'                                                           CFT134
     C           ACBT      OREQ 'N'                                                           CFT134
     C           ACBT      OREQ 'P'                                                           CFT134
      *                                                                                       CFT134
     C           ACBT      IFEQ 'R'                                                           CFT134
     C                     MOVELACBK      KRACN                                               CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           ACBT      IFEQ 'N'                                                           CFT134
     C                     MOVELACBK      @NONB   2                                           CFT134
     C                     CALL 'AONOSTR0'                                                    CFT134
     C                     PARM *BLANKS   @RTCD                                               CFT134
     C                     PARM '*KEY   ' @OPTN                                               CFT134
     C                     PARM           KCNUM                                               CFT134
     C                     PARM           PCCY                                                CFT134
     C                     PARM           KACOD                                               CFT134
     C                     PARM           KACSQ                                               CFT134
     C                     PARM           @NONB                                               CFT134
     C                     PARM           KBRCA                                               CFT134
     C                     PARM *BLANKS   @CSSN  10                                           CFT134
     C                     PARM *BLANKS   @PNOI   1                                           CFT134
     C           SDNOST    PARM *BLANKS   DSFDY                                               CFT134
      *                                                                                       CFT134
     C           @RTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELA7CUST    KCNUM                                               CFT134
     C                     MOVELA7CYCD    KCCY                                                CFT134
     C                     MOVELA7ACCD    KACOD                                               CFT134
     C                     MOVELA7ACSN    KACSQ                                               CFT134
     C                     MOVELA7BRCD    KBRCA                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           ACBT      IFEQ 'P'                                                           CFT134
     C                     MOVELACBK      WORC1                                               CFT134
     C                     MOVELPCCY      KCCY                                                CFT134
     C                     MOVELACBB      KBRCA                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     EXSR GTIBAN                                                        CFT134
     C           FOIBAN    IFNE *BLANKS                                                       CFT134
     C                     MOVELFOIBAN    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ELSE                                                               CFT134
     C           BNCT      IFEQ 'R'                                                           CFT134
     C           BNCT      OREQ 'P'                                                           CFT134
     C           BNCT      OREQ 'I'                                                           CFT134
      *                                                                                       CFT134
     C           BNCT      IFEQ 'I'                                                           CFT134
     C           34        SUBSTBNC1:2    PIBAN                                               CFT134
      *                                                                                       CFT134
     C                     CALL 'AOIBANR3'                                                    CFT134
     C                     PARM           WRTCD                                               CFT134
     C                     PARM           PIBAN  47                                           CFT134
     C                     PARM           POWITH 47                                           CFT134
     C                     PARM           PONOBL 34                                           CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELPOWITH    FOIBAN                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           BNCT      IFEQ 'P'                                                           CFT134
     C                     MOVELBNC1      WORC1                                               CFT134
     C                     MOVELPCCY      KCCY                                                CFT134
     C                     EXSR GTIBAN                                                        CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           BNCT      IFEQ 'R'                                                           CFT134
     C                     MOVELBNC1      KRACN                                               CFT134
     C                     EXSR GTIBAN                                                        CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           FOIBAN    IFNE *BLANKS                                                       CFT134
     C                     MOVELFOIBAN    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     END                                                                CFT134
     C                     END                                                                CFT134
      *                                                                                       CFT134
      ** At this point, P1IBAN could contain an IBAN or not.  If                              CFT134
      ** not an IBAN, if Beneficiary is an address, it can contain                            CFT134
      ** the IBAN.                                                                            CFT134
      *                                                                                       CFT134
     C           CFT014    IFEQ 'Y'                                                           CFT134
     C           FIBAN     ANDEQ'N'                        NO IBAN RETRIEVED                  CFT134
      *                                                                                       CFT134
     C           BNCT      IFEQ 'A'                                                           CFT134
     C           1         SUBSTBNC1:1    BCSL    1                                           CFT134
      *                                                                                       CFT134
     C           BCSL      IFEQ '/'                                                           CFT134
     C           34        SUBSTBNC1:2    PIBAN                                               CFT134
     C                     ELSE                                                               CFT134
     C                     MOVELBNC1      PIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     CALL 'AOIBANR3'                                                    CFT134
     C                     PARM           WRTCD                                               CFT134
     C                     PARM           PIBAN                                               CFT134
     C                     PARM           POWITH                                              CFT134
     C           P@IBAN    PARM           PONOBL                                              CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
      *                                                                                       CFT134
     C                     MOVELWRTCD     @RTCD                                               CFT134
     C                     MOVELP@IBAN    WIBAN                                               CFT134
     C                     EXSR SRIBAN                                                        CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELPOWITH    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
      **  Get IBAN for Outgoing Payments                                                      CFT134
      *                                                                                       CFT134
     C           ##FILE    IFEQ 'OTPAY  '                                                     CFT134
      *                                                                                       CFT134
     C           ORBT      IFEQ 'R'                                                           CFT134
     C           ORBT      OREQ 'N'                                                           CFT134
     C           ORBT      OREQ 'P'                                                           CFT134
      *                                                                                       CFT134
     C           ORBT      IFEQ 'R'                                                           CFT134
     C                     MOVELORBK      KRACN                                               CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           ORBT      IFEQ 'N'                                                           CFT134
     C                     MOVELORBK      @NONB                                               CFT134
     C                     CALL 'AONOSTR0'                                                    CFT134
     C                     PARM *BLANKS   @RTCD                                               CFT134
     C                     PARM '*KEY   ' @OPTN                                               CFT134
     C                     PARM           KCNUM                                               CFT134
     C                     PARM           SMCY                                                CFT134
     C                     PARM           KACOD                                               CFT134
     C                     PARM           KACSQ                                               CFT134
     C                     PARM           @NONB                                               CFT134
     C                     PARM           KBRCA                                               CFT134
     C                     PARM *BLANKS   @CSSN                                               CFT134
     C                     PARM *BLANKS   @PNOI                                               CFT134
     C           SDNOST    PARM *BLANKS   DSFDY                                               CFT134
      *                                                                                       CFT134
     C           @RTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELA7CUST    KCNUM                                               CFT134
     C                     MOVELA7CYCD    KCCY                                                CFT134
     C                     MOVELA7ACCD    KACOD                                               CFT134
     C                     MOVELA7ACSN    KACSQ                                               CFT134
     C                     MOVELA7BRCD    KBRCA                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           ORBT      IFEQ 'P'                                                           CFT134
     C                     MOVELORBK      WORC1                                               CFT134
     C                     MOVELSMCY      KCCY                                                CFT134
     C                     MOVELORBB      KBRCA                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     EXSR GTIBAN                                                        CFT134
     C           FOIBAN    IFNE *BLANKS                                                       CFT134
     C                     MOVELFOIBAN    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ELSE                                                               CFT134
     C           ORCT      IFEQ 'R'                                                           CFT134
     C           ORCT      OREQ 'P'                                                           CFT134
      *                                                                                       CFT134
     C           ORCT      IFEQ 'P'                                                           CFT134
     C                     MOVELORC1      WORC1                                               CFT134
     C                     MOVELSMCY      KCCY                                                CFT134
     C                     ELSE                                                               CFT134
      *                                                                                       CFT134
     C           ORCT      IFEQ 'R'                                                           CFT134
     C           1         SUBSTORC1:1    WSLSH                                               CFT134
     C           WSLSH     IFEQ '/'                                                           CFT134
     C           10        SUBSTORC1:2    KRACN                                               CFT134
     C                     ELSE                                                               CFT134
     C                     MOVELORC1      KRACN                                               CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     EXSR GTIBAN                                                        CFT134
     C           FOIBAN    IFNE *BLANKS                                                       CFT134
     C                     MOVELFOIBAN    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
     C*                                                                                       CFT134
     C                     END                                                                CFT134
     C                     END                                                                CFT134
      *                                                                                       CFT134
      ** At this point, P1IBAN could contain an IBAN or not.  If                              CFT134
      ** not an IBAN, if ord customer is an address, it may contain                           CFT134
      ** the IBAN.                                                                            CFT134
      *                                                                                       CFT134
     C           CFT014    IFEQ 'Y'                                                           CFT134
     C           FIBAN     ANDEQ'N'                                                           CFT134
      *                                                                                       CFT134
     C           ORCT      IFEQ 'A'                                                           CFT134
     C           1         SUBSTORC1:1    BCSL    1                                           CFT134
      *                                                                                       CFT134
     C           BCSL      IFEQ '/'                                                           CFT134
     C           34        SUBSTORC1:2    PIBAN                                               CFT134
     C                     ELSE                                                               CFT134
     C                     MOVELORC1      PIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     CALL 'AOIBANR3'                                                    CFT134
     C                     PARM           WRTCD                                               CFT134
     C                     PARM           PIBAN                                               CFT134
     C                     PARM           POWITH                                              CFT134
     C           P@IBAN    PARM           PONOBL                                              CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
      *                                                                                       CFT134
     C                     MOVELWRTCD     @RTCD                                               CFT134
     C                     MOVELP@IBAN    WIBAN                                               CFT134
     C                     EXSR SRIBAN                                                        CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELPOWITH    P1IBAN                                              CFT134
     C                     MOVEL'Y'       FIBAN                                               CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C           FIBAN     IFEQ 'Y'                                                           CFT134
     C                     MOVELP1IBAN    ##D,1                                               CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
      ** Accumulate RDEs and associated data and output to PF/ CGUDTAPD                       CFT134
      *                                                                                       CFT134
     C                     EXSR SRADTA                                                        CFT134
     C                     EXSR SRODTA                                                        CFT134
      *                                                                                       CFT134
     C           EXGTIB    TAG                                                                CFT134
      *                                                                                       CFT134
     C                     EXSR POPGRS                                                        CFT134
      *                                                                                       CFT134
      **  Unwind subroutine stack name                                                        CFT134
      *                                                                                       CFT134
     C                     MOVEA*BLANKS   @STK,Q                                              CFT134
     C                     SUB  1         Q                                                   CFT134
      *                                                                                       CFT134
     C                     ENDSR                                                              CFT134
      *****************************************************************                       CFT134
     C/EJECT                                                                                  CFT134
      *****************************************************************                       CFT134
      *                                                               *                       CFT134
      *  GTIBAN - Get IBAN of retail account                          *                       CFT134
      *                                                               *                       CFT134
      *  Called By: SRGTIB                                            *                       CFT134
      *                                                               *                       CFT134
      *  Calls: AOACCTR0, AOIBANR3                                    *                       CFT134
      *                                                               *                       CFT134
      *****************************************************************                       CFT134
      *                                                                                       CFT134
     C           GTIBAN    BEGSR                                                              CFT134
      *                                                                                       CFT134
     C                     MOVEL*BLANKS   FOIBAN 47                                           CFT134
      *                                                                                       CFT134
     C                     CALL 'AOACCTR0'                                                    CFT134
     C                     PARM *BLANKS   WRTCD   7                                           CFT134
     C                     PARM '*KEY    'WOPTN   7                                           CFT134
     C                     PARM           KRACN                                               CFT134
     C                     PARM           KCNUM                                               CFT134
     C                     PARM           KCCY                                                CFT134
     C                     PARM           KACOD                                               CFT134
     C                     PARM           KACSQ                                               CFT134
     C                     PARM           KBRCA                                               CFT134
     C           SDACCT    PARM SDACCT    DSSDY                                               CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
     C           IBAN      IFNE *BLANKS                                                       CFT134
     C                     MOVELIBAN      PIBAN                                               CFT134
     C                     CALL 'AOIBANR3'                                                    CFT134
     C                     PARM           WRTCD                                               CFT134
     C                     PARM           PIBAN                                               CFT134
     C                     PARM           POWITH                                              CFT134
     C                     PARM           PONOBL                                              CFT134
      *                                                                                       CFT134
     C           WRTCD     IFEQ *BLANKS                                                       CFT134
     C                     MOVELPOWITH    FOIBAN                                              CFT134
     C                     ENDIF                                                              CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDIF                                                              CFT134
      *                                                                                       CFT134
     C                     ENDSR                                                              CFT134
      *                                                                                       CFT134
     C/EJECT                                                                               AR1082119
      *****************************************************************                    AR1082119
      *                                                               *                    AR1082119
      *  SR#CCY    - Get the Charge Currency                          *                    AR1082119
      *                                                               *                    AR1082119
      *  Called By - INENTC, OTENTC                                   *                    AR1082119
      *                                                               *                    AR1082119
      *  Calls     - None                                             *                    AR1082119
      *                                                               *                    AR1082119
      *****************************************************************                    AR1082119
      *                                                                                    AR1082119
     C           SR#CCY    BEGSR                                                           AR1082119
      *                                                                                    AR1082119
     C                     SELEC                                                           AR1082119
     C           CDRO      WHNE *BLANKS                                                    AR1082119
     C           CFT120    ANDEQ'Y'                                                        AR1082119
      *                                                                                    AR1082119
      ** Incoming Payment                                                                  AR1082119
      *                                                                                    AR1082119
     C           ##FILE    IFEQ 'INPAY  '                                                  AR1082119
     C           INCDRC    IFEQ *BLANKS                                                    AR1082119
     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
     C                     ELSE                                                            AR1082119
     C                     MOVELINCDRC    ##WCCY                                           AR1082119
     C                     ENDIF                                                           AR1082119
     C                     ENDIF                                                           AR1082119
      *                                                                                    AR1082119
      ** Outgoing Payment                                                                  AR1082119
      *                                                                                    AR1082119
     C           ##FILE    IFEQ 'OTPAY  '                                                  AR1082119
     C           OPCDRC    IFEQ *BLANKS                                                    AR1082119
     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
     C                     ELSE                                                            AR1082119
     C                     MOVELOPCDRC    ##WCCY                                           AR1082119
     C                     ENDIF                                                           AR1082119
     C                     ENDIF                                                           AR1082119
      *                                                                                    AR1082119
     C           CDRO      WHNE *BLANKS                                                    AR1082119
     C           CFT120    ANDEQ'N'                                                        AR1082119
      *                                                                                    AR1082119
     C**********           SELEC                                                AR1082119 AR1082119A
     C********** BTCHCY    WHEQ 'B'                                             AR1082119 AR1082119A
     C********** BTCHCY    OREQ 'B'                                             AR1082119A AR1097394
     C                     MOVELBJCYCD    ##WCCY                                           AR1082119
     C********** BTCHCY    WHEQ 'L'                                              AR1082119 AR1097394
     C**********           MOVELBJLCCY    ##WCCY                                 AR1082119 AR1097394
     C********** BTCHCY    WHEQ 'C'                                              AR1082119 AR1097394
     C           CDRO      WHEQ *BLANKS                                                    AR1097394
     C           ADDC      ANDEQ'A'                                                        AR1082119
     C                     MOVELSMCY      ##WCCY                                           AR1082119
     C********** BTCHCY    WHEQ 'C'                                              AR1082119 AR1097394
     C           CDRO      WHEQ *BLANKS                                                    AR1097394
     C           ADDC      ANDEQ'D'                                                        AR1082119
     C                     MOVELPCCY      ##WCCY                                           AR1082119
     C********** BTCHCY    WHEQ 'F'                                              AR1082119 AR1097394
     C**********           MOVELFCHCCY    ##WCCY                                 AR1082119 AR1097394
     C**********           ENDSL                                                AR1082119 AR1082119A
     C                     ENDSL                                                           AR1082119
     C                     ENDSR                                                           AR1082119
      *****************************************************************                       CER031
     C/EJECT                                                                                  CER031
      *****************************************************************                       CER031
      *                                                                   CFT009
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
      /EJECT                                                                                  CCG015
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
** ##GRP/##RDE
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
BOOK  0001 BOOK_CODE
BOOK  0002 BOOK_DESC
PROF_C0001 PROF_CENT
PROF_C0002 PROF_C_DSC
FT_USR0001 USR_INP_1
FT_USR0002 USR_INP_2
FT_USR0003 USR_AUT_1
FT_USR0004 USR_AUT_2
FT_USR0005 UINP1_DESC
FT_USR0006 UINP2_DESC
FT_USR0007 UAUT1_DESC
FT_USR0008 UAUT2_DESC
PAYMNT0001 PAY_REF
PAYMNT0002 VALUE DATE Date
PAYMNT0003 PRINT_DATE Date
PAYMNT0004 PAY_TYPE
PAYMNT0005 PAY_S_TYPE
PAYMNT0006 PAY_ST_DSC
PAYMNT0007 SETTLEMOD                                                      095577
PAY_II0001 PAY_RATE   Xrate L8
PAY_II0002 CHG_CCY
PAY_II0003 ADD/DEDUCT
PAY_II0004 TFR_COMM   AmountL
PAY_II0005 FX/CHG_COM AmountL
PAY_II0006 TELEX_CHG  AmountL
PAY_II0007 CHEQUE_CHG AmountL
PAY_II0008 COST_ABRD  AmountL
PAY_II0009 SWIFT_CHG  AmountL
PAY_II0010 MISC_CHG   AmountL
PAY_II0011 VAT_AMOUNT AmountL
PAY_II0012 TOT_CHG    AmountL
PAY_II0013 NET_AMOUNT AmountL
PAY_II0014 CHG_DETL
PAY_II0015 REL_REF
PAY_II0016 COLL_CHG   AmountL
PAY_II0017 TELEPH_CHG AmountL
PAY_II0018 ADVICE_CHG AmountL
PAY_II0019 DEDUCTIONS AmountL
FTSTAX0001 ZSTAXFLG                                                                           CER049
FTSTAX0002 Z_TAX_AMT  AmountL                                                                 CER049
CR_CCY0001 CR_CCY
CR_CCY0002 CR_CCY_NAM
CR_CCY0003 CR_AMOUNT  AmountL
CR_CCY0004 CHQ_NUMBER
CR_CCY0005 CHQ_SEQ_NO
CR_CCY0006 CR DATE    Date                                                095577
DR_CCY0001 DR_CCY
DR_CCY0002 DR_CCY_NAM
DR_CCY0003 DR_AMOUNT  AmountL
DR_CCY0004 DR DATE    Date                                                095577
PAYDET0001 PAY_DETL_1
PAYDET0002 PAY_DETL_2
PAYDET0003 PAY_DETL_3
PAYDET0004 PAY_DETL_4
NARR  0001 NARRAT_1
NARR  0002 NARRAT_2
NARR  0003 NARRAT_3
NARR  0004 NARRAT_4
NARR  0005 NARRAT_5
NARR  0006 NARRAT_6
CORDTA0001 COR_TYPE                      Information Type
CORDTA0002 COR_CUST                      Customer
CORDTA0003 COR_CUSNAM                    Customer Name
CORDTA0004 COR_CUSTWN                    Customer Town
CORDTA0005 COR_AC_LIN                    Account line
CORDTA0006 COR_RET_NO                    Retail AC No.
CORDTA0007 COR_ACCT                      Midas Account Identifier
CORDTA0008 COR_AC_NAM                    Account name
CORDTA0009 COR_SWIFT                     SWIFT ID
CORDTA0010 COR_ADDR_1                    Address line 1
CORDTA0011 COR_ADDR_2                    Address line 2
CORDTA0012 COR_ADDR_3                    Address line 3
CORDTA0013 COR_ADDR_4                    Address line 4
CORDTA0014 COR_ADDR_5                    Address line 5
CORDTA0015 COR_PTFR                      Portfolio Reference              CPB001
CORDTA0016 CFT121F                       CFT121 Switchable Feature Flag                       CFT121
CORDTA0017 CFT120F                       CFT120 Switchable Feature Flag                       CFT120
CORDTA0018 COR_CCY                       Charge to the Debit A/c ccy                          CFT120
FT_DLV0001 NTF_DLVCCY                                                     CEU006
FT_DLV0002 NTF_DLVAMT AmountL                                             CEU006
FT_DLV0003 PAY_DLVCCY                                                     CEU006
FT_DLV0004 PAY_DLVAMT AmountL                                             CEU006
CHGENT0001 ENT_CURRCY                                                     CEU006
CHGENT0002 ENT_TFRCOM AmountL                                             CEU006
CHGENT0003 ENT_FX/CHG AmountL                                             CEU006
CHGENT0004 ENT_TELEX  AmountL                                             CEU006
CHGENT0005 ENT_CHEQUE AmountL                                             CEU006
CHGENT0006 ENT_COSTAB AmountL                                             CEU006
CHGENT0007 ENT_SWIFT  AmountL                                             CEU006
CHGENT0008 ENT_COLLEC AmountL                                             CEU006
CHGENT0009 ENT_TELEPH AmountL                                             CEU006
CHGENT0010 ENT_ADVICE AmountL                                             CEU006
CHGENT0011 ENT_MISC   AmountL                                             CEU006
CHGENT0012 ENT_VATAMT AmountL                                             CEU006
CHGENT0013 ENT_TOTCHG AmountL                                             CEU006
CHGENT0014 ENT_DEDUCT AmountL                                             CEU006
CHGENT0015 ENT_NETAMT AmountL                                             CEU006
CHGENT0016 ENT_SWFTP  AmountL                                             CFT009
CHGENT0017 ENT_MISC1  AmountL                                             CFT009
CHGENT0018 ENT_MISC2  AmountL                                             CFT009
CHGENT0019 ENT_MISC3  AmountL                                             CFT009
CHGENT0020 ENT_MISC4  AmountL                                             CFT009
CHGENT0021 ENT_MISC5  AmountL                                             CFT009
CHGEUR0001 EUR_CURRCY                                                     CEU006
CHGEUR0002 EUR_TFRCOM AmountL                                             CEU006
CHGEUR0003 EUR_FX/CHG AmountL                                             CEU006
CHGEUR0004 EUR_TELEX  AmountL                                             CEU006
CHGEUR0005 EUR_CHEQUE AmountL                                             CEU006
CHGEUR0006 EUR_COSTAB AmountL                                             CEU006
CHGEUR0007 EUR_SWIFT  AmountL                                             CEU006
CHGEUR0008 EUR_COLLEC AmountL                                             CEU006
CHGEUR0009 EUR_TELEPH AmountL                                             CEU006
CHGEUR0010 EUR_ADVICE AmountL                                             CEU006
CHGEUR0011 EUR_MISC   AmountL                                             CEU006
CHGEUR0012 EUR_VATAMT AmountL                                             CEU006
CHGEUR0013 EUR_TOTCHG AmountL                                             CEU006
CHGEUR0014 EUR_DEDUCT AmountL                                             CEU006
CHGEUR0015 EUR_NETAMT AmountL                                             CEU006
CHGEUR0016 EUR_SWFTP  AmountL                                             CFT009
CHGEUR0017 EUR_MISC1  AmountL                                             CFT009
CHGEUR0018 EUR_MISC2  AmountL                                             CFT009
CHGEUR0019 EUR_MISC3  AmountL                                             CFT009
CHGEUR0020 EUR_MISC4  AmountL                                             CFT009
CHGEUR0021 EUR_MISC5  AmountL                                             CFT009
FT_RFT0001 RFTID                                                          CFT006
FT_RFT0002 SNDR_ID                                                        CFT006
FT_RFT0003 SNDR_REF                                                       CFT006
FT_RFT0004 TRN_DTL_RF                                                     CFT006
FT_RFT0005 FX_DL_REF                                                      CFT006
FT_RFT0006 INST_PARTY                                                     CFT006
FT_RFT0007 RQST_EXDAT Date                                                CFT006
FT_RFT0008 HAND_CCY                                                       CFT006
FT_RFT0009 HAND_CHRG  AmountL                                             CFT006
FT_RFT0010 CHRG_DR                                                        CFT006
FT_RFT0011 AUTH                                                           CFT006
FT_RFT0012 ORG_CCY                                                        CFT006
FT_RFT0013 ORG_AMT    AmountL                                             CFT006
FT_RFT0014 INST_CODE1                                                     CFT006
FT_RFT0015 INST_CODE2                                                     CFT006
FT_RFT0016 INST_CODE3                                                     CFT006
FT_RFT0017 INST_CODE4                                                     CFT006
FT_RFT0018 INST_CODE5                                                     CFT006
FT_RFT0019 INST_CODE6                                                     CFT006
FT_RFT0020 INST_CODE7                                                     CFT006
FT_RFI0001 INTERMED1                                                      CFT006
FT_RFI0002 INTERMED2                                                      CFT006
FT_RFI0003 INTERMED3                                                      CFT006
FT_RFI0004 INTERMED4                                                      CFT006
FT_RFI0005 INTERMED5                                                      CFT006
FT_RFI0006 INTERMED6                                                      CFT006
FT_RFI0007 INTER_TYPE                                                     CFT006
FT_RFI0008 ACNTINST1                                                      CFT006
FT_RFI0009 ACNTINST2                                                      CFT006
FT_RFI0010 ACNTINST3                                                      CFT006
FT_RFI0011 ACNTINST4                                                      CFT006
FT_RFI0012 ACNTINST5                                                      CFT006
FT_RFI0013 ACNTINST6                                                      CFT006
FT_RFI0014 ACNT_TYPE                                                      CFT006
FT_RFI0015 ACNTSRVIN1                                                     CFT006
FT_RFI0016 ACNTSRVIN2                                                     CFT006
FT_CCT0001 CCTID                                                          CFT008
FT_CCT0002 FILE_REF                                                       CFT008
FT_CCT0003 TRAN_REF                                                       CFT008
FT_CCT0004 BANK_OPCDE                                                     CFT008
FT_CCT0005 DESTIN                                                         CFT008
FT_CCT0006 TOT_VALDAT Date                                                CFT008
FT_CCT0007 CHARGE                                                         CFT008
FT_CCT0008 TRAN_TYPCD                                                     CFT008
FT_CCI0001 SCHG_CCY                                                       CFT008
FT_CCI0002 SCHG       AmountL                                             CFT008
FT_CCI0003 SCHG_PCCY  AmountL                                             CFT008
FT_CCI0004 SCHG_TCCY  AmountL                                             CFT008
FT_CCI0005 SUM_AMTS   AmountL                                             CFT008
FT_CCI0006 SUM_RCHG   AmountL8                                            CFT008
FT_CCI0007 SDR_CORR                                                       CFT008
FT_CCI0008 RCV_CORR                                                       CFT008
FT_CCI0009 ADD_INFO1                                                      CFT008
FT_CCI0010 ADD_INFO2                                                      CFT008
FT_CCI0011 ADD_INFO3                                                      CFT008
FT_CCI0012 ADD_INFO4                                                      CFT008
FT_CCI0013 ADD_INFO5                                                      CFT008
FT_CCI0014 ADD_INFO6                                                      CFT008
FT_CCI0015 DR_INPAKY                                                      CFT008
FT_CCI0016 DR_DRAKY                                                       CFT008
FT_SCH0001 SCHG_CCY2                                                                          CSW201
FT_SCH0002 SCHG2      AmountL                                                                 CSW201
FT_SCH0003 SCHG_PCCY2 AmountL                                                                 CSW201
FT_SCH0004 SCHG_TCCY2 AmountL                                                                 CSW201
FT_SCH0005 SCHG_CCY3                                                                          CSW201
FT_SCH0006 SCHG3      AmountL                                                                 CSW201
FT_SCH0007 SCHG_PCCY3 AmountL                                                                 CSW201
FT_SCH0008 SCHG_TCCY3 AmountL                                                                 CSW201
FT_SCH0009 SCHG_CCY4                                                                          CSW201
FT_SCH0010 SCHG4      AmountL                                                                 CSW201
FT_SCH0011 SCHG_PCCY4 AmountL                                                                 CSW201
FT_SCH0012 SCHG_TCCY4 AmountL                                                                 CSW201
FT_SCH0013 SCHG_CCY5                                                                          CSW201
FT_SCH0014 SCHG5      AmountL                                                                 CSW201
FT_SCH0015 SCHG_PCCY5 AmountL                                                                 CSW201
FT_SCH0016 SCHG_TCCY5 AmountL                                                                 CSW201
FT_MT00001 TRAN_TYPE                                                      CFT006
FT_MT00002 TRAN_STYPE                                                     CFT006
FT_MT00003 BOOK_BRCH                                                      CFT006
FT_MT00004 ORIG_BRCH                                                      CFT006
FT_MT00005 SND_INST                                                       CFT006
FT_MT00006 EXRATE     Xrate L8                                            CFT006
FT_MT00007 EXRATE_IND                                                     CFT006
FT_MT00008 OUT_PAYFL                                                      CFT006
FT_MT00009 DTL_CHRG                                                       CFT006
FT_MT00010 RCHG_CCY                                                       CFT006
FT_MT00011 RCHG       AmountL                                             CFT006
FT_MT00012 RCHG_PCCY                                                      CFT006
FT_MT00013 RCHG_PCHG  AmountL                                             CFT006
FT_MT00014 RCHG_TCCY                                                      CFT006
FT_MT00015 RCHG_TCHG  AmountL                                             CFT006
FT_MT10001 ORD_CUST1                                                      CFT006
FT_MT10002 ORD_CUST2                                                      CFT006
FT_MT10003 ORD_CUST3                                                      CFT006
FT_MT10004 ORD_CUST4                                                      CFT006
FT_MT10005 ORD_CUST5                                                      CFT006
FT_MT10006 ORD_CUSTTP                                                     CFT006
FT_MT10007 BENEFICI1                                                      CFT006
FT_MT10008 BENEFICI2                                                      CFT006
FT_MT10009 BENEFICI3                                                      CFT006
FT_MT10010 BENEFICI4                                                      CFT006
FT_MT10011 BENEFICI5                                                      CFT006
FT_MT10012 BENE_TYPE                                                      CFT006
FT_MT10013 REM_INFO1                                                      CFT006
FT_MT10014 REM_INFO2                                                      CFT006
FT_MT10015 REM_INFO3                                                      CFT006
FT_MT10016 REM_INFO4                                                      CFT006
FT_MT10017 REG_RPT1                                                       CFT006
FT_MT10018 REG_RPT2                                                       CFT006
FT_MT10019 REG_RPT3                                                       CFT006
FT_MT20001 FTRN_TYPE                                                      CFT006
FT_MT20002 FTRN_REF                                                       CFT006
FT_MT20003 CHQ_PRNT                                                       CFT006
FT_MT20004 SWIFT_PTY                                                      CFT006
FT_MT20005 BASE_RATE  Xrate L3                                            CFT006
FT_MT20006 INP_USER                                                       CFT006
FT_MT20007 INP_DATE   Date                                                CFT006
FT_MT20008 INP_TIME                                                       CFT006
FT_MT20009 UPD_USER                                                       CFT006
FT_MT20010 UPD_DATE   Date                                                CFT006
FT_MT20011 UPD_TIME                                                       CFT006
FT_MT20012 AUT_USR1                                                       CFT006
FT_MT20013 AUT_USR2                                                       CFT006
FT_MT20014 AUTH_IND                                                       CFT006
FT_MT20015 BATCH_NO                                                       CFT006
FT_MT20016 ADV_CRT                                                        CFT006
FT_MT20017 TOT_CRTRN  AmountL                                             CFT006
FT_MT20018 AKEY_INDT                                                      CFT006
FT_MT20019 AKEY_DRDT                                                      CFT006
FT_MT20020 AKEY_CRDT                                                      CFT006
PYDRCR0001 PAY_REF                                                        CFT014
PYDRCR0002 VALUE DATE Date                                                CFT014
PYDRCR0003 PRINT_DATE Date                                                CFT014
PYDRCR0004 PAY_TYPE                                                       CFT014
PYDRCR0005 PAY_S_TYPE                                                     CFT014
PYDRCR0006 PAY_ST_DSC                                                     CFT014
PYDRCR0007 SETTLEMOD                                                      CFT014
PYDRCR0008 CR_CCY                                                         CFT014
PYDRCR0009 CR_CCY_NAM                                                     CFT014
PYDRCR0010 CR_AMOUNT  AmountL                                             CFT014
PYDRCR0011 CHQ_NUMBER                                                     CFT014
PYDRCR0012 CHQ_SEQ_NO                                                     CFT014
PYDRCR0013 CR DATE    Date                                                CFT014
PYDRCR0014 DR_CCY                                                         CFT014
PYDRCR0015 DR_CCY_NAM                                                     CFT014
PYDRCR0016 DR_AMOUNT  AmountL                                             CFT014
PYDRCR0017 DR DATE    Date                                                CFT014
TRNCHG0001 RCV_CHGS   AmountL                                             CFT014
TRNCHG0002 SNDR_CHG1  AmountL                                             CFT014
TRNCHG0003 SNDR_CCY1                                                      CFT014
TRNCHG0004 SNDR_CHG2  AmountL                                             CFT014
TRNCHG0005 SNDR_CCY2                                                      CFT014
TRNCHG0006 SNDR_CHG3  AmountL                                             CFT014
TRNCHG0007 SNDR_CCY3                                                      CFT014
TRNCHG0008 SNDR_CHG4  AmountL                                             CFT014
TRNCHG0009 SNDR_CCY4                                                      CFT014
TRNCHG0010 SNDR_CHG5  AmountL                                             CFT014
TRNCHG0011 SNDR_CCY5                                                      CFT014
TRNCHG0012 EUR_RCHG   AmountL                                             CFT014
TRNCHG0013 EUR_SCHG1  AmountL                                             CFT014
TRNCHG0014 EUR_SCHG2  AmountL                                             CFT014
TRNCHG0015 EUR_SCHG3  AmountL                                             CFT014
TRNCHG0016 EUR_SCHG4  AmountL                                             CFT014
TRNCHG0017 EUR_SCHG5  AmountL                                             CFT014
CFT0090001 CFT009                                                         CFT009
CFT0090002 CODE_TELEX                                                     CFT009
CFT0090003 CODE_CHQ                                                       CFT009
CFT0090004 CODE_COSTA                                                     CFT009
CFT0090005 CODE_SWFTS                                                     CFT009
CFT0090006 CODE_SWFTP                                                     CFT009
CFT0090007 CODE_MISC0                                                     CFT009
CFT0090008 CODE_MISC1                                                     CFT009
CFT0090009 CODE_MISC2                                                     CFT009
CFT0090010 CODE_MISC3                                                     CFT009
CFT0090011 CODE_MISC4                                                     CFT009
CFT0090012 CODE_MISC5                                                     CFT009
CFT0090013 CODE_TRAN                                                      CFT009
CFT0090014 CODE_FX                                                        CFT009
CFT0090015 CODE_ADVIC                                                     CFT009
CFT0090016 CODE_TELEP                                                     CFT009
CFT0090017 CODE_COLL                                                      CFT009
CFT0090018 CFT010                                                         CFT009
CFT0090019 FXSPREAD                                                       CFT009
VATA  0001 VATA_TELEX AmountL                                             CFT009
VATA  0002 VATA_CHQ   AmountL                                             CFT009
VATA  0003 VATA_COSTA AmountL                                             CFT009
VATA  0004 VATA_SWFTS AmountL                                             CFT009
VATA  0005 VATA_SWFTP AmountL                                             CFT009
VATA  0006 VATA_MISC0 AmountL                                             CFT009
VATA  0007 VATA_MISC1 AmountL                                             CFT009
VATA  0008 VATA_MISC2 AmountL                                             CFT009
VATA  0009 VATA_MISC3 AmountL                                             CFT009
VATA  0010 VATA_MISC4 AmountL                                             CFT009
VATA  0011 VATA_MISC5 AmountL                                             CFT009
VATA  0012 VATA_TRAN  AmountL                                             CFT009
VATA  0013 VATA_FX    AmountL                                             CFT009
VATA  0014 VATA_ADVIC AmountL                                             CFT009
VATA  0015 VATA_TELEP AmountL                                             CFT009
VATA  0016 VATA_COLL  AmountL                                             CFT009
VATA  0017 ENT_TOTCHG AmountL                                             CFT009
VATE  0001 VATE_TELEX AmountL                                             CFT009
VATE  0002 VATE_CHQ   AmountL                                             CFT009
VATE  0003 VATE_COSTA AmountL                                             CFT009
VATE  0004 VATE_SWFTS AmountL                                             CFT009
VATE  0005 VATE_SWFTP AmountL                                             CFT009
VATE  0006 VATE_MISC0 AmountL                                             CFT009
VATE  0007 VATE_MISC1 AmountL                                             CFT009
VATE  0008 VATE_MISC2 AmountL                                             CFT009
VATE  0009 VATE_MISC3 AmountL                                             CFT009
VATE  0010 VATE_MISC4 AmountL                                             CFT009
VATE  0011 VATE_MISC5 AmountL                                             CFT009
VATE  0012 VATE_TRAN  AmountL                                             CFT009
VATE  0013 VATE_FX    AmountL                                             CFT009
VATE  0014 VATE_ADVIC AmountL                                             CFT009
VATE  0015 VATE_TELEP AmountL                                             CFT009
VATE  0016 VATE_COLL  AmountL                                             CFT009
VATE  0017 EUR_TOTCHG AmountL                                             CFT009
BBP   0001 BRANCH                                                         CFT009
BBP   0002 BRANCH NAM                                                     CFT009
BBP   0003 BOOK_CODE                                                      CFT009
BBP   0004 BOOK_DESC                                                      CFT009
BBP   0005 PROF_CENT                                                      CFT009
BBP   0006 PROF_C_DSC                                                     CFT009
DEXNAR0001 DEX_NARR01                    Extended Narrative 1                                 CER031
DEXNAR0002 DEX_NARR02                    Extended Narrative 2                                 CER031
DEXNAR0003 DEX_NARR03                    Extended Narrative 3                                 CER031
DEXNAR0004 DEX_NARR04                    Extended Narrative 4                                 CER031
DEXNAR0005 DEX_NARR05                    Extended Narrative 5                                 CER031
DEXNAR0006 DEX_NARR06                    Extended Narrative 6                                 CER031
DEXNAR0007 DEX_NARR07                    Extended Narrative 7                                 CER031
DEXNAR0008 DEX_NARR08                    Extended Narrative 8                                 CER031
DEXNAR0009 DEX_NARR09                    Extended Narrative 9                                 CER031
DEXNAR0010 DEX_NARR10                    Extended Narrative 10                                CER031
DEXNAR0011 DEX_NARR11                    Extended Narrative 11                                CER031
DEXNAR0012 DEX_NARR12                    Extended Narrative 12                                CER031
DEXNAR0013 DEX_NARR13                    Extended Narrative 13                                CER031
DEXNAR0014 DEX_NARR14                    Extended Narrative 14                                CER031
DEXNAR0015 DEX_NARR15                    Extended Narrative 15                                CER031
DEXNAR0016 DEX_NARR16                    Extended Narrative 16                                CER031
DEXNAR0017 DEX_NARR17                    Extended Narrative 17                                CER031
DEXNAR0018 DEX_NARR18                    Extended Narrative 18                                CER031
DEXNAR0019 DEX_NARR19                    Extended Narrative 19                                CER031
DEXNAR0020 DEX_NARR20                    Extended Narrative 20                                CER031
CEXNAR0001 CEX_NARR01                    Extended Narrative 1 Crd                             CER031
CEXNAR0002 CEX_NARR02                    Extended Narrative 2 Crd                             CER031
CEXNAR0003 CEX_NARR03                    Extended Narrative 3 Crd                             CER031
CEXNAR0004 CEX_NARR04                    Extended Narrative 4 Crd                             CER031
CEXNAR0005 CEX_NARR05                    Extended Narrative 5 Crd                             CER031
CEXNAR0006 CEX_NARR06                    Extended Narrative 6 Crd                             CER031
CEXNAR0007 CEX_NARR07                    Extended Narrative 7 Crd                             CER031
CEXNAR0008 CEX_NARR08                    Extended Narrative 8 Crd                             CER031
CEXNAR0009 CEX_NARR09                    Extended Narrative 9 Crd                             CER031
CEXNAR0010 CEX_NARR10                    Extended Narrative 10 Crd                            CER031
CEXNAR0011 CEX_NARR11                    Extended Narrative 11 Crd                            CER031
CEXNAR0012 CEX_NARR12                    Extended Narrative 12 Crd                            CER031
CEXNAR0013 CEX_NARR13                    Extended Narrative 13 Crd                            CER031
CEXNAR0014 CEX_NARR14                    Extended Narrative 14 Crd                            CER031
CEXNAR0015 CEX_NARR15                    Extended Narrative 15 Crd                            CER031
CEXNAR0016 CEX_NARR16                    Extended Narrative 16 Crd                            CER031
CEXNAR0017 CEX_NARR17                    Extended Narrative 17 Crd                            CER031
CEXNAR0018 CEX_NARR18                    Extended Narrative 18 Crd                            CER031
CEXNAR0019 CEX_NARR19                    Extended Narrative 19 Crd                            CER031
CEXNAR0020 CEX_NARR20                    Extended Narrative 20 Crd                            CER031
CFT1340001 IBAN                                                                               CFT134
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
