     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Input cycle - retail advices print')          *
/*OVRF*: OVRDBF GLJEXXX1 GLJENPL1                                   : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4900 - Input Cycle - Retail Advice Print                   *
     F*                                                               *
     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*  (phase(s))                                                   *
     F*                                                               *
     F*  Called By: mmCnnnn - (program name)                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. CER050             Date 16Jun19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 MD027587           Date 19Jun14               *
      *                 CER055             Date 06Dec10               *
      *                 CAP207             Date 10Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23742           Date 09May09               *
      *                 BUG23445A          Date 19Apr09               *
      *                 BUG23445           Date 17Mar09               *
      *                 BUG23350           Date 14Mar09               *
      *                 BUG23197           Date 03Mar09               *
      *                 CER031             Date 19May08               *
      *                 CER030             Date 09Jul08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9646            Date 20Dec05               *
      *                 CSC024             Date 07Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2330            Date 29Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      *                 170613             Date 16Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 188244             Date 19Jan01               *
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 CFT004             Date 04Aug99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CEU014             Date 12Jun98               *
     F*                 CEU013             Date 09Mar98               *
     F*                 113415             Date 01May97               *
     F*                 089776             DATE 17APR96               *
     F*                 096420             DATE 24NOV95               *
     F*                 086918             DATE 02MAY95               *
     F*                 S01522             DATE 06JAN94               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CER050 - Annualised Percentage Rate (Recompile)              *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  MD027587 - Unable to used the C for Copy and T for Template  *
      *             (Recompile)                                       *
      *  CER055 - Penalty Interest on Exceeding Overdraft Limit       *
      *  CAP207 - Account Balance Check extended to other APIs        *
      *           (Recompile)                                         *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23742 - Improper handling of Ext Narr from Batch          *
      *             Interface Input                                   *
      *  BUG23445A - Paper statements were not reformatted based on   *
      *              network *PAPER                                   *
      *  BUG23445 - Format network according to network Paper if      *
      *             Account is linked                                 *
      *  BUG23350 - Comment the extra processing of subroutine PSHGRS *
      *             and POPGRS                                        *
      *  BUG23197 - Pass blank parameter to the MG001900(Output       *
      *             parameter)                                        *
      *  CER031 - FT/GL Extended Narrative German Features            *
      *  CER030 - Multicash German Feature (Recompile)                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
      *  CSC024 - Open Month End (Recompile)                          *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2330- CG programs looking at wrong dataarea for CSC022    *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  170613 - Retail Advices do not print narrative description   *
      *           when narrative code is used.                        *
     F*  CSD006 - Recompiled over changed SDCURRPD.                   *
     F*  188244 - RE0880 not printed when customer is not a correspdnt*
     F*  CFT004 - Straight Through Processing Phase 2                 *
     F*           International Bank Account Numbers (IBAN)           *
     F*  CEU014 - EMU User Defined Correspondence Changes             *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*  113415 - Add the setup of customer nbr and report name       *
     F*  089776 - Add 'Account officer' details                       *
     F*  096420 - Correct formatting of Account                       *
     F*  086918 - Add customer town RDE to Group set CUST.            *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*                                                               *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     F/SPACE 5
     FGLJENHL0UF  E           K        DISK         KCOMIT
     FGLJEXXX1IF  E           K        DISK         KCOMIT
     F            @BTREAL                           KRENAME@BTXXX
     FGLJENPL1UF  E           K        DISK         KCOMIT
     FSDDEPTL0IF  E           K        DISK
     FSDRETRL0IF  E           K        DISK
     FACCNTL0 IF  E           K        DISK
     FREIAC   IF  E           K        DISK
     FSDCUSTL0IF  E           K        DISK
     FACCNTBY0IF  E           K        DISK                                                   CER055
      *                                                                                       CER031
      ** Midas GL Journal entry - add. inf. - retrieval                                       CER031
      *                                                                                       CER031
     FGLJENXL2IF  E           K        DISK                                                   CER031
      *                                                                                       CER031
      ** Midas GL Network accounts - MT94x - retrieval                                      BUG23445
      *                                                                                     BUG23445
     F*GLNW94L1IF  E           K        DISK                                      BUG23445 BUG23445A
     FGLNWACL1IF  E           K        DISK                                                BUG23445A
      *                                                                                     BUG23445
      ** GL MultiCash Narratives File                                                       BUG23742
      *                                                                                     BUG23742
     FGLMNARL1IF  E           K        DISK                                                 BUG23742
      *                                                                                     BUG23742
     F/COPY WNCPYSRC,CG4900F001
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E********************##GRP   1  22 10   ##RDEA 22                    086918
     E***********         ##GRP   1  23 10   ##RDEA 22              086918CEU014
     E***********         ##GRP   1  26 10   ##RDEA 22             CEU014 CFT004
     E**********          ##GRP   1  27 10   ##RDEA 22                                 CFT004 CER031
     E**********          ##GRP   1  67 10   ##RDEA 22                               CER031 BUG23742
     E**********          ##GRP   1  71 10   ##RDEA 22                               BUG23742 CER055
     E                    ##GRP   1  82 10   ##RDEA 22                                        CER055
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
      *                                                                                       CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      *                                                                                       CSC022
     E                    WCMT       10 10                                                    CSC022
      *                                                                                       CER031
     E                    FLDNAM     40 10                                                    CER031
     E                    MSGID      40  7                                                    CER031
     E                    MSGDTA     40 45                                                    CER031
     E                    WFLDNM     40 10                                                    CER031
     E                    WMGID      40  7                                                    CER031
     E                    WMGDTA     40 45                                                    CER031
      *                                                                                     BUG23742
      ** Array for 22 * 35                                                                  BUG23742
      *                                                                                     BUG23742
     E                    EXT        22 35                                                  BUG23742
     I*
     I            DS
     I                                    B   1   20##OSEQ
     I**  Convert Ouput Sequence between Numeric and Binary
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9646
     I                                        15632 ##S                                      BUG9646
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I** Used to convert item reference from character to numeric
     I*
     ISDRETL    E DSSDRETLPD
     I              QQACCD                          QQACCX                                  BUG23445
     IDSFDY     E DSDSFDY
     ISDBANK    E DSSDBANKPD
      **  External DS for Bank details
     I**   EXTERNAL DATA STRUCTURE FOR BRANCH DETAILS
     I**
     ISDBRCH    E DSSDBRCHPD
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     ISDCURR    E DSSDCURRPD                101
      **  External DS for currency details
     IDSSDY     E DSDSSDY
      **  Second DS for access programs, long data structure
      *
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
      *                                                                   CEU014
     ISCSARD    E DSSCSARDPD                                              CEU014
      ** SAR Details Accessed via access program                          CEU014
      *                                                                   CEU014
     ISDGELR    E DSSDGELRPD                                              CEU014
     I              QQACCD                          QQACC1                                    CGL029
      ** General Ledger Details Accessed Via Access Program               CEU014
      *                                                                   CEU014
     ISDCUST    E DSSDCUSTPD                                              CEU014
     I              QQDFAC                          QQDFA1                                    CGL029
      ** Customer Details Accessed Via Access Program                     CEU014
      *                                                                   CEU014
     ISDNARR    E DSSDNARRPD                                              170613
      ** Narrative Details Accessed Via Access Program                    170613
      *                                                                   170613
     IWDSJOB    E DSSCCMTJOB                                                                  CSC022
     I              COMITNUM                        WCMTNO                                    CSC022
     I              COMITJOB1                       WJOB01                                    CSC022
     I              COMITJOB2                       WJOB02                                    CSC022
     I              COMITJOB3                       WJOB03                                    CSC022
     I              COMITJOB4                       WJOB04                                    CSC022
     I              COMITJOB5                       WJOB05                                    CSC022
     I              COMITJOB6                       WJOB06                                    CSC022
     I              COMITJOB7                       WJOB07                                    CSC022
     I              COMITJOB8                       WJOB08                                    CSC022
     I              COMITJOB9                       WJOB09                                    CSC022
     I              COMITJOB10                      WJOB10                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      *                                                                                       CSC022
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
     IDSACCT      DS
     I                                        1   6 CNUMX
     I                                        7   9 CCYX
     I**********                             10  13 ACODX                                     CGL029
     I**********                             14  15 ACSQX                                     CGL029
     I**********                             16  18 BRCHX                                     CGL029
     I                                       10  19 ACODX                                     CGL029
     I                                       20  21 ACSQX                                     CGL029
     I                                       22  24 BRCHX                                     CGL029
     I##ACC       DS
     I                                        1   6 ##CUST
     I                                        7   9 ##CYCD
     I**********                             10  13 ##ACCD                                    CGL029
     I**********                             14  15 ##ACSN                                    CGL029
     I**********                             16  18 ##BRCA                             096420 CGL029
     I                                       10  19 ##ACCD                                    CGL029
     I                                       20  21 ##ACSN                                    CGL029
     I                                       22  24 ##BRCA                                    CGL029
     I            DS
     I*
     I*     Sub fields to hold key values of files
     I*
     I                                        1   6 TRNKEY
      *
      *    STANDARD LOCAL DATA AREA FIELDS
      *
     IRUNDT       DS
      *  DATA AREA RUNDAT
      *
      *
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I/COPY WNCPYSRC,CG4900I001
     I*---------------------------------------------------------------------
     I* Named constants
     I*
     I              'RETAILADVS'          C         #TEXT1
     I              'INPUT_CYCL'          C         #TEXT2
     I*
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
      *                                                                   089776
      ** Parameters for call to CG4976.                                   089776
      **                                                                  089776
     IP5PARM      DS                            256                       089776
      * Output Sequence                                                   089776
     I                                        1   90R1OSEQ                089776
      * UDC item number                                                   089776
     I                                       10  170R1ITEM                089776
      * This bind level                                                   089776
     I                                       18  250R1TBIN                089776
      * Previous bind level                                               089776
     I                                       26  330R1PBIN                089776
     IP7PARM      DS                            256                       089776
      * Account Officer                                                   089776
     I                                        1   2 P1ACOF                089776
     I/COPY CGCPYSRC,SRERRI
     I/COPY CGCPYSRC,CGAUDTI
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           BATCH   3        Batch Number
     C                     PARM           W0RTN
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      **  Initial processing
     C                     EXSR SRINIT
      *
      **  Main processing
     C                     EXSR SRMAIN
      *
      **  Program termination
     C                     EXSR SRTERM
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
     C                     EXSR R08RAD
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R08RAD                                         *
      * Function    :  Input Cycle - Retail Advice Print              *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           R08RAD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'r08RAD'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\r08RAD' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
     C*
     C*     Position pointer on first transaction record of the batch
     C*
     C           BATCH     CHAINGLJEXXX1             07
     C  N07      BATCH     CHAINGLJENPL1             07
     C*
     C*     Data base error if no transaction recs exist for the batch
     C*
     C           *IN07     IFEQ '1'
     C                     MOVEL'GLJENPL1'W0FILE
     C                     MOVELBATCH     W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C**
     C*
     C*     Process all transactions relating to the batch
     C*
     C           *IN07     DOWEQ'0'
     C*
     C*     Ignore transactions that have not been shadow posted
     C*
     C           BTSHPI    CABNE'Y'       GETREC
     C*
     C*     Ignore non retail transactions
     C*
     C           BTACTY    CABNE'R'       GETREC
     C*
     C*     Ignore transaction if its advice has been printed
     C*
     C           BTRADP    CABEQ'Y'       GETREC
     C*
     C*     Access transaction types file using the narrative code
     C*
     C           BTTRTY    CHAINSDRETRL0             08
     C*
     C*     Data base error if record not found
     C*
     C           *IN08     IFEQ '1'                        NARR NOT
     C                     MOVE *BLANK    A1RTNM           FOUND
     C                     END
     C*
     C*     Ignore transaction if advice not required for this type
     C*
     C           A1PADI    CABNE'Y'       GETREC
      *                                                                   CEU013
     C* Retrieve the currency record if the currency has changed.         CEU013
     C*                                                                   CEU013
     C           CEU013    IFEQ 'Y'                                       CEU013
     C           BRTOJE    ANDEQ'I'                                       CEU013
     C           BTCYCD    IFNE WKCYCD                                    CEU013
      **  Retrieve the currency 'In' currency flag details                CEU013
     C                     CALL 'AOCURRR0'                                CEU013
     C                     PARM *BLANKS   ##RTCD           B:Return Cd    CEU013
     C                     PARM '*KEY'    ##OPTN           I:Option       CEU013
     C                     PARM BTCYCD    ##CCYP  3        I:Currency CodeCEU013
     C           SDCURR    PARM *BLANK    DSSDY            O:Format       CEU013
      *                                                                   CEU013
      **  Database Error                                                  CEU013
     C           ##RTCD    IFNE *BLANK                                    CEU013
     C                     MOVEL'SDCURRPD'W0FILE                          CEU013
     C                     MOVELBTCYCD    W0KEY            ***************CEU013
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *CEU013
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU013
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU013
     C                     EXSR SRERR                                     CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C                     MOVE A6INCY    WKINCY                          CEU013
     C                     MOVE BTCYCD    WKCYCD                          CEU013
     C                     ENDIF                                          CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C*
     C*     Access accounts master file
     C*
     C                     MOVE BTCUST    CNUM
     C                     MOVE BTCYCD    CCY
     C                     MOVE BTACCD    ACOD
     C                     MOVE BTACSN    ACSQ
     C*
     C*
     C           ACCKEY    KLIST
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           BTIBCA
     C*
     C           ACCKEY    CHAINACCNTL0              14
     C*
     C*     Data base error if record not found
     C*     (OR IF ACCOUNT FOUND IS NON-RETAIL)
     C*                                                                   CEU013
     C* If switchable feature CEU013 is installed, the batch is an        CEU013
     C*   interface batch and the item currency is an 'In' currency,      CEU013
     C*   then the account may not be existing and hence is not an        CEU013
     C*   error. The Journal entry interface batch maintenance allows     CEU013
     C*   only Retail or Nostro accounts and hence check for Retail       CEU013
     C*   account is not performed.                                       CEU013
     C*
     C           *IN14     IFEQ '1'
     C           CEU013    ANDNE'Y'                                       CEU013
     C           BRTOJE    ANDNE'I'                                       CEU013
     C           WKINCY    ANDNE'Y'                                       CEU013
     C           ATYP      ORNE 'R'
     C           *IN14     ANDEQ*OFF                                      CEU013
     C                     MOVEL'ACCNTL0' W0FILE
     C                     MOVE CNUM      CNUMX
     C                     MOVE CCY       CCYX
     C                     MOVE ACOD      ACODX
     C                     MOVE ACSQ      ACSQX
     C                     MOVELDSACCT    W0KEY            ***************
     C                     Z-ADD08        W0ERNB           * DB ERROR 08 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C* If the account is not found, the further process is bypassed      CEU013
     C*  and the next record is read.                                     CEU013
     C*                                                                   CEU013
     C           *IN14     IFEQ *OFF                                      CEU013
     C/COPY WNCPYSRC,CG4900C006
     C*     Access retail interest and charges
     C*
     C*
     C           ACCKEY    CHAINREIAC                09
     C*
     C*     Data base error if record not found
     C*
     C           *IN09     IFEQ '1'
     C                     MOVEL'REIAC   'W0FILE
     C                     MOVE CNUM      CNUMX
     C                     MOVE CCY       CCYX
     C                     MOVE ACOD      ACODX
     C                     MOVE ACSQ      ACSQX
     C                     MOVE BTIBCA    BRCHX
     C                     MOVELDSACCT    W0KEY            ***************
     C                     Z-ADD09        W0ERNB           * DB ERROR 09 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C* If Retail interest and charges record is not retrieved the        CEU013
     C*   field Print transaction advice has the value of previous        CEU013
     C*   record and hence is initialised.                                CEU013
     C*                                                                   CEU013
     C           *IN14     IFEQ *ON                                       CEU013
     C                     MOVE 'N'       PTRA                            CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C*
     C*     Ignore transaction if advice not required for this account
     C*
     C           PTRA      CABNE'Y'       GETREC
     C*
     C*     Access customer master
     C*
     C           BTCUST    CHAINSDCUSTL0             10
     C*
     C**    Data base error if record not found
     C*
     C           *IN10     IFEQ '1'
     C                     MOVEL'SDCUSTL0'W0FILE
     C                     MOVELBTCUST    W0KEY            ***************
     C                     Z-ADD03        W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
      *
      **  Update records for update flag.
     C                     MOVEL'Y'       #RECS   1
      *
     C                     EXSR SRGENR
     C**********           EXSR PSHGRS                                               CCG015 BUG23350
      *                                                                   096420
      *  Only generated if needed                                         096420
     C           ##RTCD    IFEQ *BLANKS                                   096420
      *
      **  Branch Details
     C                     EXSR BRANCH
      *
      **  Common Details
     C                     EXSR DETL
      *
      **  Input Cycle - Retail Print Advices
     C                     EXSR R08DTL
      *
      **  Customer Details
     C                     EXSR CUST
      *                                                                                       CER055
      **  Overdraft Details                                                                   CER055
      *                                                                                       CER055
     C           CER055    IFEQ 'Y'                                                           CER055
     C                     EXSR ODACCT                                                        CER055
     C                     ENDIF                                                              CER055
      *                                                                                       CER055
     C/COPY WNCPYSRC,CG4900C003
      *                                                                   089776
      ** Counterparty Account Officer Details                             089776
     C                     EXSR ACOF                                      089776
      *                                                                                       CER031
      ** Retrieve Extended Narratives based on Transaction Type                               CER031
      *                                                                                       CER031
     C           CER031    IFEQ 'Y'                                                           CER031
     C           CER030    OREQ 'Y'                                                         BUG23742
     C                     EXSR SREXNR                                                        CER031
     C                     ENDIF                                                              CER031
      *                                                                   089776
     C/COPY WNCPYSRC,CG4900C005
     C**********           ENDIF                                   096420 188244
      *
      * Move counter below so that Retail Advice Pprinted updated if      188244
      * through UDC.                                                      188244
      ****Increment*the*count of records read.                            188244
     C**********           ADD  1         ##DREC  50                      188244
     C*
     C*     Update transaction record to show that its printed
     C*
     C                     MOVE 'Y'       BTRADP
     C                     UPDAT@BTREAL                12
     C*
     C*     Data base error if update fails
     C*
     C           *IN12     IFEQ '1'
     C                     MOVEL'GLJENPL1'W0FILE
     C                     MOVELTRNKEY    W0KEY            ***************
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C                     ENDIF                                          188244
      *                                                                   188244
      **  Increment the count of records read.                            188244
     C                     ADD  1         ##DREC  50                      188244
     C*                                                                   188244
      *
      ** Audit processing
     C                     EXSR SRAUDT
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
      *                                                                                       CCG015
     C**********           EXSR POPGRS                                               CCG015 BUG23350
     C*
     C           GETREC    TAG
     C*
     C*     Read next transaction record
     C*     READ DUMMY FILE FIRST IN CASE RECORD LOCK
     C*
     C           BATCH     READE@BTXXX                   07
     C  N07      BATCH     READE@BTREAL                  07
     C                     END
      *
      ** Audit processing where no records selected for processing.
     C           #RECS     IFEQ 'N'
     C                     EXSR SRAUDT
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C                     ENDIF
      *
      *................................................................
      *
     C           EX8RAD    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD  7
     C                     PARM '*KEY    '##OPTN  7
     C                     PARM BTIBCA    ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBTIBCA    W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
      *
      ** Branch
     C***********BMBNRA    IFEQ 'Y'
     C***********MBIN      ANDEQ'Y'
     C                     MOVELBTIBCA    ##D,1
     C***********          ENDIF
      *
      ** Branch Name
     C           MBIN      IFEQ 'Y'
     C                     MOVELA8BRNM    ##D,2
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DETL                                           *
      * Function    :  Common Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           DETL      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DETL  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\DETL  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Run date
     C                     MOVELBJRDNB    ##D,1
      *
      ** Value date
     C                     MOVELBTVLDT    ##D,2
      *
      ** DR/CR Indicator
     C                     MOVELBTDCIN    ##D,3
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTL      TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  R08DTL                                         *
      * Function    :  Input Cycle Retail Advice Print                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           R08DTL    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'R08DTL'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\R08DTL' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Retail Account Number
     C           BTRACN    IFNE *ZEROS
     C***********          MOVELBTRACN    ##D,1
     C***********          MOVE *BLANKS   ##D,2
     C***********          MOVELBTRACN    ##D,2                           096420
     C                     MOVELBTRACN    ##D,1                           096420
     C                     ENDIF                                          096420
     C***********          MOVE *BLANKS   ##D,1                           096420
     C***********          ELSE                                           096420
     C                     MOVE BTCUST    ##CUST
     C                     MOVE BTCYCD    ##CYCD
     C                     MOVE BTACCD    ##ACCD
     C                     MOVE BTACSN    ##ACSN
     C                     MOVE BTIBCA    ##BRCA                          096420
     C                     MOVEL##ACC     ##D,2                           096420
     C***********          MOVEL##ACC     ##D,2
     C***********          MOVEL*BLANKS   ##D,1
     C***********          MOVEL##ACC     ##D,1                           096420
     C***********          MOVEL*BLANKS   ##D,2                           096420
     C***********          ENDIF                                          096420
      *
      **  Batch Number
     C                     MOVELBTBTNB    ##D,3
      *
      **  Batch Item Number
     C                     MOVELBTBINB    ##D,4
      *
      **  Department Name
     C                     MOVELAEDPNM    ##D,5
      *
      **  Retail transaction name
     C                     MOVELA1RTNM    ##D,6
      *
      **  Narrative/Description
      *                                                                   170613
     C           BTNRDC    IFEQ *BLANK                                    170613
     C                     CALL 'AONARRR0'                                170613
     C                     PARM *BLANK    ##RTCD                          170613
     C                     PARM '*KEY'    ##OPTN                          170613
     C                     PARM BTNVCD    ##NVCD  2                       170613
     C           SDNARR    PARM *BLANK    DSSDY                           170613
      *                                                                   170613
     C           ##RTCD    IFNE *BLANK                                    170613
     C                     MOVEL'SDNARRPD'W0FILE                          170613
     C                     MOVELBTNVCD    W0KEY                           170613
     C                     Z-ADD5         W0ERNB                          170613
     C                     MOVEL'MEM5004' W0MSGD                          170613
     C                     MOVEL'MIDAS'   W0MSGF                          170613
     C                     MOVE '1'       *INU7                           170613
     C                     MOVE '1'       *INU8                           170613
     C                     EXSR SRERR                                     170613
     C                     ELSE                                           170613
     C                     MOVELALDON     ##D,7                           170613
     C                     END                                            170613
     C                     ELSE                                           170613
     C                     MOVELBTNRDC    ##D,7
     C                     END                                            170613
      *
      **  Currency
     C                     MOVELBTCYCD    ##D,8
      *
      **  Retrieve the currency details.
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   ##RTCD           B:Return Cd
     C                     PARM '*KEY'    ##OPTN           I:Option
     C                     PARM CCY       ##CCYP  3        I:Currency Code
     C           SDCURR    PARM *BLANK    DSSDY            O:Format
      *
      **  Database Error
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELBTCYCD    W0KEY            ***************
     C                     Z-ADD14        W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C/COPY WNCPYSRC,CG4900C001
      *
      **  Posting Amount
     C                     MOVELBTPTAM    ##D,9
     C/COPY WNCPYSRC,CG4900C008
     C                     MOVE A6NBDP    ##D,9
      *
      **  Deal Type
     C                     MOVELBTTRTY    ##D,10
      *
      **  Profit Centre
     C                     MOVELBTPRCN    ##D,11
      *                                                                   CEU014
      ** CEU014 changes.                                                  CEU014
      *                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C                     MOVE *BLANKS   EQCY    3                       CEU014
      *                                                                   CEU014
      ** If Posting Ccy is 'IN'.                                          CEU014
     C           A6INCY    IFEQ 'Y'                                       CEU014
     C                     MOVE BKEURO    EQCY                            CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** If Posting Ccy is BKEURO.                                        CEU014
     C           CCY       IFEQ BKEURO                                    CEU014
      *                                                                   CEU014
     C** Call Access Program for Customer Details using the Customer      CEU014
     C** No. or the Customer Shortname.                                   CEU014
      *                                                                   CEU014
     C                     MOVELCNUM      WWCNUM 10                       CEU014
     C                     CALL 'AOCUSTR0'                                CEU014
     C                     PARM '*BLANKS' ##RTCD                          CEU014
     C                     PARM '*KEY   ' ##OPTN                          CEU014
     C                     PARM WWCNUM    @KEY1  10                       CEU014
     C                     PARM *BLANKS   @KYST   7                       CEU014
     C           SDCUST    PARM SDCUST    DSSDY                           CEU014
      *                                                                   CEU014
      ** If Customer No./Customer Shortname does not exist...             CEU014
      *                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C                     MOVEL'SDCUSTPD'W0FILE                          CEU014
     C                     MOVEL@KEY1     W0KEY            ***************CEU014
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *CEU014
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** Set Equivalent currency to Designated In ccy.                    CEU014
     C                     MOVE BBDINC    EQCY                            CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** Check if Equivalent currency is not blank.                       CEU014
     C           EQCY      IFNE *BLANKS                                   CEU014
      *                                                                   CEU014
      **  Retrieve the currency details.                                  CEU014
     C                     CALL 'AOCURRR0'                                CEU014
     C                     PARM *BLANKS   ##RTCD           B:Return Cd    CEU014
     C                     PARM '*KEY'    ##OPTN           I:Option       CEU014
     C                     PARM EQCY      ##CCYP  3        I:Currency CodeCEU014
     C           SDCURR    PARM *BLANK    DSSDY            O:Format       CEU014
      *                                                                   CEU014
      **  Database Error                                                  CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C                     MOVEL'SDCURRPD'W0FILE                          CEU014
     C                     MOVEL##CCYP    W0KEY            ***************CEU014
     C                     Z-ADD23        W0ERNB           * DB ERROR 23 *CEU014
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** Convert Posting Amount from CCY to its equivalent ccy.           CEU014
     C                     Z-ADDBTPTAM    P@FRAM                          CEU014
     C                     MOVE CCY       P@FRCY                          CEU014
     C                     MOVE EQCY      P@TOCY                          CEU014
     C                     EXSR R@EURO                                    CEU014
     C                     MOVEL##OUTA    ##D,12                          CEU014
     C                     MOVE A6NBDP    ##D,12                          CEU014
     C                     MOVELEQCY      ##D,13                          CEU014
     C                     MOVELA6CYNM    ##D,14                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CFT004
      ** Set up International Bank Account Number (IBAN)                  CFT004
      *                                                                   CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
      *                                                                   CFT004
     C                     MOVE *BLANKS   PIWITH                          CFT004
     C           IBAN      IFNE *BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM IBAN      PIBAN  47                       CFT004
     C                     PARM           PIWITH 47                       CFT004
     C                     PARM *BLANKS   PINOBL 34                       CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     MOVELPIWITH    ##D,15                          CFT004
     C                     ENDIF                                          CFT004
      *                                                                                       CER055
     C           CER055    IFEQ 'Y'                                                           CER055
     C                     MOVEL'Y'       ##D,16                                              CER055
     C                     ENDIF                                                              CER055
      *                                                                                       CER055
     C/COPY WNCPYSRC,CG4900C007
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX8DTL    TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CUST                                           *
      * Function    :  Customer Details                               *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CUST      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CUST  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CUST  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *                                                                   113415
      ** Customer number                                                  113415
     C                     MOVELBBCUST    ##D,1                           113415
      *                                                                   113415
      ** Customer report name                                             113415
     C                     MOVELBBCRNM    ##D,2                           113415
      *
      ** Customer name and address line 1
     C                     MOVELBBCNA1    ##D,3
      *
      ** Customer name and address line 2
     C                     MOVELBBCNA2    ##D,4
      *
      ** Customer name and address line 3
     C                     MOVELBBCNA3    ##D,5
      *
      ** Customer name and address line 4
     C                     MOVELBBCNA4    ##D,6
      *                                                                   086918
      ** Customer Town                                                    086918
     C                     MOVELBBCRTN    ##D,7                           086918
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXST      TAG
      *
      **  Unwind subroutine stack name
     C                     EXSR POPGRS                                                        CCG015
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************                       CER055
     C/SPACE 5                                                                                CER055
      *****************************************************************                       CER055
      * Subroutine  :  ODACCT                                         *                       CER055
      * Function    :  Overdraft Details                              *                       CER055
      *                                                               *                       CER055
      * Called by   :                                                 *                       CER055
      * Calls       :                                                 *                       CER055
      *****************************************************************                       CER055
     C           ODACCT    BEGSR                                                              CER055
      *                                                                                       CER055
      **  Set up subroutine stack name                                                        CER055
      *                                                                                       CER055
     C                     ADD  1         Q                                                   CER055
     C                     MOVEL'ODACCT'  @STK,Q                                              CER055
      *                                                                                       CER055
      *................................................................                       CER055
      *                                                                                       CER055
      **  Retrieve subroutine specific data.                                                  CER055
      *                                                                                       CER055
     C           1         OCUR ##SRDT                                                        CER055
     C                     MOVEL##SPAT    S#PATH                                              CER055
      *                                                                                       CER055
      **  Set up Path.                                                                        CER055
      *                                                                                       CER055
     C                     MOVEL'\ODACCT' ##PNAM                                              CER055
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER055
      *                                                                                       CER055
     C                     EXSR PSHGRS                                                        CER055
      *                                                                                       CER055
      **  Retrieve RDE information for RDEs in group set                                      CER055
      *                                                                                       CER055
     C                     MOVEL@STK,Q    ##GRPS                                              CER055
     C                     Z-ADD1         ##RDEN                                              CER055
     C                     EXSR SRRRDE                                                        CER055
      *                                                                                       CER055
     C           ACCKEY    CHAINACCNTL0              14                                       CER055
     C           CFT004    IFEQ 'Y'                                                           CER055
     C           IBAN      ANDNE*BLANKS                                                       CER055
     C                     MOVELIBAN      ##D,1                                               CER055
     C                     ELSE                                                               CER055
     C                     MOVELACNO      ##D,1                                               CER055
     C                     ENDIF                                                              CER055
     C                     MOVELCCY       ##D,2                                               CER055
     C                     MOVELCLBL      ##D,3                                               CER055
     C                     MOVELLDBL      ##D,4                                               CER055
     C                     MOVELODLN      ##D,5                                               CER055
     C                     MOVELODED      ##D,6                                               CER055
     C                     MOVELDRIS      ##D,7                                               CER055
     C           ACCKEY    CHAINACCNTBY0             14                                       CER055
     C                     MOVELATAODR    ##D,8                                               CER055
     C                     MOVELATDOBE    ##D,9                                               CER055
     C                     MOVELATNDYE    ##D,10                                              CER055
      *                                                                                       CER055
      **  Accumulate RDE's and associated data and output to                                  CER055
      **  PF/CGUDTAPD.                                                                        CER055
      *                                                                                       CER055
     C                     EXSR SRADTA                                                        CER055
     C                     EXSR SRODTA                                                        CER055
      *                                                                                       CER055
      *................................................................                       CER055
      *                                                                                       CER055
     C           EXODAC    TAG                                                                CER055
      *                                                                                       CER055
      **  Unwind subroutine stack name                                                        CER055
      *                                                                                       CER055
     C                     EXSR POPGRS                                                        CER055
     C                     MOVEA*BLANKS   @STK,Q                                              CER055
     C                     SUB  1         Q                                                   CER055
      *                                                                                       CER055
     C                     ENDSR                                                              CER055
      *****************************************************************
     C/SPACE 5                                                            089776
      *****************************************************************   089776
      * Subroutine  :  ACOF                                           *   089776
      * Function    :  Account Officer Details                        *   089776
      *                                                               *   089776
      * Called by   :                                                 *   089776
      * Calls       :                                                 *   089776
      *****************************************************************   089776
     C           ACOF      BEGSR                                          089776
      *                                                                   089776
      **  Set up subroutine stack name                                    089776
     C                     ADD  1         Q                               089776
     C                     MOVEL'ACOF  '  @STK,Q                          089776
      *                                                                   089776
      *................................................................   089776
      *                                                                   089776
      **  Retrieve subroutine specific data.                              089776
     C           1         OCUR ##SRDT                                    089776
     C                     MOVEL##SPAT    S#PATH                          089776
      *                                                                   089776
      **  Set up data.                                                    089776
     C                     CLEARP7PARM                                    089776
     C                     MOVELBBACOC    P1ACOF                          089776
      *                                                                   089776
     C                     CLEARP4PARM                                    089776
     C                     MOVELS#PATH    P4PARM                          089776
      *                                                                   089776
     C                     CLEARP5PARM                                    089776
     C                     Z-ADD##OSEQ    R1OSEQ                          089776
     C                     Z-ADD##ITEM    R1ITEM                          089776
     C                     Z-ADDDETBIN    R1TBIN                          089776
     C                     Z-ADDDEPBIN    R1PBIN                          089776
      *                                                                   089776
     C                     CALL 'CG4976'                                  089776
     C                     PARM *BLANKS   W0RTN   7                       089776
     C                     PARM           P7PARM                          089776
     C                     PARM           P4PARM140        Path           089776
     C                     PARM           W0CMT   3                       089776
     C                     PARM           P5PARM                          089776
     C                     PARM           ##REFR                                              CCG015
     C                     PARM           P@ICR                                               CCG015
     C                     PARM 'N'       ##MAST                                              CCG015
      *                                                                   089776
      **  Reset Sequence number.                                          089776
     C                     Z-ADDR1OSEQ    ##OSEQ                          089776
     C                     Z-ADDR1TBIN    DETBIN                          089776
     C                     Z-ADDR1PBIN    DEPBIN                          089776
      *                                                                   089776
      *                                                                   089776
      *                                                                   089776
      *................................................................   089776
      *                                                                   089776
     C           EXACOF    TAG                                            089776
      *                                                                   089776
      **  Unwind subroutine stack name                                    089776
     C                     MOVEA*BLANKS   @STK,Q                          089776
     C                     SUB  1         Q                               089776
      *                                                                   089776
     C                     ENDSR                                          089776
     C*****************************************************************   089776
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
      *                                                                                       CCG015
      ** Set-up Action Code parameter W0ACT                                                   CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 15 *
     C                     Z-ADD15        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
      ** Write a XML record for RDE                                                           CCG015
      *                                                                                       CCG015
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD1         DEPBIN
     C                     Z-ADD1         DETBIN
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *
      **  Output PF/CGUDTAPD Record.
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 16 *
     C                     Z-ADD16        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF                                                              CCG015
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELBTIBCA    DRBRCA
     C                     MOVEL'RE'      DRMODI
     C                     MOVELBTBTNB    DRMTRN                          096420
     C                     MOVE BTBINB    DRMTRN                          096420
     C***********BTRACN    IFNE *ZEROS                                    096420
     C***********          MOVELBTRACN    DRMACT                          096420
     C***********          ELSE                                           096420
     C                     MOVE BTCUST    ##CUST
     C                     MOVE BTCYCD    ##CYCD
     C                     MOVE BTACCD    ##ACCD
     C                     MOVE BTACSN    ##ACSN
     C                     MOVE BTIBCA    ##BRCA                          096420
     C                     MOVEL##ACC     DRMACT
     C***********          ENDIF                                          096420
     C                     MOVEL'N'       DRATRM
     C                     MOVEL#TEXT1    DRPTYP
     C                     MOVEL#TEXT2    DRPSTP
      *
     C                     MOVELBTCUST    ##CUST
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *                                                                                       CCG015
      ** Pass reference as printtype:subtype                                                  CCG015
      *                                                                                       CCG015
     C           DRPTYP    CAT  ':':0     COLON  11 P                                         CCG015
     C           COLON     CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRTERM                                         *
      * Function    :  Program termination                            *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRTERM    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRTERM'  @STK,Q
      *
      *................................................................
      *
     C*
     C*     Access batch header and update it as 'not in use'
     C*
     C           BATCH     CHAINGLJENHL0             03
     C*
     C*     Data base error if batch not found
     C*
     C           *IN03     IFEQ '1'
     C                     MOVEL'GLJENHL0'W0FILE
     C                     MOVELBATCH     W0KEY            ***************
     C                     Z-ADD6         W0ERNB           * DB ERROR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C                     MOVE XXWSID    BRWSID
     C                     MOVE ' '       BRBIUF
     C                     MOVE 'Y'       BRSHPI
     C*
     C                     UPDAT@BRREAG                04
     C*
     C*     Data base error if update fails
     C*
     C           *IN04     IFEQ '1'
     C                     MOVEL'GLJENHL0'W0FILE
     C                     MOVELBATCH     W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C*
     C                     MOVE '1'       *INLR
      *
      *................................................................
      *
     C           EXTERM    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C                     MOVE 'YES'     W0CMT   3
     C                     MOVEL'N'       #RECS
      *
      **  Open the Audit Print File.
     C                     CLEARI#DTA
     C                     MOVEL'CG4900AU'I#SPLN
     C                     MOVEL'CG4900  'I#REF
     C                     MOVE 'CGD1762' I#TITL
     C                     MOVE 'CGD1763' I#TUL
     C                     MOVEL'CGUSRMSG'I#FILE
     C*
     C                     CALL 'CGZAUDIT'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM '*OPEN   'W0ACT   8
     C                     PARM           I#DTA
     C                     PARM           W0RSQN  5
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
      **         IN THE DATAAREA RUNDAT
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
      *                                                                                       CSC022
     C************NAMVAR   DEFN           WDSJOB                                       CSC022BUG2330
     C           *NAMVAR   DEFN SCCMTJOB  WDSJOB                                             BUG2330
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCMTSK  1                                           CSC022
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   @RTCD                                               CSC022
     C                     PARM '*VERIFY' @OPTN                                               CSC022
     C                     PARM 'CSC022'  WSARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           PRTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C                     MOVE 'N'       WCMTSK                                              CSC022
      *                                                                                       CSC022
     C                     IN   WDSJOB                                                        CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
     C                     Z-ADD1         I       20                                          CSC022
      *                                                                                       CSC022
     C           ##JOB     LOKUPWCMT,I                   50                                   CSC022
     C           *IN50     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ELSE                                                               CSC022
     C           PRTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD29        W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ENDIF                                                              CSC022
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*FIRST  '@OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBANKPD'W0FILE           ***************
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
      *
      ** DATABASE ERROR
      *
     C*
     C*     Access SDRETLPD
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
      *
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDRETLPD'W0FILE           ***************
     C                     Z-ADD10        W0ERNB           * DB ERROR 10 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C*     Access batch header
     C*
     C           BATCH     CHAINGLJENHL0             03
     C*
     C*     Data base error if batch not found
     C*
     C           *IN03     IFEQ '1'
     C                     MOVEL'GLJENHL0'W0FILE
     C                     MOVELBATCH     W0KEY            ***************
     C                     Z-ADD11        W0ERNB           * DB ERROR 11 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C*     Abort program if batch is in use
     C*
     C           BRBIUF    IFEQ 'Y'
     C                     SETON                     U5LR
     C                     RETRN
     C                     END
     C*
     C*     Abort program if batch posting is outstanding
     C*
     C           BRSHPI    IFNE 'Y'
     C                     SETON                     U6LR
     C                     RETRN
     C                     END
     C*
     C*     Abort program if batch has been printed
     C*
     C           BRRAPI    IFEQ 'P'
     C                     MOVE '1'       *INLR
     C                     RETRN
     C                     END
     C*
     C*     Update batch header (to show that it is in use)
     C*
     C                     MOVE BRWSID    XXWSID 10
     C                     MOVE '**'      BRWSID
     C                     MOVE 'Y'       BRBIUF
     C                     UPDAT@BRREAG                04
     C*
     C*     Data base error if update fails
     C*
     C           *IN04     IFEQ '1'
     C                     MOVEL'GLJENHL0'W0FILE
     C                     MOVELBATCH     W0KEY            ***************
     C                     Z-ADD12        W0ERNB           * DB ERROR 12 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C*
     C*     Access department name
     C*
     C           BRDPCD    CHAINSDDEPTL0             05
     C*
     C*     Data base error if chain fails
     C*
     C           *IN05     IFEQ '1'
     C                     MOVEL'SDDEPTL0'W0FILE
     C                     MOVELBRDPCD    W0KEY            ***************
     C                     Z-ADD13        W0ERNB           * DB ERROR 13 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     SETON                     U7U8
     C                     EXSR SRERR
     C                     END
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C* Initialise Saved field of currency for comparison.                CEU013
     C                     MOVE *BLANKS   WKCYCD  3                       CEU013
     C                     MOVE *BLANKS   WKINCY  1        'In' Currency  CEU013
      *                                                                   CEU014
      ** Check if CEU014 (EMU - UDC changes) is on.                       CEU014
      *                                                                   CEU014
     C                     CALL 'AOSARDR0'                                CEU014
     C                     PARM *BLANKS   ##RTCD                          CEU014
     C                     PARM '*VERIFY '##OPTN                          CEU014
     C                     PARM 'CEU014'  @SARD   6                       CEU014
     C           SCSARD    PARM SCSARD    DSFDY                           CEU014
      *                                                                   CEU014
     C           ##RTCD    IFEQ *BLANKS                                   CEU014
     C                     MOVE 'Y'       CEU014  1                       CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** Database Error                                                   CEU014
      *                                                                   CEU014
     C           ##RTCD    IFNE *BLANKS                                   CEU014
     C           ##RTCD    ANDNE'*NRF   '                                 CEU014
      *                                                                   CEU014
     C                     MOVEL'SCSARDPD'W0FILE                          CEU014
     C                     MOVEL'CEU014'  W0KEY            ***************CEU014
     C                     Z-ADD24        W0ERNB           * DB ERROR 24 *CEU014
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
      ** Call Access Program for General Ledger ICD details               CEU014
      *                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
      *                                                                   CEU014
     C**********           CALL 'AOGELRR0'                                CEU014              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD  7                       CEU014
     C                     PARM '*FIRST  '##OPTN  7                       CEU014
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU014              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
      *                                                                   CEU014
      ** Database Error                                                   CEU014
      *                                                                   CEU014
     C                     MOVEL'SDGELRPD'W0FILE                          CEU014
     C                     MOVEL'*CALL'   W0KEY            ***************CEU014
     C                     Z-ADD25        W0ERNB           * DB ERROR 25 *CEU014
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CFT004
      ** Access SAR details file to determine if CFT004 is installed.     CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM '*VERIFY' POPTN   7                       CFT004
     C                     PARM 'CFT004'  PSARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
      *                                                                   CFT004
      ** Database Error                                                   CFT004
      *                                                                   CFT004
     C           PRTCD     IFNE *BLANK                                    CFT004
     C           PRTCD     ANDNE'*NRF   '                                 CFT004
     C                     MOVEL'SCSARDPD'W0FILE           ************   CFT004
     C                     MOVEL'*CALL'   W0KEY            * DBERR 27 *   CFT004
     C                     Z-ADD27        W0ERNB           ************   CFT004
     C                     MOVEL'MEM5003' W0MSGD                          CFT004
     C                     MOVEL'MIDAS  ' W0MSGF                          CFT004
     C                     EXSR SRERR                                     CFT004
     C                     END                                            CFT004
      *                                                                   CFT004
     C                     MOVEL'N'       CFT004                          CFT004
     C           PRTCD     IFEQ *BLANK                                    CFT004
     C                     MOVEL'Y'       CFT004  1                       CFT004
     C                     ENDIF                                          CFT004
     C*                                                                   CEU013
      ** Access Switchable Features file and check if CCG015 is                               CCG015
      ** installed                                                                            CCG015
      *                                                                                       CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD                                               CCG015
     C                     PARM '*VERIFY' POPTN                                               CCG015
     C                     PARM 'CCG015'  PSARD                                               CCG015
      *                                                                                       CCG015
     C           PRTCD     IFEQ *BLANK                                                        CCG015
     C                     MOVE 'Y'       CCG015  1                                           CCG015
     C                     ELSE                                                               CCG015
     C                     MOVE 'N'       CCG015                                              CCG015
     C           PRTCD     IFNE '*NRF   '                                                     CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL'   W0KEY                                               CCG015
     C                     Z-ADD28        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CER031
      ** Access Switchable Features file and check if CER031 is                               CER031
      ** installed                                                                            CER031
      *                                                                                       CER031
     C                     CALL 'AOSARDR0'                                                    CER031
     C                     PARM *BLANKS   PRTCD                                               CER031
     C                     PARM '*VERIFY' POPTN                                               CER031
     C                     PARM 'CER031'  PSARD                                               CER031
      *                                                                                       CER031
     C           PRTCD     IFEQ ' '                                                           CER031
     C                     MOVE 'Y'       CER031  1                                           CER031
     C                     ELSE                                                               CER031
     C                     MOVE 'N'       CER031                                              CER031
     C                     ENDIF                                                              CER031
      *                                                                                     BUG23445
      ** Access Switchable Features file and check if CCG015 is                             BUG23445
      ** installed                                                                          BUG23445
      *                                                                                     BUG23445
     C                     CALL 'AOSARDR0'                                                  BUG23445
     C                     PARM *BLANKS   PRTCD                                             BUG23445
     C                     PARM '*VERIFY' POPTN                                             BUG23445
     C                     PARM 'CGL013'  PSARD                                             BUG23445
      *                                                                                     BUG23445
     C           PRTCD     IFEQ *BLANK                                                      BUG23445
     C                     MOVE 'Y'       CGL013  1                                         BUG23445
     C                     ELSE                                                             BUG23445
     C                     MOVE 'N'       CGL013                                            BUG23445
     C           PRTCD     IFNE '*NRF   '                                                   BUG23445
     C                     MOVEL'SCSARDPD'W0FILE                                            BUG23445
     C                     MOVEL'*CALL'   W0KEY                                             BUG23445
     C                     Z-ADD32        W0ERNB                                            BUG23445
     C                     MOVEL'MEM5003' W0MSGD                                            BUG23445
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23445
     C                     EXSR SRERR                                                       BUG23445
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                     BUG23742
      ** Access Switchable Features file and check if CER030 is                             BUG23742
      ** installed                                                                          BUG23742
      *                                                                                     BUG23742
     C                     CALL 'AOSARDR0'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD                                             BUG23742
     C                     PARM '*VERIFY' POPTN                                             BUG23742
     C                     PARM 'CER030'  PSARD                                             BUG23742
      *                                                                                     BUG23742
     C           PRTCD     IFEQ *BLANK                                                      BUG23742
     C                     MOVE 'Y'       CER030  1                                         BUG23742
     C                     ELSE                                                             BUG23742
     C                     MOVE 'N'       CER030                                            BUG23742
     C           PRTCD     IFNE '*NRF   '                                                   BUG23742
     C                     MOVEL'SCSARDPD'W0FILE                                            BUG23742
     C                     MOVEL'*CALL'   W0KEY                                             BUG23742
     C                     Z-ADD35        W0ERNB                                            BUG23742
     C                     MOVEL'MEM5003' W0MSGD                                            BUG23742
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23742
     C                     EXSR SRERR                                                       BUG23742
     C                     ENDIF                                                            BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                       CER055
      ** Check if CER055 is installed.                                                        CER055
      *                                                                                       CER055
     C                     CALL 'AOSARDR0'                                                    CER055
     C                     PARM *BLANKS   PRTCD                                               CER055
     C                     PARM '*VERIFY' POPTN                                               CER055
     C                     PARM 'CER055'  PSARD                                               CER055
     C           SCSARD    PARM SCSARD    DSFDY                                               CER055
      *                                                                                       CER055
     C           PRTCD     IFNE *BLANK                                                        CER055
     C           PRTCD     ANDNE'*NRF   '                                                     CER055
     C                     MOVEL'SCSARDPD'W0FILE                                              CER055
     C                     MOVEL'*CALL'   W0KEY                                               CER055
     C                     Z-ADD36        W0ERNB                                              CER055
     C                     MOVEL'MEM5003' W0MSGD                                              CER055
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER055
     C                     EXSR SRERR                                                         CER055
     C                     ENDIF                                                              CER055
      *                                                                                       CER055
     C                     MOVE 'N'       CER055                                              CER055
      *                                                                                       CER055
     C           PRTCD     IFEQ *BLANKS                                                       CER055
     C                     MOVE 'Y'       CER055  1                                           CER055
     C                     ENDIF                                                              CER055
      *                                                                                       CER031
      ** Keylist for file GLJENXL2                                                            CER031
      *                                                                                       CER031
     C           KLJENP    KLIST                                                              CER031
     C                     KFLD           BTBTNB                                              CER031
     C                     KFLD           BTBINB                                              CER031
      *                                                                                     BUG23445
      ***Keylist*for*file**GLNW94L1                                               BUG23445 BUG23445A
      ** Keylist for file  GLNWACL1                                                        BUG23445A
      *                                                                                     BUG23445
     C           KACCT     KLIST                                                            BUG23445
     C                     KFLD           KNWRK                                             BUG23445
     C                     KFLD           PBRCA                                             BUG23445
     C                     KFLD           PCUSNO                                            BUG23445
     C                     KFLD           PCCY                                              BUG23445
     C                     KFLD           KACCD                                             BUG23445
     C                     KFLD           KACSQ                                             BUG23445
      *                                                                                     BUG23742
      ** Keylist for file GLMNARL1                                                          BUG23742
      *                                                                                     BUG23742
     C           KLNAR     KLIST                                                            BUG23742
     C                     KFLD           BTPTDT                                            BUG23742
     C                     KFLD           BTBTNB                                            BUG23742
     C                     KFLD           BTBINB                                            BUG23742
      *                                                                                       CCG015
     C/COPY WNCPYSRC,CG4900C002
      *
      ** Initialise XML increment                                                             CCG015
      *                                                                                       CCG015
     C                     EXSR INIXML                                                        CCG015
      *                                                                                       CCG015
      *................................................................
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************   CEU014
     C/SPACE 5                                                            CEU014
      *****************************************************************   CEU014
      * Subroutine  :  R@EURO                                         *   CEU014
      * Function    :  EURO Currency Conversion:                      *   CEU014
      *                Converts P@FRAM in P@FRCY to ##OUTA in P@TOCY. *   CEU014
      * Called by   :  R08DTL                                         *   CEU014
      *                                                               *   CEU014
      * Calls       :  EU0200                                         *   CEU014
      *                SRERR                                          *   CEU014
      *****************************************************************   CEU014
     C           R@EURO    BEGSR                                          CEU014
      *                                                                   CEU014
     C                     Z-ADD0         ##OUTA 130                      CEU014
     C                     CALL 'EU0200'                                  CEU014
     C                     PARM *BLANKS   P@RTCD  7        Return Code    CEU014
     C                     PARM           P@FRAM 183       FROM Ccy AmountCEU014
     C                     PARM           P@FRCY  3        FROM Currency  CEU014
     C                     PARM           P@TOCY  3        TO Currency    CEU014
     C                     PARM           P@OUTA 150       Outright AmountCEU014
     C                     PARM           P@INTA 183       Interim Amount CEU014
     C                     PARM           P@EXRT 159       Exchange Rate  CEU014
     C                     PARM           P@MDIN  1        Mult/Div Ind.  CEU014
      *                                                                   CEU014
      ** Database error handling:                                         CEU014
      *                                                                   CEU014
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU014
     C                     MOVEL'EU0200  'W0FILE                          CEU014
     C                     MOVEL'*CALL   'W0KEY            ***************CEU014
     C                     Z-ADD26        W0ERNB           * DB ERROR 26 *CEU014
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
      *                                                                   CEU014
      ** Otherwise, store amount in settlement currency as ##OUTA         CEU014
      *                                                                   CEU014
     C                     ELSE                                           CEU014
     C                     MOVE P@OUTA    ##OUTA                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
     C                     ENDSR                                          CEU014
      *****************************************************************                       CER031
     C/SPACE 5                                                                                CER031
      *****************************************************************                       CER031
      * Subroutine  :  SREXNR                                         *                       CER031
      * Function    :  Retrieve Extended Narratives based on          *                       CER031
      *                Transaction Type                               *                       CER031
      *                                                               *                       CER031
      * Called by   :  R08RAD - Input Cycle - Retail Advice Print     *                       CER031
      * Calls       :  DEXNAR                                         *                       CER031
      *                CEXNAR                                         *                       CER031
      *****************************************************************                       CER031
     C           SREXNR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'SREXNR'  @STK,Q                                              CER031
      *                                                                                       CER031
     C                     MOVEL*BLANKS   WMT22   1                                         BUG23742
     C                     MOVEL*BLANKS   WMT06   1                                         BUG23742
      *                                                                                     BUG23742
     C           KLJENP    CHAINGLJENXL2             08                                       CER031
      *                                                                                       CER031
     C           *IN08     IFEQ '0'                                                           CER031
     C           CER031    ANDEQ'Y'                                                         BUG23742
      *                                                                                       CER031
     C                     MOVELBAADI1    PNARR1 65                                           CER031
     C                     MOVELBAADI2    PNARR2 65                                           CER031
     C                     MOVELBAADI3    PNARR3 65                                           CER031
     C                     MOVELBAADI4    PNARR4 65                                           CER031
     C                     MOVELBAADI5    PNARR5 65                                           CER031
     C                     MOVELBAADI6    PNARR6 65                                           CER031
      *                                                                                     BUG23742
     C                     MOVEL'Y'       WMT06                                             BUG23742
     C                     ELSE                                                             BUG23742
      *                                                                                     BUG23742
     C           KLNAR     CHAINGLMNARL1             97                                     BUG23742
     C           *IN97     IFEQ '0'                                                         BUG23742
     C           CER030    ANDEQ'Y'                                                         BUG23742
     C                     EXSR SREVNA                                                      BUG23742
     C                     MOVEL'Y'       WMT22                                             BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                       CER031
      ** Check Transaction Type - Debit / Credit                                              CER031
      *                                                                                       CER031
     C           WMT22     IFEQ 'Y'                                                         BUG23742
     C           WMT06     OREQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
     C           BTDCIN    IFEQ 'D'                                                           CER031
     C                     EXSR DEXNAR                                                        CER031
     C                     ELSE                                                               CER031
     C                     EXSR CEXNAR                                                        CER031
     C                     ENDIF                                                              CER031
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                              CER031 BUG23742
     C**********           ELSE                                                      CER031 BUG23742
     C**********           MOVEL'GLJENXPD'W0FILE                                     CER031 BUG23742
     C**********           MOVELBTBINB    KFBINB  3                                  CER031 BUG23742
     C**********  TBTNB    CAT  KFBINB    W0KEY                                      CER031 BUG23742
     C**********           Z-ADD30        W0ERNB                                     CER031 BUG23742
     C**********           MOVEL'MEM5004' W0MSGD                                     CER031 BUG23742
     C**********           MOVEL'MIDAS  ' W0MSGF                                     CER031 BUG23742
     C**********           EXSR SRERR                                                CER031 BUG23742
     C**********           ENDIF                                                     CER031 BUG23742
      *                                                                                       CER031
      ** Unwind subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     MOVEA*BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
      *****************************************************************                       CER031
     C/SPACE 5                                                                                CER031
      *****************************************************************                       CER031
      * Subroutine  :  DEXNAR                                         *                       CER031
      * Function    :  Extract Extended Debit Narrative               *                       CER031
      *                                                               *                       CER031
      * Called by   :  SREXNR - Retrieve Extended Narratives based    *                       CER031
      *                         on Transaction Type                   *                       CER031
      * Calls       :                                                 *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
     C           DEXNAR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'DEXNAR'  @STK,Q                                              CER031
      *                                                                                       CER031
      ** Retrieve subroutine specific data                                                    CER031
      *                                                                                       CER031
     C           1         OCUR ##SRDT                                                        CER031
     C                     MOVEL##SPAT    S#PATH                                              CER031
      *                                                                                       CER031
      ** Set up Path                                                                          CER031
      *                                                                                       CER031
     C                     MOVEL'\DEXNAR' ##PNAM                                              CER031
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
     C                     EXSR PSHGRS                                                        CER031
      *                                                                                       CER031
      ** Retrieve RDE information for RDEs in group set                                       CER031
      *                                                                                       CER031
     C                     MOVEL@STK,Q    ##GRPS                                              CER031
     C                     Z-ADD1         ##RDEN                                              CER031
     C                     EXSR SRRRDE                                                        CER031
      *                                                                                       CER031
      ** Format Narrative fields                                                              CER031
      *                                                                                       CER031
     C                     MOVE BTIBCA    PBRCA   3                                           CER031
     C**********           MOVE BTCUST    PCUSNO  60                                   CER031 CER059
     C                     MOVE BTCUST    PCUSNO  6                                           CER059
     C                     MOVE BTCYCD    PCCY    3                                           CER031
     C                     MOVE BTACCD    PACCD  10                                           CER031
     C                     MOVE BTACSN    PACSQ   2                                           CER031
     C                     MOVE '*FORMAT' POPTN   7                                           CER031
      *                                                                                     BUG23445
      ** Format according to network Paper if Account is linked                             BUG23445
      *                                                                                     BUG23445
     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
     C           CGL013    IFEQ 'Y'                                                         BUG23445
     C                     MOVEL'PAPER'   KNWRK   6                                         BUG23445
     C                     MOVE PACCD     KACCD  100                                        BUG23445
     C                     MOVE PACSQ     KACSQ   20                                        BUG23445
     C********** KACCT     CHAINGLNW94L1             98                           BUG23445 BUG23445A
     C           KACCT     CHAINGLNWACL1             98                                    BUG23445A
     C           *IN98     IFEQ *OFF                                                        BUG23445
     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
     C                     MOVELNANWRK    PNTWK                                            BUG23445A
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                     BUG23742
      ** Set Flag for Accumulate RDE's and data when RDE's > than 21                        BUG23742
      *                                                                                     BUG23742
     C                     MOVEL*BLANKS   WACUM   1                                         BUG23742
      *                                                                                     BUG23742
     C           WMT22     IFEQ 'Y'                                                         BUG23742
     C                     MOVEL'Y'       WACUM                                             BUG23742
      *                                                                                     BUG23742
      ** Call the MG001901 access object to format the extended                             BUG23742
      ** narratives                                                                         BUG23742
      *                                                                                     BUG23742
     C                     CALL 'MG001901'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD2                                            BUG23742
     C                     PARM           POPTN                                             BUG23742
     C                     PARM           PNTWK                                             BUG23742
     C                     PARM           PMGTYP                                            BUG23742
     C                     PARM           PBRCA                                             BUG23742
     C                     PARM           PCUSNO                                            BUG23742
     C                     PARM           PCCY                                              BUG23742
     C                     PARM           PACCD                                             BUG23742
     C                     PARM           PACSQ                                             BUG23742
     C                     PARM           PDCIN                                             BUG23742
     C                     PARM           PTRTP                                             BUG23742
      *                                                                                     BUG23742
      ** Extended Narratives of length 22 * 35                                              BUG23742
      *                                                                                     BUG23742
     C                     PARM           EXT                                               BUG23742
      *                                                                                     BUG23742
     C                     PARM *BLANKS   PRTF1                                             BUG23742
     C                     PARM *BLANKS   PRTF2                                             BUG23742
     C                     PARM *BLANKS   PRTF3                                             BUG23742
     C                     PARM *BLANKS   PRTF4                                             BUG23742
     C                     PARM *BLANKS   PRTF5                                             BUG23742
     C                     PARM *BLANKS   PRTF6                                             BUG23742
     C                     PARM *BLANKS   PRTF7                                             BUG23742
     C                     PARM *BLANKS   PRTF8                                             BUG23742
     C                     PARM *BLANKS   PRTF9                                             BUG23742
     C                     PARM *BLANKS   PRTF10                                            BUG23742
     C                     PARM *BLANKS   PRTF11                                            BUG23742
     C                     PARM *BLANKS   PRTF12                                            BUG23742
     C                     PARM *BLANKS   PRTF13                                            BUG23742
     C                     PARM *BLANKS   PRTF14                                            BUG23742
     C                     PARM *BLANKS   PRTF15                                            BUG23742
     C                     PARM *BLANKS   PRTF16                                            BUG23742
     C                     PARM *BLANKS   PRTF17                                            BUG23742
     C                     PARM *BLANKS   PRTF18                                            BUG23742
     C                     PARM *BLANKS   PRTF19                                            BUG23742
     C                     PARM *BLANKS   PRTF20                                            BUG23742
     C                     PARM *BLANKS   PRTF21 70                                         BUG23742
     C                     PARM *BLANKS   PRTF22 70                                         BUG23742
     C                     PARM           IDX                                               BUG23742
     C                     PARM           FLDNAM                                            BUG23742
     C                     PARM           MSGID                                             BUG23742
     C                     PARM           MSGDTA                                            BUG23742
     C                     PARM           WFLDNM                                            BUG23742
     C                     PARM           WMGID                                             BUG23742
     C                     PARM           WMGDTA                                            BUG23742
      *                                                                                     BUG23742
     C           PRTCD2    IFEQ *BLANKS                                                     BUG23742
     C           PRTCD2    OREQ '*FORMAT'                                                   BUG23742
      *                                                                                     BUG23742
     C                     MOVELPRTF1     ##D,1                                             BUG23742
     C                     MOVELPRTF2     ##D,2                                             BUG23742
     C                     MOVELPRTF3     ##D,3                                             BUG23742
     C                     MOVELPRTF4     ##D,4                                             BUG23742
     C                     MOVELPRTF5     ##D,5                                             BUG23742
     C                     MOVELPRTF6     ##D,6                                             BUG23742
     C                     MOVELPRTF7     ##D,7                                             BUG23742
     C                     MOVELPRTF8     ##D,8                                             BUG23742
     C                     MOVELPRTF9     ##D,9                                             BUG23742
     C                     MOVELPRTF10    ##D,10                                            BUG23742
     C                     MOVELPRTF11    ##D,11                                            BUG23742
     C                     MOVELPRTF12    ##D,12                                            BUG23742
     C                     MOVELPRTF13    ##D,13                                            BUG23742
     C                     MOVELPRTF14    ##D,14                                            BUG23742
     C                     MOVELPRTF15    ##D,15                                            BUG23742
     C                     MOVELPRTF16    ##D,16                                            BUG23742
     C                     MOVELPRTF17    ##D,17                                            BUG23742
     C                     MOVELPRTF18    ##D,18                                            BUG23742
     C                     MOVELPRTF19    ##D,19                                            BUG23742
     C                     MOVELPRTF20    ##D,20                                            BUG23742
      *                                                                                     BUG23742
     C                     ELSE                                                             BUG23742
      *                                                                                     BUG23742
     C                     MOVEL'MG001901'W0FILE                                            BUG23742
     C                     MOVELEXT,1     W0KEY                                             BUG23742
     C                     Z-ADD33        W0ERNB                                            BUG23742
     C                     MOVEL'MEM5003' W0MSGD                                            BUG23742
     C                     MOVEL'MIDAS'   W0MSGF                                            BUG23742
     C                     EXSR SRERR                                                       BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ELSE                                                             BUG23742
      *                                                                                       CER031
      ** Call the MG001900 access object to format the extended                               CER031
      ** narratives                                                                           CER031
      *                                                                                       CER031
     C                     CALL 'MG001900'                                                    CER031
     C                     PARM           PRTCD2 10                                           CER031
     C                     PARM           POPTN                                               CER031
     C                     PARM           PNTWK   6                                           CER031
     C                     PARM           PMGTYP  3                                           CER031
     C                     PARM           PBRCA                                               CER031
     C                     PARM           PCUSNO                                              CER031
     C                     PARM           PCCY                                                CER031
     C                     PARM           PACCD                                               CER031
     C                     PARM           PACSQ                                               CER031
     C                     PARM           PDCIN   1                                           CER031
     C                     PARM           PTRTP   5                                           CER031
     C                     PARM           PNARR1                                              CER031
     C                     PARM           PNARR2                                              CER031
     C                     PARM           PNARR3                                              CER031
     C                     PARM           PNARR4                                              CER031
     C                     PARM           PNARR5                                              CER031
     C                     PARM           PNARR6                                              CER031
     C**********           PARM           PRTF1  70                                  CER031 BUG23197
     C**********           PARM           PRTF2  70                                  CER031 BUG23197
     C**********           PARM           PRTF3  70                                  CER031 BUG23197
     C**********           PARM           PRTF4  70                                  CER031 BUG23197
     C**********           PARM           PRTF5  70                                  CER031 BUG23197
     C**********           PARM           PRTF6  70                                  CER031 BUG23197
     C**********           PARM           PRTF7  70                                  CER031 BUG23197
     C**********           PARM           PRTF8  70                                  CER031 BUG23197
     C**********           PARM           PRTF9  70                                  CER031 BUG23197
     C**********           PARM           PRTF10 70                                  CER031 BUG23197
     C**********           PARM           PRTF11 70                                  CER031 BUG23197
     C**********           PARM           PRTF12 70                                  CER031 BUG23197
     C**********           PARM           PRTF13 70                                  CER031 BUG23197
     C**********           PARM           PRTF14 70                                  CER031 BUG23197
     C**********           PARM           PRTF15 70                                  CER031 BUG23197
     C**********           PARM           PRTF16 70                                  CER031 BUG23197
     C**********           PARM           PRTF17 70                                  CER031 BUG23197
     C**********           PARM           PRTF18 70                                  CER031 BUG23197
     C**********           PARM           PRTF19 70                                  CER031 BUG23197
     C**********           PARM           PRTF20 70                                  CER031 BUG23197
     C                     PARM *BLANKS   PRTF1  70                                         BUG23197
     C                     PARM *BLANKS   PRTF2  70                                         BUG23197
     C                     PARM *BLANKS   PRTF3  70                                         BUG23197
     C                     PARM *BLANKS   PRTF4  70                                         BUG23197
     C                     PARM *BLANKS   PRTF5  70                                         BUG23197
     C                     PARM *BLANKS   PRTF6  70                                         BUG23197
     C                     PARM *BLANKS   PRTF7  70                                         BUG23197
     C                     PARM *BLANKS   PRTF8  70                                         BUG23197
     C                     PARM *BLANKS   PRTF9  70                                         BUG23197
     C                     PARM *BLANKS   PRTF10 70                                         BUG23197
     C                     PARM *BLANKS   PRTF11 70                                         BUG23197
     C                     PARM *BLANKS   PRTF12 70                                         BUG23197
     C                     PARM *BLANKS   PRTF13 70                                         BUG23197
     C                     PARM *BLANKS   PRTF14 70                                         BUG23197
     C                     PARM *BLANKS   PRTF15 70                                         BUG23197
     C                     PARM *BLANKS   PRTF16 70                                         BUG23197
     C                     PARM *BLANKS   PRTF17 70                                         BUG23197
     C                     PARM *BLANKS   PRTF18 70                                         BUG23197
     C                     PARM *BLANKS   PRTF19 70                                         BUG23197
     C                     PARM *BLANKS   PRTF20 70                                         BUG23197
     C                     PARM           IDX     30                                          CER031
     C                     PARM           FLDNAM                                              CER031
     C                     PARM           MSGID                                               CER031
     C                     PARM           MSGDTA                                              CER031
     C                     PARM           WFLDNM                                              CER031
     C                     PARM           WMGID                                               CER031
     C                     PARM           WMGDTA                                              CER031
      *                                                                                       CER031
     C           PRTCD2    IFEQ ' '                                                           CER031
     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
      *                                                                                       CER031
     C                     MOVELPRTF1     ##D,1                                               CER031
     C                     MOVELPRTF2     ##D,2                                               CER031
     C                     MOVELPRTF3     ##D,3                                               CER031
     C                     MOVELPRTF4     ##D,4                                               CER031
     C                     MOVELPRTF5     ##D,5                                               CER031
     C                     MOVELPRTF6     ##D,6                                               CER031
     C                     MOVELPRTF7     ##D,7                                               CER031
     C                     MOVELPRTF8     ##D,8                                               CER031
     C                     MOVELPRTF9     ##D,9                                               CER031
     C                     MOVELPRTF10    ##D,10                                              CER031
     C                     MOVELPRTF11    ##D,11                                              CER031
     C                     MOVELPRTF12    ##D,12                                              CER031
     C                     MOVELPRTF13    ##D,13                                              CER031
     C                     MOVELPRTF14    ##D,14                                              CER031
     C                     MOVELPRTF15    ##D,15                                              CER031
     C                     MOVELPRTF16    ##D,16                                              CER031
     C                     MOVELPRTF17    ##D,17                                              CER031
     C                     MOVELPRTF18    ##D,18                                              CER031
     C                     MOVELPRTF19    ##D,19                                              CER031
     C                     MOVELPRTF20    ##D,20                                              CER031
      *                                                                                       CER031
     C                     ELSE                                                               CER031
     C                     MOVEL'MG001900'W0FILE                                              CER031
     C                     MOVELPNARR1    W0KEY                                               CER031
     C                     Z-ADD31        W0ERNB                                              CER031
     C                     MOVEL'MEM5003' W0MSGD                                              CER031
     C                     MOVEL'MIDAS'   W0MSGF                                              CER031
     C                     EXSR SRERR                                                         CER031
     C                     ENDIF                                                              CER031
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                       CER031
      ** Accumulate RDE's and associated data and output to                                   CER031
      ** PF/CGUDTAPD.                                                                         CER031
      *                                                                                       CER031
     C                     EXSR SRADTA                                                        CER031
      *                                                                                     BUG23742
     C           WACUM     IFEQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
      ** Retrieve RDE information for RDEs in group set                                     BUG23742
      *                                                                                     BUG23742
     C                     MOVEL@STK,Q    ##GRPS                                            BUG23742
     C                     Z-ADD21        ##RDEN                                            BUG23742
     C                     EXSR SRRRDE                                                      BUG23742
      *                                                                                     BUG23742
     C                     MOVELPRTF21    ##D,1                                             BUG23742
     C                     MOVELPRTF22    ##D,2                                             BUG23742
      *                                                                                     BUG23742
     C                     EXSR SRADTA                                                      BUG23742
      *                                                                                     BUG23742
     C                     MOVEL*BLANKS   EXT                                               BUG23742
     C                     MOVEL*BLANKS   WACUM                                             BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
     C                     EXSR SRODTA                                                        CER031
      *                                                                                       CER031
      *................................................................                       CER031
      *                                                                                       CER031
     C           EXDBNR    TAG                                                                CER031
      *                                                                                       CER031
      ** Unwind subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     EXSR POPGRS                                                        CER031
     C                     MOVEA*BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
      *****************************************************************                       CER031
     C/SPACE 5                                                                                CER031
      *****************************************************************                       CER031
      * Subroutine  :  CEXNAR                                         *                       CER031
      * Function    :  Extract Extended Credit Narrative              *                       CER031
      *                                                               *                       CER031
      * Called by   :  SREXNR - Retrieve Extended Narratives based    *                       CER031
      *                         on Transaction Type                   *                       CER031
      * Calls       :                                                 *                       CER031
      *                                                               *                       CER031
      *****************************************************************                       CER031
     C           CEXNAR    BEGSR                                                              CER031
      *                                                                                       CER031
      ** Set up subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     ADD  1         Q                                                   CER031
     C                     MOVEL'CEXNAR'  @STK,Q                                              CER031
      *                                                                                       CER031
      ** Retrieve subroutine specific data                                                    CER031
      *                                                                                       CER031
     C           1         OCUR ##SRDT                                                        CER031
     C                     MOVEL##SPAT    S#PATH                                              CER031
      *                                                                                       CER031
      ** Set up Path                                                                          CER031
      *                                                                                       CER031
     C                     MOVEL'\CEXNAR' ##PNAM                                              CER031
     C           S#PATH    CAT  ##PNAM:0  S#PATH                                              CER031
     C                     EXSR PSHGRS                                                        CER031
      *                                                                                       CER031
      ** Retrieve RDE information                                                             CER031
      *                                                                                       CER031
     C                     MOVEL@STK,Q    ##GRPS                                              CER031
     C                     Z-ADD1         ##RDEN                                              CER031
     C                     EXSR SRRRDE                                                        CER031
      *                                                                                       CER031
      ** Format Narrative fields                                                              CER031
      *                                                                                       CER031
     C                     MOVE BTIBCA    PBRCA   3                                           CER031
     C**********           MOVE BTCUST    PCUSNO  60                                   CER031 CER059
     C                     MOVE BTCUST    PCUSNO  6                                           CER059
     C                     MOVE BTCYCD    PCCY    3                                           CER031
     C                     MOVE BTACCD    PACCD  10                                           CER031
     C                     MOVE BTACSN    PACSQ   2                                           CER031
     C                     MOVE '*FORMAT' POPTN   7                                           CER031
      *                                                                                     BUG23445
      ** Format according to network Paper if Account is linked                             BUG23445
      *                                                                                     BUG23445
     C                     MOVEL*BLANKS   PNTWK                                             BUG23445
     C           CGL013    IFEQ 'Y'                                                         BUG23445
     C                     MOVEL'PAPER'   KNWRK                                             BUG23445
     C                     MOVE PACCD     KACCD                                             BUG23445
     C                     MOVE PACSQ     KACSQ                                             BUG23445
     C********** KACCT     CHAINGLNW94L1             98                           BUG23445 BUG23445A
     C           KACCT     CHAINGLNWACL1             98                                    BUG23445A
     C           *IN98     IFEQ *OFF                                                        BUG23445
     C**********           MOVELN4NWRK    PNTWK                                   BUG23445 BUG23445A
     C                     MOVELNANWRK    PNTWK                                            BUG23445A
     C                     ENDIF                                                            BUG23445
     C                     ENDIF                                                            BUG23445
      *                                                                                     BUG23742
      ** Set Flag for Accumulate RDE's and data when RDE's > than 21                        BUG23742
      *                                                                                     BUG23742
     C                     MOVEL*BLANKS   WACUM                                             BUG23742
      *                                                                                     BUG23742
     C           WMT22     IFEQ 'Y'                                                         BUG23742
     C                     MOVEL'Y'       WACUM                                             BUG23742
      *                                                                                     BUG23742
      ** Call the MG001901 access object to format the extended                             BUG23742
      ** narratives                                                                         BUG23742
      *                                                                                     BUG23742
     C                     CALL 'MG001901'                                                  BUG23742
     C                     PARM *BLANKS   PRTCD2                                            BUG23742
     C                     PARM           POPTN                                             BUG23742
     C                     PARM           PNTWK                                             BUG23742
     C                     PARM           PMGTYP                                            BUG23742
     C                     PARM           PBRCA                                             BUG23742
     C                     PARM           PCUSNO                                            BUG23742
     C                     PARM           PCCY                                              BUG23742
     C                     PARM           PACCD                                             BUG23742
     C                     PARM           PACSQ                                             BUG23742
     C                     PARM           PDCIN                                             BUG23742
     C                     PARM           PTRTP                                             BUG23742
      *                                                                                     BUG23742
      ** Extended Narratives of length 22 * 35                                              BUG23742
      *                                                                                     BUG23742
     C                     PARM           EXT                                               BUG23742
      *                                                                                     BUG23742
     C                     PARM *BLANKS   PRTF1                                             BUG23742
     C                     PARM *BLANKS   PRTF2                                             BUG23742
     C                     PARM *BLANKS   PRTF3                                             BUG23742
     C                     PARM *BLANKS   PRTF4                                             BUG23742
     C                     PARM *BLANKS   PRTF5                                             BUG23742
     C                     PARM *BLANKS   PRTF6                                             BUG23742
     C                     PARM *BLANKS   PRTF7                                             BUG23742
     C                     PARM *BLANKS   PRTF8                                             BUG23742
     C                     PARM *BLANKS   PRTF9                                             BUG23742
     C                     PARM *BLANKS   PRTF10                                            BUG23742
     C                     PARM *BLANKS   PRTF11                                            BUG23742
     C                     PARM *BLANKS   PRTF12                                            BUG23742
     C                     PARM *BLANKS   PRTF13                                            BUG23742
     C                     PARM *BLANKS   PRTF14                                            BUG23742
     C                     PARM *BLANKS   PRTF15                                            BUG23742
     C                     PARM *BLANKS   PRTF16                                            BUG23742
     C                     PARM *BLANKS   PRTF17                                            BUG23742
     C                     PARM *BLANKS   PRTF18                                            BUG23742
     C                     PARM *BLANKS   PRTF19                                            BUG23742
     C                     PARM *BLANKS   PRTF20                                            BUG23742
     C                     PARM *BLANKS   PRTF21                                            BUG23742
     C                     PARM *BLANKS   PRTF22                                            BUG23742
     C                     PARM           IDX                                               BUG23742
     C                     PARM           FLDNAM                                            BUG23742
     C                     PARM           MSGID                                             BUG23742
     C                     PARM           MSGDTA                                            BUG23742
     C                     PARM           WFLDNM                                            BUG23742
     C                     PARM           WMGID                                             BUG23742
     C                     PARM           WMGDTA                                            BUG23742
      *                                                                                     BUG23742
     C           PRTCD2    IFEQ *BLANKS                                                     BUG23742
     C           PRTCD2    OREQ '*FORMAT'                                                   BUG23742
      *                                                                                     BUG23742
     C                     MOVELPRTF1     ##D,1                                             BUG23742
     C                     MOVELPRTF2     ##D,2                                             BUG23742
     C                     MOVELPRTF3     ##D,3                                             BUG23742
     C                     MOVELPRTF4     ##D,4                                             BUG23742
     C                     MOVELPRTF5     ##D,5                                             BUG23742
     C                     MOVELPRTF6     ##D,6                                             BUG23742
     C                     MOVELPRTF7     ##D,7                                             BUG23742
     C                     MOVELPRTF8     ##D,8                                             BUG23742
     C                     MOVELPRTF9     ##D,9                                             BUG23742
     C                     MOVELPRTF10    ##D,10                                            BUG23742
     C                     MOVELPRTF11    ##D,11                                            BUG23742
     C                     MOVELPRTF12    ##D,12                                            BUG23742
     C                     MOVELPRTF13    ##D,13                                            BUG23742
     C                     MOVELPRTF14    ##D,14                                            BUG23742
     C                     MOVELPRTF15    ##D,15                                            BUG23742
     C                     MOVELPRTF16    ##D,16                                            BUG23742
     C                     MOVELPRTF17    ##D,17                                            BUG23742
     C                     MOVELPRTF18    ##D,18                                            BUG23742
     C                     MOVELPRTF19    ##D,19                                            BUG23742
     C                     MOVELPRTF20    ##D,20                                            BUG23742
      *                                                                                     BUG23742
     C                     ELSE                                                             BUG23742
      *                                                                                     BUG23742
     C                     MOVEL'MG001901'W0FILE                                            BUG23742
     C                     MOVELEXT,1     W0KEY                                             BUG23742
     C                     Z-ADD34        W0ERNB                                            BUG23742
     C                     MOVEL'MEM5003' W0MSGD                                            BUG23742
     C                     MOVEL'MIDAS'   W0MSGF                                            BUG23742
     C                     EXSR SRERR                                                       BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     ELSE                                                             BUG23742
      *                                                                                       CER031
      ** Call the MG001900 access object to format the extended                               CER031
      ** narratives                                                                           CER031
      *                                                                                       CER031
     C                     CALL 'MG001900'                                                    CER031
     C                     PARM           PRTCD2 10                                           CER031
     C                     PARM           POPTN                                               CER031
     C                     PARM           PNTWK   6                                           CER031
     C                     PARM           PMGTYP  3                                           CER031
     C                     PARM           PBRCA                                               CER031
     C                     PARM           PCUSNO                                              CER031
     C                     PARM           PCCY                                                CER031
     C                     PARM           PACCD                                               CER031
     C                     PARM           PACSQ                                               CER031
     C                     PARM           PDCIN   1                                           CER031
     C                     PARM           PTRTP   5                                           CER031
     C                     PARM           PNARR1                                              CER031
     C                     PARM           PNARR2                                              CER031
     C                     PARM           PNARR3                                              CER031
     C                     PARM           PNARR4                                              CER031
     C                     PARM           PNARR5                                              CER031
     C                     PARM           PNARR6                                              CER031
     C**********           PARM           PRTF1  70                                  CER031 BUG23197
     C**********           PARM           PRTF2  70                                  CER031 BUG23197
     C**********           PARM           PRTF3  70                                  CER031 BUG23197
     C**********           PARM           PRTF4  70                                  CER031 BUG23197
     C**********           PARM           PRTF5  70                                  CER031 BUG23197
     C**********           PARM           PRTF6  70                                  CER031 BUG23197
     C**********           PARM           PRTF7  70                                  CER031 BUG23197
     C**********           PARM           PRTF8  70                                  CER031 BUG23197
     C**********           PARM           PRTF9  70                                  CER031 BUG23197
     C**********           PARM           PRTF10 70                                  CER031 BUG23197
     C**********           PARM           PRTF11 70                                  CER031 BUG23197
     C**********           PARM           PRTF12 70                                  CER031 BUG23197
     C**********           PARM           PRTF13 70                                  CER031 BUG23197
     C**********           PARM           PRTF14 70                                  CER031 BUG23197
     C**********           PARM           PRTF15 70                                  CER031 BUG23197
     C**********           PARM           PRTF16 70                                  CER031 BUG23197
     C**********           PARM           PRTF17 70                                  CER031 BUG23197
     C**********           PARM           PRTF18 70                                  CER031 BUG23197
     C**********           PARM           PRTF19 70                                  CER031 BUG23197
     C**********           PARM           PRTF20 70                                  CER031 BUG23197
     C                     PARM *BLANKS   PRTF1  70                                         BUG23197
     C                     PARM *BLANKS   PRTF2  70                                         BUG23197
     C                     PARM *BLANKS   PRTF3  70                                         BUG23197
     C                     PARM *BLANKS   PRTF4  70                                         BUG23197
     C                     PARM *BLANKS   PRTF5  70                                         BUG23197
     C                     PARM *BLANKS   PRTF6  70                                         BUG23197
     C                     PARM *BLANKS   PRTF7  70                                         BUG23197
     C                     PARM *BLANKS   PRTF8  70                                         BUG23197
     C                     PARM *BLANKS   PRTF9  70                                         BUG23197
     C                     PARM *BLANKS   PRTF10 70                                         BUG23197
     C                     PARM *BLANKS   PRTF11 70                                         BUG23197
     C                     PARM *BLANKS   PRTF12 70                                         BUG23197
     C                     PARM *BLANKS   PRTF13 70                                         BUG23197
     C                     PARM *BLANKS   PRTF14 70                                         BUG23197
     C                     PARM *BLANKS   PRTF15 70                                         BUG23197
     C                     PARM *BLANKS   PRTF16 70                                         BUG23197
     C                     PARM *BLANKS   PRTF17 70                                         BUG23197
     C                     PARM *BLANKS   PRTF18 70                                         BUG23197
     C                     PARM *BLANKS   PRTF19 70                                         BUG23197
     C                     PARM *BLANKS   PRTF20 70                                         BUG23197
     C                     PARM           IDX     30                                          CER031
     C                     PARM           FLDNAM                                              CER031
     C                     PARM           MSGID                                               CER031
     C                     PARM           MSGDTA                                              CER031
     C                     PARM           WFLDNM                                              CER031
     C                     PARM           WMGID                                               CER031
     C                     PARM           WMGDTA                                              CER031
      *                                                                                       CER031
     C           PRTCD2    IFEQ ' '                                                           CER031
     C           PRTCD2    OREQ '*FORMAT'                                                     CER031
      *                                                                                       CER031
     C                     MOVELPRTF1     ##D,1                                               CER031
     C                     MOVELPRTF2     ##D,2                                               CER031
     C                     MOVELPRTF3     ##D,3                                               CER031
     C                     MOVELPRTF4     ##D,4                                               CER031
     C                     MOVELPRTF5     ##D,5                                               CER031
     C                     MOVELPRTF6     ##D,6                                               CER031
     C                     MOVELPRTF7     ##D,7                                               CER031
     C                     MOVELPRTF8     ##D,8                                               CER031
     C                     MOVELPRTF9     ##D,9                                               CER031
     C                     MOVELPRTF10    ##D,10                                              CER031
     C                     MOVELPRTF11    ##D,11                                              CER031
     C                     MOVELPRTF12    ##D,12                                              CER031
     C                     MOVELPRTF13    ##D,13                                              CER031
     C                     MOVELPRTF14    ##D,14                                              CER031
     C                     MOVELPRTF15    ##D,15                                              CER031
     C                     MOVELPRTF16    ##D,16                                              CER031
     C                     MOVELPRTF17    ##D,17                                              CER031
     C                     MOVELPRTF18    ##D,18                                              CER031
     C                     MOVELPRTF19    ##D,19                                              CER031
     C                     MOVELPRTF20    ##D,20                                              CER031
      *                                                                                       CER031
     C                     ELSE                                                               CER031
     C                     MOVEL'MG001900'W0FILE                                              CER031
     C                     MOVELPNARR1    W0KEY                                               CER031
     C                     Z-ADD31        W0ERNB                                              CER031
     C                     MOVEL'MEM5003' W0MSGD                                              CER031
     C                     MOVEL'MIDAS'   W0MSGF                                              CER031
     C                     EXSR SRERR                                                         CER031
     C                     ENDIF                                                              CER031
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                       CER031
      ** Accumulate RDE's and associated data and output to                                   CER031
      ** PF/CGUDTAPD.                                                                         CER031
      *                                                                                       CER031
     C                     EXSR SRADTA                                                        CER031
      *                                                                                     BUG23742
     C           WACUM     IFEQ 'Y'                                                         BUG23742
      *                                                                                     BUG23742
      ** Retrieve RDE information for RDEs in group set                                     BUG23742
      *                                                                                     BUG23742
     C                     MOVEL@STK,Q    ##GRPS                                            BUG23742
     C                     Z-ADD21        ##RDEN                                            BUG23742
      *                                                                                     BUG23742
     C                     EXSR SRRRDE                                                      BUG23742
      *                                                                                     BUG23742
     C                     MOVELPRTF21    ##D,1                                             BUG23742
     C                     MOVELPRTF22    ##D,2                                             BUG23742
      *                                                                                     BUG23742
     C                     EXSR SRADTA                                                      BUG23742
      *                                                                                     BUG23742
     C                     MOVEL*BLANKS   EXT                                               BUG23742
     C                     MOVEL*BLANKS   WACUM                                             BUG23742
      *                                                                                     BUG23742
     C                     ENDIF                                                            BUG23742
      *                                                                                     BUG23742
     C                     EXSR SRODTA                                                        CER031
      *                                                                                       CER031
      *................................................................                       CER031
      *                                                                                       CER031
     C           EXCRNR    TAG                                                                CER031
      *                                                                                       CER031
      ** Unwind subroutine stack name                                                         CER031
      *                                                                                       CER031
     C                     EXSR POPGRS                                                        CER031
     C                     MOVEA*BLANKS   @STK,Q                                              CER031
     C                     SUB  1         Q                                                   CER031
      *                                                                                       CER031
     C                     ENDSR                                                              CER031
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRAUDT                                         *
      * Function    :  Audit Report Processing                        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  CGZAUDIT - Audit Processing                    *
      *                CG9020   - Write Data to UDC Data Files - Audit*
      *****************************************************************
     C           SRAUDT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRAUDT'  @STK,Q
      *
      *................................................................
      *
      **  Output the Count of records read
     C                     CLEARI#DTA
     C                     MOVEL'CG4900AU'I#SPLN
     C                     MOVEL'CG4900  'I#REF
     C                     MOVE 'CGD1762' I#TITL
     C                     MOVE 'CGD1763' I#TUL
     C                     MOVEL'CGUSRMSG'I#FILE
     C                     MOVE '*LINE   'W1ACT
     C                     MOVE *BLANKS   I#SUB
     C                     MOVEL'GLJENPL1'I#SUB
     C                     MOVEL'CAD1021' I#TEXT
     C                     Z-ADD##DREC    I#QTY
     C                     Z-ADD*ZERO     I#DECS
     C                     MOVE '1'       I#EDIT
     C*
     C                     CALL 'CGZAUDIT'
     C                     PARM           W1RTN   7
     C                     PARM           W1ACT   8
     C                     PARM           I#DTA
     C                     PARM           W1RSQN  5
      *
      **  Skip a line.
     C                     MOVE '*SKIP   'W1ACT
     C*
     C                     CALL 'CGZAUDIT'
     C                     PARM           W1RTN   7
     C                     PARM           W1ACT   8
     C                     PARM           I#DTA
     C                     PARM           W1RSQN  5
      *
      **  Produce the Audit Report.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*AUDIT  'W0ACT
     C                     PARM *BLANKS   W0PATH256
     C                     PARM           W0FMT
     C                     PARM 'CGD1762' W0TITL  7
     C                     PARM 'CGD1763' W0ULIN  7
     C                     PARM           W0CMT   3
      *
      **  Close the Audit Print File.
     C                     CLEARI#DTA
     C                     MOVEL'CG4900AU'I#SPLN
     C                     MOVEL'CG4900  'I#REF
     C                     MOVE 'CGD1762' I#TITL
     C                     MOVE 'CGD1763' I#TUL
     C                     MOVEL'CGUSRMSG'I#FILE
      *
     C           ##DREC    IFNE *ZEROS
     C                     MOVEL'CAD1021' I#TEXT
     C                     ENDIF
      *
     C                     CALL 'CGZAUDIT'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*CLOSE  'W0ACT   8
     C                     PARM           I#DTA
     C                     PARM           W0RSQN  5
      *
      *................................................................
      *
     C           EXAUDT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************                     BUG23742
      /EJECT                                                                                BUG23742
      *****************************************************************                     BUG23742
      *                                                               *                     BUG23742
      *  SREVNA   - Evaluate Additional Narrative Details             *                     BUG23742
      *                                                               *                     BUG23742
      *  Called by: DEXNAR, CEXNAR                                    *                     BUG23742
      *                                                               *                     BUG23742
      *  Calls: None                                                  *                     BUG23742
      *                                                               *                     BUG23742
      *****************************************************************                     BUG23742
     C           SREVNA    BEGSR                                                            BUG23742
      *                                                                                     BUG23742
     C                     MOVELBAEX1     EXT,1                                             BUG23742
     C                     MOVELBAEX2     EXT,2                                             BUG23742
     C                     MOVELBAEX3     EXT,3                                             BUG23742
     C                     MOVELBAEX4     EXT,4                                             BUG23742
     C                     MOVELBAEX5     EXT,5                                             BUG23742
     C                     MOVELBAEX6     EXT,6                                             BUG23742
     C                     MOVELBAEX7     EXT,7                                             BUG23742
     C                     MOVELBAEX8     EXT,8                                             BUG23742
     C                     MOVELBAEX9     EXT,9                                             BUG23742
     C                     MOVELBAEX10    EXT,10                                            BUG23742
     C                     MOVELBAEX11    EXT,11                                            BUG23742
     C                     MOVELBAEX12    EXT,12                                            BUG23742
     C                     MOVELBAEX13    EXT,13                                            BUG23742
     C                     MOVELBAEX14    EXT,14                                            BUG23742
     C                     MOVELBAEX15    EXT,15                                            BUG23742
     C                     MOVELBAEX16    EXT,16                                            BUG23742
     C                     MOVELBAEX17    EXT,17                                            BUG23742
     C                     MOVELBAEX18    EXT,18                                            BUG23742
     C                     MOVELBAEX19    EXT,19                                            BUG23742
     C                     MOVELBAEX20    EXT,20                                            BUG23742
     C                     MOVELBAEX21    EXT,21                                            BUG23742
     C                     MOVELBAEX22    EXT,22                                            BUG23742
      *                                                                                     BUG23742
     C                     ENDSR                                                            BUG23742
      *****************************************************************                     BUG23742
     C/COPY WNCPYSRC,CG4900C004
      *****************************************************************
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
     C/SPACE 5                                                                                CCG015
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
** ##GRP/##RDE
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
DETL  0001 RUNDAT     Date
DETL  0002 VALUE DATE Date
DETL  0003 DR/CRIND
R08DTL0001 RETL_ACNO
R08DTL0002 ACCOUNT
R08DTL0003 POST_BCHN
R08DTL0004 POST_BITEM
R08DTL0005 DEPT_CODE
R08DTL0006 RET_TRNAME
R08DTL0007 POST_NARR
R08DTL0008 CURRENCY
R08DTL0009 POST_AMT   AmountL
R08DTL0010 TRANS TYPE
R08DTL0011 PROF_CENT
R08DTL0012 POST_EQCY  AmountL                                             CEU014
R08DTL0013 EQUIV_CCY                                                      CEU014
R08DTL0014 EQUIV_CCYD                                                     CEU014
R08DTL0015 IBAN                                                           CFT004
R08DTL0016 CER055F                                                                            CER055
ODACCT0001 ACCNUM                                                                             CER055
ODACCT0002 CURRENCY                                                                           CER055
ODACCT0003 CLRDBAL    AmountL                                                                 CER055
ODACCT0004 LDGRBAL    AmountL                                                                 CER055
ODACCT0005 ODLIMIT    AmountL                                                                 CER055
ODACCT0006 ODLMTEXPDT Date                                                                    CER055
ODACCT0007 DEBINTRTE  Rate  L7                                                                CER055
ODACCT0008 ODINTRATE  Rate  L7                                                                CER055
ODACCT0009 DTEODBAL   Date                                                                    CER055
ODACCT0010 NUMDAYS                                                                            CER055
CUST  0001 CUSTOMER
CUST  0002 CUST_NAME
CUST  0003 CUST_ADR1
CUST  0004 CUST_ADR2
CUST  0005 CUST_ADR3
CUST  0006 CUST_ADR4
CUST  0007 CUST_TOWN                                                      086918
DEXNAR0001 DEX_NARR01                    Extended Narrative 1                                 CER031
DEXNAR0002 DEX_NARR02                    Extended Narrative 2                                 CER031
DEXNAR0003 DEX_NARR03                    Extended Narrative 3                                 CER031
DEXNAR0004 DEX_NARR04                    Extended Narrative 4                                 CER031
DEXNAR0005 DEX_NARR05                    Extended Narrative 5                                 CER031
DEXNAR0006 DEX_NARR06                    Extended Narrative 6                                 CER031
DEXNAR0007 DEX_NARR07                    Extended Narrative 7                                 CER031
DEXNAR0008 DEX_NARR08                    Extended Narrative 8                                 CER031
DEXNAR0009 DEX_NARR09                    Extended Narrative 9                                 CER031
DEXNAR0010 DEX_NARR10                    Extended Narrative 10                                CER031
DEXNAR0011 DEX_NARR11                    Extended Narrative 11                                CER031
DEXNAR0012 DEX_NARR12                    Extended Narrative 12                                CER031
DEXNAR0013 DEX_NARR13                    Extended Narrative 13                                CER031
DEXNAR0014 DEX_NARR14                    Extended Narrative 14                                CER031
DEXNAR0015 DEX_NARR15                    Extended Narrative 15                                CER031
DEXNAR0016 DEX_NARR16                    Extended Narrative 16                                CER031
DEXNAR0017 DEX_NARR17                    Extended Narrative 17                                CER031
DEXNAR0018 DEX_NARR18                    Extended Narrative 18                                CER031
DEXNAR0019 DEX_NARR19                    Extended Narrative 19                                CER031
DEXNAR0020 DEX_NARR20                    Extended Narrative 20                                CER031
DEXNAR0021 DEX_NARR21                    Extended Narrative 21                              BUG23742
DEXNAR0022 DEX_NARR22                    Extended Narrative 22                              BUG23742
CEXNAR0001 CEX_NARR01                    Extended Narrative 1 Crd                             CER031
CEXNAR0002 CEX_NARR02                    Extended Narrative 2 Crd                             CER031
CEXNAR0003 CEX_NARR03                    Extended Narrative 3 Crd                             CER031
CEXNAR0004 CEX_NARR04                    Extended Narrative 4 Crd                             CER031
CEXNAR0005 CEX_NARR05                    Extended Narrative 5 Crd                             CER031
CEXNAR0006 CEX_NARR06                    Extended Narrative 6 Crd                             CER031
CEXNAR0007 CEX_NARR07                    Extended Narrative 7 Crd                             CER031
CEXNAR0008 CEX_NARR08                    Extended Narrative 8 Crd                             CER031
CEXNAR0009 CEX_NARR09                    Extended Narrative 9 Crd                             CER031
CEXNAR0010 CEX_NARR10                    Extended Narrative 10 Crd                            CER031
CEXNAR0011 CEX_NARR11                    Extended Narrative 11 Crd                            CER031
CEXNAR0012 CEX_NARR12                    Extended Narrative 12 Crd                            CER031
CEXNAR0013 CEX_NARR13                    Extended Narrative 13 Crd                            CER031
CEXNAR0014 CEX_NARR14                    Extended Narrative 14 Crd                            CER031
CEXNAR0015 CEX_NARR15                    Extended Narrative 15 Crd                            CER031
CEXNAR0016 CEX_NARR16                    Extended Narrative 16 Crd                            CER031
CEXNAR0017 CEX_NARR17                    Extended Narrative 17 Crd                            CER031
CEXNAR0018 CEX_NARR18                    Extended Narrative 18 Crd                            CER031
CEXNAR0019 CEX_NARR19                    Extended Narrative 19 Crd                            CER031
CEXNAR0020 CEX_NARR20                    Extended Narrative 20 Crd                            CER031
CEXNAR0021 CEX_NARR21                    Extended Narrative 21 Crd                          BUG23742
CEXNAR0022 CEX_NARR22                    Extended Narrative 22 Crd                          BUG23742
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
