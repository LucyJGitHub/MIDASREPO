     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG FT mail payment orders - cheques')
      *****************************************************************
      *                                                               *
      *  Midas - User Defined Correspondence                          *
      *                                                               *
      *  CG4960 - FT Mail Payment Orders                              *
      *                                                               *
      *  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
      *  (phase(s))                                                   *
      *                                                               *
      *  Called By: mmCnnnn - (program name)                          *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9646            Date 20Dec05               *
      *                 BUG2330            Date 29Apr04               *
      *                 TDA035             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 30May00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU006             Date 07Apr98               *
      *                 095577             DATE 07NOV95               *
      *                 087995             DATE 11MAY95               *
      *                 086382             DATE 18APR95               *
      *                 085775             DATE 05APR95               *
      *                 085712             DATE 04APR95               *
      *                 086182             DATE 31MAR95               *
      *                 086177             DATE 30MAR95               *
      *                 S01522             DATE 11JAN95               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
     F*  BUG2330- CG programs looking at wrong dataarea for CSC022    *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  CFT009 - Addition of fields for FT fees and charges          *
      *           Recompile                                           *
      *  CEU006 - EMU FT Payments and Settlements:                    *
      *           added new group set FT_DLV to MAPO02.               *
      *  095577 - Add new RDEs                                        *
      *           CR DATE Credit Date                                 *
      *           SETTLE MOD Settlement Method                        *
      *  087995 - Remove *DBERR from AOCURRR0 call                    *
      *           Correct Currency as parameter                       *
      *  086382 - Do not call A0PRFCR0 if profit center blank.        *
      *  085775 - Change customer report town from 10A to 35A         *
      *  085712 - Details of amounts added are character not numeric. *
      *  086182 - Correct Print Sub-type to Cheques                   *
      *  086177 - Move generation so not print can be set             *
      *  S01522 - User Defined Correspondence                         *
      *                                                               *
      *****************************************************************
      *                                                               *
      *  Indicator usage                                              *
      *  ~~~~~~~~~~~~~~~                                              *
      *  99   -    General work indicator                             *
      *                                                               *
      *****************************************************************
     FTABFP   IF  E           K        DISK
     F            TABTB11F                          KIGNORE
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETRF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     FMUSER   IF  E           K        DISK
     F/SPACE 5
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
      *                                                                                       CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      *                                                                                       CSC022
     E                    WCMT       10 10                                                    CSC022
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E***********         ##GRP   1  52 10   ##RDEA 22                    095577
     E***********         ##GRP   1  54 10   ##RDEA 22              095577CEU006
     E                    ##GRP   1  56 10   ##RDEA 22                    CEU006
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
     I*
     IWDSJOB    E DSSCCMTJOB                                                                  CSC022
     I              COMITNUM                        WCMTNO                                    CSC022
     I              COMITJOB1                       WJOB01                                    CSC022
     I              COMITJOB2                       WJOB02                                    CSC022
     I              COMITJOB3                       WJOB03                                    CSC022
     I              COMITJOB4                       WJOB04                                    CSC022
     I              COMITJOB5                       WJOB05                                    CSC022
     I              COMITJOB6                       WJOB06                                    CSC022
     I              COMITJOB7                       WJOB07                                    CSC022
     I              COMITJOB8                       WJOB08                                    CSC022
     I              COMITJOB9                       WJOB09                                    CSC022
     I              COMITJOB10                      WJOB10                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      *                                                                                       CSC022
     I            DS
     I                                    B   1   20##OSEQ
     I**  Convert Ouput Sequence between Numeric and Binary
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9646
     I                                        15632 ##S                                      BUG9646
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I*
     I#RETLN      DS
     I**********                              1   60##CNUM                                    CSD027
     I                                        1   6 ##CNUM                                    CSD027
     I                                        7   9 ##CCY
     I**********                             10  130##ACOD                                    CGL029
     I**********                             14  150##ACSQ                                    CGL029
     I**********                             16  18 ##BRCA                                    CGL029
     I                                       10  190##ACOD                                    CGL029
     I                                       20  210##ACSQ                                    CGL029
     I                                       22  24 ##BRCA                                    CGL029
     I            DS
      *
      * Data Structure redefining Address fields
      *
     I                                        1 210 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
     I                                      176 210 ADCHK6
      *
      * Blank Line Analysis data structure
      *
     I                                       36 210 ADCH26
     I                                       71 210 ADCH36
      *
      * SWIFT Address Analysis data structure
      *
     I                                        1   1 ADSLSH
     I                                        1  11 ADSWFT
     I                                       12  35 ADEXSW
     I                                       36  36 ADSLS2
     I                                       36  46 ADSWF2
     I                                       47  70 ADEXS2
      *
      * Customer Analysis data structure
      *
     I                                        1  10 ADCUST
     I                                       11  35 ADEXCS
     I                                        1   6 ADCNUM
     I                                        7  35 ADEXCN
     I                                       36  45 ADCUS2
     I                                       46  70 ADXCS2
     I                                       36  41 ADCNM2
     I                                       42  70 ADXCN2
      *
      * Account Analysis data structure FULL Account
      *
     I                                        1   6 ADGCNM
     I                                        7   9 ADGCCY
     I**********                             10  13 ADGACD                                    CGL029
     I**********                             14  15 ADGASQ                                    CGL029
     I**********                             16  18 ADGBRC                                    CGL029
     I**********                             16  35 ADEXG1                                    CGL029
     I**********                             19  35 ADEXGL                                    CGL029
     I                                       10  19 ADGACD                                    CGL029
     I                                       20  21 ADGASQ                                    CGL029
     I                                       22  24 ADGBRC                                    CGL029
     I                                       22  35 ADEXG1                                    CGL029
     I                                       25  35 ADEXGL                                    CGL029
      *
      * Partial Account Analysis data structure
      *
     I                                        1   6 ADPCNM
     I**********                              7  10 ADPACD                                    CGL029
     I**********                             11  12 ADPASQ                                    CGL029
     I**********                             13  15 ADPBRC                                    CGL029
     I**********                             13  35 ADEXP1                                    CGL029
     I**********                             16  35 ADEXPA                                    CGL029
     I                                        7  16 ADPACD                                    CGL029
     I                                       17  18 ADPASQ                                    CGL029
     I                                       19  21 ADPBRC                                    CGL029
     I                                       19  35 ADEXP1                                    CGL029
     I                                       22  35 ADEXPA                                    CGL029
      *
      * Nostro Number Account Analysis data structure
      *
     I                                        1   2 ADNOSN
     I                                        3  35 ADEXNN
      *
      * Nostro Account Analysis data structure
      *
     I                                        1   5 ADFNOS
     I                                        1   3 ADFCCY
     I                                        4   5 ADFNNB
     I                                        6  35 ADFNEX
      *
      * Retail Account Analysis data structure
      *
     I                                        1  10 ADACNO
     I                                       11  35 ADEXAC
      *
     I            DS
      *
      * Data Structure redefining Partial Account
      *
     I**********                              1  12 PTACCT                                    CGL029
     I                                        1  18 PTACCT                                    CGL029
     I                                        1   6 PTCNUM
     I**********                              7  10 PTACOD                                    CGL029
     I**********                             11  12 PTACSQ                                    CGL029
     I                                        7  16 PTACOD                                    CGL029
     I                                       17  18 PTACSQ                                    CGL029
      *
     IDSSDY     E DSDSSDY                                                 S01194
     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                       S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I* DS FOR CURRENCIES DETAILS                                         S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I* DS FOR BRANCH DETAILS                                             S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* DS FOR BANK DETAILS                                               S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I*                                                                   S01194
     ISDBOOK    E DSSDBOOKPD                                              S01194
     I*                                                                   S01194
     ISDPRFC    E DSSDPRFCPD                                              S01194
     I* DS FOR PROFIT CENTRE DETAILS                                      S01194
     I*                                                                   S01194
     I** RECORD FORMATS FOR ACCESS TO BOOK DETAILS                        S01194
     I*                                                                   S01194
     ISDDLST    E DSSDDLSTPD                                              S01194
     I* DS FOR DEAL SUBTYPE DETAILS                                       S01194
      *                                                                                       CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
      ** DS for SAR details                                                                   CCG015
     I              LCD                             WSCLCD                                    CCG015
      *                                                                                       CCG015
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
     IDSPARM    E DSCQPACDD
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
      *
      *    STANDARD LOCAL DATA AREA FIELDS
      *
     IRUNDT       DS
      *  DATA AREA RUNDAT
      *
      *
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     IW8FT        DS                            256                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      * Customer number
     I**********                             47  520W0CNUM                                    CSD027
     I                                       47  52 W0CNUM                                    CSD027
      * Retail Account number
     I                                       53  620W0ACNO
      * Currency
     I*****************                      63  650W#CCY                 087995
     I                                       63  65 W#CCY                 087995
      * Account Code
     I**********                             66  690W0ACOD                                    CGL029
     I                                       66  690QQACOD                                    CGL029
      * Account Sequence
     I                                       70  710W0ACSQ
      * Account Name
     I                                       72 101 W0ANAM
      * Branch
     I                                      102 104 W0BRCA
      * Customer name
     I                                      105 124 W0CRNM
      * Customer SWIFT I.D
     I                                      125 136 W0CSID
      * Customer account line
     I                                      137 171 W0ACLN
      * Customer report town
     I************                          172 181 W0RTWN                085775
     I                                      172 206 W0RTWN                085775
     I                                      207 2160W0ACOD                                    CGL029
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *
     I*---------------------------------------------------------------------
     I* Named constants
     I              'FT_MAIL   '          C         #TEXT1
     I**************'OUT_PAY   '          C         #TEXT2                086182
     I              'CHQ_TO_PAY'          C         #TEXT2                086182
     I/COPY CGCPYSRC,SRERRI
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           DSPARM
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      **  Initial processing - Once Only
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      **  Initialisation processing
     C                     EXSR SRINZ
      *
     C* Try to generate record if customer                                086177
     C********** CNUM      IFNE *ZEROS                                                 086177 CSD027
     C           CNUM      IFNE *BLANKS                                                       CSD027
     C                     EXSR SRGENR                                    086177
     C                     ENDIF                                          086177
      **  Main processing
     C********** CNUM      IFNE *ZEROS                                                        CSD027
     C           CNUM      IFNE *BLANKS                                                       CSD027
     C           ##RTCD    ANDNE'CGD1270'                                 086177
     C                     EXSR SRMAIN
     C                     ELSE
     C                     MOVEL'*NOPRNT' W0RTN
     C                     ENDIF
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
     C***********          EXSR SRGENR                                    086177
      *
     C                     EXSR MAPO02
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  MAPO02                                         *
      * Function    :  Mail transfers - Cheques                       *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           MAPO02    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAPO02'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\MAPO02' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      **  Branch Details
     C                     EXSR BRANCH
      *
      **  Book Details
     C                     EXSR BOOK
      *
      **  Profit Centre Details
     C                     EXSR PROF@C
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      *
      **  Payment Main Data
     C                     EXSR PAYMNT
      *
      **  Credit/Cheque Currency
     C                     EXSR CR@CCY
      *
      **  Account with bank
     C                     EXSR AC@W@B
      *
      **  Remitting Party
     C                     EXSR REMIT
      *
      **  Receivers Correspondant
     C                     EXSR RECEVR
      *
      **  Senders Correspondant
     C                     EXSR SENDER
      *
      **  Bank to bank information
     C                     EXSR B@TO@B
      *
      **  Details of Amounts added
     C                     EXSR AMTADD
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process group set FT_DLV - FT Delivery Details.            CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
     C                     EXSR FT@DLV                                    CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      *................................................................
      *
     C           EXPO02    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Branch
     C                     MOVELA8BRCD    ##D,1
      *
      ** Branch Name
     C                     MOVELA8BRNM    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BOOK                                           *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BOOK      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BOOK  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BOOK  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Book Details
     C                     CALL 'AOBOOKR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BOKC      @BOKC   2                       S01194
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01194
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBOOKPD'W0FILE
     C                     MOVELBOKC      W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Book Code
     C                     MOVELBOKC      ##D,1
      *
      ** Book Description
     C                     MOVELBDBKD     ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOK      TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PROF@C                                         *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PROF@C    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PROF_C'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PROF_C' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *                                                                   086382
      **  Bypass if profit center blank.                                  086382
     C           PRFC      IFEQ *BLANKS                                   086382
     C                     GOTO EXOF@C                                    086382
     C                     ENDIF                                          086382
      *
      **  Obtain Profit Centre details
     C                     CALL 'AOPRFCR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PRFC      @KEY    4
     C           SDPRFC    PARM SDPRFC    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDPRFCPD'W0FILE
     C                     MOVELPRFC      W0KEY            ***************
     C                     Z-ADD3         W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Profit Centre
     C                     MOVELPRFC      ##D,1
      *
      ** Profit Centre Description
     C                     MOVELDSPCDS    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOF@C    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  FT@USR                                         *
      * Function    :  FT Transaction Users                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           FT@USR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'FT_USR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\FT_USR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Input User 1
     C                     MOVELINUSR1    ##D,1
      *
      ** Input User 2
     C                     MOVELINUSR2    ##D,2
      *
      ** Authorising User 1
     C                     MOVELAUP1      ##D,3
      *
      ** Authorising User 2
     C                     MOVELAUP2      ##D,4
      *
      ** Input User 1 Description.
     C           INUSR1    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,5
     C                     ENDIF
      *
      ** Input User 2 Description.
     C           INUSR1    IFNE INUSR2
     C           INUSR2    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,7
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      IFNE AUP2
     C           AUP2      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@USR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAYMNT                                         *
      * Function    :  Payment - Main data                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAYMNT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAYMNT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAYMNT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Payment Reference
     C                     MOVELPREF      ##D,1
      *
      **  Value Date
     C                     MOVELPVDT      ##D,2
      *
      **  Payment Date
     C                     MOVELBJRDNB    ##D,3
      *
      **  Payment Type
     C                     MOVELPYTP      ##D,4
      *
      **  Payment Sub-Type
     C                     MOVELPYST      ##D,5
      *
      **  Obtain Payment Sub-Type Description
     C                     CALL 'AODLSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PYST      @AQCD   3
     C           SDDLST    PARM SDDLST    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDDLSTPD'W0FILE
     C                     MOVELPYST      W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **  Payment Sub-Type Description
     C                     MOVELASDSTN    ##D,6
      *                                                                   095577
      * Set up Settle Method                                              095577
      *                                                                   095577
     C                     MOVELSTMT      ##D,7                           095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXYMNT    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SR@CCY                                         *
      * Function    :  Credit/Cheque Currency                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CR@CCY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CR_CCY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CR_CCY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Credit Cheque/Currency
     C                     MOVELPCCY      ##D,1
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM PCCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELPCCY      W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4960C001
      *
      **  Credit/Cheque Currency Name
     C                     MOVELA6CYNM    ##D,2
      *
      **  Credit/Cheque Amount
     C/COPY WNCPYSRC,CG4960C003
     C                     MOVELPRRM      ##D,3
     C/COPY WNCPYSRC,CG4960C004
     C                     MOVE A6NBDP    ##D,3
      *
      **  Cheque Number
     C                     MOVE *BLANKS   ##D,4
      *
      **  Cheque Sequence Number
     C                     MOVELCQSQ      ##D,5
      *                                                                   095577
      * Set up Credit Date                                                095577
      *                                                                   095577
     C                     MOVELPVDT      ##D,6                           095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@CCY    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CORDTA                                         *
      * Function    :  Correspondent data                             *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           CORDTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CORDTA'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\CORDTA' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Correspondent type.
     C                     MOVEL#TYPE     ##D,1
      *
      **  Customer.
     C                     MOVELW0CNUM    ##D,2
      *
      **  Customer name.
     C                     MOVELW0CRNM    ##D,3
      *
      **  Customer town.
     C                     MOVELW0RTWN    ##D,4
      *
      **  Account line.
     C                     MOVELW0ACLN    ##D,5
      *
      **  Retail account no.
     C                     MOVELW0ACNO    ##D,6
      *
      **  Midas account number.
     C                     CLEAR#RETLN
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRCA
     C***********          MOVEL#RETLN    ##D,5                           087995
     C                     MOVEL#RETLN    ##D,7                           087995
      *
      **  Account name.
     C                     MOVELW0ANAM    ##D,8
      *
      **  SWIFT ID.
     C                     MOVELW0CSID    ##D,9
      *
      **  Address line 1.
     C                     MOVELSPT1      ##D,10
      *
      **  Address line 2.
     C                     MOVELSPT2      ##D,11
      *
      **  Address line 3.
     C                     MOVELSPT3      ##D,12
      *
      **  Address line 4.
     C                     MOVELSPT4      ##D,13
      *
      **  Address line 5.
     C                     MOVELSPT5      ##D,14
      *
      *................................................................
      *
     C           EXRDTA    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  AC@W@B                                         *
      * Function    :  Account with Bank details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           AC@W@B    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'AC_W_B'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\AC_W_B' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1   35
     C                     MOVE *BLANKS   SPT2   35
     C                     MOVE *BLANKS   SPT3   35
     C                     MOVE *BLANKS   SPT4   35
     C                     MOVE *BLANKS   SPT5   35
     C*
     C                     MOVE ACBT      SPTP    1
     C                     MOVE ACB1      SPT1
     C                     MOVE ACB2      SPT2
     C                     MOVE ACB3      SPT3
     C                     MOVE ACB4      SPT4
     C                     MOVE ACB5      SPT5
      *
     C                     SETOF                     60
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE   1
     C                     MOVELACBT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@W@B    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  REMIT                                          *
      * Function    :  Remitting Party                                *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           REMIT     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'REMIT '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\REMIT ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE RBKT      SPTP
     C                     MOVE RBK1      SPT1
     C                     MOVE RBK2      SPT2
     C                     MOVE RBK3      SPT3
     C                     MOVE RBK4      SPT4
      *
     C                     SETON                     60
     C                     EXSR SRTPSR
     C                     SETOF                     60
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELRBKT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXMIT     TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  RECEVR                                         *
      * Function    :  Receiver's Correspondant                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           RECEVR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'RECEVR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\RECEVR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE RCRT      SPTP
     C                     MOVE RCO1      SPT1
     C                     MOVE RCO2      SPT2
     C                     MOVE RCO3      SPT3
     C                     MOVE RCO4      SPT4
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELRCRT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCEVR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SENDER                                         *
      * Function    :  Sender's Correspondant                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SENDER    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SENDER'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\SENDER' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE SNCT      SPTP
     C                     MOVELSNCO      SPT1
     C                     MOVELPCCY      XCCY
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELSNCT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNDER    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  B@TO@B                                         *
      * Function    :  Bank to bank information                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           B@TO@B    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'B_TO_B'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\B_TO_B' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Bank to bank information - 1.
     C                     MOVELBBI1      ##D,1
      *
      **  Bank to bank information - 2.
     C                     MOVELBBI2      ##D,2
      *
      **  Bank to bank information - 3.
     C                     MOVELBBI3      ##D,3
      *
      **  Bank to bank information - 4.
     C                     MOVELBBI4      ##D,4
      *
      **  Bank to bank information - 5.
     C                     MOVELBBI5      ##D,5
      *
      **  Bank to bank information - 6.
     C                     MOVELBBI6      ##D,6
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTO@B    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  AMTADD                                         *
      * Function    :  Detils of Amounts added                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           AMTADD    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'AMTADD'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\AMTADD' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Amount added field - 1.
     C                     MOVELDAA1      ##D,1
     C***********          MOVE A6NBDP    ##D,1                           085712
      *
      **  Amount added field - 2.
     C                     MOVELDAA2      ##D,2
     C***********          MOVE A6NBDP    ##D,2                           085712
      *
      **  Amount added field - 3.
     C***********          MOVELDAA1      ##D,3                           085712
     C                     MOVELDAA3      ##D,3                           085712
     C***********          MOVE A6NBDP    ##D,3                           085712
      *
      **  Amount added field - 4.
     C***********          MOVELDAA1      ##D,4                           085712
     C                     MOVELDAA4      ##D,4                           085712
     C***********          MOVE A6NBDP    ##D,4                           085712
      *
      **  Amount added field - 5.
     C***********          MOVELDAA1      ##D,5                           085712
     C                     MOVELDAA5      ##D,5                           085712
     C***********          MOVE A6NBDP    ##D,5                           085712
      *
      **  Amount added field - 6.
     C***********          MOVELDAA1      ##D,6                           085712
     C                     MOVELDAA6      ##D,6                           085712
     C***********          MOVE A6NBDP    ##D,6                           085712
      *
      **  Amount subtracted field - 1.
     C***********          MOVELDAA1      ##D,7                           085712
     C/COPY WNCPYSRC,CG4960C005
     C                     MOVELDEDS      ##D,7                           085712
     C/COPY WNCPYSRC,CG4960C006
     C                     MOVE A6NBDP    ##D,7
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTADD    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************   CEU006
      * Subroutine  :  FT@DLV                                         *   CEU006
      * Function    :  Funds Transfer Delivery Details                *   CEU006
      *                                                               *   CEU006
      * Called by   :  MAPO02                                         *   CEU006
      * Calls       :                                                 *   CEU006
      *****************************************************************   CEU006
     C           FT@DLV    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'FT_DLV'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Retrieve subroutine specific data.                              CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\FT_DLV' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      **  Pay Delivery Currency                                           CEU006
      *                                                                   CEU006
     C           PDCY      IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM PDCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELPDCY      W0KEY            ***************CEU006
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4960C007
      *                                                                   CEU006
     C                     MOVELPDCY      ##D,1                           CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,1                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Pay Delivery Amount                                             CEU006
     C           PDCY      IFNE *BLANKS                                   CEU006
     C/COPY WNCPYSRC,CG4960C008
     C                     MOVELPDAM      ##D,2                           CEU006
     C/COPY WNCPYSRC,CG4960C009
     C                     MOVE A6NBDP    ##D,2                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,2                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@DLV    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************
      * Subroutine  :  SRTPSR                                         *
      * Function    :  Format Settlement Party Subroutine             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRTPSR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRTPSR'  @STK,Q
      *
      *................................................................
      *
     C*
     C**********************
     C*    NOT ENTERED     *
     C**********************
     C*
     C           SPTP      IFEQ ' '
     C                     MOVE *BLANK    SPT1
     C                     END
      *
      * Use FT0315 to format text for D address type
      *
      *  Set up general parameters
      *
     C           *LIKE     DEFN PCCY      XCCY
      *
     C                     CLEARW8FT
     C                     MOVEL*BLANKS   W8STMT
     C                     MOVELXCCY      W8CCY
     C                     MOVEL##PGM     W8CPGM
     C                     MOVEL'*MSG  '  W8ACT
     C                     Z-ADD5         W8NLIN
     C                     MOVEL'Y'       W8MTXT
     C                     MOVEL'Y'       W8MADD
      *
      *  Format data to be translated
      *
     C                     MOVELSPTP      W8TYPE
     C                     MOVEL*BLANKS   W8LINS
     C                     MOVELSPT1      ADCHK1
     C                     MOVELSPT2      ADCHK2
     C                     MOVELSPT3      ADCHK3
     C                     MOVELSPT4      ADCHK4
     C                     MOVELSPT5      ADCHK5
     C                     MOVELADDRSS    W8LINS
      *
      * Call expansion program
      *
     C                     CALL 'CG4980'               3030
     C                     PARM           W8RTN   7
     C                     PARM           W8FT
     C                     PARM           W8LINS256
     C                     PARM           W8RPT 256
     C                     PARM           W8MSG 256
     C                     PARM           W8SCR 256
      *
      *  Check if database error occurred
      *
     C           *IN30     IFEQ '1'
     C           W8RTN     ORNE *BLANKS
     C                     MOVEL'CG4980  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 09 *
     C                     Z-ADD9         W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C           *IN60     IFEQ '1'
     C                     MOVELW8RPT     ADDRSS
     C                     ELSE
     C                     MOVELW8MSG     ADDRSS
     C                     END
     C                     MOVELADCHK1    SPT1
     C                     MOVELADCHK2    SPT2
     C                     MOVELADCHK3    SPT3
     C                     MOVELADCHK4    SPT4
     C                     MOVELADCHK5    SPT5
      *
      *
      *................................................................
      *
     C           EXTPSR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 15 *
     C                     Z-ADD15        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD1         DEPBIN
     C                     Z-ADD1         DETBIN
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *                                                                                       CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
      *
      **  Output PF/CGUDTAPD Record.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 16 *
     C                     Z-ADD16        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
     C                     ENDIF                                                              CCG015
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELBRCA      DRBRCA
     C                     MOVELORBR      DRORBR
     C                     MOVEL'FT'      DRMODI
     C                     MOVELPREF      DRMTRN
      *
      **  Midas Account Identifier
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRCA
     C                     MOVEL#RETLN    DRMACT
     C                     MOVEL'N'       DRATRM
     C                     MOVEL#TEXT1    DRPTYP
     C                     MOVEL#TEXT2    DRPSTP
      *
     C                     MOVELCNUM      ##CUST
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *                                                                                       CCG015
      ** Pass reference as printtype:subtype                                                  CCG015
     C           DRPTYP    CAT  ':':0     WCOLON 11 P                                         CCG015
     C           WCOLON    CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **         IN THE DATAAREA RUNDAT
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
      *                                                                   CEU006
      ** Access Switchable Features file to check for CEU006              CEU006
      *                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C                     PARM           DSFDY                           CEU006
     C                     SELEC                                          CEU006
     C           @RTCD     WHEQ *BLANK                                    CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C           @RTCD     WHEQ '*NRF'                                    CEU006
     C                     MOVE 'N'       CEU006                          CEU006
     C                     OTHER                                          CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      ** Determine if Correspondence Manager Phase 1 Development                              CCG015
      ** on iSeries is installed                                                              CCG015
      *                                                                                       CCG015
     C                     MOVE 'N'       CCG015  1                                           CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD   7                                           CCG015
     C                     PARM '*VERIFY' POPTN   7                                           CCG015
     C                     PARM 'CCG015'  PSARD   6                                           CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
     C           PRTCD     IFNE *BLANKS                                                       CCG015
     C           PRTCD     ANDNE'*NRF    '                                                    CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL '  W0KEY                                               CCG015
     C                     Z-ADD19        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C           PRTCD     IFEQ *BLANKS                                                       CCG015
     C                     MOVE 'Y'       CCG015                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C/COPY WNCPYSRC,CG4960C002
     C*
      *
      *................................................................
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      *                                                                                       CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCMTSK  1                                           CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   PRTCD                                               CSC022
     C                     PARM '*VERIFY' POPTN                                               CSC022
     C                     PARM 'CSC022'  PSARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           PRTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C                     MOVE 'N'       WCMTSK                                              CSC022
      *                                                                                       CSC022
     C                     IN   WDSJOB                                                        CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
     C                     Z-ADD1         I       20                                          CSC022
      *                                                                                       CSC022
     C           ##JOB     LOKUPWCMT,I                   51                                   CSC022
     C           *IN51     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ELSE                                                               CSC022
     C           PRTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD21        W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C************NAMVAR   DEFN           WDSJOB                                       CSC022BUG2330
     C           *NAMVAR   DEFN SCCMTJOB  WDSJOB                                             BUG2330
      *                                                                                       CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C*
     C                     MOVE *BLANKS   ZTABKY 12
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      KEY4    4
     C                     MOVE '1'       KEY4
     C                     MOVE KEY4      ZTABKY
     C*
     C           ZTABKY    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     MOVEL'TABTG10 'W0FILE
     C                     MOVELZTABKY    W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
      *
      **  Attempt to obtain customer number.
      *
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE RBKT      SPTP
     C                     MOVE RBK1      SPT1
     C                     MOVE RBK2      SPT2
     C                     MOVE RBK3      SPT3
     C                     MOVE RBK4      SPT4
     C*
     C                     SETON                     60
     C                     EXSR SRTPSR
     C                     SETOF                     60
      *
     C                     MOVELW0CNUM    CNUM
      *                                                                                       CCG015
      ** Initialize context for new extraction                                                CCG015
     C                     EXSR INIXML                                                        CCG015
      *
     C           EXINZ     TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
      /EJECT                                                                                  CCG015
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
      *AMTADD0001 AMT_ADD_1  AmountL     085712
      *AMTADD0002 AMT_ADD_2  AmountL     085712
      *AMTADD0003 AMT_ADD_3  AmountL     085712
      *AMTADD0004 AMT_ADD_4  AmountL     085712
      *AMTADD0005 AMT_ADD_5  AmountL     085712
      *AMTADD0006 AMT_ADD_6  AmountL     085712
** ##GRP/##RDE
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
BOOK  0001 BOOK_CODE
BOOK  0002 BOOK_DESC
PROF_C0001 PROF_CENT
PROF_C0002 PROF_C_DSC
FT_USR0001 USR_INP_1
FT_USR0002 USR_INP_2
FT_USR0003 USR_AUT_1
FT_USR0004 USR_AUT_2
FT_USR0005 UINP1_DESC
FT_USR0006 UINP2_DESC
FT_USR0007 UAUT1_DESC
FT_USR0008 UAUT2_DESC
PAYMNT0001 PAY_REF
PAYMNT0002 VALUE DATE Date
PAYMNT0003 PRINT_DATE Date
PAYMNT0004 PAY_TYPE
PAYMNT0005 PAY_S_TYPE
PAYMNT0006 PAY_ST_DSC
PAYMNT0007 SETTLEMOD                                                      095577
CR_CCY0001 CR_CCY
CR_CCY0002 CR_CCY_NAM
CR_CCY0003 CR_AMOUNT  AmountL
CR_CCY0004 CHQ_NUMBER
CR_CCY0005 CHQ_SEQ_NO
CR_CCY0006 CR DATE    Date                                                095577
CORDTA0001 COR_TYPE                      Information Type
CORDTA0002 COR_CUST                      Customer
CORDTA0003 COR_CUSNAM                    Customer Name
CORDTA0004 COR_CUSTWN                    Customer Town
CORDTA0005 COR_AC_LIN                    Account line
CORDTA0006 COR_RET_NO                    Retail AC No.
CORDTA0007 COR_ACCT                      Midas Account Identifier
CORDTA0008 COR_AC_NAM                    Account name
CORDTA0009 COR_SWIFT                     SWIFT ID
CORDTA0010 COR_ADDR_1                    Address line 1
CORDTA0011 COR_ADDR_2                    Address line 2
CORDTA0012 COR_ADDR_3                    Address line 3
CORDTA0013 COR_ADDR_4                    Address line 4
CORDTA0014 COR_ADDR_5                    Address line 5
B_TO_B0001 BK_TO_BK_1
B_TO_B0002 BK_TO_BK_2
B_TO_B0003 BK_TO_BK_3
B_TO_B0004 BK_TO_BK_4
B_TO_B0005 BK_TO_BK_5
B_TO_B0006 BK_TO_BK_6
AMTADD0001 AMT_ADD_1                                                      084929
AMTADD0002 AMT_ADD_2                                                      084929
AMTADD0003 AMT_ADD_3                                                      084929
AMTADD0004 AMT_ADD_4                                                      084929
AMTADD0005 AMT_ADD_5                                                      084929
AMTADD0006 AMT_ADD_6                                                      084929
AMTADD0007 AMT_SUB_1  AmountL
FT_DLV0001 PAY_DLVCCY                                                     CEU006
FT_DLV0002 PAY_DLVAMT AmountL                                             CEU006
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
