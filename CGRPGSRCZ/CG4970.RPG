     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG FT Mail Payment Orders - outgoing pays')      *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG4970 - FT Mail Payment Orders - Outgoing Pays              *
     F*                                                               *
     F*  Function:  This program xxxxxxxxxxxxxxxxxxxxxxxxxxxx         *
     F*  (phase(s))                                                   *
     F*                                                               *
     F*  Called By: mmCnnnn - (program name)                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CFT120             Date 28Sep12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG15105           Date 23Oct07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CFT032             Date 11Sep06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9646            Date 20Dec05               *
      *                 BUG2330            Date 29Apr04               *
      *                 TDA035             Date 02Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CFT009             Date 01Jun00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 175479             Date 16Feb00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CEU006             DATE 07APR98               *
     F*                 095577             DATE 07NOV95               *
     F*                 087995             DATE 11MAY95               *
     F*                 086382             DATE 18APR95               *
     F*                 085775             DATE 05APR95               *
     F*                 086182             DATE 31MAR95               *
     F*                 086177             DATE 30MAR95               *
     F*                 S01522             DATE 13JAN95               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CFT120 - FT IN/OP - Charges to DR of Account Currency        *
      *  BUG15105 - Missing Process for SWIFT 2007                    *
      *  CFT032 - Account line in field 50X in MT103                  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9646- Changes in CGPACKE causes programs not to compile   *
     F*  BUG2330- CG programs looking at wrong dataarea for CSC022    *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CCG015 - Correspondence Manager Phase 1                      *
     F*  CFT009 - FT Fees and Charge Development-Recompiled           *
     A*  175479 - Incorporate Fontis : dealer's reference             *
     A*           Recompiled due to changes in file OTPAYDD.          *
     F*  CEU006 - EMU Funds Transfer Payments and Settlements:        *
     F*           added new group set FT_EMU to existing group set    *
     F*           MAPO01. FT_EMU is linked to new group sets          *
     F*           FT_DLV, CHGENT and CHGEUR.                          *
     F*  095577 - Add new RDEs                                        *
     F*           CR DATE Credit Date                                 *
     F*           DR DATE Dedit Date                                  *
     F*           SETTLE MOD Settlement Method                        *
     F*  087995 - Remove *DBERR from AOCURRR0 call                    *
     F*           Correct Currency as parameter                       *
     F*  086382 - Do not call A0PRFCR0 if profit center blank.        *
     F*  085775 - Change customer report town from 10A to 35A         *
     F*  086182 - Correct Print Sub-type to Cheques                   *
     F*  086177 - Move generation so not print can be set             *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*                                                               *
     F*                                                               *
     F*  99   -    General work indicator                             *
     F*                                                               *
     F*****************************************************************
     FTABFP   IF  E           K        DISK
     F            TABTB11F                          KIGNORE
     F            TABTB20F                          KIGNORE
     F            TABTG20F                          KIGNORE
     F            TABLETHF                          KIGNORE
     F            TABLETPF                          KIGNORE
     F            TABLETRF                          KIGNORE
     F            TABLET5F                          KIGNORE
     F            TABTE10F                          KIGNORE
     FMUSER   IF  E           K        DISK
     F/SPACE 5
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
      *                                                                                       CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      *                                                                                       CSC022
     E                    WCMT       10 10                                                    CSC022
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E* ##GRP = Group/RDE Number               ##RDEA = RDE + Attributes
     E*
     E***********         ##GRP   1  78 10   ##RDEA 22                    095577
     E/COPY WNCPYSRC,CG4970E001
     E***********         ##GRP   1  81 10   ##RDEA 22              095577CEU006
     E***********         ##GRP   1 115 10   ##RDEA 22                                 CEU006 CFT120
     E                    ##GRP   1 117 10   ##RDEA 22                                        CFT120
     E/COPY WNCPYSRC,CG4970E002                                                               CFT120
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E**  Copyright array.
     E                    ##CPY   1   1 80
     I*
     I            DS
     I                                    B   1   20##OSEQ
     I**  Convert Ouput Sequence between Numeric and Binary
     I*
     I            DS
     I                                        1  10 ##GRPX
     I                                        1   6 ##GRPS
     I                                        7  100##RDEN
     I**  Look-up string for RDE definition Array
     I*
     I##SDS       DS
     I**********                              15120 ##S                                      BUG9646
     I                                        15632 ##S                                      BUG9646
     I**  Packed data string.
     I*
     I            DS
     I                                        1  20 ##W
     I                                        1  200##WNUM
     IWDSJOB    E DSSCCMTJOB                                                                  CSC022
     I              COMITNUM                        WCMTNO                                    CSC022
     I              COMITJOB1                       WJOB01                                    CSC022
     I              COMITJOB2                       WJOB02                                    CSC022
     I              COMITJOB3                       WJOB03                                    CSC022
     I              COMITJOB4                       WJOB04                                    CSC022
     I              COMITJOB5                       WJOB05                                    CSC022
     I              COMITJOB6                       WJOB06                                    CSC022
     I              COMITJOB7                       WJOB07                                    CSC022
     I              COMITJOB8                       WJOB08                                    CSC022
     I              COMITJOB9                       WJOB09                                    CSC022
     I              COMITJOB10                      WJOB10                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      *                                                                                       CSC022
     I**  Number Field
     I*
     I            DS
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I*
     I#RETLN      DS
     I**********                              1   60##CNUM                                    CSD027
     I                                        1   6 ##CNUM                                    CSD027
     I                                        7   9 ##CCY
     I**********                             10  130##ACOD                                    CGL029
     I**********                             14  150##ACSQ                                    CGL029
     I**********                             16  18 ##BRCA                                    CGL029
     I                                       10  190##ACOD                                    CGL029
     I                                       20  210##ACSQ                                    CGL029
     I                                       22  24 ##BRCA                                    CGL029
     I            DS
      *
      * Data Structure redefining Address fields
      *
     I                                        1 210 ADDRSS
     I                                        1  35 ADCHK1
     I                                       36  70 ADCHK2
     I                                       71 105 ADCHK3
     I                                      106 140 ADCHK4
     I                                      141 175 ADCHK5
     I                                      176 210 ADCHK6
      *
      * Blank Line Analysis data structure
      *
     I                                       36 210 ADCH26
     I                                       71 210 ADCH36
      *
      * SWIFT Address Analysis data structure
      *
     I                                        1   1 ADSLSH
     I                                        1  11 ADSWFT
     I                                       12  35 ADEXSW
     I                                       36  36 ADSLS2
     I                                       36  46 ADSWF2
     I                                       47  70 ADEXS2
      *
      * Customer Analysis data structure
      *
     I                                        1  10 ADCUST
     I                                       11  35 ADEXCS
     I                                        1   6 ADCNUM
     I                                        7  35 ADEXCN
     I                                       36  45 ADCUS2
     I                                       46  70 ADXCS2
     I                                       36  41 ADCNM2
     I                                       42  70 ADXCN2
      *
      * Account Analysis data structure FULL Account
      *
     I                                        1   6 ADGCNM
     I                                        7   9 ADGCCY
     I**********                             10  13 ADGACD                                    CGL029
     I**********                             14  15 ADGASQ                                    CGL029
     I**********                             16  18 ADGBRC                                    CGL029
     I**********                             16  35 ADEXG1                                    CGL029
     I**********                             19  35 ADEXGL                                    CGL029
     I                                       10  19 ADGACD                                    CGL029
     I                                       20  21 ADGASQ                                    CGL029
     I                                       22  24 ADGBRC                                    CGL029
     I                                       22  35 ADEXG1                                    CGL029
     I                                       25  35 ADEXGL                                    CGL029
      *
      * Partial Account Analysis data structure
      *
     I                                        1   6 ADPCNM
     I**********                              7  10 ADPACD                                    CGL029
     I**********                             11  12 ADPASQ                                    CGL029
     I**********                             13  15 ADPBRC                                    CGL029
     I**********                             13  35 ADEXP1                                    CGL029
     I**********                             16  35 ADEXPA                                    CGL029
     I                                        7  16 ADPACD                                    CGL029
     I                                       17  18 ADPASQ                                    CGL029
     I                                       19  21 ADPBRC                                    CGL029
     I                                       19  35 ADEXP1                                    CGL029
     I                                       22  35 ADEXPA                                    CGL029
      *
      * Nostro Number Account Analysis data structure
      *
     I                                        1   2 ADNOSN
     I                                        3  35 ADEXNN
      *
      * Nostro Account Analysis data structure
      *
     I                                        1   5 ADFNOS
     I                                        1   3 ADFCCY
     I                                        4   5 ADFNNB
     I                                        6  35 ADFNEX
      *
      * Retail Account Analysis data structure
      *
     I                                        1  10 ADACNO
     I                                       11  35 ADEXAC
      *
     I            DS
      *
      * Data Structure redefining Partial Account
      *
     I**********                              1  12 PTACCT                                    CGL029
     I                                        1  18 PTACCT                                    CGL029
     I                                        1   6 PTCNUM
     I**********                              7  10 PTACOD                                    CGL029
     I**********                             11  12 PTACSQ                                    CGL029
     I                                        7  16 PTACOD                                    CGL029
     I                                       17  18 PTACSQ                                    CGL029
      *
     IDSSDY     E DSDSSDY                                                 S01194
     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                       S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I* DS FOR CURRENCIES DETAILS                                         S01194
     ISDBRCH    E DSSDBRCHPD                                              S01194
     I* DS FOR BRANCH DETAILS                                             S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I* DS FOR BANK DETAILS                                               S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I*                                                                   S01194
     ISDBOOK    E DSSDBOOKPD                                              S01194
     I*                                                                   S01194
     ISDPRFC    E DSSDPRFCPD                                              S01194
     I* DS FOR PROFIT CENTRE DETAILS                                      S01194
     I*                                                                   CEU006
     ISDGELR    E DSSDGELRPD                                              CEU006
     I* DS for GL ICD Details                                             CEU006
     I*                                                                   CEU006
     ISDFTFR    E DSSDFTFRPD                                              CEU006
     I* DS for FT ICD Details                                             CEU006
     I*                                                                   S01194
     I** RECORD FORMATS FOR ACCESS TO BOOK DETAILS                        S01194
     I*                                                                   S01194
     ISDDLST    E DSSDDLSTPD                                              S01194
     I* DS FOR DEAL SUBTYPE DETAILS                                       S01194
      *                                                                                       CCG015
     ISCSARD    E DSSCSARDPD                                                                  CCG015
      ** DS for SAR details                                                                   CCG015
     I              LCD                             WSCLCD                                    CCG015
      *                                                                                       CCG015
     I##UDCR    E DSCGUDCRPD
      ** External DS for incomplete reference
     IDSPARM    E DSOTPAYDD
     I##SRDT      DS                         20
      **  DS to store subroutine specific data.
      **  - Saved Path
     I                                        1  70 ##SPAT
     I/COPY CGCPYSRC,CGPACKI
      *
     ICPYR        DS
      **  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
      *
      *    STANDARD LOCAL DATA AREA FIELDS
      *
     IRUNDT       DS
      *  DATA AREA RUNDAT
      *
      *
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     IW8FT        DS                            256                       S01435
      *                                                                   S01435
      * Address data structure                                            S01435
      *                                                                   S01435
      * Currency                                                          S01435
     I                                        1   3 W8CCY                 S01435
      * Settlement Type                                                   S01435
     I                                        4   5 W8STMT                S01435
      * Mandatory Text - convert BIC identifiers                          S01435
     I                                        6   6 W8MTXT                S01435
      * Message Tag                                                       S01435
     I                                        7  11 W8MTAG                S01435
      * Construct of data in field                                        S01435
     I                                       12  12 W8TYPE                S01435
      * Number of Lines available                                         S01435
     I                                       13  140W8NLIN                S01435
      * Network and Message Type                                          S01435
     I                                       15  20 W8NWRK                S01435
     I                                       21  23 W8MTPY                S01435
      * Calling Program                                                   S01435
     I                                       24  33 W8CPGM                S01435
      * Action *PRINT/*ENQ/*MSG GEN                                       S01435
     I                                       34  41 W8ACT                 S01435
      * Critical reporting - Database error if 'Y'                        S01435
      * If no BIC directory and BIC entered no error                      S01435
     I                                       42  42 W8CRIT                S01435
      * Force Midas Address - where possible                              S01435
     I                                       43  43 W8MADD                S01435
      * If Retail get first address from account                          S01435
     I                                       44  44 W8RTAD                S01435
      * Alternative Address                                               S01435
     I                                       45  45 W8ALTN                S01435
      * Address type selected in W0MSG                                    S01435
     I                                       46  46 W8ADTP                S01435
      * Customer number
     I**********                             47  520W0CNUM                                    CSD027
     I                                       47  52 W0CNUM                                    CSD027
      * Retail Account number
     I                                       53  620W0ACNO
      * Currency
     I*****************                      63  650W#CCY                 087995
     I                                       63  65 W#CCY                 087995
      * Account Code
     I**********                             66  690W0ACOD                                    CGL029
     I                                       66  690QQACOD                                    CGL029
      * Account Sequence
     I                                       70  710W0ACSQ
      * Account Name
     I                                       72 101 W0ANAM
      * Branch
     I                                      102 104 W0BRCA
      * Customer name
     I                                      105 124 W0CRNM
      * Customer SWIFT I.D
     I                                      125 136 W0CSID
      * Customer account line
     I                                      137 171 W0ACLN
      * Customer report town
     I************                          172 181 W0RTWN                085775
     I                                      172 206 W0RTWN                085775
     I                                      207 2160W0ACOD                                    CGL029
     IW0FMT     E DSCGUDTAPD
      **  Record format of PF/CGUDTAPD for use as a parameter
      *                                                                   CEU006
     I/COPY FTCPYSRC,FT0010I001                                           CEU006
      **  Input/output parameters for call to FT0010.                     CEU006
      *
     I*---------------------------------------------------------------------
     I* Named constants
     I              'FT_MAIL   '          C         #TEXT1
     I**************'CHQ_TO_PAY'          C         #TEXT2                086177
     I              'OUT_PAY   '          C         #TEXT2                086177
     I/COPY CGCPYSRC,SRERRI
      *****************************************************************
      * Process     :  MAINLINE                                       *
      * Function    :  Mainline processing                            *
      *                                                               *
      * Called by   :  None                                           *
      * Calls       :  SRINIT - Initial Processing - On First Call    *
      *                SRINZ  - Initialise Fields on Each Invocation  *
      *                SRMAIN - Main Processing                       *
      *****************************************************************
      *
      **  Parameter list for current program invocation.
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           DSPARM
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
      *
      *................................................................
      *
      **  Initial processing - Once Only
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
      *
      **  Initialisation processing
     C                     EXSR SRINZ
      *
     C* Try to generate record if customer                                086177
     C********** CNUM      IFNE *ZEROS                                                 086177 CSD027
     C           CNUM      IFNE *BLANKS                                                       CSD027
     C                     EXSR SRGENR                                    086177
     C                     ENDIF                                          086177
      **  Main processing
     C********** CNUM      IFNE *ZEROS                                                        CSD027
     C           CNUM      IFNE *BLANKS                                                       CSD027
     C           ##RTCD    ANDNE'CGD1270'                                 086177
     C                     EXSR SRMAIN
     C                     ELSE
     C                     MOVEL'*NOPRNT' W0RTN
     C                     ENDIF
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      **  Terminate program
     C                     RETRN
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRMAIN                                         *
      * Function    :  Main processing                                *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRMAIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
      *
      *................................................................
      *
     C***********          EXSR SRGENR                                    086177
      *
     C                     EXSR MAPO01
      *
      *................................................................
      *
     C           EXMAIN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  MAPO01                                         *
      * Function    :  Mail transfers - Cheques                       *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           MAPO01    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'MAPO01'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\MAPO01' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Store Path
     C           1         OCUR ##SRDT
     C                     MOVELS#PATH    ##SPAT
      *
      **  Branch Details
     C                     EXSR BRANCH
      *
      **  Book Details
     C                     EXSR BOOK
      *
      **  Profit Centre Details
     C                     EXSR PROF@C
      *
      **  FT Transaction Users
     C                     EXSR FT@USR
      *
      **  Payment Main Data
     C                     EXSR PAYMNT
      *
      **  Payment Secondary data
     C                     EXSR PAY@II
      *
      **  Credit/Cheque Currency
     C                     EXSR CR@CCY
      *
      **  Debit Currency
     C                     EXSR DR@CCY
      *
      **  Ordering Customer Details
     C                     EXSR O@CUST
      *
      **  Ordering Institution
     C                     EXSR O@INST
      *
      **  Account with bank
     C                     EXSR AC@W@B
      *
      **  Beneficiary Details
     C                     EXSR BENEF
      *
      **  Destination Institution
     C                     EXSR DESTIN
      *
      **  Receiver's Correspondant
     C                     EXSR RECEVR
      *
      **  Sender's Correspondant
     C                     EXSR SENDER
      *
      **  Details of Payment
     C                     EXSR PAYDET
      *
      **  Bank to bank information
     C                     EXSR B@TO@B
      *
      **  Charges to the debit of
     C                     EXSR CG@DAC
      *
      **  If CEU006 - EMU FT Payments & Settlements - is on               CEU006
      **  then process group set FT_EMU.                                  CEU006
      *                                                                   CEU006
     C           CEU006    IFEQ 'Y'                                       CEU006
      *                                                                   CEU006
      **  Funds Transfer EMU Details                                      CEU006
     C                     EXSR FT@EMU                                    CEU006
      *                                                                   CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      *................................................................
      *
     C           EXPO01    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BRANCH                                         *
      * Function    :  Branch Details                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BRANCH    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BRANCH'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BRANCH' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Branch Details
      *
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG    '##RTCD
     C                     PARM '*KEY    '##OPTN
     C                     PARM BRCA      ##BRCD  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
      *
      ** DATABASE ERROR
      *
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBRCHPD'W0FILE
     C                     MOVELBRCA      W0KEY            ***************
     C                     Z-ADD1         W0ERNB           * DB ERROR 01 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Branch
     C                     MOVELA8BRCD    ##D,1
      *
      ** Branch Name
     C                     MOVELA8BRNM    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXBRCH    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BOOK                                           *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BOOK      BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BOOK  '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BOOK  ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Get Book Details
     C                     CALL 'AOBOOKR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BOKC      @BOKC   2                       S01194
     C           SDBOOK    PARM SDBOOK    DSFDY                           S01194
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDBOOKPD'W0FILE
     C                     MOVELBOKC      W0KEY            ***************
     C                     Z-ADD2         W0ERNB           * DB ERROR 02 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Book Code
     C                     MOVELBOKC      ##D,1
      *
      ** Book Description
     C                     MOVELBDBKD     ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOK      TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PROF@C                                         *
      * Function    :  Book Details                                   *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PROF@C    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PROF_C'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PROF_C' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *                                                                   086382
      **  Bypass if profit center blank.                                  086382
     C           PRFC      IFEQ *BLANKS                                   086382
     C                     GOTO EXOF@C                                    086382
     C                     ENDIF                                          086382
      *
      **  Obtain Profit Centre details
     C                     CALL 'AOPRFCR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PRFC      @KEY    4
     C           SDPRFC    PARM SDPRFC    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDPRFCPD'W0FILE
     C                     MOVELPRFC      W0KEY            ***************
     C                     Z-ADD3         W0ERNB           * DB ERROR 03 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      ** Profit Centre
     C                     MOVELPRFC      ##D,1
      *
      ** Profit Centre Description
     C                     MOVELDSPCDS    ##D,2
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXOF@C    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  FT@USR                                         *
      * Function    :  FT Transaction Users                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           FT@USR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'FT_USR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\FT_USR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      ** Input User 1
     C                     MOVELINUSR1    ##D,1
      *
      ** Input User 2
     C                     MOVELINUSR2    ##D,2
      *
      ** Authorising User 1
     C                     MOVELAUP1      ##D,3
      *
      ** Authorising User 2
     C                     MOVELAUP2      ##D,4
      *
      ** Input User 1 Description.
     C           INUSR1    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,5
     C                     ENDIF
      *
      ** Input User 2 Description.
     C           INUSR1    IFNE INUSR2
     C           INUSR2    CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,6
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,7
     C                     ENDIF
      *
      ** Authorising User 1 Description.
     C           AUP1      IFNE AUP2
     C           AUP2      CHAINMUSER                98
     C           *IN98     IFEQ *OFF
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
     C                     ELSE
     C                     MOVELUSER1     ##D,8
     C                     ENDIF
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@USR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAYMNT                                         *
      * Function    :  Payment - Main data                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAYMNT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAYMNT'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAYMNT' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Payment Reference
     C                     MOVELPREF      ##D,1
      *
      **  Value Date
     C                     MOVELPVDT      ##D,2
      *
      **  Payment Date
     C                     MOVELBJRDNB    ##D,3
      *
      **  Payment Type
     C                     MOVELPYTP      ##D,4
      *
      **  Payment Sub-Type
     C                     MOVELPYST      ##D,5
      *
      **  Obtain Payment Sub-Type Description
     C                     CALL 'AODLSTR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM PYST      @AQCD   3
     C           SDDLST    PARM SDDLST    DSFDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDDLSTPD'W0FILE
     C                     MOVELPYST      W0KEY            ***************
     C                     Z-ADD4         W0ERNB           * DB ERROR 04 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **  Payment Sub-Type Description
     C                     MOVELASDSTN    ##D,6
      *                                                                   095577
      * Set up Settle Method                                              095577
      *                                                                   095577
     C                     MOVELSTMT      ##D,7                           095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXYMNT    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAY@II                                         *
      * Function    :  Payment - Secondary Data                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAY@II    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAY_II'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAY_II' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Payment Exchange rate
     C                     MOVELRATE      ##D,1
      *
      **  Ascertain the correct currency code.
     C           *LIKE     DEFN ##CCY     #CCY
     C********** CDRO      IFNE *ZEROS                                                        CFT120
     C           CDRO      IFNE *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ELSE
     C           ADDC      IFEQ 'A'
     C                     MOVELSMCY      #CCY
     C                     ELSE
     C                     MOVELPCCY      #CCY
     C                     ENDIF
     C                     ENDIF
      *
      **  Charge currency
     C                     MOVEL#CCY      ##D,2
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM #CCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVEL#CCY      W0KEY            ***************
     C                     Z-ADD9         W0ERNB           * DB ERROR 09 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4970C001
      *
      **  Add/Deduct Flag
     C                     MOVELADDC      ##D,3
      *
      **  Transfer Commission
     C                     MOVELTRCM      ##D,4
     C/COPY WNCPYSRC,CG4970C005
     C                     MOVE A6NBDP    ##D,4
      *
      **  FX/Charge Commission
     C                     MOVELOPCHCM    ##D,5
     C/COPY WNCPYSRC,CG4970C006
     C                     MOVE A6NBDP    ##D,5
      *
      **  Telex Charge
     C                     MOVELTXCH      ##D,6
     C/COPY WNCPYSRC,CG4970C007
     C                     MOVE A6NBDP    ##D,6
      *
      **  Cheque Charge
     C                     MOVELCQCH      ##D,7
     C/COPY WNCPYSRC,CG4970C008
     C                     MOVE A6NBDP    ##D,7
      *
      **  Costs Abroad
     C                     MOVELCSTA      ##D,8
     C/COPY WNCPYSRC,CG4970C009
     C                     MOVE A6NBDP    ##D,8
      *
      **  SWIFT priority charge
     C                     MOVELSPCH      ##D,9
     C/COPY WNCPYSRC,CG4970C010
     C                     MOVE A6NBDP    ##D,9
      *
      **  Miscellaneous charge
     C                     MOVELMSCH      ##D,10
     C/COPY WNCPYSRC,CG4970C011
     C                     MOVE A6NBDP    ##D,10
      *
      **  VAT
     C                     MOVELOPVATT    ##D,11
     C/COPY WNCPYSRC,CG4970C012
     C                     MOVE A6NBDP    ##D,11
      *
      **  Total Charge
     C           *LIKE     DEFN TXCH      #W110A
     C           *LIKE     DEFN TXCH      #W110B
     C           *LIKE     DEFN TXCH      #W110C
     C           *LIKE     DEFN TXCH      #W110D
     C                     Z-ADD*ZEROS    #W110A
     C                     Z-ADD*ZEROS    #W110B
     C                     Z-ADD*ZEROS    #W110C
     C                     Z-ADD*ZEROS    #W110D
     C           TRCM      ADD  OPCHCM    #W110A
     C           TXCH      ADD  CQCH      #W110B
     C           CSTA      ADD  SPCH      #W110C
     C           #W110C    ADD  MSCH      #W110C
     C           #W110A    ADD  #W110B    #W110D
     C           #W110D    ADD  #W110C    #W110D
     C                     MOVEL#W110D    ##D,12
     C/COPY WNCPYSRC,CG4970C013
     C                     MOVE A6NBDP    ##D,12
      *
      **  Net Amount
     C           *LIKE     DEFN #W110D    #NETA
     C                     Z-ADD*ZEROS    #NETA
      *
     C********** CDRO      IFNE *ZEROS                     B1                                 CFT120
     C           CDRO      IFNE *BLANKS                    B1                                 CFT120
     C           ADDC      IFEQ 'A'                        B*2
     C                     Z-ADDSMAM      #NETA
     C                     ELSE                            X*2
     C                     Z-ADDPYAM      #NETA
     C                     ENDIF                           E*2
     C                     ELSE                            X1
     C           ADDC      IFEQ 'A'                        B*2
     C           SMAM      ADD  #W110D    #NETA
     C                     ELSE                            X*2
     C           PYAM      SUB  #W110D    #NETA
     C                     ENDIF                           E*2
     C                     ENDIF                           E1
      *
     C                     MOVEL#NETA     ##D,13
     C/COPY WNCPYSRC,CG4970C014
     C                     MOVE A6NBDP    ##D,13
      *
      **  Details of charges
     C                     MOVELDTCH      ##D,14
      *
      **  Related Reference
     C                     MOVELRLPR      ##D,15
      *
      **  Collection Charge
     C                     MOVE *BLANKS   ##D,16
      *
      **  Telephone Charge
     C                     MOVE *BLANKS   ##D,17
      *
      **  Advice Charge
     C                     MOVE *BLANKS   ##D,18
      *
      **  Deductions
     C                     MOVEL*BLANKS   ##D,19
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXY@II    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SR@CCY                                         *
      * Function    :  Credit/Cheque Currency                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CR@CCY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CR_CCY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CR_CCY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Credit Cheque/Currency
     C                     MOVELPCCY      ##D,1
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM PCCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELPCCY      W0KEY            ***************
     C                     Z-ADD5         W0ERNB           * DB ERROR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4970C002
      *
      **  Credit/Cheque Currency Name
     C                     MOVELA6CYNM    ##D,2
      *
      **  Credit/Cheque Amount
     C                     MOVELPYAM      ##D,3
     C/COPY WNCPYSRC,CG4970C015
     C                     MOVE A6NBDP    ##D,3
      *
      **  Cheque Number
     C                     MOVE *BLANKS   ##D,4
      *
      **  Cheque Sequence Number
     C                     MOVE *BLANKS   ##D,5
      *                                                                   095577
      * Set up Credit Date                                                095577
      *                                                                   095577
     C                     MOVELPVDT      ##D,6                           095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@CCY    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DR@CCY                                         *
      * Function    :  Debit Currency                                 *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           DR@CCY    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DR_CCY'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\DR_CCY' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Debit Currency
     C                     MOVELSMCY      ##D,1
      *
      **  Obtain currency details
     C                     CALL 'AOCURRR0'
     C***********          PARM '*DBERR'  @RTCD   7                       087995
     C                     PARM *BLANKS   @RTCD   7                       087995
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SMCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
      *
      ** DATABASE ERROR
      *
     C           @RTCD     IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVELSMCY      W0KEY            ***************
     C                     Z-ADD6         W0ERNB           * DB ERROR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C/COPY WNCPYSRC,CG4970C003
      *
      **  Debit Currency Name
     C                     MOVELA6CYNM    ##D,2
      *
      **  Debit Amount
     C                     MOVELSMAM      ##D,3
     C/COPY WNCPYSRC,CG4970C016
     C                     MOVE A6NBDP    ##D,3
      *                                                                   095577
      * Set up Dedit Date                                                 095577
      *                                                                   095577
     C                     MOVELSLDT      ##D,4                           095577
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@CC1    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CORDTA                                         *
      * Function    :  Correspondent data                             *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :                                                 *
      *****************************************************************
     C           CORDTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CORDTA'  @STK,Q
      *
      *................................................................
      *
      **  Set up Path.
     C                     MOVEL'\CORDTA' ##PNAM  7
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Correspondent type.
     C                     MOVEL#TYPE     ##D,1
      *
      **  Customer.
     C                     MOVELW0CNUM    ##D,2
      *
      **  Customer name.
     C                     MOVELW0CRNM    ##D,3
      *
      **  Customer town.
     C                     MOVELW0RTWN    ##D,4
      *
      **  Account line.
     C                     MOVELW0ACLN    ##D,5
      *
      **  Retail account no.
     C                     MOVELW0ACNO    ##D,6
      *
      **  Midas account number.
     C                     CLEAR#RETLN
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRCA
     C***********          MOVEL#RETLN    ##D,5                           087995
     C                     MOVEL#RETLN    ##D,7                           087995
      *
      **  Account name.
     C                     MOVELW0ANAM    ##D,8
      *
      **  SWIFT ID.
     C                     MOVELW0CSID    ##D,9
      *
      **  Address line 1.
     C                     MOVELSPT1      ##D,10
      *
      **  Address line 2.
     C                     MOVELSPT2      ##D,11
      *
      **  Address line 3.
     C                     MOVELSPT3      ##D,12
      *
      **  Address line 4.
     C                     MOVELSPT4      ##D,13
      *
      **  Address line 5.
     C                     MOVELSPT5      ##D,14
      *                                                                                       CFT120
      **  CFT120 Flag                                                                         CFT120
      *                                                                                       CFT120
     C           CFT120    IFEQ 'N'                                                           CFT120
     C                     MOVEL'N'       ##D,15                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVEL'Y'       ##D,15                                              CFT120
      *                                                                                       CFT120
      **  Charge to the Debit of Account Currency                                             CFT120
      *                                                                                       CFT120
     C           CDRO      IFNE *BLANKS                                                       CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    ##D,16                                              CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    ##D,16                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
     C                     ENDIF                                                              CFT120
      *
      *................................................................
      *
     C           EXRDTA    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  O@CUST                                         *
      * Function    :  Ordering Customer Details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           O@CUST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'O_CUST'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\O_CUST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
      *
     C                     MOVE ORCT      SPTP
     C                     MOVELSMCY      XCCY
     C           1         SUBSTORC1:1    WSLSH   1                                           CFT032
     C           WSLSH     IFEQ '/'                                                           CFT032
     C           ORCT      ANDEQ'R'                                                           CFT032
     C           WSLSH     OREQ '/'                                                           CFT032
     C           ORCT      ANDEQ'P'                                                           CFT032
     C           WSLSH     OREQ '/'                                                         BUG15105
     C           ORCT      ANDEQ'I'                                                         BUG15105
     C           34        SUBSTORC1:2    SPT1      P                                         CFT032
     C                     ELSE                                                               CFT032
     C                     MOVE ORC1      SPT1
     C                     ENDIF                                                              CFT032
     C                     MOVE ORC2      SPT2
     C                     MOVE ORC3      SPT3
     C                     MOVE ORC4      SPT4
     C                     MOVE ORC5      SPT5                                                CFT032
      *
     C                     EXSR SRTPSR
      *
      **  Ordering Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELORCT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCUST    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  O@INST                                         *
      * Function    :  Ordering Institution                           *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           O@INST    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'O_INST'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\O_INST' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
      *
     C                     MOVE ORBT      SPTP
     C                     MOVELSMCY      XCCY
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
      *
     C                     EXSR SRTPSR
      *
      **  Ordering Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELORBT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXINST    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  AC@W@B                                         *
      * Function    :  Account with Bank details                      *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           AC@W@B    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'AC_W_B'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\AC_W_B' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1   35
     C                     MOVE *BLANKS   SPT2   35
     C                     MOVE *BLANKS   SPT3   35
     C                     MOVE *BLANKS   SPT4   35
     C                     MOVE *BLANKS   SPT5   35
     C*
     C                     MOVE ACBT      SPTP    1
     C                     MOVE ACB1      SPT1
     C                     MOVE ACB2      SPT2
     C                     MOVE ACB3      SPT3
     C                     MOVE ACB4      SPT4
     C                     MOVE ACB5      SPT5
      *
     C                     EXSR SRTPSR
      *
      **  Account with bank Information Type
     C                     MOVE *BLANKS   #TYPE   1
     C                     MOVELACBT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@W@B    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  BENEF                                          *
      * Function    :  Beneficiary Details                            *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           BENEF     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'BENEF '  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\BENEF ' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE BNCT      SPTP
     C                     MOVELPCCY      XCCY
     C                     MOVE BNC1      SPT1
     C                     MOVE BNC2      SPT2
     C                     MOVE BNC3      SPT3
     C                     MOVE BNC4      SPT4
     C                     MOVE BNC5      SPT5
      *
     C                     EXSR SRTPSR
      *
      **  Beneficiary Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELBNCT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNEF     TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  DESTIN                                         *
      * Function    :  Destination Institution                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           DESTIN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'DESTIN'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\DESTIN' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE DSTT      SPTP
     C                     MOVE DST1      SPT1
     C                     MOVE DST2      SPT2
     C                     MOVE DST3      SPT3
     C                     MOVE DST4      SPT4
      *
     C                     SETON                     60
     C                     EXSR SRTPSR
     C                     SETOF                     60
      *
      **  Destination Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELDSTT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXSTIN    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  RECEVR                                         *
      * Function    :  Receiver's Correspondant                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           RECEVR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'RECEVR'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\RECEVR' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE RCRT      SPTP
     C                     MOVE RCO1      SPT1
     C                     MOVE RCO2      SPT2
     C                     MOVE RCO3      SPT3
     C                     MOVE RCO4      SPT4
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELRCRT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXCEVR    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SENDER                                         *
      * Function    :  Sender's Correspondant                         *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           SENDER    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SENDER'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\SENDER' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE SNCT      SPTP
     C                     MOVELSNCO      SPT1
     C                     MOVELPCCY      XCCY
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELSNCT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXNDER    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  PAYDET                                         *
      * Function    :  Details of Payment                             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           PAYDET    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'PAYDET'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\PAYDET' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Details of payment - 1
     C                     MOVELDTP1      ##D,1
      *
      **  Details of payment - 2
     C                     MOVELDTP2      ##D,2
      *
      **  Details of payment - 3
     C                     MOVELDTP3      ##D,3
      *
      **  Details of payment - 4
     C                     MOVELDTP4      ##D,4
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXYDET    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  B@TO@B                                         *
      * Function    :  Bank to bank information                       *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           B@TO@B    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'B_TO_B'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\B_TO_B' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL@STK,Q    ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
      *
      **  Bank to bank information - 1.
     C                     MOVELBBI1      ##D,1
      *
      **  Bank to bank information - 2.
     C                     MOVELBBI2      ##D,2
      *
      **  Bank to bank information - 3.
     C                     MOVELBBI3      ##D,3
      *
      **  Bank to bank information - 4.
     C                     MOVELBBI4      ##D,4
      *
      **  Bank to bank information - 5.
     C                     MOVELBBI5      ##D,5
      *
      **  Bank to bank information - 6.
     C                     MOVELBBI6      ##D,6
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EXTO@B    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  CG@DAC                                         *
      * Function    :  Charges to the debit of                        *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :                                                 *
      *****************************************************************
     C           CG@DAC    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'CG_DAC'  @STK,Q
      *
      *................................................................
      *
      **  Retrieve subroutine specific data.
     C           1         OCUR ##SRDT
     C                     MOVEL##SPAT    S#PATH
      *
      **  Set up Path.
     C                     MOVEL'\CG_DAC' ##PNAM
     C           S#PATH    CAT  ##PNAM:0  S#PATH
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *
      **  Retrieve RDE information for RDEs in group set
      *
     C                     MOVEL'CORDTA'  ##GRPS
     C                     Z-ADD1         ##RDEN
     C                     EXSR SRRRDE
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE ORBT      SPTP
     C                     MOVELSMCY      XCCY
      *
     C                     EXSR SRTPSR
      *
      **  Information Type
     C                     MOVE *BLANKS   #TYPE
     C                     MOVELORBT      #TYPE
      *
     C                     EXSR CORDTA
      *
      **  Accumulate RDE's and associated data and output to
      **  PF/CGUDTAPD.
     C                     EXSR SRADTA
     C                     EXSR SRODTA
      *
      *................................................................
      *
     C           EX@DAC    TAG
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  FT@EMU                                         *   CEU006
      * Function    :  Funds Transfer EMU Details                     *   CEU006
      *                                                               *   CEU006
      * Called by   :  MAPO01                                         *   CEU006
      * Calls       :  FT@DLV, CHGENT, CHGEUR.                        *   CEU006
      *****************************************************************   CEU006
     C           FT@EMU    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'FT_EMU'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Retrieve subroutine specific data.                              CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\FT_EMU' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Funds Transfer Delivery Details                                 CEU006
     C                     EXSR FT@DLV                                    CEU006
      *                                                                   CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
     C                     MOVEL'\FT_EMU' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                   CEU006
      **  Entered Charges                                                 CEU006
     C                     EXSR CHGENT                                    CEU006
      *                                                                   CEU006
     C           1         OCUR ##SRDT                                    CEU006
     C                     MOVEL##SPAT    S#PATH                          CEU006
     C                     MOVEL'\FT_EMU' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                   CEU006
      **  Euro Charges                                                    CEU006
     C                     EXSR CHGEUR                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@EMU    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  FT@DLV                                         *   CEU006
      * Function    :  Funds Transfer Delivery Details                *   CEU006
      *                                                               *   CEU006
      * Called by   :  FT@EMU                                         *   CEU006
      * Calls       :                                                 *   CEU006
      *****************************************************************   CEU006
     C           FT@DLV    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'FT_DLV'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\FT_DLV' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      **  Notified Delivery Currency                                      CEU006
      *                                                                   CEU006
     C           NDCY      IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM NDCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELNDCY      W0KEY            ***************CEU006
     C                     Z-ADD16        W0ERNB           * DB ERROR 16 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4970C017
      *                                                                   CEU006
     C                     MOVELNDCY      ##D,1                           CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,1                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Notified Delivery Amount                                        CEU006
     C           NDCY      IFNE *BLANKS                                   CEU006
     C                     MOVELNDAM      ##D,2                           CEU006
     C                     MOVE A6NBDP    ##D,2                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,2                           CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4970C018
      *                                                                   CEU006
      **  Pay Delivery Currency                                           CEU006
      *                                                                   CEU006
     C           PDCY      IFNE *BLANKS                                   CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM PDCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVELPDCY      W0KEY            ***************CEU006
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4970C019
      *                                                                   CEU006
     C                     MOVELPDCY      ##D,3                           CEU006
      *                                                                   CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,3                           CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Pay Delivery Amount                                             CEU006
     C           PDCY      IFNE *BLANKS                                   CEU006
     C                     MOVELPDAM      ##D,4                           CEU006
     C                     MOVE A6NBDP    ##D,4                           CEU006
     C                     ELSE                                           CEU006
     C                     MOVEL*BLANKS   ##D,4                           CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4970C020
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@DLV    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  CHGENT                                         *   CEU006
      * Function    :  Entered Charges                                *   CEU006
      *                                                               *   CEU006
      * Called by   :  FT@EMU                                         *   CEU006
      * Calls       :  EURAMT                                         *   CEU006
      *****************************************************************   CEU006
     C           CHGENT    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'CHGENT'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\CHGENT' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      **  Entered Currency                                                CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
     C********** CDRO      WHNE *ZEROS                                                 CEU006 CFT120
     C********** BTCHCY    OREQ 'B'                                                    CEU006 CFT120
     C           CDRO      WHNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C           OPCDRC    IFEQ *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                                                CFT120
     C                     ELSE                                                               CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C           CDRO      WHNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'N'                                                           CFT120
     C           BTCHCY    OREQ 'B'                                                           CFT120
     C                     MOVELBJCYCD    #CCY                            CEU006
     C           BTCHCY    WHEQ 'L'                                       CEU006
     C                     MOVELBJLCCY    #CCY                            CEU006
     C           BTCHCY    WHEQ 'C'                                       CEU006
     C           ADDC      ANDEQ'A'                                       CEU006
     C                     MOVELSMCY      #CCY                            CEU006
     C                     OTHER                                          CEU006
     C                     MOVELPCCY      #CCY                            CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN SLDT      W#DATE                          CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     MOVE SLDT      W#DATE                          CEU006
     C                     ELSE                                           CEU006
     C                     MOVE PVDT      W#DATE                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM #CCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD18        W0ERNB           * DB ERROR 18 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
     C/COPY WNCPYSRC,CG4970C021
      *                                                                   CEU006
      ** save entry currency as #ENTCY and In Ccy Indicator as #ENTIN     CEU006
      ** for use in subroutine CHGEUR.                                    CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      #ENTCY  3                       CEU006
     C                     MOVELA6INCY    #ENTIN  1                       CEU006
     C           A6TPSD    IFGT W#DATE                                    CEU006
     C                     MOVE 'N'       #ENTIN                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      ##D,1                           CEU006
      *                                                                   CEU006
      **  Entered Transfer Commission                                     CEU006
      *                                                                   CEU006
     C                     MOVELDUMA1     ##D,2                           CEU006
     C/COPY WNCPYSRC,CG4970C022
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Entered FX/Charge Commission                                    CEU006
      *                                                                   CEU006
     C                     MOVELOPDUM7    ##D,3                           CEU006
     C/COPY WNCPYSRC,CG4970C023
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Entered Telex Charge                                            CEU006
      *                                                                   CEU006
     C                     MOVELDUMA2     ##D,4                           CEU006
     C/COPY WNCPYSRC,CG4970C024
     C                     MOVE A6NBDP    ##D,4                           CEU006
      *                                                                   CEU006
      **  Entered Cheque Charge                                           CEU006
      *                                                                   CEU006
     C                     MOVELDUMA3     ##D,5                           CEU006
     C/COPY WNCPYSRC,CG4970C025
     C                     MOVE A6NBDP    ##D,5                           CEU006
      *                                                                   CEU006
      **  Entered Costs Abroad                                            CEU006
      *                                                                   CEU006
     C                     MOVELDUMA4     ##D,6                           CEU006
     C/COPY WNCPYSRC,CG4970C026
     C                     MOVE A6NBDP    ##D,6                           CEU006
      *                                                                   CEU006
      **  Entered SWIFT Charge                                            CEU006
      *                                                                   CEU006
     C                     MOVELDUMA5     ##D,7                           CEU006
     C/COPY WNCPYSRC,CG4970C027
     C                     MOVE A6NBDP    ##D,7                           CEU006
      *                                                                   CEU006
      **  Entered Collection Charge                                       CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,8                           CEU006
      *                                                                   CEU006
      **  Entered Telephone Charge                                        CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,9                           CEU006
      *                                                                   CEU006
      **  Entered Advice Charge                                           CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,10                          CEU006
      *                                                                   CEU006
      **  Entered Miscellaneous Charge                                    CEU006
      *                                                                   CEU006
     C                     MOVELDUMA6     ##D,11                          CEU006
     C/COPY WNCPYSRC,CG4970C028
     C                     MOVE A6NBDP    ##D,11                          CEU006
      *                                                                   CEU006
      **  Entered VAT Amount                                              CEU006
      *                                                                   CEU006
     C                     MOVELOPDUM8    ##D,12                          CEU006
     C/COPY WNCPYSRC,CG4970C029
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Entered Total Charge                                            CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN #W110D    ##W110                          CEU006
     C                     Z-ADD*ZEROS    ##W110                          CEU006
      *                                                                   CEU006
     C                     Z-ADDDUMA1     ##W110                          CEU006
     C           ##W110    ADD  OPDUM7    ##W110                          CEU006
     C           ##W110    ADD  DUMA2     ##W110                          CEU006
     C           ##W110    ADD  DUMA3     ##W110                          CEU006
     C           ##W110    ADD  DUMA4     ##W110                          CEU006
     C           ##W110    ADD  DUMA5     ##W110                          CEU006
     C           ##W110    ADD  DUMA6     ##W110                          CEU006
     C           ##W110    ADD  OPDUM8    ##W110                          CEU006
      *                                                                   CEU006
     C                     MOVEL##W110    ##D,13                          CEU006
     C/COPY WNCPYSRC,CG4970C030
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Entered Deductions                                              CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,14                          CEU006
      *                                                                   CEU006
      **  Entered Net Amount                                              CEU006
      *                                                                   CEU006
     C                     Z-ADD0         #NETA                           CEU006
     C           *LIKE     DEFN SMAM      ##SMAM                          CEU006
     C           *LIKE     DEFN PYAM      ##PYAM                          CEU006
      *                                                                   CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
      *                                                                   CEU006
      **** convert SMAM in SMCY to ##SMAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE SMCY      P#FRCY                          CEU006
     C                     Z-ADDSMAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##SMAM                          CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
      **** convert PYAM in PCCY to ##PYAM in #CCY                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE PCCY      P#FRCY                          CEU006
     C                     Z-ADDPYAM      P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    ##PYAM                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C********** CDRO      IFNE *ZEROS                                                 CEU006 CFT120
     C           CDRO      IFNE *BLANKS                                                       CFT120
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     Z-ADD##SMAM    #NETA                           CEU006
     C                     ELSE                                           CEU006
     C                     Z-ADD##PYAM    #NETA                           CEU006
     C                     ENDIF                                          CEU006
     C                     ELSE                                           CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C           ##SMAM    ADD  ##W110    #NETA                           CEU006
     C                     ELSE                                           CEU006
     C           ##PYAM    SUB  ##W110    #NETA                           CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#NETA     ##D,15                          CEU006
     C/COPY WNCPYSRC,CG4970C031
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@ENT    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  CHGEUR                                         *   CEU006
      * Function    :  Calculates Euro Charges:                       *   CEU006
      *                                                               *   CEU006
      *                Euro Charges are the interim euro amounts      *   CEU006
      *                resulting during the conversion of entered     *   CEU006
      *                charges from entry currency to charge currency.*   CEU006
      *                                                               *   CEU006
      * Called by   :  FT@EMU                                         *   CEU006
      * Calls       :  EURAMT                                         *   CEU006
      *****************************************************************   CEU006
     C           CHGEUR    BEGSR                                          CEU006
      *                                                                   CEU006
      **  Set up subroutine stack name                                    CEU006
     C                     ADD  1         Q                               CEU006
     C                     MOVEL'CHGEUR'  @STK,Q                          CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
      **  Set up Path.                                                    CEU006
     C                     MOVEL'\CHGEUR' ##PNAM                          CEU006
     C           S#PATH    CAT  ##PNAM:0  S#PATH                          CEU006
      *                                                                                       CCG015
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                   CEU006
      **  Retrieve RDE information for RDEs in group set                  CEU006
      *                                                                   CEU006
     C                     MOVEL@STK,Q    ##GRPS                          CEU006
     C                     Z-ADD1         ##RDEN                          CEU006
     C                     EXSR SRRRDE                                    CEU006
      *                                                                   CEU006
      ** Save Charge currency and its In Currency Indicator.              CEU006
      *                                                                   CEU006
     C********** CDRO      IFNE *ZEROS                                                 CEU006 CFT120
     C           CDRO      IFNE *BLANKS                                                       CFT120
     C                     MOVELBJCYCD    #CCY                            CEU006
     C           OPCDRC    IFNE *BLANKS                                                       CFT120
     C           CFT120    ANDEQ'Y'                                                           CFT120
     C                     MOVELOPCDRC    #CCY                                                CFT120
     C                     ENDIF                                                              CFT120
     C                     ELSE                                           CEU006
     C           ADDC      IFEQ 'A'                                       CEU006
     C                     MOVELSMCY      #CCY                            CEU006
     C                     ELSE                                           CEU006
     C                     MOVELPCCY      #CCY                            CEU006
     C                     ENDIF                                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM #CCY      @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD19        W0ERNB           * DB ERROR 19 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      #CHGCY  3                       CEU006
     C                     MOVELA6INCY    #CHGIN  1                       CEU006
     C           A6TPSD    IFGT W#DATE                                    CEU006
     C                     MOVE 'N'       #CHGIN                          CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      **  Determine the number of decimal places for Euro                 CEU006
      *                                                                   CEU006
     C                     CALL 'AOCURRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*KEY   ' @OPTN                           CEU006
     C                     PARM BKEURO    @AJCD                           CEU006
     C           SDCURR    PARM SDCURR    DSSDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
     C           @RTCD     IFNE *BLANK                                    CEU006
     C                     MOVEL'SDCURRPD'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD21        W0ERNB           * DB ERROR 21 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      ** Calculate the interim Euro amounts resulting from conversion     CEU006
      ** of charges from Entry Ccy #ENTCY to Charge Ccy #CHGCY.           CEU006
      **                                                                  CEU006
      ** First deal with case requiring #ENTCY -> Base -> Euro -> In:     CEU006
      **  #ENTCY is Out (not Base) and #CHGCY is In (not Base)            CEU006
      *                                                                   CEU006
     C                     SELEC                                          CEU006
      *                                                                   CEU006
     C           #ENTIN    WHNE 'Y'                                       CEU006
     C           #ENTCY    ANDNEBJCYCD                                    CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #CHGCY    ANDNEBJCYCD                                    CEU006
      *                                                                   CEU006
      **  Euro Currency                                                   CEU006
      *                                                                   CEU006
     C                     MOVELBKEURO    ##D,1                           CEU006
      *                                                                   CEU006
     C           *LIKE     DEFN P#FRAM    W#FRAM                          CEU006
      *                                                                   CEU006
      **  Interim Euro Transfer Commission                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA1     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,2                           CEU006
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Interim Euro FX/Charge Commission                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDOPDUM7    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,3                           CEU006
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telex Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA2     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,4                           CEU006
     C                     MOVE A6NBDP    ##D,4                           CEU006
      *                                                                   CEU006
      **  Interim Euro Cheque Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA3     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,5                           CEU006
     C                     MOVE A6NBDP    ##D,5                           CEU006
      *                                                                   CEU006
      **  Interim Euro Costs Abroad                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA4     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,6                           CEU006
     C                     MOVE A6NBDP    ##D,6                           CEU006
      *                                                                   CEU006
      **  Interim Euro SWIFT Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA5     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,7                           CEU006
     C                     MOVE A6NBDP    ##D,7                           CEU006
      *                                                                   CEU006
      **  Interim Euro Collection Charge                                  CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ##D,8                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telephone Charge                                   CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ##D,9                           CEU006
      *                                                                   CEU006
      **  Interim Euro Advice Charge                                      CEU006
      *                                                                   CEU006
     C                     MOVEL*BLANKS   ##D,10                          CEU006
      *                                                                   CEU006
      **  Interim Euro Miscellaneous Charge                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA6     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,11                          CEU006
     C                     MOVE A6NBDP    ##D,11                          CEU006
      *                                                                   CEU006
      **  Interim Euro VAT Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDOPDUM8    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,12                          CEU006
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Interim Euro Total Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD##W110    P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,13                          CEU006
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Interim Euro Deductions                                         CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,14                          CEU006
      *                                                                   CEU006
      **  Interim Euro Net Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#NETA     P#FRAM                          CEU006
     C                     MOVE BJCYCD    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     Z-ADDP#TOAM    W#FRAM                          CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE BJCYCD    P#FRCY                          CEU006
     C                     Z-ADDW#FRAM    P#FRAM                          CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,15                          CEU006
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
      ** Now deal with the other cases, these require #ENTCY -> Euro:     CEU006
      **  if #ENTCY is In  and #CHGCY is In , and #ENTCY is not #CHGCY;   CEU006
      **  or #ENTCY is In  and #CHGCY is Out, and #ENTCY is not Base;     CEU006
      **  or #ENTCY is Out and #CHGCY is In , and #CHGCY is not Base.     CEU006
      *                                                                   CEU006
     C           #ENTIN    WHEQ 'Y'                                       CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #ENTCY    ANDNE#CHGCY                                    CEU006
     C           #ENTIN    OREQ 'Y'                                       CEU006
     C           #CHGIN    ANDNE'Y'                                       CEU006
     C           #ENTCY    ANDNEBJCYCD                                    CEU006
     C           #ENTIN    ORNE 'Y'                                       CEU006
     C           #CHGIN    ANDEQ'Y'                                       CEU006
     C           #CHGCY    ANDNEBJCYCD                                    CEU006
      *                                                                   CEU006
      **  Set up Euro from GL ICD as currency to convert to.              CEU006
      *                                                                   CEU006
     C                     MOVE BKEURO    #CCY                            CEU006
      *                                                                   CEU006
      **  Euro Currency                                                   CEU006
      *                                                                   CEU006
     C                     MOVELBKEURO    ##D,1                           CEU006
      *                                                                   CEU006
      **  Interim Euro Transfer Commission                                CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA1     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,2                           CEU006
     C                     MOVE A6NBDP    ##D,2                           CEU006
      *                                                                   CEU006
      **  Interim Euro FX/Charge Commission                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDOPDUM7    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,3                           CEU006
     C                     MOVE A6NBDP    ##D,3                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telex Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA2     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,4                           CEU006
     C                     MOVE A6NBDP    ##D,4                           CEU006
      *                                                                   CEU006
      **  Interim Euro Cheque Charge                                      CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA3     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,5                           CEU006
     C                     MOVE A6NBDP    ##D,5                           CEU006
      *                                                                   CEU006
      **  Interim Euro Costs Abroad                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA4     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,6                           CEU006
     C                     MOVE A6NBDP    ##D,6                           CEU006
      *                                                                   CEU006
      **  Interim Euro SWIFT Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA5     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,7                           CEU006
     C                     MOVE A6NBDP    ##D,7                           CEU006
      *                                                                   CEU006
      **  Interim Euro Collection Charge                                  CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,8                           CEU006
      *                                                                   CEU006
      **  Interim Euro Telephone Charge                                   CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,9                           CEU006
      *                                                                   CEU006
      **  Interim Euro Advice Charge                                      CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,10                          CEU006
      *                                                                   CEU006
      **  Interim Euro Miscellaneous Charge                               CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDDUMA6     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,11                          CEU006
     C                     MOVE A6NBDP    ##D,11                          CEU006
      *                                                                   CEU006
      **  Interim Euro VAT Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADDOPDUM8    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,12                          CEU006
     C                     MOVE A6NBDP    ##D,12                          CEU006
      *                                                                   CEU006
      **  Interim Euro Total Charge                                       CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD##W110    P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,13                          CEU006
     C                     MOVE A6NBDP    ##D,13                          CEU006
      *                                                                   CEU006
      **  Interim Euro Deductions                                         CEU006
      *                                                                   CEU006
     C                     MOVE *BLANKS   ##D,14                          CEU006
      *                                                                   CEU006
      **  Interim Euro Net Amount                                         CEU006
      *                                                                   CEU006
     C                     CLEARP#0010                                    CEU006
     C                     MOVE #ENTCY    P#FRCY                          CEU006
     C                     Z-ADD#NETA     P#FRAM                          CEU006
     C                     EXSR EURAMT                                    CEU006
     C                     MOVELW#TOAM    ##D,15                          CEU006
     C                     MOVE A6NBDP    ##D,15                          CEU006
      *                                                                   CEU006
     C                     OTHER                                          CEU006
     C                     MOVEL*BLANKS   ##D,1                           CEU006
     C                     MOVEL*BLANKS   ##D,2                           CEU006
     C                     MOVEL*BLANKS   ##D,3                           CEU006
     C                     MOVEL*BLANKS   ##D,4                           CEU006
     C                     MOVEL*BLANKS   ##D,5                           CEU006
     C                     MOVEL*BLANKS   ##D,6                           CEU006
     C                     MOVEL*BLANKS   ##D,7                           CEU006
     C                     MOVEL*BLANKS   ##D,8                           CEU006
     C                     MOVEL*BLANKS   ##D,9                           CEU006
     C                     MOVEL*BLANKS   ##D,10                          CEU006
     C                     MOVEL*BLANKS   ##D,11                          CEU006
     C                     MOVEL*BLANKS   ##D,12                          CEU006
     C                     MOVEL*BLANKS   ##D,13                          CEU006
     C                     MOVEL*BLANKS   ##D,14                          CEU006
     C                     MOVEL*BLANKS   ##D,15                          CEU006
     C                     ENDSL                                          CEU006
      *                                                                   CEU006
      **  Accumulate RDE's and associated data and output to              CEU006
      **  PF/CGUDTAPD.                                                    CEU006
     C                     EXSR SRADTA                                    CEU006
     C                     EXSR SRODTA                                    CEU006
      *                                                                   CEU006
      *................................................................   CEU006
      *                                                                   CEU006
     C           EX@EUR    TAG                                            CEU006
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
      *                                                                   CEU006
      **  Unwind subroutine stack name                                    CEU006
     C                     MOVEA*BLANKS   @STK,Q                          CEU006
     C                     SUB  1         Q                               CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
     C*****************************************************************   CEU006
     C/SPACE 5                                                            CEU006
      *****************************************************************   CEU006
      * Subroutine  :  EURAMT                                         *   CEU006
      * Function    :  Calculates Currency Amounts for EMU            *   CEU006
      *                                                               *   CEU006
      *                Converts P#FRAM in P#FRCY -> P#TOAM in #CCY.   *   CEU006
      *                                                               *   CEU006
      * Called by   :  CHGENT, CHGEUR                                 *   CEU006
      * Calls       :  FT0010 - Midas FT Calculate Currency Amounts   *   CEU006
      *****************************************************************   CEU006
     C           EURAMT    BEGSR                                          CEU006
      *                                                                   CEU006
     C                     MOVEL#CCY      P#TOCY                          CEU006
     C                     MOVE W#DATE    P#FRDT                          CEU006
     C                     MOVE W#DATE    P#TODT                          CEU006
      *                                                                   CEU006
     C                     CALL 'FT0010'                                  CEU006
     C                     PARM           P#0010                          CEU006
      *                                                                   CEU006
      *  Check if database error occurred                                 CEU006
      *                                                                   CEU006
     C           P#RTCD    IFNE *BLANKS                                   CEU006
     C                     MOVEL'FT0010  'W0FILE                          CEU006
     C                     MOVEL#CCY      W0KEY            ***************CEU006
     C                     Z-ADD20        W0ERNB           * DB ERROR 20 *CEU006
     C                     MOVEL'MEM5004' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ELSE                                           CEU006
      *                                                                   CEU006
     C                     Z-ADDP#TOAM    W#TOAM 170                      CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C                     ENDSR                                          CEU006
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRTPSR                                         *
      * Function    :  Format Settlement Party Subroutine             *
      *                                                               *
      * Called by   :                                                 *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRTPSR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRTPSR'  @STK,Q
      *
      *................................................................
      *
     C*
     C**********************
     C*    NOT ENTERED     *
     C**********************
     C*
     C           SPTP      IFEQ ' '
     C                     MOVE *BLANK    SPT1
     C                     END
      *
      * Use FT0315 to format text for D address type
      *
      *  Set up general parameters
      *
     C           *LIKE     DEFN PCCY      XCCY
      *
     C                     CLEARW8FT
     C                     MOVEL*BLANKS   W8STMT
     C                     MOVELXCCY      W8CCY
     C                     MOVEL##PGM     W8CPGM
     C                     MOVEL'*MSG  '  W8ACT
     C                     Z-ADD5         W8NLIN
     C                     MOVEL'Y'       W8MTXT
     C                     MOVEL'Y'       W8MADD
      *
      *  Format data to be translated
      *
     C                     MOVELSPTP      W8TYPE
     C                     MOVEL*BLANKS   W8LINS
     C                     MOVELSPT1      ADCHK1
     C                     MOVELSPT2      ADCHK2
     C                     MOVELSPT3      ADCHK3
     C                     MOVELSPT4      ADCHK4
     C                     MOVELSPT5      ADCHK5
     C                     MOVELADDRSS    W8LINS
      *
      * Call expansion program
      *
     C                     CALL 'CG4980'               3030
     C                     PARM           W8RTN   7
     C                     PARM           W8FT
     C                     PARM           W8LINS256
     C                     PARM           W8RPT 256
     C                     PARM           W8MSG 256
     C                     PARM           W8SCR 256
      *
      *  Check if database error occurred
      *
     C           *IN30     IFEQ '1'
     C           W8RTN     ORNE *BLANKS
     C                     MOVEL'CG4980  'W0FILE           ***************
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 11 *
     C                     Z-ADD11        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
     C           *IN60     IFEQ '1'
     C                     MOVELW8RPT     ADDRSS
     C                     ELSE
     C                     MOVELW8MSG     ADDRSS
     C                     END
     C                     MOVELADCHK1    SPT1
     C                     MOVELADCHK2    SPT2
     C                     MOVELADCHK3    SPT3
     C                     MOVELADCHK4    SPT4
     C                     MOVELADCHK5    SPT5
      *
      *
      *................................................................
      *
     C           EXTPSR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRRDE                                         *
      * Function    :  Retrieve RDE information for RDEs in group set *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  -                                              *
      *****************************************************************
     C           SRRRDE    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRRDE'  @STK,Q
      *
      *................................................................
      *
      **  Reset
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
      *
      **  Get information about next 20 RDEs in group set from compile
      **  time arrays
     C                     Z-ADD0         #1
     C           *IN99     DOUEQ'0'
     C           #1        OREQ 20
     C                     Z-ADD1         #2
     C           ##GRPX    LOKUP##GRP,#2                 99*
     C           *IN99     IFEQ '1'
     C                     ADD  1         #1
     C                     MOVEL##RDEA,#2 ##R,#1
     C                     ADD  1         ##RDEN
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRRDE    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRADTA                                         *
      * Function    :  Accumulate RDEs and associated data for output *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG3999 - Format and Pack Data                  *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRADTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
      *
      *................................................................
      *
      **  Reformat RDE data
      *
     C                     EXSR SRRFMN
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANKS   W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *
      **  Pack RDEs and associated data into data string
     C                     CLEAR##SDS
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG3999  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 12 *
     C                     Z-ADD12        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     EXSR WRTRDE                                                        CCG015
      *
      **  Initialise Write Format Parameter.
     C                     CLEARW0FMT
      *
      **  Set up Control Information.
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD1         DEPBIN
     C                     Z-ADD1         DETBIN
     C                     MOVE 'FR'      DEFSLI
     C                     MOVE *BLANKS   W0PATH
     C                     MOVELS#PATH    W0PATH
      *
      **  Append Data from pack routine.
     C           W0FMT     CAT  ##SDS:0   W0FMT
      *
      *................................................................
      *
     C           EXADTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRRFMN                                         *
      * Function    :  Reformat RDE data                              *
      *                                                               *
      * Called by   :  SRADTA                                         *
      * Calls       :                                                 *
      *****************************************************************
     C           SRRFMN    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
      *
      *................................................................
      *
      ** Loop through RDE's and data
      *
     C                     Z-ADD0         #1
     C           #1        DOUEQ20
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
      *
      ** If data present and RDE is edited
      *
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
      *
      * Reformat Amount
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
      *
      * Sign the amount
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
      *
      * Default Edit Type
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
      *
      * Default Decimal Places
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
      * New RDE data
     C                     MOVELR#DATA    ##D,#1
     C                     ENDIF
     C                     ENDDO
      *
      *................................................................
      *
     C           EXRFMN    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
      *****************************************************************
      /SPACE 5
      *****************************************************************
      * Subroutine  :  SRODTA                                         *
      * Function    :  Output Accumulated data to PF/CGUDTAPD         *
      *                                                               *
      * Called by   :  Simple group set subroutines                   *
      * Calls       :  CG9020 - Output Data to CGUDTAPD               *
      *                SRERR  - Database Error                        *
      *****************************************************************
     C           SRODTA    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
      *
      *................................................................
      *                                                                                       CCG015
     C           CCG015    IFEQ 'N'                                                           CCG015
      *
      **  Output PF/CGUDTAPD Record.
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
      *
      **  Database error
     C           ##RTCD    IFNE *BLANK
      *
     C                     MOVEL'CG9020  'W0FILE           ***************
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 13 *
     C                     Z-ADD13        W0ERNB           ***************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
      *                                                                                       CCG015
     C                     ENDIF                                                              CCG015
      *
      *................................................................
      *
     C           EXODTA    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRGENR                                         *
      * Function    :  Generate reference number                      *
      *                by writing to PF/CGUDCRPD                      *
      *                                                               *
      * Called by   :  SRMAIN - Main Processing                       *
      * Calls       :  CG9010 - Create reference record               *
      *****************************************************************
     C           SRGENR    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
      *
      *................................................................
      *
      **  Generate reference number and check if further processing
      **  required. Set up all available information in the record
      **  format before calling.
      *
     C                     MOVELBRCA      DRBRCA
     C                     MOVELORBR      DRORBR
     C                     MOVEL'FT'      DRMODI
     C                     MOVELPREF      DRMTRN
      *
      **  Midas Account Identifier
     C**********           Z-ADDW0CNUM    ##CNUM                                              CSD027
     C                     MOVE W0CNUM    ##CNUM                                              CSD027
     C                     MOVELW#CCY     ##CCY
     C                     Z-ADDW0ACOD    ##ACOD
     C                     Z-ADDW0ACSQ    ##ACSQ
     C                     MOVELBRCA      ##BRCA
     C                     MOVEL#RETLN    DRMACT
     C                     MOVEL'N'       DRATRM
     C                     MOVEL#TEXT1    DRPTYP
     C                     MOVEL#TEXT2    DRPSTP
      *
     C                     MOVELCNUM      ##CUST
      *
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
      *
      **  Blank return code implies generate correspondence.
      **  CGD1270 => no error, but suppress output for this transaction.
      *
     C           ##RTCD    IFEQ *BLANK
      *                                                                                       CCG015
      ** Pass reference as printtype:subtype                                                  CCG015
     C           DRPTYP    CAT  ':':0     WCOLON 11 P                                         CCG015
     C           WCOLON    CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
      *
     C                     ELSE
      *
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ***************
     C                     Z-ADD7         W0ERNB           * DB ERROR 07 *
     C                     MOVEL'CGD1286' W0MSGD           ***************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF
      *
      *................................................................
      *
     C           EXGENR    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINIT                                         *
      * Function    :  Initial processing - First Call Only           *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :  None                                           *
      *****************************************************************
     C           SRINIT    BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
      *
      *................................................................
      *
      ** CALL ACCESS PROGRAM FOR BANK DETAILS
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           ##RTCD    IFNE *BLANK
      *
      ** DATABASE ERROR
      *
     C                     MOVEL'AOBANKR0'W0FILE
     C                     MOVEL'*CALL'   W0KEY            ***************
     C                     Z-ADD8         W0ERNB           * DB ERROR 08 *
     C                     MOVEL'MEM5003' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **         IN THE DATAAREA RUNDAT
      *
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
      *                                                                   CEU006
      ** Access Switchable Features file to check for CEU006              CEU006
      *                                                                   CEU006
     C                     CALL 'AOSARDR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*VERIFY' @OPTN                           CEU006
     C                     PARM 'CEU006'  @SARD   6                       CEU006
     C                     PARM           DSFDY                           CEU006
     C                     SELEC                                          CEU006
     C           @RTCD     WHEQ *BLANK                                    CEU006
     C                     MOVE 'Y'       CEU006  1                       CEU006
     C           @RTCD     WHEQ '*NRF'                                    CEU006
     C                     MOVE 'N'       CEU006                          CEU006
     C                     OTHER                                          CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C                     MOVEL'SCSARDPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD14        W0ERNB           * DB ERROR 14 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDSL                                          CEU006
      *                                                                                       CCG015
      ** Determine if Correspondence Manager Phase 1 Development                              CCG015
      ** on iSeries is installed                                                              CCG015
      *                                                                                       CCG015
     C                     MOVE 'N'       CCG015  1                                           CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   PRTCD   7                                           CCG015
     C                     PARM '*VERIFY' POPTN   7                                           CCG015
     C                     PARM 'CCG015'  PSARD   6                                           CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
     C           PRTCD     IFNE *BLANKS                                                       CCG015
     C           PRTCD     ANDNE'*NRF    '                                                    CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL '  W0KEY                                               CCG015
     C                     Z-ADD23        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
     C           PRTCD     IFEQ *BLANKS                                                       CCG015
     C                     MOVE 'Y'       CCG015                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                   CEU006
      ** Access GL ICD                                                    CEU006
      *                                                                   CEU006
     C**********           CALL 'AOGELRR0'                                CEU006              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*FIRST ' @OPTN                           CEU006
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU006              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C           @RTCD     IFNE *BLANKS                                   CEU006
     C                     MOVEL'SDGELRPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD22        W0ERNB           * DB ERROR 22 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
      ** Access FT ICD                                                    CEU006
      *                                                                   CEU006
     C                     CALL 'AOFTFRR0'                                CEU006
     C                     PARM *BLANKS   @RTCD                           CEU006
     C                     PARM '*FIRST ' @OPTN                           CEU006
     C           SDFTFR    PARM SDFTFR    DSFDY                           CEU006
      *                                                                   CEU006
      ** DATABASE ERROR                                                   CEU006
      *                                                                   CEU006
     C           @RTCD     IFNE *BLANKS                                   CEU006
     C                     MOVEL'SDFTFRPD'W0FILE                          CEU006
     C                     MOVEL@OPTN     W0KEY            ***************CEU006
     C                     Z-ADD15        W0ERNB           * DB ERROR 15 *CEU006
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU006
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU006
     C                     EXSR SRERR                                     CEU006
     C                     ENDIF                                          CEU006
      *                                                                   CEU006
     C/COPY WNCPYSRC,CG4970C004
      *                                                                                       CFT120
      ** Determine if CFT120 is on.                                                           CFT120
      *                                                                                       CFT120
     C                     MOVE 'N'       CFT120  1                                           CFT120
     C                     CALL 'AOSARDR0'                                                    CFT120
     C                     PARM *BLANKS   PRTCD   7                                           CFT120
     C                     PARM '*VERIFY' POPTN   7                                           CFT120
     C                     PARM 'CFT120'  PSARD   6                                           CFT120
     C           SCSARD    PARM SCSARD    DSFDY                                               CFT120
     C           PRTCD     IFNE *BLANKS                                                       CFT120
     C           PRTCD     ANDNE'*NRF    '                                                    CFT120
     C                     MOVEL'SCSARDPD'W0FILE                                              CFT120
     C                     MOVEL'*CALL '  W0KEY                                               CFT120
     C                     Z-ADD24        W0ERNB                                              CFT120
     C                     MOVEL'MEM5003' W0MSGD                                              CFT120
     C                     MOVEL'MIDAS  ' W0MSGF                                              CFT120
     C                     EXSR SRERR                                                         CFT120
     C                     ENDIF                                                              CFT120
     C           PRTCD     IFEQ *BLANKS                                                       CFT120
     C                     MOVE 'Y'       CFT120                                              CFT120
     C                     ENDIF                                                              CFT120
     C*
      *
      *................................................................
      *
     C           EXINIT    TAG
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*****************************************************************
     C/SPACE 5
      *****************************************************************
      * Subroutine  :  SRINZ                                          *
      * Function    :  Initialise Fields on Program Invocation        *
      *                                                               *
      * Called by   :  Mainline                                       *
      * Calls       :                                                 *
      *****************************************************************
     C           SRINZ     BEGSR
      *
      **  Set up subroutine stack name
     C                     ADD  1         Q
     C                     MOVEL'SRINZ '  @STK,Q
      *
      *................................................................
      *
      **  Initialise work fields
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C*
     C                     MOVE *BLANKS   ZTABKY 12
     C                     MOVEL'20'      ZTABKY
     C                     MOVELPCCY      KEY4    4
     C                     MOVE '1'       KEY4
     C                     MOVE KEY4      ZTABKY
     C*
     C           ZTABKY    CHAINTABFP                10
     C*
     C           *IN10     IFEQ '1'
     C           RECI      ORNE 'D'
     C                     MOVEL'TABTG10 'W0FILE
     C                     MOVELZTABKY    W0KEY            ***************
     C                     Z-ADD10        W0ERNB           * DB ERROR 10 *
     C                     MOVEL'MEM5004' W0MSGD           ***************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *
      **  Initialise output sequence (to CGUDTAPD)
     C                     Z-ADD*ZEROS    ##OSEQ
      *
      **  Attempt to obtain customer number.
      *
     C*
     C                     MOVE *BLANKS   SPT1
     C                     MOVE *BLANKS   SPT2
     C                     MOVE *BLANKS   SPT3
     C                     MOVE *BLANKS   SPT4
     C                     MOVE *BLANKS   SPT5
     C*
     C                     MOVE DSTT      SPTP
     C                     MOVE DST1      SPT1
     C                     MOVE DST2      SPT2
     C                     MOVE DST3      SPT3
     C                     MOVE DST4      SPT4
     C*
     C                     SETON                     60
     C                     EXSR SRTPSR
     C                     SETOF                     60
      *
     C                     MOVELW0CNUM    CNUM
      *                                                                                       CCG015
      ** Initialize context for new extraction                                                CCG015
     C                     EXSR INIXML                                                        CCG015
     C/SPACE 5
     C/COPY WNCPYSRC,CG4970FCPG
      *
     C           EXINZ     TAG
      *
      *................................................................
      *
      **  Unwind subroutine stack name
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
      *
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      *                                                                                       CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCMTSK  1                                           CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   PRTCD                                               CSC022
     C                     PARM '*VERIFY' POPTN                                               CSC022
     C                     PARM 'CSC022'  PSARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           PRTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C                     MOVE 'N'       WCMTSK                                              CSC022
      *                                                                                       CSC022
     C                     IN   WDSJOB                                                        CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
     C                     Z-ADD1         I       20                                          CSC022
      *                                                                                       CSC022
     C           ##JOB     LOKUPWCMT,I                   51                                   CSC022
     C           *IN51     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ELSE                                                               CSC022
     C           PRTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  W0KEY                                               CSC022
     C                     MOVEL'SCSARDPD'W0FILE                                              CSC022
     C                     Z-ADD21        W0ERNB                                              CSC022
     C                     EXSR SRERR                                                         CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C************NAMVAR   DEFN           WDSJOB                                       CSC022BUG2330
     C           *NAMVAR   DEFN SCCMTJOB  WDSJOB                                             BUG2330
      *                                                                                       CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ENDSR
      *****************************************************************
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRPSSR
     C/SPACE 5
     C/COPY CGCPYSRC,SRERRC
      /EJECT                                                                                  CCG015
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
** ##GRP/##RDE
BRANCH0001 BRANCH
BRANCH0002 BRANCH NAM
BOOK  0001 BOOK_CODE
BOOK  0002 BOOK_DESC
PROF_C0001 PROF_CENT
PROF_C0002 PROF_C_DSC
FT_USR0001 USR_INP_1
FT_USR0002 USR_INP_2
FT_USR0003 USR_AUT_1
FT_USR0004 USR_AUT_2
FT_USR0005 UINP1_DESC
FT_USR0006 UINP2_DESC
FT_USR0007 UAUT1_DESC
FT_USR0008 UAUT2_DESC
PAYMNT0001 PAY_REF
PAYMNT0002 VALUE DATE Date
PAYMNT0003 PRINT_DATE Date
PAYMNT0004 PAY_TYPE
PAYMNT0005 PAY_S_TYPE
PAYMNT0006 PAY_ST_DSC
PAYMNT0007 SETTLEMOD                                                      095577
PAY_II0001 PAY_RATE   Xrate L8
PAY_II0002 CHG_CCY
PAY_II0003 ADD/DEDUCT
PAY_II0004 TFR_COMM   AmountL
PAY_II0005 FX/CHG_COM AmountL
PAY_II0006 TELEX_CHG  AmountL
PAY_II0007 CHEQUE_CHG AmountL
PAY_II0008 COST_ABRD  AmountL
PAY_II0009 SWIFT_CHG  AmountL
PAY_II0010 MISC_CHG   AmountL
PAY_II0011 VAT_AMOUNT AmountL
PAY_II0012 TOT_CHG    AmountL
PAY_II0013 NET_AMOUNT AmountL
PAY_II0014 CHG_DETL
PAY_II0015 REL_REF
PAY_II0016 COLL_CHG   AmountL
PAY_II0017 TELEPH_CHG AmountL
PAY_II0018 ADVICE_CHG AmountL
PAY_II0019 DEDUCTIONS AmountL
CR_CCY0001 CR_CCY
CR_CCY0002 CR_CCY_NAM
CR_CCY0003 CR_AMOUNT  AmountL
CR_CCY0004 CHQ_NUMBER
CR_CCY0005 CHQ_SEQ_NO
CR_CCY0006 CR DATE    Date                                                095577
DR_CCY0001 DR_CCY
DR_CCY0002 DR_CCY_NAM
DR_CCY0003 DR_AMOUNT  AmountL
DR_CCY0004 DR DATE    Date                                                095577
PAYDET0001 PAY_DETL_1
PAYDET0002 PAY_DETL_2
PAYDET0003 PAY_DETL_3
PAYDET0004 PAY_DETL_4
B_TO_B0001 BK_TO_BK_1
B_TO_B0002 BK_TO_BK_2
B_TO_B0003 BK_TO_BK_3
B_TO_B0004 BK_TO_BK_4
B_TO_B0005 BK_TO_BK_5
B_TO_B0006 BK_TO_BK_6
CORDTA0001 COR_TYPE                      Information Type
CORDTA0002 COR_CUST                      Customer
CORDTA0003 COR_CUSNAM                    Customer Name
CORDTA0004 COR_CUSTWN                    Customer Town
CORDTA0005 COR_AC_LIN                    Account line
CORDTA0006 COR_RET_NO                    Retail AC No.
CORDTA0007 COR_ACCT                      Midas Account Identifier
CORDTA0008 COR_AC_NAM                    Account name
CORDTA0009 COR_SWIFT                     SWIFT ID
CORDTA0010 COR_ADDR_1                    Address line 1
CORDTA0011 COR_ADDR_2                    Address line 2
CORDTA0012 COR_ADDR_3                    Address line 3
CORDTA0013 COR_ADDR_4                    Address line 4
CORDTA0014 COR_ADDR_5                    Address line 5
CORDTA0015 CFT120F                       CFT120 Switchable Feature Flag                       CFT120
CORDTA0016 COR_CCY                       Charge to the Debit A/c ccy                          CFT120
AMTADD0001 AMT_ADD_1  AmountL
AMTADD0002 AMT_ADD_2  AmountL
AMTADD0003 AMT_ADD_3  AmountL
AMTADD0004 AMT_ADD_4  AmountL
AMTADD0005 AMT_ADD_5  AmountL
AMTADD0006 AMT_ADD_6  AmountL
AMTADD0007 AMT_SUB_1  AmountL
FT_DLV0001 NTF_DLVCCY                                                     CEU006
FT_DLV0002 NTF_DLVAMT AmountL                                             CEU006
FT_DLV0003 PAY_DLVCCY                                                     CEU006
FT_DLV0004 PAY_DLVAMT AmountL                                             CEU006
CHGENT0001 ENT_CURRCY                                                     CEU006
CHGENT0002 ENT_TFRCOM AmountL                                             CEU006
CHGENT0003 ENT_FX/CHG AmountL                                             CEU006
CHGENT0004 ENT_TELEX  AmountL                                             CEU006
CHGENT0005 ENT_CHEQUE AmountL                                             CEU006
CHGENT0006 ENT_COSTAB AmountL                                             CEU006
CHGENT0007 ENT_SWIFT  AmountL                                             CEU006
CHGENT0008 ENT_COLLEC AmountL                                             CEU006
CHGENT0009 ENT_TELEPH AmountL                                             CEU006
CHGENT0010 ENT_ADVICE AmountL                                             CEU006
CHGENT0011 ENT_MISC   AmountL                                             CEU006
CHGENT0012 ENT_VATAMT AmountL                                             CEU006
CHGENT0013 ENT_TOTCHG AmountL                                             CEU006
CHGENT0014 ENT_DEDUCT AmountL                                             CEU006
CHGENT0015 ENT_NETAMT AmountL                                             CEU006
CHGEUR0001 EUR_CURRCY                                                     CEU006
CHGEUR0002 EUR_TFRCOM AmountL                                             CEU006
CHGEUR0003 EUR_FX/CHG AmountL                                             CEU006
CHGEUR0004 EUR_TELEX  AmountL                                             CEU006
CHGEUR0005 EUR_CHEQUE AmountL                                             CEU006
CHGEUR0006 EUR_COSTAB AmountL                                             CEU006
CHGEUR0007 EUR_SWIFT  AmountL                                             CEU006
CHGEUR0008 EUR_COLLEC AmountL                                             CEU006
CHGEUR0009 EUR_TELEPH AmountL                                             CEU006
CHGEUR0010 EUR_ADVICE AmountL                                             CEU006
CHGEUR0011 EUR_MISC   AmountL                                             CEU006
CHGEUR0012 EUR_VATAMT AmountL                                             CEU006
CHGEUR0013 EUR_TOTCHG AmountL                                             CEU006
CHGEUR0014 EUR_DEDUCT AmountL                                             CEU006
CHGEUR0015 EUR_NETAMT AmountL                                             CEU006
** ##CPY  **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
