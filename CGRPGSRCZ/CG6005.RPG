     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Lending commencement confirmations')          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                          *
     F*                                                               *
     F*  CG6005 - Lending Commencement Confirmations                  *
     F*                                                               *
     F*  Function:  This program extracts data for Commencement       *
     F*  ( I/C )    Confirmations.                                    *
     F*  (I/C Term)                                                   *
     F*                                                               *
     F*  Called By: CG6000 - Lending Commencement Confirmations Driver*
     F*                                                               *
     F*  Calls :    CG3999 - Pack/Unpack Extracted Data               *
     F*             CG6001 - General Loan Details                     *
     F*             CG9010 - Create Item Reference Records            *
     F*             CG9020 - Write Data to UDC Extract Files          *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CLE141             Date 08Feb16               *
      *  Prev Amend No. MD029242           Date 25Nov14               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 AR322732           Date 23Jul12               *
      *                 CLE148             Date 23Jul12               *
      *                 AR822053           Date 29Aug11               *
      *                 CER049             Date 06Dec10               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23004           Date 21Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER038             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 245914             Date 22Feb07               *
      *                 245082             Date 29Jan07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 130998             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CLE106             Date 01Aug04               *
      *                 CLE036             Date 22Sep03               *
      *                 CIR013             Date 25Apr05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CLE031             Date 05Feb03               *
      *                 CLE028             Date 27Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CCG015             Date 09Aug01               *
      *                 177914             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 15May01               *
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU014             Date 04Jun98               *
      *                 126017             Date 14Nov97               *
     F*                 121768             DATE 19FEB98               *
     F*                 CLE005             DATE 22May97               *
     F*                 S01408             Date 10JUL96               *
     F*                 CCG008 *CREATE     Date 30OCT95               *
     F*                                                               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*  AMENDMENT HISTORY                                            *
     F*                                                               *
      *  CLE141 - Currency and Location Business Day Convention for   *
      *           Lending Transactions                                *
      *  MD029242 - System should generate Dealing CM correspondences *
      *             also for the Customers with SWIFT-Id (suppressed  *
      *             by CER038)                                        *
      *           - Created new system value to condition the         *
      *             suppression of correspondence if customer has     *
      *             Swift ID                                          *
      *  AR996895 - Incorrect accrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  AR322732 - LEC0212A and APISERVER locks LTRIX file.          *
      *           - Prevent LTRIX RRN 1 from being locked (Recompile) *
      *  CLE148 - Alpha Loan Reference                                *
      *  AR822053 - Incorrect value of Effective Annual Interest Rate *
      *             in CGUXMLPD                                       *
      *  CER049 - Stamp Tax (Portuguese Features Upgrade)             *
      *  CRE073 - Portuguese Feature - Interest Rate Rounding         *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate                                                *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23004 - The counterparty is a SWIFT participant and still *
      *            a paper confirmation has been produced             *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER038 - Additional fields added to Correspondence           *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  245914 - Review interest calculation.                        *
      *  245082 - Loans with first and last day accrual should be     *
      *           treated as first day accruals until maturity        *
      *           date.  Then add one day on the maturity date.       *
      *           Applied fix 235784 from Release 4.                  *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  130998 - If not using extended settlements use old fields.   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CLE106 - Syndications Manager. (Recompile)                   *
      *  CLE036 - LE Enh for Nordea Phase 1 Pty 2 - Specific Base Rate*
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CLE031 - Lending Enhancements.                               *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *  CCG015 - Correspondence Manager Phase 1                      *
      *  177914 - Confirmation reflected 0 interest. Calculate        *
      *           interest whatever the repayment type is.            *
      *  CSD006 - Use DSSDY for call to AOBSTRR0.                     *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CIR004 - Dealing Calculation Method Change.                  *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  CEU014 - EMU User Defined Correspondence Changes.            *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  CLE005 - Customer Lending Enhancements - Others (T3)         *
     F*  S01408 - Core hook CG6005CCP1 added.                         *
     F*           Core hook CG6005CCP2 added.                         *
     F*  CCG008 - User Defined Correspondence - Lending               *
     F*                                                               *
     F*****************************************************************
     F*
     FCLOAN   IF  E           K        DISK
     F            CLOANHHF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
     F                                              KINFSR SRFILE
     FLOAMS   IF  E           K        DISK                               S01518
     F            LOAMSDHF                          KIGNORE
     F            LOAMSZ1F                          KIGNORE
     F                                              KINFSR SRFILE
      *                                                                                       CER049
      ** Stamp Tax file                                                                       CER049
      *                                                                                       CER049
     FCLONCLL1IF  E           K        DISK                                                   CER049
     F*
     F/COPY WNCPYSRC,CG6005F001
      /TITLE FUNCTION OF INDICATORS
     F*****************************************************************
     F*                                                               *
     F*  F U N  C T I O N    O F    I N D I C A T O R S               *
     F*                                                               *
     F*  90         Poffered for READE LOOPS                          *
     F*  99         General error indicator                           *
     F*                                                               *
     F*****************************************************************
      /TITLE SUBROUTINE INDEX
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E    I N D E X                             *
     F*                                                               *
     F*  Main routine                                                 *
     F*  SRMAIN  -  Main Processing                                   *
     F*  SRDETL  -  Obtain Detail Information                         *
     F*  L01CC   -  Lending Commencement Confirmations                *
     F*  LOANA   -  Loan Associated Details                           *
     F*  LOAN    -  Process Loan Details                              *
     F*  L@ROL   -  Process Rollover Details                          *
     F*  L@REP   -  Process Repayment Details                         *
     F*  L@IPY   -  Process Interest Payment Details                  *
     F*  L@GUAR  -  Process Guarantee Details                         *
     F*  SRSDET  -  Set-up Settlement Details                         *
     F*  SRINZF  -  Initialise Fields on Each Invocation              *
     F*  SRINIT  -  Initial Processing - On First Call                *
     F*  SRADTA  -  Accumulate RDEs and Associated Data               *
     F*  SRODTA  -  Output Accumulated Data to CGUDTAPD               *
     F*  SRBIND  -  Generate Binding Numbers                          *
     F*  SRPATH  -  Generate Path String                              *
     F*  SRRFMN  -  Reformat RDE Data                                 *
     F*  SRDCDT  -  Determine Currency Details                        *
     F*  SRGENR  -  Generate Reference Number                         *
     F*  SRICAL  -  Calculate Interest                                *
     F*  ZFLAC   -  Calculate End Date                                *
     F*  GLINTC  -  Calculate Interest Between any 2 day numbers      *
     F*  AOBANKR0 - Retrive Bank Details                              *
     F*  AOBRCHRO - Retrive Branch Details                            *
     F*  AOBSRTRO - Retrive Base Rate Code Details                    *
     F*  AOCURRRO - Retrive Currency Details                          *
     F*  AOCUSTR0 - Retrieve Customer Details                         *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E*
     E**  Copyright array.
     E                    CPY@    1   1 80
     E*
     E/COPY CGCPYSRC,CGPACKE
     E/COPY CGCPYSRC,SRERRE
     E*
     E**  Number Arrays
     E                    ##W        20  1
     E                    ##NUMA     29  1
     E*
     E**  Array of Currencies accessed by program
     E                    ##CY      100  3
     E*
     E/COPY ZSRSRC,ZDATE9Z1
     E*
     E                    POWER   1   7  7 3                                                  CLE031
     I/EJECT
     I*
     ICLOANCLF
     I** Rename fields of CLOANCL
     I              RECI                            ##RECI
     I              LNRF                            ##LNRF
     I              RCDT                            ##RCDT
     I              MRIN                            ##MRIN
     I              PTYP                            ##PTYP
     I              CNUM                            ##CNUM
     I              BRCA                            ##BRCA
     I              LTYP                            ##LTYP
     I              SUTP                            ##SUTP
     I              DDAT                            ##DDAT
     I              VDAT                            ##VDAT
     I              MDAT                            ##MDAT
     I              LASQ                            ##LASQ
     I              FCUS                            ##FCUS
     I              FTYP                            ##FTYP
     I              FSEQ                            ##FSEQ
     I              CCY                             ##CCY1
     I              CPAM                            ##CPAM
     I              INTC                            ##INTC
     I              INTR                            ##INTR
     I              BRTT                            ##BRTT
     I              BRTE                            ##BRTE
     I              RTSP                            ##RTSP
     I              MARG                            ##MARG
     I              SPIN                            ##SPIN
     I              CHIN                            ##CHIN
     I              WTRT                            ##WTRT
     I              WTIN                            ##WTIN
     I              REPT                            ##REPT
     I              RAMT                            ##RAMT
     I              NRPD                            ##NRPD
     I              RFRQ                            ##RFRQ
     I              RDYN                            ##RDYN
     I              FCCY                            ##FCCY
     I              LIND                            ##LIND
     I              CRSK                            ##CRSK
     I              ACOF                            ##ACOF
     I              NACD                            ##NACD
     I              RELI                            ##RELI
     I              AUTO                            ##AUT1
     I              PSAM                            ##PSAM
     I              BCXR                            ##BCXR
     I              FCXR                            ##FCXR
     I              SDST                            ##SDST
     I              OSDA                            ##OSDA
     I              TSTN                            ##TSTN
     I              MDST                            ##MDST
     I              OMDA                            ##OMDA
     I              TMAN                            ##TMAN
     I              FACO                            ##FACO
     I              RLDT                            ##RLDT
     I              NROD                            ##NROD
     I              RLFQ                            ##RLFQ
     I              RLDY                            ##RLDY
     I              RDFC                            ##RDFC
     I              NBRA                            ##NBRA
     I              NRTS                            ##NRTS
     I              NSIN                            ##NSIN
     I              NCAS                            ##NCAS
     I              AWTP                            ##AWTP
     I              WTRD                            ##WTRD
     I              WTWD                            ##WTWD
     I              IWOD                            ##IWOD
     I              PWOD                            ##PWOD
     I              BMDI                            ##BMDI
     I              FMDI                            ##FMDI
     I              PDIN                            ##PDIN
     I              LSWC                            ##LSWC
     I              LSWS                            ##LSWS
     I              OSDB                            ##OSDB
     I              OMDB                            ##OMDB
     I              ORBR                            ##ORBR
     I              PRFC                            ##PRFC
     I              FCLB                            ##FCLB
     I              MLNR                            ##MLNR
     I              BTIN                            ##BTIN
     I              BLDY                            ##BLDY
     I              OLNO                            ##OLNO
     I              RCSI                            ##RCSI
     I              ICBS                            ##ICBS
     I              IPFR                            ##IPFR
     I              TOTI                            ##TOTI
     I              NIDT                            ##NIDT
     I              IBDT                            ##IBDT
     I              SLID                            ##SLID
     I              AIPD                            ##AIPD
     I              DLRC                            ##DLRC
     I              IACD                            ##IACD
     I              AITC                            ##AITC
     I              TFEP                            ##TFEP
     I              AIAP                            ##AIAP
     I              IPRD                            ##IPRD
     I              IPRM                            ##IPRM
     I              ICTD                            ##ICTD
     I              AIMN                            ##AIMN
     I              RBDT                            ##RBDT
     I              NOPS                            ##NOPS
     I              NCHI                            ##NCHI
     I              IFDY                            ##IFDY
     I              LONI                            ##LONI
     I              CNFI                            ##CNFI
     I              ACEI                            ##ACEI
     I              TLXI                            ##TLXI
     I              CBLI                            ##CBLI
     I              ORED                            ##ORED
     I              LCD                             ##LCD
     I              CHTP                            ##CHTP
     I              TNLU                            ##TNLU
     I              ADDI                            ##ADDI
     I              ORMD                            ##ORMD
     I              ORTI                            ##ORTI
     I              BOKC                            ##BOKC
     I              COCU                            ##COCU
     I              RECE                            ##RECE
     I              OMDT                            ##OMDT
     I              NIPD                            ##NIPD
     I              NMDT                            ##NMDT
     I              APMI                            ##APMI
     I              RSTM                            ##RSTM
     I              RONS                            ##RONS
     I              RIBN                            ##RIBN
     I              RIBA                            ##RIBA
     I              ROBN                            ##ROBN
     I              ROCN                            ##ROCN
     I              PSTM                            ##PSTM
     I              PONS                            ##PONS
     I              PIBN                            ##PIBN
     I              PIBA                            ##PIBA
     I              POBN                            ##POBN
     I              POCN                            ##POCN
     I              RCRN                            ##RCRN
     I              RCRA                            ##RCRA
     I              RVNO                            ##RVNO
     I              AWBN                            ##AWBN
     I              AWBA                            ##AWBA
     I              BENN                            ##BENN
     I              BENA                            ##BENA
     I              DTP1                            ##DTP1
     I              DTP2                            ##DTP2
     I              DTP3                            ##DTP3
     I              DTP4                            ##DTP4
     I              DCHG                            ##DCHG
     I              BTB1                            ##BTB1
     I              BTB2                            ##BTB2
     I              BTB3                            ##BTB3
     I              BTB4                            ##BTB4
     I              BTB5                            ##BTB5
     I              BTB6                            ##BTB6
     I              CVMR                            ##CVMR
     I              PTFR                            ##PTFR
     I              SCCY                            ##STCY                CEU014
     I              ADIF                            ##ADIF                                    CLE028
     I              ADCF                            ##ADCF                                    CLE028
     I              CHGA                            ##CHGA                                    CLE028
     I              ICIF                            ##ICIF                                    CLE028
     I              FLTI                            ##FLTI                                    CLE028
     I              FRPD                            ##FRPD                                    CLE028
     I              REXR                            ##REXR                                    CLE031
     I              REXI                            ##REXI                                    CLE031
     I              PSCY                            ##PSCY                                    CLE031
     I              PEXR                            ##PEXR                                    CLE031
     I              PEXI                            ##PEXI                                    CLE031
     I              BASR                            ##BASR                                    CLE036
     I              NBSR                            ##NBSR                                    CLE036
     I              OCDT                            ##OCDT                                    CLE143
     I              EAIR                            ##EAIR                                    CLE143
     I              CNSP                            ##CNSP                                    CRE073
     I              CNSG                            ##CNSG                                    CRE073
     I              RDMT                            ##RDMT                                    CRE073
     I              RDFD                            ##RDFD                                    CRE073
     I*
     ICLOANCKF
     I** Rename fields of CLOANCK
     I              RECI                            ##RECI
     I              LNRF                            ##LNRF
     I              RCDT                            ##RCDT
     I              MRIN                            ##MRIN
     I              NAR1                            ##NAR1
     I              NAR2                            ##NAR2
     I              NAR3                            ##NAR3
     I              NAR4                            ##NAR4
     I              OPAM                            ##OPAM
     I              FRBC                            ##FRBC
     I              YPLN                            ##YPLN
     I              YFLN                            ##YFLN
     I              YWLN                            ##YWLN
     I              ABLN                            ##ABLN
     I              YPLC                            ##YPLC
     I              YFLC                            ##YFLC
     I              YWLC                            ##YWLC
     I              ABLC                            ##ABLC
     I              WWLN                            ##WWLN
     I              IWLN                            ##IWLN
     I              PWLN                            ##PWLN
     I              RDST                            ##RDST
     I              SPI1                            ##SPI1
     I              SPI2                            ##SPI2
     I              SPI3                            ##SPI3
     I              YILN                            ##YILN
     I              F57U                            ##F57U
     I              ORVD                            ##ORVD
     I              THRN                            ##THRN
     I              NPRAM                           ##NPAM
     I              NDAM                            ##NDAM
     I              RLBR                            ##RLBR
     I              ORED                            ##ORED
     I              LCD                             ##LCD
     I              CHTP                            ##CHTP
     I              TNLU                            ##TNLU
     I*
     ILOAMSDKF
     I** Rename fields of LOAMSDK
     I              VDAT                            ##VDA1
     I              AMTP                            ##AMT1
     I*
     ICPYR        DS
     I**  Data Structure for Compilation - Copyright Insertion
     I                                        1  80 ##CPY
     I*
     I##SDS       DS
     I**  Look-up string for RDE definition Array
     I**********                              15120 ##S                                       CLE036
     I                                        15632 ##S                                       CLE036
     I#@SDS       DS
     I**  Packed data string.
     I**********                           51205120 #@S                                       CLE036
     I                                     56325632 #@S                                       CLE036
     I*
     I            DS
     I**  Number Field
     I                                        1  20 ##W
     I                                        1  200##WNUM
     I            DS
     I** Used to convert item reference from character to numeric
     I                                        1   8 ##ITMA
     I                                        1   80##ITEM
     I*
     I            DS
     I                                        1   6 ##NCIT
     I                                        1   3 NMCY
     I                                        4   6 SITP
     I            DS
     I                                        1   5 ##CCCC
     I                                        1   3 ##CCY
     I                                        4   5 ##CCD
     I*
     I**  Loan details parameter for call to CG99LSET.
     I*
     IPDETLS      DS                            256
     I* Currency
     I                                        1   3 ##CCY1
     I* Customer Number
     I**********                              4   90##CNUM                                    CSD027
     I                                        4   9 ##CNUM                                    CSD027
     I* Branch
     I                                       10  12 ##BRCA
     I*
     I**  Settlement Instructions Parameter for call to CG99LSET.
     I*
     IP0PARM      DS                            768
     I**  Pay - Branch
     I                                        1   3 P0POBR
     I**  Receipt - Branch
     I                                        4   6 P0ROBR
     I**  Receipt - Settlement Method
     I                                        7   80P0RSTM
     I**  Receipt - Our Nostro
     I**********                              9  20 P0RONS                                    CGL029
     I                                        9  20 QQRONS                                    CGL029
     I**  Receipt - Intermediary Bank
     I                                       21  28 P0RIBN
     I**  Receipt - Intermediary Bank a/c
     I                                       29  63 P0RIBA
     I**  Receipt - Ordering Bank No.
     I**********                             64  690P0ROBN                                    CSD027
     I                                       64  69 P0ROBN                                    CSD027
     I**  Receipt - Ordering Customer
     I**********                             70  750P0ROCN                                    CSD027
     I                                       70  75 P0ROCN                                    CSD027
     I**  Pay - Settlement Method
     I                                       76  770P0PSTM
     I**  Pay - Our Nostro
     I**********                             78  89 P0PONS                                    CGL029
     I                                       78  89 QQPONS                                    CGL029
     I**  Pay - Intermediary Bank
     I                                       90  97 P0PIBN
     I**  Pay - Intermediary Bank a/c
     I                                       98 132 P0PIBA
     I**  Pay - Ordering Bank No.
     I**********                            133 1380P0POBN                                    CSD027
     I                                      133 138 P0POBN                                    CSD027
     I**  Pay - Ordering Customer No.
     I**********                            139 1440P0POCN                                    CSD027
     I                                      139 144 P0POCN                                    CSD027
     I**  Receiver Correspondent No.
     I                                      145 152 P0RCRN
     I**  Receiver Correspondent A/C 1
     I                                      153 187 P0RCRA
     I**  Receiver Number
     I                                      188 195 P0RVNO
     I**  A/C with Bank No.
     I                                      196 203 P0AWBN
     I**  A/C with Bank A/C Line
     I                                      204 238 P0AWBA
     I**  Beneficiary No.
     I                                      239 246 P0BENN
     I**  Beneficiary A/C Line
     I                                      247 281 P0BENA
     I**  Details of Pay 1
     I                                      282 316 P0DTP1
     I**  Details of Pay 2
     I                                      317 351 P0DTP2
     I**  Details of Pay 3
     I                                      352 386 P0DTP3
     I**  Details of Pay 4
     I                                      387 421 P0DTP4
     I**  Details of Charges
     I                                      422 424 P0DCHG
     I**  Bank to Bank Info 1
     I                                      425 459 P0BTB1
     I**  Bank to Bank Info 2
     I                                      460 494 P0BTB2
     I**  Bank to Bank Info 3
     I                                      495 529 P0BTB3
     I**  Bank to Bank Info 4
     I                                      530 564 P0BTB4
     I**  Bank to Bank Info 5
     I                                      565 599 P0BTB5
     I**  Bank to Bank Info 6
     I                                      600 634 P0BTB6
     I**  Special Instruction 1
     I                                      635 664 P0SPI1
     I**  Special Instruction 2
     I                                      665 694 P0SPI2
     I**  Special Instruction 3
     I                                      695 724 P0SPI3
     I**  Settlement Currency                                             CEU014
     I                                      725 727 P0STCY                CEU014
     I                                      728 730 P0PSCY                                    CLE031
     I                                      731 748 P0RONS                                    CGL029
     I                                      749 766 P0PONS                                    CGL029
     I*
     I**  UDC Details
     I*
     IP1PARM      DS                            256
     I**  Output Sequence
     I                                        1   90P1OSEQ
     I**  UDC item number
     I                                       10  170P1ITEM
     I**  This bind level
     I                                       18  250P1TBIN
     I**  Previous bind level
     I                                       26  330P1PBIN
     I*
     I**  Loan details Parameters for call to CG6001.
     I*
     IP@PARM      DS                            256
     I**  Loan Reference
     I                                        1   6 P@LNRF
     I**  Cancel/Amend Field
     I                                        7   7 P@CNAM
     I*
     I**  Facility details Parameter for call to CG6001
     I*
     IP4PARM      DS                            256
     I**  Facility customer
     I**********                              1   60P4FCUS                                    CSD027
     I                                        1   6 P4FCUS                                    CSD027
     I**  Facility type
     I                                        7   90P4FTYP
     I**  Facility Seq
     I                                       10  110P4FSEQ
     I*
     I**  For error reporting
     I*
     I**  Named constants
     I*
     I              'LOAN COMMC'          C         W#PTYP
     I              'CALL LOAN '          C         W#PST1
     I              'TERM LOAN '          C         W#PST2
     I              'DISC LOAN '          C         W#PST3
     I              'TERM PA PU'          C         W#PST4
     I              'DISC PA PU'          C         W#PST5
     I              'TERM PA SL'          C         W#PST6
     I              'DISC PA SL'          C         W#PST7
     I              'GUAR ISSUE'          C         W#PST8
     I              'CALL PA PU'          C         W#PST9                CLE005
     I              'CALL PA SL'          C         W#PS10                CLE005
     I              'RISK PA PU'          C         W#PS11                CLE005
     I              'RISK P SL1'          C         W#PS12                CLE005
     I              'RISK P SL2'          C         W#PS13                CLE005
     I              'FLAT LOAN '          C         W#PS14                                    CLE028
     I              'SupCorr4CustwSwiftID'C         #SUPRS                                  MD029242
     I*
     IDSPARM    E DSLTRIX
     I** External DS for parameter passed from CG6000
     I              RCDT                            ##RCD1
     I              CHTP                            ##CHT1
     I*
     I##UDCR    E DSCGUDCRPD
     I**  External DS for incomplete reference
     I*
     ISDBANK    E DSSDBANKPD
     I**  External DS for Bank details
     I*
     ISDBRCH    E DSSDBRCHPD
     I**  External DS for branch details
     I*
     ISDCUST    E DSSDCUSTPD
     I**  External DS for customer details
     I              QQDFAC                          QQDFA1                                    CGL029
     I*
     ISDBSRT    E DSSDBSRTPD
     I**  External DS for base rate details
     I*
     ISDCURR    E DSSDCURRPD                101
     I**  External DS for currency details
     I*
     ISCSARD    E DSSCSARDPD                                              CLE005
     I** Switchable Feature details                                       CLE005
     I*                                                                   CLE005
     ISDGELR    E DSSDGELRPD                                              CEU014
     I* DS for GL ICD Details                                             CEU014
     I*                                                                   CEU014
     IDSFDY     E DSDSFDY
     I**  First DS for access programs, short data structure
     I*
     IDSSDY     E DSDSSDY
     I**  Second DS for access programs, long data structure
     I*
     IW0FMT     E DSCGUDTAPD
     I**  Record format of PF/CGUDTAPD for use as a parameter
     I*
     I/COPY CGCPYSRC,CGPACKI
     I/COPY CGCPYSRC,SRERRI
     I*
     I**  DS to store subroutine specific data.
     I**  - Saved Path
     I*
     I##PATH      DS                         20
     I                                        1   6 ##GRPS
     I*
     I##BIND      DS                         20
     I I            1                         1   60##PBIN
     I I            1                         7  120##TBIN
     I*
     I            DS
     I I            1                         1   60#@BIND
     I*
     I#PDS        DS
     I I            0                         1   30P1
     I                                        4   60P2
     I                                        7   90P3
     I                                       10  120P4
     I                                       13  150P5
     I*
     ISVAL1       DS                            200                                         MD029242
     I                                        1   1 SVAL11                                  MD029242
      *                                                                                       CER038
     ISDMMOD    E DSSDMMODPD                                                                  CER038
      *                                                                                       CER038
     ISDMGME    E DSSDMGMEPD                                                                  CER038
      *                                                                                       CER038
     ISDTRAD    E DSSDTRADPD                                                                  CER038
     I              QQACCD                          QQDFA2                                    CER038
     ISDLOCN    E DSSDLOCNPD                                                                  CLE141
      *                                                                                       CER038
     I/COPY ZSRSRC,ZINTDYZ1
     I/COPY ZSRSRC,ZDATE9Z2
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I/COPY WNCPYSRC,CG6005I001
     I*
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Process     :  MAINLINE                                      *
     C*  Function    :  Mainline Processing                           *
     C*                                                               *
     C*  Called by   :  None                                          *
     C*  Calls       :  SRINIT - Initial Processing - On First Call   *
     C*                 SRINZF - Initialise Fields on Each Invocation *
     C*                 SRMAIN - Main Processing                      *
     C*                                                               *
     C*****************************************************************
     C*
     C**  Parameter list for current program invocation.
     C*
     C           *ENTRY    PLIST
     C                     PARM           W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           ##COPD  1
     C                     PARM           ##AUTO  1
     C                     PARM           ##SPPS  1                                           CER038
     C                     PARM           DSPARM
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'MAIN'    @STK,Q
     C*
     C**  Initial processing - Once Only.
     C*
     C           ##INIT    IFEQ *BLANK
     C                     EXSR SRINIT
     C                     MOVE 'Y'       ##INIT  1
     C                     ENDIF
     C*
     C**  Initialisation processing.
     C*
     C                     EXSR SRINZF
     C*
     C**  Main processing.
     C*
     C                     EXSR SRMAIN
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C**  Terminate program.
     C*
     C                     RETRN
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRMAIN                                        *
     C*  Function    :  Main Processing                               *
     C*                                                               *
     C*  Called by   :  MAINLINE - Mainline Processing                *
     C*  Calls       :  SRDETL - Obtain Detail Information            *
     C*                 SRGENR - Generate Reference Number            *
     C*                 L01CC  - Lending Commencement Confirmations   *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRMAIN    BEGSR                           ** SRMAIN **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRMAIN'  @STK,Q
     C*
     C**  Obtain Detail Information.
     C*
     C                     EXSR SRDETL
     C*
     C**  Generate reference number by writing to PF/CGUDCRPD.
     C**  If no confirmation to be produced, then bypass.
     C*
     C                     MOVE 'N'       ##COPD
     C/COPY WNCPYSRC,CG6005C020
      *                                                                                       CER038
     C                     MOVE 'N'       ##SPPS                                              CER038
     C           CER038    IFEQ 'Y'                                                           CER038
     C                     EXSR SRAUTO                                                        CER038
     C           ##SPPS    IFEQ 'Y'                                                           CER038
     C           ##SPPS    CABEQ'Y'       EXMAIN                                              CER038
     C                     ENDIF                                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     EXSR SRGENR
     C           ##COPD    CABEQ'N'       EXMAIN
     C*
     C**  Extract.
     C*
     C                     EXSR L01CC
     C*
     C           EXMAIN    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRMAI9    ENDSR                           ** SRMAI9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRDETL                                        *
     C*  Function    :  Obtain Detail Information                     *
     C*                                                               *
     C*  Called by   :  SRMAIN - Main Processing                      *
     C*  Calls       :  None                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRDETL    BEGSR                           ** SRDETL **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'DETAIL'  @STK,Q
     C*
     C           KCLOAN    KLIST
     C                     KFLD           LNRF
     C                     KFLD           RCDT
     C*
     C                     MOVEL'A'       RCDT    1
     C           KCLOAN    CHAINCLOAN                88
     C           *IN88     IFEQ '1'
     C                     MOVEL'CLOAN   'W0FILE           ************
     C                     MOVELLNRF      W0KEY            * DBERR 01 *
     C                     Z-ADD1         W0ERNB           ************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C                     MOVEL'B'       RCDT
     C           KCLOAN    CHAINCLOAN                88
     C           *IN88     IFEQ '1'
     C                     MOVEL'CLOAN   'W0FILE           ************
     C                     MOVELLNRF      W0KEY            * DBERR 02 *
     C                     Z-ADD2         W0ERNB           ************
     C                     MOVEL'MEM5004' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
      *                                                                   CLE005
      ** If CLE005 is on, for proc. type 72, access CLOANCL to            CLE005
      ** get the processing type of the loan sold, then rechain           CLE005
      ** back to using the original loan                                  CLE005
      *                                                                   CLE005
     C           ##PTYP    IFEQ 72                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C                     MOVE *BLANK    WOLN70  1                       CLE005
     C**********           Z-ADDLNRF      WOLNRF  60                                   CLE005 CLE148
     C                     MOVELLNRF      WOLNRF  6                                           CLE148
     C**********           Z-ADD##OLNO    LNRF                                         CLE005 CSD027
     C                     MOVE ##OLNO    LNRF                                                CSD027
     C                     MOVEL'A'       RCDT    1                       CLE005
      *                                                                   CLE005
     C           KCLOAN    CHAINCLOAN                88                   CLE005
     C           *IN88     IFEQ '1'                                       CLE005
     C                     MOVEL'CLOAN   'W0FILE           ************   CLE005
     C                     MOVELLNRF      W0KEY            * DBERR 13 *   CLE005
     C                     Z-ADD13        W0ERNB           ************   CLE005
     C                     MOVEL'MEM5004' W0MSGD                          CLE005
     C                     MOVEL'MIDAS  ' W0MSGF                          CLE005
     C                     EXSR SRERR                                     CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C           ##PTYP    IFEQ 70                                        CLE005
     C                     MOVE 'Y'       WOLN70                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** Rechain CLOANCL to get original loan details                     CLE005
      *                                                                   CLE005
     C**********           Z-ADDWOLNRF    LNRF                                         CLE005 CLE148
     C                     MOVELWOLNRF    LNRF                                                CLE148
     C                     MOVEL'A'       RCDT    1                       CLE005
      *                                                                   CLE005
     C           KCLOAN    CHAINCLOAN                88                   CLE005
     C           *IN88     IFEQ '1'                                       CLE005
     C                     MOVEL'CLOAN   'W0FILE           ************   CLE005
     C                     MOVELLNRF      W0KEY            * DBERR 14 *   CLE005
     C                     Z-ADD14        W0ERNB           ************   CLE005
     C                     MOVEL'MEM5004' W0MSGD                          CLE005
     C                     MOVEL'MIDAS  ' W0MSGF                          CLE005
     C                     EXSR SRERR                                     CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
     C/COPY WNCPYSRC,CG6005C001
     C*
     C** If an equal loan reference has been read, check if amendment
     C** type is 'RE'.   If it is, store the repayment value date to be
     C** used later in the calculation.
     C*
     C                     MOVE *BLANKS   ##AMT1
     C           LNRF      CHAINLOAMS                87
     C*
     C           *IN87     DOWEQ'0'
     C********** ##AMT1    ANDNE'RE'                                                          245914
     C           ##AMT1    IFEQ 'RE'
     C                     Z-ADD##VDA1    ##RPDT  50
     C**********           ELSE                                                               245914
     C                     END                                                                245914
     C           LNRF      READELOAMS                    87
     C**********           END                                                                245914
     C                     END
     C*
     C/COPY WNCPYSRC,CG6005C005
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRDET9    ENDSR                           ** SRDET9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRGENR                                        *
     C*  Function    :  Generate reference number by writing to       *
     C*                 PF/CGUDCRPD                                   *
     C*                                                               *
     C*  Called by   :  SRMAIN - Main Processing                      *
     C*  Calls       :  CG9010 - Create Item Reference Records        *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRGENR    BEGSR                           ** SRGENR **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRGENR'  @STK,Q
     C*
     C**  Generate reference number and check if further processing
     C**  required. Set up all available information in the record
     C**  format before calling.
     C*
     C                     CLEAR##UDCR
     C*
     C**  Booking/Main Branch (Mandatory).
     C*
     C                     MOVEL##BRCA    DRBRCA
     C*
     C**  Originating Branch (Optional).
     C*
     C                     MOVEL##ORBR    DRORBR
     C*
     C**  Module identifier (Mandatory).
     C*
     C                     MOVEL'LE'      DRMODI
     C*
     C**  Midas Transaction Number (Mandatory).
     C*
     C                     MOVELLNRF      DRMTRN
     C*
     C**  Midas GL Account Reference CNUMCCYACODACSQBRCA  (Optional).
     C*
     C                     MOVEL*BLANKS   DRMACT
     C*
     C**  Print Type.
     C*
     C                     MOVELW#PTYP    DRPTYP
     C*
     C**  Print Sub-type.
     C*
     C                     SELEC
     C           ##PTYP    WHEQ 61
     C                     MOVELW#PST1    DRPSTP
     C           ##PTYP    WHEQ 62
     C                     MOVELW#PST2    DRPSTP
     C           ##PTYP    WHEQ 63
     C                     MOVELW#PST3    DRPSTP
     C           ##PTYP    WHEQ 64
     C                     MOVELW#PST4    DRPSTP
     C           ##PTYP    WHEQ 65
     C                     MOVELW#PST5    DRPSTP
     C           ##PTYP    WHEQ 66
     C                     MOVELW#PST6    DRPSTP
     C           ##PTYP    WHEQ 67
     C                     MOVELW#PST7    DRPSTP
     C           ##PTYP    WHEQ 70
     C                     MOVELW#PST8    DRPSTP
     C                     ENDSL
      *                                                                   CLE005
     C           CLE005    IFEQ 'Y'                                       CLE005
     C           ##PTYP    IFEQ 68                                        CLE005
     C                     MOVELW#PST9    DRPSTP                          CLE005
     C                     ENDIF                                          CLE005
     C           ##PTYP    IFEQ 69                                        CLE005
     C                     MOVELW#PS10    DRPSTP                          CLE005
     C                     ENDIF                                          CLE005
     C           ##PTYP    IFEQ 71                                        CLE005
     C                     MOVELW#PS11    DRPSTP                          CLE005
     C                     ENDIF                                          CLE005
     C           ##PTYP    IFEQ 72                                        CLE005
     C           WOLN70    IFEQ 'Y'                                       CLE005
     C                     MOVELW#PS13    DRPSTP                          CLE005
     C                     ELSE                                           CLE005
     C                     MOVELW#PS12    DRPSTP                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
      *                                                                   CLE005
      ** If Flat Rate Personal Loans (Rule of 78s) CLE028 is                                  CLE028
      ** installed, set print item subtype field to 'FLAT LOAN' if                            CLE028
      ** processing a Flat Rate Personal Loan.                                                CLE028
      *                                                                                       CLE028
     C           ##PTYP    IFEQ 80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     MOVELW#PS14    DRPSTP                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C/COPY WNCPYSRC,CG6005C012
     C*
     C**  Auto Transmission indicator.
     C*
     C                     MOVEL'N'       DRATRM
     C*
     C**  Cheque Reference (Optional).
     C*
     C                     MOVEL*BLANKS   DRCHQR
     C*
     C**  Further Reference (Optional).
     C*
     C                     MOVEL*BLANKS   DRFREF
     C*
     C**  Customer Number (Mandatory).
     C*
     C                     MOVEL##CNUM    ##CUST
     C*
     C                     CALL 'CG9010'
     C                     PARM           ##RTCD  7
     C                     PARM '*GEN'    ##MODE 10
     C                     PARM W0CMT     ##CMT   3
     C                     PARM           ##CUST  6
     C                     PARM           ##UDCR
     C                     PARM           ##ITMA  8
     C*
     C**  Blank return code implies generate correspondence.
     C**  CGD1270 => no error, but suppress output for this transaction.
     C*
     C           ##RTCD    IFEQ *BLANK
      *                                                                                       CCG015
     C           DRPTYP    CAT  ':':0     COLON  11 P                                         CCG015
     C           COLON     CAT  DRPSTP:0  ##REFR    P                                         CCG015
     C                     EXSR WRAPRF                                                        CCG015
     C*
     C                     MOVE 'Y'       ##COPD
     C*
     C                     ELSE
     C*
     C           ##RTCD    IFNE 'CGD1270'
     C                     MOVEL'CG9010  'W0FILE
     C                     MOVEL##RTCD    W0KEY            ************
     C                     Z-ADD3         W0ERNB           * DBERR 03 *
     C                     MOVEL'CGD1286' W0MSGD           ************
     C                     MOVEL'CGUSRMSG'W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C*
     C                     ENDIF
     C*
     C           EXGENR    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  L01CC                                         *
     C*  Function    :  Lending Commencement Confirmations            *
     C*                                                               *
     C*  Called by   :  SRMAIN - Main Processing                      *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 LOANA  - Loan Associated Details              *
     C*                 LOAN   - Process Loan Details                 *
     C*                 L@IPY  - Process Interest Payment Details     *
     C*                 L@ROL  - Process Rollover Details             *
     C*                 L@REP  - Process Repayment Details            *
     C*                 L@GUAR - Process Guarantee Details            *
     C*                 SRSDET - Set-up Settlement Details            *
     C*                                                               *
     C*****************************************************************
     C*
     C           L01CC     BEGSR                           ** L01CC  **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'L01CC '  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'l01CC '  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
      *                                                                                       CCG015
     C                     EXSR LOANA
     C                     EXSR LOAN
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG6005CCP1                                           S01408
     C*                                                                   S01408
     C                     EXSR L@IPY
     C                     EXSR L@ROL
     C                     EXSR L@REP
     C                     EXSR L@GUAR
      *                                                                                       CER049
      ** Stamp Tax                                                                            CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     EXSR LNSTAX                                                        CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     EXSR SRSDET
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           L01CC9    ENDSR                           ** L01CC9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  LOAN                                          *
     C*  Function    :  Process Loan details                          *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 SRICAL - Calculate Interest                   *
     C*                 SRDCDT - Determine Currency Details           *
     C*                 SRADTA - Accumulate RDEs and Associated Data  *
     C*                 SRODTA - Output Accumulated Data to CGUDTAPD  *
     C*                 AOBSRTRO - Retrive Base Rate Code Details     *
     C*                                                               *
     C*****************************************************************
     C*
     C           LOAN      BEGSR                           ** LOAN   **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'LOAN  '  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'LOAN  '  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     Z-ADD0         R1      30
     C*
     C**  Base Rate Name.
     C*
     C           ##BRTT    IFEQ 0
     C                     MOVEL*BLANKS   ##BSRN 30
     C                     ELSE
     C*
     C                     MOVEL##BRTT    ##BSRC
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM ##CCY1    ##CYCD  3
     C                     PARM           ##BSRC  2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE
     C           ##CYCD    CAT  ##BSRC    W0KEY            ************
     C                     Z-ADD4         W0ERNB           * DBERR 04 *
     C                     MOVEL'MEM5004' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C                     MOVELBABSRN    ##BSRN
     C*
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'BASERATN'#@RDE
     C                     MOVE 'AM'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##BSRN    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
      *                                                                                       CLE036
      ** If CLE036 is installed, process base rate.                                           CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
      *                                                                                       CLE036
     C                     ADD  1         R1                                                  CLE036
     C                     CLEARR#DATA                                                        CLE036
     C                     CLEARR#DEFN                                                        CLE036
     C                     CLEAR#@RDE                                                         CLE036
     C                     MOVEL'BASE RAT'#@RDE                                               CLE036
     C                     MOVE 'E '      #@RDE                                               CLE036
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE036
     C                     MOVEL##BASR    R#DATA                                              CLE036
     C                     MOVELR#DATA    ##D,R1                                              CLE036
     C                     MOVELR#DEFN    ##R,R1                                              CLE036
     C                     ENDIF                                                              CLE036
     C*
     C**  Base Rate Type.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'BASERATT'#@RDE
     C                     MOVE 'YP'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##BRTT    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Currency Description.
     C*
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C                     MOVELA6CYNM    ##WRK  14
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'CCY_DESC'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##WRK     R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Current Principal (Amount).
     C*
     C           ##RCD1    IFEQ 'R'
     C                     Z-ADD##NPAM    ##PAMT 130
     C                     ELSE
     C                     Z-ADD##CPAM    ##PAMT
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) CLE028 is                                  CLE028
      ** installed , the Principal Amount confirmed must include                              CLE028
      ** interest and charges where these have been added on.                                 CLE028
      *                                                                                       CLE028
     C           ##ADCF    IFEQ 'Y'                                                           CLE028
     C           ##PTYP    ANDEQ80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     ADD  ##CHGA    ##PAMT                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C           ##ADIF    IFEQ 'Y'                                                           CLE028
     C           ##PTYP    ANDEQ80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     ADD  ##FLTI    ##PAMT                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'CUR PRIN'#@RDE
     C                     MOVE 'CL'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##PAMT    ##DATA
     C                     MOVEL'Amount'  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C/COPY WNCPYSRC,CG6005C015
     C                     MOVELA6NBDP    ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Currency.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'CURRENCY'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##CCY1    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Deal Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'DEAL DAT'#@RDE
     C                     MOVE 'E '      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##DDAT    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Discount Rate.
     C*
     C           ##RCD1    IFNE 'R'
     C*
     C           ##PTYP    IFEQ 63
     C           ##PTYP    OREQ 65
     C           ##PTYP    OREQ 67
     C                     Z-ADD##INTR    ##DISC 117
     C                     ELSE
     C                     Z-ADD0         ##DISC
     C                     END
     C*
     C                     ELSE
     C*
     C           ##NBRA    IFEQ 0
     C           CLE036    ANDEQ'N'                                                           CLE036
     C           ##NBRA    OREQ *ZERO                                                         CLE036
     C           ##NBSR    ANDEQ*ZERO                                                         CLE036
     C           CLE036    ANDEQ'Y'                                                           CLE036
     C                     Z-ADD0         ##BASE 117
     C                     ELSE
     C*
     C           ##NBRA    IFNE *ZERO                                                         CLE036
     C                     MOVEL##NBRA    ##BSRC
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM ##CCY1    ##CYCD  3
     C                     PARM           ##BSRC  2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE
     C           ##CYCD    CAT  ##BSRC    W0KEY            ************
     C                     Z-ADD5         W0ERNB           * DBERR 05 *
     C                     MOVEL'MEM5004' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           BAVDNR    IFGT ##RLDT
     C                     Z-ADDBACBSR    ##BASE
     C                     ELSE
     C                     Z-ADDBANBRT    ##BASE
     C                     END
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
      ** If CLE036 is on and ##NBSR is not zero, ##NBRA should have been zero                 CLE036
      ** so set ##BASE to ##NBSR to get discount rate.                                        CLE036
      *                                                                                       CLE036
     C           ##NBSR    IFNE *ZERO                                                         CLE036
     C           CLE036    ANDEQ'Y'                                                           CLE036
     C                     Z-ADD##NBSR    ##BASE                                              CLE036
     C                     ENDIF                                                              CLE036
     C*
     C                     END
     C*
     C           ##NSIN    IFEQ 'A'
     C           ##BASE    ADD  ##NRTS    ##DISC
     C                     ELSE
     C           ##NSIN    IFEQ 'S'
     C           ##BASE    SUB  ##NRTS    ##DISC
     C                     ELSE
     C           ##NRTS    DIV  100       ##WWRK 139
     C           ##WWRK    MULT ##BASE    ##DISC
     C           ##DISC    IFEQ 0
     C                     Z-ADD##INTR    ##DISC
     C                     END
     C                     END
     C                     END
     C*
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'DSC RATE'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##DISC    ##DATA
     C                     MOVEL'Rate  '  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL'7'       ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Rate.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'GRS DISC'#@RDE
     C                     MOVE 'NT'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##TOTI    ##DATA
     C                     MOVEL'Amount'  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C/COPY WNCPYSRC,CG6005C016
     C                     MOVELA6NBDP    ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Gross Interest.
     C*
     C********** ##REPT    IFEQ 1                                                             177914
     C********** ##REPT    OREQ 3                                                             177914
     C**********           Z-ADD0         ##TINT                                              177914
     C**********           ELSE                                                               177914
     C                     EXSR SRICAL
     C**********           END                                                                177914
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'GRS INTR'#@RDE
     C                     MOVE 'ST'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##TINT    ##DATA
     C                     MOVEL'Amount'  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C/COPY WNCPYSRC,CG6005C017
     C                     MOVELA6NBDP    ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Interest Calculation Basis.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'INT CALB'#@RDE
     C                     MOVE 'AS'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##ICBS    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Interest capitalization indicator.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'INT CAP '#@RDE
     C                     MOVE 'IN'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##INTC    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Interest Rate.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'INT RATE'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##INTR    ##DATA
     C                     MOVEL'Rate  '  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL'7'       ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Loan Reference.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'LOAN REF'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVELLNRF      R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Loan Total.
     C*
     C           ##RCD1    IFEQ 'R'
     C           ##NPAM    SUB  ##NDAM    ##TTAL
     C                     ELSE
     C           ##PTYP    IFEQ 61
     C           ##PTYP    OREQ 62
     C           ##PTYP    OREQ 64
     C           ##PTYP    OREQ 66
     C           ##PTYP    OREQ 68                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           ##PTYP    OREQ 69                                        CLE005
     C           CLE005    ANDEQ'Y'                                       CLE005
     C           ##PTYP    OREQ 80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C           ##CPAM    ADD  ##TINT    ##TTAL 130
     C                     ELSE
     C           ##PTYP    IFEQ 63
     C           ##PTYP    OREQ 65
     C           ##PTYP    OREQ 67
     C           ##CPAM    SUB  ##TOTI    ##TTAL
     C                     END
     C                     END
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) is installed and                           CLE028
      ** Add on Charges Flag is 'Y', charge amount will be included                           CLE028
      ** in the Loan Amount of a Flat Rate Personal Loans.                                    CLE028
      *                                                                                       CLE028
     C           ##ADCF    IFEQ 'Y'                                                           CLE028
     C           ##PTYP    ANDEQ80                                                            CLE028
     C           CLE028    ANDEQ'Y'                                                           CLE028
     C                     ADD  ##CHGA    ##TTAL                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'LOAN TOT'#@RDE
     C                     MOVE 'AL'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##TTAL    ##DATA
     C                     MOVEL'Amount'  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C/COPY WNCPYSRC,CG6005C018
     C                     MOVELA6NBDP    ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Maturity Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'MATUR DA'#@RDE
     C                     MOVE 'TE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##MDAT    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Run date; production time.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'RUNDAT  '#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVELBJRDNB    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Spread.
     C*
     C           ##SPIN    IFEQ 'A'
     C                     Z-ADD##RTSP    ##SPRD 117
     C                     ELSE
     C                     Z-SUB##RTSP    ##SPRD
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'SPREAD  '#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##SPRD    ##DATA
     C                     MOVEL'Rate  '  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL'7'       ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Value Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'VALUE DA'#@RDE
     C                     MOVE 'TE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##VDAT    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C** Current Principal in Settlement Currency                         CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'C_PRN_SC'#@RDE                           CEU014
     C                     MOVE 'CY'      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVEL'Amount'  ##RDEC                          CEU014
     C                     MOVEL'L'       ##RDET                          CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
      ** If Lending Enhancements is installed, make use                                       CLE031
      ** the appropriate settlement currency.                                                 CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Loan Currency                                       CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   WLINCY  1                                           CLE031
     C           ##CCY1    IFNE *BLANKS                                                       CLE031
     C                     MOVEL##CCY1    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
     C                     MOVE A6INCY    WLINCY                                              CLE031
     C                     Z-ADDA6NBDP    WLNBDP  10                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** For parts sold loans.                                                                CLE031
      *                                                                                       CLE031
     C           ##PTYP    IFEQ 66                                                            CLE031
     C           ##PTYP    OREQ 67                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           ##PTYP    ANDEQ69                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           ##PTYP    ANDEQ72                                                            CLE031
      *                                                                                       CLE031
      ** Conversion is done only if Receipt Settlement currency is                            CLE031
      ** non-blank and different from Loan Currency.                                          CLE031
      *                                                                                       CLE031
     C           ##CCY1    IFNE ##STCY                                                        CLE031
     C           ##STCY    ANDNE*BLANKS                                                       CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Receipt Settlement Currency.                        CLE031
      *                                                                                       CLE031
     C                     MOVEL##STCY    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
      *                                                                                       CLE031
      ** Convert by calling EU0200 if either of the two following conditions                  CLE031
      ** is satisfied:                                                                        CLE031
      ** 1. Loan currency is 'In' currency                                                    CLE031
      ** 2. Receipt settlement currency is 'In' currency                                      CLE031
      *                                                                                       CLE031
     C           WLINCY    IFEQ 'Y'                                                           CLE031
     C           A6INCY    OREQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADD##PAMT    P@FRAM                                              CLE031
     C                     MOVE ##CCY1    P@FRCY                                              CLE031
     C                     MOVE ##STCY    P@TOCY                                              CLE031
     C                     EXSR D@EURO                                                        CLE031
     C                     MOVEL##OUTA    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** If the above condition is not satisfied, convert the Principal Amount                CLE031
      ** using ZCONV and the appropriate settlement exchange rate and indicator               CLE031
      ** from CLOANCL.                                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADD##REXR    ZEXCH                                               CLE031
     C                     MOVE ##REXI    ZMD                                                 CLE031
     C                     Z-ADD##PAMT    ZAMTCI                                              CLE031
     C                     MOVE ##CCY1    ZCCYI                                               CLE031
     C                     MOVE ##STCY    ZCCYO                                               CLE031
     C                     Z-ADDWLNBDP    ZCDPI                                               CLE031
     C                     Z-ADDA6NBDP    ZCDPO                                               CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     MOVELZAMTCO    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Conversion is done only if Pay Settlement currency is                                CLE031
      ** non-blank and different from Loan Currency.                                          CLE031
      *                                                                                       CLE031
     C           ##CCY1    IFNE ##PSCY                                                        CLE031
     C           ##PSCY    ANDNE*BLANKS                                                       CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Pay Settlement Currency.                            CLE031
      *                                                                                       CLE031
     C                     MOVEL##PSCY    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
      *                                                                                       CLE031
      ** Convert by calling EU0200 if either of the two following conditions                  CLE031
      ** is satisfied:                                                                        CLE031
      ** 1. Loan currency is 'In' currency                                                    CLE031
      ** 2. Pay Settlement Currency is 'In' currency                                          CLE031
      *                                                                                       CLE031
     C           WLINCY    IFEQ 'Y'                                                           CLE031
     C           A6INCY    OREQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADD##PAMT    P@FRAM                                              CLE031
     C                     MOVE ##CCY1    P@FRCY                                              CLE031
     C                     MOVE ##PSCY    P@TOCY                                              CLE031
     C                     EXSR D@EURO                                                        CLE031
     C                     MOVEL##OUTA    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** If the above condition is not satisfied, convert the Principal Amount                CLE031
      ** using ZCONV and the appropriate settlement exchange rate and indicator               CLE031
      ** from CLOANCL.                                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADD##PEXR    ZEXCH                                               CLE031
     C                     MOVE ##PEXI    ZMD                                                 CLE031
     C                     Z-ADD##PAMT    ZAMTCI                                              CLE031
     C                     MOVE ##CCY1    ZCCYI                                               CLE031
     C                     MOVE ##PSCY    ZCCYO                                               CLE031
     C                     Z-ADDWLNBDP    ZCDPI                                               CLE031
     C                     Z-ADDA6NBDP    ZCDPO                                               CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     MOVELZAMTCO    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           ##STCY    ANDNE*BLANKS                                   CEU014
     C                     MOVEL##STCY    ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADD##PAMT    P@FRAM                          CEU014
     C                     MOVE ##CCY1    P@FRCY                          CEU014
     C                     MOVE ##STCY    P@TOCY                          CEU014
     C                     EXSR D@EURO                                    CEU014
     C                     MOVEL##OUTA    ##DATA                          CEU014
     C                     MOVELA6NBDP    ##DCPA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU014
     C** Loan Total in Settlement Currency                                CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'L_TOT_SC'#@RDE                           CEU014
     C                     MOVE 'CY'      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVEL'Amount'  ##RDEC                          CEU014
     C                     MOVEL'L'       ##RDET                          CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
      ** If Lending Enhancements is installed, make use of                                    CLE031
      ** the appropriate settlement currency.                                                 CLE031
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Loan Currency                                       CLE031
      *                                                                                       CLE031
     C                     MOVE *BLANKS   WLINCY  1                                           CLE031
     C           ##CCY1    IFNE *BLANKS                                                       CLE031
     C                     MOVEL##CCY1    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
     C                     MOVE A6INCY    WLINCY                                              CLE031
     C                     Z-ADDA6NBDP    WLNBDP  10                                          CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
      ** For parts sold loans.                                                                CLE031
      *                                                                                       CLE031
     C           ##PTYP    IFEQ 66                                                            CLE031
     C           ##PTYP    OREQ 67                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           ##PTYP    ANDEQ69                                                            CLE031
     C           CLE005    OREQ 'Y'                                                           CLE031
     C           ##PTYP    ANDEQ72                                                            CLE031
      *                                                                                       CLE031
      ** Conversion is done only if Receipt Settlement currency is                            CLE031
      ** non-blank and different from Loan Currency.                                          CLE031
      *                                                                                       CLE031
     C           ##CCY1    IFNE ##STCY                                                        CLE031
     C           ##STCY    ANDNE*BLANKS                                                       CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Receipt Settlement Currency.                        CLE031
      *                                                                                       CLE031
     C                     MOVEL##STCY    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
      *                                                                                       CLE031
      ** Convert by calling EU0200 if either of the two following conditions                  CLE031
      ** is satisfied:                                                                        CLE031
      ** 1. Loan currency is 'In' currency                                                    CLE031
      ** 2. Receipt settlement currency is 'In' currency                                      CLE031
      *                                                                                       CLE031
     C           WLINCY    IFEQ 'Y'                                                           CLE031
     C           A6INCY    OREQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADD##TTAL    P@FRAM                                              CLE031
     C                     MOVE ##CCY1    P@FRCY                                              CLE031
     C                     MOVE ##STCY    P@TOCY                                              CLE031
     C                     EXSR D@EURO                                                        CLE031
     C                     MOVEL##OUTA    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** If the above condition is not satisfied, convert the Loan Total                      CLE031
      ** using ZCONV and the appropriate settlement exchange rate and indicator               CLE031
      ** from CLOANCL.                                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADD##REXR    ZEXCH                                               CLE031
     C                     MOVE ##REXI    ZMD                                                 CLE031
     C                     Z-ADD##TTAL    ZAMTCI                                              CLE031
     C                     MOVE ##CCY1    ZCCYI                                               CLE031
     C                     MOVE ##STCY    ZCCYO                                               CLE031
     C                     Z-ADDWLNBDP    ZCDPI                                               CLE031
     C                     Z-ADDA6NBDP    ZCDPO                                               CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     MOVELZAMTCO    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** Conversion is done only if Pay Settlement currency is                                CLE031
      ** non-blank and different from Loan Currency.                                          CLE031
      *                                                                                       CLE031
     C           ##CCY1    IFNE ##PSCY                                                        CLE031
     C           ##PSCY    ANDNE*BLANKS                                                       CLE031
      *                                                                                       CLE031
      ** Retrieve the currency details of Pay Settlement Currency.                            CLE031
      *                                                                                       CLE031
     C                     MOVEL##PSCY    ##CCY                                               CLE031
     C                     EXSR SRDCDT                                                        CLE031
      *                                                                                       CLE031
      ** Convert by calling EU0200 if either of the two following conditions                  CLE031
      ** is satisfied:                                                                        CLE031
      ** 1. Loan currency is 'In' currency                                                    CLE031
      ** 2. Pay Settlement Currency is 'In' currency                                          CLE031
      *                                                                                       CLE031
     C           WLINCY    IFEQ 'Y'                                                           CLE031
     C           A6INCY    OREQ 'Y'                                                           CLE031
      *                                                                                       CLE031
     C                     Z-ADD##TTAL    P@FRAM                                              CLE031
     C                     MOVE ##CCY1    P@FRCY                                              CLE031
     C                     MOVE ##PSCY    P@TOCY                                              CLE031
     C                     EXSR D@EURO                                                        CLE031
     C                     MOVEL##OUTA    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
      ** If the above condition is not satisfied, convert the Loan Total                      CLE031
      ** using ZCONV and the appropriate settlement exchange rate and indicator               CLE031
      ** from CLOANCL.                                                                        CLE031
      *                                                                                       CLE031
     C                     Z-ADD##PEXR    ZEXCH                                               CLE031
     C                     MOVE ##PEXI    ZMD                                                 CLE031
     C                     Z-ADD##TTAL    ZAMTCI                                              CLE031
     C                     MOVE ##CCY1    ZCCYI                                               CLE031
     C                     MOVE ##PSCY    ZCCYO                                               CLE031
     C                     Z-ADDWLNBDP    ZCDPI                                               CLE031
     C                     Z-ADDA6NBDP    ZCDPO                                               CLE031
      *                                                                                       CLE031
     C                     EXSR ZCONV                                                         CLE031
      *                                                                                       CLE031
     C                     MOVELZAMTCO    ##DATA                                              CLE031
     C                     MOVELA6NBDP    ##DCPA                                              CLE031
     C                     MOVELR#DATA    ##D,R1                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ELSE                                                               CLE031
      *                                                                                       CLE031
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           ##STCY    ANDNE*BLANKS                                   CEU014
     C                     MOVEL##STCY    ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADD##TTAL    P@FRAM                          CEU014
     C                     MOVE ##CCY1    P@FRCY                          CEU014
     C                     MOVE ##STCY    P@TOCY                          CEU014
     C                     EXSR D@EURO                                    CEU014
     C                     MOVEL##OUTA    ##DATA                          CEU014
     C                     MOVELA6NBDP    ##DCPA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
     C*                                                                   CEU014
     C**  20 RDEs extracted for this group set so accumulate them and     CEU014
     C**  the associated data.                                            CEU014
     C*                                                                   CEU014
     C                     EXSR SRADTA                                    CEU014
     C                     Z-ADD0         R1                              CEU014
     C*                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C*                                                                   CEU014
     C** determine the Equivalent Currency                                CEU014
     C*                                                                   CEU014
     C                     MOVE *BLANKS   EQCY    3                       CEU014
     C                     MOVE ##CCY1    ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C           A6INCY    IFEQ 'Y'                                       CEU014
     C                     MOVE BKEURO    EQCY                            CEU014
     C                     ENDIF                                          CEU014
     C           ##CCY1    IFEQ BKEURO                                    CEU014
     C                     MOVEL##CNUM    ##KEY2                          CEU014
     C                     CALL 'AOCUSTR0'                                CEU014
     C                     PARM *BLANKS   ##RTCD                          CEU014
     C                     PARM '*KEY   ' ##OPTN                          CEU014
     C                     PARM           ##KEY2 10                       CEU014
     C                     PARM *BLANKS   ##KYST  7                       CEU014
     C           SDCUST    PARM SDCUST    DSSDY                           CEU014
     C*                                                                   CEU014
     C           ##RTCD    IFNE *BLANK                                    CEU014
     C                     MOVEL'SDCUSTPD'W0FILE                          CEU014
     C                     MOVEL##CNUM    W0KEY            ************   CEU014
     C                     Z-ADD18        W0ERNB           * DBERR 18 *   CEU014
     C                     MOVEL'MEM5004' W0MSGD           ************   CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C                     MOVE BBDINC    EQCY                            CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C** Current Principal in Equivalent Currency                         CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'C_PRN_EQ'#@RDE                           CEU014
     C                     MOVE 'CY'      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVEL'Amount'  ##RDEC                          CEU014
     C                     MOVEL'L'       ##RDET                          CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           EQCY      ANDNE*BLANKS                                   CEU014
     C                     MOVELEQCY      ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADD##PAMT    P@FRAM                          CEU014
     C                     MOVE ##CCY1    P@FRCY                          CEU014
     C                     MOVE EQCY      P@TOCY                          CEU014
     C                     EXSR D@EURO                                    CEU014
     C                     MOVEL##OUTA    ##DATA                          CEU014
     C                     MOVELA6NBDP    ##DCPA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C** Loan Total in Equivalent Currency                                CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'L_TOT_EQ'#@RDE                           CEU014
     C                     MOVE 'CY'      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVEL'Amount'  ##RDEC                          CEU014
     C                     MOVEL'L'       ##RDET                          CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           EQCY      ANDNE*BLANKS                                   CEU014
     C                     MOVELEQCY      ##CCY                           CEU014
     C                     EXSR SRDCDT                                    CEU014
     C                     Z-ADD##TTAL    P@FRAM                          CEU014
     C                     MOVE ##CCY1    P@FRCY                          CEU014
     C                     MOVE EQCY      P@TOCY                          CEU014
     C                     EXSR D@EURO                                    CEU014
     C                     MOVEL##OUTA    ##DATA                          CEU014
     C                     MOVELA6NBDP    ##DCPA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C** Equivalent Currency                                              CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'EQUIV_CC'#@RDE                           CEU014
     C                     MOVE 'Y '      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           EQCY      ANDNE*BLANKS                                   CEU014
     C                     MOVELEQCY      ##DATA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C** Equivalent Currency Description                                  CEU014
     C*                                                                   CEU014
     C                     ADD  1         R1                              CEU014
     C                     CLEARR#DATA                                    CEU014
     C                     CLEARR#DEFN                                    CEU014
     C                     CLEAR#@RDE                                     CEU014
     C                     MOVEL'EQUIV_CC'#@RDE                           CEU014
     C                     MOVE 'YD'      #@RDE                           CEU014
     C           ##RDE     CAT  #@RDE:1   ##RDE                           CEU014
     C                     MOVELR#DEFN    ##R,R1                          CEU014
     C*                                                                   CEU014
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           EQCY      ANDNE*BLANKS                                   CEU014
     C                     MOVELA6CYNM    ##DATA                          CEU014
     C                     MOVELR#DATA    ##D,R1                          CEU014
     C                     ENDIF                                          CEU014
     C*                                                                   CEU014
     C           CLE143    IFEQ 'Y'                                                           CLE143
      *                                                                                       CLE143
      ** Original Contract Date                                                               CLE143
      *                                                                                       CLE143
     C                     ADD  1         R1                                                  CLE143
     C                     CLEARR#DATA                                                        CLE143
     C                     CLEARR#DEFN                                                        CLE143
     C                     CLEAR#@RDE                                                         CLE143
     C                     MOVEL'ORIGCDAT'#@RDE                                               CLE143
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE143
     C                     MOVEL##OCDT    ##DATA                                              CLE143
     C                     MOVEL'Date  '  ##RDEC                                              CLE143
     C                     MOVELR#DATA    ##D,R1                                              CLE143
     C                     MOVELR#DEFN    ##R,R1                                              CLE143
      *                                                                                       CLE143
      ** Effective Annual Interest Rate                                                       CLE143
      *                                                                                       CLE143
     C                     ADD  1         R1                                                  CLE143
     C                     CLEARR#DATA                                                        CLE143
     C                     CLEARR#DEFN                                                        CLE143
     C                     CLEAR#@RDE                                                         CLE143
     C                     MOVEL'EFFAINTR'#@RDE                                               CLE143
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE143
     C                     MOVEL##EAIR    ##DATA                                              CLE143
     C                     MOVEL'Rate  '  ##RDEC                                              CLE143
     C                     MOVEL'L'       ##RDET                                              CLE143
     C**********           MOVEL'7'       ##DCPA                                     CLE143 AR822053
     C                     MOVEL'8'       ##DCPA                                            AR822053
     C                     MOVELR#DATA    ##D,R1                                              CLE143
     C                     MOVELR#DEFN    ##R,R1                                              CLE143
      *                                                                                       CLE143
      ** CLE143 Switchable Feature status RDE                                                 CLE143
      *                                                                                       CLE143
     C                     ADD  1         R1                                                  CLE143
     C                     CLEARR#DATA                                                        CLE143
     C                     CLEARR#DEFN                                                        CLE143
     C                     CLEAR#@RDE                                                         CLE143
     C                     MOVEL'CLE143F '#@RDE                                               CLE143
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE143
     C                     MOVELCLE143    ##DATA                                              CLE143
     C                     MOVELR#DATA    ##D,R1                                              CLE143
     C                     MOVELR#DEFN    ##R,R1                                              CLE143
     C                     ENDIF                                                              CLE143
      *                                                                                       CLE143
      ** Contractual Spread                                                                   CRE073
      *                                                                                       CRE073
     C           CRE073    IFEQ 'Y'                                                           CRE073
     C                     ADD  1         R1                                                  CRE073
     C                     CLEARR#DATA                                                        CRE073
     C                     CLEARR#DEFN                                                        CRE073
     C                     CLEAR#@RDE                                                         CRE073
     C                     MOVEL'CONTSPR' #@RDE                                               CRE073
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CRE073
     C                     MOVEL##CNSP    ##DATA                                              CRE073
     C                     MOVEL'Rate  '  ##RDEC                                              CRE073
     C                     MOVEL'L'       ##RDET                                              CRE073
     C                     MOVEL'7'       ##DCPA                                              CRE073
     C                     MOVELR#DATA    ##D,R1                                              CRE073
     C                     MOVELR#DEFN    ##R,R1                                              CRE073
      *                                                                                       CRE073
      ** Contractual Spread Sign                                                              CRE073
      *                                                                                       CRE073
     C                     ADD  1         R1                                                  CRE073
     C                     CLEARR#DATA                                                        CRE073
     C                     CLEARR#DEFN                                                        CRE073
     C                     CLEAR#@RDE                                                         CRE073
     C                     MOVEL'CONTSSG' #@RDE                                               CRE073
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CRE073
     C                     MOVEL##CNSG    ##DATA                                              CRE073
     C                     MOVELR#DATA    ##D,R1                                              CRE073
     C                     MOVELR#DEFN    ##R,R1                                              CRE073
      *                                                                                       CRE073
      ** Rounding Method                                                                      CRE073
      *                                                                                       CRE073
     C                     ADD  1         R1                                                  CRE073
     C                     CLEARR#DATA                                                        CRE073
     C                     CLEARR#DEFN                                                        CRE073
     C                     CLEAR#@RDE                                                         CRE073
     C                     MOVEL'RNDMTD'  #@RDE                                               CRE073
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CRE073
     C                     MOVEL##RDMT    ##DATA                                              CRE073
     C                     MOVELR#DATA    ##D,R1                                              CRE073
     C                     MOVELR#DEFN    ##R,R1                                              CRE073
      *                                                                                       CRE073
      ** Rounding Fraction/Decimal                                                            CRE073
      *                                                                                       CRE073
     C                     ADD  1         R1                                                  CRE073
     C                     CLEARR#DATA                                                        CRE073
     C                     CLEARR#DEFN                                                        CRE073
     C                     CLEAR#@RDE                                                         CRE073
     C                     MOVEL'RNDFRCD' #@RDE                                               CRE073
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CRE073
     C                     MOVEL##RDFD    ##DATA                                              CRE073
     C                     MOVELR#DATA    ##D,R1                                              CRE073
     C                     MOVELR#DEFN    ##R,R1                                              CRE073
      *                                                                                       CRE073
      ** CRE073 Switchable Feature                                                            CRE073
      *                                                                                       CRE073
     C                     ADD  1         R1                                                  CRE073
     C                     CLEARR#DATA                                                        CRE073
     C                     CLEARR#DEFN                                                        CRE073
     C                     CLEAR#@RDE                                                         CRE073
     C                     MOVEL'CRE073F' #@RDE                                               CRE073
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CRE073
     C                     MOVELCRE073    ##DATA                                              CRE073
     C                     MOVELR#DATA    ##D,R1                                              CRE073
     C                     MOVELR#DEFN    ##R,R1                                              CRE073
      *                                                                                       CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
      ** CLE141 Switchable Feature status RDE                                                 CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CLE141F '#@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELCLE141    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C*                                                                                       CLE141
     C** DETERMINE THE BUSINESS DAY CONVENTION FOR INTEREST AND PRIN. SETTLEMENT              CLE141
     C*                                                                                       CLE141
     C           CLE141    IFEQ 'Y'                                                           CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 1                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR1INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C1PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC1PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 2                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR2INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C2PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC2PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 3                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR3INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C3PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC3PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 4                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR4INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C4PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC4PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 5                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR5INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C5PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC5PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 6                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR6INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C6PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC6PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 7                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR7INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C7PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC7PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
     C*                                                                                       CLE141
     C**  20 RDEs extracted for this group set so accumulate them and                         CLE141
     C**  the associated data.                                                                CLE141
     C*                                                                                       CLE141
     C                     EXSR SRADTA                                                        CLE141
     C                     Z-ADD0         R1                                                  CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 8                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR8INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C8PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC8PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 9                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR9INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C9PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC9PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Currency 10                                                   CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR0INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C0PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELC0PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 1                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC1INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L1PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL1PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 1                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD  7                                           CLE141
     C                     PARM '*KEY    'UFOPTN  7                                           CLE141
     C                     PARM L1PI      UFLOCN  3                                           CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON1INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 2                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC2INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L2PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL2PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 2                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L2PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON2INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 3                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC3INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L3PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL3PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 3                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L3PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON3INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 4                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC4INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L4PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL4PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 4                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L4PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON4INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 5                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC5INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L5PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL5PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 5                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L5PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON5INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 6                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC6INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L6PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL6PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 6                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L6PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON6INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 7                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC7INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L7PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL7PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 7                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L7PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON7INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 8                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC8INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L8PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL8PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 8                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L8PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON8INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
     C*                                                                                       CLE141
     C**  20 RDEs extracted for this group set so accumulate them and                         CLE141
     C**  the associated data.                                                                CLE141
     C*                                                                                       CLE141
     C                     EXSR SRADTA                                                        CLE141
     C                     Z-ADD0         R1                                                  CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 9                                                    CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC9INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L9PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL9PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 9                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L9PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON9INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Interest and Principal Location 10                                                   CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC0INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L0PI      IFNE *BLANKS                                                       CLE141
     C                     MOVELL0PI      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 10                                                            CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L0PI      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON0INTP'#@RDE                                               CLE141
     C                     MOVE 'AY'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 1                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR1ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C1PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC1PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 2                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR2ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C2PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC2PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 3                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR3ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C3PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC3PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 4                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR4ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C4PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC4PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 5                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR5ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C5PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC5PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 6                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR6ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C6PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC6PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 7                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR7ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C7PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC7PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 8                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR8ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C8PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC8PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 9                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR9ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C9PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC9PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Currency 10                                                 CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'CUR0ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           C0PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELC0PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 1                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC1ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L1PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL1PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 1                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L1PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON1ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 2                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC2ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L2PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL2PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 1                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L2PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON2ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 3                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC3ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L3PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL3PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 3                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L3PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON3ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
     C*                                                                                       CLE141
     C**  20 RDEs extracted for this group set so accumulate them and                         CLE141
     C**  the associated data.                                                                CLE141
     C*                                                                                       CLE141
     C                     EXSR SRADTA                                                        CLE141
     C                     Z-ADD0         R1                                                  CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 4                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC4ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L4PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL4PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 4                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L4PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON4ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 5                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC5ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L5PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL5PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 5                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L5PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON5ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 6                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC6ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L6PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL6PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 6                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L6PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON6ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 7                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC7ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L7PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL7PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 7                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L7PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON7ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 8                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC8ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L8PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL8PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 8                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L8PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON8ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 9                                                  CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC9ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L9PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL9PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 9                                                             CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L9PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON9ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
      ** Rollover and Rate Fixing Location 10                                                 CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LOC0ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
      *                                                                                       CLE141
     C           L0PR      IFNE *BLANKS                                                       CLE141
     C                     MOVELL0PR      ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
      *                                                                                       CLE141
      ** Retrieve Location Name 10                                                            CLE141
      *                                                                                       CLE141
     C                     CALL 'AOLOCNR0'                                                    CLE141
     C                     PARM *BLANKS   UFRTCD                                              CLE141
     C                     PARM '*KEY    'UFOPTN                                              CLE141
     C                     PARM L0PR      UFLOCN                                              CLE141
     C           SDLOCN    PARM SDLOCN    DSFDY                                               CLE141
      *                                                                                       CLE141
     C                     ADD  1         R1                                                  CLE141
     C                     CLEARR#DATA                                                        CLE141
     C                     CLEARR#DEFN                                                        CLE141
     C                     CLEAR#@RDE                                                         CLE141
     C                     MOVEL'LON0ROLL'#@RDE                                               CLE141
     C                     MOVE 'RT'      #@RDE                                               CLE141
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE141
     C                     MOVELR#DEFN    ##R,R1                                              CLE141
     C                     MOVELDVLCNM    ##DATA                                              CLE141
     C                     MOVELR#DATA    ##D,R1                                              CLE141
     C                     ENDIF                                                              CLE141
      *                                                                                       CLE141
     C                     ENDIF                                                              CLE141
     C*                                                                                       CLE141
     C/COPY WNCPYSRC,CG6005C006
     C**  Accumulate RDEs and associated data and output to PF/CGUDTPD.
     C*
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           LOAN9     ENDSR                           ** LOAN9  **
     C*
     C*****************************************************************
     C*                                                                   S01408
     C/COPY WNCPYSRC,CG6005CCP2                                           S01408
     C*                                                                   S01408
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  L@ROL                                         *
     C*  Function    :  Process Rollover Details                      *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 SRADTA - Accumulate RDEs and Associated Data  *
     C*                 SRODTA - Output Accumulated Data to CGUDTAPD  *
     C*                 AOBSRTRO - Retrive Base Rate Code Details     *
     C*                                                               *
     C*****************************************************************
     C*
     C           L@ROL     BEGSR                           ** L@ROL  **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'L@ROL '  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'L_ROL '  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     Z-ADD0         R1      30
     C*
     C**  Next Base Rate Name.
     C*
     C           ##NBRA    IFEQ 0
     C                     MOVEL*BLANKS   ##NBRN 30
     C                     ELSE
     C*
     C                     MOVEL##NBRA    ##BSRC
     C                     CALL 'AOBSRTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM ##CCY1    ##CYCD  3
     C                     PARM           ##BSRC  2
     C********** SDBSRT    PARM SDBSRT    DSFDY                                 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                                 CSD006
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBSRTPD'W0FILE
     C           ##CYCD    CAT  ##BSRC    W0KEY            ************
     C                     Z-ADD6         W0ERNB           * DBERR 06 *
     C                     MOVEL'MEM5004' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C                     MOVELBABSRN    ##NBRN
     C*
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT BSRN'#@RDE
     C                     MOVE 'AM'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NBRN    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
      *                                                                                       CLE036
      ** If CLE036 is installed, process next base rate.                                      CLE036
      *                                                                                       CLE036
     C           CLE036    IFEQ 'Y'                                                           CLE036
      *                                                                                       CLE036
     C                     ADD  1         R1                                                  CLE036
     C                     CLEARR#DATA                                                        CLE036
     C                     CLEARR#DEFN                                                        CLE036
     C                     CLEAR#@RDE                                                         CLE036
     C                     MOVEL'NXT BSRA'#@RDE                                               CLE036
     C                     MOVE 'TE'      #@RDE                                               CLE036
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CLE036
     C                     MOVEL##NBSR    R#DATA                                              CLE036
     C                     MOVELR#DATA    ##D,R1                                              CLE036
     C                     MOVELR#DEFN    ##R,R1                                              CLE036
     C                     ENDIF                                                              CLE036
     C*
     C**  Next Base Rate Type.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT BSRT'#@RDE
     C                     MOVE 'YP'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NBRA    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C** Next Interest Calculation Basis.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT INTC'#@RDE
     C                     MOVE 'LB'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NCAS    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Next Rollover Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT RLDA'#@RDE
     C                     MOVE 'TE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NROD    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Next Spread.
     C*
     C           ##NSIN    IFEQ 'A'
     C                     Z-ADD##NRTS    ##NSPR 117
     C                     ELSE
     C                     Z-SUB##NRTS    ##NSPR
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT SPRE'#@RDE
     C                     MOVE 'AD'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NSPR    ##DATA
     C                     MOVEL'Rate  '  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL'7'       ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Rollover Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'ROLL DAT'#@RDE
     C                     MOVE 'E '      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RLDT    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Rollover Day in Month.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'ROLL DAY'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RLDY    ##DATA
     C                     MOVEL'Day   '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Rollover Frequency.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'ROLL FRE'#@RDE
     C                     MOVE 'Q '      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RLFQ    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Rollover Indicator.
     C*
     C           ##RCD1    IFEQ 'R'
     C                     MOVE 'Y'       ##ROIN  1
     C                     ELSE
     C                     MOVE ' '       ##ROIN
     C                     END
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'ROLLIND '#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##ROIN    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Accumulate RDEs and associated data and output to PF/CGUDTPD.
     C*
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           L@ROL9    ENDSR                           ** L@ROL9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  L@REP                                         *
     C*  Function    :  Process Repayment Details                     *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 SRDCDT - Determine Currency Details           *
     C*                 SRADTA - Accumulate RDEs and Associated Data  *
     C*                 SRODTA - Output Accumulated Data to CGUDTAPD  *
     C*                                                               *
     C*****************************************************************
     C*
     C           L@REP     BEGSR                           ** L@REP  **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'L@REP '  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'L_REP '  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     Z-ADD0         R1      30
     C*
     C**  Next Repayment Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT RPDA'#@RDE
     C                     MOVE 'TE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NRPD    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Repayment Amount.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'REPAY AM'#@RDE
     C                     MOVE 'NT'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RAMT    ##DATA
     C                     MOVEL'Amount'  ##RDEC
     C                     MOVEL'L'       ##RDET
     C                     MOVEL##CCY1    ##CCY
     C                     EXSR SRDCDT
     C/COPY WNCPYSRC,CG6005C019
     C                     MOVELA6NBDP    ##DCPA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Repayment Day in Month.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'REPAY DA'#@RDE
     C                     MOVE 'Y '      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RDYN    ##DATA
     C                     MOVEL'Day   '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Repayment Frequency.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'REPAY FR'#@RDE
     C                     MOVE 'EQ'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##RFRQ    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Repayment Type.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'REPAY TY'#@RDE
     C                     MOVE 'PE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##REPT    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Accumulate RDEs and associated data and output to PF/CGUDTPD.
     C*
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           L@REP9    ENDSR                           ** L@REP9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  L@IPY                                         *
     C*  Function    :  Process Interest Payment details              *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 SRADTA - Accumulate RDEs and Associated Data  *
     C*                 SRODTA - Output Accumulated Data to CGUDTAPD  *
     C*                                                               *
     C*****************************************************************
     C*
     C           L@IPY     BEGSR                           ** L@IPY  **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'L@IPY '  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'L_IPY '  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     Z-ADD0         R1      30
     C*
     C**  Interest Payment Day.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'INT DAY '#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##IFDY    ##DATA
     C                     MOVEL'Day   '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Interest Payment Frequency.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'INT FREQ'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##IPFR    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Next Interest Payment Date.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'NXT IPDA'#@RDE
     C                     MOVE 'TE'      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##NIDT    ##DATA
     C                     MOVEL'Date  '  ##RDEC
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C/COPY WNCPYSRC,CG6005C014
     C*
     C**  Accumulate RDEs and associated data and output to PF/CGUDTPD.
     C*
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           L@IPY9    ENDSR                           ** L@IPY9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  L@GUAR                                        *
     C*  Function    :  Process Guarantee details                     *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 SRADTA - Accumulate RDEs and Associated Data  *
     C*                 SRODTA - Output Accumulated Data to CGUDTAPD  *
     C*                 AOCUSTR0 - Retrieve Customer Details          *
     C*                                                               *
     C*****************************************************************
     C*
     C           L@GUAR    BEGSR                           ** L@GUAR **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'L@GUAR'  @STK,Q
     C*
     C                     ADD  1         P1
     C*
     C           P1        OCUR ##PATH
     C                     MOVEL'L_GUAR'  ##GRPS    P
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     Z-ADD0         R1      30
     C*
     C********** ##RECE    IFEQ 0                                                             CSD027
     C           ##RECE    IFEQ *BLANKS                                                       CSD027
     C                     MOVEL*BLANKS   ##GRNM 20
     C                     MOVEL*BLANKS   ##GRTN 10
     C                     ELSE
     C*
     C                     MOVEL##RECE    ##KEY1
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   ##RTCD
     C                     PARM '*KEY   ' ##OPTN
     C                     PARM           ##KEY1 10
     C                     PARM *BLANKS   ##KYST  7
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCUSTPD'W0FILE
     C                     MOVEL##RECE    W0KEY            ************
     C                     Z-ADD7         W0ERNB           * DBERR 07 *
     C                     MOVEL'MEM5004' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C                     MOVELBBCRNM    ##GRNM
     C                     MOVELBBCRTN    ##GRTN
     C*
     C                     END
     C*
     C**  Receiver of Guarantee Name.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVEL'RECGUANA'#@RDE
     C                     MOVE 'M '      #@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##GRNM    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C*
     C**  Receiver of Guarantee Town.
     C*
     C                     ADD  1         R1
     C                     CLEARR#DATA
     C                     CLEARR#DEFN
     C                     CLEAR#@RDE
     C                     MOVE 'N '      #@RDE
     C                     MOVEL'RECGUATW'#@RDE
     C           ##RDE     CAT  #@RDE:1   ##RDE
     C                     MOVEL##GRTN    R#DATA
     C                     MOVELR#DATA    ##D,R1
     C                     MOVELR#DEFN    ##R,R1
     C/COPY WNCPYSRC,CG6005C007
     C*
     C**  Accumulate RDEs and associated data and output to PF/CGUDTPD.
     C*
     C                     EXSR SRADTA
     C                     EXSR SRODTA
     C*
     C**  Decrement Path DS index.
     C*
     C           P1        OCUR ##PATH
     C                     CLEAR##GRPS
     C                     SUB  1         P1
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           L@GUA9    ENDSR                           ** L@GUA9 **
     C*
     C*****************************************************************
      /EJECT                                                                                  CER049
      *****************************************************************                       CER049
      *                                                               *                       CER049
      *  Subroutine  :  LNSTAX                                        *                       CER049
      *  Function    :  Process Stamp Tax information                 *                       CER049
      *                                                               *                       CER049
      *  Called by   :  L01CC  - Lending Commencement Confirmations   *                       CER049
      *  Calls       :  SRPATH - Generate Path String                 *                       CER049
      *                 SRADTA - Accumulate RDEs and Associated Data  *                       CER049
      *                 SRODTA - Output Accumulated Data to CGUDTAPD  *                       CER049
      *                                                               *                       CER049
      *****************************************************************                       CER049
      *                                                                                       CER049
     C           LNSTAX    BEGSR                           ** LNSTAX **                       CER049
      *                                                                                       CER049
      ** Set up subroutine stack name.                                                        CER049
      *                                                                                       CER049
     C                     ADD  1         Q                                                   CER049
     C                     MOVEL'LNSTAX'  @STK,Q                                              CER049
      *                                                                                       CER049
     C                     ADD  1         P1                                                  CER049
      *                                                                                       CER049
     C           P1        OCUR ##PATH                                                        CER049
     C                     MOVEL'LNSTAX'  ##GRPS    P                                         CER049
     C                     EXSR SRPATH                                                        CER049
     C                     EXSR PSHGRS                                                        CER049
      *                                                                                       CER049
     C                     Z-ADD0         R1      30                                          CER049
      *                                                                                       CER049
      ** Set Loan number key                                                                  CER049
      *                                                                                       CER049
     C**********           Z-ADDLNRF      K1LNRF  60                                   CER049 CLE148
     C                     MOVELLNRF      K1LNRF  6                                           CLE148
      *                                                                                       CER049
      ** Retrieve the stamp tax record for the loan                                           CER049
      *                                                                                       CER049
     C           K1LNRF    CHAINCLONCLL1             98                                       CER049
      *                                                                                       CER049
      ** If record found, extract stamp tax data                                              CER049
      *                                                                                       CER049
     C           *IN98     IFEQ *OFF                                                          CER049
      *                                                                                       CER049
      ** Stamp Tax Liable Flag                                                                CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZSTAXFLG'#@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQTAX     R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Principal Tax flag                                                                   CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXPRFL'#@RDE                                               CER049
     C                     MOVE 'G '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQPRIN    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Start Date for Principal Tax                                                         CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXPRDT'#@RDE                                               CER049
     C                     MOVE 'E '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQPDTE    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Average Balance Flag                                                                 CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXAVFL'#@RDE                                               CER049
     C                     MOVE 'G '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQAVBL    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Start Date for Average Balance                                                       CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXAVDT'#@RDE                                               CER049
     C                     MOVE 'E '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQADTE    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Interest Tax Flag                                                                    CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXINFL'#@RDE                                               CER049
     C                     MOVE 'G '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQSINT    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Start Date for Interest Tax                                                          CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXINDT'#@RDE                                               CER049
     C                     MOVE 'E '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQIDTE    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Debit Account Reference                                                              CER049
      *                                                                                       CER049
     C           LQDCST    CAT  LQDCCY    WDRAC1  9                                           CER049
     C                     MOVELWDRAC1    WDRAC2 19                                           CER049
     C                     MOVE LQDACD    WDRAC2                                              CER049
     C                     MOVELWDRAC2    WDRAC3 21                                           CER049
     C                     MOVE LQDASC    WDRAC3                                              CER049
     C           WDRAC3    CAT  LQDBRC    WDRACC 24                                           CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ACCOUNT' #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELWDRACC    R#DATA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Stamp Tax amount                                                                     CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'Z_TAX_AM'#@RDE                                               CER049
     C                     MOVE 'T '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQSTAB    ##DATA                                              CER049
     C                     MOVEL'Amount'  ##RDEC                                              CER049
     C                     MOVEL'L'       ##RDET                                              CER049
     C                     MOVELLQDCCY    ##CCY                                               CER049
     C                     EXSR SRDCDT                                                        CER049
     C                     MOVELA6NBDP    ##DCPA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Stamp Tax On Interest                                                                CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXINAM'#@RDE                                               CER049
     C                     MOVE 'T '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQSTAI    ##DATA                                              CER049
     C                     MOVEL'Amount'  ##RDEC                                              CER049
     C                     MOVEL'L'       ##RDET                                              CER049
     C                     MOVELLQDCCY    ##CCY                                               CER049
     C                     EXSR SRDCDT                                                        CER049
     C                     MOVELA6NBDP    ##DCPA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
      ** Stamp Tax on Average This Month                                                      CER049
      *                                                                                       CER049
     C                     ADD  1         R1                                                  CER049
     C                     CLEARR#DATA                                                        CER049
     C                     CLEARR#DEFN                                                        CER049
     C                     CLEAR#@RDE                                                         CER049
     C                     MOVEL'ZTAXAVAM'#@RDE                                               CER049
     C                     MOVE 'T '      #@RDE                                               CER049
     C           ##RDE     CAT  #@RDE:1   ##RDE                                               CER049
     C                     MOVELLQTAXE    ##DATA                                              CER049
     C                     MOVEL'Amount'  ##RDEC                                              CER049
     C                     MOVEL'L'       ##RDET                                              CER049
     C                     MOVELLQDCCY    ##CCY                                               CER049
     C                     EXSR SRDCDT                                                        CER049
     C                     MOVELA6NBDP    ##DCPA                                              CER049
     C                     MOVELR#DATA    ##D,R1                                              CER049
     C                     MOVELR#DEFN    ##R,R1                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Accumulate RDEs and associated data and output to PF/CGUDTPD.                        CER049
      *                                                                                       CER049
     C                     EXSR SRADTA                                                        CER049
     C                     EXSR SRODTA                                                        CER049
      *                                                                                       CER049
      ** Decrement Path DS index.                                                             CER049
      *                                                                                       CER049
     C           P1        OCUR ##PATH                                                        CER049
     C                     CLEAR##GRPS                                                        CER049
     C                     SUB  1         P1                                                  CER049
     C                     EXSR POPGRS                                                        CER049
      *                                                                                       CER049
      ** Unwind subroutine stack name.                                                        CER049
      *                                                                                       CER049
     C                     MOVEA*BLANKS   @STK,Q                                              CER049
     C                     SUB  1         Q                                                   CER049
      *                                                                                       CER049
     C           LNSTA9    ENDSR                           ** LNSTA9 **                       CER049
      *                                                                                       CER049
      *****************************************************************                       CER049
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  LOANA                                         *
     C*  Function    :  Loan Associated Details                       *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 CG6001 - General Loan Details                 *
     C*****************************************************************
     C*
     C           LOANA     BEGSR                           ** LOANA  **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'LOANA '  @STK,Q
     C*
     C                     EXSR SRPATH
     C*
     C                     MOVELS#PATH    P2PARM
     C                     Z-ADD##OSEQ    P1OSEQ
     C                     Z-ADD##ITEM    P1ITEM
     C                     Z-ADD##TBIN    P1TBIN
     C                     Z-ADD##PBIN    P1PBIN
     C*
     C**  Set up data.
     C*
     C                     CLEARP4PARM
     C                     MOVE *BLANKS   P@CNAM
     C           ##CHT1    IFEQ 'R'
     C           ##CHT1    OREQ 'A'
     C                     MOVEL##CHT1    P@CNAM
     C                     END
     C*
     C                     MOVE LNRF      P@LNRF
     C                     CALL 'CG6001'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           P1PARM           UDC Details
     C                     PARM           P2PARM140        Path Details
     C                     PARM           P@PARM           Loan Details
     C                     PARM           P4PARM           Facility Details
     C                     PARM           ##AUTO
     C                     PARM           ##REFR                                              CCG015
     C                     PARM           P@ICR                                               CCG015
     C                     PARM 'N'       ##MAST                                              CCG015
     C*
     C**  Reset Sequence number.
     C*
     C                     Z-ADDP1OSEQ    ##OSEQ
     C*
     C           EXXPAY    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           LOANA9    ENDSR                           ** LOANA9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRSDET                                        *
     C*  Function    :  Set-up settlement details                     *
     C*                                                               *
     C*  Called by   :  L01CC - Lending Commencement Confirmations    *
     C*  Calls       :  SRPATH - Generate Path String                 *
     C*                 CG99LSET - To set-up settlement details       *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRSDET    BEGSR                           ** SRSDET **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRSDET'  @STK,Q
     C*
     C                     ADD  1         P1                                                  CCG015
     C*                                                                                       CCG015
     C           P1        OCUR ##PATH                                                        CCG015
     C                     MOVEL'L_SETL'  ##GRPS    P                                         CCG015
     C                     EXSR SRPATH
     C                     EXSR PSHGRS                                                        CCG015
     C*
     C                     MOVELS#PATH    P2PARM
     C*
     C**  Setup the parameters for CG99LSET.
     C*
     C                     CLEARP0PARM
     C                     MOVEL##OSDB    P0POBR
     C                     MOVEL##OMDB    P0ROBR
     C                     Z-ADD##RSTM    P0RSTM
     C                     MOVEL##RONS    P0RONS
     C                     MOVEL##RIBN    P0RIBN
     C                     MOVEL##RIBA    P0RIBA
     C**********           Z-ADD##ROBN    P0ROBN                                              CSD027
     C**********           Z-ADD##ROCN    P0ROCN                                              CSD027
     C                     MOVE ##ROBN    P0ROBN                                              CSD027
     C                     MOVE ##ROCN    P0ROCN                                              CSD027
     C                     Z-ADD##PSTM    P0PSTM
     C                     MOVEL##PONS    P0PONS
     C                     MOVEL##PIBN    P0PIBN
     C                     MOVEL##PIBA    P0PIBA
     C**********           Z-ADD##POBN    P0POBN                                              CSD027
     C**********           Z-ADD##POCN    P0POCN                                              CSD027
     C                     MOVE ##POBN    P0POBN                                              CSD027
     C                     MOVE ##POCN    P0POCN                                              CSD027
     C                     MOVEL##RCRN    P0RCRN
     C                     MOVEL##RCRA    P0RCRA
     C                     MOVEL##RVNO    P0RVNO
     C                     MOVEL##AWBN    P0AWBN
     C                     MOVEL##AWBA    P0AWBA
     C                     MOVEL##BENN    P0BENN
     C                     MOVEL##BENA    P0BENA
     C                     MOVEL##DTP1    P0DTP1
     C                     MOVEL##DTP2    P0DTP2
     C                     MOVEL##DTP3    P0DTP3
     C                     MOVEL##DTP4    P0DTP4
     C                     MOVEL##DCHG    P0DCHG
     C                     MOVEL##BTB1    P0BTB1
     C                     MOVEL##BTB2    P0BTB2
     C                     MOVEL##BTB3    P0BTB3
     C                     MOVEL##BTB4    P0BTB4
     C                     MOVEL##BTB5    P0BTB5
     C                     MOVEL##BTB6    P0BTB6
     C                     MOVEL##SPI1    P0SPI1
     C                     MOVEL##SPI2    P0SPI2
     C                     MOVEL##SPI3    P0SPI3
     C           CEU014    IFEQ 'Y'                                       CEU014
     C           CLE031    OREQ 'Y'                                                           CLE031
     C                     MOVEL##STCY    P0STCY                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                                       CLE031
     C           CLE031    IFEQ 'Y'                                                           CLE031
     C                     MOVEL##PSCY    P0PSCY                                              CLE031
     C                     ENDIF                                                              CLE031
     C*
     C                     Z-ADD##OSEQ    P1OSEQ
     C                     Z-ADD##ITEM    P1ITEM
     C                     Z-ADD##TBIN    P1TBIN
     C                     Z-ADD##PBIN    P1PBIN
      *                                                                                       130998
      * If settlement method set in old fields and not in new then use                        130998
      *                                                                                       130998
     C           ##MDST    IFNE 0                                                             130998
     C           P0RSTM    ANDEQ0                                                             130998
     C                     MOVEL##MDST    P0RSTM           *Settlemt type                     130998
     C                     MOVEL##OMDB    P0ROBR           *Settlemt branch                   130998
     C                     MOVEL##OMDA    P0RONS           *Our nostro/ A/C                   130998
     C                     MOVEL##TMAN    P0RIBN           *Their nostro                      130998
     C                     ENDIF                                                              130998
     C*                                                                                       130998
     C           ##SDST    IFNE 0                                                             130998
     C           P0PSTM    ANDEQ0                                                             130998
     C                     MOVEL##SDST    P0PSTM           *Settlemt type                     130998
     C                     MOVEL##OSDB    P0POBR           *Settlemt branch                   130998
     C                     MOVEL##OSDA    P0PONS           *Our nostro/ A/C                   130998
     C                     MOVEL##TSTN    P0AWBN           *Their nostro                      130998
     C                     MOVEL##FACO    P0BENN           *For account of                    130998
     C                     ENDIF                                                              130998
     C*
     C                     CALL 'CG99LSET'
     C                     PARM *BLANKS   W0RTN   7
     C                     PARM           W0CMT   3
     C                     PARM           ##COPD
     C                     PARM           P1PARM
     C                     PARM           P2PARM140
     C                     PARM           PDETLS
     C                     PARM           P0PARM
     C                     PARM           ##REFR                                              CCG015
     C                     PARM           P@ICR                                               CCG015
     C                     PARM 'N'       ##MAST                                              CCG015
     C*
     C           W0RTN     IFNE *BLANK
     C                     MOVEL'CG99LSET'W0FILE
     C                     MOVEL'W0RTN'   W0KEY            ************
     C                     Z-ADD8         W0ERNB           * DBERR 08 *
     C                     MOVEL'MEM5003' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C**  Reset Sequence number.
     C*
     C                     Z-ADDP1OSEQ    ##OSEQ
     C*                                                                                       CCG015
     C**  Decrement Path DS index                                                             CCG015
     C*                                                                                       CCG015
     C           P1        OCUR ##PATH                                                        CCG015
     C                     CLEAR##GRPS                                                        CCG015
     C                     SUB  1         P1                                                  CCG015
      *                                                                                       CCG015
     C                     EXSR POPGRS                                                        CCG015
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRSDE9    ENDSR                           ** SRSDE9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRINZF                                        *
     C*  Function    :  Initialise Fields on Each Invocation          *
     C*                                                               *
     C*  Called by   :  MAINLINE - Mainline Processing                *
     C*  Calls       :  None                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRINZF    BEGSR                           ** SRINZF **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRINZF'  @STK,Q
     C*
     C**  Initialise work fields.
     C*
     C                     Z-ADD*ZEROS    ##W050  50
     C                     Z-ADD*ZEROS    ##W150 150
     C                     Z-ADD*ZEROS    ##W157 157
     C                     Z-ADD*ZEROS    #1      60
     C                     Z-ADD*ZEROS    #2      60
     C                     Z-ADD*ZEROS    #3      60
     C                     MOVE *BLANKS   S#PATH256
     C           *LIKE     DEFN DEOSEQ    ##OSEQ
     C*
     C**  Initialise output sequence (to CGUDTAPD).
     C*
     C                     Z-ADD*ZEROS    ##OSEQ
     C*
     C**  DJU Additions for CG4999 1st version.
     C*
     C                     MOVE *BLANKS   #@RDE  10
     C           *LIKE     DEFN ##TBIN    #@TBIN
     C*
     C           1         OCUR ##BIND
     C                     RESET##BIND
     C                     RESET#@BIND
     C                     RESET#PDS
      *                                                                                       CCG015
      ** Initialise XML increment                                                             CCG015
      *                                                                                       CCG015
     C                     EXSR INIXML                                                        CCG015
     C*
     C           EXINZ     TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRINZ9    ENDSR                           ** SRINZ9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRINIT                                        *
     C*  Function    :  Initial processing - On First Call            *
     C*                                                               *
     C*  Called by   :  MAINLINE - Mainline Processing                *
     C*  Calls       :  AOBANKR0 - Retrive Bank Details               *
     C*                 SRDCDT   - Determine Currency Details         *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRINIT    BEGSR                           ** SRINIT **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRINIT'  @STK,Q
     C/COPY WNCPYSRC,CG6005C003
     C*
     C**  Retrieve Bank details.
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   ##RTCD  7
     C                     PARM '*FIRST  '##OPTN  7
     C           SDBANK    PARM SDBANK    DSSDY
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDBANKPD'W0FILE
     C                     MOVEL'*FIRST'  W0KEY            ************
     C                     Z-ADD9         W0ERNB           * DBERR 09 *
     C                     MOVEL'MEM5003' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     END
     C*
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*
     C**  Determine Number of decimal places - Base currency.
     C*
     C                     MOVELBJCYCD    ##CCY
     C                     EXSR SRDCDT
     C                     Z-ADDA6NBDP    BASCDP  10
      *                                                                   CEU014
      ** Access GL ICD for Euro currency code                             CEU014
      *                                                                   CEU014
     C**********           CALL 'AOGELRR0'                                             CEU014 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   ##RTCD                          CEU014
     C                     PARM '*FIRST ' ##OPTN                          CEU014
     C********** SDGELR    PARM SDGELR    DSFDY                                        CEU014 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                   CEU014
      ** DATABASE ERROR                                                   CEU014
      *                                                                   CEU014
     C           ##RTCD    IFNE *BLANKS                                   CEU014
     C                     MOVEL'SDGELRPD'W0FILE                          CEU014
     C                     MOVEL##OPTN    W0KEY            ***************CEU014
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU014
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CLE005
      ** Check if CLE005 is ON                                            CLE005
      *                                                                   CLE005
     C                     CALL 'AOSARDR0'                                CLE005
     C                     PARM *BLANKS   ##RTCD  7                       CLE005
     C                     PARM '*KEY    '##OPTN  7                       CLE005
     C                     PARM 'CLE005'  PSARD   6                       CLE005
     C           SCSARD    PARM SCSARD    DSFDY                           CLE005
     C*                                                                   CLE005
     C           ##RTCD    IFEQ *BLANK                                    CLE005
     C                     MOVE 'Y'       CLE005  1                       CLE005
     C                     ELSE                                           CLE005
     C                     MOVE 'N'       CLE005                          CLE005
     C           ##RTCD    IFNE '*NRF    '                                CLE005
     C                     MOVEL'SCSARDPD'W0FILE                          CLE005
     C                     MOVEL'CLE005'  W0KEY            ************   CLE005
     C                     Z-ADD15        W0ERNB           * DBERR 15 *   CLE005
     C                     MOVEL'MEM5003' W0MSGD           ************   CLE005
     C                     MOVEL'MIDAS  ' W0MSGF                          CLE005
     C                     EXSR SRERR                                     CLE005
     C                     ENDIF                                          CLE005
     C                     ENDIF                                          CLE005
     C*
      ** Check if CEU014 is switched on                                   CEU014
      *                                                                   CEU014
     C                     CALL 'AOSARDR0'                                CEU014
     C                     PARM *BLANKS   ##RTCD  7                       CEU014
     C                     PARM '*KEY    '##OPTN  7                       CEU014
     C                     PARM 'CEU014'  PSARD   6                       CEU014
     C           SCSARD    PARM SCSARD    DSFDY                           CEU014
     C*                                                                   CEU014
     C           ##RTCD    IFEQ *BLANK                                    CEU014
     C                     MOVE 'Y'       CEU014  1                       CEU014
     C                     ELSE                                           CEU014
     C                     MOVE 'N'       CEU014                          CEU014
     C           ##RTCD    IFNE '*NRF    '                                CEU014
     C                     MOVEL'SCSARDPD'W0FILE                          CEU014
     C                     MOVEL'CEU014'  W0KEY            ************   CEU014
     C                     Z-ADD16        W0ERNB           * DBERR 16 *   CEU014
     C                     MOVEL'MEM5003' W0MSGD           ************   CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
     C                     ENDIF                                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                                       CCG015
      ** Access Switchable Features file and check if CCG015 is                               CCG015
      ** installed                                                                            CCG015
      *                                                                                       CCG015
     C                     CALL 'AOSARDR0'                                                    CCG015
     C                     PARM *BLANKS   ##RTCD                                              CCG015
     C                     PARM '*VERIFY' ##OPTN                                              CCG015
     C                     PARM 'CCG015'  PSARD                                               CCG015
     C           SCSARD    PARM SCSARD    DSFDY                                               CCG015
      *                                                                                       CCG015
     C           ##RTCD    IFEQ *BLANK                                                        CCG015
     C                     MOVE 'Y'       CCG015  1                                           CCG015
     C                     ELSE                                                               CCG015
     C                     MOVE 'N'       CCG015                                              CCG015
      *                                                                                       CCG015
     C           ##RTCD    IFNE '*NRF    '                                                    CCG015
     C                     MOVEL'SCSARDPD'W0FILE                                              CCG015
     C                     MOVEL'*CALL   'W0KEY                                               CCG015
     C                     Z-ADD19        W0ERNB                                              CCG015
     C                     MOVEL'MEM5003' W0MSGD                                              CCG015
     C                     MOVEL'MIDAS  ' W0MSGF                                              CCG015
     C                     EXSR SRERR                                                         CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CLE028
      ** Check if Flat Rate Personal Loans (Rule of 78s) is installed.                        CLE028
      *                                                                                       CLE028
     C                     CALL 'AOSARDR0'                                                    CLE028
     C                     PARM *BLANKS   ##RTCD                                              CLE028
     C                     PARM '*KEY    '##OPTN                                              CLE028
     C                     PARM 'CLE028'  PSARD                                               CLE028
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE028
     C*                                                                                       CLE028
     C           ##RTCD    IFEQ *BLANK                                                        CLE028
     C                     MOVE 'Y'       CLE028  1                                           CLE028
     C                     ELSE                                                               CLE028
     C                     MOVE 'N'       CLE028                                              CLE028
     C           ##RTCD    IFNE '*NRF    '                                                    CLE028
     C                     MOVEL'SCSARDPD'W0FILE                                              CLE028
     C                     MOVEL'CLE028'  W0KEY                                               CLE028
     C                     Z-ADD20        W0ERNB                                              CLE028
     C                     MOVEL'MEM5003' W0MSGD                                              CLE028
     C                     MOVEL'MIDAS  ' W0MSGF                                              CLE028
     C                     EXSR SRERR                                                         CLE028
     C                     ENDIF                                                              CLE028
     C                     ENDIF                                                              CLE028
      *                                                                                       CLE028
      ** Access Switchable Features file and check if CLE031 is                               CLE031
      ** installed                                                                            CLE031
      *                                                                                       CLE031
     C                     CALL 'AOSARDR0'                                                    CLE031
     C                     PARM *BLANKS   ##RTCD                                              CLE031
     C                     PARM '*VERIFY' ##OPTN                                              CLE031
     C                     PARM 'CLE031'  PSARD                                               CLE031
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE031
      *                                                                                       CLE031
     C           ##RTCD    IFEQ *BLANK                                                        CLE031
     C                     MOVE 'Y'       CLE031  1                                           CLE031
     C                     ELSE                                                               CLE031
     C                     MOVE 'N'       CLE031                                              CLE031
      *                                                                                       CLE031
     C           ##RTCD    IFNE '*NRF    '                                                    CLE031
     C                     MOVEL'SCSARDPD'W0FILE                                              CLE031
     C                     MOVEL'*CALL   'W0KEY                                               CLE031
     C                     Z-ADD20        W0ERNB                                              CLE031
     C                     MOVEL'MEM5003' W0MSGD                                              CLE031
     C                     MOVEL'MIDAS  ' W0MSGF                                              CLE031
     C                     EXSR SRERR                                                         CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE031
     C                     ENDIF                                                              CLE031
      *                                                                                       CLE036
      ** Check if CLE036 is installed.                                                        CLE036
      *                                                                                       CLE036
     C                     CALL 'AOSARDR0'                                                    CLE036
     C                     PARM *BLANKS   PRTCD   7                                           CLE036
     C                     PARM '*VERIFY' POPTN   7                                           CLE036
     C                     PARM 'CLE036'  PSARD                                               CLE036
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE036
      *                                                                                       CLE036
     C           PRTCD     IFEQ *BLANK                                                        CLE036
     C                     MOVE 'Y'       CLE036  1                                           CLE036
     C                     ELSE                                                               CLE036
     C                     MOVE 'N'       CLE036                                              CLE036
      *                                                                                       CLE036
     C           PRTCD     IFNE '*NRF    '                                                    CLE036
     C                     MOVEL'SCSARDPD'W0FILE                                              CLE036
     C                     MOVEL'*CALL   'W0KEY                                               CLE036
     C                     Z-ADD21        W0ERNB                                              CLE036
     C                     MOVEL'MEM5003' W0MSGD                                              CLE036
     C                     MOVEL'MIDAS  ' W0MSGF                                              CLE036
     C                     EXSR SRERR                                                         CLE036
     C                     ENDIF                                                              CLE036
      *                                                                                       CLE036
     C                     ENDIF                                                              CLE036
     C*                                                                   CEU014
     C/COPY WNCPYSRC,CG6005C013
     C**  Copyright Statement.
     C*
     C                     MOVEACPY@      ACT@   80
     C/COPY WNCPYSRC,CG6005C002
      *                                                                                       CER038
      ** Check if CER038 is ON                                                                CER038
      *                                                                                       CER038
     C                     CALL 'AOSARDR0'                                                    CER038
     C                     PARM *BLANKS   ##RTCD  7                                           CER038
     C                     PARM '*KEY    '##OPTN  7                                           CER038
     C                     PARM 'CER038'  PSARD   6                                           CER038
     C           SCSARD    PARM SCSARD    DSFDY                                               CER038
      *                                                                                       CER038
     C           ##RTCD    IFEQ *BLANKS                                                       CER038
     C                     MOVE 'Y'       CER038  1                                           CER038
     C                     ELSE                                                               CER038
     C                     MOVE 'N'       CER038                                              CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
      ** Check if CLE143 is ON                                                                CLE143
      *                                                                                       CLE143
     C                     CALL 'AOSARDR0'                                                    CLE143
     C                     PARM *BLANKS   ##RTCD                                              CLE143
     C                     PARM '*VERIFY '##OPTN                                              CLE143
     C                     PARM 'CLE143'  PSARD                                               CLE143
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE143
      *                                                                                       CLE143
     C           ##RTCD    IFEQ *BLANKS                                                       CLE143
     C                     MOVE 'Y'       CLE143  1                                           CLE143
     C                     ELSE                                                               CLE143
     C                     MOVE 'N'       CLE143                                              CLE143
     C                     ENDIF                                                              CLE143
     C/COPY WNCPYSRC,CGH00020
      *                                                                                       CLE143
     C                     CALL 'AOMMODR0'                                                  BUG23004
     C                     PARM *BLANKS   ##RTCD                                            BUG23004
     C                     PARM '*FIRST  '##OPTN                                            BUG23004
     C           SDMMOD    PARM SDMMOD    DSFDY                                             BUG23004
      *                                                                                     BUG23004
     C           ##RTCD    IFNE *BLANKS                                                     BUG23004
      *                                                                                     BUG23004
      ** Database error                                                                     BUG23004
      *                                                                                     BUG23004
     C                     MOVEL'AOMMODR0'W0FILE                                            BUG23004
     C                     MOVEL'*CALL'   W0KEY            ************                     BUG23004
     C                     Z-ADD20        W0ERNB           * DB ERROR 2                     BUG23004
     C                     MOVEL'MEM5003' W0MSGD           ************                     BUG23004
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23004
     C                     EXSR SRERR                                                       BUG23004
     C                     ENDIF                                                            BUG23004
      *                                                                                     BUG23004
      ** Call access program for message details                                            BUG23004
      *                                                                                     BUG23004
     C           BGSWCL    IFEQ 'Y'                                                         BUG23004
     C                     CALL 'AOMGMER0'                                                  BUG23004
     C                     PARM *BLANKS   ##RTCD                                            BUG23004
     C                     PARM '*FIRST  '##OPTN                                            BUG23004
     C           SDMGME    PARM SDMGME    DSFDY                                             BUG23004
      *                                                                                     BUG23004
     C           ##RTCD    IFNE *BLANKS                                                     BUG23004
      *                                                                                     BUG23004
      ** Database error                                                                     BUG23004
      *                                                                                     BUG23004
     C                     MOVEL'AOMGMER0'W0FILE                                            BUG23004
     C                     MOVEL'*CALL'   W0KEY            ************                     BUG23004
     C                     Z-ADD24        W0ERNB           * DB ERROR 2                     BUG23004
     C                     MOVEL'MEM5003' W0MSGD           ************                     BUG23004
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23004
     C                     EXSR SRERR                                                       BUG23004
     C                     ENDIF                                                            BUG23004
     C                     ENDIF                                                            BUG23004
      *                                                                                     BUG23004
      ** Call access program for trading data details                                       BUG23004
      *                                                                                     BUG23004
     C                     CALL 'AOTRADR0'                                                  BUG23004
     C                     PARM *BLANKS   ##RTCD                                            BUG23004
     C                     PARM '*FIRST  '##OPTN                                            BUG23004
     C           SDTRAD    PARM SDTRAD    DSFDY                                             BUG23004
      *                                                                                     BUG23004
     C           ##RTCD    IFNE *BLANKS                                                     BUG23004
      *                                                                                     BUG23004
      ** Database error                                                                     BUG23004
      *                                                                                     BUG23004
     C                     MOVEL'AOTRADR0'W0FILE                                            BUG23004
     C                     MOVEL'*CALL'   W0KEY            ************                     BUG23004
     C                     Z-ADD22        W0ERNB           * DB ERROR 2                     BUG23004
     C                     MOVEL'MEM5003' W0MSGD           ************                     BUG23004
     C                     MOVEL'MIDAS  ' W0MSGF                                            BUG23004
     C                     EXSR SRERR                                                       BUG23004
     C                     ENDIF                                                            BUG23004
      *                                                                                       CRE073
      ** Check if CRE073 is ON                                                                CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   ##RTCD                                              CRE073
     C                     PARM '*VERIFY '##OPTN                                              CRE073
     C                     PARM 'CRE073'  PSARD                                               CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           ##RTCD    IFEQ *BLANKS                                                       CRE073
     C                     MOVE 'Y'       CRE073  1                                           CRE073
     C                     ELSE                                                               CRE073
     C                     MOVE 'N'       CRE073                                              CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
      ** Check if CER049 is installed.                                                        CER049
      *                                                                                       CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   PRTCD   7                                           CER049
     C                     PARM '*VERIFY' POPTN   7                                           CER049
     C                     PARM 'CER049'  PSARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           PRTCD     IFEQ *BLANK                                                        CER049
     C                     MOVE 'Y'       CER049  1                                           CER049
     C                     ELSE                                                               CER049
     C                     MOVE 'N'       CER049                                              CER049
      *                                                                                       CER049
     C           PRTCD     IFNE '*NRF    '                                                    CER049
     C                     MOVEL'SCSARDPD'W0FILE                                              CER049
     C                     MOVEL'*CALL   'W0KEY                                               CER049
     C                     Z-ADD31        W0ERNB                                              CER049
     C                     MOVEL'MEM5003' W0MSGD                                              CER049
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER049
     C                     EXSR SRERR                                                         CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                     MD029242
      ** If CER038 is switched on, check if Suppress Correspondence for                     MD029242
      ** Customer with Swift ID is 'Y/N'                                                    MD029242
      *                                                                                     MD029242
     C           CER038    IFEQ 'Y'                                                         MD029242
     C                     MOVEL*BLANKS   SUPCON  1                                         MD029242
     C                     CALL 'AOSVALR0'                                                  MD029242
     C                     PARM           P@RTCD  7                                         MD029242
     C                     PARM #SUPRS    P@OP01 20                                         MD029242
     C           SVAL1     PARM           P@VL01200                                         MD029242
     C                     PARM *BLANK    P@OP02 20                                         MD029242
     C                     PARM           P@VL02200                                         MD029242
     C                     PARM *BLANK    P@OP03 20                                         MD029242
     C                     PARM           P@VL03200                                         MD029242
     C                     PARM *BLANK    P@OP04 20                                         MD029242
     C                     PARM           P@VL04200                                         MD029242
     C                     PARM *BLANK    P@OP05 20                                         MD029242
     C                     PARM           P@VL05200                                         MD029242
     C                     PARM *BLANK    P@OP06 20                                         MD029242
     C                     PARM           P@VL06200                                         MD029242
     C                     PARM *BLANK    P@OP07 20                                         MD029242
     C                     PARM           P@VL07200                                         MD029242
     C                     PARM *BLANK    P@OP08 20                                         MD029242
     C                     PARM           P@VL08200                                         MD029242
     C                     PARM *BLANK    P@OP09 20                                         MD029242
     C                     PARM           P@VL09200                                         MD029242
     C                     PARM *BLANK    P@OP10 20                                         MD029242
     C                     PARM           P@VL10200                                         MD029242
      *                                                                                     MD029242
     C           P@RTCD    IFNE *BLANKS                                                     MD029242
     C           P@RTCD    ANDNE'*NRF   '                                                   MD029242
     C                     MOVEL'SDSVALPD'W0FILE           ***************                  MD029242
     C                     MOVEL'*CALL'   W0KEY            * DB ERROR 50 *                  MD029242
     C                     Z-ADD50        W0ERNB           ***************                  MD029242
     C                     MOVEL'MEM5003' W0MSGD                                            MD029242
     C                     MOVEL'MIDAS  ' W0MSGF                                            MD029242
     C                     EXSR SRERR                                                       MD029242
     C                     ENDIF                                                            MD029242
      *                                                                                     MD029242
     C           P@RTCD    IFEQ *BLANKS                                                     MD029242
     C                     MOVELSVAL11    SUPCON                                            MD029242
     C                     ENDIF                                                            MD029242
      *                                                                                     MD029242
     C                     ENDIF                                                            MD029242
      *                                                                                       CER049
      ** Check if CLE141 is installed.                                                        CLE141
      *                                                                                       CLE141
     C                     CALL 'AOSARDR0'                                                    CLE141
     C                     PARM *BLANKS   PRTCD                                               CLE141
     C                     PARM '*VERIFY' POPTN                                               CLE141
     C                     PARM 'CLE141'  PSARD                                               CLE141
     C           SCSARD    PARM SCSARD    DSFDY                                               CLE141
      *                                                                                       CLE141
     C           PRTCD     IFEQ *BLANK                                                        CLE141
     C                     MOVE 'Y'       CLE141  1                                           CLE141
     C                     ELSE                                                               CLE141
     C                     MOVE 'N'       CLE141                                              CLE141
     C                     ENDIF                                                              CLE141
     C*
     C           EXINIT    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRINI9    ENDSR                           ** SRINI9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRADTA                                        *
     C*  Function    :  Accumulate RDEs and Associated Data           *
     C*                                                               *
     C*  Called by   :  LOAN   - Process Loan Details                 *
     C*                 L@ROL  - Process Rollover Details             *
     C*                 L@REP  - Process Repayment Details            *
     C*                 L@IPY  - Process Interest Payment Details     *
     C*                 L@GUAR - Process Guarantee Details            *
     C*  Calls       :  CG3999 - Pack/Unpack Extracted Data           *
     C*                 SRRFMN - Reformat RDE Data                    *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRADTA    BEGSR                           ** SRADTA **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRADTA'  @STK,Q
     C*
     C**  Reformat RDE data.
     C*
     C                     EXSR SRRFMN
     C*
     C**  Pack RDEs and associated data into data string.
     C*
     C                     CLEAR##SDS
      *                                                                                       CCG015
      ** If CCG015 is installed, value of W0ACT is '*NEWARR'                                  CCG015
      *                                                                                       CCG015
     C           CCG015    IFEQ 'Y'                                                           CCG015
     C                     MOVEL'*NEWARR 'W0ACT                                               CCG015
     C                     MOVELS#PATH    W0SPAT                                              CCG015
     C                     ELSE                                                               CCG015
     C                     MOVEL'*PACK   'W0ACT                                               CCG015
     C                     MOVEL*BLANK    W0SPAT                                              CCG015
     C                     ENDIF                                                              CCG015
      *                                                                                       CCG015
     C                     CALL 'CG3999'
     C                     PARM *BLANK    ##RTCD
     C**********           PARM '*PACK   'W0ACT                                               CCG015
     C                     PARM           W0ACT                                               CCG015
     C                     PARM           ##R
     C                     PARM           ##D
     C                     PARM           ##S
     C                     PARM           W0SPAT 70                                           CCG015
     C                     PARM           ##RN                                                CCG015
     C                     PARM           ##DN                                                CCG015
     C                     PARM           ##FM                                                CCG015
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'CG3999  'W0FILE           ************
     C                     MOVEL##RTCD    W0KEY            * DBERR 10 *
     C                     Z-ADD10        W0ERNB           ************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     EXSR WRTRDE                                                        CCG015
     C*
     C**  Append Data from pack routine.
     C*
     C           #@SDS     CAT  ##SDS:0   #@SDS
     C                     MOVEL*BLANK    ##R
     C                     MOVEL*BLANK    ##D
     C                     MOVEL*BLANK    ##S
     C*
     C           EXADTA    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRADT9    ENDSR                           ** SRADT9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRODTA                                        *
     C*  Function    :  Output Accumulated Data to CGUDTAPD           *
     C*                                                               *
     C*  Called by   :  LOAN   - Process Loan Details                 *
     C*                 L@ROL  - Process Rollover Details             *
     C*                 L@REP  - Process Repayment Details            *
     C*                 L@IPY  - Process Interest Payment Details     *
     C*                 L@GUAR - Process Guarantee Details            *
     C*  Calls       :  CG9020 - Write Data to UDC Extract Files      *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRODTA    BEGSR                           ** SRODTA **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRODTA'  @STK,Q
     C*
     C**  Initialise Write Format Parameter.
     C*
     C                     CLEARW0FMT
     C*
     C**  Set up Control Information.
     C*
     C                     Z-ADD##ITEM    DEITEM
     C                     ADD  1         ##OSEQ
     C                     Z-ADD##OSEQ    DEOSEQ
     C                     Z-ADD##PBIN    DEPBIN
     C                     Z-ADD##TBIN    DETBIN
     C                     MOVE 'FR'      DEFSLI
     C/COPY WNCPYSRC,CG6005C008
     C                     MOVE *BLANKS   W0PATH
     C/COPY WNCPYSRC,CG6005C009
     C                     MOVELS#PATH    W0PATH
     C*
     C**  Append Data from pack routine.
     C*
     C           W0FMT     CAT  #@SDS:0   W0FMT
     C*
     C**  Output PF/CGUDTAPD Record.
     C*
     C           CCG015    IFEQ 'N'                                                           CCG015
     C                     CALL 'CG9020'
     C                     PARM *BLANK    ##RTCD
     C                     PARM '*WRITE  'W0ACT
     C                     PARM           W0PATH256
     C                     PARM           W0FMT
     C                     PARM *BLANK    W0TITL  7
     C                     PARM *BLANK    W0ULIN  7
     C                     PARM           W0CMT
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'CG9020  'W0FILE           ************
     C                     MOVEL##RTCD    W0KEY            * DBERR 11 *
     C                     Z-ADD11        W0ERNB           ************
     C                     MOVEL'MEM5003' W0MSGD
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C                     ENDIF                                                              CCG015
     C*
     C                     CLEAR#@SDS
     C*
     C           EXODTA    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRODT9    ENDSR                           ** SRODT9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRBIND                                        *
     C*  Function    :  Generate Binding Numbers                      *
     C*                                                               *
     C*  Called by   :  All Repeating Group Set Subroutines           *
     C*  Calls       :  None                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRBIND    BEGSR                           ** SRBIND **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRBIND'  @STK,Q
     C*
     C           P1        SUB  1         P2
     C*
     C           P2        OCUR ##BIND
     C                     Z-ADD##TBIN    #@TBIN
     C*
     C           P1        OCUR ##BIND
     C                     Z-ADD#@TBIN    ##PBIN
     C                     ADD  1         #@BIND
     C                     Z-ADD#@BIND    ##TBIN
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRBIN9    ENDSR                           ** SRBIN9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRPATH                                        *
     C*  Function    :  Generate Path String                          *
     C*                                                               *
     C*  Called by   :  L01CC  - Lending Commencement Confirmations   *
     C*                 LOAN   - Process Loan Details                 *
     C*                 L@ROL  - Process Rollover Details             *
     C*                 L@REP  - Process Repayment Details            *
     C*                 L@IPY  - Process Interest Payment Details     *
     C*                 L@GUAR - Process Guarantee Details            *
     C*                 LOANA  - Loan Associated Details              *
     C*  Calls       :  None                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRPATH    BEGSR                           ** SRPATH **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRPATH'  @STK,Q
     C*
     C                     CLEARS#PATH
     C*
     C**  Set up Path.
     C*
     C                     DO   P1        P2
     C           P2        OCUR ##PATH
     C           S#PATH    CAT  '\':0     S#PATH
     C           S#PATH    CAT  ##GRPS:0  S#PATH
     C                     END
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRPAT9    ENDSR                           ** SRPAT9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRRFMN                                        *
     C*  Function    :  Reformat RDE Data                             *
     C*                                                               *
     C*  Called by   :  SRADTA - Accumulate RDEs and Associated Data  *
     C*  Calls       :  None                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRRFMN    BEGSR                           ** SRRFMN **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRRFMN'  @STK,Q
     C*
     C                     Z-ADD0         #1
     C*
     C**  Loop through RDE's and data.
     C*
     C           #1        DOUEQ20
     C*
     C                     ADD  1         #1
     C                     MOVEL##R,#1    R#DEFN
     C                     MOVEL##D,#1    R#DATA
     C*
     C**  If data present and RDE is edited.
     C*
     C           R#DATA    IFNE *BLANK
     C           ##RDEC    ANDNE*BLANK
     C*
     C**  Reformat Amount.
     C*
     C                     Z-ADD1         #2
     C           *BLANK    LOKUP##NUMA,#2                99*
     C                     Z-ADD20        #3
     C                     Z-ADD0         ##WNUM
     C*
     C           #2        DOWGT1
     C           #2        ANDLE20
     C           #3        ANDGT1
     C                     SUB  1         #2
     C                     MOVEL##NUMA,#2 ##W,#3
     C                     SUB  1         #3
     C                     ENDDO
     C*
     C**  Sign the amount.
     C*
     C           ##SIGN    IFEQ '-'
     C                     Z-SUB##WNUM    ##NUMB
     C                     ELSE
     C                     Z-ADD##WNUM    ##NUMB
     C                     END
     C*
     C**  Default Edit Type.
     C*
     C           ##EDTT    IFEQ *BLANK
     C                     MOVEL##RDET    ##EDTT
     C                     END
     C*
     C**  Default Decimal Places.
     C*
     C           ##DCPA    IFEQ *BLANK
     C                     MOVEL##RDED    ##DCPA
     C                     END
     C*
     C**  New RDE data.
     C*
     C                     MOVELR#DATA    ##D,#1
     C*
     C                     ENDIF
     C*
     C                     ENDDO
     C*
     C           EXRFMN    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRRFM9    ENDSR                           ** SRRFM9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRDCDT                                        *
     C*  Function    :  Determine Currency Details                    *
     C*                                                               *
     C*  Called by   :  LOAN   - Process Loan Details                 *
     C*                 L@REP  - Process Repayment Details            *
     C*                 SRINIT - Initial Processing - On First Call   *
     C*  Calls       :  AOCURRRO - Retrive Currency Details           *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRDCDT    BEGSR                           ** SRDCDT **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRDCDT'  @STK,Q
     C*
     C**  Access array of Currency Details already loaded.
     C*
     C                     Z-ADD1         C       30
     C           ##CCY     LOKUP##CY,C                   99
     C*
     C**  If no match is found determine the next free space in the
     C**  loaded currency array.
     C*
     C           *IN99     IFEQ *OFF
     C*
     C                     Z-ADD1         C
     C           *BLANK    LOKUP##CY,C                   99
     C*
     C**  If no space is left, set the Currency Data data structure to
     C**  the 101st occurrence so that when the new details are
     C**  retrieved no existing details are overwritten.
     C*
     C           *IN99     IFEQ *OFF
     C           101       OCUR SDCURR
     C*
     C**  If a space is found, set up the new currency into the array
     C**  and position the Currency Data data structure on the
     C**  occurrence matching the array index.
     C*
     C                     ELSE
     C                     MOVE ##CCY     ##CY,C
     C           C         OCUR SDCURR
     C                     ENDIF
     C*
     C**  Retrieve the currency details.
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   ##RTCD           B:Return Cd
     C                     PARM '*KEY'    ##OPTN           I:Option
     C                     PARM ##CCY     ##CCYP  3        I:Currency Code
     C           SDCURR    PARM *BLANK    DSSDY            O:Format
     C*
     C           ##RTCD    IFNE *BLANK
     C                     MOVEL'SDCURRPD'W0FILE
     C                     MOVEL##CCY     W0KEY            ************
     C                     Z-ADD12        W0ERNB           * DBERR 12 *
     C                     MOVEL'MEM5004' W0MSGD           ************
     C                     MOVEL'MIDAS  ' W0MSGF
     C                     EXSR SRERR
     C                     ENDIF
     C*
     C**  If the currency has been retrieved earlier, position the
     C**  Currency Data data structure on the relevant occurrence.
     C*
     C                     ELSE
     C           C         OCUR SDCURR
     C                     ENDIF
     C/COPY WNCPYSRC,CG6005C004
     C*
     C           EXDCDT    TAG
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRDCD9    ENDSR                           ** SRDCD9 **
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  Subroutine  :  SRICAL                                        *
     C*  Function    :  Calculate Interest                            *
     C*                                                               *
     C*  Called by   :  LOAN   - Process Loan Details                 *
     C*  Calls       :  ZFLAC  - Calculate End Date                   *
     C*                 GLINTC - Calculate Interest Between any 2     *
     C*                          day numbers                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           SRICAL    BEGSR                           ** SRICAL **
     C*
     C**  Set up subroutine stack name.
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRICAL'  @STK,Q
      *                                                                                       CLE028
      ** If Flat Rate Personal Loans (Rule of 78s) is installed,                              CLE028
      ** Gross Interest of flat rate personal loans is computed as per                        CLE028
      ** the Rule of 78s.  GROSS INTEREST is equal to Total Flat Interest                     CLE028
      *                                                                                       CLE028
     C           CLE028    IFEQ 'Y'                                                           CLE028
     C           ##PTYP    ANDEQ80                                                            CLE028
      *                                                                                       CLE028
     C                     Z-ADD##FLTI    ZINTR                                               CLE028
      *                                                                                       CLE028
     C                     ELSE                                                               CLE028
      *                                                                                       CLE028
     C*
     C                     Z-ADD##VDAT    ZIBEG
     C                     Z-ADD##ICBS    ZICALC
     C                     Z-ADD##CPAM    ZIAMT
     C                     Z-ADD##INTR    ZIRATE
     C**********           Z-ADD##VDAT    ZVDAT                                               245082
     C                     Z-ADD##MDAT    ZMDAT                                               245082
     C                     Z-ADD0         ZIEND                                               245914
     C*
     C           ##REPT    IFNE 1                                                             245914
     C           ##REPT    ANDNE3                                                             245914
      *                                                                                       245914
     C**  If repayment schedule exists for the loan, use the repayment
     C**  value date.
     C*
     C           ##RPDT    IFGT 0
     C                     Z-ADD##RPDT    ZIEND
     C                     Z-ADD0         ##RPDT
     C**********           ELSE                                                               245914
     C                     END                                                                245914
     C*
     C**  else, if repayment date is not zero, use repayment date.                            245914
     C*                                                                                       245914
     C           ##NRPD    IFGT 0                                                             245914
     C           ##NRPD    IFLT ZIEND                                                         245914
     C           ZIEND     OREQ 0                                                             245914
     C                     Z-ADD##NRPD    ZIEND                                               245914
     C                     END                                                                245914
     C                     END                                                                245914
     C*                                                                                       245914
     C**  else, if rollover date is not zero, use rollover date.
     C*
     C           ##RLDT    IFGT 0
     C           ##RLDT    IFLT ZIEND                                                         245914
     C           ZIEND     OREQ 0                                                             245914
     C                     Z-ADD##RLDT    ZIEND
     C**********           ELSE                                                               245914
     C                     END                                                                245914
     C                     END                                                                245914
     C*
     C**  else,if interest pay date is not zero, use interest pay date.
     C*
     C           ##NIDT    IFGT 0
     C                     Z-ADD##NIDT    ZIEND
     C**********           ELSE                                                               245914
     C                     END                                                                245914
     C*
     C**  else, use maturity date.
     C*
     C           ZIEND     IFEQ 0                                                             245914
     C                     Z-ADD##MDAT    ZIEND
     C                     END
     C**********           END                                                                245914
     C**********           END                                                                245914
     C*                                                                                       245914
     C                     ELSE                                                               245914
     C*                                                                                       245914
     C** If repayment type 1 or 3                                                             245914
     C*                                                                                       245914
     C**  If repayment schedule exists for the loan, use the repayment                        245914
     C**  value date.                                                                         245914
     C*                                                                                       245914
     C           ##RPDT    IFGT 0                                                             245914
     C                     Z-ADD##RPDT    ZIEND                                               245914
     C                     Z-ADD0         ##RPDT                                              245914
     C                     END                                                                245914
     C*                                                                                       245914
     C**  else, if repayment date is not zero, use repayment date.                            245914
     C*                                                                                       245914
     C           ##NRPD    IFGT 0                                                             245914
     C           ##NRPD    IFLT ZIEND                                                         245914
     C           ZIEND     OREQ 0                                                             245914
     C                     Z-ADD##NRPD    ZIEND                                               245914
     C                     END                                                                245914
     C                     END                                                                245914
     C*                                                                                       245914
     C**  else, if rollover date is not zero, use rollover date.                              245914
     C*                                                                                       245914
     C           ##RLDT    IFGT 0                                                             245914
     C           ##RLDT    IFLT ZIEND                                                         245914
     C           ZIEND     OREQ 0                                                             245914
     C                     Z-ADD##RLDT    ZIEND                                               245914
     C                     END                                                                245914
     C                     END                                                                245914
     C*                                                                                       245914
     C**  else,if interest pay date is not zero, use interest pay date.                       245914
     C*                                                                                       245914
     C           ##NIDT    IFGT 0                                                             245914
     C                     Z-ADD##NIDT    ZIEND                                               245914
     C                     END                                                                245914
     C*                                                                                       245914
     C**  else, use maturity date.                                                            245914
     C*                                                                                       245914
     C           ZIEND     IFEQ 0                                                             245914
     C                     Z-ADD##MDAT    ZIEND                                               245914
     C                     END                                                                245914
     C                     ENDIF                                                              245914
     C*
     C                     MOVE ##ADDI    ADDI    1
      *                                                                                       245914
     C           ZIEND     IFNE 0                                                             245914
      *                                                                                       245914
     C                     EXSR ZFLAC
     C/COPY WNCPYSRC,CG6005C010
     C                     EXSR GLINTC
     C/COPY WNCPYSRC,CG6005C011
     C                     ELSE                                                               245914
     C                     Z-ADD0         ZINTR                                               245914
     C                     ENDIF                                                              245914
     C                     ENDIF                                                              CLE028
     C*
     C** Round down interest if required
     C*
     C           ##RDFC    IFEQ 'Y'
     C           ##PTYP    ANDNE80                                                            CLE028
     C                     Z-ADDZINTR     ##TINT 130
     C                     ELSE
     C                     Z-ADDZINTR     ##TINT    H
     C                     END
     C/COPY WNCPYSRC,CGH00027
     C*
     C**  Unwind subroutine stack name.
     C*
     C                     MOVEA*BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C           SRICA9    ENDSR                           ** SRICA9 **
     C*
     C*****************************************************************
     C/SPACE 5                                                            CEU014
      *****************************************************************   CEU014
      * Subroutine  :  D@EURO                                         *   CEU014
      * Function    :  EURO Currency Conversion:                      *   CEU014
      *                Converts P@FRAM in P@FRCY to ##OUTA in P@TOCY. *   CEU014
      * Called by   :  LOAN                                           *   CEU014
      *                                                               *   CEU014
      * Calls       :  EU0200                                         *   CEU014
      *                SRERR                                          *   CEU014
      *****************************************************************   CEU014
     C           D@EURO    BEGSR                                          CEU014
      *                                                                   CEU014
     C                     Z-ADD0         ##OUTA 130                      CEU014
     C                     CALL 'EU0200'                                  CEU014
     C                     PARM *BLANKS   P@RTCD  7        Return Code    CEU014
     C                     PARM           P@FRAM 183       FROM Ccy AmountCEU014
     C                     PARM           P@FRCY  3        FROM Currency  CEU014
     C                     PARM           P@TOCY  3        TO Currency    CEU014
     C                     PARM 0         P@OUTA 150       Outright AmountCEU014
     C                     PARM 0         P@INTA 183       Interim Amount CEU014
     C                     PARM 0         P@EXRT 159       Exchange Rate  CEU014
     C                     PARM *BLANK    P@MDIN  1        Mult/Div Ind.  CEU014
      *                                                                   CEU014
      ** Database error handling:                                         CEU014
      *                                                                   CEU014
     C           P@RTCD    IFEQ '*ERROR*'                                 CEU014
     C                     MOVEL'EU0200  'W0FILE                          CEU014
     C                     MOVEL'*CALL   'W0KEY            ***************CEU014
     C                     Z-ADD17        W0ERNB           * DB ERROR 17 *CEU014
     C                     MOVEL'MEM5003' W0MSGD           ***************CEU014
     C                     MOVEL'MIDAS  ' W0MSGF                          CEU014
     C                     EXSR SRERR                                     CEU014
      *                                                                   CEU014
      ** Otherwise, store amount in settlement currency as ##OUTA         CEU014
      *                                                                   CEU014
     C                     ELSE                                           CEU014
     C                     MOVE P@OUTA    ##OUTA                          CEU014
     C                     ENDIF                                          CEU014
      *                                                                   CEU014
     C                     ENDSR                                          CEU014
      *****************************************************************   CEU014
     C/EJECT
      *****************************************************************                       CER038
      *  Subroutine  -  SRAUTO                                        *                       CER038
      *  Function    -  Auto transmission processing                  *                       CER038
      *                                                               *                       CER038
      *  Called by   -                                                *                       CER038
      *  Calls       -                                                *                       CER038
      *****************************************************************                       CER038
     C           SRAUTO    BEGSR                                                              CER038
      *                                                                                       CER038
      ** Set up subroutine stack name                                                         CER038
      *                                                                                       CER038
     C                     ADD  1         Q                                                   CER038
     C                     MOVEL'SRAUTO'  @STK,Q                                              CER038
      *                                                                                       CER038
      ** Get Branch Details                                                                   CER038
      *                                                                                       CER038
     C           BRCA      IFNE ##BRCD                                                        CER038
     C                     CALL 'AOBRCHR0'                                                    CER038
     C                     PARM '*MSG    '##RTCD                                              CER038
     C                     PARM '*KEY    '##OPTN                                              CER038
     C                     PARM BRCA      ##BRCD  3                                           CER038
     C           SDBRCH    PARM SDBRCH    DSFDY                                               CER038
      *                                                                                       CER038
      ** Database error                                                                       CER038
      *                                                                                       CER038
     C           ##RTCD    IFNE *BLANKS                                                       CER038
     C                     MOVEL'SDBRCHPD'W0FILE                                              CER038
     C                     MOVELBRCA      W0KEY            ***************                    CER038
     C                     Z-ADD27        W0ERNB           * DB ERROR 27 *                    CER038
     C                     MOVEL'MEM5004' W0MSGD           ***************                    CER038
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER038
     C                     EXSR SRERR                                                         CER038
     C                     END                                                                CER038
     C                     END                                                                CER038
      *                                                                                       CER038
      ** Get Customer Details for Loan customer number                                        CER038
      ** Get Customer Details for Branch Internal Customer (Sender)                           CER038
      *                                                                                       CER038
     C                     CALL 'AOCUSTR0'                                                    CER038
     C                     PARM *BLANKS   ##RTCD                                              CER038
     C                     PARM '*KEY   ' ##OPTN                                              CER038
     C                     PARM A8BICN    ##KEY1 10                                           CER038
     C                     PARM *BLANKS   ##KYST  7                                           CER038
     C           SDCUST    PARM SDCUST    DSSDY                                               CER038
      *                                                                                       CER038
      ** Database error                                                                       CER038
      *                                                                                       CER038
     C           ##RTCD    IFNE *BLANKS                                                       CER038
     C                     MOVEL'SDCUSTPD'W0FILE                                              CER038
     C                     MOVELA8BICN    W0KEY            ***************                    CER038
     C                     Z-ADD28        W0ERNB            DB ERROR 28 *                     CER038
     C                     MOVEL'MEM5004' W0MSGD           ***************                    CER038
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER038
     C                     EXSR SRERR                                                         CER038
     C                     END                                                                CER038
      *                                                                                       CER038
      ** Store Booking Branch, Branch Internal Customer Number and Name                       CER038
      *                                                                                       CER038
     C           *LIKE     DEFN BRCA      BBBRCA                                              CER038
     C                     MOVELBRCA      BBBRCA                                              CER038
     C           *LIKE     DEFN BBCUST    BBBICN                                              CER038
     C                     MOVELBBCUST    BBBICN                                              CER038
     C           *LIKE     DEFN BBCRNM    BICRNM                                              CER038
     C                     MOVELBBCRNM    BICRNM                                              CER038
      *                                                                                       CER038
      ** Store : Sender's (i.e. Branch)                                                       CER038
      **             SWIFT TID Address,                                                       CER038
      **             STTX Address                                                             CER038
      **             Telex Address                                                            CER038
      ** (All used in message routing)                                                        CER038
      *                                                                                       CER038
     C                     MOVELA8BTID    ##SCSD                                              CER038
     C                     MOVELBBSTAD    ##SSTD                                              CER038
     C                     MOVELBBTXA1    ##STXA                                              CER038
      *                                                                                       CER038
      ** Get Customer Details for loan customer (Receiver)                                    CER038
      *                                                                                       CER038
     C                     MOVE *BLANKS   ##KEY1                                              CER038
     C                     MOVEL##CNUM    ##KEY1                                              CER038
     C                     CALL 'AOCUSTR0'                                                    CER038
     C                     PARM *BLANKS   ##RTCD                                              CER038
     C                     PARM '*KEY   ' ##OPTN                                              CER038
     C                     PARM           ##KEY1 10                                           CER038
     C                     PARM *BLANKS   ##KYST  7                                           CER038
     C           SDCUST    PARM SDCUST    DSSDY                                               CER038
      *                                                                                       CER038
      ** Database error                                                                       CER038
      *                                                                                       CER038
     C           ##RTCD    IFNE *BLANKS                                                       CER038
     C                     MOVEL'SDCUSTPD'W0FILE                                              CER038
     C                     MOVEL##CNUM    W0KEY            **************                     CER038
     C                     Z-ADD29        W0ERNB           * DB ERROR 29*                     CER038
     C                     MOVEL'MEM5004' W0MSGD           **************                     CER038
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER038
     C                     EXSR SRERR                                                         CER038
     C                     END                                                                CER038
      *                                                                                       CER038
      ** Store Customer Name                                                                  CER038
      *                                                                                       CER038
     C           *LIKE     DEFN BBCRNM    CPCRNM                                              CER038
     C                     MOVELBBCRNM    CPCRNM                                              CER038
      *                                                                                       CER038
      ** Store : Destination Customer's (i.e. Counterparty)                                   CER038
      **             SWIFT TID Address,                                                       CER038
      **             STTX Address                                                             CER038
      **             Telex Address                                                            CER038
      **             Default Network for MTnnn messages                                       CER038
      ** (All used in message routing)                                                        CER038
      *                                                                                       CER038
     C                     MOVELBBCSID    ##DCSD                                              CER038
     C                     MOVELBBSTAD    ##DSTD                                              CER038
     C                     MOVELBBTXA1    ##DTXA                                              CER038
     C                     MOVELBBDNW3    ##DDNW           *MT300 messages                    CER038
      *                                                                                       CER038
      ** Determine Message Routing                                                            CER038
      *                                                                                       CER038
     C                     CALL 'CG99DTMR'             99                                     CER038
     C                     PARM           ##SCSD 12                                           CER038
     C                     PARM           ##SSTD 12                                           CER038
     C                     PARM           ##STXA 10                                           CER038
     C                     PARM           ##DCSD 12                                           CER038
     C                     PARM           ##DSTD 12                                           CER038
     C                     PARM           ##DTXA 10                                           CER038
     C                     PARM           ##DDNW  6                                           CER038
     C                     PARM BGMSDL    ##MSDL  1                                           CER038
     C                     PARM BGMTMI    ##MTMI  1                                           CER038
     C                     PARM BLSWPY    ##SWPY  10                                          CER038
     C                     PARM BLTXPY    ##TXPY  10                                          CER038
     C                     PARM *BLANKS   ##NETW  6                                           CER038
     C                     PARM *BLANKS   ##RTCD  7                                           CER038
      *                                                                                       CER038
     C           *IN99     IFEQ '1'                                                           CER038
     C           ##RTCD    ORNE *BLANKS                                                       CER038
      *                                                                                       CER038
      ** Database error                                                                       CER038
      *                                                                                       CER038
     C                     MOVEL'CG99DTMR'W0FILE           ***************                    CER038
     C                     MOVEL##RTCD    W0KEY            * DB ERROR 30 *                    CER038
     C                     Z-ADD30        W0ERNB           ***************                    CER038
     C                     MOVEL'MEM5003' W0MSGD                                              CER038
     C                     MOVEL'MIDAS  ' W0MSGF                                              CER038
     C                     EXSR SRERR                                                         CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C                     EXSR SRDAUT                                                        CER038
     C                     MOVEL'N'       ##SPPS                                              CER038
     C                     MOVEL##AUTO    DRATRM                                              CER038
      *                                                                                       CER038
      ** if auto transmission                                                                 CER038
      *                                                                                       CER038
     C           ##AUTO    IFEQ 'Y'                                                           CER038
     C           CER038    ANDEQ'Y'                                                           CER038
     C           SUPCON    ANDEQ'Y'                                                         MD029242
      *                                                                                       CER038
      ** set suppress indicator                                                               CER038
      *                                                                                       CER038
     C                     MOVE 'Y'       ##SPPS                                              CER038
      *                                                                                       CER038
     C                     ENDIF                                                              CER038
      *                                                                                       CER038
     C           EXAUTO    TAG                                                                CER038
      *                                                                                       CER038
      ** Unwind subroutine stack name                                                         CER038
      *                                                                                       CER038
     C                     MOVEA*BLANKS   @STK,Q                                              CER038
     C                     SUB  1         Q                                                   CER038
      *                                                                                       CER038
     C                     ENDSR                                                              CER038
      *****************************************************************                       CER038
     C/EJECT                                                                                  CER038
      *****************************************************************                       CER038
      *  Subroutine  -  SRDAUT                                        *                       CER038
      *  Function    -  Determine if Auto-Transmission of             *                       CER038
      *                 Confirmation                                  *                       CER038
      *                                                               *                       CER038
      *  Called by   -                                                *                       CER038
      *  Calls       -                                                *                       CER038
      *****************************************************************                       CER038
     C           SRDAUT    BEGSR                                                              CER038
      *                                                                                       CER038
      ** Set up subroutine stack name                                                         CER038
      *                                                                                       CER038
     C                     ADD  1         Q                                                   CER038
     C                     MOVEL'SRDAUT'  @STK,Q                                              CER038
      *                                                                                       CER038
      **********                                                                     CER038 BUG23004
      ***Call*access*program*for*midas*modules*details                               CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C**********           CALL 'AOMMODR0'                                           CER038 BUG23004
     C**********           PARM *BLANKS   ##RTCD                                     CER038 BUG23004
     C**********           PARM '*FIRST  '##OPTN                                     CER038 BUG23004
     C********** SDMMOD    PARM SDMMOD    DSFDY                                      CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C********** ##RTCD    IFNE *BLANKS                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
      ***Database*error                                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C**********           MOVEL'AOMMODR0'W0FILE                                     CER038 BUG23004
     C**********           MOVEL'*CALL'   W0KEY            ************              CER038 BUG23004
     C**********           Z-ADD20        W0ERNB           * DB ERROR 2              CER038 BUG23004
     C**********           MOVEL'MEM5003' W0MSGD           ************              CER038 BUG23004
     C**********           MOVEL'MIDAS  ' W0MSGF                                     CER038 BUG23004
     C**********           EXSR SRERR                                                CER038 BUG23004
     C**********           END                                                       CER038 BUG23004
      **********                                                                     CER038 BUG23004
      ***Call*access program for message details                                     CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C********** BGSWCL    IFEQ 'Y'                                                  CER038 BUG23004
     C**********           CALL 'AOMGMER0'                                           CER038 BUG23004
     C**********           PARM *BLANKS   ##RTCD                                     CER038 BUG23004
     C**********           PARM '*FIRST  '##OPTN                                     CER038 BUG23004
     C********** SDMGME    PARM SDMGME    DSFDY                                      CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C********** ##RTCD    IFNE *BLANKS                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
      ***Database error                                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C**********           MOVEL'AOMGMER0'W0FILE                                     CER038 BUG23004
     C**********           MOVEL'*CALL'   W0KEY            ************              CER038 BUG23004
     C**********           Z-ADD24        W0ERNB           * DB ERROR 2              CER038 BUG23004
     C**********           MOVEL'MEM5003' W0MSGD           ************              CER038 BUG23004
     C**********           MOVEL'MIDAS  ' W0MSGF                                     CER038 BUG23004
     C**********           EXSR SRERR                                                CER038 BUG23004
     C**********           END                                                       CER038 BUG23004
     C**********           END                                                       CER038 BUG23004
      **********                                                                     CER038 BUG23004
      ***Call*access program for trading data details                                CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C**********           CALL 'AOTRADR0'                                           CER038 BUG23004
     C**********           PARM *BLANKS   ##RTCD                                     CER038 BUG23004
     C**********           PARM '*FIRST  '##OPTN                                     CER038 BUG23004
     C********** SDTRAD    PARM SDTRAD    DSFDY                                      CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C********** ##RTCD    IFNE *BLANKS                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
      ***Database error                                                              CER038 BUG23004
      **********                                                                     CER038 BUG23004
     C**********           MOVEL'AOTRADR0'W0FILE                                     CER038 BUG23004
     C**********           MOVEL'*CALL'   W0KEY            ************              CER038 BUG23004
     C**********           Z-ADD22        W0ERNB           * DB ERROR 2              CER038 BUG23004
     C**********           MOVEL'MEM5003' W0MSGD           ************              CER038 BUG23004
     C**********           MOVEL'MIDAS  ' W0MSGF                                     CER038 BUG23004
     C**********           EXSR SRERR                                                CER038 BUG23004
     C**********           END                                                       CER038 BUG23004
     C                     MOVEL'N'       ##AUTO  1                                           CER038
      *                                                                                       CER038
     C           BGSWCL    IFEQ 'Y'                                                           CER038
     C           BGMTCL    OREQ 'Y'                                                           CER038
      *                                                                                       CER038
     C           ##NETW    IFNE 'PAPER '                                                      CER038
     C           ##NETW    OREQ 'PAPER '                                                      CER038
     C           ENFFCR    ANDNE'Y'                                                           CER038
     C                     MOVEL'Y'       ##AUTO                                              CER038
     C                     END                                                                CER038
     C                     END                                                                CER038
      *                                                                                       CER038
      **  Unwind subroutine stack name                                                        CER038
      *                                                                                       CER038
     C                     MOVEA*BLANKS   @STK,Q                                              CER038
     C                     SUB  1         Q                                                   CER038
      *                                                                                       CER038
     C                     ENDSR                                                              CER038
      *                                                                                       CER038
      *****************************************************************                       CER038
     C/EJECT                                                                                  CER038
      *****************************************************************                       CER038
     C/COPY ZSRSRC,ZFLACZ2
     C/EJECT
     C/COPY ZSRSRC,GLINTCZ1
     C/EJECT
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
     C/COPY ZSRSRC,ZINTDYZ2
     C/EJECT
     C/COPY ZSRSRC,ZDATE9Z3
     C/EJECT
     C/COPY CGCPYSRC,SRERRPSSR
     C/EJECT
     C/COPY CGCPYSRC,SRERRC
     C/EJECT
     C/COPY CGCPYSRC,CGNWEX                                                                   CCG015
     C/EJECT                                                                                  CCG015
     C/COPY ZSRSRC,ZCONVZ1                                                                    CLE031
     C/EJECT                                                                                  CLE031
** ##CPY  **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION                                           CLE031
0000001                                                                                       CLE031
0000010                                                                                       CLE031
0000100                                                                                       CLE031
0001000                                                                                       CLE031
0010000                                                                                       CLE031
0100000                                                                                       CLE031
1000000                                                                                       CLE031
