     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas CG Payment frequency narratives.')
     F*****************************************************************
     F*                                                               *
     F*  Midas - User Defined Correspondence                  *
     F*                                                               *
     F*  CGZ2110 - - - - Convert a payment frequency code             *
     F*                   to an appropriate narrative.                *
     F*                                                               *
     F*  Function:   - - This program returns the appropriate         *
     F*                   narrative for a payment frequency.          *
     F*                                                               *
     F*  Parameters: - - P0RTN  --   7    -- Return code;             *
     F*                  P0VIN  -- 256    -- Input value;             *
     F*                  P0VOUT -- 256    -- Output value;            *
     F*                  P0VLEN --   3(0) -- Output value length;     *
     F*                  P0FTYP --  10    -- Format type;             *
     F*                  P0FOPT --  15    -- Format option.           *
     F*                                                               *
     F*  Called by:  - - CGxxxx.                                      *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSC022             Date 24Feb04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01522             Date 01Jan95               *
      *                                    Date ddmmmyy               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *           (Recompile)                                         *
     F*  S01522 - User Defined Correspondence                         *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Indicator usage                                              *
     F*  ~~~~~~~~~~~~~~~                                              *
     F*  90 -- Value found.                                           *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  Subroutine usage                                             *
     F*  ~~~~~~~~~~~~~~~~                                             *
     F*  SRCONV -- Convert the code to a narrative.                   *
     F*  SRINIT -- Provide initialisation and definitions.            *
     F*                                                               *
     F*  Copied in routines:                                          *
     F*                                                               *
     F*  *PSSR  -- Program error routine.                             *
     F*  SRFILE -- File error routine.                                *
     F*  SRERR  -- Error reporting routine.                           *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E*-------------------------------------------------------------------
     E* Error processing array:
     E*
     E/COPY CGCPYSRC,SRERRE
     E*
     E                    CPY@    1   1 80               Copyright
     E                    #CD     1  20  1   #NR    50   Codes; narratives
     E*
     E* Copied-in array definitions:
     E*
     E/COPY WNCPYSRC,CGZ2110EPG
     E*
     E*-------------------------------------------------------------------
     I/SPACE
     I*-------------------------------------------------------------------
     I/COPY WNCPYSRC,CGZ2110IPG
     I*
     I* Copied-in data structures
     I*
     I*...................................................................
     I/COPY CGCPYSRC,SRERRI
     I*
     I* Error processing data structures
     I********************************************************************
     C/EJECT
     C********************************************************************
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P0VIN 256
     C                     PARM           P0VOUT256
     C                     PARM           P0VLEN  30
     C                     PARM           P0FTYP 10
     C                     PARM           P0FOPT 15
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q
     C                     MOVEL'@Main@'  @STK,Q
     C*
     C* Initialise:
     C                     EXSR SRINIT
     C*
     C* Convert the value:
     C                     EXSR SRCONV
     C*
     C           EXMAIN    TAG                             <<<=== EXMAIN
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     RETRN
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRCONV returns the narrative for a given code.     **
     C********************************************************************
     C           SRCONV    BEGSR                           * S R C O N V *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q
     C                     MOVEL'SRCONV'  @STK,Q
     C*
     C* Move the input value:
     C*
     C                     MOVELP0VIN     #CODE   1
     C*
     C                     Z-ADD1         #C      30
     C           #CODE     LOKUP#CD,#C                   90
     C           *IN90     IFEQ *ON
     C                     MOVEL#NR,#C    P0VOUT
     C                     ENDIF
     C*
     C* Get the length of the returned narrative,
     C*  with a limit of the entered value:
     C*
     C           ' '       CHEKRP0VOUT    P0VLEN
     C           P#VLEN    IFLT P0VLEN
     C           P#VLEN    ANDNE*ZERO
     C                     Z-ADDP#VLEN    P0VLEN
     C                     ENDIF
     C*
     C           EXCONV    TAG                             <<<=== EXCONV
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**  Subroutine SRINIT provides initialisation.                    **
     C********************************************************************
     C           SRINIT    BEGSR                           * S R I N I T *
     C*
     C* Add subroutine name to stack:
     C*
     C                     ADD  1         Q       50
     C                     MOVEL'SRINIT'  @STK,Q
     C*
     C* Define and clear error return code:
     C*
     C                     MOVE *BLANKS   P0RTN
     C*
     C* Move the copyright parameter:
     C*
     C                     MOVEACPY@      ACT@   80
     C*
     C* /Copy point for calculations:
     C*
     C/COPY WNCPYSRC,CGZ2110CPG
     C*
     C* Save the input length:
     C*
     C                     Z-ADDP0VLEN    P#VLEN  30
     C*
     C* Clear output length and value:
     C*
     C                     Z-ADD*ZERO     P0VLEN
     C*
     C                     MOVE *BLANKS   P0VOUT
     C*
     C           EXINIT    TAG                             <<<=== EXINIT
     C*
     C* Unwind subroutine stack:
     C*
     C                     MOVE *BLANKS   @STK,Q
     C                     SUB  1         Q
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C** Subroutine *PSSR handles program errors.                       **
     C********************************************************************
     C*
     C/COPY CGCPYSRC,SRERRPSSR
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* File and Program Error Processing
     C*
     C/COPY CGCPYSRC,SRERRC
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C* /Copy point for calculation specifications:
     C*
     C/COPY WNCPYSRC,CGZ2110CPG
     C*
     C********************************************************************
     O/EJECT
     O********************************************************************
     C* /Copy point for output:
     C*
     O/COPY WNCPYSRC,CGZ2110OPG
     C*
     O********************************************************************
** CPY@
(c) Finastra International Limited 2001
** #CD / #NR -- Frequency codes and narratives.
AMONTHLY ACCRUAL / PROFIT DATE                     |
BLAST WORKING DAY OF MONTH                         |
DDAILY                                             |
FFORTNIGHTLY                                       |
GPENULT. WORKING DAY OF YEAR                       |
HPENULT. WORKING DAY OF HALF-YEAR                  |
KPENULT. WORKING DAY OF QUARTER                    |
LLAST CALENDAR DAY OF MONTH                        |
MMONTHLY                                           |
NMONTHLY                                           |
PPENULT. WORKING DAY OF MONTH                      |
QQUARTERLY                                         |
RSIX DAYS BEFORE MONTH END                         |
SSEMI-MONTHLY                                      |
TBI-MONTHLY                                        |
WWEEKLY                                            |
XSIX-MONTHLY                                       |
YYEARLY                                            |
                                                   |
                                                   |
