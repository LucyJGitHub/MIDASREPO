     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DE Default of next export date to run date')     *
      *****************************************************************
      *                                                               *
      *  Midas - Data Export Module                                   *
      *                                                               *
      *  DE0120 - Default Next Export Date to Run Date                *
      *                                                               *
      *  Function:  This program is used to default Next Export Date  *
      *             field of PF/MXEXFDPD to Run Date of the current   *
      *             system.                                           *
      *                                                               *
      *  Called By: DEC0120 - Input Extract Control Information       *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CLE134             Date 01Aug12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *  Prev Amend No. CDE002  *CREATE    Date 01Jun01               *
      *                 xxxxxx             Date ddmmmyy               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CDE002 - Date Export - CCRM Revenue Analysis                 *
      *                                                               *
      *****************************************************************
     FMXEXFDL2UF  E           K        DISK         KINFSR *PSSR
      ** Midas MX Export Format Details
      *
      *****************************************************************
      /EJECT
      *****************************************************************
     E                    CPY@    1   1 80
      ** Array containing Copyright statement
      *
     E                    FMTARR  1  23 10
      ** Array containing format names
      *
      *****************************************************************
      /SPACE 3
      *****************************************************************
      *
     ILDA       E DSLDA                         256
      ** Local data area for database error details
      *
     IRUNDAT    E DSRUNDAT
      ** Data Area giving Installation Control Details
      *
     ISDBANK    E DSSDBANKPD
      ** Bank details
      *
     IDSFDY     E DSDSFDY
      ** Short date structure
      *
     IPSDS       SDS
      ** Program Status Data Structure
      *
     I                                     *PROGRAM PGM
     I                                      244 253 WSID
     I                                      254 263 USER
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *
      ** Perform initial processing
      *
     C                     EXSR SRINIT
      *
      ** Initialise index value to 1
      *
     C                     Z-ADD1         I       40
      *
      ** Do this until all format names in the array have been chained
      *
     C           I         DOUGT23
      *
      ** Chain LF/MXEXFDL2 using format stored in the array
      *
     C           FMTARR,I  CHAINMXEXFDL2             99
      *
     C           *IN99     IFEQ *OFF
      *
      ** Default the field Next Export Date to the System's rundate
      *
     C                     MOVE AGRDNB    EXEXND
      *
     C                     UPDATMXEXFDP0               81
      *
     C           *IN81     IFEQ *ON
     C                     MOVEL'MXEXFDPD'DBFILE
     C                     Z-ADD02        DBASE
     C                     MOVEL*BLANK    DBKEY
     C                     EXSR *PSSR
     C                     ENDIF
     C                     ENDIF
      *
     C                     ADD  1         I
      *
     C                     ENDDO
      *
      *
      ** Return to the calling program
      *
     C                     RETRN
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      * SRINIT - Initial Processing                                   *
      *                                                               *
      * Called by: Main routine                                       *
      *                                                               *
      * Calls: None                                                   *
      *                                                               *
      *****************************************************************
      *
     C           SRINIT    BEGSR
      *
      ** Set up copyright parameter
      *
     C                     MOVEACPY@      CPY2@  80
      *
      ** Read in Installation Data
      *
     C           *NAMVAR   DEFN           RUNDAT
     C           *NAMVAR   DEFN           LDA
     C                     IN   RUNDAT
      *
      ** Retrieve bank details
      *
     C                     CALL 'AOBANKR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*FIRST ' POPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
      *
     C           PRTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE
     C                     Z-ADD01        DBASE
     C                     MOVEL'*FIRST'  DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C                     ENDSR
      *
      *****************************************************************
      /EJECT
      *****************************************************************
      *                                                               *
      * *PSSR  - Program exception error routine                      *
      *          Called automatically if a program error occurs,      *
      *          or directly by the program code using EXSR.          *
      *          This subroutine DUMPs the program just once.         *
      *                                                               *
      * Called by: (**calling routines**)                             *
      *                                                               *
      * Calls: None                                                   *
      *                                                               *
      *****************************************************************
      *
     C           *PSSR     BEGSR                           ** *PSSR SR **
      *
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
      *
     C                     CALL 'DBERRCTL'
      *
     C                     ENDIF
      *
     C                     MOVE *ON       *INU7
     C                     MOVE *ON       *INU8
     C                     MOVE *ON       *INLR
      *
     C                     RETRN
      *
     C                     ENDSR
      *
      ********************************************************************
      /EJECT
      ********************************************************************
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**  FMTARR
MDEACEXPD
MDENEVNTPD
MDENPOSNPD
MDENTRANPD
MDETCASHPD
MDETEVNTPD
MDETPOSNPD
MDETTRANPD
MFDDTSTPD
MINVTPD
MSDACOFPD
MSDBANKPD
MSDBRCHPD
MSDCOMPPD
MSDCTRYPD
MSDCUHSPD
MSDCURRPD
MSDCUSTPD
MSDFACTPD
MSDFEEPD
MSDINDSPD
MSDINSTPD
MSDLOANPD
