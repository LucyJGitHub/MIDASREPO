      *****************************************************************
/*STD *  DSPFBASE                                                     *
/*EXI *  TEXT('Midas DL OIS compounding interest rate enq/amend')     *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DSPF/DL1641DF - Midas OIS Compounding Interest Rate          *
      *                  Display File                                 *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. 241044             Date 13May22               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 245692             Date 09Dec13               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG6693            Date 19Apr05               *
      *                 BUG6043            Date 23Feb05               *
      *                 226723             Date 12May04               *
      *                 224925             Date 13Feb04               *
      *                 220859             Date 10Sep03               *
      *                 214440             Date 30Jan03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CIR007 *CREATE     Date 11May01               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  241044 - Applied fix 238333.                                 *
      *  238333 - OIS Patch delivery                                  *
      *           Additional coding needed:                           *
      *           Don't set off *IN98, it is used for date processing *
      *           in ZDATE1.                                          *
      *  MD046248 - Finastra Rebranding                               *
      *  245692 - Incorrect validation of rates when the decimal se-  *
      *           parator in the Dealing ICD was defined as "," ins-  *
      *           tead of ".".                                        *
      *         - Applied for MD-23981.                               *
      *  BUG6693 - Interest Column from the OIS Compounding Enquiry   *
      *            has disappeared                                    *
      *  BUG6043 - Compounding rate incorrectly displayed.            *
      *  226723 - Correctly display negative base, compound and inte- *
      *           rest rates.  Applied fix 219286.                    *
      *  224925 - Disallow access to amend function keys if matured   *
      *           loan. Use different set of indicator to display     *
      *           function keys.                                      *
      *  220859 - Increase the size of Compounding Rate from 7 to 15  *
      *           decimal places.                                     *
      *           Applied fix 220258.                                 *
      *  214440 - Add functionality to Amend Applicable Days field,   *
      *           and Insert and Delete records. (OIS)                *
      *  CIR007 - Overnight Index Swaps                               *
      *                                                               *
      *****************************************************************
      *
     A                                      REF(MFRFL)
     A                                      CA03(03 'Exit')
     A  31                                  CA05(05 'Refresh')
     A  31                                  CA12(12 'Initial Screen')
      **Start of change 214440
     A**31*09***                            CA09(09 'Amend')                                  214440
      **Start of change 224925
     A**31*08***                            CA08(08 'Amend')                                  224925
     A**31*09***                            CA09(09 'Insert')                                 224925
     A**31*10***                            CA10(10 'Delete')                                 224925
      **End of change 214440
     A  31 15                               CA08(08 'Amend')                                  224925
     A  31 16                               CA09(09 'Insert')                                 224925
     A  31 17                               CA10(10 'Delete')                                 224925
      **End of change 224925
      *
     A                                      INDARA
     A                                      PRINT(MPRINT)
     A                                      MSGLOC(24)
      *
------*-------------------------------------------------------------------------
      ***  Subfile Record
------*-------------------------------------------------------------------------
      *
      ***  Loading one Page at a Time Subfile
      *
     A          R DL1641S0                  SFL
      *                                              Begin /238333/
     A**********                            SETOF(98 'Force input format')
      *                                              End   /238333/
      *
     A            #0BSDT         6A  O 12  2DSPATR(HI)
      *
      **Start of change 226723
      *                                                                                       226723
     A**********  #0BSRT         9  7O 12  9EDTWRD('0 .       ')
      *                                                                                       245692
      ** Start of change 245692                                                               245692
      *                                                                                       245692
     A**********  #0BSRT         9  7O 12  9EDTWRD('0 .       -')                             245692
     A            W#BSRT        10A  O 12  9                                                  245692
      *                                                                                       245692
      ** End of change 245692                                                                 245692
      *                                                                                       245692
      *
      **End of change 226723
      *
     A                                      DSPATR(HI)
      *                                              Begin /220859/
     A**********  #0CPRT         8  7O 12 20EDTWRD('0 .       ')
     A**********                            DSPATR(HI)
     A**********  #0INRT         9  7O 12 30EDTWRD('0 .       ')
     A**********                            DSPATR(HI)
     A**********  #0APDY         3  0O 12 41EDTCDE(Z)
     A**********                            DSPATR(HI)
     A**********  #0PRIN        18A  O 12 45DSPATR(HI)
     A**********  #0AMT         17A  O 12 64DSPATR(HI)
      *
      * Start of change 226723
      *
     A**********  #0CPRT        16 15O 12 20EDTWRD('0 .              '')                      226723
      ** Start of change BUG6043
     A**********  #0CPRT        15 14O 12 21EDTWRD('0 .              -')
     A**********                            DSPATR(HI)
     A**********  #0INRT         9  7O 12 38EDTWRD('0 .       ')                              226723
     A**********  #0INRT         9  7O 12 39EDTWRD('0 .       -')
     A**********                            DSPATR(HI)
     A*********   #0APDY         3  0O 12 49EDTCDE(Z)                                         226723
     A**********  #0APDY         3  0O 12 51EDTCDE(Z)
     A**********                            DSPATR(HI)
     A*********   #0PRIN        18A  O 12 53DSPATR(HI)                                        226723
     A**********  #0PRIN        18A  O 12 55DSPATR(HI)
      *
      *                                                                                       245692
      ** Start of change 245692                                                               245692
      *                                                                                       245692
     A**********  #0CPRT        19 15O 12 21EDTWRD('  0 .               -')                   245692
     A            W#CPRT        20A  O 12 21                                                  245692
     A                                      DSPATR(HI)
     A**********  #0INRT         9  7O 12 44EDTWRD('0 .       -')                             245692
     A            W#INRT        10A  O 12 44                                                  245692
      *                                                                                       245692
      ** End of change 245692                                                                 245692
      *                                                                                       245692
     A                                      DSPATR(HI)
     A            #0APDY         3  0O 12 56EDTCDE(Z)
     A                                      DSPATR(HI)
     A            #0PRIN        18A  O 12 60DSPATR(HI)
      ** End of change BUG6043
      *
      **End of change 226723
      *
     A            #0AMT         17A  O 13 64DSPATR(HI)
      *                                              End   /220859/
      *
------*-------------------------------------------------------------------------
      ***  Subfile Control
------*-------------------------------------------------------------------------
      *
     A          R DL1641C0                  TEXT('(c) Finastra International +
     A                                      Limited +
     A                                      2001')
      *
     A                                      OVERLAY
     A  86                                  PUTOVR
     A                                      SFLCTL(DL1641S0)
      *                                              Begin /238333/
     A**********                            SETOF(98 'Force input format')
      *                                              End   /238333/
     A*                                              Begin /220859/
     A**********                            SFLSIZ(11)
     A**********                            SFLPAG(10)
     A                                      SFLSIZ(6)
     A                                      SFLPAG(5)
     A*                                              End   /220859/
     A                                      BLINK
     A  80                                  SFLCLR
     A N80                                  SFLDSPCTL
     A N80 81                               SFLDSP
     A N80 81 82                            SFLEND(*MORE)
     A N82                                  ROLLUP(22)
      *
     A  83                                  ERASE(DL1641S0)
      *
------*-------------------------------------------------------------------------
      ***  Screen Header
------*-------------------------------------------------------------------------
      *
     A            #0USER        10A  O  1  2
     A                                  1 13'DL1641DF'
     A                                  1 25'OIS Compounding Interest +
     A                                       Rate Enquiry'
     A                                      DSPATR(UL HI)
     A                                  1 67'DATE '
     A            #0MRDT         7A  O  1 73
      *
     A            #0WSID        10A  O  2  2
     A                                  2 67'TIME '
     A                                  2 73TIME
      *
------*-------------------------------------------------------------------------
      ***  Input Fields and a list of indicators used.
      *
      *     40  - Error on Deal Number
      *     41  - Error on Deal Side
      *     42  - Error on Position to Date
------*-------------------------------------------------------------------------
      *
     A                                  5  2'Deal Number '
     A            #0DLNO         6A  B  5 15OVRDTA
     A N40                                  DSPATR(HI)
      **Start of change 214440
     A*N40******                            DSPATR(UL)                                        214440
     A N40N35                               DSPATR(UL)
      **End of change 214440
     A  40                                  DSPATR(RI)
     A  40                                  DSPATR(PC)
      **Start of change 214440
     A  35                                  DSPATR(PR)
      **End of change 214440
      *
     A                                  5 26'Ourside/Theirside '
     A            #0SIDE         1A  B  5 45OVRDTA
     A N41                                  DSPATR(HI)
      **Start of change 214440
     A*N41******                            DSPATR(UL)                                        214440
     A N41N35                               DSPATR(UL)
      **End of change 214440
     A  41                                  DSPATR(RI)
     A  41                                  DSPATR(PC)
      **Start of change 214440
     A  35                                  DSPATR(PR)
      **End of change 214440
      *
     A                                  5 50'Position to Date '
     A            #0PDAT         6A  B  5 68OVRDTA
     A N42                                  DSPATR(HI)
     A N42                                  DSPATR(UL)
     A  42                                  DSPATR(RI)
     A  42                                  DSPATR(PC)
      *
------*-------------------------------------------------------------------------
      ***  Deal Details
------*-------------------------------------------------------------------------
      *
     A            #0SFRN         4  0H      SFLRCDNBR
     A  31                              7  2'Cust Name'
     A  31        #0CSNM        10   O  7 12
     A                                      DSPATR(HI)
      *
     A  31                              7 24'Currency'
     A  31        #0CCYD         3   O  7 33
     A                                      DSPATR(HI)
      *
     A  31                              7 38'Deal Date'
     A  31        #0DDAT         6  0O  7 48
     A                                      DSPATR(HI)
      *
     A  31                              7 57'Value Date'
     A  31        #0VDAT         6  0O  7 68
     A                                      DSPATR(HI)
      *
     A  31                              8  2'Next Interest Date'
     A  31        #0NIND         6A  O  8 21DSPATR(HI)
     A
      *
     A  31                              8 30'Maturity Date'
     A  31        #0MDAT         6  0O  8 44DSPATR(HI)
      *
------*-------------------------------------------------------------------------
      ***  Column Heading
------*-------------------------------------------------------------------------
      *
     A  31                             10  3'Date'
     A  31                             10  9'Base Rate'
      *                                              Begin /220859/
     A**31******                       10 20'Cmp. Rate'
     A**31******                       10 31'Int. Rate'
     A**31******                       10 41'A/Ds'
     A**31******                       10 49'Principal'
     A**31******                       10 67'Int. Amount'
      *
     A  31                             10 23'Cmp. Rate'
      *
      **Start of change 226723
      *
     A**31******                       10 38'Int. Rate'                                       226723
      * Start of change BUG6043
     A**31******                       10 39'Int. Rate'
      * End of change BUG6043
     A**31******                       10 50'A/Ds'                                            226723
      * Start of change BUG6043
     A**31******                       10 51'A/Ds'
      * End of change BUG6043
     A**31******                       10 57'Principal'                                       226723
      * Start of change BUG6043
     A**31******                       10 59'Principal'
     A  31                             10 44'Int. Rate'
     A  31                             10 56'A/Ds'
     A  31                             10 62'Principal'
      * End of change BUG6043
      *
      **End of change 226723
      *
     A**Start of change BUG6693
     A**31******                       10 70'Int. Amount'                                    BUG6693
     A  31                             10 72'Int. Amt'
     A**End of change BUG6693
     A*                                              End   /220859/
      *
------*-------------------------------------------------------------------------
      ***  FOOTER     Allowed Function Keys
------*-------------------------------------------------------------------------
      *
     A          R DL1641F0
     A                                      OVERLAY
     A                                 23  3'F3=Exit'
      **Start of change 214440
     A**31******                       23 14'F5=Refresh'                                      214440
     A**31******                       23 28'F12=Initial Screen'                              214440
     A**31*09***                       23 50'F9=Amend'                                        214440
     A  31                             23 12'F5=Refresh'
     A  31                             23 24'F12=Initial Screen'
      **Start of change 224925
     A**31*08***                       23 49'F8=Amend'                                        224925
     A**31*09***                       23 59'F9=Insert'                                       224925
     A**31*10***                       23 70'F10=Delete'                                      224925
      **End of change 214440
     A  31 15                          23 49'F8=Amend'                                        224925
     A  31 16                          23 59'F9=Insert'                                       224925
     A  31 17                          23 70'F10=Delete'                                      224925
      **End of change 224925
      *
------*-------------------------------------------------------------------------
      ***  Message Subfile
------*-------------------------------------------------------------------------
      *
     A          R DL1641S1                  TEXT('Program messages')
     A                                      SFL SFLMSGRCD(24)
     A            #1MSGK                    SFLMSGKEY
     A            #1PGM                     SFLPGMQ
      *
------*-------------------------------------------------------------------------
      ***  Message Subfile  Control
------*-------------------------------------------------------------------------
      *
     A          R DL1641C1                  TEXT('Program messages')
     A                                      SFLCTL(DL1641S1)
     A                                      SFLPAG(01) SFLSIZ(03)
     A                                      OVERLAY PUTOVR
     A                                      SFLINZ SFLDSP SFLDSPCTL
     A  25
     AON25                                  SFLEND
     A            #1PGM                     SFLPGMQ
      *
