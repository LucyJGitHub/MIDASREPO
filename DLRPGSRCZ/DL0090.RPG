     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Forward rates input')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                   *
     F*                                                               *
     F*  DL0090  -  FORWARD RATES INPUT                               *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CAAA03             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 138010             Date 20Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 23Feb01               *
      *                 CAP059             Date 23Feb01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 152522             Date 18Jan99               *
      *                 152073             Date 03Jan99               *
     F*                 CEU026             DATE 17JUL98               *
     F*                 089129             DATE 27JUL95               *
     F*                 065331             DATE 23MAR94               *
     F*                 S01432             DATE 21JUL93               *
     F*                 047413             DATE 22MAR93               *
     F*                 E32245             DATE 27OCT92               *
     F*                 E26581             DATE 25JUL91               *
     F*                 S01328             DATE 04FEB91               *
     F*                 E22348             DATE 08JUN90               *
     F*                 LN744              DATE 12SEP90               *
     F*                 BHF575             DATE 13AUG90               *
     F*                 BHF323             DATE 13AUG90               *
     F*                 BHF200             DATE 17JUL90               *
     F*                 LN0303             DATE 31MAY90               *
     F*                 E19847             DATE 11APR90               *
     F*                 E219               DATE 19JAN90               *
     F*                 S01199             DATE 07/03/89              *
     F*                 S01194             DATE 26/04/89              *
     F*                 E12711             DATE 09/03/88              *
     F*                 E11232             DATE 27/08/87              *
     F*                 E10181             DATE 20/01/87              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*  ANY CHANGES MADE TO THIS PROGRAM SHOULD ALSO BE MADE TO      *
     F*                    DL0090A                                    *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Webfacing Changes (Recompile)                       *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  138010 - Increase rate field size by 1. Previous fix #089129 *
     F*           incorporated in CORE M106PXXSRC but missing few lines
     F*           and not working properly. Compared it with #128797 &*
     F*           #129789 and added the missing lines .               *
     F*  CSD006 - Market Data Feed                                    *
     F*  CAP059 - Conversion of Forward Rates into Modular APIs       *
     F*  152522 - Reverse reciprocal rates for OUT currency if base   *
     F*           currency is IN.  Use multiply/divide indicator of   *
     F*           OUT currency/EUR rate for rate conversion in ZXRATE *
      *  152073 - Correct calculation of base rate for OUT currency   *
      *           if base currency is IN.                             *
     F*  CEU026 - EMU Forward rates changes                           *
     F*  089129 - Recompile over changed version of FWDRT             *
     F*  065331 - Forward Rates Input did not accept 93 in the days   *
     F*           input field. Error on fix E26581. Wrong variable    *
     F*           used for period entered. Fix done uses DAY instead  *
     F*           of DYA.                                             *
     F*  S01432 - Recompile over changed version of FWDRT             *
     F*  047413 - FORWARD RATES INPUT DID NOT ACCEPT 93 IN THE DAYS   *
     F*           INPUT FIELD BUT IT DID ACCEPT 093. ERROR ON FIX     *
     F*           E26581. WRONG VARIABLE USED FOR PERIOD ENTERED.     *
     F*           FIX DONE USES DAY INSTEAD OF DYA.                   *
     F*  E32245 - When CCY entered via '?', file is not checked       *
     F*           for an existing entry.                              *
     F*  E26581 - MAXIMUM PERIOD ALLOWED SHOULD BE SUCH THAT          *
     F*           RUN DATE + PERIOD ENTERED <= 99998                  *
     F*  S01328 - FRA/IRS REVALUATION                                 *
     F*  E22348 - CHANGE DUPLICATE USAGE OF INDICATOR 26 THAT         *
     F*           CAUSED PROGRAM TO CRASH IF FORWARD RATE DID NOT     *
     F*           EXIST.                                              *
     F*  LN744  - WRONG FIELD NAME ON FWDRTFE                         *
     F*  BHF575 - ? CCY OPTION - MOVE SELECTED CURRENCY TO SCREEN     *
     F*  BHF323 - OUTPUT FROM SCREEN NOT REDISPLAYED WHEN             *
     F*           ERRORS HAVE OCCURRED.                               *
     F*  BHF200 - FIX INCORPORATED BY C.P.S INCORRECTLY               *
     F*  LN0303 - ZMUSER INCORRECTLY DEFINED                          *
     F*  E19847 - AMEND PROGRAM SO THAT IT EVALUATES THE NUMBER OF    *
     F*           DECIMAL PLACES BEFORE DISPLAYING THE OUTPUT         *
     F*  E219   - ENSURE CORRECT ZVACT PROG CALLED DEPENDING          *
     F*           ON IF MULTIBRANCHED OR NOT.                         *
     F*  S01199 -  HELP SYSTEM.                                    *
     F*  S01194 - STANDING DATA CHANGES.                              *
     F*  E12711 - TO STOP ERRORS IN DL0410 LIMIT RATE DP TO SIX       *
     F*           OR SEVEN IN CERTAIN CCY CIRCUMSTANCES.              *
     F*  E11232 - LAST CHANGE DATES NOT UPDATED CORRECTLY             *
     F*           IN FILE FWDRT.                                      *
     F*  E10181 - TO ALLOW ERROR CODE W11 TO BE DISPLAYED             *
     F*           BUT ONLY ONCE IF THE ERROR CONDITION OCCURS.        *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                       *
     F* 01   CURRENCY SHOULD HAVE 6 DECIMAL PLACES                    *   E19847
     F* 02                        - INITIAL SCREEN                    *
     F* 03                        - INSERT SCREEN                     *
     F* 04                        - AMEND SCREEN                      *
     F* 05                        - DELETE SCREEN                     *
     F* 06            FORWARD RATES - DETAIL RECORD                   *
     F* 07                          - DELETED RECORD                  *
     F* 08                          - HEADER RECORD                   *
     F**09**************************- CATCH ALL                       *   E19847
     F* 09            CURRENCY SHOULD HAVE 7 DECIMAL PLACES           *   E19847
     F**10************TABLE*FILE*DEALING*CURRENCY**                   *   S01194
     F* 10            DEALING CURRENCY FOUND ON FILE                  *   S01194
     F*  11   USED TO CONDITION FIRST TIME PASS THROUGH RPG CALC CYCLE*
     F*  12   SET ON IF ERROR DURING READ FROM THE WORK STATION       *
     F********ALSO*HELP*IND*                                          *   S01199
     F*       13      OUTPUT DAYS/RATE FIELDS                         *
     F*       14      OUTPUT ACTION/CURRENCY                          *
     F*    15         CURRENCY FROM SCREEN BLANK                      *
     F*       16      ACTION - INSERT                                 *
     F*       17             - AMEND                                  *
     F*       18             - DELETE                                 *
     F*       19             - ENQUIRY                                *
     F*       20      NTH DAY NUMBER BLANK                            *
     F*       21      NTH RATE BLANK                                  *
     F*       22      FIRST BLANK FOUND                               *
     F*       23      RATE HAS BEEN DECREASED                         *
     F*       24      RATE DIFFERS BY MORE THAN 10%                   *
     F********25******ALL DATA PROCESSED                              *   CEU026
     F*       25      PROTECT RATE FIELDS FOR 'IN' CURRENCY           *   CEU026
     F*       26      CHAIN FAIL                                      *
     F*       27      RELEASE SCREEN                                  *
     F*       28      AT LEAST ONE WARNING ERROR                      *
     F*       29      SEVERE ERROR                                    *
     F*       30      NON-DISPLAY COLUMN HEADINGS                     *
     F*       31      PROTECT DAYS/RATE FIELDS                        *
     F*       32      NON-DISPLAY ERROR CODES                         *
     F*       33      NON-DISPLAY ERROR MESSAGE                       *
     F*       34      POSITION CURSOR ON ACTION CODE                  *
     F*       35      PROTECT ACTION CODE AND CURRENCY                *
     F*       36      BLINK ACTION CODE LABEL                         *
     F*       37      BLINK CURRENCY LABEL                            *
     F*       38      WORKSTATION OUTPUT                              *
     F*       39      CONDITION ONLY ONE OCCURANCE OF 'W11' ERROR CODE*   E10181
     F*       44      UPDATE HEADER                                   *
     F*       46      UPDATE/ADD FORWARD RATE DETAIL                  *
     F*       47      RELEASE FORWARD RATE FILE                       *
     F*   40-89  ALSO BLINK DAYS/RATE FIELD                           *
     F*                                                               *
     F*****************************************************************
0066 F*DL0090FMCF**F*****635************WORKSTN      KPASS  *NOIND        S01328
0068 F*FWDRT***UF**F*****256**3AI*****2*DISK                              S01328
0066 F*DL0090FMCF**F     685            WORKSTN      KPASS  *NOIND S01328 089129
     FDL0090FMCF  F     710            WORKSTN      KPASS  *NOIND         089129
0014 F*FWDRT***UF  F     261  3AI     2 DISK                       S01328 S01432
0014 F*FWDRT***UF  F     436  3AI     2 DISK                       S01432 089129
0014 F***********FWDRT   UF  F     611  3AI     2 DISK                               089129   CSD006
0014 FFWDRT   UF  F     719  3AI     2 DISK                                                   CSD006
0068 F                                              KCOMIT
0071 F*ABLE   IF  F      96 12AI     2 DISK                               S01194
     F*FWDRTFE*O***F*****256************DISK                      A       S01328
     F*FWDRTFE*O   F     261            DISK                      AS01328 S01432
     F*FWDRTFE*O   F     436            DISK                      AS01432 089129
     F**********FWDRTFE O   F     611            DISK                      A        089129   CSD006
     FFWDRTFE O   F     719            DISK                      A                           CSD006
     F                                              KCOMIT
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,DL0090E001
0072 E                    EMSG    1   5 55               ERROR MESSAGES
     E/COPY WNCPYSRC,DL0090E002
0073 E                    ERCD       19  4               ERROR CODES
0074 E********************DAY        25  3 0             NO. DAYS - SCREENS01328
0075 E********************DYA        25  3               NO. DAYS - ALPHA S01328
0076 E********************DYS        25  3 0             NO. DAYS - FWDRT S01328
0074 E                    DAY        25  5 0             NO. DAYS - SCREENS01328
0075 E                    DYA        25  5               NO. DAYS - ALPHA S01328
0076 E                    DYS        25  5 0             NO. DAYS - FWDRT S01328
0077 E********************RAT        25 12 8             RATE - SCREEN    089129
0077 E                    RAT        25 13 8             RATE - SCREEN    089129
0078 E********************RTE        25 13               RATE - ALPHA     089129
0079 E********************RTN        25 12 8             RATE - FWDRT     089129
0078 E                    RTE        25 14               RATE - ALPHA     089129
0079 E                    RTN        25 13 8             RATE - FWDRT     089129
0079 E**********          RT6        25 12 6             6 DP OUTPUT ARRAY             E19847 138010
0079 E**********          RT7        25 12 7             6 DP OUTPUT ARRAY             E19847 138010
0079 E                    RT6        25 13 6             6 DP OUTPUT ARRAY                    138010
0079 E                    RT7        25 13 7             6 DP OUTPUT ARRAY                    138010
0080 E                    ZA1        16  1               ZALIGN SR. ARRAY
0081 E                    ZA2        16  1               ZALIGN SR. ARRAY
0082 I**DL0090FMNS**02***2*CS***3*CF                                      S01199
0083 I*******OR   03   2 CS   3 CI                                        S01199
0084 I*******OR   04   2 CS   3 CA                                        S01199
0085 I*******OR   05   2 CS   3 CD                                        S01199
     I*********                               1   1 *IN12                 S01199
0087 I*********                               2   3 SCRN                  S01199
0088 I*********                               4   4 ACTNX                 S01199
0089 I*********                               5   7 CCYS                  S01199
0090 I*********                               8  10 DYA,1                 S01199
0091 I*********                              11  23 RTE,1                 S01199
0092 I*********                              24  26 DYA,2                 S01199
0093 I*********                              27  39 RTE,2                 S01199
0094 I*********                              40  42 DYA,3                 S01199
0095 I*********                              43  55 RTE,3                 S01199
0096 I*********                              56  58 DYA,4                 S01199
0097 I*********                              59  71 RTE,4                 S01199
0098 I*********                              72  74 DYA,5                 S01199
0099 I*********                              75  87 RTE,5                 S01199
0100 I*********                              88  90 DYA,6                 S01199
0101 I*********                              91 103 RTE,6                 S01199
0102 I*********                             104 106 DYA,7                 S01199
0103 I*********                             107 119 RTE,7                 S01199
0104 I*********                             120 122 DYA,8                 S01199
0105 I*********                             123 135 RTE,8                 S01199
0106 I*********                             136 138 DYA,9                 S01199
0107 I*********                             139 151 RTE,9                 S01199
0108 I*********                             152 154 DYA,10                S01199
0109 I*********                             155 167 RTE,10                S01199
0110 I*********                             168 170 DYA,11                S01199
0111 I*********                             171 183 RTE,11                S01199
0112 I*********                             184 186 DYA,12                S01199
0113 I*********                             187 199 RTE,12                S01199
0114 I*********                             200 202 DYA,13                S01199
0115 I*********                             203 215 RTE,13                S01199
0116 I*********                             216 218 DYA,14                S01199
0117 I*********                             219 231 RTE,14                S01199
0118 I*********                             232 234 DYA,15                S01199
0119 I*********                             235 247 RTE,15                S01199
0120 I*********                             248 250 DYA,16                S01199
0121 I*********                             251 263 RTE,16                S01199
0122 I*********                             264 266 DYA,17                S01199
0123 I*********                             267 279 RTE,17                S01199
0124 I*********                             280 282 DYA,18                S01199
0125 I*********                             283 295 RTE,18                S01199
0126 I*********                             296 298 DYA,19                S01199
0127 I*********                             299 311 RTE,19                S01199
0128 I*********                             312 314 DYA,20                S01199
0129 I*********                             315 327 RTE,20                S01199
0130 I*********                             328 330 DYA,21                S01199
0131 I*********                             331 343 RTE,21                S01199
0132 I*********                             344 346 DYA,22                S01199
0133 I*********                             347 359 RTE,22                S01199
0134 I*********                             360 362 DYA,23                S01199
0135 I*********                             363 375 RTE,23                S01199
0136 I*********                             376 378 DYA,24                S01199
0137 I*********                             379 391 RTE,24                S01199
0138 I*********                             392 394 DYA,25                S01199
0139 I*********                             395 407 RTE,25                S01199
0140 I*********                               8 207 DATA1                 S01199
0141 I*********                             208 407 DATA2                 S01199
0142 I*********                             408 408 ACTN                  S01199
0143 I*********                             409 411 CCYX            15    S01199
      **
     IDL0090FMNS  02   1 CS   2 CF                                        S01199
     I       OR   03   1 CS   2 CI                                        S01199
     I       OR   04   1 CS   2 CA                                        S01199
     I       OR   05   1 CS   2 CD                                        S01199
     I                                        1   2 SCRN                  S01199
     I                                        3   3 ACTNX                 S01199
     I                                        4   6 CCYS                  S01199
     I**************************************  7   9 DYA,1          S01199 S01328
     I************************************** 10  22 RTE,1          S01199 S01328
     I************************************** 23  25 DYA,2          S01199 S01328
     I************************************** 26  38 RTE,2          S01199 S01328
     I************************************** 39  41 DYA,3          S01199 S01328
     I************************************** 42  54 RTE,3          S01199 S01328
     I************************************** 55  57 DYA,4          S01199 S01328
     I************************************** 58  70 RTE,4          S01199 S01328
     I************************************** 71  73 DYA,5          S01199 S01328
     I************************************** 74  86 RTE,5          S01199 S01328
     I************************************** 87  89 DYA,6          S01199 S01328
     I************************************** 90 102 RTE,6          S01199 S01328
     I**************************************103 105 DYA,7          S01199 S01328
     I**************************************106 118 RTE,7          S01199 S01328
     I**************************************119 121 DYA,8          S01199 S01328
     I**************************************122 134 RTE,8          S01199 S01328
     I**************************************135 137 DYA,9          S01199 S01328
     I**************************************138 150 RTE,9          S01199 S01328
     I**************************************151 153 DYA,10         S01199 S01328
     I**************************************154 166 RTE,10         S01199 S01328
     I**************************************167 169 DYA,11         S01199 S01328
     I**************************************170 182 RTE,11         S01199 S01328
     I**************************************183 185 DYA,12         S01199 S01328
     I**************************************186 198 RTE,12         S01199 S01328
     I**************************************199 201 DYA,13         S01199 S01328
     I**************************************202 214 RTE,13         S01199 S01328
     I**************************************215 217 DYA,14         S01199 S01328
     I**************************************218 230 RTE,14         S01199 S01328
     I**************************************231 233 DYA,15         S01199 S01328
     I**************************************234 246 RTE,15         S01199 S01328
     I**************************************247 249 DYA,16         S01199 S01328
     I**************************************250 262 RTE,16         S01199 S01328
     I**************************************263 265 DYA,17         S01199 S01328
     I**************************************266 278 RTE,17         S01199 S01328
     I**************************************279 281 DYA,18         S01199 S01328
     I**************************************282 294 RTE,18         S01199 S01328
     I**************************************295 297 DYA,19         S01199 S01328
     I**************************************298 310 RTE,19         S01199 S01328
     I**************************************311 313 DYA,20         S01199 S01328
     I**************************************314 326 RTE,20         S01199 S01328
     I**************************************327 329 DYA,21         S01199 S01328
     I**************************************330 342 RTE,21         S01199 S01328
     I**************************************343 345 DYA,22         S01199 S01328
     I**************************************346 358 RTE,22         S01199 S01328
     I**************************************359 361 DYA,23         S01199 S01328
     I**************************************362 374 RTE,23         S01199 S01328
     I**************************************375 377 DYA,24         S01199 S01328
     I**************************************378 390 RTE,24         S01199 S01328
     I**************************************391 393 DYA,25         S01199 S01328
     I**************************************394 406 RTE,25         S01199 S01328
     I**************************************  7 206 DATA1          S01199 S01328
     I**************************************207 406 DATA2          S01199 S01328
     I**************************************407 407 ACTN           S01199 S01328
     I**************************************408 410 CCYX        15 S01199 S01328
     I**************************************  7  11 DYA,1          S01328 089129
     I************************************** 12  24 RTE,1          S01328 089129
     I************************************** 25  29 DYA,2          S01328 089129
     I************************************** 30  42 RTE,2          S01328 089129
     I************************************** 43  47 DYA,3          S01328 089129
     I************************************** 48  60 RTE,3          S01328 089129
     I************************************** 61  65 DYA,4          S01328 089129
     I************************************** 66  78 RTE,4          S01328 089129
     I************************************** 79  83 DYA,5          S01328 089129
     I************************************** 84  96 RTE,5          S01328 089129
     I************************************** 97 101 DYA,6          S01328 089129
     I**************************************102 114 RTE,6          S01328 089129
     I**************************************115 119 DYA,7          S01328 089129
     I**************************************120 132 RTE,7          S01328 089129
     I**************************************133 137 DYA,8          S01328 089129
     I**************************************138 150 RTE,8          S01328 089129
     I**************************************151 155 DYA,9          S01328 089129
     I**************************************156 168 RTE,9          S01328 089129
     I**************************************169 173 DYA,10         S01328 089129
     I**************************************174 186 RTE,10         S01328 089129
     I**************************************187 191 DYA,11         S01328 089129
     I**************************************192 204 RTE,11         S01328 089129
     I**************************************205 209 DYA,12         S01328 089129
     I**************************************210 222 RTE,12         S01328 089129
     I**************************************223 227 DYA,13         S01328 089129
     I**************************************228 240 RTE,13         S01328 089129
     I**************************************241 245 DYA,14         S01328 089129
     I**************************************246 258 RTE,14         S01328 089129
     I**************************************259 263 DYA,15         S01328 089129
     I**************************************264 276 RTE,15         S01328 089129
     I**************************************277 281 DYA,16         S01328 089129
     I**************************************282 294 RTE,16         S01328 089129
     I**************************************295 299 DYA,17         S01328 089129
     I**************************************300 312 RTE,17         S01328 089129
     I**************************************313 317 DYA,18         S01328 089129
     I**************************************318 330 RTE,18         S01328 089129
     I**************************************331 335 DYA,19         S01328 089129
     I**************************************336 348 RTE,19         S01328 089129
     I**************************************349 353 DYA,20         S01328 089129
     I**************************************354 366 RTE,20         S01328 089129
     I**************************************367 371 DYA,21         S01328 089129
     I**************************************372 384 RTE,21         S01328 089129
     I**************************************385 389 DYA,22         S01328 089129
     I**************************************390 402 RTE,22         S01328 089129
     I**************************************403 407 DYA,23         S01328 089129
     I**************************************408 420 RTE,23         S01328 089129
     I**************************************421 425 DYA,24         S01328 089129
     I**************************************426 438 RTE,24         S01328 089129
     I**************************************439 443 DYA,25         S01328 089129
     I**************************************444 456 RTE,25         S01328 089129
     I**************************************  7 206 DATA1          S01328 089129
     I**************************************207 406 DATA2          S01328 089129
     I**************************************407 456 DATA3          S01328 089129
     I**************************************457 457 ACTN           S01328 089129
     I**************************************458 460 CCYX           S15328 S01328
     I                                        7  11 DYA,1                 089129
     I                                       12  25 RTE,1                 089129
     I                                       26  30 DYA,2                 089129
     I                                       31  44 RTE,2                 089129
     I                                       45  49 DYA,3                 089129
     I                                       50  63 RTE,3                 089129
     I                                       64  68 DYA,4                 089129
     I                                       69  82 RTE,4                 089129
     I                                       83  87 DYA,5                 089129
     I                                       88 101 RTE,5                 089129
     I                                      102 106 DYA,6                 089129
     I                                      107 120 RTE,6                 089129
     I                                      121 125 DYA,7                 089129
     I                                      126 139 RTE,7                 089129
     I                                      140 144 DYA,8                 089129
     I                                      145 158 RTE,8                 089129
     I                                      159 163 DYA,9                 089129
     I                                      164 177 RTE,9                 089129
     I                                      178 182 DYA,10                089129
     I                                      183 196 RTE,10                089129
     I                                      197 201 DYA,11                089129
     I                                      202 215 RTE,11                089129
     I                                      216 220 DYA,12                089129
     I                                      221 234 RTE,12                089129
     I                                      235 239 DYA,13                089129
     I                                      240 253 RTE,13                089129
     I                                      254 258 DYA,14                089129
     I                                      259 272 RTE,14                089129
     I                                      273 277 DYA,15                089129
     I                                      278 291 RTE,15                089129
     I                                      292 296 DYA,16                089129
     I                                      297 310 RTE,16                089129
     I                                      311 315 DYA,17                089129
     I                                      316 329 RTE,17                089129
     I                                      330 334 DYA,18                089129
     I                                      335 348 RTE,18                089129
     I                                      349 353 DYA,19                089129
     I                                      354 367 RTE,19                089129
     I                                      368 372 DYA,20                089129
     I                                      373 386 RTE,20                089129
     I                                      387 391 DYA,21                089129
     I                                      392 405 RTE,21                089129
     I                                      406 410 DYA,22                089129
     I                                      411 424 RTE,22                089129
     I                                      425 429 DYA,23                089129
     I                                      430 443 RTE,23                089129
     I                                      444 448 DYA,24                089129
     I                                      449 462 RTE,24                089129
     I                                      463 467 DYA,25                089129
     I                                      468 481 RTE,25                089129
     I                                        7 206 DATA1                 089129
     I                                      207 406 DATA2                 089129
     I                                      407 481 DATA3                 089129
     I                                      482 482 ACTN                  089129
     I                                      483 485 CCYX            15    089129
     I*
     I*   CATCHALL
     I********NS**01*********                                             E19847
0144 I*    FORWARD RATES FILE - HEADER RECORD.
0145 I*
0146 IFWDRT   NS  08   1 CH
0147 I                                        1   1 RECI
0148 I                                        2   4 CCY
0149 I                                    P   5   70NORE
0150 I                                    P   8  100FLSZ
0151 I                                    P  11  130NLRB
0152 I                                    P  14  160NINS
0153 I                                    P  17  190NAMD
0154 I                                    P  20  220NDEL
0155 I                                    P  23  250NLRA
0156 I                                    P 250 2520LCD
0157 I                                      253 253 CHTP
0158 I                                    P 254 2560TNLU
0159 I                                        1 150 FWR1
0160 I                                      151 256 FWR2
0161 I*
0162 I*
0163 I*    FORWARD RATES FILE - DETAIL RECORD.
0164 I*
0165 IFWDRT   NS  06   1 CD
0166 I       OR   07   1 C*
0167 I                                        1   1 RECI
0168 I                                        2   4 CCY
0169 I************************************P   5  54 DYS                   S01328
0170 I************************************P  55 229 RTN                   S01328
0171 I************************************P 250 2520LCDF                  S01328
0172 I************************************  253 253 CHTPF                 S01328
0173 I************************************P 254 2560TNLUF                 S01328
0174 I************************************    1 150 FWR1                  S01328
0175 I************************************  151 256 FWR2                  S01328
0169 I                                    P   5  79 DYS                   S01328
0170 I                                    P  80 254 RTN                   S01328
0171 I                                    P 255 2570LCDF                  S01328
0172 I                                      258 258 CHTPF                 S01328
0173 I                                    P 259 2610TNLUF                 S01328
     I                                      612 612 RPRL                                      CSD006
     I                                      613 638 TSTAMP                                    CSD006
     I                                    P 639 6460DFTS                                      CSD006
     I                                      647 666 FOID                                      CSD006
     I                                      667 686 AFOI                                      CSD006
     I                                      687 718 DREQ                                      CSD006
     I                                      719 719 FWRT                                      CSD006
0176 I*
0177 I********NS**09                                                      E19847
0178 I****************                                             E11232 S01194
0179 I*****TABLE*FILE*- I. C. D. 1                                 E11232 S01194
0180 I****************                                             E11232 S01194
0181 I*ABLE***NS****** 1 CD   2 C0   3 C1                          E11232 S01194
0182 I*******AND******12 C1  13 C0                                 E11232 S01194
0183 I****************                        1   1 RECI           E11232 S01194
0184 I****************                        2   30RECT           E11232 S01194
0185 I****************                       12  130RCDE           E11232 S01194
0188 I****************                    P  77  790RUND           E11232 S01194
0178 I****************                                                    S01194
0179 I*****TABLE*FILE*- CURRENCIES RECORD 1.                              S01194
0180 I****************                                                    S01194
0181 I*ABLE***NS**10** 1 CD   2 C2   3 C0                                 S01194
0182 I*******AND******13 C1  40 CY                                        S01194
0183 I****************                        1   1 RECI                  S01194
0184 I****************                        2   30RECT                  S01194
0185 I****************                       10  12 CCY                   S01194
0186 I****************                       13  130SREC                  S01194
0187 I****************                       14  27 CCNM                  S01194
0188 I****************                    P  28  348SPOT                  S01194
0189 I****************                       38  380CDP                   S01194
0190 I****************                       39  390TNOT                  S01194
0191 I****************                       40  40 DCCY                  S01194
0192 I****************                       41  44 SRC1                  S01194
0193 I****************                       45  48 SRC2                  S01194
0194 I****************                       49  520TACC                  S01194
0195 I****************                       53  560TEQV                  S01194
0196 I****************                       57  600SWQV                  S01194
0197 I****************                       61  640TAC4                  S01194
0198 I****************                       65  680TAC5                  S01194
0199 I****************                       69  69 HIND                  S01194
0200 I****************                    P  70  768PART                  S01194
0201 I****************                       77  780SSNO                  S01194
0202 I****************                    P  79  858ERLC                  S01194
0203 I****************                    P  90  920LCD                   S01194
0204 I****************                       93  93 CHTP                  S01194
0205 I****************                    P  94  960TNLU                  S01194
0206 I****************                                                    S01194
0207 I*****CATCH*ALL**                                                    S01194
0208 I********NS******                                                    S01194
0208 I*****************                      14  16 BCCY           E12711 S01194
0237 I*
0238 I            DS
0239 I                                        1  11 LUD
0240 I                                        1   50LCDF
0241 I                                        6   6 CHTPF
0242 I                                        7  110TNLUF
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      254 263 USRID
     I*
     IDNATN       DS                              5
     I                                        1   50FNATN
     I**
     I**  DATA STRUCTURE FOR ERROR HANDLING SUBROUTINE
     I**
     IINFDS       DS
     I                                     *STATUS  STATUS
0255 I**
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I                                       26  35 USRIDX
     I                                       51  52 SCRN
     I                                       53  53 ACTNY
     I                                       54  56 CCYS
     I                                       57 256 DATA1
     I                                      257 456 DATA2
     I                                      457 531 DATA3                 089129
     I************                          457 506 DATA3          S01328 089129
     I*                                                                   S01194
     ILDA       E DSLDA                         256                       CEU026
      *                                                                   CEU026
      ** Local data area for database error details                       CEU026
      ** *LOCK IN LDA immediately before and OUT LDA immediately          CEU026
      ** after each database error handling.                              CEU026
      **                                                                  CEU026
      **                                    134 141 DBFILE                CEU026
      **       Defines:                     142 170 DBKEY                 CEU026
      **                                    171 180 DBPGM                 CEU026
      **                                    181 1830DBASE                 CEU026
     ISDBANK    E DSSDBANKPD                                              S01194
     I** External DS for Bank Details                                     S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** External DS for Currency Details                                 S01194
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              CEU026
     I** External DS for General Ledger Details.                          CEU026
     I*                                                                   CEU026
     IDSFDY     E DSDSFDY                                                 S01194
     I* DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                      S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                       S01194
     I*                                                                   S01194
     IRUNDAT      DS                                                      E219
     I*  DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           E219
     I                                       13  13 @MBIN                 E219
     I*                                                                   E219
     I*  EXTERNAL DATA AREA OF DEFAULT BRANCH FOR USER                    E219
     I*ZMUSER******DS**************************                     E219  LN0303
     IZMUSER      DS                             17                       LN0303
     I                                       11  13 ZDFB                  E219
     I/COPY WNCPYSRC,DL0090I001
      *                                                                   E219
     C*
     C/COPY ZSRSRC,DFTTSTAMPC                                                                 CSD006
      *                                                                                       CSD006
     C**   FROM ERROR HANDLING SUBROUTINE RETURN TO EXIT POINT
     C           STATUS    IFEQ 01021
     C                     Z-ADD0         STATUS  50
     C                     GOTO INFTAG
     C                     END
0243 C*    FIRST CYCLE CALCULATIONS
     C*****ALLOW HELP                                                     S01199
     C**
     C           *IN11     IFEQ '1'
     C************IN12     DOUEQ'0'                                       S01199
     C                     READ DL0090FM                 12
     C************IN12     IFEQ '1'                                       S01199
     C*********************MOVEAERCD      HERCD 160                       S01199
     C*********************MOVEL'DL0090  'HBPGM   8                       S01199
     C*********************CALL 'MHELP'                                   S01199
     C*********************PARM           HBPGM                           S01199
     C*********************PARM           HERCD                           S01199
     C*********************END                                            S01199
     C*********************END                                            S01199
     C*********************SETOF                         12               S01199
     C                     GOTO ENDFC
     C                     END
0249 C*                                                            E12711 S01194
0250 C**GET*BASE*CURRENCY*DEC*PLACES                               E12711 S01194
0251 C**CHAIN*TO*ICD*REC*2*FOR*BASE*CURRENCY                       E12711 S01194
0252 C*****************    MOVEL'01    '  TABKEY                   E12711 S01194
0253 C*****************    MOVE '    11'  TABKEY                   E12711 S01194
0254 C*****************    EXSR TABCHN                             E12711 S01194
     C**CHAIN*TO*CURRENCY*REC*FOR*BASE*CURRENCY*TO*GET*DEC*PLACES  E12711 S01194
     C**N26************    MOVEL'20    '  TABKEY                   E12711 S01194
     C**N26************    MOVELBCCY      WK4                      E12711 S01194
     C**N26************    MOVE '1'       WK4                      E12711 S01194
     C**N26************    MOVE WK4       TABKEY                   E12711 S01194
     C**N26************    EXSR TABCHN                             E12711 S01194
0255 C**N26************    Z-ADDCDP       BCCDP   10               E12711 S01194
     C**IF*ICD*RECORD*NOT*FOUND,*TERMINATE*PROGRAM                 E12711 S01194
0256 C***26************    SETON                     U7U8          E12711 S01194
0257 C***26************    GOTO END                                E12711 S01194
     C*                                                                   S01194
     C                     MOVEACPY@      BIS@   80
      * Initialise LDA                                                    CEU026
     C           *NAMVAR   DEFN           LDA                             CEU026
     C                     MOVEL'SD0020M 'DBPGM                           CEU026
     C*                                                                   S01194
     C** CALL TO BANK ACCESS OBJECT TO OBTAIN BASE CURRENCY               S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C***********          PARM           SDBANK                          S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C*********************MOVEL'SDBANKPD'DBFILE 10        *********S01194CEU026
     C*********************MOVEL'01'      DBASE   3        * DBERR 0S01194CEU026
     C*********************MOVEL@OPTN     DBOPTN  7        *********S01194CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDBANKPD'DBFILE           ************   CEU026
     C                     MOVEL'01'      DBASE            * DBERR 01 *   CEU026
     C                     MOVEL@OPTN     DBKEY            ************   CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CEU026
      ** Check for EMU Forward Rates CEU026                               CEU026
      *                                                                   CEU026
     C                     CALL 'AOSARDR0'                                CEU026
     C                     PARM *BLANKS   @RTCD                           CEU026
     C                     PARM '*VERIFY' @OPTN                           CEU026
     C                     PARM 'CEU026'  @SARD   6                       CEU026
     C                     PARM           DSFDY                           CEU026
     C                     SELEC                                          CEU026
     C           @RTCD     WHEQ *BLANK                                    CEU026
     C                     MOVE 'Y'       CEU026  1                       CEU026
     C           @RTCD     WHEQ '*NRF'                                    CEU026
     C                     MOVE 'N'       CEU026                          CEU026
     C                     OTHER                                          CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SCSARDPD'DBFILE            ************* CEU026
     C                     MOVEL'004'     DBASE             *DBERROR 004* CEU026
     C                     MOVEL@OPTN     DBKEY             ************* CEU026
     C                     SETON                     U7U8LR               CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     CEU026
     C                     ENDSL                                          CEU026
     C*                                                                   S01194
     C** GET BASE CURRENCY DECIMAL PLACES                                 S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM BJCYCD    @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C************         PARM           SDCURR                          S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   CEU026
     C*********************MOVEL@OPTN     DBOPTN           ******** S01194CEU026
     C                     MOVELBJCYCD    DBKEY  29                       S01194
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
     C                     Z-ADDA6NBDP    BCCDP   10                      S01194
     C                     MOVELA6EUER    SPOTRA 138                      CEU026
     C******************** MOVELA6MDIN    MULDIV  1                 CEU002152073
     C                     MOVELA6EUMD    MULDIV  1                       152073
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
      *                                                                   CEU026
      ** Check for Whether the Base is an 'IN' Currency                   CEU026
      ** and past its Transition Start Date.                              CEU026
      *                                                                   CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     MOVE 'Y'       INCCY   1                       CEU026
     C                     ELSE                                           CEU026
     C                     MOVE 'N'       INCCY                           CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
      ** Check for EURO Currency Name                                     CEU026
      *                                                                   CEU026
     C**********           CALL 'AOGELRR0'                                CEU026              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR'  @RTCD                           CEU026
     C                     PARM '*FIRST ' @OPTN                           CEU026
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU026              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDGELRPD'DBFILE            ************* CEU026
     C                     MOVEL'003'     DBASE             *DBERROR 003* CEU026
     C                     MOVEL@OPTN     DBKEY             ************* CEU026
     C                     SETON                     U7U8LR               CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
      ** Initialise Forward Rates For a EURO Base or 'IN' Currency Base   CEU026
      ** or 'OUT' Base.                                                   CEU026
      *                                                                   CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'Y'       INITN   1        First Call     CEU026
     C                     PARM *BLANKS   RCODE   7        Return Code    CEU026
     C                     ENDIF                                          CEU026
0248 C*
0249 C*    SET UP FIELDS
0250 C                     MOVE ' '       BLNK16 16
0251 C                     MOVE ' '       BLNK76 76
0252 C                     Z-ADD8         ZADEC
0253 C                     Z-ADD4         ZADIG
0254 C                     SETON                     3233
     C*****************                                            E11232 S01194
     C*****ACCESS*I.C.D.*1                                         E11232 S01194
     C*****************    MOVEL'01      'TABKEY                   E11232 S01194
     C*****************    MOVE '  10'    TABKEY                   E11232 S01194
     C*****************    EXSR TABCHN                             E11232 S01194
     C***26************    SETON                     LRU7U8        E11232 S01194
     C***26************    GOTO END                                E11232 S01194
0255 C*
0256 C*  OUTPUT INITIAL SCREEN
0257 C                     EXSR SFOUT
     C                     SETON                     11
     C/COPY WNCPYSRC,DL0090C001
0258 C                     GOTO END
0259 C*
0260 C*    DETAIL CALCULATIONS
0261 C           ENDFC     TAG                             ** ENDFC TAG **
0262 C                     Z-ADD0         S       20
0263 C                     MOVE BLNK76    ERCD
0264 C                     MOVE BLNK76    EMES   55
0265 C                     SETON                     3233
0266 C                     EXSR BOFF
0267 C*    CHECK COMMAND KEY STATUS
0268 C   KL                EXSR SFOUT
0269 C   KC
0270 COR KL                GOTO END
0271 C   KJ 05             GOTO UDLOG
0272 C*
0273 C*    ERROR IF CMD10 NOT FROM DELETION SCREEN
0274 C   KJ                MOVELEMSG,1    EMES
0275 C   KJ                SETOF                     33
0276 C   KJ                GOTO END
0277 C*
0278 C*    CHECK SCREEN TYPE
0279 C   02                GOTO SFIN
0280 C   03
0281 COR 04                GOTO SISAIN
0282 C*
0283 C*    ERROR IF DELETION SCREEN WITHOUT CMD10
0284 C                     MOVELEMSG,1    EMES
0285 C                     SETOF                     33
0286 C                     GOTO END
0287 C*
0288 C*    PROCESS INITIAL SCREEN
0289 C           SFIN      TAG                             ** SFIN TAG **
0290 C                     EXSR SFOUT
0291 C*
0292 C*    CHECK WHETHER CURRENCY IS ON FORWARD RATE FILE
0293 C                     MOVE CCYX      FRTKEY  3
0294 C                     EXSR FRTCHN
     C*                                                                   E22348
     C*  RELEASE FWDRT RECORD BEFORE CHAINING TO TABLE FILE TO PREVENT    E22348
     C*  ERROR ON EXCPT STATEMENT.                                        E22348
     C*                                                                   E22348
     C  N26                SETON                     47                   E22348
     C  N26                EXSR EXCEPT                                    E22348
     C                     MOVE LUD       LUDSV  11                       E22348
     C   26                MOVE BLNK16    LUDSV                           E22348
     C*                                                                   E19847
     C*    CONVERT RATE FROM FILE TO HAVE CORRECT NUMBER OF DEC. PLACES   E19847
     C*                                                                   E19847
     C                     CALL 'AOCURRR0'                                E19847
     C                     PARM *BLANKS   @RTCD                           E19847
     C                     PARM '*KEY   ' @OPTN                           E19847
     C                     PARM CCYX      @AJCD   3                       E19847
     C           SDCURR    PARM SDCURR    DSSDY                           E19847
     C*
     C           CCYX      IFEQ '?'                                       BHF575
     C                     MOVELA6CYCD    CCYX                            BHF575
     C*                                                                   E32245
     C** Check whether currency is on FORWARD RATE file.                  E32245
     C*                                                                   E32245
     C                     MOVE CCYX      FRTKEY  3                       E32245
     C                     EXSR FRTCHN                                    E32245
     C                     END                                            BHF575
     C*                                                             E19847BHF200
     C********** @RTCD     IFNE *BLANKS                             E19847BHF200
     C**********           MOVEL'SDCURRPD'DBFILE     ************   E19847BHF200
     C**********           MOVEL'03'      DBASE      * DBERR 03 *   E19847BHF200
     C**********           MOVEL@OPTN     DBOPTN     ************   E19847BHF200
     C**********           MOVELBJCYCD    DBKEY  29                 E19847BHF200
     C**********           EXSR *PSSR                               E19847BHF200
     C**********           GOTO END                                 E19847BHF200
     C**********           END                                      E19847BHF200
     C**********                                                    E19847BHF200
     C*
     C*    CALC DIFFERENCE IN DEC PLACES BETWEEN CCY AND BASE CCY.        E19847
     C*
     C           A6NBDP    SUB  BCCDP     CDIFF   10                      E19847
     C           CDIFF     ADD  4         CDIFF                           E19847
     C*                                                                   E19847
     C                     SETOF                     0109                 E19847
     C                     Z-ADD1         A       20                      E19847
     C           CDIFF     IFEQ 1                                         E19847
     C           A         DOWLE25                                        E19847
     C                     Z-ADDRTN,A     RT6,A                           E19847
     C                     ADD  1         A                               E19847
     C                     END                                            E19847
     C                     SETON                     01                   E19847
     C                     END                                            E19847
     C           CDIFF     IFEQ 2                                         E19847
     C           A         DOWLE25                                        E19847
     C                     Z-ADDRTN,A     RT7,A                           E19847
     C                     ADD  1         A                               E19847
     C                     END                                            E19847
     C                     SETON                     09                   E19847
     C                     END                                            E19847
     C*                                                                   E19847
0295 C**N26******          SETON                     47                   E22348
0296 C**N26******          EXSR EXCEPT                                    E22348
0297 C***********          MOVE LUD       LUDSV  11                       E22348
0298 C***26******          MOVE BLNK16    LUDSV                           E22348
0299 C*
0300 C*    TEST ACTION TYPE
0301 C                     SETOF                     363728
0302 C                     SETON                     14
0303 C           ACTN      COMP 'I'                      16
0304 C           ACTN      COMP 'A'                      17
0305 C           ACTN      COMP 'D'                      18
     C/COPY WNCPYSRC,DL0090C003
0306 C           ACTN      COMP 'E'                      19
0307 C                     MOVE ACTN      ACTNX
0308 C  N16N17N18
0309 CANN19                SETON                     36
0310 C*
0311 C*    MOVE ERROR CODE INTO ARRAY IF ACTION INVALID
0312 C   36      S         ADD  1         S
0313 C   36                MOVE '021'     ERCD,S
     C/COPY WNCPYSRC,DL0090C004
0314 C   36                MOVE EMSG,2    EMES
     C/COPY WNCPYSRC,DL0090C005
0315 C   36                SETOF                     3233
     C*                                                                   S01117
      ** Validation of user's action code security.                       S01117
      ** Dependant on multibranched or not                                E219
     C           @MBIN     IFEQ 'N'                                       E219
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM           ACTN                            S01117
     C                     PARM           @ERR    10                      S01117
      **                                                                  S01117
     C                     ELSE                                           E219
     C           *NAMVAR   DEFN           ZMUSER                          E219
     C                     IN   ZMUSER                                    E219
     C                     CALL 'ZVACTBU'                                 E219
     C                     PARM           ACTN                            E219
     C                     PARM           ZDFB                            E219
     C                     PARM           @ERR    10                      E219
     C                     END                                            E219
     C*
     C           @ERR      IFNE 0                          B1             S01117
     C           S         ADD  1         S                *1             S01117
     C                     MOVE '235'     ERCD,S           *1             S01117
     C                     SETON                     36    *1             S01117
     C                     SETOF                     3233  *1             S01117
     C                     END                             E1             S01117
0316 C*
0317 C*    ERROR IF NO CURRENCY CODE ENTERED
0318 C   15      S         ADD  1         S          37
0319 C   15                MOVE '229'     ERCD,S
0320 C   15                SETOF                     32
0321 C   36
0322 COR 37                GOTO END
0323 C*
0324 C*    CHECK ACTION AND CURRENCY COMPATIBLE
0325 C   06 16
0326 CORN06 17
0327 CORN06 18
0328 CORN06 19             SETON                     37
0329 C   37                GOTO SFER
0330 C*
0331 C*    IF INSERT CHECK CURRENCY VALID
0332 C***16**********      MOVEL'20      'TABKEY 12                       S01194
0333 C***16**********      MOVELCCYX      WK4     4                       S01194
0334 C***16**********      MOVE '1'       WK4                             S01194
0335 C***16**********      MOVE WK4       TABKEY                          S01194
0336 C***16**********      EXSR TABCHN                                    S01194
0337 C***16N10*******      SETON                     37                   S01194
     C                     MOVE *BLANKS   A6DLCI                          S01194
     C*                                                                   S01194
     C           *IN16     IFEQ '1'                        B**1           S01194
     C                     CALL 'AOCURRR0'                  **1           S01194
     C                     PARM *BLANKS   @RTCD             **1           S01194
     C                     PARM '*KEY   ' @OPTN             **1           S01194
     C                     PARM CCYX      @AJCD   3         **1           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C************         PARM           SDCURR            **1           S01194
      *                                                                   S01194
      **  IF CCY IS FOUND AND IS A DEALING CCY                            S01194
     C           @RTCD     IFEQ *BLANKS                    B**2           S01194
     C           A6DLCI    ANDEQ'Y'                        B**2           S01194
     C                     SETON                     10     **2           S01194
     C                     SETOF                     37     **2           S01194
     C                     ELSE                            X**2           S01194
     C                     SETON                     37     **2           S01194
     C                     SETOF                     10     **2           S01194
     C                     END                             E**2           S01194
     C                     END                             E**1           S01194
     C*                                                                   S01194
0338 C   37                GOTO SFER                                      S01194
0339 C                     MOVE CCYX      CCYS
     C*                                                                   CEU026
     C** If CCY is 'IN' then forward rates not amendable.                 CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     SETON                     25                   CEU026
     C                     ELSE                                           CEU026
     C                     SETOF                     25                   CEU026
     C                     ENDIF                                          CEU026
     C                     ELSE                                           CEU026
     C                     SETOF                     25                   CEU026
     C                     ENDIF                                          CEU026
0340 C*
0341 C*    OUTPUT REQUESTED SCREEN
0342 C   16                EXSR SIOUT
0343 C   17                EXSR SAOUT
0344 C   18                EXSR SDOUT
0345 C   19                EXSR SEOUT
0346 C                     GOTO END
0347 C*
0348 C*    MOVE ERROR CODE INTO ARRAY
0349 C           SFER      TAG                             ** SFER TAG **
0350 C           S         ADD  1         S
0351 C   16
0352 COR 16 10             MOVE '230'     ERCD,S
0353 C  N16                MOVE '231'     ERCD,S
0354 C  N16                MOVE EMSG,4    EMES
0355 C   16 06             MOVE EMSG,3    EMES
0356 C   16 06
0357 CORN16                SETOF                     33
0358 C                     SETOF                     32
0359 C                     GOTO END
0360 C*
0361 C*    PROCESS INSERT AND AMEND SCREENS
0362 C           SISAIN    TAG                             ** SISAIN TAG *
0363 C*
0364 C*    RESET OUTPUT INDICATOR
0365 C                     SETON                     13
0366 C*    MOVE INPUT DATA INTO ALPHA FIELDS
0367 C******************** MOVEARTE       LOTR1 195                                           138010
0368 C******************** MOVEARTE,16    LOTR2 130                                           138010
0367 C                     MOVEARTE       LOTR1 210                                           138010
0368 C                     MOVEARTE,16    LOTR2 140                                           138010
0369 C*********************MOVEADYA       LOTD   75                       S01328
0369 C                     MOVEADYA       LOTD  125                       S01328
0370 C*
0371 C*    IF ONLY WARNING ERRORS ON LAST OUTPUT CHECK FOR
 372 C*    DATA CHANGES
0373 C   28      LOTD      COMP DSAV                     28
0374 C   28      LOTR1     COMP RSAV1                    28
0375 C   28      LOTR2     COMP RSAV2                    28
0376 C   28                GOTO UDLOG
0377 C*
0378 C*    VALIDATE DATA
0379 C                     SETOF                     2829
0380 C                     EXSR CHECK
0382 C   29                SETOF                     28
     C                     SETOF                     39                   E10181
0383 C*
0384 C*    IF ONLY WARNING ERRORS SAVE DATA
0385 C***28*************** MOVE LOTR1     RSAV1 195                                           138010
0386 C***28*************** MOVE LOTR2     RSAV2 130                                           138010
0385 C   28                MOVE LOTR1     RSAV1 210                                           138010
0386 C   28                MOVE LOTR2     RSAV2 140                                           138010
0387 C***28****************MOVE LOTD      DSAV   75                       S01328
0387 C   28                MOVE LOTD      DSAV  125                       S01328
0388 C*
0389 C*    IF ERROR OUTPUT SCREEN
0390 C   28
0391 COR 29                SETOF                     32
0392 C   28
0393 COR 29                GOTO END
0394 C*
 395 C*    UPDATE PROCEDURE
0396 C           UDLOG     TAG                             ** UDLOG TAG **
0397 C*
0401 C*    READ RECORD TO BE UPDATED
0402 C                     EXSR FRTCHN
0403 C*
0404 C*  IF NO RECORD, BLANK OUT LAST UPDATE DATA
0405 C   26                MOVE BLNK16    LUD
0406 C*
0407 C*    CHECK FOR CHANGED RECORD
0408 C           LUD       COMP LUDSV                3838
0409 C  N38                GOTO RUNCH
0410 C*
     C           INFTAG    TAG                             ** INFTAG **
 411 C*    OUTPUT ERROR MESSAGE AND UPDATED RECORD, RELEASE FWDRT
0412 C                     MOVE EMSG,5    EMES
0413 C                     SETOF                     33
0414 C   07                SETOF                     13
0416 C  N26                SETON                     47
0418 C                     GOTO END
0419 C*
0421 C           RUNCH     TAG                             ** RUNCH TAG **
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
     C                     EXSR ZTNLU1
     C                     MOVE 'DL'      MDID    2
     C                     MOVEL'DL0090'  PGMN    8
     C                     MOVE WSID      WSIDX   3
     C                     MOVE USRID     USRIDX 10
     C                     MOVE ACTNX     ACTNY   1
 448 C*    UPDATE FORWARD DATES FILE
0454 C                     SETON                     46
0455 C                     EXSR EXCEPT
     C*                                                                   CEU026
     C** IF CHANGED RECORD = 'IN' CCY (I.E DAYS HAVE CHANGED)             CEU026
     C** RE-CALCULATE RATES FOR THAT DAY.                                 CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C                     CALL 'AOCURRR0'                                CEU026
     C                     PARM '*MSG   ' @RTCD                           CEU026
     C                     PARM '*KEY   ' @OPTN                           CEU026
     C                     PARM CCYS      @AJCD                           CEU026
     C           SDCURR    PARM SDCURR    DSSDY                           CEU026
      *                                                                   CEU026
     C           @RTCD     IFNE *BLANKS                                   CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDCURRPD'DBFILE           ************   CEU026
     C                     MOVEL'05'      DBASE            * DBERR 05 *   CEU026
     C                     MOVEL@OPTN     DBOPTN           ************   CEU026
     C                     MOVELCCYS      DBKEY                           CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     CEU026
     C                     GOTO END                                       CEU026
     C                     END                                            CEU026
      *                                                                   CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'N'       INITN            First Call     CEU026
     C                     PARM *BLANKS   RCODE            Return Code    CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0456 C*
0457 C*    READ FORWARD RATES HEADER
0458 C                     MOVE BLNK16    FRTKEY
0459 C                     EXSR FRTCHN
0460 C  N08                SETON                     U7U8
0461 C   U7 U8             GOTO END
0462 C*
0471 C*    UPDATE CONTROL FIELDS ON HEADER
0472 C   03      NINS      ADD  1         NINS
0473 C   04      NAMD      ADD  1         NAMD
0474 C   05      NDEL      ADD  1         NDEL
0475 C   03N07   NORE      ADD  1         NORE
0476 C   03      NLRA      ADD  1         NLRA
0477 C   05      NLRA      SUB  1         NLRA
0478 C*
0480 C**   UPDATE FORWARD RATES HEADER
0485 C                     SETON                     44
0486 C                     EXSR EXCEPT
     C*                                                                   CEU026
     C** IF CHANGED RECORD = EURO CCY, RE-CALCULATE 'IN' CURRENCIES       CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           CCYS      IFEQ BKEURO                                    CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'N'       INITN            First Call     CEU026
     C                     PARM *BLANKS   RCODE            Return Code    CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0487 C*
     C**   END COMMITMENT CONTROL
     C           CMTTXT    COMIT
0495 C*
0496 C*    OUTPUT INITIAL SCREEN
0497 C                     EXSR SFOUT
0498 C*
0499 C           END       TAG                             ** END TAG **
0500 C*
0501 C*    SET INDICATOR TO RELEASE SCREEN
0502 C   KC
     COR U8                SETON                     LR
0506 C                     SETON                     38
0507 C                     TIME           MTIME   60
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
0608 C*****SR.*TO*CHAIN*TO*TABLE*FILE                                     S01194
0609 C***********TABCHN****BEGSR                           *** TABCHN *** S01194
0610 C*****************                                                   S01194
0611 C*****************    SETOF                     10                   S01194
0612 C***********TABKEY    CHAINTABLE                26                   S01194
0613 C*****************    ENDSR                                          S01194
0614 C*****************                                                   S01194
0615 C********************************************************************
0616 C*    SR TO CHAIN TO FORWARD RATES FILE
0617 C           FRTCHN    BEGSR                           *** FRTCHN ***
0618 C*
0619 C                     SETOF                     060708
0620 C                     SETOF                     09
0621 C           FRTKEY    CHAINFWDRT                26
0622 C                     ENDSR
0623 C*
0624 C********************************************************************
0632 C********************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C*****************************************************************
0633 C*    SR TO PERFORM EXCEPTION OUTPUT
0634 C           EXCEPT    BEGSR                           *** EXCEPT ***
0635 C                     EXCPT
0638 C                     SETOF                     444647
0639 C*
0640 C                     ENDSR
0641 C*
0642 C********************************************************************
0643 C*    SR TO SETOF DAYS/RATE BLINK INDICATORS
0644 C           BOFF      BEGSR                           *** BOFF ***
0645 C*
0646 C                     SETOF                     404142
0647 C                     SETOF                     434445
0648 C                     SETOF                     464748
0649 C                     SETOF                     495051
0650 C                     SETOF                     525354
0651 C                     SETOF                     555657
0652 C                     SETOF                     585960
0653 C                     SETOF                     616263
0654 C                     SETOF                     646566
0655 C                     SETOF                     676869
0656 C                     SETOF                     707172
0657 C                     SETOF                     737475
0658 C                     SETOF                     767778
0659 C                     SETOF                     798081
0660 C                     SETOF                     828384
0661 C                     SETOF                     858687
0662 C                     SETOF                     8889
0663 C                     ENDSR
0664 C*
0665 C********************************************************************
0666 C*    SR TO VALIDATE INPUT DATA
0667 C           CHECK     BEGSR                           *** CHECK ***
0668 C                     Z-ADD0         RAT
0669 C                     Z-ADD0         DAY
0670 C                     Z-ADD1         N       20
0671 C                     SETOF                     222324
0673 C*    SET UP KEY FOR CURRENCY TABLE
0674 C*****************    MOVEL'20      'TABKEY                          S01194
0675 C*****************    MOVELCCYS      WK4                             S01194
0676 C*****************    MOVE '1'       WK4                             S01194
0677 C*****************    MOVE WK4       TABKEY                          S01194
0678 C*****************    EXSR TABCHN                             E12711 S01194
     C*                                                                   S01194
     C** CALL CURRENCY ACCESS OBJECTS                                     S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM CCYS      @AJCD                           S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C************         PARM           SDCURR                          S01194
     C*                                                                   S01194
     C           A6DLCI    IFEQ 'Y'                        B**1           S01194
     C                     SETON                     10     **1           S01194
     C                     ELSE                            X**1
     C                     SETOF                     10     **1           S01194
     C                     END                             E**1           S01194
     C*                                                                   S01194
0679 C*    CALC DIFFERENCE IN DEC PLACES BETWEEN CCY AND BASE CURRENCY    E12711
0680 C***********CDP***    SUB  BCCDP     CDIFF   10               E12711 S01194
     C           A6NBDP    SUB  BCCDP     CDIFF   10                      S01194
0681 C           CDIFF     ADD  4         CDIFF                           E12711
0678 C*
0679 C*    FIRST ELEMENT OF DAY AND RATE ARRAYS ARE VALIDATED
0680 C*    SEPARATELY
0681 C*    CHECK FIRST NO OF DAYS IS POSITIVE NUMERIC
0682 C*********************Z-ADD3         ZADIG                           S01328
0682 C                     Z-ADD5         ZADIG                           S01328
0683 C                     Z-ADD0         ZADEC
0684 C                     MOVE BLNK16    ZFIELD
0685 C                     MOVE DYA,1     ZFIELD
0686 C                     EXSR ZALIGN
0687 C   99                SETON                     40
0688 C  N40                MOVE ZFIELD    DAY,1
0689 C  N40      DAY,1     COMP 0                      4040
     C/COPY WNCPYSRC,DL0090C002
0690 C*
0691 C*    MOVE ERROR CODE INTO ARRAY.
0692 C   40      S         ADD  1         S          29
0693 C   40                MOVE '232'     ERCD,S
     C*                                                                   E26581
     C*    IF PERIOD ENTERED NOT IN ERROR SO FAR THEN CHECK THAT, WHEN    E26581
     C*    ADDED TO TODAY, IT DOES NOT EXCEED 99998.                      E26581
     C           *IN29     IFEQ '0'                                       E26581
     C***********          MOVE DYA,1     WDYA    50               E26581 047413
     C***********          MOVE DYA,1     WDAY    50               047413 065331
     C                     MOVE DAY,1     WDAY    50                      065331
     C***********BJRDNB    ADD  WDYA      WLIMIT  60               E26581 047413
     C           BJRDNB    ADD  WDAY      WLIMIT  60                      047413
     C           WLIMIT    IFGT 99998                                     E26581
     C                     ADD  1         S                               E26581
     C                     MOVE '232'     ERCD,S                          E26581
     C                     SETON                     2940                 E26581
     C                     END                                            E26581
     C                     END                                            E26581
0694 C*
0695 C*    CHECK IF FIRST FORWARD RATE IS BLANK.
      *                                                                   CEU026
      *    IF EMU FORWARD RATE SWITCHED ON AND CCY IS IN. RATES NOT       CEU026
      *    AMENDABLE. ALLOW BLANKS IN RATE FIELD.                         CEU026
     C           CEU026    IFEQ 'N'                                       CEU026
     C           *IN25     ANDEQ'0'                                       CEU026
0696 C           RTE,1     COMP BLNK16                   99
0697 C   99      S         ADD  1         S          29
0698 C   99                MOVE '233'     ERCD,S
0699 C   99                GOTO SET41
     C                     ENDIF                                          CEU026
0700 C*
     C           RTE,1     IFNE BLNK16                                    CEU026
0701 C*    ALIGN FIRST FORWARD RATE AND CHECK NUMERIC
0702 C*************        Z-ADD4         ZADIG                           089129
0702 C                     Z-ADD5         ZADIG                           089129
0703 C*    SET UP DECIMAL PLACES FOR MAX ALLOWED FOR CURRENCY             E12711
0704 C           CDIFF     IFEQ 1                                         E12711
0705 C                     Z-ADD6         ZADEC                           E12711
0706 C                     ELSE                                           E12711
0707 C           CDIFF     IFEQ 2                                         E12711
0708 C                     Z-ADD7         ZADEC                           E12711
0709 C                     ELSE                                           E12711
0703 C                     Z-ADD8         ZADEC
0704 C                     END                                            E12711
0705 C                     END                                            E12711
0704 C                     MOVE BLNK16    ZFIELD
0705 C                     MOVE RTE,1     ZFIELD
0706 C                     EXSR ZALIGN
0703 C*    IF NUMERIC AND DEC PLACES HAS BEEN LIMITED, RE-RUN ZALIGN TO   E12711
0704 C*    ALIGN DECIMAL PLACES FOR OUTPUT FIELD ZFIELD                   E12711
0705 C  N99      ZADEC     IFLT 8                                         E12711
0706 C                     Z-ADD8         ZADEC                           E12711
0707 C                     MOVE BLNK16    ZFIELD                          E12711
0708 C                     MOVE RTE,1     ZFIELD                          E12711
0709 C                     EXSR ZALIGN                                    E12711
0709 C                     END                                            E12711
0707 C  N99                MOVE ZFIELD    RAT,1
0708 C  N99      RAT,1     COMP 0                      9999
     C                     ENDIF                                          CEU026
     C*                                                                   CEU026
     C*    IF CCY = 'OUT' AND BASE 'IN', RECALCULATE RATES IF CHANGES     CEU026
     C*    HAVE BEEN MADE (ASSUME RATES ENTERED OUT/EURO RATES)           CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           A6INCY    IFNE 'Y'                                       CEU026
     C           INCCY     ANDEQ'Y'                                       CEU026
     C           CCYS      ANDNEBKEURO                                    CEU026
     C*                                                                   CEU026
     C           A6INCY    OREQ 'Y'                                       CEU026
     C           BJRDNB    ANDLTA6TPSD                                    CEU026
     C           INCCY     ANDEQ'Y'                                       CEU026
     C*                                                                   CEU026
     C           *IN09     IFEQ *ON                                       CEU026
     C           RT7,1     ANDNERAT,1                                     CEU026
      *                                                                   CEU026
     C           *IN01     OREQ *ON                                       CEU026
     C           RT6,1     ANDNERAT,1                                     CEU026
      *                                                                   CEU026
     C           *IN09     OREQ *OFF                                      CEU026
     C           *IN01     ANDEQ*OFF                                      CEU026
     C           RTN,1     ANDNERAT,1                                     CEU026
      *                                                                   CEU026
     C           RAT,1     IFNE 0                                         CEU026
     C******************** Z-ADDSPOTRA    ZRATE1 138                CEU026152073
     C******************** MOVE MULDIV    ZMDI1   1                 CEU026152073
     C******************** Z-ADDRAT,1     ZRATE2 138                CEU026152073
     C******************** MOVE A6MDIN    ZMDI2   1                 CEU026152073
     C                     Z-ADDSPOTRA    ZRATE2 138                      152073
     C                     MOVE MULDIV    ZMDI2   1                       152073
     C                     Z-ADDRAT,1     ZRATE1 138                      152073
     C***  As rate entered is the OUT/EUR rate, use the OUT/EUR     152073152522
     C***  multiply/divide indicator                                152073152522
     C******************** MOVE A6MDIN    ZMDI1   1                 152073152522
     C                     MOVE A6INMD    ZMDI1   1                 152073152522
     C                     EXSR ZXRATE                                    CEU026
      *                                                                   152522
     C***  If rate is recripocal, call subroutine again with rates        152522
     C***  reversed (input rate = ZRATE2; fixed IN/EUR rate = ZRATE1)     152522
     C*                                                                   152522
     C           ZRATEX    IFLT 1                                         152522
     C                     Z-ADDSPOTRA    ZRATE1 138                      152522
     C                     Z-ADDRAT,1     ZRATE2 138                      152522
     C                     EXSR ZXRATE                                    152522
     C                     ENDIF                                          152522
     C*                                                                   152522
      ** Move new Forward Rate into Display Field for Validation.         CEU026
      *                                                                   CEU026
     C                     Z-ADDZRATEX    RAT,1                           CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0709 C*
     C           RTE,1     IFNE BLNK16                                    CEU026
0710 C*    IF RATE IS NUMERIC, CHECK WITHIN 10% OF SPOT RATE.
0711 C**N99*****           EXSR TABCHN                                    E12711
0712 C  N10N99             SETON                     99
0713 C**N99******RAT,1*****SUB  SPOT      WK12   128   23                 S01194
     C**N99******RAT,1*****SUB  A6SPRT    WK12   128   23          S01194 138010
     C  N99      RAT,1     SUB  A6SPRT    WK12   138   23                 138010
0714 C  N99 23             Z-SUBWK12      WK12
0715 C**N99******WK12******DIV  SPOT      DIFF   158                      S01194
     C  N99      WK12      DIV  A6SPRT    DIFF   158                      S01194
0716 C  N99      DIFF      COMP .1                   24
     C                     ENDIF                                          CEU026
0717 C*
0718 C*    IF NO ERRORS VALIDATE REST OF DATA
0719 C  N99N24N40          GOTO REST
0720 C*
0721 C*    MOVE ERROR CODES INTO ARRAY
0722 C   99      S         ADD  1         S          29
0723 C   99                MOVE '234'     ERCD,S
0724 C   24      S         ADD  1         S          28
0725 C   24                MOVE 'W10'     ERCD,S
0726 C*
0727 C*    SET ERROR INDICATOR.
0728 C           SET41     TAG
0729 C   24
0730 COR 99                SETON                     41
0731 C*
0732 C*    END VALIDATION IF TERMINAL ERROR
0733 C   29                GOTO ENDCHK
0734 C*
0735 C*    VALIDATE REST OF DATA
0736 C           REST      TAG                             ** REST TAG **
0737 C*
0738 C*    INCREMENT ARRAY INDEX AND CHECK WITHIN LIMIT
0739 C           N         ADD  1         N
     C           N         IFGT 25                                        CEU026
     C                     GOTO ENDCHK                                    CEU026
     C                     ENDIF                                          CEU026
0740 C***********N         COMP 25                   25                   CEU026
0741 C***25******          GOTO ENDCHK                                    CEU026
0742 C*
0743 C*    TEST FOR BLANK INPUT
0744 C           DYA,N     COMP BLNK16                   20
0745 C           RTE,N     COMP BLNK16                   21
0746 C*
0747 C*    EITHER BOTH OR NEITHER FIELD MUST BE PRESENT
0748 C   20N21
0749 CORN20 21             SETON                     29
0750 C*
0751 C*    EMBEDED BLANKS NOT ALLOWED
0752 C  N20N21 22          SETON                     29
      *                                                                   CEU026
      *    IF EMU FORWARD RATE SWITCHED ON AND CCY IS IN. RATES NOT       CEU026
      *    AMENDABLE. ALLOW BLANKS IN RATE FIELD.                         CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           *IN25     IFEQ '1'                                       CEU026
     C           *IN21     ANDEQ'1'                                       CEU026
     C                     SETOF                     29                   CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
0753 C*
0754 C*    MOVE ERROR CODE INTO ARRAY
0755 C   29      S         ADD  1         S
0756 C   29N20             MOVE '239'     ERCD,S
0757 C   29 20             MOVE '240'     ERCD,S
0758 C   29 22             MOVE '237'     ERCD,S
0759 C   29 21
0760 COR 29 22             EXSR SETN1
0761 C   29 20
0762 COR 29 22             EXSR SETN2
0763 C   29                GOTO ENDCHK
0764 C*
0765 C*    IF BLANK CHECK NEXT ELEMENTS
0766 C   20 21             SETON                     22
0767 C   22                GOTO REST
0768 C*
0769 C*    CHECK NTH DAY IS NUMERIC AND GREATER THAN
0770 C*    N-1 TH DAY
0771 C*********************Z-ADD3         ZADIG                           S01328
0771 C                     Z-ADD5         ZADIG                           S01328
0772 C                     Z-ADD0         ZADEC
0773 C                     MOVE BLNK16    ZFIELD
0774 C                     MOVE DYA,N     ZFIELD
0775 C                     EXSR ZALIGN
0776 C   99                SETON                     29
0777 C  N29                MOVE ZFIELD    DAY,N
0778 C           N         SUB  1         M       20
0779 C  N29      DAY,N     COMP DAY,M                  2929
0780 C*
0781 C*    IF ERROR SET BLINK INDICATOR
0782 C   29                EXSR SETN1
     C*                                                                   E26581
     C*    IF PERIOD ENTERED NOT IN ERROR SO FAR THEN CHECK THAT, WHEN    E26581
     C*    ADDED TO TODAY, IT DOES NOT EXCEED 99998.                      E26581
     C           *IN29     IFEQ '0'                                       E26581
     C***********          MOVE DYA,N     WDYA    50               E26581 065331
     C                     MOVE DAY,N     WDAY    50                      065331
     C***********BJRDNB    ADD  WDYA      WLIMIT  60               E26581 065331
     C           BJRDNB    ADD  WDAY      WLIMIT  60                      065331
     C           WLIMIT    IFGT 99998                                     E26581
     C                     SETON                     29                   E26581
     C                     EXSR SETN1                                     E26581
     C                     END                                            E26581
     C                     END                                            E26581
0783 C*
0784 C*    CHECK NTH RATE IS NUMERIC AND WITHIN 10% OF
0785 C*    N-1 TH RATE
     C*    IF EMU FORWARD RATE ON AND CCY IS 'IN' THEN RATE IS BLANK      CEU026
     C*    BYPASS THIS VALIDATION                                         CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           *IN25     ANDEQ'1'                                       CEU026
     C           RTE,N     ANDEQBLNK16                                    CEU026
     C                     GOTO REST                                      CEU026
     C                     ENDIF                                          CEU026
0786 C**********           Z-ADD4         ZADIG                           138010
0786 C                     Z-ADD5         ZADIG                           138010
0703 C*    SET UP DECIMAL PLACES FOR MAX ALLOWED FOR CURRENCY             E12711
0704 C           CDIFF     IFEQ 1                                         E12711
0705 C                     Z-ADD6         ZADEC                           E12711
0706 C                     ELSE                                           E12711
0707 C           CDIFF     IFEQ 2                                         E12711
0708 C                     Z-ADD7         ZADEC                           E12711
0709 C                     ELSE                                           E12711
0787 C                     Z-ADD8         ZADEC
0704 C                     END                                            E12711
0705 C                     END                                            E12711
0788 C                     MOVE BLNK16    ZFIELD
0789 C                     MOVE RTE,N     ZFIELD
0790 C                     EXSR ZALIGN
0703 C*    IF NUMERIC AND DEC PLACES HAS BEEN LIMITED, RE-RUN ZALIGN TO   E12711
0704 C*    ALIGN DECIMAL PLACES FOR OUTPUT FIELD ZFIELD                   E12711
0705 C  N99      ZADEC     IFLT 8                                         E12711
0706 C                     Z-ADD8         ZADEC                           E12711
0707 C                     MOVE BLNK16    ZFIELD                          E12711
0708 C                     MOVE RTE,N     ZFIELD                          E12711
0709 C                     EXSR ZALIGN                                    E12711
0709 C                     END                                            E12711
0791 C  N99                MOVE ZFIELD    RAT,N
0792 C  N99      RAT,N     COMP 0                      9999
     C*                                                                   CEU026
     C*    IF CCY = 'OUT' AND BASE 'IN', RECALCULATE RATES IF CHANGES     CEU026
     C*    HAVE BEEN MADE (ASSUME RATES ENTERED OUT/EURO RATES)           CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           A6INCY    IFNE 'Y'                                       CEU026
     C           INCCY     ANDEQ'Y'                                       CEU026
     C           CCYS      ANDNEBKEURO                                    CEU026
     C*                                                                   CEU026
     C           A6INCY    OREQ 'Y'                                       CEU026
     C           BJRDNB    ANDLTA6TPSD                                    CEU026
     C           INCCY     ANDEQ'Y'                                       CEU026
     C*                                                                   CEU026
     C           *IN09     IFEQ *ON                                       CEU026
     C           RT7,N     ANDNERAT,N                                     CEU026
      *                                                                   CEU026
     C           *IN01     OREQ *ON                                       CEU026
     C           RT6,N     ANDNERAT,N                                     CEU026
      *                                                                   CEU026
     C           *IN09     OREQ *OFF                                      CEU026
     C           *IN01     ANDEQ*OFF                                      CEU026
     C           RTN,N     ANDNERAT,N                                     CEU026
     C           RAT,N     IFNE 0                                         CEU026
     C******************** Z-ADDSPOTRA    ZRATE1 138                CEU026152073
     C******************** MOVE MULDIV    ZMDI1   1                 CEU026152073
     C******************** Z-ADDRAT,N     ZRATE2 138                CEU026152073
     C******************** MOVE A6MDIN    ZMDI2   1                 CEU026152073
     C                     Z-ADDSPOTRA    ZRATE2 138                      152073
     C                     MOVE MULDIV    ZMDI2   1                       152073
     C                     Z-ADDRAT,N     ZRATE1 138                      152073
     C***  As rate entered is the OUT/EUR rate, use the OUT/EUR     152073152522
     C***  multiply/divide indicator                                152073152522
     C******************** MOVE A6MDIN    ZMDI1   1                 152073152522
     C                     MOVE A6INMD    ZMDI1   1                 152073152522
     C                     EXSR ZXRATE                                    CEU026
      *                                                                   152522
     C***  If rate is recripocal, call subroutine again with rates        152522
     C***  reversed (input rate = ZRATE2; fixed IN/EUR rate = ZRATE1)     152522
     C*                                                                   152522
     C           ZRATEX    IFLT 1                                         152522
     C                     Z-ADDSPOTRA    ZRATE1 138                      152522
     C                     Z-ADDRAT,N     ZRATE2 138                      152522
     C                     EXSR ZXRATE                                    152522
     C                     ENDIF                                          152522
     C*                                                                   152522
      ** Move new Forward Rate into Display Field for Validation.         CEU026
      *                                                                   CEU026
     C                     Z-ADDZRATEX    RAT,N                           CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0793 C  N99      RAT,N     SUB  RAT,M     WK12         23
0794 C  N99 23             Z-SUBWK12      WK12
0795 C  N99      WK12      DIV  RAT,M     DIFF
0796 C  N99      DIFF      COMP .1                   24
0797 C   24                SETON                     28
0798 C*
0799 C*    IF NO ERRORS VALIDATE REST OF DATA
0800 C  N99N24N29          GOTO REST
0801 C   99                SETON                     29
0802 C*
0803 C*    OTHERWISE SET BLINK INDICATOR
0804 C   99
0805 COR 24                EXSR SETN2
0806 C*
0807 C*    IF WARNING ERROR VALIDATE REST OF DATA
0808 C   28N29             GOTO REST
0809 C*
0810 C           ENDCHK    ENDSR                           ** ENDCHK TAG *
0811 C********************************************************************
0812 C*    SR TO SET ERROR INDICATOR FOR INVALID NUMBER OF DAYS
0813 C           SETN1     BEGSR                           *** SETN1 ***
0814 C*
0815 C  N42      N         COMP 2                        42
0816 C  N44      N         COMP 3                        44
0817 C  N46      N         COMP 4                        46
0818 C  N48      N         COMP 5                        48
0819 C  N50      N         COMP 6                        50
0820 C  N52      N         COMP 7                        52
0821 C  N54      N         COMP 8                        54
0822 C  N56      N         COMP 9                        56
0823 C  N58      N         COMP 10                       58
0824 C  N60      N         COMP 11                       60
0825 C  N62      N         COMP 12                       62
0826 C  N64      N         COMP 13                       64
0827 C  N66      N         COMP 14                       66
0828 C  N68      N         COMP 15                       68
0829 C  N70      N         COMP 16                       70
0830 C  N72      N         COMP 17                       72
0831 C  N74      N         COMP 18                       74
0832 C  N76      N         COMP 19                       76
0833 C  N78      N         COMP 20                       78
0834 C  N80      N         COMP 21                       80
0835 C  N82      N         COMP 22                       82
0836 C  N84      N         COMP 23                       84
0837 C  N86      N         COMP 24                       86
0838 C  N88      N         COMP 25                       88
0839 C*
0840 C*    MOVE ERROR CODE INTO ARRAY
0841 C  N20N21N22S         ADD  1         S
0842 C  N20N21N22          MOVE '238'     ERCD,S
0843 C*
0844 C                     ENDSR
0845 C********************************************************************
0846 C*    SR TO SET INDICATOR FOR INVALID RATE
0847 C           SETN2     BEGSR                           *** SETN2 ***
0848 C*
0849 C  N43      N         COMP 2                        43
0850 C  N45      N         COMP 3                        45
0851 C  N47      N         COMP 4                        47
0852 C  N49      N         COMP 5                        49
0853 C  N51      N         COMP 6                        51
0854 C  N53      N         COMP 7                        53
0855 C  N55      N         COMP 8                        55
0856 C  N57      N         COMP 9                        57
0857 C  N59      N         COMP 10                       59
0858 C  N61      N         COMP 11                       61
0859 C  N63      N         COMP 12                       63
0860 C  N65      N         COMP 13                       65
0861 C  N67      N         COMP 14                       67
0862 C  N69      N         COMP 15                       69
0863 C  N71      N         COMP 16                       71
0864 C  N73      N         COMP 17                       73
0865 C  N75      N         COMP 18                       75
0866 C  N77      N         COMP 19                       77
0867 C  N79      N         COMP 20                       79
0868 C  N81      N         COMP 21                       81
0869 C  N83      N         COMP 22                       83
0870 C  N85      N         COMP 23                       85
0871 C  N87      N         COMP 24                       87
0872 C  N89      N         COMP 25                       89
0873 C*
0874 C*    ONLY ONE W11 ERROR CODE IS OUTPUT
0875 C   20
0876 COR 21
0877 COR 22
0878 C*RN29****************GOTO ENDS2                                     E10181
0878 CORN29 39             GOTO ENDS2                                     E10181
0879 C*
0880 C*    MOVE ERROR CODE INTO ARRAY
0881 C           S         ADD  1         S
0882 C*********************MOVE '234'     ERCD,S                          E10181
0882 C   29                MOVE '234'     ERCD,S                          E10181
0883 C   28N29             MOVE 'W11'     ERCD,S
     C   28N29             SETON                     39                   E10181
0885 C*
0886 C           ENDS2     ENDSR
0887 C********************************************************************
0888 C*    SR TO SET INDICATORS FOR INITIAL SCREEN OUTPUT
0889 C           SFOUT     BEGSR                           *** SFOUT ***
0890 C*
0891 C                     SETOF                     131435
0892 C                     SETOF                     3637
0893 C                     SETON                     303134
0894 C*
0895 C                     MOVE 'SF'      SCRN
0896 C                     ENDSR
0897 C*
0898 C********************************************************************
0899 C*    SR TO SET INDICATORS FOR INSERT SCREEN OUTPUT
0900 C           SIOUT     BEGSR                           *** SIOUT ***
0901 C*
0902 C                     SETOF                     131430
0903 C                     SETOF                     313436
0904 C                     SETOF                     37
0905 C                     SETON                     35
0906 C*
0907 C                     MOVE 'SI'      SCRN
0908 C                     ENDSR
0909 C*
0910 C********************************************************************
0911 C*    SR TO SET INDICATORS FOR AMEND SCREEN OUTPUT
0912 C           SAOUT     BEGSR                           *** SAOUT ***
0913 C*
0914 C                     SETOF                     143031
0915 C                     SETOF                     343637
0916 C                     SETON                     1335
0917 C*
0918 C                     MOVE 'SA'      SCRN
0919 C                     ENDSR
0920 C*
0921 C********************************************************************
0922 C*    SR TO SET INDICATORS FOR DELETE SCREEN OUTPUT
0923 C           SDOUT     BEGSR                           *** SDOUT ***
0924 C*
0925 C                     SETOF                     143034
0926 C                     SETOF                     3637
0927 C                     SETON                     133135
0928 C*
0929 C                     MOVE 'SD'      SCRN
0930 C                     ENDSR
0931 C*
0932 C********************************************************************
0933 C*    SR TO SET INDICATORS FOR ENQUIRY SCREEN OUTPUT
0934 C           SEOUT     BEGSR                           *** SEOUT ***
0935 C*
0936 C                     SETOF                     143035
0937 C                     SETOF                     3637
0938 C                     SETON                     133134
0939 C*
0940 C                     MOVE 'SF'      SCRN
0941 C                     ENDSR
0942 C*
      **  Subroutine to Calculate Exchange Rates                          CEU026
      /COPY ZSRSRC,ZXRATEZ1                                               CEU026
     C********************************************************************
     C**   FILE EXCEPTION / ERROR HANDLING SUBROUTINE
     C           INFSR     BEGSR
     C**   CHECK ERROR TYPE
     C           STATUS    IFEQ 01021
     C**   CHAIN FILE TO GET CURRENT DETAILS
     C           FRTKEY    CHAINFWDRT                26
     C**
     C           *IN26     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED BY ANOTHER WORKSTATION' INDICATOR
     C                     SETON                     29
     C**   RESET OTHER INDICATORS
     C                     SETOF                     444647
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ENDSREXTTAG
 671 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     SETON                     U7U8LR               S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0597 C*****************************************************************   S01194
0943 ODL0090FMD        38NLR
0944 O                                   K8 'DL0090F1'
     O                         *IN30      1
     O                         *IN40      2
     O                         *IN31      3
     O                         *IN41      4
     O                         *IN25      5                               CEU026
     O**************************IN42      5                               CEU026
     O**************************IN43      6                               CEU026
     O**************************IN44      7                               CEU026
     O**************************IN45      8                               CEU026
     O**************************IN46      9                               CEU026
     O**************************IN47     10                               CEU026
     O**************************IN48     11                               CEU026
     O**************************IN49     12                               CEU026
     O**************************IN50     13                               CEU026
     O**************************IN51     14                               CEU026
     O**************************IN52     15                               CEU026
     O**************************IN53     16                               CEU026
     O**************************IN54     17                               CEU026
     O**************************IN55     18                               CEU026
     O**************************IN56     19                               CEU026
     O**************************IN57     20                               CEU026
     O**************************IN58     21                               CEU026
     O**************************IN59     22                               CEU026
     O**************************IN60     23                               CEU026
     O**************************IN61     24                               CEU026
     O**************************IN62     25                               CEU026
     O**************************IN63     26                               CEU026
     O**************************IN64     27                               CEU026
     O**************************IN65     28                               CEU026
     O**************************IN66     29                               CEU026
     O**************************IN67     30                               CEU026
     O**************************IN68     31                               CEU026
     O**************************IN69     32                               CEU026
     O**************************IN70     33                               CEU026
     O**************************IN71     34                               CEU026
     O**************************IN72     35                               CEU026
     O**************************IN73     36                               CEU026
     O**************************IN74     37                               CEU026
     O**************************IN75     38                               CEU026
     O**************************IN76     39                               CEU026
     O**************************IN77     40                               CEU026
     O**************************IN78     41                               CEU026
     O**************************IN79     42                               CEU026
     O**************************IN80     43                               CEU026
     O**************************IN81     44                               CEU026
     O**************************IN82     45                               CEU026
     O**************************IN83     46                               CEU026
     O**************************IN84     47                               CEU026
     O**************************IN85     48                               CEU026
     O**************************IN86     49                               CEU026
     O**************************IN87     50                               CEU026
     O**************************IN88     51                               CEU026
     O**************************IN89     52                               CEU026
     O**************************IN32     53                               CEU026
     O**************************IN33     54                               CEU026
     O**************************IN35     55                               CEU026
     O**************************IN36     56                               CEU026
     O**************************IN34     57                               CEU026
     O**************************IN37     58                               CEU026
0945 O*************************SCRN      60                               CEU026
0946 O*************************MTIME     68 '  .  .  '                    CEU026
0947 O*************************WSID      71                               CEU026
0948 O*************************ACTNX     72                               CEU026
0949 O*************************CCYS      75                               CEU026
0950 O*****************13******DATA1    275                               CEU026
0951 O*****************13******DATA2    475                               CEU026
0951 O*****************13******DATA3    550                         089129CEU026
     O                         *IN42      6                               CEU026
     O                         *IN43      7                               CEU026
     O                         *IN44      8                               CEU026
     O                         *IN45      9                               CEU026
     O                         *IN46     10                               CEU026
     O                         *IN47     11                               CEU026
     O                         *IN48     12                               CEU026
     O                         *IN49     13                               CEU026
     O                         *IN50     14                               CEU026
     O                         *IN51     15                               CEU026
     O                         *IN52     16                               CEU026
     O                         *IN53     17                               CEU026
     O                         *IN54     18                               CEU026
     O                         *IN55     19                               CEU026
     O                         *IN56     20                               CEU026
     O                         *IN57     21                               CEU026
     O                         *IN58     22                               CEU026
     O                         *IN59     23                               CEU026
     O                         *IN60     24                               CEU026
     O                         *IN61     25                               CEU026
     O                         *IN62     26                               CEU026
     O                         *IN63     27                               CEU026
     O                         *IN64     28                               CEU026
     O                         *IN65     29                               CEU026
     O                         *IN66     30                               CEU026
     O                         *IN67     31                               CEU026
     O                         *IN68     32                               CEU026
     O                         *IN69     33                               CEU026
     O                         *IN70     34                               CEU026
     O                         *IN71     35                               CEU026
     O                         *IN72     36                               CEU026
     O                         *IN73     37                               CEU026
     O                         *IN74     38                               CEU026
     O                         *IN75     39                               CEU026
     O                         *IN76     40                               CEU026
     O                         *IN77     41                               CEU026
     O                         *IN78     42                               CEU026
     O                         *IN79     43                               CEU026
     O                         *IN80     44                               CEU026
     O                         *IN81     45                               CEU026
     O                         *IN82     46                               CEU026
     O                         *IN83     47                               CEU026
     O                         *IN84     48                               CEU026
     O                         *IN85     49                               CEU026
     O                         *IN86     50                               CEU026
     O                         *IN87     51                               CEU026
     O                         *IN88     52                               CEU026
     O                         *IN89     53                               CEU026
     O                         *IN32     54                               CEU026
     O                         *IN33     55                               CEU026
     O                         *IN35     56                               CEU026
     O                         *IN36     57                               CEU026
     O                         *IN34     58                               CEU026
     O                         *IN37     59                               CEU026
0945 O                         SCRN      61                               CEU026
0946 O                         MTIME     69 '  .  .  '                    CEU026
0947 O                         WSID      72                               CEU026
0948 O                         ACTNX     73                               CEU026
0949 O                         CCYS      76                               CEU026
0950 O                 13      DATA1    276                               CEU026
0951 O                 13      DATA2    476                               CEU026
0951 O                 13      DATA3    551                               089129
0951 O*****************13      DATA3    525                        S01328 089129
0952 O*****************13    06DYS,1 4   78                               S01328
0953 O*****************13    06RTN,1 4   91                               E19847
0953 O*****************13N01N09RTN,1 4   91                        E19847 S01328
0953 O*****************13N01 09RT7,1 4   91                        E19847 S01328
0953 O*****************13 01N09RT6,1 4   91                        E19847 S01328
     O*****************13N32   RTE,1     91                        BHF323 S01328
0954 O*****************13    06DYS,2 4   94                               S01328
0955 O*****************13    06RTN,2 4  107                               E19847
0955 O*****************13N01N09RTN,2 4  107                        E19847 S01328
0955 O*****************13N01 09RT7,2 4  107                        E19847 S01328
0955 O*****************13 01N09RT6,2 4  107                        E19847 S01328
     O*****************13N32   RTE,2    107                        BHF323 S01328
0956 O*****************13    06DYS,3 4  110                               S01328
0957 O*****************13    06RTN,3 4  123                               E19847
0957 O*****************13N01N09RTN,3 4  123                        E19847 S01328
0957 O*****************13N01 09RT7,3 4  123                        E19847 S01328
0957 O*****************13 01N09RT6,3 4  123                        E19847 S01328
     O*****************13N32   RTE,3    123                        BHF323 S01328
0958 O*****************13    06DYS,4 4  126                               S01328
0959 O*****************13    06RTN,4 4  139                               E19847
0959 O*****************13N01N09RTN,4 4  139                        E19847 S01328
0959 O*****************13N01 09RT7,4 4  139                        E19847 S01328
0959 O*****************13 01N09RT6,4 4  139                        E19847 S01328
     O*****************13N32   RTE,4    139                        BHF323 S01328
0960 O*****************13    06DYS,5 4  142                               S01328
0961 O*****************13    06RTN,5 4  155                               E19847
0961 O*****************13N01N09RTN,5 4  155                        E19847 S01328
0961 O*****************13N01 09RT7,5 4  155                        E19847 S01328
0961 O*****************13 01N09RT6,5 4  155                        E19847 S01328
     O*****************13N32   RTE,5    155                        BHF323 S01328
0962 O*****************13    06DYS,6 4  158                               S01328
0963 O*****************13    06RTN,6 4  171                               E19847
0963 O*****************13N01N09RTN,6 4  171                               E19847
0963 O*****************13N01 09RT7,6 4  171                        E19847 S01328
0963 O*****************13 01N09RT6,6 4  171                        E19847 S01328
     O*****************13N32   RTE,6    171                        BHF323 S01328
0964 O*****************13    06DYS,7 4  174                               S01328
0965 O*****************13    06RTN,7 4  187                               E19847
0965 O*****************13N01N09RTN,7 4  187                        E19847 S01328
0965 O*****************13N01 09RT7,7 4  187                        E19847 S01328
0965 O*****************13 01N09RT6,7 4  187                        E19847 S01328
     O*****************13N32   RTE,7    187                        BHF323 S01328
0966 O*****************13    06DYS,8 4  190                               S01328
0967 O*****************13    06RTN,8 4  203                               E19847
0965 O*****************13N01N09RTN,8 4  203                        E19847 S01328
0965 O*****************13N01 09RT7,8 4  203                        E19847 S01328
0965 O*****************13 01N09RT6,8 4  203                        E19847 S01328
     O*****************13N32   RTE,8    203                        BHF323 S01328
0968 O*****************13    06DYS,9 4  206                               S01328
0969 O*****************13    06RTN,9 4  219                               E19847
0965 O*****************13N01N09RTN,9 4  219                        E19847 S01328
0965 O*****************13N01 09RT7,9 4  219                        E19847 S01328
0965 O*****************13 01N09RT6,9 4  219                        E19847 S01328
     O*****************13N32   RTE,9    219                        BHF323 S01328
0970 O*****************13    06DYS,104  222                               S01328
0971 O*****************13    06RTN,104  235                               E19847
0965 O*****************13N01N09RTN,104  235                        E19847 S01328
0965 O*****************13N01 09RT7,104  235                        E19847 S01328
0965 O*****************13 01N09RT6,104  235                        E19847 S01328
     O*****************13N32   RTE,10   235                        BHF323 S01328
0972 O*****************13    06DYS,114  238                               S01328
0973 O*****************13    06RTN,114  251                               E19847
0965 O*****************13N01N09RTN,114  251                        E19847 S01328
0965 O*****************13N01 09RT7,114  251                        E19847 S01328
0965 O*****************13 01N09RT6,114  251                        E19847 S01328
     O*****************13N32   RTE,11   251                        BHF323 S01328
0974 O*****************13    06DYS,124  254                               S01328
0975 O*****************13    06RTN,124  267                               E19847
0965 O*****************13N01N09RTN,124  267                        E19847 S01328
0965 O*****************13N01 09RT7,124  267                        E19847 S01328
0965 O*****************13 01N09RT6,124  267                        E19847 S01328
     O*****************13N32   RTE,12   267                        BHF323 S01328
0976 O*****************13    06DYS,134  270                               S01328
0977 O*****************13    06RTN,134  283                               E19847
0965 O*****************13N01N09RTN,134  283                        E19847 S01328
0965 O*****************13N01 09RT7,134  283                        E19847 S01328
0965 O*****************13 01N09RT6,134  283                        E19847 S01328
     O*****************13N32   RTE,13   283                        BHF323 S01328
0978 O*****************13    06DYS,144  286                               S01328
0979 O*****************13    06RTN,144  299                               E19847
0965 O*****************13N01N09RTN,144  299                        E19847 S01328
0965 O*****************13N01 09RT7,144  299                        E19847 S01328
0965 O*****************13 01N09RT6,144  299                        E19847 S01328
     O*****************13N32   RTE,14   299                        BHF323 S01328
0980 O*****************13    06DYS,154  302                               S01328
0981 O*****************13    06RTN,154  315                               E19847
0965 O*****************13N01N09RTN,154  315                        E19847 S01328
0965 O*****************13N01 09RT7,154  315                        E19847 S01328
0965 O*****************13 01N09RT6,154  315                        E19847 S01328
     O*****************13N32   RTE,15   315                        BHF323 S01328
0982 O*****************13    06DYS,164  318                        E19847 S01328
0983 O*****************13    06RTN,164  331                               E19847
0965 O*****************13N01N09RTN,164  331                        E19847 S01328
0965 O*****************13N01 09RT7,164  331                        E19847 S01328
0965 O*****************13 01N09RT6,164  331                        E19847 S01328
     O*****************13N32   RTE,16   331                        BHF323 S01328
0984 O*****************13    06DYS,174  334                        E19847 S01328
0983 O*****************13    06RTN,164  331                               BHF323
0984 O*****************13    06DYS,174  334                               BHF323
0985 O*****************13    06RTN,174  347                               E19847
0965 O*****************13N01N09RTN,174  347                        E19847 S01328
0965 O*****************13N01 09RT7,174  347                        E19847 S01328
0965 O*****************13 01N09RT6,174  347                        E19847 S01328
     O*****************13N32   RTE,17   347                        BHF323 S01328
0986 O*****************13    06DYS,184  350                               S01328
0987 O*****************13    06RTN,184  363                               E19847
0965 O*****************13N01N09RTN,184  363                        E19847 S01328
0965 O*****************13N01 09RT7,184  363                        E19847 S01328
0965 O*****************13 01N09RT6,184  363                        E19847 S01328
     O*****************13N32   RTE,18   363                        BHF323 S01328
0988 O*****************13    06DYS,194  366                               S01328
0989 O*****************13    06RTN,194  379                               E19847
0965 O*****************13N01N09RTN,194  379                        E19847 S01328
0965 O*****************13N01 09RT7,194  379                        E19847 S01328
0965 O*****************13 01N09RT6,194  379                        E19847 S01328
     O*****************13N32   RTE,19   379                        BHF323 S01328
0990 O*****************13    06DYS,204  382                               S01328
0991 O*****************13    06RTN,204  395                               E19847
0965 O*****************13N01N09RTN,204  395                        E19847 S01328
0965 O*****************13N01 09RT7,204  395                        E19847 S01328
0965 O*****************13 01N09RT6,204  395                        E19847 S01328
     O*****************13N32   RTE,20   395                        BHF323 S01328
0992 O*****************13    06DYS,214  398                               S01328
0993 O*****************13    06RTN,214  411                               E19847
0965 O*****************13N01N09RTN,214  411                        E19847 S01328
0965 O*****************13N01 09RT7,214  411                        E19847 S01328
0965 O*****************13 01N09RT6,214  411                        E19847 S01328
     O*****************13N32   RTE,21   411                        BHF323 S01328
0994 O*****************13    06DYS,224  414                               S01328
0995 O*****************13    06RTN,224  427                               E19847
0965 O*****************13N01N09RTN,224  427                        E19847 S01328
0965 O*****************13N01 09RT7,224  427                        E19847 S01328
0965 O*****************13 01N09RT6,224  427                        E19847 S01328
     O*****************13N32   RTE,22   427                        BHF323 S01328
0996 O*****************13    06DYS,234  430                               S01328
0997 O*****************13    06RTN,234  443                               E19847
0965 O*****************13N01N09RTN,234  443                        E19847 S01328
0965 O*****************13N01 09RT7,234  443                        E19847 S01328
0965 O*****************13 01N09RT6,234  443                        E19847 S01328
     O*****************13N32   RTE,23   443                        BHF323 S01328
0998 O*****************13    06DYS,244  446                               S01328
0999 O*****************13    06RTN,244  459                               E19847
0965 O*****************13N01N09RTN,244  459                        E19847 S01328
0965 O*****************13N01 09RT7,244  459                        E19847 S01328
0965 O*****************13 01N09RT6,244  459                        E19847 S01328
     O*****************13N32   RTE,24   459                        BHF323 S01328
1000 O*****************13    06DYS,254  462                               S01328
1001 O*****************13    06RTN,254  475                               E19847
0965 O*****************13N01N09RTN,254  475                        E19847 S01328
0965 O*****************13N01 09RT7,254  475                        E19847 S01328
0965 O*****************13 01N09RT6,254  475                        E19847 S01328
     O*****************13N32   RTE,25   475                        BHF323 S01328
1002 O*****************        ERCD     551                        S01328 089129
1003 O*****************        EMES     606                        S01328 089129
1004 O*****************14      ACTN     628                        S01328 089129
1005 O*****************14      CCYX     631                        S01328 089129
0952 O*****************13    06DYS,1 4   80                        S01328 089129
0953 O*****************13N01N09RTN,1 4   93                        S01328 089129
0953 O*****************13N01 09RT7,1 4   93                        S01328 089129
0953 O*****************13 01N09RT6,1 4   93                        S01328 089129
     O*****************13N32   RTE,1     93                        S01328 089129
0954 O*****************13    06DYS,2 4   98                        S01328 089129
0955 O*****************13N01N09RTN,2 4  111                        S01328 089129
0955 O*****************13N01 09RT7,2 4  111                        S01328 089129
0955 O*****************13 01N09RT6,2 4  111                        S01328 089129
     O*****************13N32   RTE,2    111                        S01328 089129
0956 O*****************13    06DYS,3 4  116                        S01328 089129
0957 O*****************13N01N09RTN,3 4  129                        S01328 089129
0957 O*****************13N01 09RT7,3 4  129                        S01328 089129
0957 O*****************13 01N09RT6,3 4  129                        S01328 089129
     O*****************13N32   RTE,3    129                        S01328 089129
0958 O*****************13    06DYS,4 4  134                        S01328 089129
0959 O*****************13N01N09RTN,4 4  147                        S01328 089129
0959 O*****************13N01 09RT7,4 4  147                        S01328 089129
0959 O*****************13 01N09RT6,4 4  147                        S01328 089129
     O*****************13N32   RTE,4    147                        S01328 089129
0960 O*****************13    06DYS,5 4  152                        S01328 089129
0961 O*****************13N01N09RTN,5 4  165                        S01328 089129
0961 O*****************13N01 09RT7,5 4  165                        S01328 089129
0961 O*****************13 01N09RT6,5 4  165                        S01328 089129
     O*****************13N32   RTE,5    165                        S01328 089129
0962 O*****************13    06DYS,6 4  170                        S01328 089129
0963 O*****************13N01N09RTN,6 4  183                        S01328 089129
0963 O*****************13N01 09RT7,6 4  183                        S01328 089129
0963 O*****************13 01N09RT6,6 4  183                        S01328 089129
     O*****************13N32   RTE,6    183                        S01328 089129
0964 O*****************13    06DYS,7 4  188                        S01328 089129
0965 O*****************13N01N09RTN,7 4  201                        S01328 089129
0965 O*****************13N01 09RT7,7 4  201                        S01328 089129
0965 O*****************13 01N09RT6,7 4  201                        S01328 089129
     O*****************13N32   RTE,7    201                        S01328 089129
0966 O*****************13    06DYS,8 4  206                        S01328 089129
0965 O*****************13N01N09RTN,8 4  219                        S01328 089129
0965 O*****************13N01 09RT7,8 4  219                        S01328 089129
0965 O*****************13 01N09RT6,8 4  219                        S01328 089129
     O*****************13N32   RTE,8    219                        S01328 089129
0968 O*****************13    06DYS,9 4  224                        S01328 089129
0965 O*****************13N01N09RTN,9 4  237                        S01328 089129
0965 O*****************13N01 09RT7,9 4  237                        S01328 089129
0965 O*****************13 01N09RT6,9 4  237                        S01328 089129
     O*****************13N32   RTE,9    237                        S01328 089129
0970 O*****************13    06DYS,104  242                        S01328 089129
0965 O*****************13N01N09RTN,104  255                        S01328 089129
0965 O*****************13N01 09RT7,104  255                        S01328 089129
0965 O*****************13 01N09RT6,104  255                        S01328 089129
     O*****************13N32   RTE,10   255                        S01328 089129
0972 O*****************13    06DYS,114  260                        S01328 089129
0965 O*****************13N01N09RTN,114  273                        S01328 089129
0965 O*****************13N01 09RT7,114  273                        S01328 089129
0965 O*****************13 01N09RT6,114  273                        S01328 089129
     O*****************13N32   RTE,11   273                        S01328 089129
0974 O*****************13    06DYS,124  278                        S01328 089129
0965 O*****************13N01N09RTN,124  291                        S01328 089129
0965 O*****************13N01 09RT7,124  291                        S01328 089129
0965 O*****************13 01N09RT6,124  291                        S01328 089129
     O*****************13N32   RTE,12   291                        S01328 089129
0976 O*****************13    06DYS,134  296                        S01328 089129
0965 O*****************13N01N09RTN,134  309                        S01328 089129
0965 O*****************13N01 09RT7,134  309                        S01328 089129
0965 O*****************13 01N09RT6,134  309                        S01328 089129
     O*****************13N32   RTE,13   309                        S01328 089129
0978 O*****************13    06DYS,144  314                        S01328 089129
0965 O*****************13N01N09RTN,144  327                        S01328 089129
0965 O*****************13N01 09RT7,144  327                        S01328 089129
0965 O*****************13 01N09RT6,144  327                        S01328 089129
     O*****************13N32   RTE,14   327                        S01328 089129
0980 O*****************13    06DYS,154  332                        S01328 089129
0965 O*****************13N01N09RTN,154  345                        S01328 089129
0965 O*****************13N01 09RT7,154  345                        S01328 089129
0965 O*****************13 01N09RT6,154  345                        S01328 089129
     O*****************13N32   RTE,15   345                        S01328 089129
0982 O*****************13    06DYS,164  350                        S01328 089129
0965 O*****************13N01N09RTN,164  363                        S01328 089129
0965 O*****************13N01 09RT7,164  363                        S01328 089129
0965 O*****************13 01N09RT6,164  363                        S01328 089129
     O*****************13N32   RTE,16   363                        S01328 089129
0984 O*****************13    06DYS,174  368                        S01328 089129
0965 O*****************13N01N09RTN,174  381                        S01328 089129
0965 O*****************13N01 09RT7,174  381                        S01328 089129
0965 O*****************13 01N09RT6,174  381                        S01328 089129
     O*****************13N32   RTE,17   381                        S01328 089129
0986 O*****************13    06DYS,184  386                        S01328 089129
0965 O*****************13N01N09RTN,184  399                        S01328 089129
0965 O*****************13N01 09RT7,184  399                        S01328 089129
0965 O*****************13 01N09RT6,184  399                        S01328 089129
     O*****************13N32   RTE,18   399                        S01328 089129
0988 O*****************13    06DYS,194  404                        S01328 089129
0965 O*****************13N01N09RTN,194  417                        S01328 089129
0965 O*****************13N01 09RT7,194  417                        S01328 089129
0965 O*****************13 01N09RT6,194  417                        S01328 089129
     O*****************13N32   RTE,19   417                        S01328 089129
0990 O*****************13    06DYS,204  422                        S01328 089129
0965 O*****************13N01N09RTN,204  435                        S01328 089129
0965 O*****************13N01 09RT7,204  435                        S01328 089129
0965 O*****************13 01N09RT6,204  435                        S01328 089129
     O*****************13N32   RTE,20   435                        S01328 089129
0992 O*****************13    06DYS,214  440                        S01328 089129
0965 O*****************13N01N09RTN,214  453                        S01328 089129
0965 O*****************13N01 09RT7,214  453                        S01328 089129
0965 O*****************13 01N09RT6,214  453                        S01328 089129
     O*****************13N32   RTE,21   453                        S01328 089129
0994 O*****************13    06DYS,224  458                        S01328 089129
0965 O*****************13N01N09RTN,224  471                        S01328 089129
0965 O*****************13N01 09RT7,224  471                        S01328 089129
0965 O*****************13 01N09RT6,224  471                        S01328 089129
     O*****************13N32   RTE,22   471                        S01328 089129
0996 O*****************13    06DYS,234  476                        S01328 089129
0965 O*****************13N01N09RTN,234  489                        S01328 089129
0965 O*****************13N01 09RT7,234  489                        S01328 089129
0965 O*****************13 01N09RT6,234  489                        S01328 089129
     O*****************13N32   RTE,23   489                        S01328 089129
0998 O*****************13    06DYS,244  494                        S01328 089129
0965 O*****************13N01N09RTN,244  507                        S01328 089129
0965 O*****************13N01 09RT7,244  507                        S01328 089129
0965 O*****************13 01N09RT6,244  507                        S01328 089129
     O*****************13N32   RTE,24   507                        S01328 089129
1000 O*****************13    06DYS,254  512                        S01328 089129
0965 O*****************13N01N09RTN,254  525                        S01328 089129
0965 O*****************13N01 09RT7,254  525                        S01328 089129
0965 O*****************13 01N09RT6,254  525                        S01328 089129
     O*****************13N32   RTE,25   525                        S01328 089129
1002 O*****************        ERCD     601                        S01328 089129
1003 O*****************        EMES     656                        S01328 089129
1004 O*****************14      ACTN     678                        S01328 089128
1005 O*****************14      CCYX     681                        S01328 089129
0952 O*****************13    06DYS,1 4   80                        089129 CEU026
0953 O*****************13N01N09RTN,1 4   94                        089129 CEU026
0953 O*****************13N01 09RT7,1 4   94                        089129 CEU026
0953 O*****************13 01N09RT6,1 4   94                        089129 CEU026
     O*****************13N32   RTE,1     94                        089129 CEU026
0954 O*****************13    06DYS,2 4   99                        089129 CEU026
0955 O*****************13N01N09RTN,2 4  113                        089129 CEU026
0955 O*****************13N01 09RT7,2 4  113                        089129 CEU026
0955 O*****************13 01N09RT6,2 4  113                        089129 CEU026
     O*****************13N32   RTE,2    113                        089129 CEU026
0956 O*****************13    06DYS,3 4  118                        089129 CEU026
0957 O*****************13N01N09RTN,3 4  132                        089129 CEU026
0957 O*****************13N01 09RT7,3 4  132                        089129 CEU026
0957 O*****************13 01N09RT6,3 4  132                        089129 CEU026
     O*****************13N32   RTE,3    132                        089129 CEU026
0958 O*****************13    06DYS,4 4  137                        089129 CEU026
0959 O*****************13N01N09RTN,4 4  151                        089129 CEU026
0959 O*****************13N01 09RT7,4 4  151                        089129 CEU026
0959 O*****************13 01N09RT6,4 4  151                        089129 CEU026
     O*****************13N32   RTE,4    151                        089129 CEU026
0960 O*****************13    06DYS,5 4  156                        089129 CEU026
0961 O*****************13N01N09RTN,5 4  170                        089129 CEU026
0961 O*****************13N01 09RT7,5 4  170                        089129 CEU026
0961 O*****************13 01N09RT6,5 4  170                        089129 CEU026
     O*****************13N32   RTE,5    170                        089129 CEU026
0962 O*****************13    06DYS,6 4  175                        089129 CEU026
0963 O*****************13N01N09RTN,6 4  189                        089129 CEU026
0963 O*****************13N01 09RT7,6 4  189                        089129 CEU026
0963 O*****************13 01N09RT6,6 4  189                        089129 CEU026
     O*****************13N32   RTE,6    189                        089129 CEU026
0964 O*****************13    06DYS,7 4  194                        089129 CEU026
0965 O*****************13N01N09RTN,7 4  208                        089129 CEU026
0965 O*****************13N01 09RT7,7 4  208                        089129 CEU026
0965 O*****************13 01N09RT6,7 4  208                        089129 CEU026
     O*****************13N32   RTE,7    208                        089129 CEU026
0966 O*****************13    06DYS,8 4  213                        089129 CEU026
0965 O*****************13N01N09RTN,8 4  227                        089129 CEU026
0965 O*****************13N01 09RT7,8 4  227                        089129 CEU026
0965 O*****************13 01N09RT6,8 4  227                        089129 CEU026
     O*****************13N32   RTE,8    227                        089129 CEU026
0968 O*****************13    06DYS,9 4  232                        089129 CEU026
0965 O*****************13N01N09RTN,9 4  246                        089129 CEU026
0965 O*****************13N01 09RT7,9 4  246                        089129 CEU026
0965 O*****************13 01N09RT6,9 4  246                        089129 CEU026
     O*****************13N32   RTE,9    246                        089129 CEU026
0970 O*****************13    06DYS,104  251                        089129 CEU026
0965 O*****************13N01N09RTN,104  265                        089129 CEU026
0965 O*****************13N01 09RT7,104  265                        089129 CEU026
0965 O*****************13 01N09RT6,104  265                        089129 CEU026
     O*****************13N32   RTE,10   265                        089129 CEU026
0972 O*****************13    06DYS,114  270                        089129 CEU026
0965 O*****************13N01N09RTN,114  284                        089129 CEU026
0965 O*****************13N01 09RT7,114  284                        089129 CEU026
0965 O*****************13 01N09RT6,114  284                        089129 CEU026
     O*****************13N32   RTE,11   284                        089129 CEU026
0974 O*****************13    06DYS,124  289                        089129 CEU026
0965 O*****************13N01N09RTN,124  303                        089129 CEU026
0965 O*****************13N01 09RT7,124  303                        089129 CEU026
0965 O*****************13 01N09RT6,124  303                        089129 CEU026
     O*****************13N32   RTE,12   303                        089129 CEU026
0976 O*****************13    06DYS,134  308                        089129 CEU026
0965 O*****************13N01N09RTN,134  322                        089129 CEU026
0965 O*****************13N01 09RT7,134  322                        089129 CEU026
0965 O*****************13 01N09RT6,134  322                        089129 CEU026
     O*****************13N32   RTE,13   322                        089129 CEU026
0978 O*****************13    06DYS,144  327                        089129 CEU026
0965 O*****************13N01N09RTN,144  341                        089129 CEU026
0965 O*****************13N01 09RT7,144  341                        089129 CEU026
0965 O*****************13 01N09RT6,144  341                        089129 CEU026
     O*****************13N32   RTE,14   341                        089129 CEU026
0980 O*****************13    06DYS,154  346                        089129 CEU026
0965 O*****************13N01N09RTN,154  360                        089129 CEU026
0965 O*****************13N01 09RT7,154  360                        089129 CEU026
0965 O*****************13 01N09RT6,154  360                        089129 CEU026
     O*****************13N32   RTE,15   360                        089129 CEU026
0982 O*****************13    06DYS,164  365                        089129 CEU026
0965 O*****************13N01N09RTN,164  379                        089129 CEU026
0965 O*****************13N01 09RT7,164  379                        089129 CEU026
0965 O*****************13 01N09RT6,164  379                        089129 CEU026
     O*****************13N32   RTE,16   379                        089129 CEU026
0984 O*****************13    06DYS,174  384                        089129 CEU026
0965 O*****************13N01N09RTN,174  398                        089129 CEU026
0965 O*****************13N01 09RT7,174  398                        089129 CEU026
0965 O*****************13 01N09RT6,174  398                        089129 CEU026
     O*****************13N32   RTE,17   398                        089129 CEU026
0986 O*****************13    06DYS,184  403                        089129 CEU026
0965 O*****************13N01N09RTN,184  417                        089129 CEU026
0965 O*****************13N01 09RT7,184  417                        089129 CEU026
0965 O*****************13 01N09RT6,184  417                        089129 CEU026
     O*****************13N32   RTE,18   417                        089129 CEU026
0988 O*****************13    06DYS,194  422                        089129 CEU026
0965 O*****************13N01N09RTN,194  436                        089129 CEU026
0965 O*****************13N01 09RT7,194  436                        089129 CEU026
0965 O*****************13 01N09RT6,194  436                        089129 CEU026
     O*****************13N32   RTE,19   436                        089129 CEU026
0990 O*****************13    06DYS,204  441                        089129 CEU026
0965 O*****************13N01N09RTN,204  455                        089129 CEU026
0965 O*****************13N01 09RT7,204  455                        089129 CEU026
0965 O*****************13 01N09RT6,204  455                        089129 CEU026
     O*****************13N32   RTE,20   455                        089129 CEU026
0992 O*****************13    06DYS,214  460                        089129 CEU026
0965 O*****************13N01N09RTN,214  474                        089129 CEU026
0965 O*****************13N01 09RT7,214  474                        089129 CEU026
0965 O*****************13 01N09RT6,214  474                        089129 CEU026
     O*****************13N32   RTE,21   474                        089129 CEU026
0994 O*****************13    06DYS,224  479                        089129 CEU026
0965 O*****************13N01N09RTN,224  493                        089129 CEU026
0965 O*****************13N01 09RT7,224  493                        089129 CEU026
0965 O*****************13 01N09RT6,224  493                        089129 CEU026
     O*****************13N32   RTE,22   493                        089129 CEU026
0996 O*****************13    06DYS,234  498                        089129 CEU026
0965 O*****************13N01N09RTN,234  512                        089129 CEU026
0965 O*****************13N01 09RT7,234  512                        089129 CEU026
0965 O*****************13 01N09RT6,234  512                        089129 CEU026
     O*****************13N32   RTE,23   512                        089129 CEU026
0998 O*****************13    06DYS,244  517                        089129 CEU026
0965 O*****************13N01N09RTN,244  531                        089129 CEU026
0965 O*****************13N01 09RT7,244  531                        089129 CEU026
0965 O*****************13 01N09RT6,244  531                        089129 CEU026
     O*****************13N32   RTE,24   531                        089129 CEU026
1000 O*****************13    06DYS,254  536                        089129 CEU026
0965 O*****************13N01N09RTN,254  550                        089129 CEU026
0965 O*****************13N01 09RT7,254  550                        089129 CEU026
0965 O*****************13 01N09RT6,254  550                        089129 CEU026
     O*****************13N32   RTE,25   550                        089129 CEU026
1002 O*****************        ERCD     626                        S01328 CEU026
1003 O*****************        EMES     681                        S01328 CEU026
1004 O*****************14      ACTN     703                        S01328 CEU026
1005 O*****************14      CCYX     706                        S01328 CEU026
0952 O                 13    06DYS,1 4   81                               CEU026
0953 O                 13N01N09RTN,1 4   95                               CEU026
0953 O                 13N01 09RT7,1 4   95                               CEU026
0953 O                 13 01N09RT6,1 4   95                               CEU026
     O                 13N32   RTE,1     95                               CEU026
0954 O                 13    06DYS,2 4  100                               CEU026
0955 O                 13N01N09RTN,2 4  114                               CEU026
0955 O                 13N01 09RT7,2 4  114                               CEU026
0955 O                 13 01N09RT6,2 4  114                               CEU026
     O                 13N32   RTE,2    114                               CEU026
0956 O                 13    06DYS,3 4  119                               CEU026
0957 O                 13N01N09RTN,3 4  133                               CEU026
0957 O                 13N01 09RT7,3 4  133                               CEU026
0957 O                 13 01N09RT6,3 4  133                               CEU026
     O                 13N32   RTE,3    133                               CEU026
0958 O                 13    06DYS,4 4  138                               CEU026
0959 O                 13N01N09RTN,4 4  152                               CEU026
0959 O                 13N01 09RT7,4 4  152                               CEU026
0959 O                 13 01N09RT6,4 4  152                               CEU026
     O                 13N32   RTE,4    152                               CEU026
0960 O                 13    06DYS,5 4  157                               CEU026
0961 O                 13N01N09RTN,5 4  171                               CEU026
0961 O                 13N01 09RT7,5 4  171                               CEU026
0961 O                 13 01N09RT6,5 4  171                               CEU026
     O                 13N32   RTE,5    171                               CEU026
0962 O                 13    06DYS,6 4  176                               CEU026
0963 O                 13N01N09RTN,6 4  190                               CEU026
0963 O                 13N01 09RT7,6 4  190                               CEU026
0963 O                 13 01N09RT6,6 4  190                               CEU026
     O                 13N32   RTE,6    190                               CEU026
0964 O                 13    06DYS,7 4  195                               CEU026
0965 O                 13N01N09RTN,7 4  209                               CEU026
0965 O                 13N01 09RT7,7 4  209                               CEU026
0965 O                 13 01N09RT6,7 4  209                               CEU026
     O                 13N32   RTE,7    209                               CEU026
0966 O                 13    06DYS,8 4  214                               CEU026
0965 O                 13N01N09RTN,8 4  228                               CEU026
0965 O                 13N01 09RT7,8 4  228                               CEU026
0965 O                 13 01N09RT6,8 4  228                               CEU026
     O                 13N32   RTE,8    228                               CEU026
0968 O                 13    06DYS,9 4  233                               CEU026
0965 O                 13N01N09RTN,9 4  247                               CEU026
0965 O                 13N01 09RT7,9 4  247                               CEU026
0965 O                 13 01N09RT6,9 4  247                               CEU026
     O                 13N32   RTE,9    247                               CEU026
0970 O                 13    06DYS,104  252                               CEU026
0965 O                 13N01N09RTN,104  266                               CEU026
0965 O                 13N01 09RT7,104  266                               CEU026
0965 O                 13 01N09RT6,104  266                               CEU026
     O                 13N32   RTE,10   266                               CEU026
0972 O                 13    06DYS,114  271                               CEU026
0965 O                 13N01N09RTN,114  285                               CEU026
0965 O                 13N01 09RT7,114  285                               CEU026
0965 O                 13 01N09RT6,114  285                               CEU026
     O                 13N32   RTE,11   285                               CEU026
0974 O                 13    06DYS,124  290                               CEU026
0965 O                 13N01N09RTN,124  304                               CEU026
0965 O                 13N01 09RT7,124  304                               CEU026
0965 O                 13 01N09RT6,124  304                               CEU026
     O                 13N32   RTE,12   304                               CEU026
0976 O                 13    06DYS,134  309                               CEU026
0965 O                 13N01N09RTN,134  323                               CEU026
0965 O                 13N01 09RT7,134  323                               CEU026
0965 O                 13 01N09RT6,134  323                               CEU026
     O                 13N32   RTE,13   323                               CEU026
0978 O                 13    06DYS,144  328                               CEU026
0965 O                 13N01N09RTN,144  342                               CEU026
0965 O                 13N01 09RT7,144  342                               CEU026
0965 O                 13 01N09RT6,144  342                               CEU026
     O                 13N32   RTE,14   342                               CEU026
0980 O                 13    06DYS,154  347                               CEU026
0965 O                 13N01N09RTN,154  361                               CEU026
0965 O                 13N01 09RT7,154  361                               CEU026
0965 O                 13 01N09RT6,154  361                               CEU026
     O                 13N32   RTE,15   361                               CEU026
0982 O                 13    06DYS,164  366                               CEU026
0965 O                 13N01N09RTN,164  380                               CEU026
0965 O                 13N01 09RT7,164  380                               CEU026
0965 O                 13 01N09RT6,164  380                               CEU026
     O                 13N32   RTE,16   380                               CEU026
0984 O                 13    06DYS,174  385                               CEU026
0965 O                 13N01N09RTN,174  399                               CEU026
0965 O                 13N01 09RT7,174  399                               CEU026
0965 O                 13 01N09RT6,174  399                               CEU026
     O                 13N32   RTE,17   399                               CEU026
0986 O                 13    06DYS,184  404                               CEU026
0965 O                 13N01N09RTN,184  418                               CEU026
0965 O                 13N01 09RT7,184  418                               CEU026
0965 O                 13 01N09RT6,184  418                               CEU026
     O                 13N32   RTE,18   418                               CEU026
0988 O                 13    06DYS,194  423                               CEU026
0965 O                 13N01N09RTN,194  437                               CEU026
0965 O                 13N01 09RT7,194  437                               CEU026
0965 O                 13 01N09RT6,194  437                               CEU026
     O                 13N32   RTE,19   437                               CEU026
0990 O                 13    06DYS,204  442                               CEU026
0965 O                 13N01N09RTN,204  456                               CEU026
0965 O                 13N01 09RT7,204  456                               CEU026
0965 O                 13 01N09RT6,204  456                               CEU026
     O                 13N32   RTE,20   456                               CEU026
0992 O                 13    06DYS,214  461                               CEU026
0965 O                 13N01N09RTN,214  475                               CEU026
0965 O                 13N01 09RT7,214  475                               CEU026
0965 O                 13 01N09RT6,214  475                               CEU026
     O                 13N32   RTE,21   475                               CEU026
0994 O                 13    06DYS,224  480                               CEU026
0965 O                 13N01N09RTN,224  494                               CEU026
0965 O                 13N01 09RT7,224  494                               CEU026
0965 O                 13 01N09RT6,224  494                               CEU026
     O                 13N32   RTE,22   494                               CEU026
0996 O                 13    06DYS,234  499                               CEU026
0965 O                 13N01N09RTN,234  513                               CEU026
0965 O                 13N01 09RT7,234  513                               CEU026
0965 O                 13 01N09RT6,234  513                               CEU026
     O                 13N32   RTE,23   513                               CEU026
0998 O                 13    06DYS,244  518                               CEU026
0965 O                 13N01N09RTN,244  532                               CEU026
0965 O                 13N01 09RT7,244  532                               CEU026
0965 O                 13 01N09RT6,244  532                               CEU026
     O                 13N32   RTE,24   532                               CEU026
1000 O                 13    06DYS,254  537                               CEU026
0965 O                 13N01N09RTN,254  551                               CEU026
0965 O                 13N01 09RT7,254  551                               CEU026
0965 O                 13 01N09RT6,254  551                               CEU026
     O                 13N32   RTE,25   551                               CEU026
1002 O                         ERCD     627                               CEU026
1003 O                         EMES     682                               CEU026
1004 O                 14      ACTN     704                               CEU026
1005 O                 14      CCYX     707                               CEU026
1009 O*
1099 O*    UPDATE FWDRT HEADER
1100 OFWDRT   E        44
1101 O                         NORE       7P
1102 O                         NINS      16P
1103 O                         NAMD      19P
1104 O                         NDEL      22P
1105 O                         NLRA      25P
     O*************************RUND     252P                       E11232 S01194
     O**********               BJMRDT   252                        S01194 LN744
     O                         BJRDNB   252P                              LN744
1107 O                         ACTNX    253
1108 O                         NATN     256P
1109 O*
1110 O*    ADD FWDRT DETAIL
1111 OFWDRTFE EADD     46 03N07
1112 O                                    1 'D'
1113 O                         CCYS       4
1114 O*************************DAY       54P                              S01328
1115 O*************************RAT      229P                              S01328
     O*************************RUND     252P                       E11232 S01194
     O**********               BJMRDT   252                        S01194 LN744
     O*************************BJRDNB   252P                       LN744  S01328
1117 O*************************ACTNX    253                               S01328
1118 O*************************NATN     256P                              S01328
1114 O                         DAY       79P                              S01328
1115 O                         RAT      254P                              S01328
     O                         BJRDNB   257P                              S01328
1117 O                         ACTNX    258                               S01328
1118 O                         NATN     261P                              S01328
     O                         RPRL     612                                                   CSD006
     O                         TSTAMP   638                                                   CSD006
     O                         DFTS     646P                                                  CSD006
     O                         FOID     666                                                   CSD006
     O                         AFOI     686                                                   CSD006
     O                         DREQ     718                                                   CSD006
     O                         FWRT     719                                                   CSD006
1119 O*
1120 O*    UPDATE/DELETE FWDRT DETAIL
1121 OFWDRT   E        46N03
1122 O       OR        46 03 07
1123 O                                    1 'D'
1124 O                 05                 1 '*'
1125 O****************N05      DAY       54P                              S01328
1126 O****************N05      RAT      229P                              S01328
     O*************************RUND     252P                       E11232 S01194
     O**********               BJMRDT   252                        S01194 LN744
     O****************         BJRDNB   252P                       LN744  S01328
1128 O****************         ACTNX    253                               S01328
1129 O****************         NATN     256P                              S01328
1125 O                N05      DAY       79P                              S01328
1126 O                N05      RAT      254P                              S01328
     O                         BJRDNB   257P                              S01328
1128 O                         ACTNX    258                               S01328
1129 O                         NATN     261P                              S01328
     O                         RPRL     612                                                   CSD006
     O                         TSTAMP   638                                                   CSD006
     O                         DFTS     646P                                                  CSD006
     O                         FOID     666                                                   CSD006
     O                         AFOI     686                                                   CSD006
     O                         DREQ     718                                                   CSD006
     O                         FWRT     719                                                   CSD006
     O*
     O*   RELEASE FWDRT FILE
     O        E        47
     O*
     O/COPY WNCPYSRC,DL0090O001
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   EMSG - ARRAY OF ERROR MESSAGES.
INVALID CMD KEY
INVALID ACTION CODE
ALREADY ON FILE
NOT ON FILE
THIS RECORD HAS BEEN UPDATED BY ANOTHER WORK STATION
     X/COPY WNCPYSRC,DL0090X001
