0002 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Forward rates input by forward pts')
0003 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Dealing Module
0006 F*                                                               *
0007 F*    DL0090A -  FORWARD RATES INPUT BY FORWARD POINTS           *
     F*               ** BASED ON DL0090 **                           *
0008 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD031             Date 10Apr06               *
      *  Prev Amend No. CSD027             Date 09Dec05               *
      *                 CAAA03             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 23Feb01               *
      *                 CAP059             Date 23Feb01               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
     F*                 119400             DATE 13OCT99               *
     F*                 125790             Date 05Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 152522             Date 03Jan99               *
     F*                 152073             Date 03Jan99               *
     F*                 147912             DATE 18Nov98               *
     F*                 CEU026             DATE 24Jul98               *
     F*                 132903             DATE 21May98               *
     F*                 089129             DATE 23Jun95               *
     F*                 088301             DATE 16JUN95               *
     F*                 S01432             DATE 21JUL93               *
0012 F*---------------------------------------------------------------*
0012 F*                                                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CAAA03 - Webfacing Changes (Recompile)                       *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CSD006 - Market Data Feed                                    *
     F*  CAP059 - Conversion of Forward Rates into Modular APIs       *
     F*  119400 - Forward Rates Input did not accept 94 in the days   *
     F*           input field. Error on fix E26581. Wrong variable    *
     F*           used for period entered. Fix done uses DAY instead  *
     F*           of DYA array. Applied fix 065331.                   *
     F*  125790 - Most significant digit for the forward point being  *
     F*           lost if it is GE 100 and the quoted decimal is lost *
     F*  152522 - Reverse reciprocal rates for OUT currency if base   *
     F*           currency is IN.  Use multiply/divide indicator of   *
     F*           OUT currency/EUR rate for rate conversion in ZXRATE *
     F*           Points entered are against OUT/EUR rate (A6INER).   *
      *  152073 - Correct calculation of base rate for OUT currency   *
      *           if base currency is IN.                             *
     F*  147912 - CEU026 coded incorrectly. Program cannot work if    *
     F*           feature is switched off as rates are never set up.  *
     F*           Combine the two IF conditions added by CEU026.      *
     F*  CEU026 - EMU Forward rates changes                           *
     F*  132903 - Fix 089129 did not increase divisor table NQD to    *
     F*           allow for 3 additional lengths of decimals.         *
     F*  089129 - Allow up to 5 digits as well as up to 8 decimals    *
     F*           as per instruction manual; use new field PNF for    *
     F*           Forward Points in FWDRTFE. Field PFW (which was     *
     F*           called PNF in I-specs) is now redundant.            *
      *  088301 - Allow input of Forward with same number of decimals *
      *           as spot.                                            *
      *  S01432 - NEW PROGRAM BASED ON DL0090 TO ENABLE FORWARD RATES *
      *           TO BE MAINTAINED USING FORWARD POINTS               *
0012 F*                                                               *
0013 F*****************************************************************
0014 F* ID F  C  H  L    FUNCTION OF INDICATORS
0016 F* 01   CURRENCY SHOULD HAVE 6 DECIMAL PLACES
0016 F* 02                        - INITIAL SCREEN
0017 F* 03                        - INSERT SCREEN
0018 F* 04                        - AMEND SCREEN
0019 F* 05                        - DELETE SCREEN
0020 F* 06            FORWARD RATES - DETAIL RECORD
0021 F* 07                          - DELETED RECORD
0022 F* 08                          - HEADER RECORD
0023 F* 09   CURRENCY SHOULD HAVE 7 DECIMAL PLACES
0024 F* 10   DEALING CURRENCY FOUND ON FILE
0064 F* 11   USED TO CONDITION FIRST TIME PASS THROUGH RPG CALC CYCLE
0065 F* 12   SET ON IF ERROR DURING READ FROM THE WORK STATION
0027 F* 13   OUTPUT DAYS/RATE FIELDS
0028 F* 14   OUTPUT ACTION/CURRENCY
0029 F* 15   CURRENCY FROM SCREEN BLANK
0030 F* 16   ACTION - INSERT
0031 F* 17          - AMEND
0032 F* 18          - DELETE
0033 F* 19          - ENQUIRY
0034 F* 20   NTH DAY NUMBER BLANK
0035 F* 21   NTH RATE BLANK
0036 F* 22   FIRST BLANK FOUND
0037 F* 23   RATE HAS BEEN DECREASED
0038 F* 24   RATE DIFFERS BY MORE THAN 10%
0039 F**25***ALL DATA PROCESSED                                           CEU026
0039 F* 25   PROTECT RATE FIELDS FOR 'IN' CURRENCY                        CEU026
0040 F* 26   CHAIN FAIL
0041 F* 27   RELEASE SCREEN
0042 F* 28   AT LEAST ONE WARNING ERROR
0043 F* 29   SEVERE ERROR
0044 F* 30   NON-DISPLAY COLUMN HEADINGS
0045 F* 31   PROTECT DAYS/RATE FIELDS
0046 F* 32   NON-DISPLAY ERROR CODES
0047 F* 33   NON-DISPLAY ERROR MESSAGE
0048 F* 34   POSITION CURSOR ON ACTION CODE
0049 F* 35   PROTECT ACTION CODE AND CURRENCY
0050 F* 36   BLINK ACTION CODE LABEL
0051 F* 37   BLINK CURRENCY LABEL
0052 F* 38   WORKSTATION OUTPUT
0052 F* 39   CONDITION ONLY ONE OCCURANCE OF 'W11' ERROR CODE
 058 F* 44   UPDATE HEADER
0060 F* 46   UPDATE/ADD FORWARD RATE DETAIL
0061 F* 47   RELEASE FORWARD RATE FILE
0062 F****40-89**ALSO BLINK DAYS/RATE FIELD                               S01432
     F* 40-89  ALSO BLINK DAYS/RATE/SIGN FIELD                            S01432
0063 F*
     F*****************************************************************
0066 F*DL0090FMCF**F     685            WORKSTN      KPASS  *NOIND        S01432
     F*DL0090FACF**F     685            WORKSTN      KPASS  *NOIND S01432 089129
     FDL0090FACF  F     760            WORKSTN      KPASS  *NOIND         089129
0014 F*FWDRT***UF  F     261  3AI     2 DISK                              S01432
0014 F*FWDRT***UF  F     436  3AI     2 DISK                       S01432 089129
0014 F******FWDRT   UF  F     611  3AI     2 DISK                               089129
0014 FFWDRT   UF  F     719  3AI     2 DISK                                                   CSD006
0068 F                                              KCOMIT
     F*FWDRTFE*O   F     261            DISK                      A       S01432
     F*FWDRTFE*O   F     436            DISK                      AS01432 089129
     F*****FWDRTFE O   F     611            DISK                      A        089129         CSD006
     FFWDRTFE O   F     719            DISK                      A                            CSD006
     F                                              KCOMIT
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,DL0090AE01
0072 E                    EMSG    1   5 55               ERROR MESSAGES
     E/COPY WNCPYSRC,DL0090AE02
0073 E                    ERCD       19  4               ERROR CODES
0074 E                    DAY        25  5 0             NO. DAYS - SCREEN
0075 E                    DYA        25  5               NO. DAYS - ALPHA
0076 E                    DYS        25  5 0             NO. DAYS - FWDRT
0077 E********************RAT        25 12 8             RATE - SCREEN    089129
0077 E                    RAT        25 13 8             RATE - SCREEN    089129
0078 E********************RTE        25 13               RATE - ALPHA     S01432
0079 E********************RTN        25 12 8             RATE - FWDRT     089129
0079 E                    RTN        25 13 8             RATE - FWDRT     089129
     E********************RT6        25 12 6      6 DP OUTPUT ARRAY       S01432
     E********************RT7        25 12 7      6 DP OUTPUT ARRAY       S01432
0080 E                    ZA1        16  1               ZALIGN SR. ARRAY
0081 E                    ZA2        16  1               ZALIGN SR. ARRAY
     E********************PNT        25 10 6             POINTS -  S01432 089129
     E********************PNT        25 10 8             POINTS -  088301 089129
     E********************PN6        25 10 6             POINTS -  088301 089129
     E********************PN7        25 10 7             POINTS -  088301 089129
     E                    PNT        25 13 8             POINTS - SCREEN  089129
     E                    PN6        25 13 6             POINTS - SCREEN  089129
     E                    PN7        25 13 7             POINTS - SCREEN  089129
     E                    PNA        25 14               POINTS -  S01432 089129
     E********************PNF        25 10 6             POINTS -  S01432 089129
     E                    SIG        25  1               SIGN - SCREEN    S01432
     E                    SIA        25  1               SIGN - ALPHA     S01432
     E                    SGN        25  1               SIGN - FWDRT     S01432
     E                    PNF        25 13 8             POINTS - FWDRT   089129
     E*************       NQD     1   6  6 0         SIGN - FWDRT  S01432 132903
     E                    NQD     1   9  9 0             SIGN - FWDRT     132903
      **
     I*L0090FMNS  02   1 CS   2 CF                                        S01432
     IDL0090FANS  02   1 CS   2 CF                                        S01432
     I       OR   03   1 CS   2 CI
     I       OR   04   1 CS   2 CA
     I       OR   05   1 CS   2 CD
     I                                        1   2 SCRN
     I                                        3   3 ACTNX
     I                                        4   6 CCYS
     I                                        7  11 DYA,1
     I************                           12  24 RTE,1                 S01432
     I************                           12  24 RTE1           S01432 089129
     I************                           25  29 DYA,2                 089129
     I************                           30  42 RTE,2                 S01432
     I************                           43  47 DYA,3                 S01432
     I************                           48  60 RTE,3                 S01432
     I************                           61  65 DYA,4                 S01432
     I************                           66  78 RTE,4                 S01432
     I************                           79  83 DYA,5                 S01432
     I************                           84  96 RTE,5                 S01432
     I************                           97 101 DYA,6                 S01432
     I************                          102 114 RTE,6                 S01432
     I************                          115 119 DYA,7                 S01432
     I************                          120 132 RTE,7                 S01432
     I************                          133 137 DYA,8                 S01432
     I************                          138 150 RTE,8                 S01432
     I************                          151 155 DYA,9                 S01432
     I************                          156 168 RTE,9                 S01432
     I************                          169 173 DYA,10                S01432
     I************                          174 186 RTE,10                S01432
     I************                          187 191 DYA,11                S01432
     I************                          192 204 RTE,11                S01432
     I************                          205 209 DYA,12                S01432
     I************                          210 222 RTE,12                S01432
     I************                          223 227 DYA,13                S01432
     I************                          228 240 RTE,13                S01432
     I************                          241 245 DYA,14                S01432
     I************                          246 258 RTE,14                S01432
     I************                          259 263 DYA,15                S01432
     I************                          264 276 RTE,15                S01432
     I************                          277 281 DYA,16                S01432
     I************                          282 294 RTE,16                S01432
     I************                          295 299 DYA,17                S01432
     I************                          300 312 RTE,17                S01432
     I************                          313 317 DYA,18                S01432
     I************                          318 330 RTE,18                S01432
     I************                          331 335 DYA,19                S01432
     I************                          336 348 RTE,19                S01432
     I************                          349 353 DYA,20                S01432
     I************                          354 366 RTE,20                S01432
     I************                          367 371 DYA,21                S01432
     I************                          372 384 RTE,21                S01432
     I************                          385 389 DYA,22                S01432
     I************                          390 402 RTE,22                S01432
     I************                          403 407 DYA,23                S01432
     I************                          408 420 RTE,23                S01432
     I************                          421 425 DYA,24                S01432
     I************                          426 438 RTE,24                S01432
     I************                          439 443 DYA,25                S01432
     I************                          444 456 RTE,25                S01432
     I************                            7 206 DATA1                 S01432
     I************                          207 406 DATA2                 S01432
     I************                          407 456 DATA3                 S01432
     I************                          457 457 ACTN                  S01432
     I************                          458 460 CCYX       15         S01432
     I************                           30  40 PNA,2          S01432 089129
     I************                           41  41 SIA,2          S01432 089129
     I************                           42  46 DYA,3          S01432 089129
     I************                           47  57 PNA,3          S01432 089129
     I************                           58  58 SIA,3          S01432 089129
     I************                           59  63 DYA,4          S01432 089129
     I************                           64  74 PNA,4          S01432 089129
     I************                           75  75 SIA,4          S01432 089129
     I************                           76  80 DYA,5          S01432 089129
     I************                           81  91 PNA,5          S01432 089129
     I************                           92  92 SIA,5          S01432 089129
     I************                           93  97 DYA,6          S01432 089129
     I************                           98 108 PNA,6          S01432 089129
     I************                          109 109 SIA,6          S01432 089129
     I************                          110 114 DYA,7          S01432 089129
     I************                          115 125 PNA,7          S01432 089129
     I************                          126 126 SIA,7          S01432 089129
     I************                          127 131 DYA,8          S01432 089129
     I************                          132 142 PNA,8          S01432 089129
     I************                          143 143 SIA,8          S01432 089129
     I************                          144 148 DYA,9          S01432 089129
     I************                          149 159 PNA,9          S01432 089129
     I************                          160 160 SIA,9          S01432 089129
     I************                          161 165 DYA,10         S01432 089129
     I************                          166 176 PNA,10         S01432 089129
     I************                          177 177 SIA,10         S01432 089129
     I************                          178 182 DYA,11         S01432 089129
     I************                          183 193 PNA,11         S01432 089129
     I************                          194 194 SIA,11         S01432 089129
     I************                          195 199 DYA,12         S01432 089129
     I************                          200 210 PNA,12         S01432 089129
     I************                          211 211 SIA,12         S01432 089129
     I************                          212 216 DYA,13         S01432 089129
     I************                          217 227 PNA,13         S01432 089129
     I************                          228 228 SIA,13         S01432 089129
     I************                          229 233 DYA,14         S01432 089129
     I************                          234 244 PNA,14         S01432 089129
     I************                          245 245 SIA,14         S01432 089129
     I************                          246 250 DYA,15         S01432 089129
     I************                          251 261 PNA,15         S01432 089129
     I************                          262 262 SIA,15         S01432 089129
     I************                          263 267 DYA,16         S01432 089129
     I************                          268 278 PNA,16         S01432 089129
     I************                          279 279 SIA,16         S01432 089129
     I************                          280 284 DYA,17         S01432 089129
     I************                          285 295 PNA,17         S01432 089129
     I************                          296 296 SIA,17         S01432 089129
     I************                          297 301 DYA,18         S01432 089129
     I************                          302 312 PNA,18         S01432 089129
     I************                          313 313 SIA,18         S01432 089129
     I************                          314 318 DYA,19         S01432 089129
     I************                          319 329 PNA,19         S01432 089129
     I************                          330 330 SIA,19         S01432 089129
     I************                          331 335 DYA,20         S01432 089129
     I************                          336 346 PNA,20         S01432 089129
     I************                          347 347 SIA,20         S01432 089129
     I************                          348 352 DYA,21         S01432 089129
     I************                          353 363 PNA,21         S01432 089129
     I************                          364 364 SIA,21         S01432 089129
     I************                          365 369 DYA,22         S01432 089129
     I************                          370 380 PNA,22         S01432 089129
     I************                          381 381 SIA,22         S01432 089129
     I************                          382 386 DYA,23         S01432 089129
     I************                          387 397 PNA,23         S01432 089129
     I************                          398 398 SIA,23         S01432 089129
     I************                          399 403 DYA,24         S01432 089129
     I************                          404 414 PNA,24         S01432 089129
     I************                          415 415 SIA,24         S01432 089129
     I************                          416 420 DYA,25         S01432 089129
     I************                          421 431 PNA,25         S01432 089129
     I************                          432 432 SIA,25         S01432 089129
     I************                            7 206 DATA1          S01432 089129
     I************                          207 406 DATA2          S01432 089129
     I************                          407 432 DATA3          S01432 089129
     I************                          433 433 ACTN           S01432 089129
     I************                          434 436 CCYX     15    S01432 089129
     I                                       12  25 RTE1                  089129
     I                                       26  30 DYA,2                 089129
     I                                       31  44 PNA,2                 089129
     I                                       45  45 SIA,2                 089129
     I                                       46  50 DYA,3                 089129
     I                                       51  64 PNA,3                 089129
     I                                       65  65 SIA,3                 089129
     I                                       66  70 DYA,4                 089129
     I                                       71  84 PNA,4                 089129
     I                                       85  85 SIA,4                 089129
     I                                       86  90 DYA,5                 089129
     I                                       91 104 PNA,5                 089129
     I                                      105 105 SIA,5                 089129
     I                                      106 110 DYA,6                 089129
     I                                      111 124 PNA,6                 089129
     I                                      125 125 SIA,6                 089129
     I                                      126 130 DYA,7                 089129
     I                                      131 144 PNA,7                 089129
     I                                      145 145 SIA,7                 089129
     I                                      146 150 DYA,8                 089129
     I                                      151 164 PNA,8                 089129
     I                                      165 165 SIA,8                 089129
     I                                      166 170 DYA,9                 089129
     I                                      171 184 PNA,9                 089129
     I                                      185 185 SIA,9                 089129
     I                                      186 190 DYA,10                089129
     I                                      191 204 PNA,10                089129
     I                                      205 205 SIA,10                089129
     I                                      206 210 DYA,11                089129
     I                                      211 224 PNA,11                089129
     I                                      225 225 SIA,11                089129
     I                                      226 230 DYA,12                089129
     I                                      231 244 PNA,12                089129
     I                                      245 245 SIA,12                089129
     I                                      246 250 DYA,13                089129
     I                                      251 264 PNA,13                089129
     I                                      265 265 SIA,13                089129
     I                                      266 270 DYA,14                089129
     I                                      271 284 PNA,14                089129
     I                                      285 285 SIA,14                089129
     I                                      286 290 DYA,15                089129
     I                                      291 304 PNA,15                089129
     I                                      305 305 SIA,15                089129
     I                                      306 310 DYA,16                089129
     I                                      311 324 PNA,16                089129
     I                                      325 325 SIA,16                089129
     I                                      326 330 DYA,17                089129
     I                                      331 344 PNA,17                089129
     I                                      345 345 SIA,17                089129
     I                                      346 350 DYA,18                089129
     I                                      351 364 PNA,18                089129
     I                                      365 365 SIA,18                089129
     I                                      366 370 DYA,19                089129
     I                                      371 384 PNA,19                089129
     I                                      385 385 SIA,19                089129
     I                                      386 390 DYA,20                089129
     I                                      391 404 PNA,20                089129
     I                                      405 405 SIA,20                089129
     I                                      406 410 DYA,21                089129
     I                                      411 424 PNA,21                089129
     I                                      425 425 SIA,21                089129
     I                                      426 430 DYA,22                089129
     I                                      431 444 PNA,22                089129
     I                                      445 445 SIA,22                089129
     I                                      446 450 DYA,23                089129
     I                                      451 464 PNA,23                089129
     I                                      465 465 SIA,23                089129
     I                                      466 470 DYA,24                089129
     I                                      471 484 PNA,24                089129
     I                                      485 485 SIA,24                089129
     I                                      486 490 DYA,25                089129
     I                                      491 504 PNA,25                089129
     I                                      505 505 SIA,25                089129
     I                                        7 206 DATA1                 089129
     I                                      207 406 DATA2                 089129
     I                                      407 505 DATA3                 089129
     I                                      506 506 ACTN                  089129
     I                                      507 509 CCYX            15    089129
     I*
     I*   CATCHALL
0144 I*    FORWARD RATES FILE - HEADER RECORD.
0145 I*
0146 IFWDRT   NS  08   1 CH
0147 I                                        1   1 RECI
0148 I                                        2   4 CCY
0149 I                                    P   5   70NORE
0150 I                                    P   8  100FLSZ
0151 I                                    P  11  130NLRB
0152 I                                    P  14  160NINS
0153 I                                    P  17  190NAMD
0154 I                                    P  20  220NDEL
0155 I                                    P  23  250NLRA
0156 I                                    P 250 2520LCD
0157 I                                      253 253 CHTP
0158 I                                    P 254 2560TNLU
0159 I                                        1 150 FWR1
0160 I                                      151 256 FWR2
0161 I*
0162 I*
0163 I*    FORWARD RATES FILE - DETAIL RECORD.
0164 I*
0165 IFWDRT   NS  06   1 CD
0166 I       OR   07   1 C*
0167 I                                        1   1 RECI
0168 I                                        2   4 CCY
0169 I                                    P   5  79 DYS
0170 I                                    P  80 254 RTN
0171 I                                    P 255 2570LCDF
0172 I                                      258 258 CHTPF
0173 I                                    P 259 2610TNLUF
     I************                        P 262 411 PNF            S01432 089129
     I                                      412 436 SGN                   S01432
     I                                    P 437 611 PNF                   089129
     I                                      612 612 RPRL                                      CSD006
     I                                      613 638 TSTAMP                                    CSD006
     I                                    P 639 6460DFTS                                      CSD006
     I                                      647 666 FOID                                      CSD006
     I                                      667 686 AFOI                                      CSD006
     I                                      687 718 DREQ                                      CSD006
     I                                      719 719 FWRT                                      CSD006
0176 I*
0237 I*
0238 I            DS
0239 I                                        1  11 LUD
0240 I                                        1   50LCDF
0241 I                                        6   6 CHTPF
0242 I                                        7  110TNLUF
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      254 263 USRID
     I*
     IDNATN       DS                              5
     I                                        1   50FNATN
     I**
     I**  DATA STRUCTURE FOR ERROR HANDLING SUBROUTINE
     I**
     IINFDS       DS
     I                                     *STATUS  STATUS
0255 I**
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTNX
     I                                       26  35 USRIDX
     I                                       51  52 SCRN
     I                                       53  53 ACTNY
     I                                       54  56 CCYS
     I                                       57 256 DATA1
     I                                      257 456 DATA2
     I*******                               457 506 DATA3                 S01432
     I************                          457 482 DATA3          S01432 089129
     I                                      457 555 DATA3                 089129
      *                                                                   CEU026
     ILDA       E DSLDA                         256                       CEU026
      *                                                                   CEU026
      ** Local data area for database error details                       CEU026
      ** *LOCK IN LDA immediately before and OUT LDA immediately          CEU026
      ** after each database error handling.                              CEU026
      **                                                                  CEU026
      **                                    134 141 DBFILE                CEU026
      **       Defines:                     142 170 DBKEY                 CEU026
      **                                    171 180 DBPGM                 CEU026
      **                                    181 1830DBASE                 CEU026
     I*
     ISDBANK    E DSSDBANKPD
     I** External DS for Bank Details
     I*
     ISDCURR    E DSSDCURRPD
     I** External DS for Currency Details
     I*
     IDSFDY     E DSDSFDY
     I* DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     ISDGELR    E DSSDGELRPD                                              CEU026
     I** External DS for General Ledger Details.                          CEU026
     I*                                                                   CEU026
     IDSSDY     E DSDSSDY
     I* DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     I*
     IRUNDAT      DS
     I*  DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.
     I                                       13  13 @MBIN
     I*
     I*  EXTERNAL DATA AREA OF DEFAULT BRANCH FOR USER
     IZMUSER      DS                             17
     I                                       11  13 ZDFB
     I*  DEFAULT TIMESTAMP
     IXXXXXX      DS                             26
     I                                        1  26 TIMST
     I/COPY WNCPYSRC,DL0090AI01
     C*
     C/COPY ZSRSRC,DFTTSTAMPC                                                                 CSD006
      *                                                                                       CSD006
      *
     C**   FROM ERROR HANDLING SUBROUTINE RETURN TO EXIT POINT
     C           STATUS    IFEQ 01021
     C                     Z-ADD0         STATUS  50
     C                     GOTO INFTAG
     C                     END
0243 C*    FIRST CYCLE CALCULATIONS
     C**
     C           *IN11     IFEQ '1'
     C*********************READ DL0090FM                 12               S01432
     C                     READ DL0090FA                 12               S01432
     C                     GOTO ENDFC
     C                     END
     C*
     C                     MOVEACPY@      BIS@   80
      * Initialise LDA                                                    CEU026
     C           *NAMVAR   DEFN           LDA                             CEU026
     C                     MOVEL'SD0020M 'DBPGM                           CEU026
     C*
     C** CALL TO BANK ACCESS OBJECT TO OBTAIN BASE CURRENCY
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C           @RTCD     IFNE *BLANKS
     C*********************MOVEL'SDBANKPD'DBFILE 10        ***********    CEU026
     C*********************MOVEL'01'      DBASE   3        * DBERR 01*    CEU026
     C*********************MOVEL@OPTN     DBOPTN  7        ***********    CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDBANKPD'DBFILE           ************   CEU026
     C                     MOVEL'01'      DBASE            * DBERR 01 *   CEU026
     C                     MOVEL@OPTN     DBKEY            ************   CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
      *                                                                   CEU026
      ** Check for EMU Forward Rates CEU026                               CEU026
      *                                                                   CEU026
     C                     CALL 'AOSARDR0'                                CEU026
     C                     PARM *BLANKS   @RTCD                           CEU026
     C                     PARM '*VERIFY' @OPTN                           CEU026
     C                     PARM 'CEU026'  @SARD   6                       CEU026
     C                     PARM           DSFDY                           CEU026
     C                     SELEC                                          CEU026
     C           @RTCD     WHEQ *BLANK                                    CEU026
     C                     MOVE 'Y'       CEU026  1                       CEU026
     C           @RTCD     WHEQ '*NRF'                                    CEU026
     C                     MOVE 'N'       CEU026                          CEU026
     C                     OTHER                                          CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SCSARDPD'DBFILE            ************* CEU026
     C                     MOVEL'004'     DBASE             *DBERROR 004* CEU026
     C                     MOVEL@OPTN     DBKEY             ************* CEU026
     C                     SETON                     U7U8LR               CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     CEU026
     C                     ENDSL                                          CEU026
     C*
     C** GET BASE CURRENCY DECIMAL PLACES
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM BJCYCD    @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVEL'02'      DBASE            * DBERR 02 *
     C*********************MOVEL@OPTN     DBOPTN           ************   CEU026
     C                     MOVEL@OPTN     DBOPTN  7        ************   CEU026
     C                     MOVELBJCYCD    DBKEY  29
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR
     C                     GOTO END
     C                     END
     C                     Z-ADDA6NBDP    BCCDP   10
     C                     MOVELA6EUER    SPOTRA 138                      CEU026
     C******************** MOVELA6MDIN    MULDIV  1                 CEU002152073
     C                     MOVELA6EUMD    MULDIV  1                       152073
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
      *                                                                   CEU026
      ** Check for Whether the Base is an 'IN' Currency                   CEU026
      ** and past its Transition Start Date.                              CEU026
      *                                                                   CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     MOVE 'Y'       INCCY   1                       CEU026
     C                     ELSE                                           CEU026
     C                     MOVE 'N'       INCCY                           CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
      ** Check for EURO Currency Name                                     CEU026
      *                                                                   CEU026
     C**********           CALL 'AOGELRR0'                                CEU026              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR'  @RTCD                           CEU026
     C                     PARM '*FIRST ' @OPTN                           CEU026
     C********** SDGELR    PARM SDGELR    DSFDY                           CEU026              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   CEU026
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDGELRPD'DBFILE            ************* CEU026
     C                     MOVEL'003'     DBASE             *DBERROR 003* CEU026
     C                     MOVEL@OPTN     DBKEY             ************* CEU026
     C                     SETON                     U7U8LR               CEU026
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
      ** Initialise Forward Rates For a EURO Base or 'IN' Currency Base   CEU026
      ** or 'OUT' Base.                                                   CEU026
      *                                                                   CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'Y'       INITN   1        First Call     CEU026
     C                     PARM *BLANKS   RCODE   7        Return Code    CEU026
     C                     ENDIF                                          CEU026
0248 C*
0249 C*    SET UP FIELDS
0250 C                     MOVE ' '       BLNK16 16
0251 C                     MOVE ' '       BLNK76 76
0252 C                     Z-ADD8         ZADEC
0253 C                     Z-ADD4         ZADIG
0254 C                     SETON                     3233
0255 C*
0256 C*  OUTPUT INITIAL SCREEN
0257 C                     EXSR SFOUT
     C                     SETON                     11
     C/COPY WNCPYSRC,DL0090AC01
0258 C                     GOTO END
0259 C*
0260 C*    DETAIL CALCULATIONS
0261 C           ENDFC     TAG                             ** ENDFC TAG **
0262 C                     Z-ADD0         S       20
0263 C                     MOVE BLNK76    ERCD
0264 C                     MOVE BLNK76    EMES   55
0265 C                     SETON                     3233
0266 C                     EXSR BOFF
0267 C*    CHECK COMMAND KEY STATUS
0268 C   KL                EXSR SFOUT
0269 C   KC
0270 COR KL                GOTO END
0271 C   KJ 05             GOTO UDLOG
0272 C*
0273 C*    ERROR IF CMD10 NOT FROM DELETION SCREEN
0274 C   KJ                MOVELEMSG,1    EMES
0275 C   KJ                SETOF                     33
0276 C   KJ                GOTO END
0277 C*
0278 C*    CHECK SCREEN TYPE
0279 C   02                GOTO SFIN
0280 C   03
0281 COR 04                GOTO SISAIN
0282 C*
0283 C*    ERROR IF DELETION SCREEN WITHOUT CMD10
0284 C                     MOVELEMSG,1    EMES
0285 C                     SETOF                     33
0286 C                     GOTO END
0287 C*
0288 C*    PROCESS INITIAL SCREEN
0289 C           SFIN      TAG                             ** SFIN TAG **
0290 C                     EXSR SFOUT
0291 C*
0292 C*    CHECK WHETHER CURRENCY IS ON FORWARD RATE FILE
0293 C                     MOVE CCYX      FRTKEY  3
0294 C                     EXSR FRTCHN
     C*
     C*  RELEASE FWDRT RECORD BEFORE CHAINING TO TABLE FILE TO PREVENT
     C*  ERROR ON EXCPT STATEMENT.
     C*
     C  N26                SETON                     47
     C  N26                EXSR EXCEPT
     C                     MOVE LUD       LUDSV  11
     C   26                MOVE BLNK16    LUDSV
     C*
     C*    CONVERT RATE FROM FILE TO HAVE CORRECT NUMBER OF DEC. PLACES
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM CCYX      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           CCYX      IFEQ '?'
     C                     MOVELA6CYCD    CCYX
     C*
     C** Check whether currency is on FORWARD RATE file.
     C*
     C                     MOVE CCYX      FRTKEY  3
     C                     EXSR FRTCHN
     C                     END
     C*
     C*    CALC DIFFERENCE IN DEC PLACES BETWEEN CCY AND BASE CCY.
     C*
     C** IF INSERT OR AMEND DEFAULT SPOT RATE INTO FIRST RATE FIELD       S01432
     C           ACTN      IFEQ 'I'                                       S01432
     C           ACTN      OREQ 'A'                                       S01432
     C                     Z-ADDA6SPRT    RTN,1                           S01432
     C                     END                                            S01432
     C*                                                                   S01432
     C           A6NBDP    SUB  BCCDP     CDIFF   10
     C           CDIFF     ADD  4         CDIFF
     C*
     C                     SETOF                     0109
     C                     Z-ADD1         A       20
     C           CDIFF     IFEQ 1
     C***********A         DOWLE25                                        S01432
     C***********          Z-ADDRTN,A     RT6,A                           S01432
     C                     Z-ADDRTN,1     RT6    126                      S01432
     C***********          ADD  1         A                               S01432
     C***********          END                                            S01432
     C           A         DOWLE25                                        088301
     C                     Z-ADDPNF,A     PN6,A                           088301
     C                     ADD  1         A                               088301
     C                     END                                            088301
     C                     SETON                     01
     C                     END
     C           CDIFF     IFEQ 2
     C***********A         DOWLE25                                        S01432
     C***********          Z-ADDRTN,A     RT7,A                           S01432
     C                     Z-ADDRTN,1     RT7    127                      S01432
     C***********          ADD  1         A                               S01432
     C***********          END                                            S01432
     C           A         DOWLE25                                        088301
     C                     Z-ADDPNF,A     PN7,A                           088301
     C                     ADD  1         A                               088301
     C                     END                                            088301
     C                     SETON                     09
     C                     END
0299 C*
0300 C*    TEST ACTION TYPE
0301 C                     SETOF                     363728
0302 C                     SETON                     14
0303 C           ACTN      COMP 'I'                      16
0304 C           ACTN      COMP 'A'                      17
0305 C           ACTN      COMP 'D'                      18
     C/COPY WNCPYSRC,DL0090AC03
0306 C           ACTN      COMP 'E'                      19
0307 C                     MOVE ACTN      ACTNX
0308 C  N16N17N18
0309 CANN19                SETON                     36
0310 C*
0311 C*    MOVE ERROR CODE INTO ARRAY IF ACTION INVALID
0312 C   36      S         ADD  1         S
0313 C   36                MOVE '021'     ERCD,S
     C/COPY WNCPYSRC,DL0090AC04
0314 C   36                MOVE EMSG,2    EMES
     C/COPY WNCPYSRC,DL0090AC05
0315 C   36                SETOF                     3233
     C*
      ** Validation of user's action code security.
      ** Dependant on multibranched or not
     C           @MBIN     IFEQ 'N'
     C                     CALL 'ZVACTU'
     C                     PARM           ACTN
     C                     PARM           @ERR    10
      **
     C                     ELSE
     C           *NAMVAR   DEFN           ZMUSER
     C                     IN   ZMUSER
     C                     CALL 'ZVACTBU'
     C                     PARM           ACTN
     C                     PARM           ZDFB
     C                     PARM           @ERR    10
     C                     END
     C*
     C           @ERR      IFNE 0                          B1
     C           S         ADD  1         S                *1
     C                     MOVE '235'     ERCD,S           *1
     C                     SETON                     36    *1
     C                     SETOF                     3233  *1
     C                     END                             E1
0316 C*
0317 C*    ERROR IF NO CURRENCY CODE ENTERED
0318 C   15      S         ADD  1         S          37
0319 C   15                MOVE '229'     ERCD,S
0320 C   15                SETOF                     32
0321 C   36
0322 COR 37                GOTO END
0323 C*
0324 C*    CHECK ACTION AND CURRENCY COMPATIBLE
0325 C   06 16
0326 CORN06 17
0327 CORN06 18
0328 CORN06 19             SETON                     37
0329 C   37                GOTO SFER
0330 C*
0331 C*    IF INSERT CHECK CURRENCY VALID
     C                     MOVE *BLANKS   A6DLCI
     C*
     C           *IN16     IFEQ '1'                        B**1
     C                     CALL 'AOCURRR0'                  **1
     C                     PARM *BLANKS   @RTCD             **1
     C                     PARM '*KEY   ' @OPTN             **1
     C                     PARM CCYX      @AJCD   3         **1
     C           SDCURR    PARM SDCURR    DSSDY
      *
      **  IF CCY IS FOUND AND IS A DEALING CCY
     C           @RTCD     IFEQ *BLANKS                    B**2
     C           A6DLCI    ANDEQ'Y'                        B**2
     C                     SETON                     10     **2
     C                     SETOF                     37     **2
     C                     ELSE                            X**2
     C                     SETON                     37     **2
     C                     SETOF                     10     **2
     C                     END                             E**2
     C                     END                             E**1
     C*
0338 C   37                GOTO SFER
0339 C                     MOVE CCYX      CCYS
     C*                                                                   CEU026
     C** If CCY is 'IN' then forward rates not amendable.                 CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     SETON                     25                   CEU026
     C                     ELSE                                           CEU026
     C                     SETOF                     25                   CEU026
     C                     ENDIF                                          CEU026
     C                     ELSE                                           CEU026
     C                     SETOF                     25                   CEU026
     C                     ENDIF                                          CEU026
0340 C*
0341 C*    OUTPUT REQUESTED SCREEN
0342 C   16                EXSR SIOUT
0343 C   17                EXSR SAOUT
0344 C   18                EXSR SDOUT
0345 C   19                EXSR SEOUT
0346 C                     GOTO END
0347 C*
0348 C*    MOVE ERROR CODE INTO ARRAY
0349 C           SFER      TAG                             ** SFER TAG **
0350 C           S         ADD  1         S
0351 C   16
0352 COR 16 10             MOVE '230'     ERCD,S
0353 C  N16                MOVE '231'     ERCD,S
0354 C  N16                MOVE EMSG,4    EMES
0355 C   16 06             MOVE EMSG,3    EMES
0356 C   16 06
0357 CORN16                SETOF                     33
0358 C                     SETOF                     32
0359 C                     GOTO END
0360 C*
0361 C*    PROCESS INSERT AND AMEND SCREENS
0362 C           SISAIN    TAG                             ** SISAIN TAG *
0363 C*
0364 C*    RESET OUTPUT INDICATOR
0365 C                     SETON                     13
0366 C*    MOVE INPUT DATA INTO ALPHA FIELDS
     C*******              MOVEARTE       LOTR1 195                       S01432
     C*******              MOVEARTE,16    LOTR2 130                       S01432
     C************         MOVE RTE1      LOTR1  13                S01432 089129
     C************         MOVEAPNA       LOTR2 165                S01432 089129
     C************         MOVEAPNA,16    LOTR3 110                S01432 089129
     C                     MOVE RTE1      LOTR1  14                       089129
     C                     MOVEAPNA       LOTR2 210                       089129
     C                     MOVEAPNA,16    LOTR3 140                       089129
     C                     MOVEASIG       LOTR4  25                       S01432
0369 C                     MOVEADYA       LOTD  125
0370 C*
0371 C*    IF ONLY WARNING ERRORS ON LAST OUTPUT CHECK FOR
 372 C*    DATA CHANGES
0373 C   28      LOTD      COMP DSAV                     28
0374 C   28      LOTR1     COMP RSAV1                    28
0375 C   28      LOTR2     COMP RSAV2                    28
     C   28      LOTR3     COMP RSAV3                    28               S01432
     C   28      LOTR4     COMP RSAV4                    28               S01432
0376 C   28                GOTO UDLOG
0377 C*
0378 C*    VALIDATE DATA
0379 C                     SETOF                     2829
0380 C                     EXSR CHECK
0382 C   29                SETOF                     28
     C                     SETOF                     39
0383 C*
0384 C*    IF ONLY WARNING ERRORS SAVE DATA
0385 C***28**              MOVE LOTR1     RSAV1 195                       S01432
0386 C***28**              MOVE LOTR2     RSAV2 130                       S01432
     C***28*******         MOVE LOTR1     RSAV1  13                S01432 089129
     C***28*******         MOVE LOTR2     RSAV2 165                S01432 089129
     C***28*******         MOVE LOTR3     RSAV3 110                S01432 089129
     C   28                MOVE LOTR1     RSAV1  14                       089129
     C   28                MOVE LOTR2     RSAV2 210                       089129
     C   28                MOVE LOTR3     RSAV3 140                       089129
     C   28                MOVE LOTR4     RSAV4  25                       S01432
0387 C   28                MOVE LOTD      DSAV  125
0388 C*
0389 C*    IF ERROR OUTPUT SCREEN
0390 C   28
0391 COR 29                SETOF                     32
0392 C   28
0393 COR 29                GOTO END
0394 C*
 395 C*    UPDATE PROCEDURE
0396 C           UDLOG     TAG                             ** UDLOG TAG **
0397 C*
0401 C*    READ RECORD TO BE UPDATED
0402 C                     EXSR FRTCHN
0403 C*
0404 C*  IF NO RECORD, BLANK OUT LAST UPDATE DATA
0405 C   26                MOVE BLNK16    LUD
0406 C*
0407 C*    CHECK FOR CHANGED RECORD
0408 C           LUD       COMP LUDSV                3838
0409 C  N38                GOTO RUNCH
0410 C*
     C           INFTAG    TAG                             ** INFTAG **
 411 C*    OUTPUT ERROR MESSAGE AND UPDATED RECORD, RELEASE FWDRT
0412 C                     MOVE EMSG,5    EMES
0413 C                     SETOF                     33
0414 C   07                SETOF                     13
0416 C  N26                SETON                     47
0418 C                     GOTO END
0419 C*
0421 C           RUNCH     TAG                             ** RUNCH TAG **
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
     C                     EXSR ZTNLU1
     C                     MOVE 'DL'      MDID    2
     C*******              MOVEL'DL0090'  PGMN    8                       S01432
     C                     MOVEL'DL0090A' PGMN    8                       S01432
     C                     MOVE WSID      WSIDX   3
     C                     MOVE USRID     USRIDX 10
     C                     MOVE ACTNX     ACTNY   1
 448 C*    UPDATE FORWARD DATES FILE
0454 C                     SETON                     46
0455 C                     EXSR EXCEPT
     C*                                                                   CEU026
     C** IF CHANGED RECORD = 'IN' CCY (I.E DAYS HAVE CHANGED)             CEU026
     C** RE-CALCULATE RATES FOR THAT DAY.                                 CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C                     CALL 'AOCURRR0'                                CEU026
     C                     PARM '*MSG   ' @RTCD                           CEU026
     C                     PARM '*KEY   ' @OPTN                           CEU026
     C                     PARM CCYS      @AJCD                           CEU026
     C           SDCURR    PARM SDCURR    DSSDY                           CEU026
      *
     C           @RTCD     IFNE *BLANKS                                   S01194
     C           *LOCK     IN   LDA                                       CEU026
     C                     MOVEL'SDCURRPD'DBFILE           ************   S01194
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   CEU026
     C                     MOVELCCYS      DBKEY                           S01194
     C                     OUT  LDA                                       CEU026
     C                     EXSR *PSSR                                     S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                   CEU026
     C           A6INCY    IFEQ 'Y'                                       CEU026
     C           A6TPSD    ANDLEBJRDNB                                    CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'N'       INITN            First Call     CEU026
     C                     PARM *BLANKS   RCODE            Return Code    CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0456 C*
0457 C*    READ FORWARD RATES HEADER
0458 C                     MOVE BLNK16    FRTKEY
0459 C                     EXSR FRTCHN
0460 C  N08                SETON                     U7U8
0461 C   U7 U8             GOTO END
0462 C*
0471 C*    UPDATE CONTROL FIELDS ON HEADER
0472 C   03      NINS      ADD  1         NINS
0473 C   04      NAMD      ADD  1         NAMD
0474 C   05      NDEL      ADD  1         NDEL
0475 C   03N07   NORE      ADD  1         NORE
0476 C   03      NLRA      ADD  1         NLRA
0477 C   05      NLRA      SUB  1         NLRA
0478 C*
0480 C**   UPDATE FORWARD RATES HEADER
0485 C                     SETON                     44
0486 C                     EXSR EXCEPT
     C*                                                                   CEU026
     C** IF CHANGED RECORD = EURO CCY, RE-CALCULATE 'IN' CURRENCIES       CEU026
     C*                                                                   CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           CCYS      IFEQ BKEURO                                    CEU026
     C                     CALL 'DL4130'                                  CEU026
     C                     PARM           BJCYCD                          CEU026
     C                     PARM           BKEURO                          CEU026
     C                     PARM           INCCY                           CEU026
     C                     PARM 'N'       INITN            First Call     CEU026
     C                     PARM *BLANKS   RCODE            Return Code    CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
0487 C*
     C**   END COMMITMENT CONTROL
     C           CMTTXT    COMIT
0495 C*
0496 C*    OUTPUT INITIAL SCREEN
0497 C                     EXSR SFOUT
0498 C*
0499 C           END       TAG                             ** END TAG **
0500 C*
0501 C*    SET INDICATOR TO RELEASE SCREEN
0502 C   KC
     COR U8                SETON                     LR
0506 C                     SETON                     38
0507 C                     TIME           MTIME   60
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
0616 C*    SR TO CHAIN TO FORWARD RATES FILE
0617 C           FRTCHN    BEGSR                           *** FRTCHN ***
0618 C*
0619 C                     SETOF                     060708
0620 C                     SETOF                     09
0621 C           FRTKEY    CHAINFWDRT                26
0622 C                     ENDSR
0623 C*
0624 C********************************************************************
0632 C********************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C*****************************************************************
0633 C*    SR TO PERFORM EXCEPTION OUTPUT
0634 C           EXCEPT    BEGSR                           *** EXCEPT ***
0635 C                     EXCPT
0638 C                     SETOF                     444647
0639 C*
0640 C                     ENDSR
0641 C*
0642 C********************************************************************
0643 C*    SR TO SETOF DAYS/RATE BLINK INDICATORS
0644 C           BOFF      BEGSR                           *** BOFF ***
0645 C*
0646 C                     SETOF                     404142
0647 C                     SETOF                     434445
0648 C                     SETOF                     464748
0649 C                     SETOF                     495051
0650 C                     SETOF                     525354
0651 C                     SETOF                     555657
0652 C                     SETOF                     585960
0653 C                     SETOF                     616263
0654 C                     SETOF                     646566
0655 C                     SETOF                     676869
0656 C                     SETOF                     707172
0657 C                     SETOF                     737475
0658 C                     SETOF                     767778
0659 C                     SETOF                     798081
0660 C                     SETOF                     828384
0661 C                     SETOF                     858687
0662 C                     SETOF                     8889
0663 C                     ENDSR
0664 C*
0665 C********************************************************************
0666 C*    SR TO VALIDATE INPUT DATA
0667 C           CHECK     BEGSR                           *** CHECK ***
0668 C                     Z-ADD0         RAT
0669 C                     Z-ADD0         DAY
     C                     Z-ADD0         PNT                             S01432
     C                     MOVE *BLANK    SIG                             S01432
0670 C                     Z-ADD1         N       20
0671 C                     SETOF                     222324
0673 C*    SET UP KEY FOR CURRENCY TABLE
     C*
     C** CALL CURRENCY ACCESS OBJECTS
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM CCYS      @AJCD
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           A6DLCI    IFEQ 'Y'                        B**1
     C                     SETON                     10     **1
     C                     ELSE                            X**1
     C                     SETOF                     10     **1
     C                     END                             E**1
     C*
0679 C*    CALC DIFFERENCE IN DEC PLACES BETWEEN CCY AND BASE CURRENCY
     C           A6NBDP    SUB  BCCDP     CDIFF   10
0681 C           CDIFF     ADD  4         CDIFF
0678 C*
0679 C*    FIRST ELEMENT OF DAY AND RATE ARRAYS ARE VALIDATED
0680 C*    SEPARATELY
0681 C*    CHECK FIRST NO OF DAYS IS POSITIVE NUMERIC
0682 C                     Z-ADD5         ZADIG
0683 C                     Z-ADD0         ZADEC
0684 C                     MOVE BLNK16    ZFIELD
0685 C                     MOVE DYA,1     ZFIELD
0686 C                     EXSR ZALIGN
0687 C   99                SETON                     40
0688 C  N40                MOVE ZFIELD    DAY,1
0689 C  N40      DAY,1     COMP 0                      4040
     C/COPY WNCPYSRC,DL0090AC02
0690 C*
0691 C*    MOVE ERROR CODE INTO ARRAY.
0692 C   40      S         ADD  1         S          29
0693 C   40                MOVE '232'     ERCD,S
     C*
     C*    IF PERIOD ENTERED NOT IN ERROR SO FAR THEN CHECK THAT, WHEN
     C*    ADDED TO TODAY, IT DOES NOT EXCEED 99998.
     C           *IN29     IFEQ '0'
     C***********          MOVE DYA,1     WDAY    50                      119400
     C                     MOVE DAY,1     WDAY    50                      119400
     C           BJRDNB    ADD  WDAY      WLIMIT  60
     C           WLIMIT    IFGT 99998
     C                     ADD  1         S
     C                     MOVE '232'     ERCD,S
     C                     SETON                     2940
     C                     END
     C                     END
0694 C*
0695 C*    CHECK IF FIRST FORWARD RATE IS BLANK.
      *                                                                   CEU026
      *    IF EMU FORWARD RATE SWITCHED ON AND CCY IS IN. RATES NOT       CEU026
      *    AMENDABLE. ALLOW BLANKS IN RATE FIELD.                         CEU026
     C           CEU026    IFEQ 'N'                                       CEU026
     C           *IN25     ANDEQ'0'                                       CEU026
0696 C***********RTE,1     COMP BLNK16                   99               S01432
     C           RTE1      COMP BLNK16                   99               S01432
0697 C   99      S         ADD  1         S          29
0698 C   99                MOVE '233'     ERCD,S
0699 C   99                GOTO SET41
     C                     ENDIF                                          CEU026
0700 C*
     C           RTE1      IFNE BLNK16                                    CEU026
0701 C*    ALIGN FIRST FORWARD RATE AND CHECK NUMERIC
0702 C************         Z-ADD4         ZADIG                           089129
0702 C                     Z-ADD5         ZADIG                           089129
0703 C*    SET UP DECIMAL PLACES FOR MAX ALLOWED FOR CURRENCY
0704 C           CDIFF     IFEQ 1
0705 C                     Z-ADD6         ZADEC
0706 C                     ELSE
0707 C           CDIFF     IFEQ 2
0708 C                     Z-ADD7         ZADEC
0709 C                     ELSE
0703 C                     Z-ADD8         ZADEC
0704 C                     END
0705 C                     END
0704 C                     MOVE BLNK16    ZFIELD
0705 C*********************MOVE RTE,1     ZFIELD                          S01432
     C                     MOVE RTE1      ZFIELD                          S01432
0706 C                     EXSR ZALIGN
0703 C*    IF NUMERIC AND DEC PLACES HAS BEEN LIMITED, RE-RUN ZALIGN TO
0704 C*    ALIGN DECIMAL PLACES FOR OUTPUT FIELD ZFIELD
0705 C  N99      ZADEC     IFLT 8
0706 C                     Z-ADD8         ZADEC
0707 C                     MOVE BLNK16    ZFIELD
     C                     MOVE RTE1      ZFIELD                          S01432
0709 C                     EXSR ZALIGN
0709 C                     END
0707 C  N99                MOVE ZFIELD    RAT,1
0708 C  N99      RAT,1     COMP 0                      9999
     C                     ENDIF                                          CEU026
     C*                                                                   CEU026
     C*    IF CCY = 'OUT' AND BASE 'IN', RECALCULATE RATES                CEU026
     C*    (ASSUME RATES ENTERED OUT/EURO RATES)                          CEU026
     C*                                                                   CEU026
     C* Remove code.  Default rate 1 = Spot rate for Out/Base CCy   CEU026152522
     C* which program already does.   Point are against Out/EUR rateCEU026152522
     C* (A6INER on SDCURRPD).  No rate calculation needed.          CEU026152522
     C********** CEU026    IFEQ 'Y'                                 CEU026152522
     C********** A6INCY    IFNE 'Y'                                 CEU026152522
     C********** INCCY     ANDEQ'Y'                                 CEU026152522
     C********** CCYS      ANDNEBKEURO                              CEU026152522
     C*                                                             CEU026152522
     C********** A6INCY    OREQ 'Y'                                 CEU026152522
     C********** BJRDNB    ANDLTA6TPSD                              CEU026152522
     C********** INCCY     ANDEQ'Y'                                 CEU026152522
      *                                                             CEU026152522
     C********** *IN09     IFEQ *ON                                 CEU026152522
     C********** RT7       ANDNERAT,1                               CEU026152522
      *                                                             CEU026152522
     C********** *IN01     OREQ *ON                                 CEU026152522
     C********** RT6       ANDNERAT,1                               CEU026152522
      *                                                             CEU026152522
     C********** *IN09     OREQ *OFF                                CEU026152522
     C********** *IN01     ANDEQ*OFF                                CEU026152522
     C********** RTN,1     ANDNERAT,1                               CEU026152522
     C*                                                             CEU026152522
     C********** RAT,1     IFNE 0                                   CEU026152522
     C******************** Z-ADDSPOTRA    ZRATE1 138                CEU026152073
     C******************** MOVE MULDIV    ZMDI1   1                 CEU026152073
     C******************** Z-ADDRAT,1     ZRATE2 138                CEU026152073
     C******************** MOVE A6MDIN    ZMDI2   1                 CEU026152073
     C******************   Z-ADDSPOTRA    ZRATE2 138                152073152522
     C******************   MOVE MULDIV    ZMDI2   1                 152073152522
     C******************   Z-ADDRAT,1     ZRATE1 138                152073152522
     C******************   MOVE A6MDIN    ZMDI1   1                 152073152522
     C******************   EXSR ZXRATE                              152073152522
      *                                                                   CEU026
      ** Move new Forward Rate into Display Field for Validation.         CEU026
      *                                                                   CEU026
     C******************   Z-ADDZRATEX    RAT,1                     CEU026152522
     C******************   ENDIF                                    CEU026152522
     C******************   ENDIF                                    CEU026152522
     C******************   ENDIF                                    CEU026152522
     C******************   ENDIF                                    CEU026152522
0709 C*
     C           RTE1      IFNE BLNK16                                    CEU026
0710 C*    IF RATE IS NUMERIC, CHECK WITHIN 10% OF SPOT RATE.
0712 C  N10N99             SETON                     99
     C**N99******RAT,1     SUB  A6SPRT    WK12   128   23                 089129
0714 C**N99*23***          Z-SUBWK12      WK12                            089129
     C**N99******WK12      DIV  A6SPRT    DIFF   158                      089129
     C  N99      RAT,1     SUB  A6SPRT    WK13   138   23                 089129
0714 C  N99 23             Z-SUBWK13      WK13                            089129
     C  N99      WK13      DIV  A6SPRT    DIFF   158                      089129
0716 C  N99      DIFF      COMP .1                   24
     C                     ENDIF                                          CEU026
0717 C*
0718 C*    IF NO ERRORS VALIDATE REST OF DATA
0719 C  N99N24N40          GOTO REST
0720 C*
0721 C*    MOVE ERROR CODES INTO ARRAY
0722 C   99      S         ADD  1         S          29
0723 C   99                MOVE '234'     ERCD,S
0724 C   24      S         ADD  1         S          28
0725 C   24                MOVE 'W10'     ERCD,S
0726 C*
0727 C*    SET ERROR INDICATOR.
0728 C           SET41     TAG
0729 C   24
0730 COR 99                SETON                     41
0731 C*
0732 C*    END VALIDATION IF TERMINAL ERROR
0733 C   29                GOTO ENDCHK
0734 C*
0735 C*    VALIDATE REST OF DATA
0736 C           REST      TAG                             ** REST TAG **
0737 C*
0738 C*    INCREMENT ARRAY INDEX AND CHECK WITHIN LIMIT
0739 C           N         ADD  1         N
     C           N         IFGT 25                                        CEU026
     C                     GOTO ENDCHK                                    CEU026
     C                     ENDIF                                          CEU026
0740 C***********N         COMP 25                   25                   CEU026
0741 C***25******          GOTO ENDCHK                                    CEU026
0742 C*
0743 C*    TEST FOR BLANK INPUT
0744 C           DYA,N     COMP BLNK16                   20
0745 C***********RTE,N     COMP BLNK16                   21               S01432
     C           PNA,N     COMP BLNK16                   21               S01432
0746 C*
0747 C*    EITHER BOTH OR NEITHER FIELD MUST BE PRESENT
0748 C   20N21
0749 CORN20 21             SETON                     29
0750 C*
0751 C*    EMBEDED BLANKS NOT ALLOWED
0752 C  N20N21 22          SETON                     29
      *                                                                   CEU026
      *    IF EMU FORWARD RATE SWITCHED ON AND CCY IS IN. RATES NOT       CEU026
      *    AMENDABLE. ALLOW BLANKS IN RATE FIELD.                         CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           *IN25     IFEQ '1'                                       CEU026
     C           *IN21     ANDEQ'1'                                       CEU026
     C                     SETOF                     29                   CEU026
     C                     ENDIF                                          CEU026
     C                     ENDIF                                          CEU026
      *                                                                   CEU026
0753 C*
0754 C*    MOVE ERROR CODE INTO ARRAY
0755 C   29      S         ADD  1         S
0756 C   29N20             MOVE '239'     ERCD,S
0757 C   29 20             MOVE '240'     ERCD,S
0758 C   29 22             MOVE '237'     ERCD,S
0759 C   29 21
0760 COR 29 22             EXSR SETN1
0761 C   29 20
0762 COR 29 22             EXSR SETN2
0763 C   29                GOTO ENDCHK
0764 C*
0765 C*    IF BLANK CHECK NEXT ELEMENTS
0766 C   20 21             SETON                     22
0767 C   22                GOTO REST
0768 C*
0769 C*    CHECK NTH DAY IS NUMERIC AND GREATER THAN
0770 C*    N-1 TH DAY
0771 C                     Z-ADD5         ZADIG
0772 C                     Z-ADD0         ZADEC
0773 C                     MOVE BLNK16    ZFIELD
0774 C                     MOVE DYA,N     ZFIELD
0775 C                     EXSR ZALIGN
0776 C   99                SETON                     29
0777 C  N29                MOVE ZFIELD    DAY,N
0778 C           N         SUB  1         M       20
0779 C  N29      DAY,N     COMP DAY,M                  2929
0780 C*
0781 C*    IF ERROR SET BLINK INDICATOR
0782 C   29                EXSR SETN1
     C*
     C*    IF PERIOD ENTERED NOT IN ERROR SO FAR THEN CHECK THAT, WHEN
     C*    ADDED TO TODAY, IT DOES NOT EXCEED 99998.
     C           *IN29     IFEQ '0'
     C***********          MOVE DYA,N     WDYA    50                      119400
     C***********BJRDNB    ADD  WDYA      WLIMIT  60                      119400
     C                     MOVE DAY,N     WDAY    50                      119400
     C           BJRDNB    ADD  WDAY      WLIMIT  60                      119400
     C           WLIMIT    IFGT 99998
     C                     SETON                     29
     C                     EXSR SETN1
     C                     END
     C                     END
0783 C*
0784 C*    CHECK NTH RATE IS NUMERIC AND WITHIN 10% OF
0785 C*    N-1 TH RATE
     C*    IF EMU FORWARD RATE ON AND CCY IS 'IN' THEN RATE IS BLANK      CEU026
     C*    BYPASS THIS VALIDATION                                         CEU026
     C           CEU026    IFEQ 'Y'                                       CEU026
     C           *IN25     ANDEQ'1'                                       CEU026
     C           PNA,N     ANDEQBLNK16                                    CEU026
     C                     GOTO REST                                      CEU026
     C                     ENDIF                                          CEU026
0786 C***********          Z-ADD4         ZADIG                           089129
0786 C                     Z-ADD5         ZADIG                           089129
     C                     Z-ADD6         ZADEC                           S01432
     C*****SET UP DECIMAL PLACES FOR MAX ALLOWED FOR CURRENCY             S01432
     C***********CDIFF     IFEQ 1                                         S01432
     C***********          Z-ADD6         ZADEC                           S01432
     C***********          ELSE                                           S01432
     C***********CDIFF     IFEQ 2                                         S01432
     C***********          Z-ADD7         ZADEC                           S01432
     C***********          ELSE                                           S01432
     C***********          Z-ADD8         ZADEC                           S01432
     C***********          END                                            S01432
     C***********          END                                            S01432
     C* SET UP DECIMAL PLACES FOR MAX ALLOWED FOR CURRENCY                088301
     C                     SELEC                                          088301
     C           CDIFF     WHEQ 1                                         088301
     C                     Z-ADD6         ZADEC                           088301
     C           CDIFF     WHEQ 2                                         088301
     C                     Z-ADD7         ZADEC                           088301
     C                     OTHER                                          088301
     C                     Z-ADD8         ZADEC                           088301
     C                     ENDSL                                          088301
0788 C                     MOVE BLNK16    ZFIELD
0789 C***********          MOVE RTE,N     ZFIELD                          S01432
     C                     MOVE PNA,N     ZFIELD                          S01432
0790 C                     EXSR ZALIGN
     C*****IF NUMERIC AND DEC PLACES HAS BEEN LIMITED, RE-RUN ZALIGN      S01432
     C*****ALIGN DECIMAL PLACES FOR OUTPUT FIELD ZFIELD                   S01432
     C**N99      ZADEC     IFLT 8                                         S01432
     C***********          Z-ADD8         ZADEC                           S01432
     C***********          MOVE BLNK16    ZFIELD                          S01432
     C***********          MOVE RTE,N     ZFIELD                          S01432
     C***********          EXSR ZALIGN                                    S01432
     C***********          END                                            S01432
     C           SIA,N     IFEQ *BLANK                                    S01432
     C                     MOVE '+'       SIA,N                           S01432
     C                     END                                            S01432
     C           SIA,N     IFNE '+'                                       S01432
     C           SIA,N     ANDNE'-'                                       S01432
     C                     MOVE '1'       *IN99                           S01432
     C                     END                                            S01432
     C**N99**              MOVE ZFIELD    RAT,N                           S01432
     C           *IN99     IFEQ '0'                                       S01432
     C                     MOVE ZFIELD    PNT,N                           S01432
     C                     SELEC                                          088301
     C           CDIFF     WHEQ 1                                         088301
     C                     MULT 100       PNT,N                           088301
     C           CDIFF     WHEQ 2                                         088301
     C                     MULT 10        PNT,N                           088301
     C                     ENDSL                                          088301
     C                     MOVE SIA,N     SIG,N                           S01432
     C*                                                                   CEU026
     C*    IF CCY = 'OUT' AND BASE 'IN', RECALCULATE POINTS               CEU026
     C*    (ASSUME RATES ENTERED OUT/EURO RATES)                          CEU026
     C***********CEU026    IFEQ 'Y'                                 CEU026147912
     C           A6INCY    IFNE 'Y'                                       CEU026
     C           CEU026    ANDEQ'Y'                                       147912
     C           INCCY     ANDEQ'Y'                                       CEU026
     C           CCYS      ANDNEBKEURO                                    CEU026
     C*                                                                   CEU026
     C           A6INCY    OREQ 'Y'                                       CEU026
     C           CEU026    ANDEQ'Y'                                       147912
     C           BJRDNB    ANDLTA6TPSD                                    CEU026
     C           INCCY     ANDEQ'Y'                                       CEU026
      *                                                                   CEU026
      * Remove code to only calculate rate if points have changed.        152522
      * The OUT/EUR rate (A6INER) could have been amended via             152522
      * Spot Rates maintenance and therefore a new forward rate           152522
      * will need to be calculated even if points are not amended.        152522
     C********** *IN09     IFEQ *ON                                 CEU026152522
     C********** PN7,N     ANDNEPNT,N                               CEU026152522
      *                                                                   CEU026
     C********** *IN01     OREQ *ON                                 CEU026152522
     C********** PN6,N     ANDNEPNT,N                               CEU026152522
      *                                                                   CEU026
     C********** *IN09     OREQ *OFF                                CEU026152522
     C********** *IN01     ANDEQ*OFF                                CEU026152522
     C***********PNF,N     ANDNEPNT,N                               CEU026152522
     C*                                                                   CEU026
     C           PNT,N     IFNE 0                                         CEU026
     C*                                                                   CEU026
     C** CALCULATE FIRST RATE INTO CCY AGAINST EURO.                      CEU026
     C*                                                                   CEU026
     C******************** Z-ADDSPOTRA    ZRATE1 138                CEU026152073
     C******************** MOVE MULDIV    ZMDI1   1                 CEU026152073
     C******************** Z-ADDRAT,1     ZRATE2 138                CEU026152073
     C******************** MOVE A6MDIN    ZMDI2   1                 CEU026152073
      ** Points should be added to the OUT/EUR rate - field A6INER  CEU026152522
      ** added to SDCURRPD for this fix.                            CEU026152522
     C******************** Z-ADDSPOTRA    ZRATE2 138                CEU026152522
     C******************** MOVE MULDIV    ZMDI2   1                 CEU026152522
     C******************** Z-ADDRAT,1     ZRATE1 138                CEU026152522
     C******************** MOVE A6MDIN    ZMDI1   1                 CEU026152522
     C******************** EXSR ZXRATE                              CEU026152522
      *                                                             CEU026152522
     C******************** Z-ADDZRATEX    ERT    138                CEU026152522
     C                     Z-ADDA6INER    ERT    138                CEU026152522
      *                                                                   CEU026
      ** CALCULATE NEW RATE FROM POINTS ENTERED                           CEU026
      *                                                                   CEU026
     C           A6NQDP    ADD  1         I                               CEU026
     C           PNT,N     DIV  NQD,I     WWPNT                           CEU026
      *                                                                   CEU026
     C***********A6MDIN    IFEQ 'M'                                 CEU026152522
     C           SIG,N     IFEQ '+'                                       CEU026
     C           ERT       ADD  WWPNT     RAT,N                           CEU026
     C                     ELSE                                           CEU026
     C           ERT       SUB  WWPNT     RAT,N                           CEU026
     C                     ENDIF                                          CEU026
     C**********           ELSE                                     CEU026152522
     C********** SIG,N     IFEQ '+'                                 CEU026152522
     C********** ERT       SUB  WWPNT     RAT,N                     CEU026152522
     C**********           ELSE                                     CEU026152522
     C********** ERT       ADD  WWPNT     RAT,N                     CEU026152522
     C**********           ENDIF                                    CEU026152522
     C**********           ENDIF                                    CEU026152522
      *                                                                   CEU026
      ** RECALCULATE RATE INTO CCY AGAINST BASE                           CEU026
      *                                                                   CEU026
     C******************** Z-ADDSPOTRA    ZRATE1 138                CEU026152073
     C******************** MOVE MULDIV    ZMDI1   1                 CEU026152073
     C******************** Z-ADDRAT,N     ZRATE2 138                CEU026152073
     C******************** MOVE A6MDIN    ZMDI2   1                 CEU026152073
     C                     Z-ADDSPOTRA    ZRATE2 138                      152073
     C                     MOVE MULDIV    ZMDI2   1                       152073
     C                     Z-ADDRAT,N     ZRATE1 138                      152073
     C**Use OUT/EUR multiply/divide indicator - field A6INMD        152073152522
     C**added to SDCURRPD for this fix                              152073152522
     C*******************  MOVE A6MDIN    ZMDI1   1                 152073152522
     C                     MOVE A6INMD    ZMDI1   1                 152073152522
     C                     EXSR ZXRATE                                    CEU026
      *                                                                   CEU026
     C***  If rate is recripocal, call subroutine again with rates        152522
     C***  reversed                                                       152522
     C*                                                                   152522
     C           ZRATEX    IFLT 1                                         152522
     C                     Z-ADDSPOTRA    ZRATE1 138                      152522
     C                     Z-ADDRAT,N     ZRATE2 138                      152522
     C                     EXSR ZXRATE                                    152522
     C                     ENDIF                                          152522
     C*                                                                   152522
     C                     Z-ADDZRATEX    RAT,N                           CEU026
      *                                                                   CEU026
      ** Move new Forward Rate into Display Field for Validation.         CEU026
      *                                                                   CEU026
     C***********SIG,N     IFEQ '+'                                CEU026 152522
     C***********RAT,N     SUB  RAT,1     WWPNT                    CEU026 152522
     C***********WWPNT     MULT NQD,I     PNT,N                    CEU026 152522
     C***********          ELSE                                    CEU026 152522
     C***********RAT,1     SUB  RAT,N     WWPNT                    CEU026 152522
     C***********WWPNT     MULT NQD,I     PNT,N                    CEU026 152522
     C*********************END                                     CEU026 152522
     C                     ENDIF                                          CEU026
     C*********************ENDIF                                   CEU026 152522
     C                     ELSE                                           CEU026
     C           A6NQDP    ADD  1         I       20                      S01432
     C***********PNT,N     DIV  NQD,I     WWPNT  106               S01432 088301
     C***********PNT,N     DIV  NQD,I     WWPNT  108               088301 125790
     C           PNT,N     DIV  NQD,I     WWPNT  138                      125790
     C           SIG,N     IFEQ '+'                                       S01432
     C           RAT,1     ADD  WWPNT     RAT,N                           S01432
     C                     ELSE                                           S01432
     C           RAT,1     SUB  WWPNT     RAT,N                           S01432
     C                     END                                            S01432
     C                     END                                            S01432
     C***********          ENDIF                                    CEU026147912
     C                     ENDIF                                          CEU026
     C**N99**              MOVE ZFIELD    RAT,N                           S01432
0792 C  N99      RAT,N     COMP 0                      9999
0793 C**N99******RAT,N     SUB  RAT,M     WK12         23                 089129
0794 C**N99*23***          Z-SUBWK12      WK12                            089129
0795 C**N99******WK12      DIV  RAT,M     DIFF                            089129
0793 C  N99      RAT,N     SUB  RAT,M     WK13         23                 089129
0794 C  N99 23             Z-SUBWK13      WK13                            089129
0795 C  N99      WK13      DIV  RAT,M     DIFF                            089129
0796 C  N99      DIFF      COMP .1                   24
0797 C   24                SETON                     28
0798 C*
0799 C*    IF NO ERRORS VALIDATE REST OF DATA
0800 C  N99N24N29          GOTO REST
0801 C   99                SETON                     29
0802 C*
0803 C*    OTHERWISE SET BLINK INDICATOR
0804 C   99
0805 COR 24                EXSR SETN2
0806 C*
0807 C*    IF WARNING ERROR VALIDATE REST OF DATA
0808 C   28N29             GOTO REST
0809 C*
0810 C           ENDCHK    ENDSR                           ** ENDCHK TAG *
0811 C********************************************************************
0812 C*    SR TO SET ERROR INDICATOR FOR INVALID NUMBER OF DAYS
0813 C           SETN1     BEGSR                           *** SETN1 ***
0814 C*
0815 C  N42      N         COMP 2                        42
0816 C  N44      N         COMP 3                        44
0817 C  N46      N         COMP 4                        46
0818 C  N48      N         COMP 5                        48
0819 C  N50      N         COMP 6                        50
0820 C  N52      N         COMP 7                        52
0821 C  N54      N         COMP 8                        54
0822 C  N56      N         COMP 9                        56
0823 C  N58      N         COMP 10                       58
0824 C  N60      N         COMP 11                       60
0825 C  N62      N         COMP 12                       62
0826 C  N64      N         COMP 13                       64
0827 C  N66      N         COMP 14                       66
0828 C  N68      N         COMP 15                       68
0829 C  N70      N         COMP 16                       70
0830 C  N72      N         COMP 17                       72
0831 C  N74      N         COMP 18                       74
0832 C  N76      N         COMP 19                       76
0833 C  N78      N         COMP 20                       78
0834 C  N80      N         COMP 21                       80
0835 C  N82      N         COMP 22                       82
0836 C  N84      N         COMP 23                       84
0837 C  N86      N         COMP 24                       86
0838 C  N88      N         COMP 25                       88
0839 C*
0840 C*    MOVE ERROR CODE INTO ARRAY
0841 C  N20N21N22S         ADD  1         S
0842 C  N20N21N22          MOVE '238'     ERCD,S
0843 C*
0844 C                     ENDSR
0845 C********************************************************************
0846 C*    SR TO SET INDICATOR FOR INVALID RATE
0847 C           SETN2     BEGSR                           *** SETN2 ***
0848 C*
0849 C  N43      N         COMP 2                        43
0850 C  N45      N         COMP 3                        45
0851 C  N47      N         COMP 4                        47
0852 C  N49      N         COMP 5                        49
0853 C  N51      N         COMP 6                        51
0854 C  N53      N         COMP 7                        53
0855 C  N55      N         COMP 8                        55
0856 C  N57      N         COMP 9                        57
0857 C  N59      N         COMP 10                       59
0858 C  N61      N         COMP 11                       61
0859 C  N63      N         COMP 12                       63
0860 C  N65      N         COMP 13                       65
0861 C  N67      N         COMP 14                       67
0862 C  N69      N         COMP 15                       69
0863 C  N71      N         COMP 16                       71
0864 C  N73      N         COMP 17                       73
0865 C  N75      N         COMP 18                       75
0866 C  N77      N         COMP 19                       77
0867 C  N79      N         COMP 20                       79
0868 C  N81      N         COMP 21                       81
0869 C  N83      N         COMP 22                       83
0870 C  N85      N         COMP 23                       85
0871 C  N87      N         COMP 24                       87
0872 C  N89      N         COMP 25                       89
0873 C*
0874 C*    ONLY ONE W11 ERROR CODE IS OUTPUT
0875 C   20
0876 COR 21
0877 COR 22
0878 CORN29 39             GOTO ENDS2
0879 C*
0880 C*    MOVE ERROR CODE INTO ARRAY
0881 C           S         ADD  1         S
0882 C   29                MOVE '234'     ERCD,S
0883 C   28N29             MOVE 'W11'     ERCD,S
     C   28N29             SETON                     39
0885 C*
0886 C           ENDS2     ENDSR
0887 C********************************************************************
0888 C*    SR TO SET INDICATORS FOR INITIAL SCREEN OUTPUT
0889 C           SFOUT     BEGSR                           *** SFOUT ***
0890 C*
0891 C                     SETOF                     131435
0892 C                     SETOF                     3637
0893 C                     SETON                     303134
0894 C*
0895 C                     MOVE 'SF'      SCRN
0896 C                     ENDSR
0897 C*
0898 C********************************************************************
0899 C*    SR TO SET INDICATORS FOR INSERT SCREEN OUTPUT
0900 C           SIOUT     BEGSR                           *** SIOUT ***
0901 C*
0902 C                     SETOF                     131430
0903 C                     SETOF                     313436
0904 C                     SETOF                     37
0905 C                     SETON                     35
0906 C*
0907 C                     MOVE 'SI'      SCRN
0908 C                     ENDSR
0909 C*
0910 C********************************************************************
0911 C*    SR TO SET INDICATORS FOR AMEND SCREEN OUTPUT
0912 C           SAOUT     BEGSR                           *** SAOUT ***
0913 C*
0914 C                     SETOF                     143031
0915 C                     SETOF                     343637
0916 C                     SETON                     1335
0917 C*
0918 C                     MOVE 'SA'      SCRN
0919 C                     ENDSR
0920 C*
0921 C********************************************************************
0922 C*    SR TO SET INDICATORS FOR DELETE SCREEN OUTPUT
0923 C           SDOUT     BEGSR                           *** SDOUT ***
0924 C*
0925 C                     SETOF                     143034
0926 C                     SETOF                     3637
0927 C                     SETON                     133135
0928 C*
0929 C                     MOVE 'SD'      SCRN
0930 C                     ENDSR
0931 C*
0932 C********************************************************************
0933 C*    SR TO SET INDICATORS FOR ENQUIRY SCREEN OUTPUT
0934 C           SEOUT     BEGSR                           *** SEOUT ***
0935 C*
0936 C                     SETOF                     143035
0937 C                     SETOF                     3637
0938 C                     SETON                     133134
0939 C*
0940 C                     MOVE 'SF'      SCRN
0941 C                     ENDSR
0942 C*
      **  Subroutine to Calculate Exchange Rates                          CEU026
      /COPY ZSRSRC,ZXRATEZ1                                               CEU026
     C********************************************************************
     C**   FILE EXCEPTION / ERROR HANDLING SUBROUTINE
     C           INFSR     BEGSR
     C**   CHECK ERROR TYPE
     C           STATUS    IFEQ 01021
     C**   CHAIN FILE TO GET CURRENT DETAILS
     C           FRTKEY    CHAINFWDRT                26
     C**
     C           *IN26     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED BY ANOTHER WORKSTATION' INDICATOR
     C                     SETON                     29
     C**   RESET OTHER INDICATORS
     C                     SETOF                     444647
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ENDSREXTTAG
 671 C********************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C           @RUN      IFEQ *BLANK
     C                     MOVE 'Y'       @RUN    1
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     END
     C*
     C                     ENDSR
0597 C*****************************************************************
     O*L0090FMD        38NLR                                              S01432
     ODL0090FAD        38NLR                                              S01432
0944 O                                   K8 'DL0090F1'
     O                         *IN30      1
     O                         *IN40      2
     O                         *IN31      3
     O                         *IN41      4
     O                         *IN25      5
     O**************************IN42      5                               CEU026
     O**************************IN43      6                               CEU026
     O**************************IN44      7                               CEU026
     O**************************IN45      8                               CEU026
     O**************************IN46      9                               CEU026
     O**************************IN47     10                               CEU026
     O**************************IN48     11                               CEU026
     O**************************IN49     12                               CEU026
     O**************************IN50     13                               CEU026
     O**************************IN51     14                               CEU026
     O**************************IN52     15                               CEU026
     O**************************IN53     16                               CEU026
     O**************************IN54     17                               CEU026
     O**************************IN55     18                               CEU026
     O**************************IN56     19                               CEU026
     O**************************IN57     20                               CEU026
     O**************************IN58     21                               CEU026
     O**************************IN59     22                               CEU026
     O**************************IN60     23                               CEU026
     O**************************IN61     24                               CEU026
     O**************************IN62     25                               CEU026
     O**************************IN63     26                               CEU026
     O**************************IN64     27                               CEU026
     O**************************IN65     28                               CEU026
     O**************************IN66     29                               CEU026
     O**************************IN67     30                               CEU026
     O**************************IN68     31                               CEU026
     O**************************IN69     32                               CEU026
     O**************************IN70     33                               CEU026
     O**************************IN71     34                               CEU026
     O**************************IN72     35                               CEU026
     O**************************IN73     36                               CEU026
     O**************************IN74     37                               CEU026
     O**************************IN75     38                               CEU026
     O**************************IN76     39                               CEU026
     O**************************IN77     40                               CEU026
     O**************************IN78     41                               CEU026
     O**************************IN79     42                               CEU026
     O**************************IN80     43                               CEU026
     O**************************IN81     44                               CEU026
     O**************************IN82     45                               CEU026
     O**************************IN83     46                               CEU026
     O**************************IN84     47                               CEU026
     O**************************IN85     48                               CEU026
     O**************************IN86     49                               CEU026
     O**************************IN87     50                               CEU026
     O**************************IN88     51                               CEU026
     O**************************IN89     52                               CEU026
     O**************************IN32     53                               CEU026
     O**************************IN33     54                               CEU026
     O**************************IN35     55                               CEU026
     O**************************IN36     56                               CEU026
     O**************************IN34     57                               CEU026
     O**************************IN37     58                               CEU026
0945 O*************************SCRN      60                               CEU026
0946 O*************************MTIME     68 '  .  .  '                    CEU026
0947 O*************************WSID      71                               CEU026
0948 O*************************ACTNX     72                               CEU026
0949 O*************************CCYS      75                               CEU026
0950 O*****************13      DATA1    275                               CEU026
0951 O*****************13      DATA2    475                               CEU026
     O                         *IN42      6                               CEU026
     O                         *IN43      7                               CEU026
     O                         *IN44      8                               CEU026
     O                         *IN45      9                               CEU026
     O                         *IN46     10                               CEU026
     O                         *IN47     11                               CEU026
     O                         *IN48     12                               CEU026
     O                         *IN49     13                               CEU026
     O                         *IN50     14                               CEU026
     O                         *IN51     15                               CEU026
     O                         *IN52     16                               CEU026
     O                         *IN53     17                               CEU026
     O                         *IN54     18                               CEU026
     O                         *IN55     19                               CEU026
     O                         *IN56     20                               CEU026
     O                         *IN57     21                               CEU026
     O                         *IN58     22                               CEU026
     O                         *IN59     23                               CEU026
     O                         *IN60     24                               CEU026
     O                         *IN61     25                               CEU026
     O                         *IN62     26                               CEU026
     O                         *IN63     27                               CEU026
     O                         *IN64     28                               CEU026
     O                         *IN65     29                               CEU026
     O                         *IN66     30                               CEU026
     O                         *IN67     31                               CEU026
     O                         *IN68     32                               CEU026
     O                         *IN69     33                               CEU026
     O                         *IN70     34                               CEU026
     O                         *IN71     35                               CEU026
     O                         *IN72     36                               CEU026
     O                         *IN73     37                               CEU026
     O                         *IN74     38                               CEU026
     O                         *IN75     39                               CEU026
     O                         *IN76     40                               CEU026
     O                         *IN77     41                               CEU026
     O                         *IN78     42                               CEU026
     O                         *IN79     43                               CEU026
     O                         *IN80     44                               CEU026
     O                         *IN81     45                               CEU026
     O                         *IN82     46                               CEU026
     O                         *IN83     47                               CEU026
     O                         *IN84     48                               CEU026
     O                         *IN85     49                               CEU026
     O                         *IN86     50                               CEU026
     O                         *IN87     51                               CEU026
     O                         *IN88     52                               CEU026
     O                         *IN89     53                               CEU026
     O                         *IN32     54                               CEU026
     O                         *IN33     55                               CEU026
     O                         *IN35     56                               CEU026
     O                         *IN36     57                               CEU026
     O                         *IN34     58                               CEU026
     O                         *IN37     59                               CEU026
0945 O                         SCRN      61                               CEU026
0946 O                         MTIME     69 '  .  .  '                    CEU026
0947 O                         WSID      72                               CEU026
0948 O                         ACTNX     73                               CEU026
0949 O                         CCYS      76                               CEU026
0950 O                 13      DATA1    276                               CEU026
0951 O                 13      DATA2    476                               CEU026
0951 O*******          13      DATA3    525                               S01432
0951 O*******          13      DATA3    501                        S01432 089129
0951 O*******          13      DATA3    574                        089129 CEU026
0951 O                 13      DATA3    575                               CEU026
0952 O*******          13    06DYS,1 4   80                               S01432
0953 O*******          13N01N09RTN,1 4   93                               S01432
0953 O*******          13N01 09RT7,1 4   93                               S01432
0953 O*******          13 01N09RT6,1 4   93                               S01432
     O*******          13N32   RTE,1     93                               S01432
0954 O*******          13    06DYS,2 4   98                               S01432
0955 O*******          13N01N09RTN,2 4  111                               S01432
0955 O*******          13N01 09RT7,2 4  111                               S01432
0955 O*******          13 01N09RT6,2 4  111                               S01432
     O*******          13N32   RTE,2    111                               S01432
0956 O*******          13    06DYS,3 4  116                               S01432
0957 O*******          13N01N09RTN,3 4  129                               S01432
0957 O*******          13N01 09RT7,3 4  129                               S01432
0957 O*******          13 01N09RT6,3 4  129                               S01432
     O*******          13N32   RTE,3    129                               S01432
0958 O*******          13    06DYS,4 4  134                               S01432
0959 O*******          13N01N09RTN,4 4  147                               S01432
0959 O*******          13N01 09RT7,4 4  147                               S01432
0959 O*******          13 01N09RT6,4 4  147                               S01432
     O*******          13N32   RTE,4    147                               S01432
0960 O*******          13    06DYS,5 4  152                               S01432
0961 O*******          13N01N09RTN,5 4  165                               S01432
0961 O*******          13N01 09RT7,5 4  165                               S01432
0961 O*******          13 01N09RT6,5 4  165                               S01432
     O*******          13N32   RTE,5    165                               S01432
0962 O*******          13    06DYS,6 4  170                               S01432
0963 O*******          13N01N09RTN,6 4  183                               S01432
0963 O*******          13N01 09RT7,6 4  183                               S01432
0963 O*******          13 01N09RT6,6 4  183                               S01432
     O*******          13N32   RTE,6    183                               S01432
0964 O*******          13    06DYS,7 4  188                               S01432
0965 O*******          13N01N09RTN,7 4  201                               S01432
0965 O*******          13N01 09RT7,7 4  201                               S01432
0965 O*******          13 01N09RT6,7 4  201                               S01432
     O*******          13N32   RTE,7    201                               S01432
0966 O*******          13    06DYS,8 4  206                               S01432
0965 O*******          13N01N09RTN,8 4  219                               S01432
0965 O*******          13N01 09RT7,8 4  219                               S01432
0965 O*******          13 01N09RT6,8 4  219                               S01432
     O*******          13N32   RTE,8    219                               S01432
0968 O*******          13    06DYS,9 4  224                               S01432
0965 O*******          13N01N09RTN,9 4  237                               S01432
0965 O*******          13N01 09RT7,9 4  237                               S01432
0965 O*******          13 01N09RT6,9 4  237                               S01432
     O*******          13N32   RTE,9    237                               S01432
0970 O*******          13    06DYS,104  242                               S01432
0965 O*******          13N01N09RTN,104  255                               S01432
0965 O*******          13N01 09RT7,104  255                               S01432
0965 O*******          13 01N09RT6,104  255                               S01432
     O*******          13N32   RTE,10   255                               S01432
0972 O*******          13    06DYS,114  260                               S01432
0965 O*******          13N01N09RTN,114  273                               S01432
0965 O*******          13N01 09RT7,114  273                               S01432
0965 O*******          13 01N09RT6,114  273                               S01432
     O*******          13N32   RTE,11   273                               S01432
0974 O*******          13    06DYS,124  278                               S01432
0965 O*******          13N01N09RTN,124  291                               S01432
0965 O*******          13N01 09RT7,124  291                               S01432
0965 O*******          13 01N09RT6,124  291                               S01432
     O*******          13N32   RTE,12   291                               S01432
0976 O*******          13    06DYS,134  296                               S01432
0965 O*******          13N01N09RTN,134  309                               S01432
0965 O*******          13N01 09RT7,134  309                               S01432
0965 O*******          13 01N09RT6,134  309                               S01432
     O*******          13N32   RTE,13   309                               S01432
0978 O*******          13    06DYS,144  314                               S01432
0965 O*******          13N01N09RTN,144  327                               S01432
0965 O*******          13N01 09RT7,144  327                               S01432
0965 O*******          13 01N09RT6,144  327                               S01432
     O*******          13N32   RTE,14   327                               S01432
0980 O*******          13    06DYS,154  332                               S01432
0965 O*******          13N01N09RTN,154  345                               S01432
0965 O*******          13N01 09RT7,154  345                               S01432
0965 O*******          13 01N09RT6,154  345                               S01432
     O*******          13N32   RTE,15   345                               S01432
0982 O*******          13    06DYS,164  350                               S01432
0965 O*******          13N01N09RTN,164  363                               S01432
0965 O*******          13N01 09RT7,164  363                               S01432
0965 O*******          13 01N09RT6,164  363                               S01432
     O*******          13N32   RTE,16   363                               S01432
0984 O*******          13    06DYS,174  368                               S01432
0965 O*******          13N01N09RTN,174  381                               S01432
0965 O*******          13N01 09RT7,174  381                               S01432
0965 O*******          13 01N09RT6,174  381                               S01432
     O*******          13N32   RTE,17   381                               S01432
0986 O*******          13    06DYS,184  386                               S01432
0965 O*******          13N01N09RTN,184  399                               S01432
0965 O*******          13N01 09RT7,184  399                               S01432
0965 O*******          13 01N09RT6,184  399                               S01432
     O*******          13N32   RTE,18   399                               S01432
0988 O*******          13    06DYS,194  404                               S01432
0965 O*******          13N01N09RTN,194  417                               S01432
0965 O*******          13N01 09RT7,194  417                               S01432
0965 O*******          13 01N09RT6,194  417                               S01432
     O*******          13N32   RTE,19   417                               S01432
0990 O*******          13    06DYS,204  422                               S01432
0965 O*******          13N01N09RTN,204  435                               S01432
0965 O*******          13N01 09RT7,204  435                               S01432
0965 O*******          13 01N09RT6,204  435                               S01432
     O*******          13N32   RTE,20   435                               S01432
0992 O*******          13    06DYS,214  440                               S01432
0965 O*******          13N01N09RTN,214  453                               S01432
0965 O*******          13N01 09RT7,214  453                               S01432
0965 O*******          13 01N09RT6,214  453                               S01432
     O*******          13N32   RTE,21   453                               S01432
0994 O*******          13    06DYS,224  458                               S01432
0965 O*******          13N01N09RTN,224  471                               S01432
0965 O*******          13N01 09RT7,224  471                               S01432
0965 O*******          13 01N09RT6,224  471                               S01432
     O*******          13N32   RTE,22   471                               S01432
0996 O*******          13    06DYS,234  476                               S01432
0965 O*******          13N01N09RTN,234  489                               S01432
0965 O*******          13N01 09RT7,234  489                               S01432
0965 O*******          13 01N09RT6,234  489                               S01432
     O*******          13N32   RTE,23   489                               S01432
0998 O*******          13    06DYS,244  494                               S01432
0965 O*******          13N01N09RTN,244  507                               S01432
0965 O*******          13N01 09RT7,244  507                               S01432
0965 O*******          13 01N09RT6,244  507                               S01432
     O*******          13N32   RTE,24   507                               S01432
1000 O*******          13    06DYS,254  512                               S01432
0965 O*******          13N01N09RTN,254  525                               S01432
0965 O*******          13N01 09RT7,254  525                               S01432
0965 O*******          13 01N09RT6,254  525                               S01432
     O*******          13N32   RTE,25   525                               S01432
1002 O*******                  ERCD     601                               S01432
1003 O*******                  EMES     656                               S01432
1004 O*******          14      ACTN     678                               S01432
1005 O*******          14      CCYX     681                               S01432
1009 O*
0952 O*******          13    06DYS,1 4   80                        S01432 CEU026
0952 O                 13    06DYS,1 4   81                               CEU026
     O************       N01N09RTN,1 4   93                        S01432 089129
     O************       N01 09RT7   4   93                        S01432 089129
     O************        01N09RT6   4   93                        S01432 089129
     O************       N32   RTE1      93                        S01432 089129
     O************     13    06DYS,2 4   98                        S01432 089129
     O************     13    06PNF,2 4  109                        S01432 089129
     O************     13N32   PNA,2    109                        S01432 089129
     O************     13    06SGN,2    110                        S01432 089129
     O************     13    06DYS,3 4  115                        S01432 089129
     O************     13    06PNF,3 4  126                        S01432 089129
     O************     13N32   PNA,3    126                        S01432 089129
     O************     13    06SGN,3    127                        S01432 089129
     O************     13    06DYS,4 4  132                        S01432 089129
     O************     13    06PNF,4 4  143                        S01432 089129
     O************     13N32   PNA,4    143                        S01432 089129
     O************     13    06SGN,4    144                        S01432 089129
     O************     13    06DYS,5 4  149                        S01432 089129
     O************     13    06PNF,5 4  160                        S01432 089129
     O************     13N32   PNA,5    160                        S01432 089129
     O************     13    06SGN,5    161                        S01432 089129
     O************     13    06DYS,6 4  166                        S01432 089129
     O************     13    06PNF,6 4  177                        S01432 089129
     O************     13N32   PNA,6    177                        S01432 089129
     O************     13    06SGN,6    178                        S01432 089129
     O************     13    06DYS,7 4  183                        S01432 089129
     O************     13    06PNF,7 4  194                        S01432 089129
     O************     13N32   PNA,7    194                        S01432 089129
     O************     13    06SGN,7    195                        S01432 089129
     O************     13    06DYS,8 4  200                        S01432 089129
     O************     13    06PNF,8 4  211                        S01432 089129
     O************     13N32   PNA,8    211                        S01432 089129
     O************     13    06SGN,8    212                        S01432 089129
     O************     13    06DYS,9 4  217                        S01432 089129
     O************     13    06PNF,9 4  228                        S01432 089129
     O************     13N32   PNA,9    228                        S01432 089129
     O************     13    06SGN,9    229                        S01432 089129
     O************     13    06DYS,104  234                        S01432 089129
     O************     13    06PNF,104  245                        S01432 089129
     O************     13N32   PNA,10   245                        S01432 089129
     O************     13    06SGN,10   246                        S01432 089129
     O************     13    06DYS,114  251                        S01432 089129
     O************     13    06PNF,114  262                        S01432 089129
     O************     13N32   PNA,11   262                        S01432 089129
     O************     13    06SGN,11   263                        S01432 089129
     O************     13    06DYS,124  268                        S01432 089129
     O************     13    06PNF,124  279                        S01432 089129
     O************     13N32   PNA,12   279                        S01432 089129
     O************     13    06SGN,12   280                        S01432 089129
     O************     13    06DYS,134  285                        S01432 089129
     O************     13    06PNF,134  296                        S01432 089129
     O************     13N32   PNA,13   296                        S01432 089129
     O************     13    06SGN,13   297                        S01432 089129
     O************     13    06DYS,144  302                        S01432 089129
     O************     13    06PNF,144  313                        S01432 089129
     O************     13N32   PNA,14   313                        S01432 089129
     O************     13    06SGN,14   314                        S01432 089129
     O************     13    06DYS,154  319                        S01432 089129
     O************     13    06PNF,154  330                        S01432 089129
     O************     13N32   PNA,15   330                        S01432 089129
     O************     13    06SGN,15   331                        S01432 089129
     O************     13    06DYS,164  336                        S01432 089129
     O************     13    06PNF,164  347                        S01432 089129
     O************     13N32   PNA,16   347                        S01432 089129
     O************     13    06SGN,16   348                        S01432 089129
     O************     13    06DYS,174  353                        S01432 089129
     O************     13    06PNF,174  364                        S01432 089129
     O************     13N32   PNA,17   364                        S01432 089129
     O************     13    06SGN,17   365                        S01432 089129
     O************     13    06DYS,184  370                        S01432 089129
     O************     13    06PNF,184  381                        S01432 089129
     O************     13N32   PNA,18   381                        S01432 089129
     O************     13    06SGN,18   382                        S01432 089129
     O************     13    06DYS,194  387                        S01432 089129
     O************     13    06PNF,194  398                        S01432 089129
     O************     13N32   PNA,19   398                        S01432 089129
     O************     13    06SGN,19   399                        S01432 089129
     O************     13    06DYS,204  404                        S01432 089129
     O************     13    06PNF,204  415                        S01432 089129
     O************     13N32   PNA,20   415                        S01432 089129
     O************     13    06SGN,20   416                        S01432 089129
     O************     13    06DYS,214  421                        S01432 089129
     O************     13    06PNF,214  432                        S01432 089129
     O************     13N32   PNA,21   432                        S01432 089129
     O************     13    06SGN,21   433                        S01432 089129
     O************     13    06DYS,224  438                        S01432 089129
     O************     13    06PNF,224  449                        S01432 089129
     O************     13N32   PNA,22   449                        S01432 089129
     O************     13    06SGN,22   450                        S01432 089129
     O************     13    06DYS,234  455                        S01432 089129
     O************     13    06PNF,234  466                        S01432 089129
     O************     13N32   PNA,23   466                        S01432 089129
     O************     13    06SGN,23   467                        S01432 089129
     O************     13    06DYS,244  472                        S01432 089129
     O************     13    06PNF,244  483                        S01432 089129
     O************     13N32   PNA,24   483                        S01432 089129
     O************     13    06SGN,24   484                        S01432 089129
     O************     13    06DYS,254  489                        S01432 089129
     O************     13    06PNF,254  500                        S01432 089129
     O************     13N32   PNA,25   500                        S01432 089129
     O************     13    06SGN,25   501                        S01432 089129
     O************             ERCD     576                        S01432 089129
     O************             EMES     651                        S01432 089129
     O************     14      ACTN     654                        S01432 089129
     O************     14      CCYX     657                        S01432 089129
     O*                                                                   089129
     O*****************  N01N09RTN,1 4   94                        089129 CEU026
     O*****************  N01 09RT7   4   94                        089129 CEU026
     O*****************   01N09RT6   4   94                        089129 CEU026
     O*****************  N32   RTE1      94                        089129 CEU026
     O*****************13    06DYS,2 4   99                        089129 CEU026
     O*****************13N01N09PNF,2 4  113                        089129 CEU026
     O*****************13N01 09PN7,2 4  113                        089129 CEU026
     O*****************13 01N09PN6,2 4  113                        089129 CEU026
     O*****************13N32   PNA,2    113                        089129 CEU026
     O*****************13    06SGN,2    114                        089129 CEU026
     O*****************13    06DYS,3 4  119                        089129 CEU026
     O*****************13N01N09PNF,3 4  133                        089129 CEU026
     O*****************13N01 09PN7,3 4  133                        089129 CEU026
     O*****************13 01N09PN6,3 4  133                        089129 CEU026
     O*****************13N32   PNA,3    133                        089129 CEU026
     O*****************13    06SGN,3    134                        089129 CEU026
     O*****************13    06DYS,4 4  139                        089129 CEU026
     O*****************13N01N09PNF,4 4  153                        089129 CEU026
     O*****************13N01 09PN7,4 4  153                        089129 CEU026
     O*****************13 01N09PN6,4 4  153                        089129 CEU026
     O*****************13N32   PNA,4    153                        089129 CEU026
     O*****************13    06SGN,4    154                        089129 CEU026
     O*****************13    06DYS,5 4  159                        089129 CEU026
     O*****************13N01N09PNF,5 4  173                        089129 CEU026
     O*****************13N01 09PN7,5 4  173                        089129 CEU026
     O*****************13 01N09PN6,5 4  173                        089129 CEU026
     O*****************13N32   PNA,5    173                        089129 CEU026
     O*****************13    06SGN,5    174                        089129 CEU026
     O*****************13    06DYS,6 4  179                        089129 CEU026
     O*****************13N01N09PNF,6 4  193                        089129 CEU026
     O*****************13N01 09PN7,6 4  193                        089129 CEU026
     O*****************13 01N09PN6,6 4  193                        089129 CEU026
     O*****************13N32   PNA,6    193                        089129 CEU026
     O*****************13    06SGN,6    194                        089129 CEU026
     O*****************13    06DYS,7 4  199                        089129 CEU026
     O*****************13N01N09PNF,7 4  213                        089129 CEU026
     O*****************13N01 09PN7,7 4  213                        089129 CEU026
     O*****************13 01N09PN6,7 4  213                        089129 CEU026
     O*****************13N32   PNA,7    213                        089129 CEU026
     O*****************13    06SGN,7    214                        089129 CEU026
     O*****************13    06DYS,8 4  219                        089129 CEU026
     O*****************13N01N09PNF,8 4  233                        089129 CEU026
     O*****************13N01 09PN7,8 4  233                        089129 CEU026
     O*****************13 01N09PN6,9 4  233                        089129 CEU026
     O*****************13N32   PNA,8    233                        089129 CEU026
     O*****************13    06SGN,8    234                        089129 CEU026
     O*****************13    06DYS,9 4  239                        089129 CEU026
     O*****************13N01N09PNF,9 4  253                        089129 CEU026
     O*****************13N01 09PN7,9 4  253                        089129 CEU026
     O*****************13 01N09PN6,9 4  253                        089129 CEU026
     O*****************13N32   PNA,9    253                        089129 CEU026
     O*****************13    06SGN,9    254                        089129 CEU026
     O*****************13    06DYS,104  259                        089129 CEU026
     O*****************13N01N09PNF,104  273                        089129 CEU026
     O*****************13N01 09PN7,104  273                        089129 CEU026
     O*****************13 01N09PN6,104  273                        089129 CEU026
     O*****************13N32   PNA,10   273                        089129 CEU026
     O*****************13    06SGN,10   274                        089129 CEU026
     O*****************13    06DYS,114  279                        089129 CEU026
     O*****************13N01N09PNF,114  293                        089129 CEU026
     O*****************13N01 09PN7,114  293                        089129 CEU026
     O*****************13 01N09PN6,114  293                        089129 CEU026
     O*****************13N32   PNA,11   293                        089129 CEU026
     O*****************13    06SGN,11   294                        089129 CEU026
     O*****************13    06DYS,124  299                        089129 CEU026
     O*****************13N01N09PNF,124  313                        089129 CEU026
     O*****************13N01 09PN7,124  313                        089129 CEU026
     O*****************13 01N09PN6,124  313                        089129 CEU026
     O*****************13N32   PNA,12   313                        089129 CEU026
     O*****************13    06SGN,12   314                        089129 CEU026
     O*****************13    06DYS,134  319                        089129 CEU026
     O*****************13N01N09PNF,134  333                        089129 CEU026
     O*****************13N01 09PN7,134  333                        089129 CEU026
     O*****************13 01N09PN6,134  333                        089129 CEU026
     O*****************13N32   PNA,13   333                        089129 CEU026
     O*****************13    06SGN,13   334                        089129 CEU026
     O*****************13    06DYS,144  339                        089129 CEU026
     O*****************13N01N09PNF,144  353                        089129 CEU026
     O*****************13N01 09PN7,144  353                        089129 CEU026
     O*****************13 01N09PN6,144  353                        089129 CEU026
     O*****************13N32   PNA,14   353                        089129 CEU026
     O*****************13    06SGN,14   354                        089129 CEU026
     O*****************13    06DYS,154  359                        089129 CEU026
     O*****************13N01N09PNF,154  373                        089129 CEU026
     O*****************13N01 09PN7,154  373                        089129 CEU026
     O*****************13 01N09PN6,154  373                        089129 CEU026
     O*****************13N32   PNA,15   373                        089129 CEU026
     O*****************13    06SGN,15   374                        089129 CEU026
     O*****************13    06DYS,164  379                        089129 CEU026
     O*****************13N01N09PNF,164  393                        089129 CEU026
     O*****************13N01 09PN7,164  393                        089129 CEU026
     O*****************13 01N09PN6,164  393                        089129 CEU026
     O*****************13N32   PNA,16   393                        089129 CEU026
     O*****************13    06SGN,16   394                        089129 CEU026
     O*****************13    06DYS,174  399                        089129 CEU026
     O*****************13N01N09PNF,174  413                        089129 CEU026
     O*****************13N01 09PN7,174  413                        089129 CEU026
     O*****************13 01N09PN6,174  413                        089129 CEU026
     O*****************13N32   PNA,17   413                        089129 CEU026
     O*****************13    06SGN,17   414                        089129 CEU026
     O*****************13    06DYS,184  419                        089129 CEU026
     O*****************13N01N09PNF,184  433                        089129 CEU026
     O*****************13N01 09PN7,184  433                        089129 CEU026
     O*****************13 01N09PN6,184  433                        089129 CEU026
     O*****************13N32   PNA,18   433                        089129 CEU026
     O*****************13    06SGN,18   434                        089129 CEU026
     O*****************13    06DYS,194  439                        089129 CEU026
     O*****************13N01N09PNF,194  453                        089129 CEU026
     O*****************13N01 09PN7,194  453                        089129 CEU026
     O*****************13 01N09PN6,194  453                        089129 CEU026
     O*****************13N32   PNA,19   453                        089129 CEU026
     O*****************13    06SGN,19   454                        089129 CEU026
     O*****************13    06DYS,204  459                        089129 CEU026
     O*****************13N01N09PNF,204  473                        089129 CEU026
     O*****************13N01 09PN7,204  473                        089129 CEU026
     O*****************13 01N09PN6,204  473                        089129 CEU026
     O*****************13N32   PNA,20   473                        089129 CEU026
     O*****************13    06SGN,20   474                        089129 CEU026
     O*****************13    06DYS,214  479                        089129 CEU026
     O*****************13N01N09PNF,214  493                        089129 CEU026
     O*****************13N01 09PN7,214  493                        089129 CEU026
     O*****************13 01N09PN6,214  493                        089129 CEU026
     O*****************13N32   PNA,21   493                        089129 CEU026
     O*****************13    06SGN,21   494                        089129 CEU026
     O*****************13    06DYS,224  499                        089129 CEU026
     O*****************13N01N09PNF,224  513                        089129 CEU026
     O*****************13N01 09PN7,224  513                        089129 CEU026
     O*****************13 01N09PN6,224  513                        089129 CEU026
     O*****************13N32   PNA,22   513                        089129 CEU026
     O*****************13    06SGN,22   514                        089129 CEU026
     O*****************13    06DYS,234  519                        089129 CEU026
     O*****************13N01N09PNF,234  533                        089129 CEU026
     O*****************13N01 09PN7,234  533                        089129 CEU026
     O*****************13 01N09PN6,234  533                        089129 CEU026
     O*****************13N32   PNA,23   533                        089129 CEU026
     O*****************13    06SGN,23   534                        089129 CEU026
     O*****************13    06DYS,244  539                        089129 CEU026
     O*****************13N01N09PNF,244  553                        089129 CEU026
     O*****************13N01 09PN7,244  553                        089129 CEU026
     O*****************13 01N09PN6,244  553                        089129 CEU026
     O*****************13N32   PNA,24   553                        089129 CEU026
     O*****************13    06SGN,24   554                        089129 CEU026
     O*****************13    06DYS,254  559                        089129 CEU026
     O*****************13N01N09PNF,254  573                        089129 CEU026
     O*****************13N01 09PN7,254  573                        089129 CEU026
     O*****************13 01N09PN6,254  573                        089129 CEU026
     O*****************13N32   PNA,25   573                        089129 CEU026
     O*****************13    06SGN,25   574                        089129 CEU026
     O*****************        ERCD     649                        089129 CEU026
     O*****************        EMES     724                        089129 CEU026
     O*****************14      ACTN     727                        089129 CEU026
     O*****************14      CCYX     730                        089129 CEU026
     O                   N01N09RTN,1 4   95                               CEU026
     O                   N01 09RT7   4   95                               CEU026
     O                    01N09RT6   4   95                               CEU026
     O                   N32   RTE1      95                               CEU026
     O                 13    06DYS,2 4  100                               CEU026
     O                 13N01N09PNF,2 4  114                               CEU026
     O                 13N01 09PN7,2 4  114                               CEU026
     O                 13 01N09PN6,2 4  114                               CEU026
     O                 13N32   PNA,2    114                               CEU026
     O                 13    06SGN,2    115                               CEU026
     O                 13    06DYS,3 4  120                               CEU026
     O                 13N01N09PNF,3 4  134                               CEU026
     O                 13N01 09PN7,3 4  134                               CEU026
     O                 13 01N09PN6,3 4  134                               CEU026
     O                 13N32   PNA,3    134                               CEU026
     O                 13    06SGN,3    135                               CEU026
     O                 13    06DYS,4 4  140                               CEU026
     O                 13N01N09PNF,4 4  154                               CEU026
     O                 13N01 09PN7,4 4  154                               CEU026
     O                 13 01N09PN6,4 4  154                               CEU026
     O                 13N32   PNA,4    154                               CEU026
     O                 13    06SGN,4    155                               CEU026
     O                 13    06DYS,5 4  160                               CEU026
     O                 13N01N09PNF,5 4  174                               CEU026
     O                 13N01 09PN7,5 4  174                               CEU026
     O                 13 01N09PN6,5 4  174                               CEU026
     O                 13N32   PNA,5    174                               CEU026
     O                 13    06SGN,5    175                               CEU026
     O                 13    06DYS,6 4  180                               CEU026
     O                 13N01N09PNF,6 4  194                               CEU026
     O                 13N01 09PN7,6 4  194                               CEU026
     O                 13 01N09PN6,6 4  194                               CEU026
     O                 13N32   PNA,6    194                               CEU026
     O                 13    06SGN,6    195                               CEU026
     O                 13    06DYS,7 4  200                               CEU026
     O                 13N01N09PNF,7 4  214                               CEU026
     O                 13N01 09PN7,7 4  214                               CEU026
     O                 13 01N09PN6,7 4  214                               CEU026
     O                 13N32   PNA,7    214                               CEU026
     O                 13    06SGN,7    215                               CEU026
     O                 13    06DYS,8 4  220                               CEU026
     O                 13N01N09PNF,8 4  234                               CEU026
     O                 13N01 09PN7,8 4  234                               CEU026
     O                 13 01N09PN6,9 4  234                               CEU026
     O                 13N32   PNA,8    234                               CEU026
     O                 13    06SGN,8    235                               CEU026
     O                 13    06DYS,9 4  240                               CEU026
     O                 13N01N09PNF,9 4  254                               CEU026
     O                 13N01 09PN7,9 4  254                               CEU026
     O                 13 01N09PN6,9 4  254                               CEU026
     O                 13N32   PNA,9    254                               CEU026
     O                 13    06SGN,9    255                               CEU026
     O                 13    06DYS,104  260                               CEU026
     O                 13N01N09PNF,104  274                               CEU026
     O                 13N01 09PN7,104  274                               CEU026
     O                 13 01N09PN6,104  274                               CEU026
     O                 13N32   PNA,10   274                               CEU026
     O                 13    06SGN,10   275                               CEU026
     O                 13    06DYS,114  280                               CEU026
     O                 13N01N09PNF,114  294                               CEU026
     O                 13N01 09PN7,114  294                               CEU026
     O                 13 01N09PN6,114  294                               CEU026
     O                 13N32   PNA,11   294                               CEU026
     O                 13    06SGN,11   295                               CEU026
     O                 13    06DYS,124  300                               CEU026
     O                 13N01N09PNF,124  314                               CEU026
     O                 13N01 09PN7,124  314                               CEU026
     O                 13 01N09PN6,124  314                               CEU026
     O                 13N32   PNA,12   314                               CEU026
     O                 13    06SGN,12   315                               CEU026
     O                 13    06DYS,134  320                               CEU026
     O                 13N01N09PNF,134  334                               CEU026
     O                 13N01 09PN7,134  334                               CEU026
     O                 13 01N09PN6,134  334                               CEU026
     O                 13N32   PNA,13   334                               CEU026
     O                 13    06SGN,13   335                               CEU026
     O                 13    06DYS,144  340                               CEU026
     O                 13N01N09PNF,144  354                               CEU026
     O                 13N01 09PN7,144  354                               CEU026
     O                 13 01N09PN6,144  354                               CEU026
     O                 13N32   PNA,14   354                               CEU026
     O                 13    06SGN,14   355                               CEU026
     O                 13    06DYS,154  360                               CEU026
     O                 13N01N09PNF,154  374                               CEU026
     O                 13N01 09PN7,154  374                               CEU026
     O                 13 01N09PN6,154  374                               CEU026
     O                 13N32   PNA,15   374                               CEU026
     O                 13    06SGN,15   375                               CEU026
     O                 13    06DYS,164  380                               CEU026
     O                 13N01N09PNF,164  394                               CEU026
     O                 13N01 09PN7,164  394                               CEU026
     O                 13 01N09PN6,164  394                               CEU026
     O                 13N32   PNA,16   394                               CEU026
     O                 13    06SGN,16   395                               CEU026
     O                 13    06DYS,174  400                               CEU026
     O                 13N01N09PNF,174  414                               CEU026
     O                 13N01 09PN7,174  414                               CEU026
     O                 13 01N09PN6,174  414                               CEU026
     O                 13N32   PNA,17   414                               CEU026
     O                 13    06SGN,17   415                               CEU026
     O                 13    06DYS,184  420                               CEU026
     O                 13N01N09PNF,184  434                               CEU026
     O                 13N01 09PN7,184  434                               CEU026
     O                 13 01N09PN6,184  434                               CEU026
     O                 13N32   PNA,18   434                               CEU026
     O                 13    06SGN,18   435                               CEU026
     O                 13    06DYS,194  440                               CEU026
     O                 13N01N09PNF,194  454                               CEU026
     O                 13N01 09PN7,194  454                               CEU026
     O                 13 01N09PN6,194  454                               CEU026
     O                 13N32   PNA,19   454                               CEU026
     O                 13    06SGN,19   455                               CEU026
     O                 13    06DYS,204  460                               CEU026
     O                 13N01N09PNF,204  474                               CEU026
     O                 13N01 09PN7,204  474                               CEU026
     O                 13 01N09PN6,204  474                               CEU026
     O                 13N32   PNA,20   474                               CEU026
     O                 13    06SGN,20   475                               CEU026
     O                 13    06DYS,214  480                               CEU026
     O                 13N01N09PNF,214  494                               CEU026
     O                 13N01 09PN7,214  494                               CEU026
     O                 13 01N09PN6,214  494                               CEU026
     O                 13N32   PNA,21   494                               CEU026
     O                 13    06SGN,21   495                               CEU026
     O                 13    06DYS,224  500                               CEU026
     O                 13N01N09PNF,224  514                               CEU026
     O                 13N01 09PN7,224  514                               CEU026
     O                 13 01N09PN6,224  514                               CEU026
     O                 13N32   PNA,22   514                               CEU026
     O                 13    06SGN,22   515                               CEU026
     O                 13    06DYS,234  520                               CEU026
     O                 13N01N09PNF,234  534                               CEU026
     O                 13N01 09PN7,234  534                               CEU026
     O                 13 01N09PN6,234  534                               CEU026
     O                 13N32   PNA,23   534                               CEU026
     O                 13    06SGN,23   535                               CEU026
     O                 13    06DYS,244  540                               CEU026
     O                 13N01N09PNF,244  554                               CEU026
     O                 13N01 09PN7,244  554                               CEU026
     O                 13 01N09PN6,244  554                               CEU026
     O                 13N32   PNA,24   554                               CEU026
     O                 13    06SGN,24   555                               CEU026
     O                 13    06DYS,254  560                               CEU026
     O                 13N01N09PNF,254  574                               CEU026
     O                 13N01 09PN7,254  574                               CEU026
     O                 13 01N09PN6,254  574                               CEU026
     O                 13N32   PNA,25   574                               CEU026
     O                 13    06SGN,25   575                               CEU026
     O                         ERCD     650                               CEU026
     O                         EMES     725                               CEU026
     O                 14      ACTN     728                               CEU026
     O                 14      CCYX     731                               CEU026
1099 O*    UPDATE FWDRT HEADER
1100 OFWDRT   E        44
1101 O                         NORE       7P
1102 O                         NINS      16P
1103 O                         NAMD      19P
1104 O                         NDEL      22P
1105 O                         NLRA      25P
     O                         BJRDNB   252P
1107 O                         ACTNX    253
1108 O                         NATN     256P
1109 O*
1110 O*    ADD FWDRT DETAIL
1111 OFWDRTFE EADD     46 03N07
1112 O                                    1 'D'
1113 O                         CCYS       4
1114 O                         DAY       79P
1115 O                         RAT      254P
     O                         BJRDNB   257P
1117 O                         ACTNX    258
1118 O                         NATN     261P
     O************             PNT      411P                       S01432 089129
     O                         SIG      436                               S01432
     O                         PNT      611P                              089129
     O                         RPRL     612                                                   CSD006
     O                         TSTAMP   638                                                   CSD006
     O                         DFTS     646P                                                  CSD006
     O                         FOID     666                                                   CSD006
     O                         AFOI     686                                                   CSD006
     O                         DREQ     718                                                   CSD006
     O                         FWRT     719                                                   CSD006
1119 O*
1120 O*    UPDATE/DELETE FWDRT DETAIL
1121 OFWDRT   E        46N03
1122 O       OR        46 03 07
1123 O                                    1 'D'
1124 O                 05                 1 '*'
1125 O                N05      DAY       79P
1126 O                N05      RAT      254P
     O                         BJRDNB   257P
1128 O                         ACTNX    258
1129 O                         NATN     261P
     O************    N05      PNT      411P                       S01432 089129
     O                N05      SIG      436                               S01432
     O                N05      PNT      611P                              089129
     O                         RPRL     612                                                   CSD006
     O                         TSTAMP   638                                                   CSD006
     O                         DFTS     646P                                                  CSD006
     O                         FOID     666                                                   CSD006
     O                         AFOI     686                                                   CSD006
     O                         DREQ     718                                                   CSD006
     O                         FWRT     719                                                   CSD006
     O*
     O*   RELEASE FWDRT FILE
     O        E        47
     O*
     O/COPY WNCPYSRC,DL0090AO01
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   EMSG - ARRAY OF ERROR MESSAGES.
INVALID CMD KEY
INVALID ACTION CODE
ALREADY ON FILE
NOT ON FILE
THIS RECORD HAS BEEN UPDATED BY ANOTHER WORK STATION
**   NQD - NORMALLY QUOTED DECIMAL PLACES DIVISORS                        132903
000000001
000000010
000000100
000001000
000010000
000100000
001000000
010000000
100000000
     X/COPY WNCPYSRC,DL0090AX01
