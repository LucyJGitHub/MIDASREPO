     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Accrued interest adjustments')                *
     F********************************************************************
     F*                                                                  *
0003 F*   Midas - Dealing Module                                     *
     F*                                                                  *
     F*     DL0100 - ACCRUED INTEREST ADJUSTMENTS                        *
     F*                                                                  *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CDL099             Date 06Oct17               *
      *  Prev Amend No. CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 245692             Date 09Dec13               *
      *                 AR1096788          Date 18Mar13               *
      *                 CRE073             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 10May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 256960             Date 08Oct08               *
      *                 256795             Date 25Sep08               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 237629             Date 12Apr06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG8864            Date 05Oct05               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CAS009             Date 04May04               *
      *                 BUG6696            Date 24May05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG6696            Date 25Apr05               *
      *                 CAS008             Date 16Jun04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CDL026             Date 12Nov04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2111            Date 05May04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 050968             Date 29Oct97               *
     F*                 CAC001             DATE 01FEB96                  *
     F*                 102714             DATE 13JUN96                  *
     F*                 099755             DATE 19FEB96                  *
     F*                 CIR002             DATE 13JUN95                  *
     F*                    S01408             DATE 03AUG95               *
     F*                    S01408             DATE 24JUL95               *
     F*                    068808 (M00136)    DATE 17MAR94               *
     F*                    AUS003             DATE 30JUN92               *
     F*                    S01354             DATE 08JAN92               *
     F*                    DT0072             DATE 02MAY91               *
     F*                    LN0767             DATE 28SEP90               *
     F*                    S01117             DATE 21/08/89              *
     F*                    S01194             DATE 22/08/89              *
     F*                    S01199             DATE 07/03/89              *
     F*                    S01203             DATE 30/03/89              *
     F*                  . S01157             DATE 03/10/88              *
     F*                    E11303             DATE 08/06/88              *
     F*                    S01119             DATE 10/07/87              *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                                  *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  245692 - Incorrect validation of rates when the decimal se-  *
      *           parator in the Dealing ICD was defined as "," ins-  *
      *           tead of ".".                                        *
      *         - Applied for MD-23981.                               *
      *  AR1096788 - DLAA details should be written in core STRANF    *
      *              file instead of the new DLSTRANFPD file          *
      *              (Recompile)                                      *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  256960 - Show Interest Adjustment on Projected Acct Movement *
      *  256795 - Penalty termination of Time Deposits (CDL052).      *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  237629 - Error with CDL026 - orig functionality broken       *
      *           even if feature switched OFF as adjustments         *
      *           are still being written to unauthorised file        *
      *           DLAIAUPD. Note there is no way to authorise         *
      *           with feature off.  Apply fix for BUG8864.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG8864 - CDL026 errors with switchability                      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  BUG6696 - Unable to authorise                                *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG6696 - Make sure core files are updated in AUTH mode      *
      *            when CDL026 is ON.                                 *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CDL026 - Authorisation on Dealing Accrued Interest           *
      *           Adjustments                                         *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2111- Webfacing changes (recompile).                      *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CIR006 - Amortisation of Caps/Collars/Floors and Individual  *
      *           Compounding Swaps.                                  *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
     F*     050968 - SEND A SCREEN MESSAGE TO TELL USER IF DEALS FILE    *
     F*              WAS UPDATED. MSG DISPLAYED ON RIGHT HAND SIDE OF    *
     F*              SCREEN TO PREVENT OVER-WRITING OF OTHER MSGS.       *
     F*  CAC001  -  Profit Centre Accounting Development:                *
     F*             Add two fields 'Cost of Funds Accrual Adjustment'    *
     F*             and Sign if Analytical Accounting is installed.      *
     F*     102714 - Save INIRS before chain to file as work/screen      *
     F*              variable has same name as file field and is         *
     F*              overwritten. Restore after chain.                   *
     F*     099755 - The IRS Our/Their indicator is not updated on       *
     F*              PF/STRANF. Value is saved before CHAIN to file.     *
     F*     CIR002 - Compounding of Interest.                            *
     F*     S01408 - Addition of core hooks DL0100FFP1.                  *
     F*              Addition of core hooks DL0100FFP2.                  *
     F*              Addition of core hooks DL0100IIP1.                  *
     F*              Addition of core hooks DL0100IIP2.                  *
     F*              Addition of core hooks DL0100IIP3.                  *
     F*              Addition of core hooks DL0100IIP4.                  *
     F*              Addition of core hooks DL0100CCP2.                  *
     F*              Addition of core hooks DL0100CCP3.                  *
     F*              Addition of core hooks DL0100CCP4.                  *
     F*              Addition of core hooks DL0100CCP5.                  *
     F*              Addition of core hooks DL0100CCP6.                  *
     F*              Addition of core hooks DL0100CCP7.                  *
     F*              Addition of core hooks DL0100CCP8.                  *
     F*              Addition of core hooks DL0100CCP9.                  *
     F*              Addition of core hooks DL0100OOP2.                  *
     F*     S01408 - Addition of core hooks DL0100CCP1.                  *
     F*                                     DL0100OOP1.                  *
     F*     068808 - Return parameter on call to AOCUSTR0 changed to     *
     F*              *MSG as previously program fell over if no cust no  *
     F*              selected and cmd 3 pressed.                         *
     F*            - Also allow for ? in currency and set screen fields  *
     F*              to selected values.
     F*     AUS003 - AUSTRALIAN PRODUCT - INTEREST DATED TO CALENDER     *
     F*              MONTH END.                                          *
     F*     S01354 - Internal Funding Deals - Ignore                     *LN0767
     F*     DT0072 - Add data base error processing                      *LN0767
     F*     LN0767 - LF/STRANDL1 REPLACES INTERNALLY DESCRIBED FILE      *LN0767
     F*              STRAN                                               *LN0767
     F*     S01117 - MULTI-BRANCHING CHANGES                             *S01117
     F*     S01194 - NEW STANDING DATA CHANGES                           *S01194
     F*     S01199 - HELP SYSTEM.                                        *
     F*     S01203 - INCORPORATION CHANGES                               *S01203
     F*     S01157 - FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' INTO    *S01157
     F*              'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).         *S01157
     F*     E11303 - FOR RLV DEALS ONLY ONE SIDE SHOULD BE MANUALLY      *E11303
     F*              ADJUSTED.                                           *E11303
     F*     S01119 - VALIDATION AND UPDATE OF NEW FRA/IRS FIELD          *S01119
     F*                                                                  *
0010 F********************************************************************
0013 F***DL0100FMCF**F     215            WORKSTN      KPASS  *NOINS01119 CIR002
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0100FFP1                                           S01408
     F*                                                                   S01408
0013 F***DL0100FMCF**F     233            WORKSTN      KPASS  *NOINCIR002 CAC001
     F***DL0100FMCF  F     251            WORKSTN      KPASS  *NOIND                   CAC001 CAS005
     FDL0100FMCF  F     286            WORKSTN      KPASS  *NOIND                             CAS005
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0100FFP2                                           S01408
     F*                                                                   S01408
0017 F*EALS***UF**F*****400**6AI*****2*DISK*********                      S01119
0017 F****DEALS   UF  F     600  6AI     2 DISK                   S01119  S01117
0017 F***DEALS***UF  F    1069  6AI     2 DISK                    S01117  CAC001
0017 F***DEALS***UF  F    1224  6AI     2 DISK                                         CAC001 CAS004
     F***DEALS** UF  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UF  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UF  F    2448  6AI     2 DISK                                         CAS006 CAS008
     FDEALS   UF  F    2458  6AI     2 DISK                                                   CAS008
      *                                                                                       CAS009
     FMMEIRDL6UF  E           K        DISK         KINFSR *PSSR                              CAS009
     F                                              KCOMIT                                    CAS009
      ** Midas MM Effective Interest Rate by Tran Ref and Eff Date                            CAS009
      *                                                                                       CAS009
0018 F*STRAN***UF**F*****200************DISK                              LN0767
0018 FSTRANH  UF  E                    DISK                               LN0767
     F                                              KCOMIT
     F                                              KRECNO RRN            LN0767
0018 FSTRANF  UF  E                    DISK                               LN0767
     F                                              KCOMIT
     F                                              KRECNO RRN            LN0767
     FDLAIAUL1UF  E           K        DISK                      A                            CDL026
     F                                              KCOMIT                                    CDL026
     F            DLAIAUD0                          KRENAMEDLAIAUD1                           CDL026
      * Midas DL Accrued Interest Adjustments Unauthorised (Upd)                              CDL026
      *                                                                                      BUG6696
     FDLAIAUL0IF  E           K        DISK                           UC                     BUG6696
     F            DLAIAUD0                          KRENAMEDLAIAUDR                          BUG6696
      * Midas DL Accrued Interest Adjustments Unauthorised (Rtv)                             BUG6696
     F*                                                                                      BUG6696
     F/COPY WNCPYSRC,DL0100F001
0019 F***TABLE   IF  F      96 12AI     2 DISK                            S01194
0020 F***SNAME   IF  F     256 10AI    39 DISK                            S01194
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0023 F* 02                        - DUMMY SCREEN
0024 F* 03            DEALS FILE - HEADER
0025 F* 04                       - DETAIL,TAKINGS,LOANS,DEPOSITS
     F* 13               MATURED - DETAIL,TAKINGS,LOANS,DEPOSITS          AUS003
0026 F* 05                       - DETAIL,NEG.ASSETS PURCHASED
     F* 10                       - FRA/IRS DETAILS                        S01119
0027 F* 06                       - CATCHALL
0028 F**07*********** STRAN FILE - HEADER                                 LN0767
0029 F**08***********            - DETAIL                                 LN0767
     F* 16                       - FRA/IRS PRESENT FLAG RECORD            S01119
0030 F* 09                       - CATCHALL
0011 F* 11    USED TO CONDITION FIRST TIME PASS THROUGH RPG CALC CYCLE  *
0034 F**14*********   TABLE FILE - INST.CONT.DATA RECD.1                  S01194
0035 F**19*********                CURRENCIES TABLE                       S01194
0036 F**15*********              - CATCHALL                               S01194
0037 F* 17            SHORTNAMES FILE
0039 F* 18                            - CATCHALL
0040 F*               BLANK FIELDS ON INPUT
     F*    12         FRA/IRS PRESENT FLAG IS 'N'                         S01119
0041 F*    20         DEAL NO.
0042 F*    21         CUSTOMER NO/SHORTNAME
0043 F*    22         ADJUSTMENT AMT.
0044 F*    23         SIGN
0045 F*    24         CURRENCY
0046 F*    25         INTEREST RATE ON DEALS FILE IS ZERO
0012 F*    26         SET ON IF ERROR DURING READ FROM THE WORK STATION *
0012 F*    26         HELP INDICATOR                                    *
     F*    27         FRA/IRS DEAL TYPE                                   S01119
     F*    28         NOT FRA/IRS BUT ENTRY IN OIURS/THEIRS FIELD         S01119
0047 F*       30      ERROR CODES SET UP
0048 F*       32      NON-DISPLAY ERROR CODES/MEGS.
     F*       37      AUTHORIZE ACTION
0049 F*       40      OUTPUT BLANK INSERT SCREEN
0050 F*               BLINK FIELDS
0051 F*       41      DEAL NO.
     F*       42      DEAL MATURED WITH INT. FREQ. = 'N'                  AUS003
     F*       46      DEALS RECORD UPDATED O.K                            050968
     F*       50      OURS/THEIRS                                         S01119
0052 F*       51      CUSTOMER
0053 F*       61      ADJUSTMENT AMT.
0054 F*       63      SIGN
0055 F*       67      CURRENCY
0056 F*       44      UNSUCCESSFUL CHAIN TO DEALS FILE
0057 F********52******UNSUCCESSFUL CHAIN TO SNAME FILE                    S01194
0058 F********62***** UNSUCCESSFUL CHAIN TO TABLES FILE                   S01194
0059 F********49***** UNSUCCESSFUL CHAIN TO STRAN FILE                    LN0767
0059 F*       49      UNSUCCESSFUL CHAIN TO STRANH FILE                   LN0767
0060 F*       54      INVALID CUSTOMER NO.
0060 F*       58      IF RL DEAL WITH NO FLOOR RATE,                      E11303
     F*               ALLOW ADJ. TO ONE SIDE ONLY                         E11303
0061 F*       64      SIGN IS 'PLUS'
0062 F*       65      SIGN IS 'MINUS'
0063 F*       68      INVALID CURRENCY
0064 F*       66      ERROR CONDITION ON SCREEN INPUT
0065 F*       60      OUTPUT TO SCREEN
0066 F*       69      SUCCESSFUL LOGGING INDICATOR
     F*       71      CHAIN DLAIAUL0                                                         BUG6696
0074 F********77******OUTPUT*TO*STRAN*-*HEADER**                          LN0767
0075 F********78**********************-*DETAIL**                          LN0767
0076 F*       79      OUTPUT TO DEALS FILE - DETAIL RECORD
0077 F*       80      RELEASE DEALS FILE
0078 F*       82      STRAN FILE NEARLY FULL
0079 F*       83      STRAN FILE FULL - SETS ON U6 AND U8
     F*       90-99   STANDARD SUBROUTINE
     F*       U7&U8   DATABASE ERROR
     F*       U6&U8   STRAN FILE FULL
     F*
     E                    CPY@    1   1 80                                S01194
0080 E****                EMES    1   2 55                                S01117
0080 E                    EMES    1   4 55                                S01117
0081 E                    ERCD       19  4
0082 E                    ZA1        16  1
0083 E                    ZA2        16  1
     E*                   IRTYP   4   4  2                         S01119 S01157
     E                    IRTYP   6   6  2                                S01157
     E                    UPDT    1   1 21                                050968
0084 I**DL0100FMNS**01***2*CS***3 CI                                      S01199
     I****************************************1   1 *IN26                 S01199
0085 I****************************************2   3 SID                   S01199
0086 I****************************************4   9 INDEAL          20    S01199
0087 I***************************************10  19 INCUSN          21    S01199
0088 I***************************************20  33 INADJ           22    S01199
0089 I***************************************34  34 INSIGN          23    S01199
0090 I***************************************35  37 INCCY           24    S01199
     I***************************************38  38 INIRS          S01119 S01199
0091 I****************************************4**37*SCFLD                 S01119
0092 I****************************************2**37*LOTSCN                S01119
0091 I****************************************4  38 SCFLD          S01119 S01199
0092 I****************************************2  38 LOTSCN         S01119 S01199
0084 IDL0100FMNS  01   1 CS   2 CI                                        S01199
0085 I                                        1   2 SID                   S01199
0086 I                                        3   8 INDEAL          20    S01199
0087 I                                        9  18 INCUSN          21    S01199
0088 I                                       19  32 INADJ           22    S01199
0089 I                                       33  33 INSIGN          23    S01199
0090 I                                       34  36 INCCY           24    S01199
     I                                       37  37 INIRS                 S01199
0091 I****************************************3  37 SCFLD          S01199 CIR002
0092 I****************************************1  37 LOTSCN         S01199 CIR002
     I                                       38  51 SUSIT                 CIR002
     I                                       52  52 SSIGN                 CIR002
     I                                       53  66 SCFAA                 CAC001
     I                                       67  67 SCFAS                 CAC001
     I                                       68  81 #1AINN                                    CAS005
     I                                       82  82 #1AINS                                    CAS005
     I                                       83  96 #1XINB                                    CAS005
     I                                       97  97 #1XINS                                    CAS005
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0100IIP1                                           S01408
     I*                                                                   S01408
     I***********                             3  52 SCFLD          CIR002 CAC001
     I***********                             1  52 LOTSCN         CIR002 CAC001
     I**********                              3  67 SCFLD                              CAC001 CAS005
     I**********                              1  67 LOTSCN                             CAC001 CAS005
     I                                        3  97 SCFLD                                     CAS005
     I                                        1  97 LOTSCN                                    CAS005
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0100IIP2                                           S01408
     F*                                                                   S01408
     I*                                                                   CIR002
0093 I        NS  02
0094 I*
0098 I*
0099 IDEALS   NS  03   1 CH
0096 I*
0097 I*    DEALS FILE - HEADER RECORD.
0100 I                                        1   1 RECI
0101 I                                        2   70DLNO
0102 I                                        8   8 RCDT
0103 I                                        9  100RCDC
0104 I**********                             11  160CNUMH                                     CSD027
0104 I                                       11  16 CNUMH                                     CSD027
0105 I                                    P 394 3960LCD
0106 I                                      397 397 CHTP
0107 I                                    P 398 4000TNLU
0108 I*
0111 I        NS  04   1 CD   8 CC
     I       OR   13   1 CM   8 CC                                        AUS003
0109 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0110 I*
0112 I                                        1   1 RECI
0113 I                                        2   70DLNO
0114 I                                        8   8 RCDT
0115 I                                        9  100RCDC
0116 I**********                             11  160CNUM                                      CSD027
0116 I                                       11  16 CNUM                                      CSD027
0117 I*****                                  17  190BRCD                  S01117
0117 I                                       17  19 BRCA                  S01117
0118 I                                       20  21 DTYP
0119 I                                       22  23 DLST
0120 I                                    P  24  260DDAT
0121 I                                    P  27  290VDAT
0122 I                                    P  30  320MDAT
0123 I                                       33  340CDAS
0124 I                                       35  38 BRKC
0125 I                                    P  39  450BAGE
0126 I                                       46  48 CCYD
0127 I                                    P  49  550PCPL
0128 I                                       56  56 INTC
0129 I                                       63  640BRTT
0130 I                                    P  65  707BRTE
0131 I                                    P  71  767RTSP
0132 I                                    P  77  827INTR
0133 I                                       83  850NOTD
0134 I                                       86 105 RNNA
0135 I**********                            106 1110CHNA                                      CSD027
0135 I                                      106 111 CHNA                                      CSD027
0136 I                                      112 1140FACT
0137 I                                      115 1160FCNO
0138 I                                    P 117 1230OPAM
0139 I                                    P 124 1308BCXR
0140 I                                    P 131 1378LCXR
0141 I                                      138 1390SDST
0142 I                                      140 151 OSDA
0143 I                                      152 161 TSTN
0144 I                                      162 1630MDST
0145 I                                      164 175 OMDA
0146 I                                      176 185 TMAN
0147 I                                      186 1910RODN
0148 I                                    P 192 1980RODA
0149 I                                      199 2040RBDN
0150 I                                    P 205 2110RBDA
0151 I                                      212 2120ICBS
0152 I                                      213 213 IPFR
0153 I                                    P 214 2200TOTI
0154 I                                    P 221 2230NIDT
0155 I                                    P 224 2260IBDT
0156 I                                    P 227 2290SLID
0157 I                                    P 230 2360AIPD
0158 I                                    P 237 2390DLRC
0159 I                                    P 240 2420IACD
0160 I                                    P 243 2490AITC
0161 I                                    P 250 2560AIAN
0162 I                                    P 257 2630AIAP
0163 I                                    P 264 2700IPRD
0164 I                                    P 271 2770IPRM
0165 I                                    P 278 2840ICTD
0166 I                                    P 294 2960DAVD
0167 I                                      297 2990DASN
0168 I                                      300 309 FACO
0169 I                                      310 344 SPI
0170 I                                      345 3460INTF
0171 I                                      370 370 DNSI
0172 I                                      371 371 DSTI
0173 I                                      372 372 CNFI
0174 I                                      373 373 ACEI
0175 I                                      374 374 TLXI
0176 I                                    P 391 3930ORED
0177 I                                    P 394 3960LCD
0178 I                                      397 397 CHTP
0179 I                                    P 398 4000TNLU
0180 I                                      394 400 LUD
0180 I                                     10571059 ORBR                  S01117
0180 I                                     11621165 FPRC                  CAC001
0180 I                                    P119412000ACAN                  CAC001
     I                                    P168616920FSAINN                                    CAS005
0181 I                                        1 200 LOTDL1
0182 I                                      201 400 LOTDL2
0184 I*
0185 I        NS  05   1 CD   8 CD
0183 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0186 I                                        1   1 RECI
0187 I                                        2   70DLNO
0188 I                                        8   8 RCDT
0189 I                                        9  100RCDC
0190 I**********                             11  160CNUM                                      CSD027
0190 I                                       11  16 CNUM                                      CSD027
0191 I******                                 17  190BRCD                  S01117
0191 I                                       17  19 BRCA                  S01117
0192 I                                       20  21 DTYP
0193 I                                       22  23 DLST
0194 I                                    P  24  260DDAT
0195 I                                    P  27  290VDAT
0196 I                                    P  30  320MDAT
0197 I                                       33  340IDAS
0198 I                                       35  38 BRKC
0199 I                                    P  39  450BAGE
0200 I                                       46  48 CCYD
0201 I                                    P  49  550PUPR
0202 I                                    P  57  627YRAT
0203 I                                    P  71  767RTSP
0204 I                                    P  77  827INTR            25
0205 I                                       86 105 RNNA
0206 I**********                            106 1110PCUS                                      CSD027
0206 I                                      106 111 PCUS                                      CSD027
0207 I                                      112 1140FACT
0208 I                                      115 1160FCNO
0209 I                                    P 117 1230FVAL
0210 I                                    P 124 1308BCXR
0211 I                                    P 131 1378LCXR
0212 I                                      138 1390SDST
0213 I                                      140 151 OSDA
0214 I                                      152 161 TSTN
0215 I                                      162 1630MDST
0216 I                                      164 175 OMDA
0217 I                                      176 185 TMAN
0218 I                                    P 192 1980DISA
0219 I                                    P 205 2110DPTD
0220 I                                      212 2120ICBS
0221 I                                      213 213 IPFR
0222 I                                    P 214 2200TOTI
0223 I                                    P 221 2230NIDT
0224 I                                    P 224 2260IBDT
0225 I                                    P 227 2290SLID
0226 I                                    P 230 2360AIPD
0227 I                                    P 237 2390DLRC
0228 I                                    P 240 2420IACD
0229 I                                    P 243 2490AITC
0230 I                                    P 250 2560AIAN
0231 I                                    P 257 2630AIAP
0232 I                                    P 264 2700IPRD
0233 I                                    P 271 2770IPRM
0234 I                                    P 278 2840SAPR
0235 I                                      285 2900ASDN
0236 I                                    P 291 2930SADT
0237 I                                    P 294 2960DAVD
0238 I                                      297 2990DASN
0239 I                                      300 309 FACO
0240 I                                      310 344 SPI
0241 I                                      345 3460INTF
0242 I                                      370 370 DNSI
0243 I                                      371 371 DSTI
0244 I                                      372 372 CNFI
0245 I                                      373 373 ACEI
0246 I                                      374 374 TLXI
0247 I                                    P 391 3930ORED
0248 I                                    P 394 3960LCD
0249 I                                      397 397 CHTP
0250 I                                    P 398 4000TNLU
0251 I                                      394 400 LUD
0251 I                                     10371039 ORBR                  S01117
     I                                     10761079 FPRC                  CAC001
     I                                    P110811140ACAN                  CAC001
     I                                    P121712230FSAINN                                    CAS005
0252 I                                        1 200 LOTDL1
0253 I                                      201 400 LOTDL2
     I*                                                                   S01119
     I*                                                                   S01119
     IDEALS   NS  10   1 CD   8 CG                                        S01119
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I******                                 17  190BRCD           S01119 S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I                                       64  650UBRTT                 S01119
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I                                      208 2090TBRTT                 S01119
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I                                      372 383 URACC                 S01119
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I                                      396 407 UPACC                 S01119
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
0251 I                                      603 605 ORBR                  S01117
     I                                      616 616 UINPM                 CIR006
     I                                      620 620 TINPM                 CIR006
     I                                    P 656 6630OUSI                  CIR002
     I                                    P 664 6710OUSA                  CIR002
     I                                    P 672 6790TUSI                  CIR002
     I                                    P 680 6870TUSA                  CIR002
     I                                    P228322890FSUINB                                    CAS005
     I                                    P236223680FSTINB                                    CAS005
     I                                        1 200 LOTDL1                S01119
     I                                      201 400 LOTDL2                S01119
     I                                      401 600 LOTDL3                S01119
0254 I** CATCHALL
0255 I        NS  06
0256 I*
0257 I*
0258 I*****SINGLE*ITEM*TRANSACTIONS*FILE*-*HEADER*RECORD***
0259 I*
0260 I*STRAN***NS**07***1*CH***                                           LN0767
0261 I**********                              1   1 RECI                  LN0767
0262 I**********                              2   60NAVT                  LN0767
0263 I**********                              7  110MNT                   LN0767
0264 I**********                          P  12  140NORC                  LN0767
0265 I**********                          P  15  170NOMA                  LN0767
0266 I**********                          P  18  250HMAW                  LN0767
0267 I**********                          P  26  270HMAD                  LN0767
0268 I**********                          P  67  690NOID                  LN0767
0269 I**********                          P  70  770HDIW                  LN0767
0270 I**********                          P  79  800HDID                  LN0767
0271 I**********                          P  81  830NODD                  LN0767
0272 I**********                          P  84  910HDDW                  LN0767
0273 I**********                          P  92  930HDDD                  LN0767
0274 I**********                          P  94  960NOIC                  LN0767
0275 I**********                          P  97 1040HCIW                  LN0767
0276 I**********                          P 105 1060HCID                  LN0767
0277 I**********                          P 107 1090NODC                  LN0767
0278 I**********                          P 110 1170HCDW                  LN0767
0279 I**********                          P 118 1190HCDD                  LN0767
0280 I**********                          P 120 1220NOIF                  LN0767
0281 I**********                          P 123 1300HFIW                  LN0767
0282 I**********                          P 131 1320HFID                  LN0767
0283 I**********                          P 133 1350NODF                  LN0767
0284 I**********                          P 136 1430HFDW                  LN0767
0285 I**********                          P 144 1450HFDD                  LN0767
0286 I**********                          P 195 1970RRNT                  LN0767
0287 I**********                          P 198 2000TNLU                  LN0767
0288 I**********                              1 200 STLOT                 LN0767
0289 I*
0290 I*****SINGLE*ITEM*TRANSACTIONS*FILE*-*DETAIL*RECORD.***              LN0767
0291 I*****MANUAL*ADJUSTMENT*TO*ACCRUED*INTEREST*-*DEALS.***              LN0767
0292 I*
0293 I********NS**08***1*CF*****                                          LN0767
0294 I***********                             1   1 RECI                  LN0767
0295 I***********                             2   70DLNO                  LN0767
0296 I***********                             8  130CNUM                  LN0767
0297 I***********                            14  16 CCY                   LN0767
0298 I***********                         P  17  230MAAM                  LN0767
0299 I***********                            24  24 SIGN                  LN0767
0300 I***********                            25  26 DTYP                  LN0767
     I***********                            27  27 INIRS          S01119 LN0767
0301 I***********                           189 1940UDTM                  LN0767
0302 I***********                         P 195 1970RRNT                  LN0767
0303 I***********                         P 198 2000TNLU                  LN0767
0304 I**
0305 I***CATCHALL****                                                     LN0767
0306 I********NS**09**                                                    LN0767
0307 I**
0308 I*
0358 I*****                                                               S01194
0359 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0360 I*****                                                               S01194
0361 I*****TABLE   NS  14   2 C0   3 C1  12 C1                            S01194
0362 I*****  AND      13 C0                                               S01194
0363 I*****                                   1   1 RECI                  S01194
0364 I*****                                   2   30RECT                  S01194
0365 I*****                                  12  130RCDE                  S01194
0366 I*****                                  14  66 TITL                  S01194
0367 I*****                                  67  67 DATF                  S01194
0368 I*****                                  68  700DFBR                  S01194
0369 I*****                                  74  74 MODI1                 S01194
0370 I*****                                  75  75 MODI2                 S01194
0371 I*****                                  76  76 MODI3                 S01194
0372 I*****                               P  77  790RUND                  S01194
0373 I*****                                  80  86 RUNA                  S01194
0374 I*****                                  87  870SFLG                  S01194
0375 I*****                               P  90  920LCD                   S01194
0376 I*****                                  93  93 CHTP                  S01194
0377 I*****                               P  94  960TNLU                  S01194
0378 I*****                                                               S01194
0379 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0380 I*****                                                               S01194
0381 I*****   NS  19   1 CD   2 C2   3 C0                                 S01194
0382 I*****  AND      13 C1                                               S01194
0383 I*****                                   1   1 RECI                  S01194
0384 I*****                                   2   30RECT                  S01194
0385 I*****                                  10  12 CCY                   S01194
0386 I*****                                  13  130SREC                  S01194
0387 I*****                                  14  27 CCNM                  S01194
0388 I*****                               P  28  348SPOT                  S01194
0389 I*****                                  35  37 CCYS                  S01194
0390 I*****                                  38  380CDP                   S01194
0391 I*****                                  39  390TNOT                  S01194
0392 I*****                                  40  40 DCCY                  S01194
0393 I*****                                  41  44 SRC1                  S01194
0394 I*****                                  45  48 SRC2                  S01194
0395 I*****                                  49  520TACC                  S01194
0396 I*****                                  53  560TEQV                  S01194
0397 I*****                                  57  600SWQV                  S01194
0398 I*****                                  61  640TAC4                  S01194
0399 I*****                                  65  680TAC5                  S01194
0400 I*****                                  69  69 HIND                  S01194
0401 I*****                               P  70  768PART                  S01194
0402 I*****                                  77  780SSNO                  S01194
0403 I*****                               P  79  858ERLC                  S01194
0404 I*****                               P  90  920LCD                   S01194
0405 I*****                                  93  93 CHTP                  S01194
0406 I*****                               P  94  960TNLU                  S01194
0378 I*****                                                               S01119
0379 I*****TABLE FILE - FRA/IRS PRESENT FLAG                       S01119 S01194
0380 I*****                                                        S01119 S01194
0381 I*****   NS  16   3 C1  12 C4  13 C0                          S01119 S01194
0383 I*****                                   1   1 RECI           S01119 S01194
0384 I*****                                  14  14 IRFRA          S01119 S01194
0407 I*****                                                               S01194
0408 I*****ATCHALL                                                        S01194
0409 I*****   NS  15                                                      S01194
0410 I*****
0423 I*
0424 I*****SNAME   NS  17   1 CD                                          S01194
0422 I*****CUSTOMER SHORTNAMES FILE - DETAIL RECORD.                      S01194
0425 I*****                                   1   1 RECI                  S01194
0426 I*****                                   2   70CNUMS                 S01194
0427 I*****                                  39  48 CSNMS                 S01194
0428 I******                                 94  960BRCD           S01117 S01194
0428 I*****                                  94  96 BRCA           S01117 S01194
0429 I*****                               P 250 2520LCD                   S01194
0430 I*****                                 253 253 CHTP                  S01194
0431 I*****                               P 254 2560TNLU                  S01194
0432 I*****                                                               S01194
0433 I****CATCHALL                                                        S01194
     I*****                                                               S01194
0434 I*****   NS  18                                                      S01194
      *                                                                                       CDL026
     IDLAIAUD1                                                                                CDL026
      ** Rename Change Type                                                                   CDL026
      *                                                                                       CDL026
     I              CHTP                            WWCHTP                                    CDL026
      *                                                                                      BUG6696
     IDLAIAUDR                                                                               BUG6696
      ** Rename fields for Rtv file                                                          BUG6696
      *                                                                                      BUG6696
     I              RECI                            @@RECI                                   BUG6696
     I              DLNO                            @@DLNO                                   BUG6696
     I              CNUM                            @@CNUM                                   BUG6696
     I              CCY                             @@CCY                                    BUG6696
     I              MAAM                            @@MAAM                                   BUG6696
     I              SIGN                            @@SIGN                                   BUG6696
     I              DTYP                            @@DTYP                                   BUG6696
     I              INIRS                           @@INIR                                   BUG6696
     I              ZZ158                           @@ZZ15                                   BUG6696
     I              BRCA                            @@BRCA                                   BUG6696
     I              UDTM                            @@UDTM                                   BUG6696
     I              RRNT                            @@RRNT                                   BUG6696
     I              TNLU                            @@TNLU                                   BUG6696
     I              USIT                            @@USIT                                   BUG6696
     I              AACF                            @@AACF                                   BUG6696
     I              FSGN                            @@FSGN                                   BUG6696
     I              CHTP                            @@CHTP                                   BUG6696
     I              ATHUSR                          @@ATHU                                   BUG6696
     I**
     I** RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      254 263 USRID
     I*
     I**  DATA STRUCTURE  TO UPDATE LAST TRANSACTION NUMBER DTAARA
     I**
     IDNATN       DS                              5
     I                                        1   50FNATN
     I**
     I**
     I**   DATA STRUCTURE USED IN COMMITMENT
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTCOD
     I                                       26  35 USRIDX
     I***************************************51**86*LOTSCN                S01119
     I***************************************51  87 LOTSCN         S01119 CIR002
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0100IIP5                                           S01408
     I*                                                                   S01408
     I***********                            51 102 LOTSCN         CIR002 CAC001
     I**********                             51 117 LOTSCN                             CAC001 CAS005
     I                                       51 147 LOTSCN                                    CAS005
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0100IIP3                                           S01408
     I*                                                                   S01408
0435 I**
     I*                                                                   S01194
     IRUNDAT      DS                                                      S01194
     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01194
     I                                       13  13 @MBIN                 S01194
     I*                                                                   S01194
     I*
     I@BANK     E DSSDBANKPD                                              S01194
     I** DUMMY RECORD FORMAT FOR BANK DETAILS                             S01194
     I*                                                                   S01194
     I@CUST     E DSSDCUSTPD                                              S01194
     I** DATA STRUCTURE FOR CUSTOMER  DETAILS                             S01194
     I*                                                                   S01194
     I@MMOD     E DSSDMMODPD                                              S01194
     I** DUMMY RECORD FORMAT FOR MIDAS MODULES DETAILS                    S01194
     I*                                                                   S01194
     I*
     I@CURR     E DSSDCURRPD                                              S01194
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                         S01194
     I*                                                                   S01194
     I@GELR     E DSSDGELRPD                                              S01194
     I** DUMMY RECORD FORMAT FOR GENERAL LEDGER DETAILS                   S01194
     I*
     I@DSPF     E DSDL0100FM                                              BUG6696
     I** DUMMY RECORD FORMAT FOR display file                             BUG6696
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0100IIP4                                           S01408
     I*                                                                   S01408
     I*                                                                   CIR002
     ISCSARD    E DSSCSARDPD                                              CIR002
     I** DUMMY RECORD FORMAT FOR SAR DETAILS                              CIR002
     I*
     I@DEAL     E DSSDDEALPD                                                                  245692
     I              QQACCD                          @@ACCD                                    245692
     I** DUMMY RECORD FORMAT FOR DEALING ICD DETAILS                                          245692
     I*                                                                                       245692
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     C/EJECT
      *                                                                                       CDL026
     C           *ENTRY    PLIST                                                              CDL026
     C                     PARM           PPOPTN  1                                           CDL026
     C                     PARM           PPDLNO  60                                          CDL026
     C**********           PARM           PPCNUM  60                                   CDL026 CSD027
     C                     PARM           PPCNUM  6                                           CSD027
     C                     PARM           PPIPTM  60                                         BUG6696
     C                     PARM           PPRDNB  50                                         BUG6696
     C                     PARM           @INKC   1                                           CDL026
      *                                                                                       CDL026
     C                     CALL 'AOSARDR0'                                                    CDL026
     C                     PARM *BLANKS   @RTCD                                               CDL026
     C                     PARM '*VERIFY' @OPTN                                               CDL026
     C                     PARM 'CDL026'  @SARD                                               CDL026
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL026
      *                                                                                       CDL026
     C                     MOVE 'N'       CDL026  1                                           CDL026
     C           @RTCD     IFEQ *BLANKS                                                       CDL026
     C                     MOVE 'Y'       CDL026                                              CDL026
     C                     ELSE                                                               CDL026
      *                                                                                       CDL026
     C           @RTCD     IFNE '*NRF'                                                        CDL026
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL026
     C                     MOVEL'CDL026'  DBKEY                                               CDL026
     C                     MOVEL'10'      DBASE                                               CDL026
     C                     MOVE *ON       *INU7                                               CDL026
     C                     MOVE *ON       *INU8                                               CDL026
     C                     EXSR *PSSR                                                         CDL026
     C                     GOTO ENDPR                                                         CDL026
     C                     ENDIF                                                              CDL026
      *                                                                                       CDL026
     C                     ENDIF                                                              CDL026
      *                                                                                       CDL026
     C           *IN37     IFEQ *ON                                                          BUG6696
     C                     MOVE *OFF      *IN37                                              BUG6696
     C           *IN11     IFEQ *ON                                                          BUG6696
     C                     MOVE *OFF      *IN11                                              BUG6696
     C                     ENDIF                                                             BUG6696
     C           *IN46     IFEQ *ON                                                          BUG6696
     C                     MOVE *OFF      *IN46                                              BUG6696
     C                     ENDIF                                                             BUG6696
     C                     ENDIF                                                             BUG6696
     C           CDL026    IFEQ 'Y'                                                           CDL026
     C           PPDLNO    IFNE *ZEROS                                                        CDL026
     C********** PPCNUM    ANDNE*ZEROS                                                 CDL026 CSD027
     C           PPCNUM    ANDNE*BLANKS                                                       CSD027
     C                     MOVE *ON       *IN37                                               CDL026
     C                     ENDIF                                                              CDL026
     C                     ENDIF                                                              CDL026
     C*                                                                   S01194
     C** READ DATA AREA - RUNDAT                                          S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
     C****                                                                S01194
     C*****ALLOW*HELP                                                     S01199
     C**
     C           *IN11     IFEQ '1'
     C           *IN37     IFEQ '0'                                                           CDL026
     C************IN26     DOUEQ'0'                                       S01199
     C                     READ DL0100FM                 26
     C                     ENDIF                                                              CDL026
     C************IN26     IFEQ '1'                                       S01199
     C*********************MOVEAERCD      HERCD 160                       S01199
     C*********************MOVEL'DL0100  'HBPGM   8                       S01199
     C*********************CALL 'MHELP'                                   S01199
     C*********************PARM           HBPGM                           S01199
     C*********************PARM           HERCD                           S01199
     C*********************END                                            S01199
     C*********************END                                            S01199
     C                     GOTO MAINPR
     C                     END
0440 C**
0441 C** FIRST CYCLE PROCESSING
0442 C**
0443 C*****                EXSR ZSYSTM
     C*****                                                        S01119 S01194
     C****IF IRS/FRA PRESENT INDICATOR IS 'N' SUPRESS 'OURS/THEIRS S01119 S01194
     C*****                                                        S01119 S01194
     C*****      *IN99     IFEQ '0'                                S01119 S01194
     C*****                MOVE '  40'    ZTABKY                   S01119 S01194
     C*****      ZTABKY    CHAINTABLE                99            S01119 S01194
     C**N99      RECI      COMP 'D'                  9999          S01119 S01194
     C*****      IRFRA     COMP 'N'                      12        S01119 S01194
     C*****                END                                     S01119 S01194
0444 C***99                SETON                     U7U8                 S01194
0445 C***99                GOTO ENDPR                                     S01194
      *
     C                     MOVEACPY@      BIS@   80                       S01194
      *
     C** CALL ACCESS PROGRAM FOR BANK DETAILS                             S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR  '@RTCD   7                       S01194
     C                     PARM '*FIRST  '@OPTN   7                       S01194
     C           @BANK     PARM @BANK     DSFDY                           S01194
     C*************        PARM           @BANK                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10         ************* S01194
     C                     MOVEL'01'      DBASE   3         *DBERROR 001* S01194
     C                     MOVEL@OPTN     DBOPTN  7         ************* S01194
     C                     SETON                     U7U8                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDPR                                     S01194
     C                     END                                            S01194
     C*
0664 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
2891 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
      *                                                                   S01194
     C** CALL ACCESS PROGRAM FOR GENERAL LEDGER DETAILS                   S01194
     C**********           CALL 'AOGELRR0'                                             S01194 CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** @GELR     PARM @GELR     DSFDY                                        S01194 CGL029
     C           @GELR     PARM @GELR     DSSDY                                               CGL029
     C*********            PARM           @GELR                           S01194
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDGELRPD'DBFILE           ***************S01194
     C                     MOVEL'02'      DBASE            * DBERROR 002 *S01194
     C                     MOVEL@OPTN     DBOPTN  7        ***************S01194
     C                     SETON                     U7U8                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDPR                                     S01194
     C                     END                                            S01194
      *
     C** CALL ACCESS PROGRAM FOR MIDAS MODULES DETAILS                    S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*DBERR  '@RTCD                           S01194
     C                     PARM '*FIRST  '@OPTN                           S01194
     C           @MMOD     PARM @MMOD     DSFDY                           S01194
     C************         PARM           @MMOD                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE            ************* S01194
     C                     MOVEL'03'      DBASE             *DBERROR 003* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     SETON                     U7U8                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDPR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C**  IF IRS/FRA PRESENT INDICATOR IS 'N' SUPRESS 'OURS/THEIRS' FLAG  S01119
     C           BGFIIN    COMP 'N'                      12               S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP2                                           S01408
     C*                                                                   S01408
     C** Check if Analytical Accounting Module is switched on             CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN17                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN17                           CAC001
     C                     END                                            CAC001
     C*                                                                   CIR002
     C** Check if switchable feature CIR002 is switched on                CIR002
     C*                                                                   CIR002
     C                     CALL 'AOSARDR0'                                CIR002
     C                     PARM *BLANKS   @RTCD                           CIR002
     C                     PARM '*VERIFY' @OPTN                           CIR002
     C                     PARM 'CIR002'  @SARD   6                       CIR002
     C           SCSARD    PARM SCSARD    DSFDY                           CIR002
     C*                                                                   CIR002
     C           @RTCD     IFNE *BLANK                                    CIR002
     C           @RTCD     ANDNE'*NRF   '                                 CIR002
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR002
     C                     MOVEL'06'      DBASE            * DB ERROR 06 *CIR002
     C                     MOVEL'CIR002'  DBKEY            ***************CIR002
     C                     SETON                     U7U8                 CIR002
     C                     EXSR *PSSR                                     CIR002
     C                     GOTO ENDPR                                     CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C           @RTCD     IFEQ *BLANKS                                   CIR002
     C                     MOVE 'Y'       CIR002  1                       CIR002
     C                     MOVE '1'       *IN14                           CIR002
     C                     ELSE                                           CIR002
     C                     MOVE 'N'       CIR002                          CIR002
     C                     MOVE '0'       *IN14                           CIR002
     C                     END                                            CIR002
      *                                                                   CIR006
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD   6                       CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
     C*                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ***************CIR006
     C                     MOVEL'07'      DBASE            * DB ERROR 07 *CIR006
     C                     MOVEL'CIR006'  DBKEY            ***************CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     GOTO ENDPR                                     CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     MOVE '1'       *IN14                           CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
      ** Access SAR details to see if CAS005 is enabled.                                      CAS005
      *                                                                                       CAS005
     C                     CALL 'AOSARDR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD   7                                           CAS005
     C                     PARM '*VERIFY' POPTN   7                                           CAS005
     C                     PARM 'CAS005'  PSARD   6                                           CAS005
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       CAS005  1                                           CAS005
     C           PRTCD     IFEQ *BLANKS                                                       CAS005
     C                     MOVE 'Y'       CAS005                                              CAS005
     C                     MOVE *ON       *IN84                                               CAS005
     C                     ELSE                                                               CAS005
      *                                                                                       CAS005
     C           PRTCD     IFNE '*NRF'                                                        CAS005
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS005
     C                     MOVEL'CAS005'  DBKEY                                               CAS005
     C                     MOVEL'08'      DBASE                                               CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     GOTO ENDPR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      *                                                                                       CAS009
      ** Access SAR details to see if CAS009 is enabled.                                      CAS009
      *                                                                                       CAS009
     C                     MOVE 'N'       CAS009  1                                           CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD                                               CAS009
     C                     PARM '*VERIFY' POPTN                                               CAS009
     C                     PARM 'CAS009'  PSARD                                               CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANKS                                                       CAS009
     C                     MOVE 'Y'       CAS009                                              CAS009
     C                     ELSE                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE '*NRF'                                                        CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'CAS009'  DBKEY                                               CAS009
     C                     MOVEL'51'      DBASE                                               CAS009
     C                     MOVE *ON       *INU7                                               CAS009
     C                     MOVE *ON       *INU8                                               CAS009
     C                     EXSR *PSSR                                                         CAS009
     C                     GOTO ENDPR                                                         CAS009
     C                     ENDIF                                                              CAS009
     C                     ENDIF                                                              CAS009
     C/COPY WNCPYSRC,DL0100C002
      *                                                                                       245692
      ** Call Access Program for DEALING ICD Details                                          245692
      *                                                                                       245692
     C                     CALL 'AODEALR1'                                                    245692
     C                     PARM '*DBERR ' @RTCD   7                                           245692
     C                     PARM '*FIRST ' @OPTN   7                                           245692
     C           @DEAL     PARM @DEAL     DSSDY                                               245692
      *                                                                                       245692
     C           @RTCD     IFNE *BLANKS                                                       245692
     C                     MOVEL'SDDEALPD'DBFILE                                              245692
     C                     MOVEL'52'      DBASE                                               245692
     C                     MOVEL@OPTN     DBOPTN  7                                           245692
     C                     SETON                     U7U8                                     245692
     C                     EXSR *PSSR                                                         245692
     C                     GOTO ENDPR                                                         245692
     C                     END                                                                245692
      *                                                                                       256795
     C                     CALL 'AOSARDR0'                                                    256795
     C                     PARM *BLANKS   @RTCD                                               256795
     C                     PARM '*VERIFY' @OPTN                                               256795
     C                     PARM 'CDL052'  @SARD                                               256795
     C           SCSARD    PARM SCSARD    DSFDY                                               256795
      *                                                                                       256795
     C           @RTCD     IFEQ *BLANKS                                                       256795
     C                     MOVE 'Y'       CDL052                                              256795
     C                     ELSE                                                               256795
     C                     MOVE 'N'       CDL052  1                                           256795
     C                     ENDIF                                                              256795
      *                                                                                       256795
     C*
0446 C**
0447 C** DEFINE FIELDS
0448 C**
0449 C                     MOVE ' '       BLK150150
0450 C                     MOVE ' '       BLK3    3
0451 C                     MOVE ' '       BLK6    6
0452 C                     MOVE ' '       BLK10  10
0453 C                     MOVE ' '       BLK14  14
0454 C                     MOVE ' '       BLK16  16
0455 C                     MOVE ' '       BLK79  79
0456 C*********************MOVE*' '*******BLK34  34                       S01119
0456 C***********          MOVE ' '       BLK35  35                S01119 CAC001
     C**********           MOVE ' '       BLK65  65                                    CAC001 CAS005
     C                     MOVE *BLANKS   BLK95  95                                           CAS005
0457 C                     Z-ADD0         ZERO05  50
     C                     SETON                     1102
0458 C           MAINPR    TAG                             ** MAINPR TAG *
0459 C**
0460 C** SET INDICATOR TO CONDITION SCREEN OUTPUT
0461 C                     SETON                     60
0462 C                     EXSR SETOF
0463 C                     EXSR TIME
     C*                                                          S01203
0464 C***KE****
0464 C   KL
     C*
0465 COR 02                EXSR SCNOUT
     C*                                                          S01203
0466 C***KA***
0467 C*OR*KE**
0466 C   KC
0467 COR KL
     C*
0468 C*OR*02                GOTO ENDPR                                                        CDL026
     COR 02N37             GOTO ENDPR                                                         CDL026
0469 C***01                EXSR SRINS                                                         CDL026
     C   01                                                                                   CDL026
     COR 37                EXSR SRINS                                                         CDL026
0470 C                     EXSR TIME
0473 C   U8
     C*                                                          S01203
0474 C*OR*KA**             SETOF                     60
0474 COR KC                SETOF                     60
     C*                                                          S01203
0475 C**
0476 C           ENDPR     TAG                             ** ENDPR TAG **
0477 C**
0478 C** IF ANY ERROR CODES ARE SET UP,MOVE INTO ARRAY
0479 C**
0480 C           S         COMP 0                    30
0481 C   30                MOVEAERCD      ERCDS
0482 C           ERRMSG    COMP BLK79                    33
0483 C  N30                SETON                     32
     C*                                                          S01203
     C***KA***
     C   KC
     C*                                                          S01203
     COR U6 U8
     COR U7 U8             SETON                     LR
     C   37                RETRN                                                              CDL026
0484 C********************************************************************
0485 C**
0486 C** SUBROUTINE TO RESET SCREEN INDICATORS AND ERROR ARRAY INDEX
0487 C           SETOF     BEGSR
0488 C*********************SETOF*********************33                   S01119
     C                     SETOF                     3536                 S01119
0488 C                     SETOF                     335028               S01119
0489 C                     SETOF                     323444
0490 C                     SETOF                     415161
0491 C                     SETOF                     636740
0492 C                     SETOF                     546865
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP3                                           S01408
     C*                                                                   S01408
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C003
     C                     MOVEA'00'      *IN,15                          CIR002
     C                     END                                            CIR002
     C           *IN17     IFEQ '1'                                       CAC001
     C                     MOVEA'00'      *IN,18                          CAC001
     C                     END                                            CAC001
      *                                                                                       CAS005
      ** Reset the Net-Treasury-Rate and Base Rate adjustment fields                          CAS005
      ** indicators if CAS005 is enabled.                                                     CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE *OFF      *IN85                                               CAS005
     C                     MOVE *OFF      *IN86                                               CAS005
     C                     MOVE *OFF      *IN87                                               CAS005
     C                     MOVE *OFF      *IN88                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0493 C                     MOVE '    '    ERCD
0494 C                     MOVE BLK79     ERCDS  79
0495 C                     MOVE BLK79     ERRMSG 79
0496 C                     Z-ADD0         S       20
0497 C                     ENDSR
0498 C********************************************************************
0499 C**
0500 C**  SUBROUTINE TO OUTPUT BLANK INSERT SCREEN
0501 C**
0502 C           SCNOUT    BEGSR
     C*                                                                                       CDL026
     C           *IN37     IFEQ *OFF                                                          CDL026
     C*                                                                                       CDL026
0503 C                     MOVE 'SI'      SID
0504 C                     MOVE BLK6      INDEAL
0505 C                     MOVE BLK10     INCUSN
0506 C                     MOVE BLK14     INADJ
0507 C                     MOVE ' '       INSIGN
0508 C                     MOVE BLK3      INCCY
     C                     MOVE ' '       INIRS                           S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP4                                           S01408
     C*                                                                   S01408
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C004
0506 C                     MOVE BLK14     SUSIT                           CIR002
0507 C                     MOVE ' '       SSIGN                           CIR002
     C                     END                                            CIR002
     C           *IN17     IFEQ '1'                                       CAC001
0506 C                     MOVE BLK14     SCFAA                           CAC001
0507 C                     MOVE ' '       SCFAS                           CAC001
     C                     END                                            CAC001
      *                                                                                       CAS005
      ** Reset the Net-Treasury-Rate and Base Rate adjustment fields                          CAS005
      ** if CAS005 is enabled.                                                                CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     MOVE *BLANKS   #1AINN                                              CAS005
     C                     MOVE *BLANK    #1AINS                                              CAS005
     C                     MOVE *BLANKS   #1XINB                                              CAS005
     C                     MOVE *BLANK    #1XINS                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0509 C   82                MOVELEMES,2    ERRMSG
      *                                                                   050968
      ** DISPLAY UPDATE SUCCESSFUL, AND SET OFF INDICATOR.                050968
     C           *IN46     IFEQ '1'                                       050968
     C                     MOVE UPDT,1    ERRMSG                          050968
     C                     MOVE '0'       *IN46                           050968
     C                     END                                            050968
0510 C                     SETON                     40
     C*                                                                                       CDL026
     C                     ENDIF                                                              CDL026
     C*                                                                                       CDL026
0511 C                     ENDSR
0512 C********************************************************************
0513 C**
0514 C** SUBROUTINE TO PROCESS INSERT SCREEN
0515 C**
0516 C           SRINS     BEGSR
     C*                                                          S01203
0517 C***KA***
0518 C*OR*KE**             GOTO ENDINS
0517 C   KC
0518 COR KL                GOTO ENDINS
     C*                                                          S01203
0519 C**
0520 C** VALIDATE DEAL NO.VALUE DATE MUST BE LESS THAN RUN DATE
0521 C**
0522 C   20                SETON                     44
0523 C   20                GOTO DLERR
     C           *IN37     IFEQ *OFF                                                          CDL026
0524 C                     MOVE INDEAL    DLKEY   60
     C                     ELSE                                                               CDL026
     C                     Z-ADDPPDLNO    DLKEY                                               CDL026
     C                     ENDIF                                                              CDL026
0525 C                     SETOF                     06
0526 C           DLKEY     CHAINDEALS                44
     C  N44                MOVE DTYP      TYPE    2                       S01119
     C  N44                MOVE BRCA      STBRCA  3                       S01117
0527 C*
0528 C*    RELEASE DEALS RECORD
0529 C  N44                SETON                     80
0530 C  N44                EXSR EXCPTN
0531 C  N44                MOVE LUD       LUDSV   7
0532 C   06                SETON                     44
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP1                                           S01408
      *                                                                                       256795
      ** Prevent adjustments if penalty termination entered for this deal                     256795
      *                                                                                       256795
     C           CDL052    IFEQ 'Y'                                                           256795
     C                     Z-ADDDLKEY     @DLNO                                               256795
      *                                                                                       256795
     C                     CALL 'MM5294'                                                      256795
     C                     PARM           @DLNO   60                                          256795
     C                     PARM *BLANKS   @ERR    1                                           256795
     C                     PARM *BLANKS   @ERRM  55                                           256795
      *                                                                                       256795
     C           @ERR      IFEQ 'Y'                                                           256795
     C                     ADD  1         S                                                   256795
     C                     MOVE '1'       *IN41                                               256795
     C                     MOVEL@ERRM     ERRMSG                                              256795
     C                     GOTO DLERR                                                         256795
     C                     END                                                                256795
     C                     ENDIF                                                              256795
     C*                                                                   S01408
     C*                                                                   S01354
     C**         *IN37     IFEQ *OFF                               CDL026 BUG6696
     C           *IN37     IFEQ *ON                                       BUG6696
     C                     OPEN DLAIAUL0                                  BUG6696
     C           KAUTH1    CHAINDLAIAUL0             71                   BUG6696
     C           *IN71     IFEQ *OFF                                      BUG6696
     C                     MOVELDSPFRF    @DSPF                           BUG6696
     C                     ENDIF                                          BUG6696
     C                     CLOSEDLAIAUL0                                  BUG6696
     C                     ENDIF                                          BUG6696
     C*                                                                   BUG6696
     C** Prevent Adjustments to Internal Deals                            S01354
     C*                                                                   S01354
     C           DTYP      IFEQ 'IL'                                      S01354
     C           DTYP      OREQ 'ID'                                      S01354
     C                     MOVE '1'       *IN44                           S01354
     C                     GOTO DLERR                                     S01354
     C                     END                                            S01354
     C*                                                                   AUS003
     C** ALLOW ADJUSTMENT OF FREQ N DEAL WITH NIDT<>0                     AUS003
     C*                                                                   AUS003
     C           *IN13     IFEQ '1'                                       AUS003
     C                     SETON                         44               AUS003
     C           IPFR      IFEQ 'N'                                       AUS003
     C           NIDT      COMP *ZERO                42  44               AUS003
     C                     END                                            AUS003
     C                     END                                            AUS003
     C*                                                                   S01119
     C** IF DEAL TYPE 'FR' THEN PROCESS DIFFERENTLY                       S01119
     C*                                                                   S01119
     C           TYPE      IFEQ 'FR'                                      S01119
     C*                                                                   S01119
     C** IF VALUE DATE GREATER THAN OR EQUAL TO RUN DATE - VALID          S01119
     C*                                                                   S01119
     C*****      VDAT      IFGE RUND                               S01119 S01194
     C           VDAT      IFGE BJRDNB                                    S01194
     C*                                                                   S01119
     C** IF OUR BASE RATE TYPE IS NOT EQUAL TO 0 AND OUR INT FIX DATE     S01119
     C** IS LESS THAN THE RUN DATE OR THEIR INTEREST FIX DATE IS LESS T   S01119
     C** THAN THE RUN DATE - VALID                                        S01119
     C*                                                                   S01119
     C           UBRTT     IFNE 0                                         S01119
     C*                                                                   S01119
     C*****      UINFD     IFLT RUND                               S01119 S01194
     C           UINFD     IFLT BJRDNB                                    S01194
     C                     GOTO DATEND                                    S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C******     TINFD     IFLT RUND                               S01119 S01194
     C           TINFD     IFLT BJRDNB                                    S01194
     C                     GOTO DATEND                                    S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C           1         ADD  S         S          41                   S01119
     C                     MOVE '185'     ERCD,S           *INT FIX DATE* S01119
     C                     GOTO ENDINS                     * ERROR      * S01119
     C                     ELSE                                           S01119
     C           1         ADD  S         S          41                   S01119
     C                     MOVE '186'     ERCD,S           * VALUE DATE * S01119
     C                     GOTO ENDINS                     * ERROR      * S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C**N44******VDAT******COMP*RUND*****************44                   S01119
0534 C**N44*25*************SETON*********************44                   S01119
     C**N44**    VDAT      COMP RUND                 44    * NOT F S01119 S01194
     C  N44      VDAT      COMP BJRDNB               44    * NOT FR DEAL* S01194
0534 C  N44 25             SETON                     44    *  TYPE      * S01119
0535 C           DLERR     TAG                             ** DLERR TAG **
0536 C   44      1         ADD  S         S          41
0537 C   44                MOVE '161'     ERCD,S
0538 C   44                GOTO ENDINS
     C** IF MBIN = Y,VALIDATE BK.BR. & ORGI.BR FOR USER                   S01117
     C** VALIDATE BK.BR. FOR USER                                         S01117
     C           @MBIN     IFEQ 'Y'                        B1             S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM BRCA      ZBRCDX  3                       S01117
     C                     PARM           ERR     10                      S01117
     C           ERR       IFNE 0                          B*2            S01117
      * this booking branch invalid for user                              S01117
     C                     ADD  1         S                               S01117
     C                     MOVELEMES,3    ERRMSG                          S01117
     C                     MOVE '287'     ERCD,S                          S01117
     C                     GOTO ENDINS                                    S01117
     C                     END                             E*2            S01117
     C*                                                                   S01119
      ** Validate Orig. branch against user if Validation flag on         S01117
      *
     C           BKOBUV    IFEQ 'Y'                        B*2
     C                     CALL 'ZVOBU'                    **             S01117
     C                     PARM ORBR      ZOBRX   3        **             S01117
     C                     PARM           ERR     10       **             S01117
     C           ERR       IFNE 0                          B**3           S01117
      * this Originating branch invalid for user                          S01117
     C                     ADD  1         S                               S01117
     C                     MOVELEMES,4    ERRMSG                          S01117
     C                     MOVE '305'     ERCD,S                          S01117
     C                     GOTO ENDINS                                    S01117
     C                     END                             E**3           S01117
     C                     END                             E2             S01117
     C                     END                                            S01119
     C                     END
     C           DATEND    TAG                             * DATEND TAG * S01119
      *                                                                   S01117
0539 C**
0540 C** CHECK IF CUST.NO. 6 NUMERIC OR 10 ALPHA
0541 C**
0542 C   21                SETON                     54
0543 C   21                GOTO CUSERR
     C/COPY WNCPYSRC,DL0100C001
0544 C                     MOVELBLK16     ZFIELD
0545 C                     MOVE INCUSN    ZFIELD
0546 C                     Z-ADD6         ZADIG
0547 C                     Z-ADD0         ZADEC
0548 C                     EXSR ZALIGN
0549 C**
0550 C** NUMERIC FIELD DETECTED
0551 C**N99*****           GOTO NUMCHK                                                        CSD027
0552 C**
0553 C                     MOVE INCUSN    SNKEY  10        99 ON,NOT NUM.
0554 C***********SNKEY*****CHAINSNAME                54                   S01194
     C** CALL ACCESS PROGRAM FOR CUST DETAILS                             S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C***********          PARM '*DBERR ' @RTCD   7                 S01194068808
     C                     PARM '*MSG   ' @RTCD   7                       068808
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM INCUSN    @KEY1  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C           @CUST     PARM @CUST     DSSDY                           S01194
     C************         PARM           @CUST                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVE '1'       *IN54                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
0555 C**N54******CNUMS*****COMP CNUM                 5454                 S01194
     C**N54*****           MOVE BBCUST    @BAENB  60                                   S01194 CSD027
     C**N54*****           MOVELBBCUST    INCUSN                                       068808 CSD027
0555 C**N54***** @BAENB    COMP CNUM                 5454                              S01194 CSD027
0556 C********** NUMCHK    TAG                             ** NUMCHK TAG *                    CSD027
0557 C**N99*****           MOVELINCUSN    NUMCUS  60                                          CSD027
0558 C**N99***** NUMCUS    COMP CNUM                 5454                                     CSD027
     C  N54      BBCUST    COMP CNUM                 5454                                     CSD027
0559 C           CUSERR    TAG                             ** CUSERR TAG *
0560 C   54      1         ADD  S         S          51
0561 C   54                MOVE '192'     ERCD,S
0562 C   54                GOTO ENDINS
     C**                                                                  S01119
     C** VALIDATE OURS/THEIRS                                             S01119
     C**                                                                  S01119
     C***IF*DEAL*TYPE*IS*NOT*FRA/IRS*(FR,RS,RX,RL)*THEN*IND*MUST*BE*' '   S01119
     C** IF DEAL TYPE IS NOT FRA/IRS (FR,RS,RX,RR,RP,RF) THEN             S01157
     C** IND MUST BE ' '                                                  S01157
     C**                                                                  S01119
     C           TYPE      LOKUPIRTYP                    27               S01119
     C  N27      INIRS     COMP ' '                  2828                 S01119
     C   28      1         ADD  S         S          50                   S01119
     C   28                MOVE '183'     ERCD,S                          S01119
     C*                                                                   S01119
     C** IF DEAL TYPE IS 'FR' THEN IND DECIDED BY EFFECTIVE INT RATE      S01119
     C*                                                                   S01119
     C                     SETOF                     5657                 S01119
     C           *IN27     IFEQ '1'                                       S01119
     C           TYPE      IFEQ 'FR'                                      S01119
     C           UEINR     COMP TEINR                353635               S01119
     C   35      INIRS     COMP 'O'                  505056               S01119
     C   36      INIRS     COMP 'T'                  505057               S01119
     C   50      1         ADD  S         S                               S01119
     C   50                MOVE '184'     ERCD,S                          S01119
     C                     MOVE UCUCY     CCYD                            S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C***DEAL*TYPE*IS*'RS','RL'*OR*'RX'**********                  S01119 S01157
     C** DEAL TYPE IS 'RS','RR','RP','RF' OR 'RX'                         S01157
     C*                                                                   S01119
     C           INIRS     COMP 'O'                  505056               S01119
     C   50      INIRS     COMP 'T'                  505057               S01119
     C   50      1         ADD  S         S                               S01119
     C   50                MOVE '181'     ERCD,S                          S01119
     C                     MOVE UCUCY     CCYD                            S01119
     C*                                                                   E11303
     C**  IF DEAL TYPE IS 'RL' ALLOW MANUAL ADJUSTMENT TO ONE SIDE ONLY   E11303
     C*    (APPLICABLE IF NO FLOOR RATE PRESENT)                          E11303
     C           TYPE      IFEQ 'RL'                       B001           E11303
     C           FLRAT     ANDEQ0                                         E11303
     C                     SETOF                     58                   E11303
     C**                                                                  E11303
     C           *IN56     IFEQ '1'                        B002           E11303
     C**                                                                  E11303
     C           UBRTT     IFGT 0                          B003           E11303
     C           CLRAT     ANDLT0                                         E11303
     C                     SETON                     58                   E11303
     C                     END                             E003           E11303
     C           TBRTT     IFGT 0                          B003           E11303
     C           CLRAT     ANDGE0                                         E11303
     C                     SETON                     58                   E11303
     C                     END                             E003           E11303
     C                     END                             E002           E11303
     C**                                                                  E11303
     C           *IN57     IFEQ '1'                        B002           E11303
     C**                                                                  E11303
     C           TBRTT     IFGT 0                          B003           E11303
     C           CLRAT     ANDLT0                                         E11303
     C                     SETON                     58                   E11303
     C                     END                             E003           E11303
     C           UBRTT     IFGT 0                          B003           E11303
     C           CLRAT     ANDGE0                                         E11303
     C                     SETON                     58                   E11303
     C                     END                             E003           E11303
     C**                                                                  E11303
     C                     END                             E002           E11303
     C**                                                                  E11303
     C           *IN58     IFEQ '1'                        B002           E11303
     C           1         ADD  S         S                               E11303
     C                     MOVE '187'     ERCD,S                          E11303
     C                     END                             E002           E11303
     C**                                                                  E11303
     C                     SETOF                     58                   E11303
     C**                                                                  E11303
     C                     END                             E001           E11303
     C*                                                                   S01119
     C**  IF CROSS CURRENCY SWAP USE THEIR CURRENCY                       S01119
     C*                                                                   S01119
     C           TYPE      IFEQ 'RX'                                      S01119
     C   57                MOVE TCUCY     CCYD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
0563 C**
0564 C** VALIDATE ADJUSTMENT - OBTAIN CORRECT NO OF DECIMAL PLACES
0565 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP5                                           S01408
     C*                                                                   S01408
     C           BGN0ST    IFEQ 'Y'                                       CAC001
      *                                                                   CAC001
     C                     SELEC                                          CAC001
     C           CIR002    WHEQ 'Y'                                       CAC001
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C005
     C           *IN22     IFEQ '1'                                       CAC001
     C           SUSIT     ANDEQ*BLANKS                                   CAC001
     C           SCFAA     ANDEQ*BLANKS                                   CAC001
     C                     MOVE '1'       *IN34                           CAC001
     C                     GOTO ADJERR                                    CAC001
     C                     END                                            CAC001
     C           CIR002    WHEQ 'N'                                       CAC001
     C           CIR006    OREQ 'N'                                       CIR006
     C/COPY WNCPYSRC,DL0100C006
     C           *IN22     IFEQ '1'                                       CAC001
     C           SCFAA     ANDEQ*BLANKS                                   CAC001
     C                     MOVE '1'       *IN34                           CAC001
     C                     GOTO ADJERR                                    CAC001
     C                     END                                            CAC001
     C                     ENDSL                                          CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C007
     C*                                                                   CIR002
     C           *IN22     IFEQ '1'                                       CIR002
     C           SUSIT     ANDEQ*BLANKS                                   CIR002
     C                     MOVE '1'       *IN34                           CIR002
     C                     GOTO ADJERR                                    CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     ELSE                                           CIR002
     C*                                                                   CIR002
0566 C   22                SETON                     34
0567 C   22                GOTO ADJERR
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP6                                           S01408
     C*                                                                   S01408
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     ENDIF                           - BGN0ST='1'   CAC001
     C*                                                                   CAC001
0568 C******               MOVEL'20'      CCYKEY 12                       S01194
0569 C******               MOVELCCYD      TEMP4   4                       S01194
0570 C******               MOVE '1'       TEMP4                           S01194
0571 C******               MOVE TEMP4     CCYKEY                          S01194
0572 C******     CCYKEY    CHAINTABLE                62                   S01194
     C*                                                                   068808
     C** Allow for ? in currency                                          068808
     C*                                                                   068808
     C           INCCY     IFEQ '?  '                                     068808
     C           INCCY     OREQ ' ? '                                     068808
     C           INCCY     OREQ '  ?'                                     068808
     C                     MOVE INCCY     @AJCD                           068808
     C                     ELSE                                           068808
     C                     MOVE CCYD      @AJCD                           068808
     C                     ENDIF                                          068808
     C*                                                                   068808
     C** CALL ACCESS PROGRAM FOR CURRENCY DETAILS                         S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG    '@RTCD                           S01194
     C                     PARM '*KEY    '@OPTN                           S01194
     C***********          PARM CCYD      @AJCD   3                 S01194068808
     C                     PARM           @AJCD   3                       068808
     C           @CURR     PARM @CURR     DSSDY                           S01194
     C**********           PARM           @CURR                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C           @RTCD     ANDNE'*NOSEL '                                 068808
     C                     MOVEL'SDCURRPD'DBFILE            ************* S01194
     C                     MOVEL'03'      DBASE             *DBERROR 003* S01194
     C                     MOVEL@OPTN     DBOPTN            ************* S01194
     C                     MOVELCCYD      DBKEY  29                       S01194
     C                     SETON                     U7U8                 S01194
     C                     EXSR *PSSR                                     S01194
     C                     GOTO ENDINS                                    S01194
     C                     END                                            S01194
     C*                                                                   068808
     C** Set screen value to selected value if not *NOSEL                 068808
     C           @RTCD     IFNE '*NOSEL '                                 068808
     C           INCCY     IFEQ '?  '
     C           INCCY     OREQ ' ? '
     C           INCCY     OREQ '  ?'
     C                     MOVE @AJCD     INCCY                           068808
     C                     ENDIF                                          068808
     C                     ENDIF                                          068808
0768 C**
0573 C***62*               SETON                     U7U8                 S01194
0574 C***62*               GOTO ENDINS                                    S01194
0575 C                     MOVE BLK16     ZFIELD
0576 C                     MOVE INADJ     ZFIELD
0577 C******               Z-ADDCDP       ZADEC                           S01194
0577 C                     Z-ADDA6NBDP    ZADEC                           S01194
0578 C******     13        SUB  CDP       ZADIG                           S01194
0578 C           13        SUB  A6NBDP    ZADIG                           S01194
0579 C                     EXSR ZALIGN
0580 C  N99                MOVE ZFIELD    OTADJ  130
0581 C  N99                GOTO SGNCHK
0582 C           ADJERR    TAG                             ** ADJERR TAG *
0583 C   34
0584 COR 99      1         ADD  S         S          61
0585 C   34
0586 COR 99                MOVE '180'     ERCD,S
0587 C**
0588 C** VALIDATE SIGN
0589 C**
0590 C           SGNCHK    TAG
0591 C           INSIGN    COMP '+'                      64
0592 C  N64      INSIGN    COMP '-'                      65
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C008
     C           BGN0ST    OREQ 'Y'                                       CAC001
     C           INADJ     IFNE *BLANKS                                   CIR002
     C           INSIGN    ANDNE'+'                                       CIR002
     C           INSIGN    ANDNE'-'                                       CIR002
     C           INADJ     OREQ *BLANKS                                   CIR002
     C           INSIGN    ANDNE*BLANK                                    CIR002
     C                     MOVE '1'       *IN63                           CIR002
     C                     END                                            CIR002
     C                     ELSE                                           CIR002
0593 C  N64N65
0594 COR 23                SETON                     63
     C                     END                                            CIR002
0595 C   63      1         ADD  S         S
0596 C   63                MOVE '182'     ERCD,S
0597 C**
0598 C** VALIDATE CURRENCY
0599 C**
0600 C   24                SETON                     68
0601 C  N68      INCCY     COMP CCYD                 6868
0602 C   68      1         ADD  S         S          67
0603 C   68                MOVE '189'     ERCD,S
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP7                                           S01408
     C*                                                                   S01408
     C*                                                                   CAC001
     C** Validate COF Adjustment Amount                                   CAC001
     C*                                                                   CAC001
     C           *IN17     IFEQ '1'                                       CAC001
     C*                                                                   CAC001
     C                     Z-ADD0         OTCOF  130                      CAC001
     C*                                                                   CAC001
     C           SCFAA     IFNE *BLANKS                                   CAC001
     C*                                                                   CAC001
     C** If the deal is not directly funded, no entry is allowed          CAC001
     C** in the COF Adjustment Amount field.                              CAC001
     C*                                                                   CAC001
     C           *IN04     IFEQ '1'                                       CAC001
     C           FPRC      ANDEQ*BLANKS                                   CAC001
     C           *IN05     OREQ '1'                                       CAC001
     C           FPRC      ANDEQ*BLANKS                                   CAC001
     C           *IN10     OREQ '1'                                       CAC001
     C                     ADD  1         S                               CAC001
     C                     MOVE '200'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN18                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C** COF Adjustment Amount must be a valid amount                     CAC001
     C*                                                                   CAC001
     C           *IN18     IFEQ '0'                                       CAC001
     C           *IN67     ANDEQ'0'                                       CAC001
     C                     MOVE BLK16     ZFIELD                          CAC001
     C                     MOVE SCFAA     ZFIELD                          CAC001
     C*                                                                   CAC001
     C** CALL ACCESS PROGRAM FOR CURRENCY DETAILS                         CAC001
     C*                                                                   CAC001
     C                     CALL 'AOCURRR0'                                CAC001
     C                     PARM *BLANKS   @RTCD                           CAC001
     C                     PARM '*KEY    '@OPTN                           CAC001
     C                     PARM INCCY     @AJCD                           CAC001
     C           @CURR     PARM @CURR     DSSDY                           CAC001
     C                     Z-ADDA6NBDP    ZADEC                           CAC001
     C           13        SUB  A6NBDP    ZADIG                           CAC001
     C                     EXSR ZALIGN                                    CAC001
     C           *IN99     IFEQ '1'                                       CAC001
     C                     ADD  1         S                               CAC001
     C                     MOVE '180'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN18                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE ZFIELD    OTCOF                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                           - SCFAA        CAC001
     C*                                                                   CAC001
     C** Validate sign                                                    CAC001
     C*                                                                   CAC001
     C           SCFAS     IFNE '+'                                       CAC001
     C           SCFAS     ANDNE'-'                                       CAC001
     C           SCFAA     ANDNE*BLANKS                                   CAC001
     C           SCFAS     ORNE *BLANKS                                   CAC001
     C           SCFAA     ANDEQ*BLANKS                                   CAC001
     C                     ADD  1         S                               CAC001
     C                     MOVE '182'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN19                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                           - *IN17        CAC001
      *                                                                                       CAS005
      ** Validate the Net-Treasury-Rate and Base Rate adjustment                              CAS005
      ** fields if CAS005 is enabled.                                                         CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
      *                                                                                       CAS005
     C                     SELEC                                                              CAS005
      *                                                                                       CAS005
      ** Adj. using N-T-R validation for MM L/D or NAP deals.                                 CAS005
      *                                                                                       CAS005
     C           *IN04     WHEQ *ON                                                           CAS005
     C           *IN05     OREQ *ON                                                           CAS005
     C                     EXSR SRVANR                                                        CAS005
      *                                                                                       CAS005
     C           WDBEF     IFEQ 'Y'                                                           CAS005
     C                     GOTO ENDINS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Adj. using Base Rate validation for FRA/IRS deals.                                   CAS005
      *                                                                                       CAS005
     C           *IN10     WHEQ *ON                                                           CAS005
     C                     EXSR SRVABR                                                        CAS005
      *                                                                                       CAS005
     C           WDBEF     IFEQ 'Y'                                                           CAS005
     C                     GOTO ENDINS                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSL                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
     C*                                                                   CIR002
     C** Validate Unsettled Interest Field                                CIR002
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C009
     C                     Z-ADD0         WUSIT                           CIR002
     C*                                                                   CIR002
     C** Entry in 'Unsettled Interest' field is prohibited unless         CIR002
     C** deal type is RS, RX, RP, RF or RR.                               CIR002
     C*                                                                   CIR002
     C           DTYP      IFNE 'RS'                                      CIR002
     C           DTYP      ANDNE'RX'                                      CIR002
     C           DTYP      ANDNE'RP'                                      CIR002
     C           DTYP      ANDNE'RF'                                      CIR002
     C           DTYP      ANDNE'RR'                                      CIR002
     C*                                                                   CIR002
     C           SUSIT     IFNE *BLANKS                                   CIR002
     C           SSIGN     ORNE *BLANKS                                   CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '193'     ERCD,S                          CIR002
     C           SUSIT     IFNE *BLANKS                                   CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
     C           SSIGN     IFNE *BLANKS                                   CIR002
     C                     MOVE '1'       *IN16                           CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C                     GOTO ENDINS                                    CIR002
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C           SUSIT     IFNE *BLANKS                                   CIR002
     C*                                                                   CIR002
     C** If the 'Unsettled Interest' field is specified, the currency     CIR002
     C** and the 'Ours/Theirs' indicator must be specified.               CIR002
     C*                                                                   CIR002
     C           INIRS     IFEQ *BLANK                                    CIR002
     C           INCCY     OREQ *BLANKS                                   CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '194'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C** If 'Adjustment' is specified, 'Unsettled Interest' must be       CIR002
     C** blank.                                                           CIR002
     C*                                                                   CIR002
     C           INADJ     IFNE *BLANKS                                   CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '195'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C** If 'Unsettled Interest' is specified, the interest rate on the   CIR002
     C** leg of the deal affected must be floating (base rate type <> 0)  CIR002
     C** and its unsettled interest is not zero.                          CIR002
     C*                                                                   CIR002
     C           INIRS     IFEQ 'O'                                       CIR002
     C           OUSI      IFEQ 0                                         CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '199'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
     C           DTYP      IFEQ 'RS'                                      CIR002
     C           UBRTT     ANDEQ0                                         CIR002
     C           DTYP      OREQ 'RX'                                      CIR002
     C           UBRTT     ANDEQ0                                         CIR002
     C           DTYP      OREQ 'RP'                                      CIR006
     C           UBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RR'                                      CIR006
     C           UBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RF'                                      CIR006
     C           UBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C                     ADD  1         S                               CIR002
     C                     MOVE '196'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
      *                                                                   CIR006
      ** If Individual Compouding (CIR006) is installed, entry of         CIR006
      ** unsettled interest is allowed only for processing types          CIR006
      ** 'A', 'I', 'L'.                                                   CIR006
      *                                                                   CIR006
     C           CIR006    IFEQ 'Y'                                       CIR006
     C           UINPM     ANDNE'A'                                       CIR006
     C           UINPM     ANDNE'I'                                       CIR006
     C           UINPM     ANDNE'L'                                       CIR006
     C                     ADD  1         S                               CIR006
     C                     MOVE '201'     ERCD,S                          CIR006
     C                     MOVE '1'       *IN15                           CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   CIR002
     C           INIRS     IFEQ 'T'                                       CIR002
     C           TUSI      IFEQ 0                                         CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '199'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
     C           DTYP      IFEQ 'RS'                                      CIR002
     C           TBRTT     ANDEQ0                                         CIR002
     C           DTYP      OREQ 'RX'                                      CIR002
     C           TBRTT     ANDEQ0                                         CIR002
     C           DTYP      OREQ 'RP'                                      CIR006
     C           TBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RR'                                      CIR006
     C           TBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RF'                                      CIR006
     C           TBRTT     ANDEQ0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C                     ADD  1         S                               CIR002
     C                     MOVE '196'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     END                                            CIR002
      *                                                                   CIR006
      ** If Individual Compouding (CIR006) is installed, entry of         CIR006
      ** unsettled interest is allowed only for processing types          CIR006
      ** 'A', 'I', 'L'.                                                   CIR006
      *                                                                   CIR006
     C           CIR006    IFEQ 'Y'                                       CIR006
     C           TINPM     ANDNE'A'                                       CIR006
     C           TINPM     ANDNE'I'                                       CIR006
     C           TINPM     ANDNE'L'                                       CIR006
     C                     ADD  1         S                               CIR006
     C                     MOVE '201'     ERCD,S                          CIR006
     C                     MOVE '1'       *IN15                           CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            CIR002
     C*                                                                   CIR002
     C** 'Unsettled Interest' must be a valid amount in the specified     CIR002
     C** currency.                                                        CIR002
     C*                                                                   CIR002
     C           *IN67     IFEQ '0'                                       CIR002
     C                     MOVE BLK16     ZFIELD                          CIR002
     C                     MOVE SUSIT     ZFIELD                          CIR002
     C*                                                                   CIR002
     C** CALL ACCESS PROGRAM FOR CURRENCY DETAILS                         CIR002
     C*                                                                   CIR002
     C                     CALL 'AOCURRR0'                                CIR002
     C                     PARM '*DBERR  '@RTCD                           CIR002
     C                     PARM '*KEY    '@OPTN                           CIR002
     C                     PARM INCCY     @AJCD                           CIR002
     C           @CURR     PARM @CURR     DSSDY                           CIR002
     C                     Z-ADDA6NBDP    ZADEC                           CIR002
     C           13        SUB  A6NBDP    ZADIG                           CIR002
     C                     EXSR ZALIGN                                    CIR002
     C           *IN99     IFEQ '1'                                       CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '197'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN15                           CIR002
     C                     ELSE                                           CIR002
     C                     MOVE ZFIELD    WUSIT  130                      CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                             -SUSIT         CIR002
     C*                                                                   CIR002
     C** If no errors in 'Unsettled Interest', validate sign.             CIR002
     C*                                                                   CIR002
     C           SSIGN     IFNE '+'                                       CIR002
     C           SSIGN     ANDNE'-'                                       CIR002
     C           SUSIT     ANDNE*BLANKS                                   CIR002
     C           SSIGN     ORNE *BLANKS                                   CIR002
     C           SUSIT     ANDEQ*BLANKS                                   CIR002
     C                     ADD  1         S                               CIR002
     C                     MOVE '198'     ERCD,S                          CIR002
     C                     MOVE '1'       *IN16                           CIR002
     C                     ELSE                                           CIR002
     C           SSIGN     IFEQ '+'                                       CIR002
     C                     MOVE '1'       *IN64                           CIR002
     C                     ELSE                                           CIR002
     C           SSIGN     IFEQ '-'                                       CIR002
     C                     MOVE '1'       *IN65                           CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                             -CIR002        CIR002
0604 C**
0605 C           ENDINS    TAG                             ** ENDINS TAG *
     C*                                                                                       CDL026
     C*******              ENDIF                                                      CDL026 BUG6696
     C*                                                                                       CDL026
0606 C**
0607 C** END OF VALIDATION - IF NO ERRORS,UPDATE
0608 C**
0609 C           S         COMP 0                    66
0610 C  N66      ERRMSG    COMP BLK79                6666
0611 C   66
0612 COR U7 U8             GOTO ENDALL
0613 C**
0614 C                     EXSR UDLOG
0615 C**
0616 C** IF SUCCESSFUL EXIT,RETURN FRESH INSERT SCREEN
0617 C**
0618 C   69                EXSR SCNOUT
0619 C           ENDALL    ENDSR                           ** ENDALL **
0620 C**
0621 C********************************************************************
0622 C**
0623 C** SUBROUTINE TO UPDATE STRAN FILE
0624 C           UPDATE    BEGSR
0625 C***STRAN*HEADER*UPDATE****                                          LN0767
0625 C** STRANH HEADER UPDATE                                             LN0767
0626 C***********1         CHAINSTRAN                49                   LN0767
0626 C           1         CHAINSTRANHF              49                   LN0767
     C           *IN49     IFEQ '1'                                       DT0072
0627 C   49                SETON                     U7U8
     C                     MOVEL'STRANH  'DBFILE            ************* DT0072
     C                     MOVEL'05'      DBASE             *DBERROR 005* DT0072
     C                     EXSR *PSSR                       ************* DT0072
0628 C   49                GOTO ENDUP
     C                     END                                            DT0072
0629 C***********NAVT      ADD  1         NAVT2   50                      LN0767
     C                     Z-ADDNAVT      TNLU                            LN0767
0629 C                     ADD  1         NAVT                            LN0767
0630 C**
0631 C** MOVE ADJUSTMENT AMOUNT INTO ZZAMT FOR HASH TOTALLING
0632 C**
0632 C** OUTPUT SPECS NO LONGER USED, AMOUNTS MOVED INTO FILE FIELDS
0633 C**
0634 C**
0635 C***64******NOID      ADD  1         NOID2   50                      LN0767
0636 C***65******NODD      ADD  1         NODD2   50                      LN0767
     C           *IN64     IFEQ '1'                                       LN0767
0635 C                     ADD  1         NOID                            LN0767
     C                     END                                            LN0767
     C           *IN65     IFEQ '1'                                       LN0767
0636 C                     ADD  1         NODD                            LN0767
     C                     END                                            LN0767
0637 C                     MOVE OTADJ     ZZAMT
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           SUSIT     ANDNE*BLANKS                                   CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           SUSIT     ANDNE*BLANKS                                   CIR006
     C/COPY WNCPYSRC,DL0100C010
     C                     MOVE WUSIT     ZZAMT                           CIR002
     C                     END                                            CIR002
0638 C**
0639 C   64                Z-ADDHDIW      ZZTOTI
0640 C   64                Z-ADDHDID      ZZTOTD
0641 C   65                Z-ADDHDDW      ZZTOTI
0642 C   65                Z-ADDHDDD      ZZTOTD
0643 C                     EXSR GLZADD
0644 C***64******          Z-ADDZZTOTI    HDIW2  150                      LN0767
0645 C***64******          Z-ADDZZTOTD    HDID2   30                      LN0767
0646 C***65******          Z-ADDZZTOTI    HDDW2  150                      LN0767
0647 C***65******          Z-ADDZZTOTD    HDDD2   30                      LN0767
     C           *IN64     IFEQ '1'                                       LN0767
0644 C                     Z-ADDZZTOTI    HDIW                            LN0767
0645 C                     Z-ADDZZTOTD    HDID                            LN0767
     C                     END                                            LN0767
     C           *IN65     IFEQ '1'                                       LN0767
0646 C                     Z-ADDZZTOTI    HDDW                            LN0767
0647 C                     Z-ADDZZTOTD    HDDD                            LN0767
     C                     END                                            LN0767
     C*                                                                   CAC001
     C** If Analytical accounting is on, include Accrued COF Adjustment   CAC001
     C** to the hash totals.                                              CAC001
     C*                                                                   CAC001
     C           *IN17     IFEQ '1'                                       CAC001
     C*                                                                   CAC001
     C           SCFAS     IFEQ '+'                                       CAC001
     C                     ADD  1         NOID                            CAC001
     C                     MOVE OTCOF     ZZAMT                           CAC001
     C                     Z-ADDHDIW      ZZTOTI                          CAC001
     C                     Z-ADDHDID      ZZTOTD                          CAC001
     C                     EXSR GLZADD                                    CAC001
     C                     Z-ADDZZTOTI    HDIW                            CAC001
     C                     Z-ADDZZTOTD    HDID                            CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           SCFAS     IFEQ '-'                                       CAC001
     C                     ADD  1         NODD                            CAC001
     C                     MOVE OTCOF     ZZAMT                           CAC001
     C                     Z-ADDHDDW      ZZTOTI                          CAC001
     C                     Z-ADDHDDD      ZZTOTD                          CAC001
     C                     EXSR GLZADD                                    CAC001
     C                     Z-ADDZZTOTI    HDDW                            CAC001
     C                     Z-ADDZZTOTD    HDDD                            CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
0648 C**
     C                     UPDATSTRANHF                                   LN0767
0648 C**
0649 C           ENDUP     ENDSR
0650 C**
0651 C********************************************************************
0652 C*****                                                               S01194
0653 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0654 C*****                                                               S01194
0655 C*****      ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0656 C*****                                                               S01194
0657 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0658 C*****                MOVEL'01      'ZTABKY 12                       S01194
0659 C*****                MOVE '  10'    ZTABKY                          S01194
0660 C*****                                                               S01194
0661 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0662 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0663 C*****                                                               S01194
0664 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0665 C*****      DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0666 C*****                                                               S01194
0667 C*****                ENDSR                                          S01194
0668 C*****                                                               S01194
0669 C*****                                                               S01194
0670 C********************************************************************
0671 C**
0672 C** SUBROUTINE TO GET CORRECT TIME
0673 C**
0674 C           TIME      BEGSR
0675 C                     TIME           MTIME   60       ** TIME **
0676 C                     ENDSR
0677 C**
0678 C********************************************************************
0679 C**
0680 C** SUBROUTINE TO OUTPUT & RECORD AND SET OFF INDICATORS
0681 C**
0682 C           EXCPTN    BEGSR                           ** EXCPTN **
0683 C                     EXCPT
      *                                                                   050968
      ** SET UP INCICATOR FOR SUCCESSFUL UPDATE..                         050968
     C           *IN79     IFEQ '1'                                       050968
      *                                                                   050968
     C           *IN04     IFEQ '1'                                       050968
     C           *IN05     OREQ '1'                                       050968
     C           *IN10     OREQ '1'                                       050968
     C           *IN42     OREQ '1'                                       050968
     C                     MOVE '1'       *IN46                           050968
     C                     END                                            050968
     C                     END                                            050968
      *                                                                                       CAS009
      ** If updated successfully, get current EIR period and                                  CAS009
      ** update the EIR recalculation indicator to 'Y'.                                       CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN46     ANDEQ'1'                                                           CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINMMEIRDL6             47                                       CAS009
      *                                                                                       CAS009
     C           *IN47     IFEQ '0'                                                           CAS009
     C                     MOVE 'Y'       EIRCAL                                              CAS009
     C                     UPDATMMEIRDD0                                                      CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
      *                                                                   050968
0686 C                     SETOF                     7778
0687 C                     SETOF                     7980
0688 C                     ENDSR
0707 C********************************************************************
0708 C**
0709 C           UDLOG     BEGSR
     C**
0710 C                     SETOF                     69
0711 C**
0712 C** IF A DATABASE OR SYSTEM ERROR IS FOUND INDICATORS
0713 C** ARE SET TO - REFLECT THE ERROR CONDITION,RELEASE
0714 C** FILES,RELEASE SCREEN AND TO END PROGRAM.
0715 C**
     C           *IN37     IFEQ *ON                                                           CDL026
     C           CDL026    OREQ 'N'                                                          BUG8864
0718 C*
0719 C*    ACCESS DEALS RECORD TO BE UPDATED
0720 C           DLKEY     CHAINDEALS                44
0721 C   06                SETON                     44
0722 C   44                SETON                     U7U8
0723 C   44                GOTO ENDD
0724 C*
0725 C*    CHECK IF RECORD CHANGED
0726 C           LUD       COMP LUDSV                8181
0727 C  N81                GOTO RUNCH
0728 C                     MOVELEMES,1    ERRMSG
     C*
     C                     SETON                     80    RELEASE DEALS
     C*
0731 C                     GOTO ENDD
0732 C           RUNCH     TAG                             ** RUNCH TAG **
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
      *
     C                     EXSR ZTNLU1
     C                     MOVE 'DL'      MDID    2
     C                     MOVEL'DL0100'  PGMN    8
     C                     MOVE WSID      WSIDX
     C                     MOVE 'A'       ACTCOD
     C                     MOVE USRID     USRIDX
     C**
     C** NOT FRA/IRS DEALS                                                S01119
     C**                                                                  S01119
     C           *IN04     IFEQ '1'                                       S01119
     C           *IN05     OREQ '1'                                       S01119
     C           *IN42     OREQ '1'                                       AUS003
     C                     Z-ADDAIAN      AIANA                           CAC001
0786 C   64      AIAN      ADD  OTADJ     AIANA  130       ** DEALS FILE *
0787 C   65      AIAN      SUB  OTADJ     AIANA  130       ** UPDATE **
     C*                                                                   CAC001
     C           *IN17     IFEQ '1'                                       CAC001
     C           SCFAS     IFEQ '+'                                       CAC001
     C                     ADD  OTCOF     ACAN                            CAC001
     C                     END                                            CAC001
     C           SCFAS     IFEQ '-'                                       CAC001
     C                     SUB  OTCOF     ACAN                            CAC001
     C                     END                                            CAC001
     C                     END                                            CAC001
     C*                                                                   CAC001
0788 C                     MOVE DNSI      DNSIA   1
0789 C                     BITON'2'       DNSIA
     C                     END                                            S01119
     C**                                                                  S01119
     C**  FRA/IRS DEALS                                                   S01119
     C**                                                                  S01119
     C           *IN10     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C**  OURS                                                            S01119
     C*                                                                   S01119
     C           *IN56     IFEQ '1'                                       S01119
0786 C   64      UAIAN     ADD  OTADJ     UAIANA 130       ** DEALS FILE *S01119
0787 C   65      UAIAN     SUB  OTADJ     UAIANA 130       ** UPDATE **   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  THEIRS                                                          S01119
     C*                                                                   S01119
     C           *IN57     IFEQ '1'                                       S01119
0786 C   64      TAIAN     ADD  OTADJ     TAIANA 130       ** DEALS FILE *S01119
0787 C   65      TAIAN     SUB  OTADJ     TAIANA 130       ** UPDATE **   S01119
     C                     END                                            S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP8                                           S01408
     C*                                                                   S01408
     C*                                                                   099755
     C** Save the Our/Their Indicator to avoid over-writing by CHAIN.     099755
     C*                                                                   099755
     C           *LIKE     DEFN INIRS     SINIRS                          099755
     C                     MOVELINIRS     SINIRS                          099755
     C*                                                                   CIR002
     C** Unsettled interest adjustment should be updated with the         CIR002
     C** value of 'Unsettled Interest' field.                             CIR002
     C*                                                                   CIR002
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C011
     C*                                                                   CIR002
     C** Ours                                                             CIR002
     C*                                                                   CIR002
     C           INIRS     IFEQ 'O'                                       CIR002
     C                     Z-ADDOUSA      WOUSA  150                      CIR002
     C*                                                                   CIR002
     C           SSIGN     IFEQ '+'                                       CIR002
     C                     ADD  WUSIT     WOUSA  150                      CIR002
     C                     END                                            CIR002
     C           SSIGN     IFEQ '-'                                       CIR002
     C                     SUB  WUSIT     WOUSA  150                      CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C** Theirs                                                           CIR002
     C*                                                                   CIR002
     C           INIRS     IFEQ 'T'                                       CIR002
     C                     Z-ADDTUSA      WTUSA  150                      CIR002
     C*                                                                   CIR002
     C           SSIGN     IFEQ '+'                                       CIR002
     C                     ADD  WUSIT     WTUSA  150                      CIR002
     C                     END                                            CIR002
     C           SSIGN     IFEQ '-'                                       CIR002
     C                     SUB  WUSIT     WTUSA  150                      CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   CIR002
     C                     END                                            CIR002
     C*                                                                   S01119
     C                     END                                            S01119
      *                                                                                       CAS005
      ** Update the Net-Treasury-Rate and Base Rate adjustment fields                         CAS005
      ** if CAS005 is enabled.                                                                CAS005
      *                                                                                       CAS005
     C           CAS005    IFEQ 'Y'                                                           CAS005
     C                     EXSR SRUAXR                                                        CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
0790 C**
0792 C**   AMEND DEALS DETAIL RECORD
0793 C                     SETON                     79
0794 C                     EXSR TIME
0795 C                     EXSR EXCPTN
      *                                                                                       256960
      ** Process Account Movement for Interest adjustment                                     256960
      *                                                                                       256960
     C           MDAT      IFNE *ZEROS                                                        256960
     C                     MOVE MDAT      P1MDAT  50                                          256960
      *                                                                                       256960
     C           NIDT      IFNE 0                                                             256960
     C                     MOVE NIDT      W5A     5                                           256960
     C                     MOVE NIDT      P1MDAT                                              256960
     C                     ELSE                                                               256960
     C                     MOVE BJRDNB    W5A     5                                           256960
     C                     ENDIF                                                              256960
      *                                                                                       256960
     C                     MOVELDTYP      P1KEY1 20 P                                         256960
     C                     MOVE DLNO      W6A     6                                           256960
     C                     CAT  W6A:0     P1KEY1                                              256960
     C                     CAT  W5A:0     P1KEY1                                              256960
     C                     MOVEL'SETTLI'  P1OPTN  6                                           256960
     C                     MOVE INSIGN    P1SIGN  1                                           256960
     C                     MOVE OTADJ     P1AMNT 130                                          256960
     C                     MOVE INCCY     P1CCY   3                                           256960
      *                                                                                       256960
     C                     CALL 'MM0100'                                                      256960
     C                     PARM           P1OPTN           in                                 256960
     C                     PARM           P1KEY1           in                                 256960
     C                     PARM           P1SIGN           in                                 256960
     C                     PARM           P1AMNT           in                                 256960
     C                     PARM           P1CCY            in                                 256960
     C                     PARM           P1MDAT           in                                 256960
      *                                                                                       256960
     C                     ENDIF                                                              256960
      *                                                                                       CDL026
     C                     ENDIF                                                              CDL026
      *                                                                                       CDL026
0796 C**
0807 C***UPDATE*STRAN*DETAIL*RECORD******                                 LN0767
0807 C** UPDATE STRANF DETAIL RECORD                                      LN0767
     C** FIRST CHECK DETAIL FILE IS NOT FULL (FROM STRANH)                LN0767
     C**
0808 C***********1         CHAINSTRAN                45                   LN0767
     C                     Z-ADD1         RRN     50                      LN0767
0808 C           RRN       CHAINSTRANHF              45                   LN0767
0809 C  N45      MNT       SUB  NAVT      DIFF    50
0810 C  N45      DIFF      COMP 10                     8282
0811 C  N45 82   DIFF      COMP 2                      8383
0812 C   83                SETON                     U6U8
0814 C   83                GOTO ENDD
     C*
0815 C**N45******NAVT      CHAINSTRAN                45                   LN0767
     C           *IN45     IFEQ '0'                                       LN0767
     C*
     C**********           MOVE CNUM      WCNUM   60                                   LN0767 CSD027
     C                     MOVE CNUM      WCNUM   6                                           CSD027
     C                     Z-ADDNAVT      RRN                             LN0767
     C                     MOVE INIRS     SVIRS   1                       102714
0815 C           RRN       CHAINSTRANFF              45                   LN0767
0816 C***********          SETON                     78                   LN0767
     C*
     C           KAUTH1    KLIST                                                              CDL026
     C                     KFLD           PPDLNO                                              CDL026
     C                     KFLD           PPCNUM                                              CDL026
     C                     KFLD           PPIPTM                                             BUG6696
     C                     KFLD           PPRDNB                                             BUG6696
     C           *IN37     IFEQ *OFF                                                          CDL026
     C** FILL FIELDS FOR STRANF RECORD                                    LN0767
     C*
0817 C                     EXSR TIME
     C                     MOVE SVIRS     INIRS                           102714
     C                     MOVE 'F'       RECI
     C                     MOVE INDEAL    DLNO                            LN0767
     C                     MOVE WCNUM     CNUM                            LN0767
     C                     MOVE INCCY     CCY                             LN0767
     C                     Z-ADDOTADJ     MAAM                            LN0767
     C                     MOVE INSIGN    SIGN                            LN0767
     C                     MOVE TYPE      DTYP                            LN0767
     C                     MOVE STBRCA    BRCA                            LN0767
     C                     MOVE MTIME     UDTM                            LN0767
     C                     Z-ADDNAVT      RRNT                            LN0767
     C                     Z-ADDNATN      TNLU                            LN0767
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0100CCP9                                           S01408
     C*                                                                   099755
     C** Restore the Our/Their Indicator.                                 099755
     C*                                                                   099755
     C***************      MOVELSINIRS    INIRS                           BUG6696 099755
     C*                                                                   S01408
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0100C012
     C           SUSIT     IFNE *BLANKS                                   CIR002
     C                     MOVE SSIGN     SIGN                            CIR002
     C                     END                                            CIR002
     C                     Z-ADDWUSIT     USIT                            CIR002
     C                     END                                            CIR002
     C*                                                                   CAC001
     C           *IN17     IFEQ '1'                                       CAC001
     C           SCFAS     IFNE *BLANKS                                   CAC001
     C                     MOVE SCFAS     FSGN                            CAC001
     C                     END                                            CAC001
     C                     Z-ADDOTCOF     AACF                            CAC001
     C                     END                                            CAC001
     C*                                                                   CAC001
0818 C***********          EXSR EXCPTN                                    LN0767
     C*
     C****                 UPDATSTRANFF                                                LN0767 CDL026
     C           CDL026    IFEQ 'N'                                       BUG8864
     C                     UPDATSTRANFF                                   BUG8864
     C                     ELSE                                           BUG8864
     C                     MOVEL'I'       WWCHTP                                              CDL026
     C                     MOVELUSRID     INPUSR                                              CDL026
     C                     MOVEL*BLANKS   ATHUSR                                              CDL026
     C                     MOVEL@DSPF     DSPFRF                                             BUG6696
     C                     Z-ADDBJRDNB    INPDAY                                             BUG6696
     C                     MOVE MTIME     INPTM                                              BUG6696
     C                     WRITEDLAIAUD1                                                      CDL026
     C                     ENDIF                                          BUG8864
     C*                                                                                       CDL026
     C                     ELSE                                                               CDL026
     C           KAUTH1    CHAINDLAIAUL1             70                                       CDL026
     C                     EXSR TIME                                                          CDL026
     C                     MOVE MTIME     UDTM                                                CDL026
     C                     Z-ADDNAVT      RRNT                                                CDL026
     C                     Z-ADDNATN      TNLU                                                CDL026
     C                     UPDATSTRANFF                                                       CDL026
     C                     MOVEL'X'       WWCHTP                                              CDL026
     C                     MOVELUSRID     ATHUSR                                              CDL026
     C                     UPDATDLAIAUD1                                                      CDL026
     C*                                                                                       CDL026
     C                     ENDIF                                                              CDL026
     C*                                                                                       CDL026
     C                     END                                            LN0767
0819 C**
0830 C***UPDATE*STRAN*HEADER*RECORD*****                                  LN0767
0830 C** UPDATE STRANH HEADER RECORD                                      LN0767
     C           *IN37     IFEQ *ON                                                           CDL026
     C           CDL026    OREQ 'N'                                       BUG8864
0831 C                     EXSR UPDATE
     C                     ENDIF                                                              CDL026
0832 C***********          SETON                     77                   LN0767
0834 C***********          EXSR EXCPTN                                    LN0767
0835 C**
     C** END COMMITMENT CYCLE
     C           CMTTXT    COMIT
0857 C**
0858 C** OUTPUT INITIAL SCREEN
0859 C                     SETON                     40
0860 C**
0861 C** OBTAIN TIME FOR SCREEN DISPLAY.
0862 C                     EXSR TIME
0863 C                     SETON                     69
0864 C**
0865 C           ENDD      ENDSR
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
      *                                                                                       245692
     C********** ZA1,ZX    COMP '.'                      90                                   245692
     C           ZA1,ZX    COMP BNDCSP                   90                                   245692
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C**
     C********************************************************************
0970 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0971 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0972 C*
0973 CSR         GLZADD    BEGSR                           *** GLZADD ****
0974 C*
0975 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0976 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0977 C*
0978 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0979 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0980 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0981 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0982 C*
0983 CSR                   EXSR GLZSUM
0984 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0985 C*
0986 C********************************************************************
0987 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0988 C*                        GLZADD, GLZSUB, GLZCMP.
0989 C*          PARAMETERS PASSED -
0990 C*                     I/P ZZAMTI ZZAMTD
0991 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0992 C*
0993 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0994 C*
0995 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0996 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0997 CSR                   SETOF                     919293
0998 CSR                   SETOF                     949599
0999 C*
1000 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1001 CSR         ZZAMTI    COMP 0                      9293
1002 CSR 93      ZZAMTD    COMP 0                      9293
1003 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1004 C*
1005 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1006 CSR         ZZTOTI    COMP 0                      9193
1007 CSR 93      ZZTOTD    COMP 0                      9193
1008 C*
1009 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1010 CSR 93                Z-ADDZZAMTI    ZZTOTI
1011 CSR 93                Z-ADDZZAMTD    ZZTOTD
1012 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1013 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1014 CSR 91N92
1015 CORN91 92             GOTO ZZOFPS
1016 C*
1017 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1018 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1019 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1020 C*
1021 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1022 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1023 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1024 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1025 C*
1026 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1027 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1028 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1029 CSRN99                Z-ADDZZWK2     ZZTOTD
1030 CSRN99                Z-ADDZZWK3     ZZTOTI
1031 C*
1032 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1033 CSR 99                Z-ADD0         ZZAMT  153
1034 CSR                   GOTO ZZSEND
1035 C*
1036 C* THE 'SIGNS' ARE DIFFERENT
1037 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1038 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1039 C*
1040 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1041 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1042 C*
1043 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1044 C*
1045 CSR 91                Z-SUBZZTOTI    ZZTOTI
1046 CSR 91                Z-SUBZZTOTD    ZZTOTD
1047 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1048 C*
1049 CSR         ZZTOTI    COMP ZZAMTI               93  95
1050 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1051 C*
1052 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1053 CSR 95                Z-ADD0         ZZTOTI
1054 CSR 95                Z-ADD0         ZZTOTD
1055 CSR 95                GOTO ZZSEND
1056 C*
1057 C* IF ZZTOT GT. ZZAMT.
1058 CSR 93      ZZAMTD    COMP ZZTOTD               94
1059 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1060 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1061 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1062 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1063 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1064 C*
1065 C*
1066 C* IF ZZAMT GT. ZZTOT.
1067 CSRN93      ZZTOTD    COMP ZZAMTD               94
1068 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1069 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1070 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1071 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1072 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1073 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1074 C*
1075 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1076 CSR                   SETOF                     94
1077 CSR 93 91
1078 CORN93 92             SETON                     94
1079 CSR 94                Z-SUBZZTOTI    ZZTOTI
1080 CSR 94                Z-SUBZZTOTD    ZZTOTD
1081 C**
1082 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1083 CSR 92                Z-SUBZZAMTI    ZZAMTI
1084 CSR 92                Z-SUBZZAMTD    ZZAMTD
1085 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1086 C**
1087 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1088 CSR                   SETOF                     96
1089 CSR         ZZTOTD    COMP 0                        91
1090 CSR 91      ZZTOTI    COMP 0                      96
1091 CSR 96                MOVE '.000-'   ZZNEGD  5
1092 CSR                   ENDSR                             ** ENDSR **
     C*****************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRVANR - Validates the Adjustment using Net-Treasury-Rate    *                       CAS005
      *           field.                                              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRVANR    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** Validate the adjustment.                                                             CAS005
      *                                                                                       CAS005
     C           #1AINN    IFNE *BLANKS                                                       CAS005
     C           #1AINS    ORNE *BLANK                                                        CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   WADJ   16                                           CAS005
     C                     MOVE #1AINN    WADJ                                                CAS005
     C                     MOVE #1AINS    WSGN    1                                           CAS005
      *                                                                                       CAS005
     C                     EXSR SRVADJ                                                        CAS005
      *                                                                                       CAS005
      ** Is the Currency invalid?                                                             CAS005
      *                                                                                       CAS005
     C           WDBEF     IFEQ 'Y'                                                           CAS005
     C                     GOTO EVANR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Is the adjustment invalid?                                                           CAS005
      *                                                                                       CAS005
     C           WADJF     IFEQ 'Y'                                                           CAS005
     C           #1AINN    OREQ *BLANKS                                                       CAS005
     C           WSGNF     ANDEQ'N'                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '180'     ERCD,S                                              CAS005
     C                     MOVE *ON       *IN85                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD*ZERO     WVADJ  130                                          CAS005
     C                     MOVE ZFIELD    WVADJ                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Is the sign invalid?                                                                 CAS005
      *                                                                                       CAS005
     C           WSGNF     IFEQ 'Y'                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '182'     ERCD,S                                              CAS005
     C                     MOVE *ON       *IN86                                               CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE WSGN      WVSGN   1                                           CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Are the Base Rate Adjustment fields not blank?                                       CAS005
      *                                                                                       CAS005
     C           #1XINB    IFNE *BLANKS                                                       CAS005
     C                     MOVE *ON       *IN87                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           #1XINS    IFNE *BLANK                                                        CAS005
     C                     MOVE *ON       *IN88                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN87     IFEQ *ON                                                           CAS005
     C           *IN88     OREQ *ON                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '201'     ERCD,S                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           EVANR     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRVABR - Validates the Adjustment using Base Rate field.     *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRVABR    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** Validate the adjustment.                                                             CAS005
      *                                                                                       CAS005
     C           #1XINB    IFNE *BLANKS                                                       CAS005
     C           #1XINS    ORNE *BLANK                                                        CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   WADJ                                                CAS005
     C                     MOVE #1XINB    WADJ                                                CAS005
     C                     MOVE #1XINS    WSGN                                                CAS005
      *                                                                                       CAS005
     C                     EXSR SRVADJ                                                        CAS005
      *                                                                                       CAS005
      ** Is the Currency invalid?                                                             CAS005
      *                                                                                       CAS005
     C           WDBEF     IFEQ 'Y'                                                           CAS005
     C                     GOTO EVABR                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Is the adjustment invalid?                                                           CAS005
      *                                                                                       CAS005
     C           WADJF     IFEQ 'Y'                                                           CAS005
     C           #1XINB    OREQ *BLANKS                                                       CAS005
     C           WSGNF     ANDEQ'N'                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '180'     ERCD,S                                              CAS005
     C                     MOVE *ON       *IN87                                               CAS005
     C                     ELSE                                                               CAS005
     C                     Z-ADD*ZERO     WVADJ                                               CAS005
     C                     MOVE ZFIELD    WVADJ                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Is the sign invalid?                                                                 CAS005
      *                                                                                       CAS005
     C           WSGNF     IFEQ 'Y'                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '182'     ERCD,S                                              CAS005
     C                     MOVE *ON       *IN88                                               CAS005
     C                     ELSE                                                               CAS005
     C                     MOVE WSGN      WVSGN                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Are the Net-Treasury-Rate Adjustment fields not blank?                               CAS005
      *                                                                                       CAS005
     C           #1AINN    IFNE *BLANKS                                                       CAS005
     C                     MOVE *ON       *IN85                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           #1AINS    IFNE *BLANK                                                        CAS005
     C                     MOVE *ON       *IN86                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           *IN85     IFEQ *ON                                                           CAS005
     C           *IN86     OREQ *ON                                                           CAS005
     C                     ADD  1         S                                                   CAS005
     C                     MOVE '202'     ERCD,S                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           EVABR     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRVADJ - Validates adjustments.                              *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRVADJ    BEGSR                                                              CAS005
      *                                                                                       CAS005
      ** Access Currency Details.                                                             CAS005
      *                                                                                       CAS005
     C                     CALL 'AOCURRR0'                                                    CAS005
     C                     PARM *BLANKS   PRTCD                                               CAS005
     C                     PARM '*KEY    'POPTN                                               CAS005
     C                     PARM INCCY     PCCY    3                                           CAS005
     C           @CURR     PARM @CURR     DSSDY                                               CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WDBEF   1                                           CAS005
     C           PRTCD     IFNE *BLANKS                                                       CAS005
     C                     MOVEL'SDCURRPD'DBFILE                                              CAS005
     C                     MOVEL'09'      DBASE                                               CAS005
     C                     MOVELPOPTN     DBOPTN                                              CAS005
     C                     MOVELPCCY      DBKEY                                               CAS005
     C                     MOVE *ON       *INU7                                               CAS005
     C                     MOVE *ON       *INU8                                               CAS005
     C                     EXSR *PSSR                                                         CAS005
     C                     MOVE 'Y'       WDBEF                                               CAS005
     C                     GOTO EVADJ                                                         CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     MOVE *BLANKS   ZFIELD                                              CAS005
     C                     MOVE WADJ      ZFIELD                                              CAS005
     C                     Z-ADDA6NBDP    ZADEC                                               CAS005
     C           13        SUB  A6NBDP    ZADIG                                               CAS005
     C                     EXSR ZALIGN                                                        CAS005
      *                                                                                       CAS005
      ** Set the Adjustment Flag if we have an invalid amount.                                CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WADJF   1                                           CAS005
     C           *IN99     IFEQ *ON                                                           CAS005
     C                     MOVE 'Y'       WADJF                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Set the Sign Flag if we have an invalid sign.                                        CAS005
      *                                                                                       CAS005
     C                     MOVE 'N'       WSGNF   1                                           CAS005
     C           WSGN      IFNE '+'                                                           CAS005
     C           WSGN      ANDNE'-'                                                           CAS005
     C                     MOVE 'Y'       WSGNF                                               CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C           EVADJ     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
      *****************************************************************                       CAS005
      *                                                               *                       CAS005
      *  SRUAXR - Updates the Net-Treasury-Rate and Base Rate         *                       CAS005
      *           adjustment fields.                                  *                       CAS005
      *                                                               *                       CAS005
      *****************************************************************                       CAS005
     C           SRUAXR    BEGSR                                                              CAS005
      *                                                                                       CAS005
     C                     SELEC                                                              CAS005
      *                                                                                       CAS005
      ** Money Market Loans/Deposits update.                                                  CAS005
      *                                                                                       CAS005
     C           *IN04     WHEQ *ON                                                           CAS005
     C           *IN05     OREQ *ON                                                           CAS005
      *                                                                                       CAS005
     C           #1AINN    IFNE *BLANKS                                                       CAS005
     C           WVSGN     IFEQ '+'                                                           CAS005
     C                     ADD  WVADJ     FSAINN                                              CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  WVADJ     FSAINN                                              CAS005
     C                     ENDIF                                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
      ** Fwd. Rate Agreement/Int. Rate Swap update.                                           CAS005
      *                                                                                       CAS005
     C           *IN10     WHEQ *ON                                                           CAS005
      *                                                                                       CAS005
     C           #1XINB    IFNE *BLANKS                                                       CAS005
      *                                                                                       CAS005
     C           WVSGN     IFEQ '+'                                                           CAS005
      *                                                                                       CAS005
     C           INIRS     IFEQ 'O'                                                           CAS005
     C                     ADD  WVADJ     FSUINB                                              CAS005
     C                     ELSE                                                               CAS005
     C                     ADD  WVADJ     FSTINB                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ELSE                                                               CAS005
      *                                                                                       CAS005
     C           INIRS     IFEQ 'O'                                                           CAS005
     C                     SUB  WVADJ     FSUINB                                              CAS005
     C                     ELSE                                                               CAS005
     C                     SUB  WVADJ     FSTINB                                              CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDIF                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSL                                                              CAS005
      *                                                                                       CAS005
     C                     ENDSR                                                              CAS005
      *****************************************************************                       CAS005
      /EJECT                                                                                  CAS005
1093 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
0590 C********************************************************************
     C*                                                          S01203
1094 O*DL0100FMD        60NKANU8
1094 ODL0100FMD        60NKCNU8
     C*                                                          S01203
1096 O                                   K8 'DL0100F1'
     O                         *IN41      1
     O                         *IN51      2
     O                         *IN61      3
     O                         *IN63      4
     O                         *IN67      5
     O**************************IN33******6                               S01119
     O**************************IN32******7                               S01119
1097 O*************************SID********9                               S01119
1098 O*************************MTIME*****17 '  .  .  '                    S01119
1099 O*************************WSID******20                               S01119
1100 O*************************INDEAL****26                               S01119
1101 O*************************INCUSN****36                               S01119
1102 O*************************INADJ*****50                               S01119
1103 O*************************INSIGN****51                               S01119
1104 O*************************INCCY*****54                               S01119
1105 O***********************32SCFLD*****54                               S01119
1106 O***********************40BLK34*****54                               S01119
1107 O*************************ERRMSG***133                               S01119
1108 O*************************ERCDS****212                               S01119
     O                         *IN12      6                               S01119
     O                         *IN50      7                               S01119
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0100OOP1                                           S01408
     O*                                                                   S01408
     O***********************  *IN33      8                        S01119 CIR002
     O***********************  *IN32      9                        S01119 CIR002
1097 O***********************  SID       11                        S01119 CIR002
1098 O***********************  MTIME     19 '  .  .  '             S01119 CIR002
1099 O***********************  WSID      22                        S01119 CIR002
1100 O***********************  INDEAL    28                        S01119 CIR002
1101 O***********************  INCUSN    38                        S01119 CIR002
1102 O***********************  INADJ     52                        S01119 CIR002
1103 O***********************  INSIGN    53                        S01119 CIR002
1104 O***********************  INCCY     56                        S01119 CIR002
     O***********************  INIRS     57                        S01119 CIR002
1105 O***********************32SCFLD     57                        S01119 CIR002
1106 O***********************40BLK35     57                        S01119 CIR002
1107 O***********************  ERRMSG   136                        S01119 CIR002
1108 O***********************  ERCDS    215                        S01119 CIR002
     O                         *IN14      8                               CIR002
     O                         *IN15      9                               CIR002
     O                         *IN16     10                               CIR002
     O***********              *IN33     11                        CIR002 CAC001
     O***********              *IN32     12                        CIR002 CAC001
1097 O***********              SID       14                        CIR002 CAC001
1098 O***********              MTIME     22 '  .  .  '             CIR002 CAC001
1099 O***********              WSID      25                        CIR002 CAC001
1100 O***********              INDEAL    31                        CIR002 CAC001
1101 O***********              INCUSN    41                        CIR002 CAC001
1102 O***********              INADJ     55                        CIR002 CAC001
1103 O***********              INSIGN    56                        CIR002 CAC001
1104 O***********              INCCY     59                        CIR002 CAC001
     O***********              INIRS     60                        CIR002 CAC001
     O***********      14      SUSIT     74                        CIR002 CAC001
     O***********      14      SSIGN     75                        CIR002 CAC001
1105 O***********            32SCFLD     75                        CIR002 CAC001
1106 O***********            40BLK35     75                        CIR002 CAC001
1107 O***********              ERRMSG   154                        CIR002 CAC001
1108 O***********              ERCDS    233                        CIR002 CAC001
     O                         *IN17     11                               CAC001
     O                         *IN18     12                               CAC001
     O                         *IN19     13                               CAC001
     O                         *IN84     14                                                   CAS005
     O                         *IN85     15                                                   CAS005
     O                         *IN86     16                                                   CAS005
     O                         *IN87     17                                                   CAS005
     O                         *IN88     18                                                   CAS005
     O                         *IN33     19                                                   CAS005
     O                         *IN32     20                                                   CAS005
     O**********               *IN33     14                                            CAC001 CAS005
     O**********               *IN32     15                                            CAC001 CAS005
     O**********               SID       17                                            CAC001 CAS005
     O**********               MTIME     25 '  .  .  '                                 CAC001 CAS005
     O**********               WSID      28                                            CAC001 CAS005
     O**********               INDEAL    34                                            CAC001 CAS005
     O**********               INCUSN    44                                            CAC001 CAS005
     O**********               INADJ     58                                            CAC001 CAS005
     O**********               INSIGN    59                                            CAC001 CAS005
     O**********               INCCY     62                                            CAC001 CAS005
     O**********               INIRS     63                                            CAC001 CAS005
     O**********       14      SUSIT     77                                            CAC001 CAS005
     O**********       14      SSIGN     78                                            CAC001 CAS005
     O**********       17      SCFAA     92                                            CAC001 CAS005
     O**********       17      SCFAS     93                                            CAC001 CAS005
     O**********             32SCFLD     93                                            CAC001 CAS005
     O**********             40BLK65     93                                            CAC001 CAS005
     O**********               ERRMSG   172                                            CAC001 CAS005
     O**********               ERCDS    251                                            CAC001 CAS005
     O                         SID       22                                                   CAS005
     O                         MTIME     30 '  .  .  '                                        CAS005
     O                         WSID      33                                                   CAS005
     O                         INDEAL    39                                                   CAS005
     O                         INCUSN    49                                                   CAS005
     O                         INADJ     63                                                   CAS005
     O                         INSIGN    64                                                   CAS005
     O                         INCCY     67                                                   CAS005
     O                         INIRS     68                                                   CAS005
     O                 14      SUSIT     82                                                   CAS005
     O                 14      SSIGN     83                                                   CAS005
     O                 17      SCFAA     97                                                   CAS005
     O                 17      SCFAS     98                                                   CAS005
     O                 84      #1AINN   112                                                   CAS005
     O                 84      #1AINS   113                                                   CAS005
     O                 84      #1XINB   127                                                   CAS005
     O                 84      #1XINS   128                                                   CAS005
     O                       32SCFLD    128                                                   CAS005
     O                       40BLK95    128                                                   CAS005
     O                         ERRMSG   207                                                   CAS005
     O                         ERCDS    286                                                   CAS005
     O*                                                                   S01408
     O/COPY WNCPYSRC,DL0100OOP2                                           S01408
     O*                                                                   S01408
1116 O**
1269 O**
1270 O** STRAN - HEADER RECORD
1271 O***STRAN***E********77*****                                         LN0767
1272 O***************                     1 'H'                           LN0767
1273 O***************          NAVT2      6                               LN0767
1274 O***************          MNT       11                               LN0767
1275 O***************          NORC      14P                              LN0767
1276 O***************        64NOID2     69P                              LN0767
1277 O***************        64HDIW2     77P                              LN0767
1278 O***************        64HDID2     80P                              LN0767
1279 O***************        65NODD2     83P                              LN0767
1280 O***************        65HDDW2     91P                              LN0767
1281 O***************        65HDDD2     93P                              LN0767
1282 O***************          NOIC      96P                              LN0767
1283 O***************          HCIW     104P                              LN0767
1284 O***************          HCID     106P                              LN0767
1285 O***************          NODC     109P                              LN0767
1286 O***************          HCDW     117P                              LN0767
1287 O***************          HCDD     119P                              LN0767
1288 O***************          NOIF     122P                              LN0767
1289 O***************          HFIW     130P                              LN0767
1290 O***************          HFID     132P                              LN0767
1291 O***************          NODF     135P                              LN0767
1292 O***************          HFDW     143P                              LN0767
1293 O***************          HFDD     145P                              LN0767
1294 O***************          RRNT     197P                              LN0767
1295 O***************          NAVT     200P                              LN0767
1296 O**
1297 O** STRAN DETAIL RECORD
1298 O********E********78****                                             LN0767
1299 O***************                     1 'F'                           LN0767
1300 O***************          INDEAL     7                               LN0767
1301 O***************          CNUM      13                               LN0767
1302 O***************          INCCY     16                               LN0767
1303 O***************          OTADJ     23P                              LN0767
1304 O***************          INSIGN    24                               LN0767
1305 O***************          DTYP      26                               LN0767
     O***************          INIRS     27                        S01119 LN0767
     O***************          STBRCA   188                        S01117 LN0767
1306 O***************          MTIME    194                               LN0767
1307 O***************          NAVT     197P                              LN0767
1308 O***************          NATN     200P                              LN0767
1309 O**
1310 O** DEALS DETAIL RECORD
1311 ODEALS   E        79 04
1312 O       OR        79 05
     O       OR        79 42                                              AUS003
1313 O                         LOTDL1   200
1314 O                         LOTDL2   400
     O                 04N05   ORBR    1059                               S01117
     O                 05N04   ORBR    1039                               S01117
1315 O                         AIANA    256P
1316 O                         DNSIA    370
     O                 04N05   ACAN    1200P                              CAC001
     O                 05N04   ACAN    1114P                              CAC001
     O                 04N05   FSAINN  1692P                                                  CAS005
     O                 05N04   FSAINN  1223P                                                  CAS005
1309 O**                                                                  S01119
1310 O** DEALS DETAIL RECORD                                              S01119
1311 ODEALS   E        79 10                                              S01119
1313 O                         LOTDL1   200                               S01119
1314 O                         LOTDL2   400                               S01119
     O                         LOTDL3   600                               S01119
     O                         ORBR     605                               S01117
1315 O                 56      UAIANA   155P                              S01119
     O                 57      TAIANA   299P                              S01119
     O                 56 14   WOUSA    671P                              CIR002
     O                 57 14   WTUSA    687P                              CIR002
     O                         FSUINB  2289P                                                  CAS005
     O                         FSTINB  2368P                                                  CAS005
1317 O*
1318 O*    DEALS FILE RELEASE
1319 O        E        80
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   EMES - ERROR MESSAGES
THIS RECORD HAS BEEN UPDATED BY ANOTHER WORK STATION
WARNING - STRAN FILE NEARLY FULL
BOOKING. BR. ON RELATED REC. INVALID FOR USER
ORIGINATING BR. ON RELATED REC. INVALID FOR USER
**   IRTYP - FRA/IRS DEAL TYPES                                           S01119
RXFRRSRPRRRF                                                       SO1119 S01157
**   UPDT - UPDATE SUCCESSFUL MESSAGE                                     050968
DEALS RECORD UPDATED                                                      050968
