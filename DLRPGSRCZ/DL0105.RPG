0001 H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Stop Confirmations Print')
0002 F********************************************************************
     F*  Midas - Dealing Module
0004 F*                                                                  *
0005 F*    DL0105 - STOP CONFIRMATIONS PRINT                             *
0006 F*                                                                  *
      *  (c) Finastra International Limited 2001                      *
0008 F*                                                                  *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. BHF210             Date 11Jul90               *
      *                 E15893             Date 11Apr90               *
0010 F*                                                                  *
0011 F********************************************************************
      *  MD046248 - Finastra Rebranding                               *
0010 F*    BHF210 - COMPILE-TIME ARRAYS IN WRONG ORDER                   *
0010 F*    E15893 - Time compare loop removed to prevent innacurate      *E15893
0010 F*             delay (can vary between 1 and 59 seconds) and to     *E15893
     F*             avoid excessive CPU usage.                           *E15893
     F*                                                                  *E15893
0011 F********************************************************************
0012 FDTRIXHH UF  F      40            DISK
     E                    CMD     1   1 14                                BHF210
     E                    CPY@    1   1 80
     E************        CMD     1   1 14                          E15893BHF210
0014 I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
0015 I*
0016 IDTRIXHH NS  01   1 CH
0017 I                                       33  330STPI        02
0018 I        NS
0019 I*
     C                     MOVEACPY@      BIS@   80
0021 C*    ONE CYCLE ONLY - SET ON LR
0022 C*
0023 C           LOOP      TAG                             ** LOOP TAG **
0024 C***********          TIME           TIME    60                      E15893
0025 C***********          MOVELTIME      MIN     40                      E15893
0026 C***********MIN       COMP MINS                 0202                 E15893
0027 C**N02******          GOTO LOOP                                      E15893
     C                     Z-ADD14        LNTH                            E15893
     C                     CALL 'QCMDEXC'                                 E15893
     C                     PARM           CMD                             E15893
     C                     PARM           LNTH   155                      E15893
0028 C*
0029 C*    WHEN 1 MINUTE HAS ELAPSED, CHECK DTRIX HEADER AGAIN
0030 C*
0031 C***********          Z-ADDMIN       MINS    40                      E15893
0032 C           1         CHAINDTRIXHH              U8
0033 C  N01                SETON                     U8
     C*    IF FIVE MINUTES HAVE ELAPSED IT IS VERY LIKELY THAT
     C*    THE PRINT PROGRAM TERMINATED BEFORE STPI WAS SET TO '1'.
     C*    IF SO THEN SET STPI TO '0' AND TERMINATE TO STOP
     C*    THIS PROGRAM LOOPING INDEFINITELY.
     C                     ADD  1         FIVE    10
     C           FIVE      COMP 5                        66
     C   66                EXCPT
     C   66                GOTO END
0034 C  NU8                EXCPT
0035 C  NLR                SETON                     02
0036 C                     SETON                     LR
0037 C   02NU8             GOTO LOOP
     C           END       TAG
0038 ODTRIXHH E
0039 O                      NLR          33 '1'
     O                    66 LR          33 '0'
**                                                                        E15893
DLYJOB DLY(60)                                                            E15893
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
