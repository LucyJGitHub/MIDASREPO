     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Customer deals enquiry')                      *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DL0120 - Customer Deals Enquiry                              *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD057842           Date 06Apr21               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 245692             Date 09Dec13               *
      *                 CER059             Date 19Jul10               *
      *                 260855             Date 11Sep09               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 259968             Date 20Apr09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 117478             Date 26May06               *
      *                 CDL049             Date 05Jul06               *
      *                 BUG11439           Date 04Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 237063             Date 20Nov05               *
      *                 CDL033             Date 10Feb05               *
      *                 BUG7411            Date 01Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 229544             Date 15Sep04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20May04               *
      *                 CAAA03             Date 22Apr04               *
      *                 BG2171             Date 01Sep03               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 214207             Date 19Feb03               *
      *                 CDL010             Date 02Aug02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 208051             Date 11Sep02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSD007             Date 28Aug00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CGL011             Date 20Sep99               *
      *                 155954             Date 04Oct99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CTI002             Date 23Sep98               *
      *                 087231             Date 15Jan98               *
     F*                 S01408             DATE 16AUG96               *
     F*                 S01408             DATE 22MAY96               *
     F*                 S01408             DATE 29APR95               *
     F*                 073516             DATE 11APR95               *
     F*                 S01453             DATE 13DEC93               *
     F*                 S01444             DATE 21SEP93               *
     F*                 058405             DATE 28OCT93               *
     F*                 S01378             DATE 15OCT92               *
     F*                 E28392             DATE 16JAN92               *
     F*                 E27537             DATE 16JAN92               *
     F*                 S01332             DATE 16JAN92               *
     F*                 S01319             DATE 19AUG91               *
     F*                 E25812             DATE 02AUG91               *
     F*                 DT0204             DATE 05JUN91               *
     F*                 DT0038             DATE 08APR91               *
     F*                 S01311             DATE 15JAN91               *
     F*                 LN0467             DATE 05SEP90               *
     F*                 E231               DATE 15FEB90               *
     F*                 E5                 DATE 12DEC89               *
     F*                 E22                DATE 01NOV89               *
     F*                 S01194             DATE 15/05/89              *
     F*                 S01117             DATE 15/05/89              *
     F*                 S01184             DATE 19FEB90               *
     F*                 E22855             DATE 29JUL90               *
     F*                 E20251             DATE 25JUN90               *
     F*                 BHF486             DATE 11SEP90               *
     F*                 E22567             DATE 22JUN90               *
     F*                 S01199             DATE 27FEB90               *
     F*                 E20901             DATE 25/01/90              *
     F*                 S01203             DATE 04/04/89              *
     F*                 S01157             DATE 04/10/88              *
     F*                 E15119             DATE 16/09/88              *
     F*                 E14702             DATE 14/08/88              *
     F*                 E13029             DATE 05/05/88              *
     F*                 S01136             DATE 15/12/87              *
     F*                 S01119             DATE 28/07/87              *
     F*                 E10784             DATE 20/05/87              *
     F*                 E10218             DATE 18/02/87              *
     F*                 S01004             DATE 11/07/86              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  MD057842 - Various CSD103 related errors                     *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  245692 - Incorrect validation of rates when the decimal se-  *
      *           parator in the Dealing ICD was defined as "," ins-  *
      *           tead of ".".                                        *
      *         - Applied for MD-23981.                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  260855 - Initialise *IN39 to avoid TCUCY of RX deal being    *
      *           used by SALE ccy of another deal.                   *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  259968 - Customer deals enquiry shows strange characters on  *
      *           overview screen.                                    *
     F*  117478 - Deal type CI(certificate of deposit issued) is         *
     F*           being reported against the internal customer.          *
     F*           It should be picked up via the counterparty            *
     F*           which on DEALSDC is held in field CHNA so new          *
     F*           format on DEALSDC needs handling.                      *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG11439 - Incorrect processing if shortname entered.        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  CDL033 - Floating Rate CDs Issued (Recompile)                *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  229544 - Recompiled due to inserted fields in DLCHISPD.      *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes.                                  *
      *  BG2171 - Recompilations omitted by BUG1832                   *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  214207 - Options ODCD and ODEC impossible to page up/down.   *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in FXDEALPP,*
      *           MMDELDPP, MMDENBPP and MMDENSPP.                    *
      *  208051 - Format -ve rates with a leading '-' sign.           *
      *  CSD007 - Customer Closing                                    *
      *  CGL011 - Collateral Processing for Midas                     *
     F*  155954 - Applied fix no 143256                               *
     F*           Reversed deals are not shown when matured deals     *
     F*           only are enquired. Applied fix 130902 .             *
     F*           Reversed deals that were not deleted today was      *
     F*           still displayed.  Fix 104439 was incomplete.        *
     F*           When deal was not deleted today, narrative status   *
     F*           should be 'REVERSED' instead of 'DELETED'.          *
     F*         - Do not display deleted/reversed deals that were not *
     F*           deleted today. Applied fix 104439 .                 *
      *  CDL006 - Dealing Fiduciary                                   *
      *  CTI002 - Recompiled : File SDEXPMPD changed                  *
     F*  087231 - Incorrect Yield Rate displayed for some deals; if   *
     F*           deal type not C1, C2, BP or BD, use field HLDCRT.   *
     F*  S01408 - Addition of core hook: DL0120CCP6                   *
     F*  S01408 - Addition of core hook: DL0120IIP1                   *
     F*           Addition of core hook: DL0120FFP1                   *
     F*           Addition of core hook: DL0120CCP3                   *
     F*           Addition of core hook: DL0120CCP4                   *
     F*           Addition of core hook: DL0120CCP5                   *
     F*  S01408 - Addition of core hook: DL0120CCP1                   *
     F*           Addition of core hook: DL0120CCP2                   *
     F*  073516 - Use decimal point and thousand separator as set up  *
     F*           in ICD                                              *
     F*  S01453 - Margin and FX Positions/Points and Base currency    *
     F*           Positions/Points added to FX input (Recompiled)     *
     F*  S01444 - Program amended so that deals on the new historic   *
     F*           deals file will be included.                        *
     F*  058405 - Does not show confirmation matching status even     *
     F*           though there is feedback available.  Correct key    *
     F*           is not set up before CHAINing to LF/CFFEEDL0.       *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction (was MOF53). Include parcel             *
     F*           details on enquiry for na's purchased and sold.     *
     F*  E28392 - IF MULTIBRANCHING IS OFF CALL CONSOLIDATED          *
     F*           VERSION OF THE REPORT                               *
     F*  E27537 - FORMAT THE INTEREST RATE SPREAD IF THE BASE RATE    *
     F*           CODE IS EITHER BLANK OR '00' AS SOME DEALS EXIST    *
     F*           WITH '00' AS A BASE RATE CODE                       *
     F*  S01332 - Amended to allow linked enquiry for FRAs IRS' and   *
     F*           Options in Exposure Management Release 10           *
     F*  S01319 - Remove redundant processing                         *
     F*  E24812 - ERROR MESSAGES ARE GETTING DISPLAYED. NEED TO       *
     F*           WRITE OUT RECORD FORMAT DL0120F3                    *
     F*  DT0204 - REPORT PROGRAM CALLED CHANGED TO BE STANDARD        *
     F*           RCF PROGRAM FC0040X                                 *
     F*  DT0038 - Recompiled to pick up S01311 changes to DL0120FM    *
     F*  S01311 - Amended to allow linked enquiry for Exposure        *
     F*           Management Release 10                               *
     F*  LN0467 - CHANGE PROGRAMME TO ALLOW SELECTION BY BRANCH       *
     F*           AND ALSO USE STANDARD VALIDATION USING SPF          *
     F*  E231   - CHECK AUTHORITY OF USER TO BOOKING BRANCH AND       *
     F*           REMOVE ALL USE OF F6                                *
     F*  E5     - REPORT REQUEST MUST CONFORM TO RCF STANDARDS        *
     F*  E22    - 1.AMENDED SO THAT CUSTOMER SHORT NAME IS            *
     F*             DISPLAYED AFTER CALLING AOCUSTR0 WITH '?'         *
     F*             PARAMETER                                         *
     F*           2.CHANGED PARM @RTCD IN CALL TO AOCUSTR0            *
     F*             TO '*BLANKS'                                      *
     F*  S01194 - NEW STANDING DATA - ADD ACCESS PROGRAMS             *
     F*  S01117 - RELEASE 10 - MULTIBRANCHING                         *S01117
     F*  S01184 - CONFIRMATION MATCHING                               *S01184
     F*           ADD IN MATCH STATUS OF RELATED COUNTERPARTY         *S01184
     F*           AND BROKER CONFIRMATIONS.                           *S01184
     F*  E22855 - HELP TEXT                                       *
     F*  E20251 - Does not show deals 'N'.                            *E20251
     F*           Delete all reference to                             *E20251
     F*           CUSDL, MMCUSDLL and FXCUSDLL as all deals can be    *E20251
     F*           viewed through the CACUSDLL FILE.                   *E20251
     F*  (BHF486 - USE CACUSDL1, MULTIBRANCHING LOGICAL, AND ABOVE    *E20251
     F*           SPEED UP COB BY REMOVING REDUNDANT FILES. THIS WILL *
     F*           SPEED UP DLC0606B WHICH IS A COB BOTTLENECK DUE TO  *
     F*           DEPENDANCIES.)                                      *
     F*  E22567 - Show Midas deal type not DRS                        *E22567
     F*  S01199 - RECOMPILED FOR  HELP SYSTEM                      *
     F*  E20901 - AMOUNTS BEING SHOWN AS +VE OR -VE WHEN OUTPUT TO    *
     F*           SCREEN (AS HELD THIS WAY ON FILE). SIGN REMOVED.    *
     F*  E15119 - INCORPORATION CHANGES                               *S01203
     F*  S01157 - (i)  FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL'    *S01157
     F*           INTO 'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).    *S01157
     F*           DO NOT OUTPUT CEILING RATE IF DEAL TYPE IS 'FR'.    *S01157
     F*           (ii) ALTER REPORT TO DISPLAY BUY/SELL INDICATOR     *S01157
     F*           NEXT TO THE DEAL SUB TYPE (eg. 'FR-01B')            *S01157
     F*  E15119 - IF MULTIPLE RECORDS ARE SELECTED FOR BROWSING, THE  *
     F*           1ST RECORD ONLY IS DISPLAYED. (ONLY IF SPACE-BAR    *
     F*           HAS BEEN USED TO MOVE THE CURSOR ON THE SCREEN.)    *
     F*  E14702 - FD FILES ACCESSED IRRESPECTIVE OF WHETHER DRS IS    *
     F*           INSTALLED OR NOT, CAUSING DB ERROR.                 *
     F*  E13029 - INCREASE SIZE OF RELATIVE RECORD NUMBER OF          *E13029
     F*           SUBFILE.                                            *E13029
0011 F*  S01136 - DRS INCORPORATION - INCLUDE PROCESSING FOR FX/MM    *
0011 F*           DEALS FILE AS PROGRAM SPECIFICATION MM0065          *
0011 F*  S01119 - FRA/IRS INCORPORATION HAS ADDED 4 MORE DEAL TYPES   *
0011 F*  E10784 - DECIMAL PLACES FROM PURCHASE CURRENCY BEING USED    *E10784
0011 F*           TO EDIT BOTH CURRENCIES.                            *E10784
0011 F*  E10218 - I-SPECS INCORRECTLY DEFINED FOR CUSDL               *
     F*  DESCRIPTION OF LAST CHANGE:      THIS ENQUIRY PROGRAM HAS    *
     F*  BEEN RE-WRITTEN USING A SUBFILE. IT NOW ALLOWS LIVE AND/OR   *
     F*  MATURED RECORDS TO BE OUTPUT WITH THE OPTION TO PRINT        *
     F*  THOSE RECORDS. LINKS TO THE SHORTNAME ENQUIRY AND DEALS      *
     F*  FILE ENQUIRY HAVE ALSO BEEN INCLUDED.                        *
0012 F*****************************************************************
     FDL0120FMCF  E                    WORKSTN
     F                                        RCDNBRKSFILE DL0120F2
0018 F*USDL***IF**F     400  6AI    11 DISK                               S01119
0018 F*****CUSDL   IF  F     600  6AI    11 DISK                   S01119 S01136
0018 F*********CUSDL   IF  F     600  6AI    11 DISK               S01136 E20251
0019 F*****CLINT   IF  F     256  7AI     2 DISK                          S01194
0020 F*****SNAME   IF  F     256 10AI    39 DISK                          S01194
0021 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
     F*ACUSDLLIF**E***********K        DISK         KINFSR *PSSR   S01136 E20251
     F*ACUSDLLIF**E***********K        DISK         KINFSR *PSSR UC E20251LN0467
     FCACUSDL1IF  E           K        DISK         KINFSR *PSSR      UC  LN0467
     F            DEALSDBF                          KRENAMECADLSDBF       E20251
     F            DEALSDCF                          KRENAMECADLSDCF       E20251
     F            DLSDCFCI                          KRENAMECADLSCI        117478
     F            DEALSDDF                          KRENAMECADLSDDF       E20251
     F            DEALSDEF                          KRENAMECADLSDEF       E20251
     F            DEALSDGF                          KRENAMECADLSDGF       S01136
     F            DLBHISD0                          KRENAMECADHIBD0       S01444
     F            DLCHISD0                          KRENAMECADHICD0       S01444
     F            DLDHISD0                          KRENAMECADHIDD0       S01444
     F            DLEHISD0                          KRENAMECADHIED0       S01444
     F            DLGHISD0                          KRENAMECADHIGD0       S01444
     F                                              KINFDS INIDS          S01136
     FEMCUSFXLIF  E           K        DISK         KINFSR *PSSR      UC  S01311
     F            FXDEALP0                          KRENAMEFXDEALP1       S01311
     F                                              KINFDS INJDS          S01311
     FEMCUSMMLIF  E           K        DISK         KINFSR *PSSR      UC  S01311
     F            MMDELDP0                          KRENAMEMMDELDP1       S01311
     F            MMDENBP0                          KRENAMEMMDENBP1       S01311
     F            MMDENSP0                          KRENAMEMMDENSP1       S01311
     F                                              KINFDS INKDS          S01311
     FEMCUSFRLIF  E           K        DISK         KINFSR *PSSR      UC  S01332
     F            DEALSDGF                          KRENAMEEMCUSFRF       S01332
     FEMCUSIRLIF  E           K        DISK         KINFSR *PSSR      UC  S01332
     F            DEALSDGF                          KRENAMEEMCUSIRF       S01332
     F*FXCUSDLLIF**E***********K        DISK         KINFSR *PSSR     UC  E20251
     F*********** FXDEALP0                          KRENAMEFXDEALP1       E20251
     F*********** DEALSDCF                          KRENAMEFXDLSDCF       E20251
     F*********** DEALSDDF                          KRENAMEFXDLSDDF       E20251
     F*********** DEALSDEF                          KRENAMEFXDLSDEF       E20251
     F*********** DEALSDGF                          KRENAMEFXDLSDGF       E20251
     F***********                                   KINFDS INGDS          E20251
     F*MMCUSDLLIF**E***********K        DISK         KINFSR *PSSR     UC  E20251
     F*********** DEALSDBF                          KRENAMEMMDLSDBF       E20251
     F*********** DEALSDGF                          KRENAMEMMDLSDGF       E20251
     F*********** MMDELDP0                          KRENAMEMMDELDP1       E20251
     F*********** MMDENBP0                          KRENAMEMMDENBP1       E20251
     F*********** MMDENSP0                          KRENAMEMMDENSP1       E20251
     F***********                                   KINFDS INHDS          E20251
     F********** FXTB40LLIF  EK        DISK         KINFSR *PSSR          E14702
     F*XTB40LLIF**E***********K        DISK         KINFSR *PSSR    E14702S01194
     F*DCCYDLLIF**E***********K        DISK         KINFSR *PSSR    S01136S01194
     F********** FDINSTLLIF  E         DISK         KINFSR *PSSR          E14702
     F*FDINSTLLIF**E*******************DISK*********KINFSR**PSSRUC**E14702S01319
     F********** FDPMNTLLIF  E         DISK         KINFSR *PSSR          E14702
     F*FDPMNTLLIF**E*******************DISK*********KINFSR**PSSRUC**E14702S01319
     FFDMNTHLLIF  E                    DISK         KINFSR *PSSR      UC  S01319
     FCFFEEDL0IF  E           K        DISK                               S01184
     FSDEXPML1IF  E           K        DISK                               S01332
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0120FFP1                                           S01408
     F*                                                                   S01408
     F*****************************************************************   S01184
0023 F* 01            WORKSTN RECORD ID
0013 F* 02   USED TO CONDITION FIRST TIME PASS THROUGH RPG CALC CYCLE
0025 F**04************CUSDL B RECORD - FX                                 E20251
0026 F**05************CUSDL C RECORD - LOANS/DEPOSITS                     E20251
0027 F**06************CUSDL D RECORD - NA PURCHASED                       E20251
0028 F**07************CUSDL E RECORD - NA SOLD                            E20251
0025 F* 04            CACUSDL1  B RECORD - FX                             E20251
0026 F* 05            CACUSDL1  C RECORD - LOANS/DEPOSITS                 E20251
0027 F* 06            CACUSDL1  D RECORD - NA PURCHASED                   E20251
0028 F* 07            CACUSDL1  E RECORD - NA SOLD                        E20251
0014 F* 08   SET ON IF ERROR DURING READ FROM THE WORK STATION
     F* 09            CATCHALL - ALL FILES
0029 F**10************CLIENT*DETAIL*RECORD**                              S01194
0028 F**11************CUSDL G RECORD - FRA/IRS                      S01119E20251
0028 F**11************CACUSDL1*G*RECORD*-*FRA/IRS**                E20251 S01332
     F* 11   FRA/IRS RECORD FROM CACUSDL1 OR EMCUSFRL OR EMCUSIRL         S01332
0031 F**12************SHORTNAME*DETAIL*RECORD**                           S01194
     F* 17            LIVD BLANK
     F* 18            ROLLUP AND SUBFILE END INDICATOR
     F*       19      'THEIR SPREAD RATE' NON-DISPLAY                     S01119
     F**KA************CMD/1*TO*END*****************************           S01203
     F**KE************CMD/5*FOR*SHORTNAME*ENQUIRY**************           S01203
     F**KH************CMD/8*PRINT*DEALS*FOR*THAT*CUSTOMER******           S01203
     F* KC            CMD/3 TO END                                        S01203
     F**KF************CMD/6*FOR*SHORTNAME*ENQUIRY**************    S01203 E231
     F* KI            CMD/9 PRINT DEALS FOR THAT CUSTOMER                 S01203
     F*       20      SUBFILE DISPLAY
     F*
     F*       21      SUBFILE CONTROL RECORD
0033 F*    22         BLANK CUSTOMER FIELD INPUT
0034 F*    23         MATURITY DATE ZERO
     F********24******DTYP*=*RL*WITH**UDSTI*OR*TDSTI*BIT*OFF***    S01119 S01157
     F*       24      DTYP = RR, RA OR RF WITH  UDSTI OR TDSTI BIT OFF    S01157
0036 F*    25         PURCH/SALE DEAL NO. ZERO
0037 F*    26         'ROLLED OVER BY DEAL NO' IS ZERO
     F*    27         MATD BLANK
     F*    28         LIVD EQUALS 'Y'
     F*    29         MATD EQUALS 'Y'
     F*       31      LIVD AND MATD SELECTED
     F*          32   BUY/SELL INDICATOR FOR FRA/CAP/COLLAR/FLOOR         S01157
     F*    33         ERROR WITH READ CFFEEDL0                            S01184
0042 F*       34      OPTION DEAL
     F*       35      NOSTRO TRANSFER
     F*    36         'OUR BASE RATE' ZERO                                S01119
     F*    37         'OUR SPREAD RATE' NON-DISPLAY                       S01119
     F*    38         'THEIR BASE RATE' ZERO                              S01119
     F*       39      'RX' DEAL TYPE                                      S01119
     F*       40      CHAIN FAIL
     F********41******CUSDL READ UNSUCCESSFUL OR END OF FILE              E20251
     F*       41      CACUSDL1 READ UNSUCCESSFUL OR END OF FILE           E20251
     F*       42      MATURED DEAL
0049 F*       43      NON-DISPLAY MESSAGE FIELD
     F*       44      EOF SUBFILE
     F********45******DTYP=RL*WITH*UDSTI*OR*TDSTI*FLOOR*RATE*BIT*ON S01119S01157
     F*       45      DTYP =RR/RP/RF WITH UDSTI OR TDSTI FLOOR RATE BIT ONS01157
     F*       46      DTYP = CI
     F*       47      DTYP = FR OR RS                                     S01119
     F********48******CUSDL RECORD FOUND                                  E20251
     F*       48      CUCUSDL1 RECORD FOUND                               E20251
     F********49******DTYP*=*RL*AND*OUR*CAP*OR*COLLAR***           S01119 S01157
     F*       49      DTYP = RR, RA OR RF AND OUR CAP OR COLLAR           S01157
     F*       49      DTYP = RL AND OUR CAP OR COLLAR                     S01119
0056 F*       52      NON DISPLAY HEADINGS
     F********53******DTYP*=*RL*AND*THEIR*CAP*OR*COLLAR***         S01119 S01157
     F*       53      DTYP = RR, RA OR RF AND THEIR CAP OR COLLAR         S01157
0057 F*       54      NOT REVERSED DEAL
0058 F*       55      FEDERAL FUND DEAL
0059 F*       56      DEAL IN DOLLARS
1111 F*       57      FEDERAL FUND SALE
     F*               RX DEAL-USED TO TEST BIT 2 OF TDSTI AND OUTPUT 'F'  S01119
0061 F*       58      SALE IN DOLLARS
     F*               RX DEAL-'THEIR CURRENCY' IN DOLLARS                 S01119
     F*       59      CUSTOMER NOT FOUND
0062 F*       60      LIVE FIELD ERROR
0063 F*       61      MATURED FIELD ERROR
0064 F*       62      LEOPSF FIELD ERROR
     F*       63      SUBFILE NEXT CHANGE INDICATOR (SFLNXTCHG)
     F*       64      WORK INDICATOR
     F*       65      CONTROLS OUTPUT OF HEADING                          S01119
     F*       66      NOT FRA/IRS DEAL TYPE                               S01119
     F*       67      'CEILING RATE' ZERO                                 S01119
     F*       70      DISABLE LEOPSF FIELD ON SUBFILE                     S01119
     F*       71      INDICATE READ PREVIOUS RECORD                       S01136
     F********80******FX*OR*MM*EXPOSURE*MANAGEMENT*ENQUIRY*        S01311 S01332
     F*       80      FX MM FR IR OR CC EXPOSURE MANAGEMENT ENQUIRY       S01332
     F*       81      FIRST TIME THROUGH FOR EXPOSURE MANAGEMENT ENQRY    S01311
     F*       94      WORK INDICATOR
     F*       96      USER NOT AUTHORISED TO MENU ITEM                    E231
     F**
     F*****************************************************************   S01184
     E                    CPY@    1   1 80
     E*    TXT LENGTH MUST EQUAL LIN LENGTH OR FOLLOWING ENTRY MOVEA'D    S01119
     E*                                                                   S01119
     E*                   TXT     1   5 56                TEXT            S01119
     E****                TXT     1   9 77                TEXT  S01119    S01157
     E********************TXT     1  11 77                TEXT  S011571157S01378
     E/COPY WNCPYSRC,DL0120E002
     E                    TXT     1  12 77                TEXT            S01378
     E/COPY WNCPYSRC,DL0120E003
0066 E********************ERR     2   7 40                MESSAGES        S01117
     E********************ERR     1   8 46                MESSAGES S01117 E231
     E*********           ERR     1   9 46                MESSAGES    E231
     E***********         ERR     1  11 46                MESSAGES LN0467 S01311
     E***********         ERR     1  13 46                MESSAGES S01311 S01332
     E                    ERR     1  15 46                MESSAGES        S01332
0069 E********************ZA1        16  1               ZALIGN SR. ARRAY S01194
0070 E********************ZA2        16  1               ZALIGN SR. ARRAY S01194
0071 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0073 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E********************ZBR       100  3               SPF USER/BRS01117LN0467
     E*                   LIN        56  1               LINE02 SR ARRAY  S01119
     E                    LIN        77  1               LINE02 SR ARRAY  S01119
     E*    ARRAYS FOR EDITING AN AMOUNT ACCORDING TO NO. OF DPS.
     E                    ZEDT        5  4               EDITED AMOUNT
     E                    ZED2        6  3               AMT WITH NO COMMA
     E                    ZAMT        5  3               AMOUNT FIELD
     E                    Z3          3  1               DUMMY 3 CHAR FLD
     E**********          ZCOM    1   4 20               EDT CHARS FOR AMT                    245692
     E                    ZCOM    1   7 20               EDT CHARS FOR AMT                    245692
     E                    RAT        11  1 0             EDITED AMOUNT
     E                    OUT        12  1               EDITED AMOUNT
     E*                                                                   S01136
     E**  ARRAY OF MONTH NAMES                                            S01136
     E                    @MN        12  3                                S01136
     E*                                                                   S01136
     E** ARRAY FOR ALLIGN AND VALIDATION                                  S01136
     E                    @A1        10  1                                S01136
     E                    @A2        10  1                                S01136
     E*                                                                   S01136
     E** ARRAYS USED IN SR.ZA0750                                         S01136
     E*                                                                   S01136
     E** ARRAY FOR AMOUNT INPUT                                           S01136
     E                    @D         15  1                                S01136
     E*                                                                   S01136
     E** ARRAY FOR DISPLAY AMOUNT                                         S01136
     E                    @E         21  1                                S01136
     E*                                                                   S01136
     E** WORK ARRAY                                                       S01136
     E                    @C         21  1                                S01136
     E*                                                                   S01136
     E** ARRAY USED BY STANDARD SR.MM1013                                 S01136
     E                    @W         13  1                                S01136
     E*                                                                   S01136
     E*                                                                   S01136
     E** TABLE FOR DEAL STATUS NARRATIVE                                  S01136
     E******************* TABA    1   6  1   TABB    7             S01136 E20251
     E********************TABA****1***7**1***TABB****7*************E20251*S01319
     E                    TABA    1   6  1   TABB    7                    S01319
     E*                                                                   S01378
     E** @IN, @OUT used to format parcel size (drop leading zeros)        S01378
     E                    @IN         5  1                                S01378
     E                    @OUT        5  1                                S01378
     E/COPY WNCPYSRC,DL0120E001
0074 E*
0089 I******************                                                  E20251
0093 I****CUSTOMER/DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.       E20251
0094 I******************                                                  E20251
0095 I*USDL***NS**04***1*CD***8*CB                                        E20251
0098 I*******OR********1*CR***8*CB                                        E20251
     I*******OR********1*CM***8*CB                                        E20251
     I*******OR********1*CN***8*CB                                        E20251
     I*******OR********1*CE***8*CB                                        E20251
0099 I**************                          1   1 RECIC                 E20251
0100 I**************                          2   70DLNO                  E20251
0101 I**************                          8   8 RCDT                  E20251
0102 I**************                          9  100RCDC                  E20251
0103 I**************                         11  160CNUM                  E20251
0104 I**************                         17  190BRCD                  E20251
0105 I**************                         20  21 DTYP                  E20251
0106 I**************                         22  23 DLST                  E20251
0107 I**************                      P  24  260DDAT                  E20251
0108 I**************                      P  27  290VDAT                  E20251
0109 I**************                      P  30  320OTDT            23    E20251
0110 I**************                         35  38 BRKC                  E20251
0111 I**************                      P  39  450BAGE                  E20251
0112 I**************                         46  48 PUCY                  E20251
0113 I**************                      P  49  550PUAM                  E20251
0114 I**************                      P  56  628EXRT                  E20251
0115 I**************                         86  88 SLCY                  E20251
0116 I**************                      P  89  950SLAM                  E20251
0117 I**************                      P 117 1230BCEQ                  E20251
0118 I**************                      P 131 1378LCXR                  E20251
0119 I**************                        138 1390PCST                  E20251
0120 I**************                        140 151 OPCA                  E20251
0121 I**************                        152 161 TSCN                  E20251
0122 I**************                        162 1630SCST                  E20251
0123 I**************                        164 175 OSCA                  E20251
0124 I**************                        176 185 TPCN                  E20251
0125 I**************                      P 192 1980ORPA                  E20251
0126 I**************                      P 205 2110ORSA                  E20251
0127 I**************                        212 2120FSLI                  E20251
0128 I**************                      P 241 2470SPPD                  E20251
0129 I**************                      P 248 2540SPLA                  E20251
0130 I**************                        255 257 SPLC                  E20251
0131 I**************                        285 2900SODN            24    S01119
0131 I**************                        285 2900SODN           S01119 E20251
0132 I**************                        300 309 FACO                  E20251
0133 I**************                        310 344 SPI                   E20251
0134 I**************                        370 370 DNSI                  E20251
0135 I**************                        371 371 DSTI                  E20251
0136 I**************                        372 372 CNFI                  E20251
0137 I**************                        373 373 ACEI                  E20251
0138 I**************                        374 374 TLXI                  E20251
0139 I**************                      P 391 3930ORED                  E20251
0140 I**************                      P 394 3960LCD                   E20251
0141 I**************                        397 397 CHTP                  E20251
0142 I**************                      P 398 4000TNLU                  E20251
0143 I**************                                                      E20251
0144 I**************                                                      E20251
0145 I*****CUSDL*FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.    E20251
0146 I**************                                                      E20251
0147 I*USDL***NS**05***1*CD   8 CC                                        E20251
0150 I*******OR********1*CR   8 CC                                        E20251
     I*******OR********1*CM   8 CB                                        E10218
     I*******OR********1*CN   8 CB                                        E10218
     I*******OR********1*CE   8 CB                                        E10218
     I*******OR********1*CM   8 CC                                 E10218 E20251
     I*******OR********1*CN   8 CC                                 E10218 E20251
     I*******OR********1*CE   8 CC                                 E10218 E20251
0151 I**************                          1   1 RECIC                 E20251
0152 I**************                          2   70DLNO                  E20251
0153 I**************                          8   8 RCDT                  E20251
0154 I**************                          9  100RCDC                  E20251
0155 I**************                         11  160CNUM                  E20251
0156 I**************                         17  190BRCD                  E20251
0157 I**************                         20  21 DTYP                  E20251
0158 I**************                         22  23 DLST                  E20251
0159 I**************                      P  24  260DDAT                  E20251
0160 I**************                      P  27  290VDAT                  E20251
0161 I**************                      P  30  320MDAT            23    E20251
0162 I**************                         33  340CDAS                  E20251
0163 I**************                         35  38 BRKC                  E20251
0164 I**************                      P  39  450BAGE                  E20251
0165 I**************                         46  48 CCY                   E20251
0166 I**************                      P  49  550PCPL                  E20251
0167 I**************                         56  56 INTC                  E20251
0168 I**************                         63  640BRTT                  E20251
0169 I**************                      P  65  707BRTE                  E20251
0170 I**************                      P  71  767RTSP                  E20251
0171 I**************                      P  77  827INTR                  E20251
0172 I**************                         83  850NOTD                  E20251
0173 I**************                         86 105 RNNA                  E20251
0174 I**************                        106 1110CHNA                  E20251
0175 I**************                        112 1140FACT                  E20251
0176 I**************                        115 1160FCNO                  E20251
0177 I**************                      P 117 1230OPAM                  E20251
0178 I**************                      P 124 1308BCXR                  E20251
0179 I**************                      P 131 1378LCXR                  E20251
0180 I**************                        138 1390SDST                  E20251
0181 I**************                        140 151 OSDA                  E20251
0182 I**************                        152 161 TSTN                  E20251
0183 I**************                        162 1630MDST                  E20251
0184 I**************                        164 175 OMDA                  E20251
0185 I**************                        176 185 TMAN                  E20251
0186 I**************                        186 1910RODN            24    S01119
0186 I**************                        186 1910RODN           S01119 E20251
0187 I**************                      P 192 1980RODA                  E20251
0188 I**************                        199 2040RBDN            26    E20251
0189 I**************                      P 205 2110RBDA                  E20251
0190 I**************                        212 2120ICBS                  E20251
0191 I**************                        213 213 IPFR                  E20251
0192 I**************                      P 214 2200TOTI                  E20251
0193 I**************                      P 221 2230NIDT                  E20251
0194 I**************                      P 224 2260IBDT                  E20251
0195 I**************                      P 227 2290SLID                  E20251
0196 I**************                      P 230 2360AIPD                  E20251
0197 I**************                      P 237 2390DLRC                  E20251
0198 I**************                      P 240 2420IACD                  E20251
0199 I**************                      P 243 2490AITC                  E20251
0200 I**************                      P 250 2560AIAN                  E20251
0201 I**************                      P 257 2630AIAP                  E20251
0202 I**************                      P 264 2700IPRD                  E20251
0203 I**************                      P 271 2770IPRM                  E20251
0204 I**************                      P 278 2840ICTD                  E20251
0205 I**************                      P 294 2960DAVD                  E20251
0206 I**************                        297 2990DASN                  E20251
0207 I**************                        300 309 FACO                  E20251
0208 I**************                        310 344 SPI                   E20251
0209 I**************                        345 3460INTF                  E20251
0210 I**************                        370 370 DNSI                  E20251
0211 I**************                        371 371 DSTI                  E20251
0212 I**************                        372 372 CNFI                  E20251
0213 I**************                        373 373 ACEI                  E20251
0214 I**************                        374 374 TLXI                  E20251
0215 I**************                      P 391 3930ORED                  E20251
0216 I**************                      P 394 3960LCD                   E20251
0217 I**************                        397 397 CHTP                  E20251
0218 I**************                      P 398 4000TNLU                  E20251
0219 I**************                                                      E20251
0220 I*****CUSDL*FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.      E20251
0221 I**************                                                      E20251
0222 I*USDL***NS**06***1*CD   8 CD                                        E20251
0225 I*******OR********1*CR   8 CD                                        E20251
     I*******OR********1*CM   8 CB                                        E10218
     I*******OR********1*CN   8 CB                                        E10218
     I*******OR********1*CE   8 CB                                        E10218
     I*******OR********1*CM   8 CD                                 E10218 E20251
     I*******OR********1*CN   8 CD                                 E10218 E20251
     I*******OR********1*CE   8 CD                                 E10218 E20251
0226 I**************                          1   1 RECIC                 E20251
0227 I**************                          2   70DLNO                  E20251
0228 I**************                          8   8 RCDT                  E20251
0229 I**************                          9  100RCDC                  E20251
0230 I**************                         11  160ISCN                  E20251
0231 I**************                         17  190BRCD                  E20251
0232 I**************                         20  21 DTYP                  E20251
0233 I**************                         22  23 DLST                  E20251
0234 I**************                      P  24  260DDAT                  E20251
0235 I**************                      P  27  290VDAT                  E20251
0236 I**************                      P  30  320MDAT            23    E20251
0237 I**************                         33  340IDAS                  E20251
0238 I**************                         35  38 BRKC                  E20251
0239 I**************                      P  39  450BAGE                  E20251
0240 I**************                         46  48 CCY                   E20251
0241 I**************                      P  49  550PUPR                  E20251
0242 I**************                      P  57  627YRAT                  E20251
0243 I**************                      P  71  767RTSP                  E20251
0244 I**************                      P  77  827INTR                  E20251
0245 I**************                         86 105 RNNA                  E20251
0246 I**************                        106 1110PCUS                  E20251
0247 I**************                        112 1140FACT                  E20251
0248 I**************                        115 1160FCNO                  E20251
0249 I**************                      P 117 1230FVAL                  E20251
0250 I**************                      P 124 1308BCXR                  E20251
0251 I**************                      P 131 1378LCXR                  E20251
0252 I**************                        138 1390SDST                  E20251
0253 I**************                        140 151 OSDA                  E20251
0254 I**************                        152 161 TSTN                  E20251
0255 I**************                        162 1630MDST                  E20251
0256 I**************                        164 175 OMDA                  E20251
0257 I**************                        176 185 TMAN                  E20251
0258 I**************                      P 192 1980DISA                  E20251
0259 I**************                      P 205 2110DPTD                  E20251
0260 I**************                        212 2120ICBS                  E20251
0261 I**************                        213 213 IPFR                  E20251
0262 I**************                      P 214 2200TOTI                  E20251
0263 I**************                      P 221 2230NIDT                  E20251
0264 I**************                      P 224 2260IBDT                  E20251
0265 I**************                      P 227 2290SLID                  E20251
0266 I**************                      P 230 2360AIPD                  E20251
0267 I**************                      P 237 2390DLRC                  E20251
0268 I**************                      P 240 2420IACD                  E20251
0269 I**************                      P 243 2490AITC                  E20251
0270 I**************                      P 250 2560AIAN                  E20251
0271 I**************                      P 257 2630AIAP                  E20251
0272 I**************                      P 264 2700IPRD                  E20251
0273 I**************                      P 271 2770IPRM                  E20251
0274 I**************                      P 278 2840SAPR                  E20251
0275 I**************                        285 2900ASDN            25    E20251
0276 I**************                      P 291 2930SADT                  E20251
0277 I**************                      P 294 2960DAVD                  E20251
0278 I**************                        297 2990DASN                  E20251
0279 I**************                        300 309 FACO                  E20251
0280 I**************                        310 344 SPI                   E20251
0281 I**************                        345 3460INTF                  E20251
0282 I**************                        370 370 DNSI                  E20251
0283 I**************                        371 371 DSTI                  E20251
0284 I**************                        372 372 CNFI                  E20251
0285 I**************                        373 373 ACEI                  E20251
0286 I**************                        374 374 TLXI                  E20251
0287 I**************                      P 391 3930ORED                  E20251
0288 I**************                      P 394 3960LCD                   E20251
0289 I**************                        397 397 CHTP                  E20251
0290 I****************                    P 398 4000TNLU                  E20251
0291 I****************                                                    E20251
0292 I****************                                                    E20251
0293 I*****CUSDL*FILE*- DETAIL RECORD - NEGOTIABLE ASSETS SOLD.           E20251
0294 I****************                                                    E20251
0295 I*USDL***NS**07***1 CD   8 CE                                        E20251
0298 I*******OR********1 CR   8 CE                                        E20251
     I*******OR********1 CM   8 CB                                        E10218
     I*******OR********1 CN   8 CB                                        E10218
     I*******OR********1 CE   8 CB                                        E10218
     I*******OR********1 CM   8 CE                                 E10218 E20251
     I*******OR********1 CN   8 CE                                 E10218 E20251
     I*******OR********1 CE   8 CE                                 E10218 E20251
0299 I**************                          1   1 RECIC                 E20251
0300 I**************                          2   70DLNO                  E20251
0301 I**************                          8   8 RCDT                  E20251
0302 I**************                          9  100RCDC                  E20251
0303 I**************                         11  160CNUM                  E20251
0304 I**************                         17  190BRCD                  E20251
0305 I**************                         20  21 DTYP                  E20251
0306 I**************                         22  23 DLST                  E20251
0307 I**************                      P  24  260DDAT                  E20251
0308 I**************                      P  27  290VDAT                  E20251
0309 I**************                         35  38 BRKC                  E20251
0310 I**************                      P  39  450BAGE                  E20251
0311 I**************                         46  48 CCY                   E20251
0312 I**************                      P  49  550SAPR                  E20251
0313 I**************                      P  57  627YRAT                  E20251
0314 I**************                      P  77  827INTR                  E20251
0315 I**************                         86 105 RNNA                  E20251
0316 I**************                        106 1110ISCN                  E20251
0317 I**************                      P 117 1230FVAL                  E20251
0318 I**************                        138 1390SETP                  E20251
0319 I**************                        140 151 OSAC                  E20251
0320 I**************                        152 161 TSEN                  E20251
0321 I**************                        285 2900RPDN            25    E20251
0322 I**************                        370 370 DNSI                  E20251
0323 I**************                        371 371 DSTI                  E20251
0324 I**************                        372 372 CNFI                  E20251
0325 I**************                        373 373 ACEI                  E20251
0326 I**************                        374 374 TLXI                  E20251
0327 I**************                      P 391 3930ORED                  E20251
0328 I**************                      P 394 3960LCD                   E20251
0329 I**************                        397 397 CHTP                  E20251
0330 I**************                      P 398 4000TNLU                  E20251
0331 I**************                                                      E20251
     I*****CUSDL*FILE - DETAIL - FRA/IRS                           S01119 E20251
     I**************                                               S01119 E20251
     I*USDL***NS**11***1*CD   8 CG                                 S01119 E20251
     I*******OR********1*CE   8 CG                                 S01119 E20251
     I*******OR********1*CM   8 CG                                 S01119 E20251
     I*******OR********1*CR   8 CG                                 S01119 E20251
     I*******OR********1*CN   8 CG                                 S01119 E20251
     I**************                          1   1 RECIC          S01119 E20251
     I**************                          2   70DLNO           S01119 E20251
     I**************                          8   8 RCDT           S01119 E20251
     I**************                          9  100RCDC           S01119 E20251
     I**************                         11  160CNUM           S01119 E20251
     I**************                         17  190BRCD           S01119 E20251
     I**************                         20  21 DTYP           S01119 E20251
     I**************                         22  23 DLST           S01119 E20251
     I**************                      P  24  260DDAT           S01119 E20251
     I**************                      P  27  290VDAT           S01119 E20251
     I**************                      P  30  320MDAT           S01119 E20251
     I**************                         33  340CDAS           S01119 E20251
     I**************                         35  38 BRKC           S01119 E20251
     I**************                      P  39  450BAGE           S01119 E20251
     I**************                         46  510LNKDN          S01119 E20251
     I**************                         52  52 HEDIN          S01119 E20251
     I**************                         53  53 TAXI           S01119 E20251
     I**************                         54  56 UCUCY          S01119 E20251
     I**************                      P  57  630UPAMT          S01119 E20251
     I**************                         64  650UBRTT          S01119 E20251
     I**************                      P  66  717USTRT          S01119 E20251
     I**************                      P  72  777UBRTE          S01119 E20251
     I**************                      P  78  837URTSP          S01119 E20251
     I**************                         84  84 USPIN          S01119 E20251
     I**************                      P  85  907UEINR          S01119 E20251
     I**************                         91  910UICBS          S01119 E20251
     I**************                         92  930UFRFD          S01119 E20251
     I**************                      P  94  960UINFD          S01119 E20251
     I**************                      P  97  990USLIP          S01119 E20251
     I**************                      P 100 1020UNICD          S01119 E20251
     I**************                      P 103 1050UICBD          S01119 E20251
     I**************                        106 106 UICFR          S01119 E20251
     I**************                        107 1080UICFD          S01119 E20251
     I**************                      P 109 1110UNIPD          S01119 E20251
     I**************                      P 112 1140UIPBD          S01119 E20251
     I**************                        115 115 UIPFR          S01119 E20251
     I**************                        116 1170UIPFD          S01119 E20251
     I**************                      P 118 1248UBCXR          S01119 E20251
     I**************                      P 125 1270UIACD          S01119 E20251
     I**************                      P 128 1340UIALC          S01119 E20251
     I**************                      P 135 1410UAITC          S01119 E20251
     I**************                      P 142 1480UAIPD          S01119 E20251
     I**************                      P 149 1550UAIAN          S01119 E20251
     I**************                      P 156 1620UAIAP          S01119 E20251
     I**************                      P 163 1690UIPRD          S01119 E20251
     I**************                      P 170 1760UIPRM          S01119 E20251
     I**************                      P 177 1830UNSAM          S01119 E20251
     I**************                      P 184 1900UTAXD          S01119 E20251
     I**************                      P 191 1970UTAXM          S01119 E20251
     I**************                        198 200 TCUCY          S01119 E20251
     I**************                      P 201 2070TPAMT          S01119 E20251
     I**************                        208 2090TBRTT          S01119 E20251
     I**************                      P 210 2157TSTRT          S01119 E20251
     I**************                      P 216 2217TBRTE          S01119 E20251
     I**************                      P 222 2277TRTSP          S01119 E20251
     I**************                        228 228 TSPIN          S01119 E20251
     I**************                      P 229 2347TEINR          S01119 E20251
     I**************                        235 2350TICBS          S01119 E20251
     I**************                        236 2370TFRFD          S01119 E20251
     I**************                      P 238 2400TINFD          S01119 E20251
     I**************                      P 241 2430TSLIP          S01119 E20251
     I**************                      P 244 2460TNICD          S01119 E20251
     I**************                      P 247 2490TICBD          S01119 E20251
     I**************                        250 250 TICFR          S01119 E20251
     I**************                        251 2520TICFD          S01119 E20251
     I**************                      P 253 2550TNIPD          S01119 E20251
     I**************                      P 256 2580TIPBD          S01119 E20251
     I**************                        259 259 TIPFR          S01119 E20251
     I**************                        260 2610TIPFD          S01119 E20251
     I**************                      P 262 2688TBCXR          S01119 E20251
     I**************                      P 269 2710TIACD          S01119 E20251
     I**************                      P 272 2780TIALC          S01119 E20251
     I**************                      P 279 2850TAITC          S01119 E20251
     I**************                      P 286 2920TAIPD          S01119 E20251
     I**************                      P 293 2990TAIAN          S01119 E20251
     I**************                      P 300 3060TAIAP          S01119 E20251
     I**************                      P 307 3130TIPRD          S01119 E20251
     I**************                      P 314 3200TIPRM          S01119 E20251
     I**************                      P 321 3270TNSAM          S01119 E20251
     I**************                      P 328 3340TTAXD          S01119 E20251
     I**************                      P 335 3410TTAXM          S01119 E20251
     I**************                      P 342 3477CLRAT          S01119 E20251
     I**************                      P 348 3537FLRAT          S01119 E20251
     I**************                      P 354 3550AVPER          S01119 E20251
     I**************                      P 356 3638TIRAT          S01119 E20251
     I**************                      P 364 3697AACRT          S01119 E20251
     I**************                        370 3710RSETM          S01119 E20251
     I**************                        372 383 URACC          S01119 E20251
     I**************                        384 393 CPPBK          S01119 E20251
     I**************                        394 3950PSETM          S01119 E20251
     I**************                        396 407 UPACC          S01119 E20251
     I**************                        408 417 CPRBK          S01119 E20251
     I**************                        418 427 FACO           S01119 E20251
     I**************                        428 462 SPI            S01119 E20251
     I**************                      P 463 4650SDCAR          S01119 E20251
     I**************                      P 466 4680ULPCD          S01119 E20251
     I**************                      P 469 4710TLPCD          S01119 E20251
     I**************                      P 472 4780UAEXA          S01119 E20251
     I**************                      P 479 4850TAEXA          S01119 E20251
     I**************                        567 567 BYSL           S01119 E20251
     I**************                        570 570 UDNSI          S01119 E20251
     I**************                        571 571 TDNSI          S01119 E20251
     I**************                        572 572 UDSTI          S01119 E20251
     I**************                        573 573 TDSTI          S01119 E20251
     I**************                        574 574 CNFI           S01119 E20251
     I**************                        575 575 ACEI           S01119 E20251
     I**************                        576 576 TLXI           S01119 E20251
     I**************                      P 587 5880LSWC           S01119 E20251
     I**************                      P 589 5900LSWS           S01119 E20251
     I**************                      P 591 5930ORED           S01119 E20251
     I**************                      P 594 5960LCD            S01119 E20251
     I**************                        597 597 CHTP           S01119 E20251
     I**************                      P 598 6000TNLU           S01119 E20251
0332 I**************                                               S01136 E20251
0335 I*****CATCHALL*                                                      E20251
0336 I**************                                                      E20251
0337 I********NS**09                                                      E20251
0345 I**************                          1   1 RECIC                 E20251
     I***SET*RECORD*ID INDICATORS FOR MIDAS FILES WHEN FX&MM MODULE ON    E20251
0331 I*                                                                   S01136
     I*    DETAIL - FRA/IRS                                               S01136
     I*                                                                   S01136
     ICADLSDGF    11                                                      S01136
0099 I              RECI                            RECIC                 S01136
     I                                              MDAT            23    S01136
     I                                              UBRTT           36    S01136
     I                                              TBRTT           38    S01136
     I                                              CLRAT           67    S01136
     ICADHIGD0    11                                                      S01444
0099 I              RECI                            RECIC                 S01444
     I                                              MDAT            23    S01444
     I                                              UBRTT           36    S01444
     I                                              TBRTT           38    S01444
     I                                              CLRAT           67    S01444
     I*                                                                   S01136
     IFXDEALP0                                                            E20251
0099 I              FHDDLT                          DLREC                 E20251
0099 I              FHDSTS                          RECIC                 E20251
     I*                                                                   S01136
     IMMDELDP0                                                            S01136
0099 I              HKDDLT                          DLREC                 S01136
0099 I              HKDSTS                          RECIC                 S01136
     I*                                                                   S01136
     IMMDENBP0                                                            S01136
0099 I              HLDDLT                          DLREC                 S01136
0099 I              HLDSTS                          RECIC                 S01136
     I*                                                                   S01136
     IMMDENSP0                                                            S01136
0099 I              HMDDLT                          DLREC                 S01136
0099 I              HMDSTS                          RECIC                 S01136
     I*                                                                   S01136
     ICADLSDBF    04                                                      E20251
     I              RECI                            RECIC                 E20251
     I                                              OTDT            23    E20251
     I*                                                                   E20251
     ICADLSDCF    05                                                      E20251
     I              RECI                            RECIC                 E20251
     I                                              MDAT            23    E20251
     I                                              RBDN            26    E20251
     ICADLSCI     05                                                      117478
     I              RECI                            RECIC                 117478
     I                                              MDAT            23    117478
     I                                              RBDN            26    117478
     ICADLSDDF    06                                                      E20251
     I              RECI                            RECIC                 E20251
     I                                              MDAT            23    E20251
     I                                              ASDN            25    E20251
     I              CNUM                            PCUS                  E20251
     ICADLSDEF    07                                                      E20251
     I              RECI                            RECIC                 E20251
     I                                              RPDN            25    E20251
     I*                                                                   S01444
     ICADHIBD0    04                                                      S01444
     I              RECI                            RECIC                 S01444
     I                                              OTDT            23    S01444
     I*                                                                   S01444
     ICADHICD0    05                                                      S01444
     I              RECI                            RECIC                 S01444
     I                                              MDAT            23    S01444
     I                                              RBDN            26    S01444
     ICADHIDD0    06                                                      S01444
     I              RECI                            RECIC                 S01444
     I                                              MDAT            23    S01444
     I                                              ASDN            25    S01444
     I              CNUM                            PCUS                  S01444
     ICADHIED0    07                                                      S01444
     I              RECI                            RECIC                 S01444
     I                                              RPDN            25    S01444
     IFXDEALP1                                                            S01311
0099 I              FHDDLT                          DLREC                 S01311
0099 I              FHDSTS                          RECIC                 S01311
     I*                                                                   S01311
     IMMDELDP1                                                            S01311
0099 I              HKDDLT                          DLREC                 S01311
0099 I              HKDSTS                          RECIC                 S01311
     I*                                                                   S01311
     IMMDENBP1                                                            S01311
0099 I              HLDDLT                          DLREC                 S01311
0099 I              HLDSTS                          RECIC                 S01311
     I*                                                                   S01311
     IMMDENSP1                                                            S01311
0099 I              HMDDLT                          DLREC                 S01311
0099 I              HMDSTS                          RECIC                 S01311
     I/COPY WNCPYSRC,DL0120I001
      *                                                                   S01332
     IEMCUSFRF    11                                                      S01332
     I              RECI                            RECIC                 S01332
     I                                              MDAT            23    S01332
     I                                              UBRTT           36    S01332
     I                                              TBRTT           38    S01332
     I                                              CLRAT           67    S01332
      *                                                                   S01332
     IEMCUSIRF    11                                                      S01332
     I              RECI                            RECIC                 S01332
     I                                              MDAT            23    S01332
     I                                              UBRTT           36    S01332
     I                                              TBRTT           38    S01332
     I                                              CLRAT           67    S01332
     A*                                                                   E20251
     I********************                                                E20251
     I***SET*RECORD*ID*INDICATORS FOR MIDAS FILES WHEN MM MODULE ONS01136 E20251
     I********************                                         S01136 E20251
     I*MMDELDP1***********                                         S01136 E20251
0099 I************* HKDDLT                          DLREC          S01136 E20251
0099 I************* HKDSTS                          RECIC          S01136 E20251
     I*************                                                S01136 E20251
     I*MMDENBP1****                                                S01136 E20251
0099 I************* HLDDLT                          DLREC          S01136 E20251
0099 I************* HLDSTS                          RECIC          S01136 E20251
     I*************                                                S01136 E20251
     I*MMDENSP1****                                                S01136 E20251
0099 I************* HMDDLT                          DLREC          S01136 E20251
0099 I************* HMDSTS                          RECIC          S01136 E20251
0089 I*************                                                S01136 E20251
0093 I*****DETAIL*RECORD - FX SWAPS/OUTRIGHTS.                     S01136 E20251
0094 I*************                                                S01136 E20251
0095 I*MMDLSDBF****04                                              S01136 E20251
0099 I************* RECI                            RECIC          S01136 E20251
0109 I*************                                 OTDT           S01136 E20251
0331 I*************                                                S01136 E20251
     I*****DETAIL*-*FRA/IRS                                        S01136 E20251
     I*************                                                S01136 E20251
     I*MMDLSDGF****11                                              S01136 E20251
0099 I************* RECI                            RECIC          S01136 E20251
     I*************                                 MDAT           S01136 E20251
     I*************                                 UBRTT          S01136 E20251
     I*************                                 TBRTT          S01136 E20251
     I*************                                 CLRAT          S01136 E20251
     I*************                                                S01136 E20251
     I***SET*RECORD ID INDICATORS FOR MIDAS FILES WHEN FX MODULE ONS01136 E20251
     I*************                                                S01136 E20251
     I*FXDEALP1****                                                S01136 E20251
0099 I************* FHDDLT                          DLREC          S01136 E20251
0099 I************* FHDSTS                          RECIC          S01136 E20251
0144 I*************                                                S01136 E20251
0145 I*****DETAIL*- TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.          S01136 E20251
0146 I*************                                                S01136 E20251
0147 I*FXDLSDCF****05                                              S01136 E20251
0099 I************* RECI                            RECIC          S01136 E20251
0161 I*************                                 MDAT           S01136 E20251
0188 I*************                                 RBDN           S01136 E20251
0219 I*************                                                S01136 E20251
0220 I*****DETAIL*RECORD - NEGOTIABLE ASSETS PURCHASED.            S01136 E20251
0221 I*************                                                S01136 E20251
0222 I*FXDLSDDF****06                                              S01136 E20251
0099 I************* RECI                            RECIC          S01136 E20251
0236 I*************                                 MDAT           S01136 E20251
0275 I*************                                 ASDN           S01136 E20251
0292 I*************                                                S01136 E20251
0293 I*****DETAIL*RECORD - NEGOTIABLE ASSETS SOLD.                 S01136 E20251
0294 I**************                                               S01136 E20251
0295 I*FXDLSDEF****07                                              S01136 E20251
0099 I**************RECI                            RECIC          S01136 E20251
0321 I**************                                RPDN           S01136 E20251
0331 I**************                                               S01136 E20251
     I*****DETAIL*-*FRA/IRS                                        S01136 E20251
     I**************                                               S01136 E20251
     I*FXDLSDGF****11                                              S01136 E20251
0099 I**************RECI                            RECIC          S01136 E20251
     I**************                                MDAT           S01136 E20251
     I**************                                UBRTT          S01136 E20251
     I**************                                TBRTT          S01136 E20251
     I**************                                CLRAT          S01136 E20251
0338 I*****TABLE*FILE*-*CURRENCIES*RECORD*1.***                           S01194
0339 I***********                                                         S01194
0340 I***********                                                         S01194
0341 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**             S01194
0342 I***********                                                         S01194
0343 I*ABLE***NS*      2 C0   3 C1  12 C1                                 S01194
0344 I*******AND*     13 C0                                               S01194
0345 I***********                             1   1 RECI                  S01194
0346 I***********                             2   30RECT                  S01194
0347 I***********                            12  130RCDE                  S01194
0348 I***********                            14  66 TITL                  S01194
0349 I***********                            67  67 DATF                  S01194
0350 I***********                            68  700DFBR                  S01194
0351 I***********                            74  74 MODI1                 S01194
0352 I***********                            75  75 MODI2                 S01194
0353 I***********                            76  76 MODI3                 S01194
0354 I***********                         P  77  790RUND                  S01194
0355 I***********                            80  86 RUNA                  S01194
0356 I***********                            87  870SFLG                  S01194
0357 I***********                         P  90  920LCD                   S01194
0358 I***********                            93  93 CHTP                  S01194
0359 I***********                         P  94  960TNLU                  S01194
     I***********                                                   S01117S01194
     I***********                                                   S01117S01194
     I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.**       S01117S01194
     I***********                                                   S01117S01194
     I*ABLE***NS*      1 CD   2 C0   3 C1                           S01117S01194
     I*******AND*     12 C1  13 C1                                  S01117S01194
     I***********                             1   1 RECI            S01117S01194
     I***********                            53  53 MBIN            S01117S01194
0360 I***********                                                         S01194
0361 I*ABLE***NS*      1 CD   2 C2   3 C0                                 S01194
0362 I*******AND*     13 C1                                               S01194
0363 I***********                            38  380XDECP                 S01194
0364 I***********                                                         S01194
0365 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*5.**             S01194
0366 I***********                                                         S01194
0367 I*ABLE***NS*      1 CD   2 C0   3 C1                                 S01194
0368 I*******AND*     12 C4  13 C0                                        S01194
0369 I***********                             1   1 RECI                  S01194
0370 I***********                            47  49 USCY                  S01194
0371 I***********                                                         S01194
0372 I********NS* 09                                                      S01194
0373 I***********                                                         S01194
0374 I*LINT***NS* 10   1 CD                                               S01194
0375 I***********                             2   70CNUM                  S01194
0376 I***********                            39  48 CSNM                  S01194
0377 I***********                             9  28 CRNM                  S01194
0378 I***********                            29  38 CTWN                  S01194
     I***********                            94  96 CBRCD           S01117S01194
0379 I********NS* 09                                                      S01194
0380 I*NAME***NS* 12   1 CD                                               S01194
0381 I***********                             2   7 CNUMX                 S01194
0382 I********NS* 09                                                      S01194
     I*FDPMNTL1***********************************************************S01319
     IFDMNTHP0                                                            S01319
     I              MNNM1                           @MN,1
     I              MNNM2                           @MN,2
     I              MNNM3                           @MN,3
     I              MNNM4                           @MN,4
     I              MNNM5                           @MN,5
     I              MNNM6                           @MN,6
     I              MNNM7                           @MN,7
     I              MNNM8                           @MN,8
     I              MNNM9                           @MN,9
     I              MNNM10                          @MN,10
     I              MNNM11                          @MN,11
     I              MNNM12                          @MN,12
0383 I*****DATA*STRUCTURE*FOR*KEY*TO*CURRENCY*TABLE.**                    S01194
0384 I************DS                                                      S01194
0385 I************                            1  12 XCYKEY                S01194
0386 I************                            1   8 XCY1                  S01194
0387 I************                            9  11 XXCCY                 S01194
0388 I************                           12  12 XCY2                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I** EXTERNAL DS FOR BANK DETAILS                                     S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I** EXTERNAL DS FOR TRADING DETAILS                                  S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01194
     I              BBCSSN                          CSNM
     I              BBCRTN                          CTWN
     I              BBCRNM                          CRNM
     ISDBRCH    E DSSDBRCHPD                                              LN0467
     I              QQDFAC                          QQDFA1                                    CGL029
     I** EXTERNAL DS FOR BRANCH CODES                                     LN0467
     I*                                                                   LN0467
     ISDDEAL    E DSSDDEALPD                                              S01319
     I              QQACCD                          QQACC1                                    CGL029
     I** EXTERNAL DS FOR DEALING DETAILS                                  S01319
     I*
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
     IRUNDAT      DS                             13                       S01194
     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01194
     I                                    P   8  100@RDNB                 E231
     I                                       13  13 @MBIN                 S01194
      *                                                                   E231
     IZMUSER      DS                             17                       E231
     I**  USER DETAILS DATA AREA                                          E231
     I                                       11  13 @DFBR                 E231
     I                                       17  17 BANK                  LN0467
      *                                                                   E231
     I*                                                                   S01194
     I**  EXTERNAL DATA AREA OF BRANCHES FOR THIS USER, TOP DOWN    S01117LN0467
     I*ZBRU        DS                                               S01117LN0467
     I**********                              1   1 ZCHB            S01117LN0467
     I**********                              2   4 ZIN             S01117LN0467
     I**********                              5 154 ZBR1            S01117LN0467
     I**********                            155 304 ZBR2            S01117LN0467
     I*                                                                   S01136
     I**                                                                  S01117
0383 I*****DATA*STRUCTURE*OF*CUSTOMER*INPUT*FIELD.***                     S01194
0384 I************DS**************************                            S01194
     I****************************************1  10 CUST                  S01194
0385 I****************************************1  10 ICUST                 S01194
     I****************************************1   6 ICUSN                 S01194
     I****************************************                            S01136
     I** DATA STRUCTURE FOR MODULES PRESENT                               S01136
     I*MODS       DS                             64                       S01136
     IMMODS       DS                            256                       S01136
     I***************************************11**11*MODFD***********E14702S01319
     I***********                            13  14 MODS            S01136BHF486
     I                                       60  60 @CNF                  S01184
     I*                                                                   S01136
     I** INFORMATION DATA STRUCTURE,FOR FORMAT ACCESSED                   S01136
     I*                                                                   S01136
     I*INGDS****** DS                                              S01136 E20251
     I************                         *RECORD  RECGMT         S01136 E20251
     I************                                                 S01136 E20251
     I*INHDS****** DS                                              S01136 E20251
     I************                         *RECORD  RECHMT         S01136 E20251
     I************                                                 S01136 E20251
     IINIDS       DS                                                      S01136
     I                                     *RECORD  RECIMT                S01136
     IINJDS       DS                                                      S01311
     I                                     *RECORD  RECJMT                S01311
     IINKDS       DS                                                      S01311
     I                                     *RECORD  RECKMT                S01311
     I*                                                                   S01136
     I**  Used by ZA0660 - Date input in YYYYMMDD format                  S01136
     I            DS                                                      S01136
     I                                        1   80@@DTIN                S01136
     I                                        1   40@@YYYY                S01136
     I                                        5   60@@MTH                 S01136
     I                                        7   80@@DAY                 S01136
     I*                                                                   S01136
     I** DRS - DL VALUE DATE DATA STRUCTURE                               S01136
     I            DS                                                      S01136
     I                                        1   80@VDAT                 S01136
     I                                        1   40FHVDYY                S01136
     I                                        1   40HKVDYY                S01136
     I                                        1   40HLVDYY                S01136
     I                                        1   40HMVDYY                S01136
     I                                        5   60FHVDMM                S01136
     I                                        5   60HKVDMM                S01136
     I                                        5   60HLVDMM                S01136
     I                                        5   60HMVDMM                S01136
     I                                        7   80FHVDDD                S01136
     I                                        7   80HKVDDD                S01136
     I                                        7   80HLVDDD                S01136
     I                                        7   80HMVDDD                S01136
     I*                                                                   S01136
     I*                                                                   S01136
     I** DRS - DL OPTION END DATE DATA STRUCTURE.                         S01136
     I            DS                                                      S01136
     I                                        1   80@ODAT                 S01136
     I                                        1   40FHDOEY                S01136
     I                                        5   60FHDOEM                S01136
     I                                        7   80FHDOED                S01136
     I*                                                                   S01408
     ISCSARD    E DSSCSARDPD                                              CDL006
      ** External Data Structure for Switchable Features                  CDL006
      *                                                                   CDL006
      ** Data Structure for Sell Date                                                         CDL099
      *                                                                                       CDL099
     I            DS                                                                          CDL099
     I                                        1   80USDAT                                     CDL099
     I                                        1   40FHVS2Y                                    CDL099
     I                                        5   60FHVS2M                                    CDL099
     I                                        7   80FHVS2D                                    CDL099
      *                                                                                       CDL099
     I/COPY WNCPYSRC,DL0120IIP1                                           S01408
     I*                                                                   S01408
     I*                                                                   S01136
     I** DRS - DL DONE DATE DATA STRUCTURE.                               S01136
     I            DS                                                      S01136
     I                                        1   80@DDAT                 S01136
     I                                        1   40FHDDYY                S01136
     I                                        1   40HKDDYY                S01136
     I                                        1   40HLDDYY                S01136
     I                                        1   40HMDDYY                S01136
     I                                        5   60FHDDMM                S01136
     I                                        5   60HKDDMM                S01136
     I                                        5   60HLDDMM                S01136
     I                                        5   60HMDDMM                S01136
     I                                        7   80FHDDDD                S01136
     I                                        7   80HKDDDD                S01136
     I                                        7   80HLDDDD                S01136
     I                                        7   80HMDDDD                S01136
     I** DRS - DL MATURITY  DATE STRUCTURE.                               S01136
     I            DS                                                      S01136
     I                                        1   80@MDAT                 S01136
     I                                        1   40HKMDYY                S01136
     I                                        1   40HLMDYY                S01136
     I                                        1   40HMMDYY                S01136
     I                                        5   60HKMDMM                S01136
     I                                        5   60HLMDMM                S01136
     I                                        5   60HMMDMM                S01136
     I                                        7   80HKMDDD                S01136
     I                                        7   80HLMDDD                S01136
     I                                        7   80HMMDDD                S01136
     I*                                                                   S01136
     I* DATSTRUCTURE USED IN SUBROUTINE ZA0750                            S01136
     I* DATASTUCTURE TO CONVERT 7@IAMT DECIMAL FIELD TO ALPHA FIELD       S01136
     I*                                                                   S01136
     I@@AMDS      DS                             15                       S01136
     I                                        1  150@@IAMT                S01136
     I*                                                                   S01136
     I** DATA STRUCTURE FOR JOB AND USER ID                               S01136
     IPSDS       SDS                                                      S01136
     I*                                                                   S01136
     I** WORKSTATION ID                                                   S01136
     I                                      244 246 WSID
     I                                      244 253 @JOB                  S01136
     I*                                                                   S01136
     I** USER ID                                                          S01136
     I                                      254 263 @USER                 S01136
0383 I**   DATA STRUCTURE FOR RATE AMOUNT
0384 I            DS
     I                                        1  110RAT
     I                                        1  117ZRATE
0277 I**  LOCAL DATA AREA FOR DATABASE RECORD
0278 ILDA        UDS                            256
0279 I********************                  134 138 DBFILE                E14702
0280 I********************                  139 167 DBKEY                 E14702
0281 I********************                  168 175 DBPGM                 E14702
0282 I********************                  176 1770DBASE                 E14702
     I                                      134 141 DBFILE                E14702
     I                                      142 170 DBKEY                 E14702
     I                                      171 180 DBPGM                 E14702
     I                                      181 183 DBASE                 E14702
     I** LINK ENQUIRY DATA AREA
     IDLSDS     E DSDLDTA
     I*                                                                   S01119
     I*    DATA STRUCTURE TO SET UP SUBFILE LINE 1                        S01119
     I*                                                                   S01119
     I            DS                                                      S01119
     I                                        1  77 ZLINE1                S01119
     I*******************                     1   5 DTYPW          S01119 S01157
     I                                        1   5 DTYPW                                     CDL038
     I                                        6   9 CLASW                                     CDL038
     I                                       11  11 BYSLW                                     CDL038
     I                                       12  170DLNO                                      CDL038
     I                                       20  26 DDATE                                     CDL038
     I**********                              1   6 DTYPW                              S01157 CDL038
     I**********                              8  130DLNO                               S01119 CDL038
     I**********                             18  24 DDATE                              S01119 CDL038
     I                                       28  34 VDATE                 S01119
     I                                       36  43 NARR1                 S01119
     I                                       45  47 CCY                   S01119
     I                                       49  49 FFIN                  S01119
     I                                       52  68 AMT1W                 S01119
     I                                       70  75 RDNO                  S01119
     I*                                                                   S01119
     I*    DATA STRUCTURE TO SET UP SUBFILE LINE 2                        S01119
     I*                                                                   S01119
     I            DS                                                      S01119
     I                                        1  77 ZLINE2                S01119
     I                                        1   1 ZF1                   S01119
     I                                        2   9 TEXT                  S01119
     I                                       10  10 ZF2                   S01119
     I                                       11  77 LINE2                 S01119
     I*                                                                   S01119
     I*    DATA STRUCTURE TO SET UP SUBFILE LINE 3                        S01119
     I*                                                                   S01119
     I            DS                                                      S01119
     I                                        1  77 ZLINE3                S01119
     I                                        1   1 ZF3                   S01119
     I                                        2   9 TEXT2                 S01119
     I                                       10  10 ZF4                   S01119
     I                                       11  77 LINE3                 S01119
     I*                                                                   S01119
     I*    DATA STRUCTURE TO RETRIEVE DEAL NUMBER AFTER READC             S01119
     I*                                                                   S01119
     I            DS                                                      S01119
     I                                        1  77 SFLINE                S01119
     I                                       12  17 ZDLNO                                     CDL038
     I***********                             8  13 ZDLNO                              S01119 CDL038
     I*                                                                   S01119
     I** CFFEEDL0 KEY                                                     S01184
     I            DS                                                      S01184
     I****************************************1  16 CFKY           S01184 058405
     I****************************************1   7 @TS1           S01184 058405
     I****************************************1   1 @KY1           S01184 058405
     I****************************************2   7 @KY2           S01184 058405
     I****************************************8  10 @KY3           S01184 058405
     I*                                                                   058405
     I                                        1  16 CFKY                  058405
     I                                        1   8 @TS1                  058405
     I                                        1   2 @KY1                  058405
     I                                        3   8 @KY2                  058405
     I                                        9  11 @KY3                  058405
     I*                                                                   DT0204
     I@PARM       DS                            100                       DT0204
     I** DATA STRUCTURE OF PROMPT PARAMETER                               DT0204
     I*                                                                   DT0204
     I                                        1   6 CUSKEY                DT0204
     I                                        7   7 OPTLIV                DT0204
     I                                        8   8 OPTMAT                DT0204
     I*                                                                   S01119
     I              ' COLLATERAL'         C         COLLA                 CGL011
      ** Constant field for 'Collateral' text                             CGL011
      *                                                                   CGL011
     I/COPY WNCPYSRC,DL0120I002
     I/EJECT
     C********************************************************************
     C           *NAMVAR   DEFN           DLSDS
     C           *NAMVAR   DEFN           LDA
     C**
0389 C*    FIRST  CYCLE CALCULATIONS.
     C*
     C*   FIRST CYCLE ONLY
     C  N02                DO
     C                     MOVEACPY@      BIS@   80
     C                     SETON                     02
     C/COPY WNCPYSRC,DL0120C016
      *                                                                   S01311
      *   Test whether it is an FX or MM Exposure Management Enquiry      S01311
      *   and setup defaults if it is an Exposure Management Enqury       S01311
      *                                                                   S01311
     C           *LOCK     IN   DLSDS                                     S01311
     C                     MOVE RQDTD     FXMM    2                       S01311
     C                     OUT  DLSDS                                     S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C           FXMM      OREQ 'MM'                                      S01311
     C           FXMM      OREQ 'FR'                                      S01332
     C           FXMM      OREQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C                     MOVE *BLANKS   EMICDK 10                       S01332
     C                     MOVEL'EXPM'    EMICDK                          S01332
     C           EMICDK    CHAINSDEXPML1             40                   S01332
     C                     SETON                     80                   S01311
     C                     MOVELRQDTD     CNUM                            S01311
     C                     MOVELRQDTD     CUST                            S01311
     C                     MOVE 'Y'       LIVD                            S01311
     C                     MOVE ' '       MATD                            S01311
     C                     MOVE 'ALL'     SBRCA                           S01311
     C                     MOVE 'ALL'     SBRCAX                          S01311
     C                     END                                            S01311
      *                                                                   E231
     C           *NAMVAR   DEFN           ZMUSER                          E231
     C                     IN   ZMUSER                                    E231
0394 C*
0395 C**   SET INDICATORS.
0396 C                     SETON                     43
0397 C*
0398 C**   GET DATE FORMAT
0399 C*********************EXSR ZSYSTM                                    S01194
0400 C*****INITIALISE*FIELDS.                                             S01194
0401 C*********************MOVE 'A'       CLKEY   7                       S01194
     C*                                                                   S01184
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
0951 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*
     C**  SETUP CFFEEDL0 KEY                                              S01184
     C***********          MOVE 'D'       @KY1                     S01184 058405
     C                     MOVE 'DL'      @KY1                            058405
     C                     MOVE '999'     @KY3                            S01184
0402 C**
0403 C*****SET*UP*KEY*FOR*CURRENCY*TABLE.**
0404 C*********************MOVEL'20      'XCY1
0405 C*********************MOVE '1'       XCY2
0406 C*****TABCHN*TO*ACCESS*USCY*CURRENCY***
0407 C*********************EXSR TABCHN
     C*                                                                   S01119
     C** ACCESS TRADING DETAILS FILE FOR USD CCY CODE (BLBWCD)            S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C***********          PARM           SDTRAD                          S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBKEY            ************   S01194
     C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01408
      *                                                                   CDL006
      ** Check if switchable feature CDL006 is switched on                CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' @RTCD                           CDL006
     C                     PARM '*VERIFY' @OPTN                           CDL006
     C                     PARM 'CDL006'  @SARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           @RTCD     IFNE *BLANKS                                   CDL006
     C           @RTCD     ANDNE'*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     MOVEL'CDL006'  DBKEY            * DBERR 05 *   CDL006
     C                     MOVEL'005'     DBASE            ************   CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVE '1'       *INLR                           CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           @RTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ENDIF                                          CDL006
      *                                                                                       CDL099
      ** Access SAR details file to see if CDL099 SAR is installed.                           CDL099
      *                                                                                       CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM *BLANKS   @RTCD                                               CDL099
     C                     PARM '*VERIFY' @OPTN                                               CDL099
     C                     PARM 'CDL099'  @SARD                                               CDL099
      *                                                                                       CDL099
     C           @RTCD     IFEQ *BLANK                                                        CDL099
     C                     MOVE 'Y'       CDL099  1                                           CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'N'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
     C/COPY WNCPYSRC,DL0120CCP4                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C*    SET UP CONTROL CHARACTERS FOR FIELD CONDITIONING               S01119
     C*                                                                   S01119
     C                     MOVE ' '       HEX20   1         NORMAL        S01119
     C                     MOVE ' '       HEX21   1         REVERSE VIDEO S01119
     C                     MOVE ' '       HEX22   1         HIGH INTENSITYS01119
     C                     BITOF'1'       HEX20                           S01119
     C                     BITOF'1'       HEX21                           S01119
     C                     BITOF'1'       HEX22                           S01119
     C                     BITON'2'       HEX20                           S01119
     C                     BITON'2'       HEX21                           S01119
     C                     BITON'7'       HEX21                           S01119
     C                     BITON'2'       HEX22                           S01119
     C                     BITON'6'       HEX22                           S01119
     C*                                                                   S01136
     C** INITIAL PROCESSING FOR DRS                                       S01136
     C                     EXSR #A                                        S01136
     C*
     C** IF DATABASE ERROR EXIT PROGRAM
     C           *INU7     CABEQ'1'       ENDM
     C**                                                            S01117S01194
     C****OBTAIN*MULTIBRANCH*IND.**                                 S01117S01194
     C*********************                                         S01117S01194
     C*********************MOVE *BLANKS   ZTABKY                    S01117S01194
     C*********************MOVEL'01'      ZTABKY                    S01117S01194
     C*********************MOVE '11'      ZTABKY                    S01117S01194
     C***********ZTABKY****CHAINTABLE                99             S01117S01194
     C************IN99*****IFEQ '1'                                 S01117S01194
     C*********************SETON                     U7U8           S01117S01194
     C*******              GOTO END                                 S01117S01194
     C*********************GOTO ENDM                       *AMENDED*S01117S01194
     C*********************END                                      S01117S01194
     C** READ DATA AREA - RUNDAT - FOR MULTIBRANCHING INDICATOR           S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
     C**                                                                  S01117
     C**  IF MBIN = Y, OBTAIN BOOKING/ A/C BRANCHES                       S01117
     C**  VALID FOR THIS USER, IN FIRST CYCLE                             S01117
     C***********MBIN      IFEQ 'Y'                                 S01117S01194
     C           @MBIN     IFEQ 'Y'                                       S01194
     C                     SETON                     10                   LN0467
     C***********          EXSR ZSPFB                               S01117LN0467
     C                     END                                            S01117
     C*                                                                   S01119
     C                     END
0412 C*
      ** Validation of user's action code security.                       E231
      **                                                                  E231
     C***********          SETOF                     96               E231LN0467
     C***********@MBIN     IFEQ 'N'                                   E231LN0467
     C***********          CALL 'ZVACTU'                              E231LN0467
     C***********          PARM 'E'       ACTCD   1                   E231LN0467
     C***********          PARM           @ERR    10                  E231LN0467
      **                                                              E231LN0467
     C***********@ERR      IFNE 0                                     E231LN0467
     C************INKC     DOUEQ'1'                                   E231LN0467
     C***********          MOVELERR,9     MSG                         E231LN0467
     C***********          SETON                     7096             E231LN0467
     C***********          SETOF                     43               E231LN0467
     C***********          EXSR SCREEN                                E231LN0467
     C***********          END                                        E231LN0467
     C***********          EXSR CMDSR                                 E231LN0467
     C***********          END                                        E231LN0467
     C***********          ELSE                                       E231LN0467
      *                                                                   E231
      ** MULIBRANCHED SYSTEM                                              E231
     C***********          CALL 'ZVACTBU'                             E231LN0467
     C***********          PARM 'E'       ACTCD   1                   E231LN0467
     C***********          PARM           @DFBR                       E231LN0467
     C***********          PARM           @ERR                        E231LN0467
     C*                                                                   E231
     C***********@ERR      IFNE 0                                     E231LN0467
     C************INKC     DOUEQ'1'                                   E231LN0467
     C***********          MOVELERR,9     MSG                         E231LN0467
     C***********          SETON                     7096             E231LN0467
     C***********          SETOF                     43               E231LN0467
     C***********          EXSR SCREEN                                E231LN0467
     C***********          END                                        E231LN0467
     C***********          EXSR CMDSR                                 E231LN0467
     C***********          END                                        E231LN0467
     C*                                                                   E231
     C***********          END                                        E231LN0467
      **                                                                  E231
0412 C*
0413 C********************************************************************
0414 C**
0415 C*    DETAIL CALCULATIONS.
     C*
     C**
     C**    MAIN PROCESSING LOOP
     C**
0416 C           DSPSC     TAG                             ** DSPSC TAG **
     C*                                                                   S01136
     C** CLEAR ALL DISPLAY WORK FIELDS.                                   S01136
     C                     MOVE *BLANKS   @MDT                            S01136
      *                                                                   S01311
      *  If it is an Exposure Management linked enquiry do not display    S01311
      *  the initial screen                                               S01311
      *                                                                   S01311
     C           *IN80     IFEQ '1'                                       S01311
     C           *IN81     ANDEQ'0'                                       S01311
     C                     SETON                     215281               S01311
     C                     SETOF                     20                   S01311
     C                     GOTO VALSC                                     S01311
     C                     END                                            S01311
     C*
     C*     DISPLAY SCREEN
     C           *IN02     IFEQ '1'
     C*********************MOVE '1'       *IN43                     S01117S01194
     C                     EXSR SCREEN
     C                     END
0416 C           VALSC     TAG                             ** DSPSC TAG **
     C                     EXSR CMDSR
      *                                                                   S01311
      *  If F12 is pressed return user to previos screen                  S01311
      *                                                                   S01311
     C           *INKL     IFEQ '1'                                       S01311
     C                     MOVE *BLANKS   CNUM                            S01311
     C                     MOVE *BLANKS   CUST                            S01311
     C                     MOVE *BLANKS   LIVD                            S01311
     C                     MOVE *BLANKS   MATD                            S01311
     C                     MOVE *BLANKS   SBRCA                           S01311
     C                     MOVE *BLANKS   SBRCAX                          S01311
     C                     GOTO DSPSC                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
     C*
     C*     IF INPUT FIELDS NOT VALID REDISPLAY PROMPT
     C           *IN43     IFEQ '0'
     C                     GOTO DSPSC
     C*
     C                     ELSE
     C*
     C*     LOAD SUBFILE
     C           *IN43     IFEQ '1'
     C                     EXSR LOAD
     C                     END
     C**
     C**    BRANCH BACK ON RESPONSE
     C                     GOTO VALSC
     C*
     C                     END
0469 C           ENDM      TAG                             ** ENDM  TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**    SCREEN SR. SETUP & DISPLAY SCREEN
     C**
     C           SCREEN    BEGSR
     C**
     C**    PROMPT FORMAT
     C**    SET INDICATORS TO DISPLAY HEADING
     C                     MOVE '1'       *IN21
     C                     MOVE '1'       *IN52
     C                     MOVE '0'       *IN20
     C                     WRITEDL0120F1
     C*                                                                   E22855
     C*********************EXFMTDL0120F3                                  E22855
     C                     WRITEDL0120F3                                  E25812
     C                     EXFMTDL0120F4                                  E22855
     C*                                                                   E22855
     C                     ENDSR
     C**
     C**
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**    CMDSR SR. PROCESSING OF COMMAND KEYS AND INPUT
     C**
     C           CMDSR     BEGSR
     C**
     C*                                                                   S01203
     C******IF*CMD/5*CALL*SHORTNAME*ENQUIRY*AND*RESET*SCREEN*INDICATORS*********
     C********** *INKE     IFEQ '1'
     C******IF*CMD/6*CALL*SHORTNAME*ENQUIRY*AND*RESET*SCREEN*INDICATORS   E231
     C********** *INKF     IFEQ '1'                                       E231
     C**********                                                          E231
     C**********           EXSR SHNSR                                     E231
     C**********           MOVE '1'       *IN43                           E231
     C**********           MOVEA'000'     *IN,59                          E231
     C**********           EXSR SCREEN                                    E231
     C**********           END                                            E231
     C**
     C******IF*CMD/1*EXIT*PGM*******************************              S01203
     C********** *INKA     IFEQ '1'                                       S01203
     C******IF*CMD/3*EXIT*PGM*******************************      S01203  S01311
     C************INKC     IFEQ '1'                               S01203  S01311
     C************         MOVE '1'       *INLR                           S01311
     C************         GOTO ENDM                                      S01311
     C************         END                                            S01311
      *                                                                   S01311
      *  Validate Command Keys                                            S01311
      *                                                                   S01311
     C           *INKA     IFEQ '1'                                       S01311
     C                     MOVE 'S'       RETNWF  1                       S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C           *INKC     IFEQ '1'                                       S01311
     C                     MOVE 'Q'       RETNWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
      * If called from modular enqiury, F12 returns user to Customer      S01311
      * Input screen, otherwise return is to the Exposure Management      S01311
      * front screen                                                      S01311
      *                                                                   S01311
     C           *INKL     IFEQ '1'                                       S01311
     C           *IN80     IFEQ '0'                                       S01311
     C                     GOTO ENDCMD                                    S01311
     C                     ELSE                                           S01311
     C                     MOVE 'U'       RETNWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
     C                     END                                            S01311
      *                                                                   S01311
     C**    VALIDATE INPUT
     C                     EXSR VALID
     C*
     C***********          ENDSR                           **ENDSR  TAG **S01311
     C           ENDCMD    ENDSR                           **ENDSR  TAG **S01311
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**    VALID SR. TO VALIDATE INPUT FIELDS
     C**
     C           VALID     BEGSR                           ** VALID SR  **
     C**
0423 C**
     C*     VALIDATE CUSTOMER FIELD INPUT
     C**
     C*     RESET INDICATORS
     C**
     C                     SETON                     43
     C                     SETOF                     596061
     C                     SETOF                     282931
     C                     SETOF                     62
     C                     SETOF                     68                   LN0467
     C**
0448 C*    ERROR IF CUSTOMER NO.NOT ENTERED,
0449 C**
     C           CUST      COMP *BLANKS                  22
0450 C   22                MOVE ERR,1     MSG
     C   22                SETOF                         43
0451 C   22                GOTO ENDCUS
0452 C*
0453 C*****IS*CUSTOMER*NO*OR*SHORTNAME*ENTERED.**                         S01194
     C*********************                                               S01194
0454 C*********************Z-ADD0         ZADEC                           S01194
 455 C*********************Z-ADD6         ZADIG                           S01194
0456 C*********************MOVE '        'ZFIELD                          S01194
0457 C*********************MOVEL'        'ZFIELD                          S01194
0458 C*********************MOVE ICUST     ZFIELD                          S01194
0459 C*********************EXSR ZALIGN                                    S01194
0460 C***99****************GOTO SNVAL                                     S01194
     C*********************                                               S01194
0461 C*****IF*CUST.*NO.*ENTERED,*CHECK*IT*IS*ON*CLIENT*FILE.**            S01194
     C*********************                                               S01194
0462 C*********************MOVELICUSN     CLKEY                           S01194
0463 C*********************EXSR CLCHN                                     S01194
0464 C***10****************GOTO CUSTDL                                    S01194
     C*********************SETOF                     43                   S01194
0465 C*********************MOVE ERR,2     MSG                             S01194
0466 C*********************GOTO ENDCUS                                    S01194
     C*********************ELSE                                           S01194
     C*********************GOTO CUSTDL                                    S01194
     C*********************END                                            S01194
0467 C*********************                                               S01194
0468 C*****IF*SNAME*ENTERED,*CHECK*IT*IS*ON*SHORT*NAME*FILE.*             S01194
     C*********************                                               S01194
0469 C***********SNVAL*****TAG                             ** SNVAL TAG **S01194
0470 C*********************SETOF                     12                   S01194
0471 C***********ICUST*****CHAINSNAME                40                   S01194
0472 C**N12****************GOTO INVSNM                                    S01194
0473 C*********************                                               S01194
0474 C*****USE*CUST.*NO.*FROM*SHORT*NAME*FILE*TO*CHAIN*TO**               S01194
0475 C*****CLIENT*FILE*FOR*MORE*DETAILS**                                 S01194
0476 C*********************MOVELCNUMX     CLKEY                           S01194
0477 C*********************EXSR CLCHN                                     S01194
0478 C***10****************GOTO CUSTDL                                    S01194
     C*********************SETON                     43                   S01194
0479 C*********************                                               S01194
0480 C*****INVALID*SHORT*NAME***                                          S01194
0481 C***********INVSNM****TAG                             ** INVSNM TAG *S01194
0482 C*********************MOVE ERR,3     MSG    40                       S01194
     C*********************SETOF                     43                   S01194
     C** READ CUSTOMER FILE. IF ERROR THEN SEND APPROPRIATE MESSAGE       S01194
     C** DEPENDING ON WHETHER CUSTOMER NUMBER OR CUSTOMER SHORTNAME       S01194
     C** ENTERED (@KYST)                                                  S01194
     C***********          CALL 'AOCUSTR0'                         S01194 CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C******************** PARM '*DBERR ' @RTCD   7                S01194 E22
     C                     PARM '*BLANKS' @RTCD   7                S01194 E22
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CUST      @KEY1  10                       S01194
     C                     PARM *BLANKS   @KYST   7                       S01194
     C***********SDCUST    PARM SDCUST    DSSDY                    S01194 CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
     C************         PARM           SDCUST                          S01194
      *
      ** If CSD007 is on, allow processing of a closed record (return     CSD007
      ** code '*NRF' and date deleted equal to zero).                     CSD007
      *                                                                   CSD007
     C           CSD007    IFEQ 'Y'                                       CSD007
     C           @RTCD     ANDEQ'*NRF'                                    CSD007
     C           BBDTDL    ANDEQ*ZERO                                     CSD007
     C           @KYST     ANDEQ'*CNUM  '                                                   BUG11439
     C           CSD007    OREQ 'Y'                                                         BUG11439
     C           @RTCD     ANDEQ'*NRF'                                                      BUG11439
     C           BBDTDL    ANDEQ*ZERO                                                       BUG11439
     C           @KYST     ANDEQ'*CSHT  '                                                   BUG11439
      *                                                                   CSD007
     C                     ELSE                                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE *BLANK                                    S01194
     C           @KYST     IFEQ '*CNUM  '                                 S01194
     C                     MOVE ERR,2     MSG                             S01194
     C                     ELSE                                           S01194
     C                     MOVE ERR,3     MSG                             S01194
     C                     END                                            S01194
     C                     MOVE '0'       *IN43                           S01194
     C                     GOTO ENDCUS                                    S01194
     C                     END                                            S01194
      *                                                                   CSD007
     C                     ENDIF                                          CSD007
      *                                                                   CSD007
     C*                                                                   E22
     C** PUT CUSTOMER SHORT NAME INTO CUST ON DISPLAY FILE                E22
     C                     MOVELCSNM      CUST   10                       E22
     C*                                                                   E22
     C** SET UP CNUM WITH VALUE CUSTOMER NO. ON SDCUSTPD                  S01194
     C                     MOVELBBCUST    CNUM                            S01194
     C**                                                                  S01117
     C** IF MBIN = Y,VALIDATE CUST.BR. FOR USER                           S01117
     C**                                                                  S01117
     C***********MBIN******IFEQ 'Y'                                 S01117S01194
     C           @MBIN     IFEQ 'Y'                                       S01194
     C           SBRCA     IFEQ '   '                                     LN0467
     C                     MOVE @DFBR     SBRCA                           LN0467
     C                     MOVE @DFBR     SBRCAX  3                       LN0467
     C                     ELSE                                           LN0467
     C                     MOVE SBRCA     SBRCAX                          LN0467
     C                     END                                            LN0467
     C           SBRCA     IFNE 'ALL'                                     LN0467
     C** VALIDATE CUST.BR. FOR USER                                 S01117LN0467
     C*********************MOVE CBRCD     ZBRCDX  3                 S01117S01194
     C**********           MOVE BBBRCD    ZBRCDX  3                 S01194LN0467
     C**********           EXSR ZBRR                                S01117LN0467
     C********** *IN99     IFEQ '1'                                 S01117LN0467
     C**********           SETON                     70             S01117LN0467
     C**********           MOVELERR,8     MSG                       S01117LN0467
     C**********           SETOF                     43             S01117LN0467
     C**********           ELSE                                     S01117LN0467
     C**********           CALL 'AOBRCHR0'                                             LN0467 CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANK    @RTCD   7                       LN0467
     C                     PARM '*KEY    '@OPTN   7                       LN0467
     C                     PARM SBRCA     @KEYB   3                       LN0467
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        LN0467 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   LN0467
     C                     SETON                     68                   LN0467
     C                     MOVELERR,10    MSG                             LN0467
     C                     SETOF                     43                   LN0467
     C                     GOTO ENDVAL                                    LN0467
     C                     ELSE                                           LN0467
     C                     MOVE A8BRCD    SBRCA                           LN0467
     C                     MOVE A8BRCD    SBRCAX                          S01311
     C                     CALL 'ZVBBU'                                   LN0467
     C                     PARM           SBRCA                           LN0467
     C                     PARM *ZEROS    ERRCOD  10                      LN0467
     C           ERRCOD    IFNE 0                                         LN0467
     C                     SETON                     70                   LN0467
     C           ERRCOD    IFEQ 1                                         LN0467
     C***********          MOVELERR,9     MSG                     LN0467  S01311
     C                     MOVELERR,8     MSG                             S01311
     C                     ELSE                                           LN0467
     C***********          MOVELERR,8     MSG                     LN0467  S01311
     C                     MOVELERR,9     MSG                             S01311
     C                     END                                            LN0467
     C                     SETOF                     43                   LN0467
     C                     GOTO ENDVAL                                    LN0467
     C                     END                                            LN0467
     C                     GOTO CUSTDL                                    S01117
     C                     END                                            LN0467
     C                     ELSE                                           LN0467
     C           BANK      IFNE 'Y'                                       LN0467
     C                     SETON                     68                   LN0467
     C                     MOVELERR,11    MSG                             LN0467
     C                     SETOF                     43                   LN0467
     C                     GOTO ENDVAL                                    LN0467
     C                     ELSE                                           LN0467
     C                     GOTO CUSTDL                                    LN0467
     C                     END                                            LN0467
     C                     END                                            LN0467
     C                     ELSE                                           LN0467
     C                     GOTO CUSTDL                                    LN0467
     C                     END                                            LN0467
     C*
0481 C           ENDCUS    TAG                             ** ENDCUS TAG *
     C*
     C*    SET ERROR INDICATOR FOR CUSTOMER FIELD IN DISPLAY FILE
     C                     SETON                     59
0483 C                     GOTO ENDVAL
     C*
0481 C           CUSTDL    TAG                             ** CUSTDL TAG *
     C*
     C*    DISPLAY LIVE OR MATURED RECORDS, OR BOTH.
     C*    ENTRIES MUST BE ' ' OR 'Y' (CANNOT BOTH BE ' ')
     C           LIVD      COMP ' '                      17
     C*
     C           MATD      COMP ' '                      27
     C*
     C           *IN17     IFEQ '1'
     C           *IN27     IFEQ '1'
     C                     MOVE ERR,5     MSG
     C                     MOVE '0'       *IN43
0483 C                     GOTO SETIND
     C                     END
     C                     END
     C*
     C           *IN17     IFNE '1'
     C           LIVD      COMP 'Y'                      28
     C           *IN28     IFNE '1'
     C                     MOVE ERR,6     MSG
     C                     MOVE '0'       *IN43
     C                     END
     C                     END
     C*
     C           *IN27     IFNE '1'
     C           MATD      COMP 'Y'                      29
     C           *IN29     IFNE '1'
     C                     MOVE ERR,6     MSG
     C                     MOVE '0'       *IN43
     C                     END
     C                     END
     C           *IN28     IFEQ '1'
     C           *IN29     ANDEQ'1'
     C                     MOVE '1'       *IN31
     C                     END
0487 C           SETIND    TAG                             **SETIND TAG **
     C*
     C*     SET ERROR INDICATOR FOR 'LIVE' AND 'MATURED' FIELDS
     C*     ON THE DISPLAY FILE
     C   17 27
     CORN17N28             SETON                     60
     C   17 27
     CORN27N29             SETON                     61
     C*
     C*     IF ERROR BRANCH TO END
     C  N43                GOTO ENDVAL
     C/COPY WNCPYSRC,DLH00159
     C*
     C**
     C*     ACCESS DEALS FOR THIS CUSTOMER
     C**
     C                     MOVELCNUM      CUSKEY  6
     C*                                                                   S01136
     C                     MOVELCNUM      CKEY    9                       LN0467
     C                     MOVE SBRCAX    CKEY                            LN0467
     C*                                                                   LN0467
     C** RESET THE POINTER IN THE DEALS FILE.                             S01136
     C********** MODS      IFEQ 'NN'                       B1      S01136 E20251
     C********** CNUM      SETLLCUSDL                    48*1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'NY'                       B1      S01136 E20251
     C********** CNUM      SETLLMMCUSDLL                 48*1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'YN'                       B1      S01136 E20251
     C********** CNUM      SETLLFXCUSDLL                 48*1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'YY'                       B1      S01136 E20251
     C********** CNUM      SETLLCACUSDLL                 48*1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C***********CUSKEY    SETLLCUSDL                    48 RECORD FOUND  S01136
     C***********CNUM      SETLLCACUSDLL                 48*2             LN0467
     C*                                                                   S01314
     C           SBRCAX    IFEQ 'ALL'                      B2             LN0467
     C           @MBIN     OREQ 'N'                        B2             LN0467
      *                                                                   S01311
      ***If*it*is*an*Exposure*Management*Enquiry,*read*either*the* S01311 S01332
      ***FX*or*the*MM*file***                                      S01311 S01332
      *  If it is an Exposure Management Enquiry, read either the         S01332
      *  FX, MM, FRA or IRS File                                          S01332
      *                                                                   S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C           CNUM      SETLLEMCUSFXL                 48               S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C           CNUM      SETLLEMCUSMML                 48               S01311
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'FR'                                      S01332
     C           CNUM      SETLLEMCUSFRL                 48               S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C           CNUM      SETLLEMCUSIRL                 48               S01332
     C                     ELSE                                           S01311
     C/COPY WNCPYSRC,DLH00198
     C           CNUM      SETLLCACUSDL1                 48*2             LN0467
     C/COPY WNCPYSRC,DLH00199
     C                     END                                            S01311
     C                     END                                            S01311
     C                     END                                            S01332
     C                     END                                            S01332
      *                                                                   S01311
     C                     ELSE                            X2             LN0467
     C           FXMM      IFEQ 'FX'                                      S01311
     C           @CRKY     SETLLEMCUSFXL                 48               S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C           @CRKY     SETLLEMCUSMML                 48               S01311
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'FR'                                      S01332
     C           @CRKY     SETLLEMCUSFRL                 48               S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C           @CRKY     SETLLEMCUSIRL                 48               S01332
     C                     ELSE                                           S01311
     C/COPY WNCPYSRC,DLH00200
     C           @CRKY     SETLLCACUSDL1                 48*1             LN0467
     C/COPY WNCPYSRC,DLH00201
     C                     END                                            S01311
     C                     END                                            S01311
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                             E1             S01136
     C**
     C*     IF NO DEALS, DISPLAY MESSAGE
     C**
     C           *IN48     IFEQ '0'
     C           FXMM      IFEQ 'FX'                                      S01311
     C                     MOVE ERR,12    MSG                             S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C                     MOVE ERR,13    MSG                             S01311
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'FR'                                      S01332
     C                     MOVE ERR,14    MSG                             S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C                     MOVE ERR,15    MSG                             S01332
     C                     ELSE                                           S01311
     C                     MOVE ERR,4     MSG
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C                     MOVE '0'       *IN43
     C                     END
     C*
0487 C           ENDVAL    ENDSR                           **ENDVAL TAG **
     C********************************************************************
     C/SPACE 3
     C********************************************************************
     C**
     C**    LOAD SR. TO FILL PAGE OF SUBFILE
     C**
     C           LOAD      BEGSR                           **  LOAD SR  **
     C*
     C**                   Z-ADD0         PAGE                            S01119
     C**                   Z-ADD0         KOUNT   30                      S01119
     C                     Z-ADD0         RCDNBR
     C**
     C**    CLEAR SUBFILE
     C                     SETOF                         20
      *                                                                   S01311
      *   Write Header if called from Exposure Management Enquiry         S01311
      *                                                                   S01311
     C           *IN80     IFEQ '1'                                       S01311
     C                     WRITEDL0120F1                                  S01311
     C                     END                                            S01311
      *                                                                   S01311
     C                     WRITEDL0120F3
     C                     WRITEDL0120F4                                  E22855
     C           FILL      TAG                             **FILL TAG**
     C                     MOVE '0'       *IN52
     C*
     C**                   ADD  6         PAGE    30                      S01119
     C                     Z-ADD0         LINES                           S01119
     C*                                                                   S01119
     C*     SUBFILE PAGE NOW 12 VARIABLE FORMAT LINES                     S01119
     C*                                                                   S01119
     C           LINES     DOWLT12                                        S01119
     C**         RCDNBR    DOUEQPAGE                                      S01119
     C**
     C**    READ DEALS FOR THIS CUSTOMER
     C                     MOVE '0'       *IN42
     C           READT     TAG                             **READTTAG**
     C                     MOVEA'0000'    *IN,04
     C                     MOVE '0'       *IN11                           S01119
     C                     MOVE '0'       *IN39                                               260855
     C*                                                                   S01136
     C** ACCESS APPROPRIATE FILES                                         S01136
     C                     EXSR #BBA                                      S01136
     C***********CUSKEY    READECUSDL                    41               S01136
     C*
     C           *IN41     IFEQ '0'
     C**
     C**    IF LIVE AND MATURED RECORDS SELECTED
     C           *IN31     CABEQ'1'       RECVAL
     C**
     C**    ONLY LIVE SELECTED
     C           *IN28     IFEQ '1'
     C           RECIC     IFEQ 'M'
     C           RECIC     OREQ 'N'
     C           RECIC     OREQ 'R'                                       155954
     C           LCD       ANDLTBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           FHLCD     ANDLTBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HKLCD     ANDLTBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HLLCD     ANDLTBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HMLCD     ANDLTBJRDNB                                    155954
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0120CCP6                                           S01408
     C*                                                                   S01408
     C                     GOTO READT
     C                     END
     C                     END
     C**
     C**    ONLY MATURED SELECTED
     C           *IN29     IFEQ '1'
     C           RECIC     IFEQ 'D'
     C           RECIC     OREQ 'R'
     C           DLREC     ANDNE'D'                                       155954
     C/COPY WNCPYSRC,DL0120C001
     C           RECIC     OREQ 'E'
     C           DLREC     ANDNE'D'                                       155954
     C*                                                                   S01136
     C** EXCLUDE DRS DEAL TYPES A,I,C                                     S01136
     C           RECIC     OREQ 'A'                                       S01136
     C           DLREC     ANDNE'D'                                       155954
     C           RECIC     OREQ 'I'                                       S01136
     C           DLREC     ANDNE'D'                                       155954
     C           RECIC     OREQ 'C'                                       S01136
     C           DLREC     ANDNE'D'                                       155954
     C           DLREC     OREQ 'D'                                       S01136
     C           FHLCD     ANDEQBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HKLCD     ANDEQBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HLLCD     ANDEQBJRDNB                                    155954
     C           DLREC     OREQ 'D'                                       155954
     C           HMLCD     ANDEQBJRDNB                                    155954
     C*                                                                   S01136
     C***********RECIC     OREQ 'R'                                       S01136
     C                     GOTO READT
     C                     END
     C                     END
      *                                                                   S01332
      * If Caps, Collars and Floors included in Option Deals exclude      S01332
      * them from IRS Deals if program called via Exposure Management     S01332
      *                                                                   S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           BUCCSO    ANDEQ'O'                                       S01332
     C           DTYP      IFEQ 'RF'                                      S01332
     C           DTYP      OREQ 'RR'                                      S01332
     C           DTYP      OREQ 'RP'                                      S01332
     C                     GOTO READT                                     S01332
     C                     END                                            S01332
     C                     END                                            S01332
      *                                                                   S01332
      * If Options selected only display Caps, Collars and Floors if      S01332
      * program called via Exposure Management                            S01332
      *                                                                   S01332
     C           FXMM      IFEQ 'CC'                                      S01332
     C           DTYP      IFEQ 'RS'                                      S01332
     C           DTYP      OREQ 'RX'                                      S01332
     C                     GOTO READT                                     S01332
     C                     END                                            S01332
     C                     END                                            S01332
      *                                                                   S01332
     C                     ELSE
     C*     IF NO RECORDS DISPLAY MESSAGE
     C***********RCDNBR    IFEQ 000                                       E13029
     C           RCDNBR    IFEQ 0000                                      E13029
     C           FXMM      IFEQ 'FX'                                      S01311
     C                     MOVE ERR,12    MSG                             S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C                     MOVE ERR,13    MSG                             S01311
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'FR'                                      S01332
     C                     MOVE ERR,14    MSG                             S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C                     MOVE ERR,15    MSG                             S01332
     C                     ELSE                                           S01311
     C                     MOVE ERR,4     MSG
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C                     MOVE '0'       *IN43
     C                     MOVE '1'       *IN52
     C                     END
     C                     MOVE '0'       *IN18
     C                     GOTO ENDLD
     C*
     C                     END
     C           RECVAL    TAG                             **RECVAL TAG**
     C*
     C           RECIC     IFEQ 'M'
     C           RECIC     OREQ 'N'
     C                     MOVE '1'       *IN42
     C                     END
     C*
     C*     FRA/IRS DEALS                                                 S01119
     C*                                                                   S01119
     C           *IN11     IFEQ '1'                                       S01119
     C**                                                                  S01119
     C*     RESET INDICATOR CONTROLLING OUTPUT OF HEADING                 S01119
     C                     SETOF                     65                   S01119
     C**                                                                  S01119
     C*                                                                   S01119
     C                     SETOF                     392445               S01119
     C                     SETOF                     474953               S01119
     C                     SETOF                     66                   S01119
     C**                                                                  S01119
     C*     For FRA/IRS deals suppress the spread rate, if base rate      S01119
     C*     type GT zero and spread ind blank.                            S01119
     C                     MOVE '0'       *IN37                           S01119
     C                     MOVE '0'       *IN19                           S01119
     C**                                                                  S01119
     C**                                                                  S01119
     C********** UBRTT     IFGT 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           USPIN     ANDEQ' '                                       S01119
     C                     MOVE '1'       *IN37                           S01119
     C                     END                                            S01119
     C**                                                                  S01119
     C********** TBRTT     IFGT 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TSPIN     ANDEQ' '                                       S01119
     C                     MOVE '1'       *IN19                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C** IF DEAL TYPE IS AN FRA OR RR,RP,RF THEN SET ON BUY/SELL          S01157
     C** CONDITIONING IND.                                                S01157
     C*                                                                   S01157
     C                     MOVE '0'       *IN32                           S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     MOVE '1'       *IN32                           S01157
     C                     END                                            S01157
     C**                                                                  S01119
     C*     IF READ SUCCESSFUL, DETERMINE DEAL TYPE,  ADD APPROPRIATE     S01119
     C*     AMOUNT TO LINES, LINE COUNTER                                 S01119
     C**                                                                  S01119
     C*     IF THE DEAL TYP IS RX, ADD 4 TO LINES                         S01119
     C**                                                                  S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C                     SETON                     39                   S01119
     C                     ADD  4         LINES   20                      S01119
     C                     ELSE                                           S01119
     C**                                                                  S01119
     C******IF*THE*DEAL*TYPE*IS*RL*AND*THE*CAP*OR*COLLAR*IS*OURS,* S01119 S01157
     C******LINE*4*CONTAINING*THE*FLOOR*RATE*IS*DISPLAYED*IF*BIT*3 S01119 S01157
     C******OF*UDSTI*IS*ON*                                        S01119 S01157
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C***********UBRTT     IFNE 0                                  S01119 S01157
     C*********************SETON                     49            S01119 S01157
     C*********************TESTB'4'       UDSTI          45        S01119 S01157
     C************IN45     IFEQ '1'                                S01119 S01157
     C*********************ADD  4         LINES                    S01119 S01157
     C**                                                           S01119 S01157
     C*****IF*BIT*3*OF*UDSTI*IS*OFF,*ONLY*3*LINES*ARE*DISPLAYED*   S01119 S01157
     C**                                                           S01119 S01157
     C*********************ELSE                                    S01119 S01157
     C*********************SETON                     24            S01119 S01157
     C*********************ADD  3         LINES                    S01119 S01157
     C*********************END                                     S01119 S01157
     C**                                                           S01119 S01157
     C******IF*THE*DEAL*TYPE*IS*RL*AND*THE*CAP*OR*COLLAR*IS*THEIRS S01119 S01157
     C******LINE*4*CONTAINING*THE*FLOOR*RATE*IS*DISPLAYED*IF*BIT*3*S01119 S01157
     C******OF*TDSTI*IS*ON*                                        S01119 S01157
     C*********************ELSE                                    S01119 S01157
     C*********************SETON                     53            S01119 S01157
     C*********************TESTB'4'       TDSTI          45        S01119 S01157
     C************IN45     IFEQ '1'                                S01119 S01157
     C*********************ADD  4         LINES                    S01157 S01157
     C**                                                           S01119 S01157
     C**                                                           S01119 S01157
     C*****IF*BIT*3*OF*TDSTI*IS*OFF,*ONLY*3*LINES*ARE*DISPLAYED*   S01119 S01157
     C**                                                           S01119 S01157
     C*********************ELSE                                    S01119 S01157
     C*********************SETON                     24            S01119 S01157
     C*********************ADD  3         LINES                    S01119 S01157
     C*********************END                                     S01119 S01157
     C*********************END                                     S01119 S01157
     C**                                                           S01119 S01157
     C* IF THE DEAL TYPE IS A CAP, COLLAR OR FLOOR (RP,RR OR RF) THEN     S01157
     C* TEST FOR OUR OR THEIR DEAL. IF A CAP OR FLOOR ADD 3 TO THE        S01157
     C* NUMBER OF LINES PRINTED ELSE (COLLAR) ADD 4 TO THE LINES          S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C*                                                                   S01157
     C********** UBRTT     IFNE 0                                                      S01157 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     SETON                     49                   S01157
     C                     ELSE                                           S01157
     C                     SETON                     53                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     SETON                     24                   S01157
     C                     ADD  3         LINES                           S01157
     C                     ELSE                                           S01157
     C                     SETON                     45                   S01157
     C                     ADD  4         LINES                           S01157
     C                     END                                            S01157
     C**                                                                  S01157
     C                     ELSE                                           S01119
     C**                                                                  S01119
     C*****DEAL*TYPES*FR*AND*RS*TAKE*UP*3*LINES****                S01119 S01157
     C*  DEAL TYPE RS TAKES UP 3 LINES / DEAL TYPE FR TAKES UP 2 LINES    S01157
     C**                                                                  S01119
     C/COPY WNCPYSRC,DL0120C017
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C                     SETON                     47                   S01119
     C*                                                                   S01157
     C           DTYP      IFEQ 'RS'                                      S01157
     C                     ADD  3         LINES                           S01119
     C                     ELSE                                           S01157
     C                     ADD  2         LINES                           S01157
     C                     END                                            S01157
     C**                                                                  S01119
     C*    ALL OTHER TYPES OF DEALS TAKE UP 2 LINES                       S01119
     C**                                                                  S01119
     C                     ELSE                                           S01119
     C                     SETON                     66                   S01119
      *                                                                   CGL011
      ** If CGL011 is installed and Collateral Flag is 'Y' add one        CGL011
      ** more line; otherwise retain current processing of 2 lines.       CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C           HKCOLF    ANDEQ'Y'                                       CGL011
     C           CGL011    OREQ 'Y'                                       CGL011
     C           COLF      ANDEQ'Y'                                       CGL011
     C                     ADD  3         LINES                           CGL011
     C                     ELSE                                           CGL011
     C                     ADD  2         LINES                           S01119
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
     C/COPY WNCPYSRC,DL0120C005
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0120C018
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*    IF DEALS OCCUPY LESS THAN 12 LINES FILL SUBFILE PAGE           S01119
     C*                                                                   S01119
     C           LINES     IFGT 12                                        S01119
     C                     MOVE '1'       *IN71                           S01136
     C*                                                                   S01136
     C** ACCESS APPROPRIATE FILES                                         S01136
     C                     EXSR #BBA                                      S01136
     C**************       READPCUSDL                    40               S01136
     C                     MOVE '0'       *IN71                           S01136
     C*                                                                   S01119
     C                     MOVE *BLANK    SFLINE                          S01119
     C*                                                                   S01119
     C                     Z-ADD0         CNT     10                      S01119
     C           12        SUB  SAVLIN    PAGFIL  30                      S01119
     C           CNT       DOWLTPAGFIL                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     ADD  1         CNT                             S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C*    LINE01 COMMON TO ALL DEAL TYPES                                S01119
     C*                                                                   S01119
     C                     MOVE '1'       *IN20             NOT SFLCLR    S01119
     C*                                                                   S01119
     C                     MOVE '0'       *IN70             ENABLE LEOPSF S01119
     C                     EXSR LINE01                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                 30               S01119
     C/COPY WNCPYSRC,DL0120C019
     C*                                                                   S01119
     C*    LINE02 COMMON TO ALL NON-FRA/IRS DEALS                         S01119
     C*                                                                   S01119
     C           *IN11     IFEQ '0'                                       S01119
     C                     MOVE '1'       *IN70             DISABLE LEOPSFS01119
     C                     EXSR LINE02                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                 30               S01119
      *                                                                   CGL011
      ** If CGL011 is installed and Collateral Flag is 'Y', display       CGL011
      ** 'COLLATERAL' text field on the third subfile line.               CGL011
      *                                                                   CGL011
     C           CGL011    IFEQ 'Y'                                       CGL011
     C           HKCOLF    IFEQ 'Y'                                       CGL011
     C           COLF      OREQ 'Y'                                       CGL011
     C                     ADD  1         RCDNBR                          CGL011
     C                     MOVE *BLANKS   SFLINE                          CGL011
     C                     MOVELCOLLA     SFLINE                          CGL011
     C                     WRITEDL0120F2                                  CGL011
     C                     MOVE *BLANKS   SFLINE                          CGL011
     C                     MOVE *BLANK    HKCOLF                          CGL011
     C                     MOVE *BLANK    COLF                            CGL011
     C                     ENDIF                                          CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
     C/COPY WNCPYSRC,DL0120C006
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C                     MOVE '1'       *IN70             DISABLE LEOPSFS01119
     C*                                                                   S01119
     C*****LINE02*AND*LINE03*FOR*'FR'*AND*'RS'*DEALS******          S01119S01157
     C*    LINE02 FOR 'FR' AND 'RS' DEALS                                 S01157
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C                     EXSR LINE02                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     END                                            S01157
     C*                                                                   S01119
     C*    LINE03 FOR 'RS' DEALS                                          S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01157
     C                     EXSR LINE03                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*    LINE02, LINE04 AND LINE03 FOR 'RX' DEALS                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C                     EXSR LINE02                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     EXSR LINE04                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     EXSR LINE03                                    S01119
     C                     ADD  1         RCDNBR                          S01119
     C                     WRITEDL0120F2                                  S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****LINE05,*LINE03*AND*LINE06*IF*UDSTI/TDSTI*ON*            S01119 S01157
     C*                                                            S01119 S01157
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C*********************EXSR LINE05                             S01119 S01157
     C*********************ADD  1         RCDNBR                   S01119 S01157
     C*********************WRITEDL0120F2                           S01119 S01157
     C*********************EXSR LINE03                             S01119 S01157
     C*********************ADD  1         RCDNBR                   S01119 S01157
     C*********************WRITEDL0120F2                           S01119 S01157
     C************IN45     IFEQ '1'                                S01119 S01157
     C*********************EXSR LINE06                             S01119 S01157
     C*********************ADD  1         RCDNBR                   S01119 S01157
     C*********************WRITEDL0120F2                           S01119 S01157
     C*********************END                                     S01119 S01157
     C*********************END                                     S01119 S01157
     C*                                                                   S01157
     C**LINE05, LINE03 AND LINE06 FOR DEAL TYPE COLLAR 'RR'               S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C                     EXSR LINE05                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     EXSR LINE03                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     EXSR LINE06                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C**LINE05 AND LINE03 FOR DEAL TYPE CAP 'RP'                          S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RP'                                      S01157
     C                     EXSR LINE05                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     EXSR LINE03                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C**LINE06 AND LINE03 FOR DEAL TYPE FLOOR 'RF'                        S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'RF'                                      S01157
     C                     EXSR LINE06                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     EXSR LINE03                                    S01157
     C                     ADD  1         RCDNBR                          S01157
     C                     WRITEDL0120F2                                  S01157
     C                     END                                            S01157
     C*                                                                   S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0120C020
     C*                                                                   S01119
     C*    SAVE LINES FOR PAGE FILLING IN NEXT PASS                       S01119
     C*                                                                   S01119
     C                     MOVE LINES     SAVLIN  20                      S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*     SAVE SUBFILE RCDNBR FOR SUBSEQUENT ROLL UP PAST SUBFILE END   S01119
     C*                                                                   S01119
     C************         MOVE RCDNBR    SAVRCN  30            S01119    E13029
     C                     MOVE RCDNBR    SAVRCN  40                      E13029
     C                     END                                            S01119
     C           CHECK     TAG                             **CHECKTAG**   S01119
     C*                    EXSR LINE01                                    S01119
     C*                    EXSR LINE02                                    S01119
     C*                                                                   S01119
     C******RESET RCDNBR TO PAGE                                          S01119
     C*                    Z-ADDKOUNT     RCDNBR                          S01119
     C*                                                                   S01119
     C******INCREMENT RECORD NUMBER                                       S01119
     C*                    MOVE '1'       *IN20                           S01119
     C*                    ADD  1         RCDNBR                          S01119
     C*                    ADD  1         KOUNT                           S01119
     C*                    WRITEDL0120F2                 30               S01119
     C*                                                                   S01119
     C*                    MOVE *BLANKS   TEXT                            S01119
     C*                                                                   S01119
     C*                    END                                            S01119
     C*          CHECK     TAG                             **CHECKTAG**   S01119
     C*
     C**    WHEN SUBFILE PAGE FULL READ TO SEE IF THERE IS NEXT RECORD
     C**    TO CONDITION SFLEND
     C**
     C*                                                                   S01136
     C** ACCESS APPROPRIATE FILES                                         S01136
     C                     EXSR #BBA                                      S01136
     C***********CUSKEY    READECUSDL                    41               S01136
     C**
     C**    IF LIVE AND MATURED RECORDS SELECTED
     C           *IN31     CABEQ'1'       RECCHK
     C**
     C**    ONLY LIVE SELECTED
     C           *IN28     IFEQ '1'
     C           RECIC     IFEQ 'M'
     C           RECIC     OREQ 'N'
     C           *IN41     CABEQ'0'       CHECK
     C                     END
     C                     END
     C**
     C**    ONLY MATURED SELECTED
     C           *IN29     IFEQ '1'
     C           RECIC     IFEQ 'D'
     C           RECIC     OREQ 'R'
     C           RECIC     OREQ 'E'
     C*                                                                   S01136
     C** EXCLUDE DRS DEAL TYPES A,I,C                                     S01136
     C           RECIC     OREQ 'A'                                       S01136
     C           RECIC     OREQ 'I'                                       S01136
     C           RECIC     OREQ 'C'                                       S01136
     C           DLREC     OREQ 'D'                                       S01136
     C           *IN41     CABEQ'0'       CHECK
     C                     END
     C                     END
     C*
     C           RECCHK    TAG                             *RECCHK TAG*
     C*
     C           *IN41     IFEQ '1'
     C                     MOVE '0'       *IN18
     C                     ELSE
     C**
     C**    IF THERE IS A NEXT RECORD BACK IT OUT
     C**
     C                     MOVE '1'       *IN18
     C                     MOVE '1'       *IN71                           S01136
     C*                                                                   S01136
     C** ACCESS APPROPRIATE FILES                                         S01136
     C                     EXSR #BBA                                      S01136
     C************         READPCUSDL                    41               S01136
     C                     MOVE '0'       *IN71                           S01136
     C                     END
     C           ENDLD     TAG                             **ENDLDTAG**
     C*
     C                     MOVE '0'       *IN42
     C*
     C                     MOVE '1'       *IN21
     C**
     C**    WRITE DL0120F1 FOR ERROR MESSAGES
     C                     WRITEDL0120F1
     C*
     C*                                                                   E22855
     C*********************EXFMTDL0120F3               44                 E22855
     C*********************EXFMTDL0120F4               44           E22855S01311
     C                     EXFMTDL0120F3               44           E22855S01311
     C*                                                                   E22855
     C**
     C******CMD/8*PRINT*DETAILS*FOR*THIS*CUSTOMER***********              S01203
     C*********  *INKH     IFEQ '1'                                       S01203
     C**    CMD/9 PRINT DETAILS FOR THIS CUSTOMER                         S01203
     C           *INKI     IFEQ '1'                                       S01203
     C                     EXSR PRINTD
     C                     END
     C           *IN43     IFEQ '0'
     C           *IN62     ANDEQ'0'
     C                     GOTO FINLD
     C                     END
     C********   *INKA     IFEQ '0'                                       S01203
     C           *INKC     IFEQ '0'                                       S01203
     C           *INKA     ANDEQ'0'                                       S01311
     C           *INKL     ANDEQ'0'                                       S01311
     C           *INKI     ANDEQ'0'                                       S01311
      *                                                                                       214207
      ** Skip process if roll up was requested by the user.                                   214207
     C           *IN41     IFEQ *ON                                                           214207
     C           *IN18     OREQ *OFF                                                          214207
     C*
     C           SFLRD     TAG                             *SFLRD TAG**
     C*
     C                     MOVE '0'       *IN64
     C*
     C**    LOWER LINK ENQUIRY REQUESTED TO DEALS FILE ENQUIRY,
     C**    MORE THAN ONE ENTRY MAY BE MADE IN THE SELECTION FIELDS,
     C**    VALIDATION WILL BE CARRIED OUT ONE AT A TIME,
     C**
     C                     READCDL0120F2                 44
     C                     MOVE ZDLNO     DLNO                            S01119
     C/COPY WNCPYSRC,DLH00287
     C           *IN44     IFEQ '1'
     C                     MOVE '0'       *IN63
     C                     END
     C**                                                                  E15119
     C** ALLOW FOR POSSIBLE 'SPACE-BAR' USE ON A SUBFILE RECORD......     E15119
     C** THIS APPEARS TO THE READC AS A CHANGED REC,BUT LEOPSF IS BLANK   E15119
     C** SO IGNORE THAT RECORD, AND PERFORM ANOTHER READC OPERATION.      E15119
     C**                                                                  E15119
     C           *IN44     IFEQ '0'                                       E15119
     C           LEOPSF    ANDEQ' '                                       E15119
     C                     GOTO SFLRD                                     E15119
     C                     END                                            E15119
     C**                                                                  E15119
     C           LEOPSF    IFNE ' '
     C                     MOVE '0'       *IN62
     C                     EXSR DTRQSS
     C*
     C                     MOVE '1'       *IN20
     C*
     C                     EXSR TEXSET
     C**
     C**    MOVE BLANK INTO SELECTION FIELD AND SETOF SFLNXTCHG IND.
     C           *IN43     IFEQ '1'
     C                     MOVE ' '       LEOPSF
     C           *IN63     IFEQ '1'
     C                     MOVE '1'       *IN64
     C                     END
     C                     MOVE '0'       *IN63
     C                     END
     C                     MOVE '0'       *IN70             ENABLE LEOPSF S01119
     C                     UPDATDL0120F2
     C           *IN41     IFEQ '0'
     C                     MOVE '1'       *IN18
     C                     END
     C*
     C           *IN64     IFEQ '1'
     C                     READCDL0120F2                 44
     C                     MOVE ZDLNO     DLNO                            S01119
     C/COPY WNCPYSRC,DLH00288
     C           *IN44     IFEQ '0'
     C                     MOVE '1'       *IN63
     C                     EXSR TEXSET
     C                     MOVE '0'       *IN70             ENABLE LEOPSF S01119
     C                     UPDATDL0120F2
     C                     END
     C                     END
     C                     GOTO ENDLD
     C                     END
     C           *IN63     IFEQ '1'
     C**
     C**    SELECTION FIELD BLANKED OUT AFTER ERROR - RESET DSPATR(RI)
     C           LEOPSF    IFEQ ' '
     C           DLNO      IFEQ SDLNO
     C                     MOVE '0'       *IN62
     C*
     C                     EXSR TEXSET
     C                     MOVE '0'       *IN70             ENABLE LEOPSF S01119
     C                     UPDATDL0120F2
     C                     END
     C                     GOTO SFLRD
     C                     END
     C                     MOVE '0'       *IN70             ENABLE LEOPSF S01119
     C                     UPDATDL0120F2
     C                     GOTO SFLRD
     C                     END
      *                                                                                       214207
     C                     ENDIF                                                              214207
     C**
     C**    ROLLUP REQUESTED, ERROR IF COMPLETE
     C**
     C           *IN18     IFEQ '1'
     C           *IN41     IFEQ '0'
     C*
     C*     RESET RCDNBR IF ROLL UP PAST EXISTING SUBFILE END             S01119
     C*                                                                   S01119
     C                     MOVE SAVRCN    RCDNBR                          S01119
     C                     GOTO FILL
     C                     ELSE
     C                     MOVE '0'       *IN18                           S01136
     C                     GOTO ENDLD
     C                     END
     C                     END
     C                     END
     C*
     C           FINLD     ENDSR
     C********************************************************************
     C/SPACE 3
     C**
     C********************************************************************
     C**
     C**    LINE01 SR TO FORMAT DETAILS OF DEAL FOR SUBFILE LINE 1
     C**
     C**    CALLED FROM    LOAD
     C******CALLS**********XCYCHN,*ZDATE2,*ZEDIT******                    S01194
     C**    CALLS          ZDATE2, ZEDIT                                  S01194
     C**
     C           LINE01    BEGSR                           *** DETAIL ***
     C**
0563 C**
     C                     MOVE *BLANKS   LEOPSF
     C*                                                                   S01136
     C** FORMAT DRS DEALS ACCORDING TO FORMAT READ                        S01136
     C*                                                                   S01136
     C** CHECK RECORD IDENTIFIER FOR F-X OR MONEY MARKET.                 S01136
     C********** @INDS     IFEQ 'FXDEALP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'FXDEALP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'FXDEALP0'                 B1             E20251
     C           @INDS     OREQ 'FXDEALP1'                                S01311
     C/COPY WNCPYSRC,DLH00276
     C                     EXSR #B                         *1             S01136
     C                     GOTO ENDFMT                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** FORMAT NON - FX DRS DEALS ************************************   S01136
     C*                                                                   S01136
     C************ DRS DEPOSITS ***************************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDELDP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDELDP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDELDP0'                 B1             E20251
     C           @INDS     OREQ 'MMDELDP1'                                S01311
     C/COPY WNCPYSRC,DLH00277
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C                     EXSR #C                         *1             S01136
     C                     GOTO ENDFMT                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS BOUGHT.***************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDENBP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDENBP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDENBP0'                 B1             E20251
     C           @INDS     OREQ 'MMDENBP1'                                S01311
     C/COPY WNCPYSRC,DLH00278
     C                     EXSR #D                         *1             S01136
     C                     GOTO ENDFMT                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS SOLD.*****************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDENSP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDENSP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDENSP0'                 B1             E20251
     C           @INDS     OREQ 'MMDENSP1'                                S01311
     C/COPY WNCPYSRC,DLH00279
     C                     EXSR #E                         *1             S01136
     C                     GOTO ENDFMT                     *1             S01136
     C                     END                             E1             S01136
     C*
     C**
     C**   DEAL TYPE TEXT
     C******************   MOVE *BLANKS   DTYPW   5                       S01157
     C                     MOVE *BLANKS   DTYPW                           S01157
     C                     MOVELDTYP      DTYPW                                               CDL038
     C**********           MOVE *BLANKS   STWK2   3                                    S01157 CDL038
     C******************   MOVELDTYP      DTYPW                           S01157
     C**********           MOVELDTYP      STWK2                                        S01157 CDL038
     C**********           MOVE '-'       STWK2                                        S01157 CDL038
     C                     MOVE *BLANKS   STWK    3
     C                     MOVEL'-'       STWK                                                CDL038
     C                     MOVE DLST      STWK                                                CDL038
     C******************   MOVEL'-'       STWK                            S01157
     C******************   MOVE DLST      STWK                            S01157
     C**********           MOVELDLST      STWK                                         S01157 CDL038
     C***32*****           MOVE BYSL      STWK                                         S01157 CDL038
     C**********           MOVELSTWK2     DTYPW                                        S01157 CDL038
     C                     MOVE STWK      DTYPW                           S01157
     C                     MOVE CLAS      CLASW                                               CDL038
     C   32                MOVE BYSL      BYSLW                                               CDL038
     C  N32                MOVE ' '       BYSLW                                               CDL038
0564 C**   FX - CHECK FOR OPTION.
0565 C           DTYP      COMP 'OP'                     34
0564 C**   FX - CHECK FOR NOSTRO TRANSFER
0565 C           DTYP      COMP 'NX'                     35
0566 C**   GET DEAL AMOUNT.
0567 C   04                Z-ADDPUAM      AMT1   130
0568 C   05                Z-ADDPCPL      AMT1
0569 C   06                Z-ADDFVAL      AMT1
0570 C   07                Z-ADDSAPR      AMT1
0570 C   11                Z-ADDUPAMT     AMT1                            S01119
     C                     MOVE '1'       *IN54
0571 C*****IS DEAL REVERSED                                               S01119
0572 C*          RECIC     IFEQ 'R'                                       S01119
     C*                    MOVE 'REVERSED'TEXT                            S01119
     C*                    MOVE '0'       *IN54                           S01119
     C*                    END                                            S01119
     C*****OR MATURED                                                     S01119
     C*          *IN42     IFEQ '1'                                       S01119
     C*                    MOVEL'MATURED' TEXT    8                       S01119
     C*                    MOVE '0'       *IN54                           S01119
     C*                    END                                            S01119
0573 C* IS DEAL FEDERAL FUND
0574 C                     SETOF                     5658
0575 C                     SETON                     5557
0576 C* N04      CCY       COMP USCY                     56               S01119
0576 C**N04N11***CCY*******COMP USCY                     56         S01119S01194
0577 C***04******PUCY******COMP USCY                     56               S01194
0577 C***11******UCUCY*****COMP USCY                     56         S01119S01194
0578 C***04N56***SLCY******COMP USCY                     58               S01194
0578 C**N56*11***TCUCY*****COMP USCY                     58         S01119S01194
0576 C  N04N11   CCY       COMP BLUSCY                   56         S01194BHF486
0577 C   04      PUCY      COMP BLUSCY                   56         S01194BHF486
0577 C   11      UCUCY     COMP BLUSCY                   56         S01194BHF486
0578 C   04N56   SLCY      COMP BLUSCY                   58         S01194BHF486
0578 C  N56 11   TCUCY     COMP BLUSCY                   58               S01194
0579 C*  56                TESTB'2'       DSTI       55                   S01119
0579 C   56N11             TESTB'2'       DSTI       55                   S01119
0579 C   56 11             TESTB'2'       UDSTI      55                   S01119
0580 C*  58                TESTB'3'       DSTI       57                   S01119
0580 C   58N11             TESTB'3'       DSTI       57                   S01119
0580 C   58 11             TESTB'2'       TDSTI      57                   S01119
0581 C*    FOR C1 DO NOT SHOW YIELD
0582 C           DTYP      COMP 'C1'                     46
0583 C   46                Z-ADD0         YRAT
0584 C**
0585 C**   GET NO. OF DECIMAL PLACES.
0586 C* N04                GOTO CCY1                                      S01119
0587 C*                    MOVE SLCY      XXCCY                           S01119
0586 C  N04N39             GOTO CCY1                                      S01119
0587 C  N39                MOVE SLCY      XXCCY                           S01119
     C   39                MOVE TCUCY     XXCCY                           S01119
0588 C*********************EXSR XCYCHN                                    S01194
     C                     EXSR #L                                        S01194
0595 C*
     C**   SAVE SALE CCY DECIMAL PLACES.                                  E10784
     C*********************Z-ADDXDECP     SCCDP   10                E10784S01194
     C                     MOVELA6NBDP    SCCDP   10                      S01194
     C*                                                                   E10784
0596 C           CCY1      TAG                             ** CCY1 **
0597 C   04                MOVE PUCY      XXCCY
0598 C* N04                MOVE CCY       XXCCY                           S01119
0598 C  N04N11             MOVE CCY       XXCCY                           S01119
     C   11                MOVE UCUCY     XXCCY                           S01119
0599 C*********************EXSR XCYCHN                                    S01194
     C                     EXSR #L                                        S01194
0584 C**
0585 C**  EDIT AMOUNT
0587 C                     Z-ADDAMT1      ZAMNT
0587 C                     MOVE 'Y'       ZCOMMA
0587 C                     MOVE 'N'       ZMINUS
0587 C*********************Z-ADDXDECP     ZCDP                            S01194
     C                     MOVELA6NBDP    ZCDP                            S01194
0602 C                     EXSR ZEDIT
0603 C                     MOVE ZAMNTA    AMT1W  17
0600 C**   FORMAT DATES.
0601 C                     Z-ADDDDAT      ZDAYNO           DEAL DATE
0602 C                     EXSR ZDATE2
0603 C                     MOVE ZADATE    DDATE   7
0604 C*
0605 C                     Z-ADDVDAT      ZDAYNO           VALUE DATE
0606 C                     EXSR ZDATE2
0607 C                     MOVE ZADATE    VDATE   7
0608 C*
0609 C   07
0610 COR 23                GOTO NARDET
0611 C                     Z-ADDMDAT      ZDAYNO           MATURITY OR
0612 C   04                Z-ADDOTDT      ZDAYNO
0613 C                     EXSR ZDATE2                     OPTION TO DATE
0614 C                     MOVE ZADATE    MDATE   7
     C/COPY WNCPYSRC,DLH00289
     C*
     C           NARDET    TAG                             **NARDET TAGSR*
0615 C**
0615 C**  DETERMINE NARR1 FIELD
0614 C                     MOVEL*BLANKS   NARR1
0614 C   04N35             MOVEL'PURCHASE'NARR1
0610 C   05      MDAT      IFNE 0
0614 C                     MOVELMDATE     NARR1
0610 C                     ELSE
0614 C                     MOVELNOTD      NARR1
0610 C                     END
0614 C   06                MOVELMDATE     NARR1
0614 C   11                MOVELMDATE     NARR1                           S01119
0615 C**
0615 C**  DETERMINE CCY   FIELD
0614 C   04                MOVELPUCY      CCY
0614 C   11                MOVELUCUCY     CCY                             S01119
0615 C**
0615 C**  DETERMINE FFIN  FIELD
     C  N55                MOVE 'F'       FFIN
0615 C**
0615 C**  DETERMINE RDNO  FIELD
0614 C                     MOVEL*BLANKS   RDNO
0610 C   04      SODN      IFNE 0
0614 C                     MOVELSODN      RDNO
0610 C                     END
0610 C   05      RODN      IFNE 0
0614 C                     MOVELRODN      RDNO
0610 C                     END
0610 C   05      RBDN      IFNE 0
0614 C                     MOVELRBDN      RDNO
0610 C                     END
0610 C   06      ASDN      IFNE 0
0614 C                     MOVELASDN      RDNO
0610 C                     END
0610 C   07      RPDN      IFNE 0
0614 C                     MOVELRPDN      RDNO
0610 C                     END
0610 C   11      LNKDN     IFNE 0                                         S01119
0614 C                     MOVELLNKDN     RDNO                            S01119
0610 C                     END                                            S01119
0615 C*                                                                   S01119
     C           ENDFMT    TAG                             **ENDFMT TAGSR*S01136
     C*                                                                   S01184
     C**  If CONFIRMATION MATCHING present and deal is FX, MM or NA,      S01184
     C**  get Counterparty/Broker matching status (defaults to "NO        S01184
     C**  FEEDBACK YET".                                                  S01184
     C           @CNF      IFEQ 'Y'                                       S01184
     C                     MOVE *BLANKS   CPST    2                       S01184
     C                     MOVE *BLANKS   BKST    2                       S01184
     C           @INDS     IFEQ 'FXDEALP0'                                S01184
     C           @INDS     OREQ 'FXDEALP1'                                S01184
     C           @INDS     OREQ 'MMDELDP0'                                S01184
     C           @INDS     OREQ 'MMDELDP1'                                S01184
     C           @INDS     OREQ 'MMDENBP0'                                S01184
     C           @INDS     OREQ 'MMDENBP1'                                S01184
     C           @INDS     OREQ 'MMDENSP0'                                S01184
     C           @INDS     OREQ 'MMDENSP1'                                S01184
     C/COPY WNCPYSRC,DLH00280
     C                     MOVE '00'      CPST                            S01184
     C                     MOVE '00'      BKST                            S01184
     C                     MOVE DLNO      @KY2                            S01184
     C           CFKY      SETGTCFFEEDL0                                  S01184
     C                     READPCFFEEDL0                 33               S01184
     C***********          MOVELIMRF      @TS2    7                S01184 058405
     C                     MOVELIMRF      @TS2    8                       058405
     C           *IN33     IFEQ '0'                                       S01184
     C           @TS1      ANDEQ@TS2                                      S01184
     C                     MOVELCPSX      CPST                            S01184
     C                     MOVELBKSX      BKST                            S01184
     C                     END                                            S01184
     C                     SETOF                     33                   S01184
     C*                                                                   S01184
     C**  Broker involved?                                                S01184
     C*                                                                   S01184
     C           BRKC      IFEQ 'PHON'                                    S01184
     C           BRKC      OREQ 'TELX'                                    S01184
     C           BRKC      OREQ 'MAIL'                                    S01184
     C           BRKC      OREQ 'SWAP'                                    S01184
     C                     MOVE *BLANKS   BKST                            S01184
     C                     END                                            S01184
     C*                                                                   S01184
     C                     END                                            S01184
     C                     END                                            S01184
     C*                                                                   S01184
     C                     MOVE ZLINE1    SFLINE                          S01119
     C                     MOVE *BLANKS   ZLINE1                          S01119
0615 C*
     C           ENDDET    ENDSR                           **ENDDET ENDSR*
     C**
     C**
     C********************************************************************
     C/SPACE 3
0721 C********************************************************************
     C**
     C**
0722 C*    LINE02 SR TO FORMAT DEAL DETAILS FOR LINE 2 NON FRA/IRS,       S01119
     C*    'FR', 'RS' AND 'RX' DEALS                                      S01119
     C*    CALLED FROM   LOAD                                             S01119
     C*    CALLS SR                                                       S01119
     C*                                                                   S01119
0723 C           LINE02    BEGSR                           ** LIN2SR  ***
0725 C                     MOVE *BLANKS   LINE2
0725 C                     MOVEA*BLANKS   LIN
     C/COPY WNCPYSRC,DL0120C007
     C*                                                                   S01136
     C** FORMAT DRS DEALS FOR LINE02 ACCORDING TO FORMAT READ             S01136
     C*                                                                   S01136
     C** CHECK RECORD IDENTIFIER FOR F-X OR MONEY MARKET.                 S01136
     C********** @INDS     IFEQ 'FXDEALP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'FXDEALP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'FXDEALP0'                 B1             E20251
     C           @INDS     OREQ 'FXDEALP1'                                S01311
     C/COPY WNCPYSRC,DLH00281
     C                     EXSR #F                         *1             S01136
     C                     GOTO ENDFM2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** FORMAT NON - FX DRS DEALS ************************************   S01136
     C*                                                                   S01136
     C************ DRS DEPOSITS ***************************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDELDP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDELDP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDELDP0'                 B1             E20251
     C           @INDS     OREQ 'MMDELDP1'                                S01311
     C/COPY WNCPYSRC,DLH00282
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C                     EXSR #G                         *1             S01136
     C                     GOTO ENDFM2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS BOUGHT.***************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDENBP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDENBP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDENBP0'                 B1             E20251
     C           @INDS     OREQ 'MMDENBP1'                                S01311
     C/COPY WNCPYSRC,DLH00283
     C                     EXSR #H                         *1             S01136
     C                     GOTO ENDFM2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C************ NEGOTIABLE ASSETS SOLD.*****************************   S01136
     C*                                                                   S01136
     C********** @INDS     IFEQ 'MMDENSP0'                 B1      S01136 E20251
     C********** @INDS     OREQ 'MMDENSP1'                 X1      S01136 E20251
     C           @INDS     IFEQ 'MMDENSP0'                 B1             E20251
     C           @INDS     OREQ 'MMDENSP1'                                S01311
     C/COPY WNCPYSRC,DLH00284
     C                     EXSR #I                         *1             S01136
     C                     GOTO ENDFM2                     *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01119
0571 C*    IS DEAL REVERSED                                               S01119
0572 C           RECIC     IFEQ 'R'                                       S01119
     C                     MOVEL'REVERSED'TEXT    8                       S01119
     C**********           MOVE HEX20     ZF2                                          S01119 259968
     C**********           MOVELHEX21     ZF1                                          S01119 259968
     C**********           MOVELHEX22     LIN,1                                        S01119 259968
     C                     MOVE '0'       *IN54                           S01119
     C                     END                                            S01119
     C*    OR MATURED                                                     S01119
     C           *IN42     IFEQ '1'                                       S01119
     C                     MOVEL'MATURED' TEXT                            S01119
     C**********           MOVE HEX20     ZF2                                          S01119 259968
     C**********           MOVELHEX21     ZF1                                          S01119 259968
     C**********           MOVELHEX22     LIN,1                                        S01119 259968
     C                     MOVE '0'       *IN54                           S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0120C014
     C*                                                                   S01119
     C*   NON FRA/IRS DEALS                                               S01119
     C*                                                                   S01119
     C           *IN11     IFEQ '0'                                       S01119
      *  Foreign exchange trades (*IN04)                                  S01378
0726 C           *IN04     IFEQ '1'
0584 C**
0585 C**  EDIT AMOUNT
0587 C                     Z-ADDSLAM      ZAMNT
0587 C                     MOVE 'Y'       ZCOMMA
0587 C                     MOVE 'N'       ZMINUS
0587 C*********************Z-ADDXDECP     ZCDP                            E10784
     C                     Z-ADDSCCDP     ZCDP                            E10784
0602 C                     EXSR ZEDIT
0603 C                     MOVE ZAMNTA    SLAMWF 17
0725 C   34                MOVEATXT,1     LIN,7                           S01119
0725 C   34                MOVEAMDATE     LIN,18                          S01119
0725 C  N35                MOVEATXT,2     LIN,30                          S01119
0725 C  N35                MOVEASLCY      LIN,35                          S01119
     C  N57                MOVEA'F'       LIN,41                          S01119
0725 C  N35                MOVEASLAMWF    LIN,42                          S01119
0725 C*  34                MOVEATXT,1     LIN,2                           S01119
0725 C* N35                MOVEATXT,2     LIN,25                          S01119
0725 C*  34                MOVEAMDATE     LIN,13                          S01119
0725 C* N35                MOVEASLCY      LIN,30                          S01119
     C* N57                MOVEA'F'       LIN,36                          S01119
0725 C* N35                MOVEASLAMWF    LIN,37                          S01119
     C/COPY WNCPYSRC,DL0120C008
0728 C                     ELSE
      * loans/deposits (*IN05)                                            S01378
0726 C           *IN05     IFEQ '1'
     C                     Z-ADDRTSP      ZRATE
     C                     EXSR RTEDIT
     C                     MOVE ZRATEA    RTSPXX
0725 C*                    MOVEATXT,3     LIN,3                           S01119
0725 C*                    MOVEATXT,4     LIN,23                          S01119
0725 C                     MOVEATXT,3     LIN,8                           S01119
     C                     MOVE BRTT      BRTTWF  2
0725 C*                    MOVEABRTTWF    LIN,14                          S01119
0725 C*                    MOVEARTSPXX    LIN,40                          S01119
0725 C                     MOVEABRTTWF    LIN,19                          S01119
0725 C                     MOVEATXT,4     LIN,28                          S01119
0725 C                     MOVEARTSPXX    LIN,44                          S01119
     C/COPY WNCPYSRC,DL0120C009
0728 C                     ELSE
      * NA's purchased (*IN06)                                            S01378
0726 C           *IN06     IFEQ '1'
     C                     Z-ADDRTSP      ZRATE
     C                     EXSR RTEDIT
     C                     MOVE ZRATEA    RTSPXX 12
     C                     Z-ADDYRAT      ZRATE
     C                     EXSR RTEDIT
     C                     MOVE ZRATEA    YRATXX 12
0725 C*                    MOVEATXT,5     LIN,2                           S01119
0725 C*                    MOVEATXT,4     LIN,23                          S01119
0725 C*                    MOVEAYRATXX    LIN,8                           S01119
0725 C*                    MOVEARTSPXX    LIN,40                          S01119
0725 C                     MOVEATXT,5     LIN,8                           S01119
0725 C                     MOVEAYRATXX    LIN,13                          S01119
0725 C                     MOVEATXT,4     LIN,28                          S01119
0725 C                     MOVEARTSPXX    LIN,44                          S01119
     C*                                                                   S01378
     C** If parcelled NA set up parcel details (remove leading 0's)       S01378
     C           PCLI      IFEQ 'P'                                       S01378
     C                     MOVEATXT,12    LIN,59                          S01378
     C                     Z-ADDPSZE      @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     MOVEA@OUTCR    LIN,63                          S01378
     C                     END                                            S01378
     C*                                                                   S01378
0728 C                     ELSE
      * NA's sold (*IN07)                                                 S01378
0726 C           *IN07     IFEQ '1'
     C                     Z-ADDYRAT      ZRATE
     C                     EXSR RTEDIT
     C                     MOVE ZRATEA    YRATXX 12
0725 C*                    MOVEATXT,5     LIN,2                           S01119
0725 C*                    MOVEAYRATXX    LIN,8                           S01119
0725 C                     MOVEATXT,5     LIN,8                           S01119
0725 C                     MOVEAYRATXX    LIN,13                          S01119
     C*                                                                   S01378
     C** If parcelled NA set up parcel details                            S01378
     C           PCLI      IFEQ 'P'                                       S01378
     C                     MOVEATXT,12    LIN,56                          S01378
     C                     Z-ADDPSZE      @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     MOVEA@OUTCR    LIN,61                          S01378
     C                     END                                            S01378
     C*                                                                   S01378
0728 C                     END
0728 C                     END
0728 C                     END
0728 C                     END
0728 C                     ELSE                                           S01119
     C*                                                                   S01119
     C*    FRA/IRS DEALS                                                  S01119
     C*                                                                   S01119
     C*****************    MOVEATXT,8     LIN,4                    S01119 S01157
0726 C********** *IN36     IFEQ '0'                                S01119 S01157
     C*****************    MOVE UBRTT     BRTTWF                   S01119 S01157
0725 C*****************    MOVEABRTTWF    LIN,19                   S01119 S01157
     C*****************    END                                     S01119 S01157
     C*                                                                   S01157
     C* SET UP THE TXT FIELDS FIRST                                       S01157
     C* IF DEAL TYPE IS FRA - INTEREST SPREAD SHOULD READ INTEREST RATE   S01157
     C* AND BASE RATE SHOULD READ REFERENCE RATE                          S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C                     MOVEATXT,11    LIN,3                           S01157
     C                     MOVEATXT,10    LIN,28                          S01157
     C                     ELSE                                           S01157
     C                     MOVEATXT,8     LIN,4                           S01157
0725 C                     MOVEATXT,4     LIN,28                          S01119
     C                     END                                            S01157
     C*                                                                   S01157
     C* IF FRA THEN SETUP REF RATE                                        S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C*                                                                   S01157
0726 C           *IN36     IFEQ '0'                                       S01157
     C                     MOVE UBRTT     BRTTWF                          S01157
     C                     ELSE                                           S01157
     C                     MOVE TBRTT     BRTTWF                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     MOVEABRTTWF    LIN,19                          S01157
     C*                                                                   S01157
     C* ELSE DEAL IS RS OR RX - SO SETUP OUR BASE RATE                    S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
     C           *IN36     IFEQ '0'                                       S01157
     C                     MOVE UBRTT     BRTTWF                          S01157
     C                     MOVEABRTTWF    LIN,19                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C** IF AN FRA AND SOLD THEN SET UP CONTRACT RATE WITH THEIRS         S01157
     C** ELSE SETUP CONTRACT RATE WITH OURS                               S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C           BYSL      ANDEQ'S'                                       S01157
     C*                                                                   S01157
0726 C           *IN19     IFEQ '0'                                       S01157
     C                     Z-ADDTRTSP     ZRATE                           S01157
     C                     EXSR RTEDIT                                    S01157
     C                     MOVE ZRATEA    TRTSPX 12                       S01157
0725 C                     MOVEATRTSPX    LIN,44                          S01157
     C                     END                                            S01157
0726 C           TSPIN     IFEQ 'S'                                       S01157
     C           TSPIN     OREQ 'P'                                       S01157
     C                     MOVEATSPIN     LIN,58                          S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C                     ELSE                                           S01157
     C*                                                                   S01157
0726 C           *IN37     IFEQ '0'                                       S01119
     C                     Z-ADDURTSP     ZRATE                           S01119
     C                     EXSR RTEDIT                                    S01119
     C                     MOVE ZRATEA    URTSPX 12                       S01119
0725 C                     MOVEAURTSPX    LIN,44                          S01119
     C                     END                                            S01119
0726 C           USPIN     IFEQ 'S'                                       S01119
     C           USPIN     OREQ 'P'                                       S01119
     C                     MOVEAUSPIN     LIN,58                          S01119
0728 C                     END                                            S01119
     C*                                                                   S01157
     C                     END                                            S01157
0728 C                     END                                            S01119
     C           ENDFM2    TAG                             **ENDFM2 TAGSR*S01136
     C*                                                                   S01184
     C**  IF CONFIRMATION MATCHING PRESENT GET COUNTERPARTY/BROKER STATUS S01184
     C*                                                                   S01184
     C           @CNF      IFEQ 'Y'                                       S01184
     C/COPY WNCPYSRC,DL0120C010
     C           CPST      ANDNE*BLANKS                                   S01184
     C           BKST      ANDNE*BLANKS                                   S01184
     C                     MOVEACPST      LIN,60                          S01184
     C                     MOVEABKST      LIN,63                          S01184
     C                     MOVEA'CF'      LIN,66                          S01184
     C/COPY WNCPYSRC,DL0120C011
     C                     END                                            S01184
     C*                                                                   S01184
0725 C                     MOVEALIN       LINE2
0727 C*
     C                     MOVE ZLINE2    SFLINE                          S01119
     C                     MOVE *BLANKS   ZLINE2                          S01119
     C*                                                                   S01119
0728 C                     ENDSR
     C/COPY WNCPYSRC,DL0120C021
     C**
     C********************************************************************
     C/SPACE 3                                                            S01119
0721 C********************************************************************S01119
     C**                                                                  S01119
0722 C*    LINE03 SR TO FORMAT DEAL DETAILS FOR LINE 3 'FR', 'RS',        S01119
     C*****'RL'*DEALS;*LINE*4*'RX'*DEALS*********                  S01119 S01157
     C*    'RR', 'RP', 'RF' DEALS; LINE 4 'RX' DEALS                      S01157
     C**   CALLED FROM   LOAD                                             S01119
     C**                                                                  S01119
0723 C           LINE03    BEGSR                           ** LIN3SR  *** S01119
0725 C                     MOVE *BLANKS   LINE3                           S01119
0725 C                     MOVEA*BLANKS   LIN                             S01119
     C*                                                                   S01119
     C                     MOVE '1'       *IN54                           S01119
     C*                                                                   S01119
     C           *IN49     IFEQ '1'                                       S01119
     C           *IN53     OREQ '1'                                       S01119
     C*                                                                   S01119
0571 C*    IS DEAL REVERSED                                               S01119
0572 C           RECIC     IFEQ 'R'                                       S01119
     C                     MOVEL'REVERSED'TEXT2   8                       S01119
     C**********           MOVE HEX20     ZF4                                          S01119 259968
     C**********           MOVELHEX21     ZF3                                          S01119 259968
     C**********           MOVELHEX22     LIN,1                                        S01119 259968
     C                     MOVE '0'       *IN54                           S01119
     C                     END                                            S01119
     C*    OR MATURED                                                     S01119
     C           *IN42     IFEQ '1'                                       S01119
     C                     MOVEL'MATURED' TEXT2                           S01119
     C**********           MOVE HEX20     ZF4                                          S01119 259968
     C**********           MOVELHEX21     ZF3                                          S01119 259968
     C**********           MOVELHEX22     LIN,1                                        S01119 259968
     C                     MOVE '0'       *IN54                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN47     IFEQ '1'                                       S01119
     C           *IN39     OREQ '1'                                       S01119
     C           *IN53     OREQ '1'                                       S01119
     C*                                                                   S01157
     C** IF THEIR CAP OR COLLAR MOVE 'BASE RATE' INTO TEXT ELSE SPECIFY   S01157
     C** 'THEIR BASE RATE'                                                S01157
     C*                                                                   S01157
     C           *IN53     IFEQ '1'                                       S01157
     C                     MOVEATXT,3     LIN,8                           S01157
     C                     ELSE                                           S01157
     C                     MOVEATXT,9     LIN,2                           S01119
     C                     END                                            S01157
     C*                                                                   S01157
0726 C           *IN38     IFEQ '0'                                       S01119
     C                     MOVE TBRTT     BRTTWF                          S01119
     C                     MOVEABRTTWF    LIN,19                          S01119
     C                     END                                            S01119
     C*                                                                   S01157
     C* IF DEAL TYPE IS FRA - INTEREST SPREAD SHOULD READ INTEREST RATE   S01157
     C*                                                                   S01157
     C           DTYP      IFEQ 'FR'                                      S01157
     C                     MOVEATXT,10    LIN,28                          S01157
     C                     ELSE                                           S01157
0725 C                     MOVEATXT,4     LIN,28                          S01119
     C                     END                                            S01157
0726 C           *IN19     IFEQ '0'                                       S01119
     C                     Z-ADDTRTSP     ZRATE                           S01119
     C                     EXSR RTEDIT                                    S01119
     C                     MOVE ZRATEA    TRTSPX 12                       S01119
0725 C                     MOVEATRTSPX    LIN,44                          S01119
     C                     END                                            S01119
0726 C           TSPIN     IFEQ 'S'                                       S01119
     C           TSPIN     OREQ 'P'                                       S01119
     C                     MOVEATSPIN     LIN,58                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN49     IFEQ '1'                                       S01119
     C******************** MOVEATXT,8     LIN,4                    S01119 S01157
     C                     MOVEATXT,3     LIN,8                           S01157
0726 C           *IN36     IFEQ '0'                                       S01119
     C                     MOVE UBRTT     BRTTWF                          S01119
     C                     MOVEABRTTWF    LIN,19                          S01119
     C                     END                                            S01119
0725 C                     MOVEATXT,4     LIN,28                          S01119
0726 C           *IN37     IFEQ '0'                                       S01119
     C                     Z-ADDURTSP     ZRATE                           S01119
     C                     EXSR RTEDIT                                    S01119
     C                     MOVE ZRATEA    URTSPX 12                       S01119
0725 C                     MOVEAURTSPX    LIN,44                          S01119
     C                     END                                            S01119
0726 C           USPIN     IFEQ 'S'                                       S01119
     C           USPIN     OREQ 'P'                                       S01119
     C                     MOVEAUSPIN     LIN,58                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
0608 C**                                                                  S01119
0725 C                     MOVEALIN       LINE3                           S01119
     C                     MOVE ZLINE3    SFLINE                          S01119
     C                     MOVE *BLANKS   ZLINE3                          S01119
     C*                                                                   S01119
     C                     ENDSR                           ** END      SR*S01119
     C**                                                                  S01119
     C**                                                                  S01119
     C********************************************************************S01119
     C/SPACE 3                                                            S01119
0721 C********************************************************************S01119
     C*                                                                   S01119
0722 C*    LINE04 SR TO FORMAT DEAL DETAILS FOR LINE 3 'RX' DEALS         S01119
     C**   CALLED FROM   LOAD                                             S01119
     C*                                                                   S01119
0723 C           LINE04    BEGSR                           ** LIN4SR  *** S01119
0725 C                     MOVEA*BLANKS   LIN                             S01119
     C*                                                                   S01119
     C*     SET UP LINE 3 FOR DEAL TYPE RX                                S01119
     C*                                                                   S01119
0726 C           *IN39     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C*     GET CURRENCY DECIMAL PLACES                                   S01119
0587 C                     MOVE TCUCY     XXCCY                           S01119
0588 C*********************EXSR XCYCHN                              S01119S01194
     C                     EXSR #L                                        S01194
0595 C**                                                                  S01119
     C*     FORMAT AMOUNT                                                 S01119
0587 C                     Z-ADDTPAMT     ZAMNT                           S01119
0587 C                     MOVE 'Y'       ZCOMMA                          S01119
0587 C                     MOVE 'N'       ZMINUS                          S01119
0587 C*********************Z-ADDXDECP     ZCDP                      S01119S01194
     C                     MOVELA6NBDP    ZCDP                            S01194
0602 C                     EXSR ZEDIT                                     S01119
0603 C                     MOVE ZAMNTA    TPAMTX 17                       S01119
0608 C**                                                                  S01119
     C                     MOVEATCUCY     LIN,45                          S01119
0726 C           *IN57     IFEQ '0'                                       S01119
     C                     MOVEA'F'       LIN,50                          S01119
     C                     END                                            S01119
     C                     MOVEATPAMTX    LIN,52                          S01119
     C                     END                                            S01119
0608 C**                                                                  S01119
0725 C                     MOVEALIN       SFLINE                          S01119
     C*                                                                   S01119
     C                     ENDSR                           **ENDDET ENDSR*S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C/SPACE 3                                                            S01119
0721 C********************************************************************S01119
     C*                                                                   S01119
0722 C*****LINE05*SR*TO*FORMAT*DEAL*DETAILS*FOR*LINE*2*'RL'*DEALS**S01119 S01157
0722 C* LINE05 SR TO FORMAT DEAL DETAILS FOR LINE 2 RR/RP/RF DEALS        S01157
     C**   CALLED FROM   LOAD                                             S01119
     C*                                                                   S01119
0723 C           LINE05    BEGSR                           ** LIN5SR  *** S01119
0725 C                     MOVEA*BLANKS   LIN                             S01119
     C*                                                                   S01119
0726 C           *IN24     IFEQ '1'                                       S01119
0726 C           *IN45     OREQ '1'                                       S01119
0725 C                     MOVEATXT,6     LIN,38                          S01119
0726 C           *IN67     IFEQ '0'                                       S01119
     C                     Z-ADDCLRAT     ZRATE                           S01119
     C                     EXSR RTEDIT                                    S01119
     C                     MOVE ZRATEA    CLRATX 12                       S01119
     C                     MOVEACLRATX    LIN,54                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
0725 C                     MOVEALIN       SFLINE                          S01119
     C*                                                                   S01119
     C                     ENDSR                           **ENDDET ENDSR*S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C/SPACE 3                                                            S01119
0721 C********************************************************************S01119
     C*                                                                   S01119
0722 C*****LINE06*SR*TO*FORMAT*DEAL*DETAILS*FOR*LINE*4*'RL'*DEALS  S01119 S01157
0722 C*    LINE06 SR TO FORMAT DEAL DETAILS FOR LINE 4 RR/RP/RF DEALS     S01157
     C**   CALLED FROM   LOAD                                             S01119
     C*                                                                   S01119
0723 C           LINE06    BEGSR                           ** LIN6SR  *** S01119
0725 C                     MOVEA*BLANKS   LIN                             S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C*****SETUP*LINE*4*FOR*DEAL*TYPE*RL***                        S01119 S01157
     C*    SETUP LINE 4 FOR DEAL TYPE RR, RP OR RF                        S01157
     C*                                                                   S01119
0725 C                     MOVEATXT,7     LIN,38                          S01119
     C                     Z-ADDFLRAT     ZRATE                           S01119
     C                     EXSR RTEDIT                                    S01119
     C                     MOVE ZRATEA    FLRATX 12                       S01119
     C                     MOVEAFLRATX    LIN,54                          S01119
     C*                                                                   S01119
0725 C                     MOVEALIN       SFLINE                          S01119
     C*                                                                   S01119
     C                     ENDSR                           **ENDDET ENDSR*S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C/SPACE 3
0721 C********************************************************************
     C**
     C**   SR. TO RESTORE INITIAL VALUE OF DISPLAY INDICATOR FOR
     C**       'MATURED' & 'REVERSED' MESSAGE I.E. IND.54
0723 C           TEXSET    BEGSR                           *** TEXSET ***
     C**
     C           TEXT      IFEQ *BLANKS
     C                     MOVE '1'       *IN54
     C                     ELSE
     C                     MOVE '0'       *IN54
     C                     END
0728 C                     ENDSR
     C********************************************************************
     C*SPACE*3*************                                               S01194
0721 C********************************************************************
     C*********************                                               S01194
0722 C*****SR.*TO*CHAIN*TO*CLIENT*FILE.**                                 S01194
0723 C***********CLCHN*****BEGSR                           *** CLCHN  *** S01194
0724 C*********************                                               S01194
0725 C*********************SETOF                     10                   S01194
0726 C***********CLKEY*****CHAINCLINT                40                   S01194
0727 C*********************                                               S01194
0728 C*********************ENDSR                                          S01194
     C********************************************************************
     C*SPACE*3*************                                               S01194
0721 C********************************************************************
0729 C*********************                                               S01194
0730 C********************************************************************
0731 C****SR.*TO*CHAIN*TO*CURRENCY*TABLE.**                               S01194
0732 C***********XCYCHN****BEGSR                           *** XCYCHN *** S01194
0733 C***********XCYKEY****CHAINTABLE                40                   S01194
0736 C*********************                                               S01194
0737 C*********************ENDSR                                          S01194
     C********************************************************************
     C*SPACE*3*************                                               S01194
0738 C********************************************************************
     C********************                                                E231
0739 C*****SHNSR*SR**PROMPT*FOR*CUSTOMER/SHORTNAME*AND*VALIDATE           E231
     C********************                                                E231
     C*****CALLED FROM***CMDSR                                            E231
     C*****CALLS SR******RETSR                                            E231
     C*****CALLS PROG****DL2470*CUSTOMER*SHORTNAMES*ENQUIRY               E231
0418 C*****THIS*IS*A*STANDARD*LINK*ENQUIRY*SUBROUTINE*FOR*PROCESSING      E231
0418 C*****SHORTNAME ENQUIRY REQUESTS.                                    E231
0418 C********************                                                E231
0740 C***********SHNSR**** BEGSR                           *** SHNSR   ***E231
0391 C********************                                                E231
0392 C***ELSE*CALL*REQESTED PROGRAM                                       E231
0391 C********************                                                E231
0392 C********FIRST UPDATE DATA AREA                                      E231
0405 C********** *LOCK*****IN***DLSDS                                     E231
0402 C******************** MOVE '0'       RETND                           E231
0402 C******************** MOVEL*BLANKS   RQDTD                           E231
0405 C******************** OUT  DLSDS                                     E231
0391 C********************                                                E231
0392 C********CALL PROGRAM                                                E231
0405 C******************** OUT  LDA                                       E231
0406 C******************** CALL 'DL2470'                                  E231
0405 C********** *LOCK**** IN   LDA                                       E231
     C********************                                                E231
0405 C********** *LOCK**** IN   DLSDS                                     E231
0391 C********************                                                E231
0392 C********LOAD REQUEST DATA INTO CUSTOMER FIELDS                      E231
0405 C******************** MOVELRQDTD     CUST                            E231
0744 C********************                                                E231
     C******************** MOVE ' '       LIVD                            E231
     C******************** MOVE ' '       MATD                            E231
0745 C******************** ENDSR                                          E231
0412 C********************                                                E231
     C********************************************************************
     C/SPACE 3
0730 C********************************************************************
     C*
0739 C*    DTRQSS SR VALIDATE AND PROCESS DEALS DETAILS REQUEST
     C*
     C**   CALLED FROM   LOAD,
     C**   CALLS SR      EMCNSR,RETSR
     C**   CALLS PROG.   PGN2
0740 C           DTRQSS    BEGSR                           ** DTRQSS   ***
     C                     MOVE '1'       *IN43
0496 C**
0375 C**  CLEAR ERROR MESSAGE FIELD,
0376 C                     MOVE *BLANKS   MSG
0388 C**
0389 C**  CHECK THAT VALUE IS EQUAL TO 1
0387 C           LEOPSF    IFNE '1'
     C**
     C**  SET INDICATORS FOR REVERSE IMAGE AND SFLNXTCHG
     C                     MOVE '1'       *IN62
     C                     MOVE '1'       *IN63
0382 C                     MOVELERR,7     MSG
     C**
     C**  SAVE DEAL NUMBER
     C                     Z-ADDDLNO      SDLNO   60
0386 C                     ELSE
0391 C**
0392 C**      CALL REQESTED PROGRAM
0391 C**
0392 C**      FIRST UPDATE DATA AREA
0405 C           *LOCK     IN   DLSDS
0402 C**                   MOVE '0'       RETND                           S01119
0402 C***********          MOVEL*BLANKS   RQDTD                           S01311
     C                     MOVE *BLANKS   RQDTW  18                       S01311
     C                     MOVELRQDTW     RQDTD                           S01311
0402 C                     MOVELDLNO      RQDTD
      *                                                                   S01311
     C           FXMM      IFEQ *BLANKS                                   S01311
     C                     MOVE 'DL'      RQDTD                           S01311
     C                     END                                            S01311
      *                                                                   S01311
     C********IF MATURED RECORD MOVE VALUE INTO PARAMETER                 S01119
0402 C**                   MOVEL*BLANK    RETND                           S01119
     C**         *IN42     IFEQ '1'                                       S01119
     C**                   MOVE '1'       RETND                           S01119
     C**                   END                                            S01119
     C/COPY WNCPYSRC,DLH00202
0405 C                     OUT  DLSDS
0391 C**
0392 C**      CALL PROGRAM
0405 C                     OUT  LDA
0406 C                     CALL 'DL0170'
0405 C           *LOCK     IN   LDA
     C                     IN   DLSDS                                     S01311
0409 C**
      *                                                                   S01311
      *   Test for database error in lower programs                       S01311
      *                                                                   S01311
     C           RETND     IFEQ 'E'                                       S01311
     C************INU7     IFEQ '1'                                 S01119S01311
     C************INU8     OREQ '1'                                 S01119S01311
     C*********            MOVE 'DL0120  'DBPGM                     S01119S01157
     C                     MOVEL'DL0120  'DBPGM                     S01119S01157
     C                     MOVEL'PROGRAM 'ZDB14  14                       S01119
     C                     MOVE 'DL0170'  ZDB14                           S01119
     C                     MOVEL' DEAL '  ZDB12  12                       S01119
     C                     MOVE DLNO      ZDB12                           S01119
     C                     MOVELZDB14     DBKEY                           S01119
     C                     MOVE ZDB12     DBKEY                           S01119
     C                     RETRN                                          S01119
     C                     END                                            S01119
      *                                                                   S01311
      *   Test for CMD1 or CMD3 pressed in lower program                  S01311
      *                                                                   S01311
     C           RETND     IFEQ 'Q'                                       S01311
     C           RETND     OREQ 'S'                                       S01311
     C           FXMM      ANDNE*BLANKS
     C                     SETON                     LR                   S01311
     C                     RETRN                                          S01311
     C                     END                                            S01311
     C*
     C                     END
0426 C**  INVALID INPUT DISPLAY ERROR CODES
0428 C           MSG       COMP *BLANKS                  43
0429 C**                                                               ***
     C                     MOVE '0'       *IN42
0744 C*
0745 C                     ENDSR
0846 C**
     C********************************************************************
     C/SPACE 3
0738 C********************************************************************
     C*
0739 C*    PRINTD SR  TO PRINT THE  DEAL DETAILS FOR THIS CUSTOMER
     C*
     C**   CALLED FROM   LOAD
     C**   CALLS PROG    DLCXXX
0418 C*
0740 C           PRINTD    BEGSR                           *** PRINTD  ***
     C**
     C**   INITIALIZE PARAMETER FIELDS
     C                     MOVE 'N'       OPTLIV
     C                     MOVE 'N'       OPTMAT
     C*********************MOVE CNUM      CUSNO   6                       S01136
     C*
     C           *IN28     IFEQ '1'
     C           *IN29     ANDEQ'1'
     C                     MOVE 'Y'       OPTLIV  1
     C                     MOVE 'Y'       OPTMAT  1
     C                     GOTO CALLP
     C                     END
     C*
     C           *IN28     IFEQ '1'
     C                     MOVE 'Y'       OPTLIV  1
     C                     ELSE
     C                     MOVE 'Y'       OPTMAT  1
     C                     END
     C*
0740 C           CALLP     TAG                             ***  CALLP  ***
     C*                                                                   DT0204
     C                     MOVEL'DL2480'  @RNAM                           DT0204
     C                     MOVEL'DLC2480' @COTT                           DT0204
     C*                                                                   DT0204
     C           *IN10     IFEQ '1'                                       E28392
     C                     MOVEL'B'       @LVL    1                       E28392
     C                     MOVELSBRCA     @ETTY   3                       E28392
     C                     ELSE                                           E28392
     C                     MOVEL'S'       @LVL                            E28392
     C                     MOVEL*BLANKS   @ETTY                           E28392
     C                     END                                            E28392
     C*                                                                   E28392
     C                     OUT  LDA                                       E5
      *                                                                   E5
     C***********          CALL 'DLC2485'                               E5DT0204
     C***********          PARM           CUSKEY                        E5DT0204
     C***********          PARM           OPTLIV                        E5DT0204
     C***********          PARM           OPTMAT                        E5DT0204
     C                     CALL 'FC0040X'                                 DT0204
     C                     PARM *BLANKS   @RTCD                           DT0204
     C                     PARM           @RNAM  10                       DT0204
     C                     PARM           @COTT  10                       DT0204
     C                     PARM '10001'   @CSEQ   5                       DT0204
     C                     PARM           @PARM                           DT0204
     C                     PARM @MBIN     @MBRC   1                       DT0204
     C***********          PARM 'B'       @LVL    1                 DT0204E28392
     C***********          PARM SBRCA     @ETTY   3                 DT0204E28392
     C                     PARM           @LVL                            E28392
     C                     PARM           @ETTY                           E28392
      *                                                                   E5
     C           *LOCK     IN   LDA                                       E5
      *                                                                   E5
     C************         CALL 'DLC2480'                                 E5
     C************                                                        S01136
     C** IF LAST DEAL READ IS A NAB,  REPORT PRINTED FOR WRONG CUSTOMER   S01136
     C** AS DEALSDD IS KEYED ON ISSUER                                    S01136
     C*********************PARM           CUSNO                           S01136
     C********             PARM           CUSKEY                          S01136
     C********             PARM           OPTLIV                          E5
     C********             PARM           OPTMAT                          E5
     C*
     C                     ENDSR
     C********************************************************************
     C/SPACE 3
0746 C********************************************************************
0846 C**
0846 C**
     C*  RTEDIT SR SUBROUTINE TO EDIT A RATE FIELD FOR OUTPUT
     C*
     C*  CALLED BY: LINE02
     C*
     C*  THIS SUBROUTINE CONTERTS AN 11,7 RATE FIELD INTO A 12 ALPHAMERIC
     C*  FIELD WITH LEADING AND TRAILING ZEROS DELETED. IF THE RATE IS
     C*  LESS THAN 1 THEN A ZERO IS PLACED BEFORE THE DECIMAL POINT.
     C*
     C*
     C*  INPUT FIELDS:
     C*                    ZRATE  11 7    AMOUNT FIELD TO BE EDITED
     C*
     C*  OUTPUT FIELDS:
     C*                    ZRATEA 12 A    EDITED AMOUNT FIELD
     C*
     C*  INDICATOR USED:
     C*                    *IN94          SETON IF NON-ZERO CHARACTER
     C*                                   FOUND IN THE AMOUNT
     C*
     C           RTEDIT    BEGSR                           ***  RTEDIT ***
     C*
     C                     Z-ADDZRATE     ZRATE  117       I/P FIELD
     C                     MOVE *BLANK    ZRATEA 12        O/P FIELD
     C                     MOVE '0'       *IN94
     C*
     C                     MOVEA*BLANKS   OUT
     C                     Z-ADD1         J       20
     C*
     C*  CLEAR LEADING ZEROS
     C           J         DOWLE4
     C           *IN94     IFEQ '0'
     C           RAT,J     IFEQ 0
     C                     MOVE ' '       OUT,J
     C                     ELSE
     C                     MOVE RAT,J     OUT,J
     C                     SETON                     94
     C                     END
     C                     ELSE
     C                     MOVE RAT,J     OUT,J
     C                     END
     C                     ADD  1         J
     C                     END
     C*
     C*  MOVE IN DECIMAL POINT
     C           J         IFEQ 5
     C           *IN94     IFEQ '0'
     C                     MOVE '0'       OUT,4
     C                     END
     C*********            MOVE '.'       OUT,J                           073516
     C                     MOVE BNDCSP    OUT,J                           073516
     C                     END
     C*
     C*  POSITION DECIMALS,ADD TRAILING ZEROS
     C                     MOVE '0'       *IN94
     C                     Z-ADD11        J
     C                     Z-ADD12        K       20
     C           J         DOWGE5
     C           *IN94     IFEQ '0'
     C           RAT,J     IFEQ 0
     C                     MOVE '0'       OUT,K
     C                     ELSE
     C                     MOVE RAT,J     OUT,K
     C                     SETON                     94
     C                     END
     C                     ELSE
     C                     MOVE RAT,J     OUT,K
     C                     END
     C                     SUB  1         J
     C                     SUB  1         K
     C                     END
     C*                                                                   208051
     C*  Add leading '-' sign if rate is negative.                        208051
     C           ZRATE     IFLT 0                                         208051
     C*                                                                   208051
     C                     MOVE '0'       *IN94                           208051
     C                     Z-ADD3         L       20                      208051
     C*                                                                   208051
     C           L         DOWGE1                                         208051
     C           *IN94     ANDEQ'0'                                       208051
     C           OUT,L     IFEQ ' '                                       208051
     C                     MOVE '-'       OUT,L                           208051
     C                     SETON                     94                   208051
     C                     END                                            208051
     C                     SUB  1         L                               208051
     C                     END                                            208051
     C*                                                                   208051
     C                     END                                            208051
     C*
     C*  FINALLY MOVE  EDITED FIELD INTO O/P FIELD
     C                     MOVEAOUT       ZRATEA
     C*
     C****
     C                     ENDSR
0846 C**
0846 C**
     C********************************************************************
     C/SPACE 3
0746 C********************************************************************
0846 C**
     C*
     C*  ZEDIT SR. SUBROUTINE TO EDIT AN AMOUNT FIELD FOR OUTPUT
     C*
     C*  CALLED BY: BASFMT, ENQFMT
     C*
     C*  INPUT FIELDS:
     C*                    ZAMNT  15 0    AMOUNT FIELD TO BE EDITED
     C*                    ZCDP    1,0    NO. OF DECIMAL PLACES
     C*                    ZCOMMA  1 A    COMMAS WANTED ('Y' OR 'N')
     C*                    ZMINUS  1 A    MINUS SIGN WANTED ('Y' OR 'N')
     C*
     C*  OUTPUT FIELDS:
     C*                    ZAMNTA 21 A    EDITED AMOUNT FIELD
     C*
     C*  INDICATOR USED:
     C*                    *IN94          SETON IF NON-ZERO CHARACTER
     C*                                   FOUND IN THE AMOUNT
     C*
     C           ZEDIT     BEGSR                           ***  ZEDIT  ***
     C*
     C                     Z-ADDZAMNT     ZAMNT  150       I/P FIELD
     C                     MOVE ZCOMMA    ZCOMMA  1        VALUE Y OR N
     C                     MOVE ZMINUS    ZMINUS  1        VALUE Y OR N
     C                     Z-ADDZCDP      ZCDP    10       NO. OF DPs.
     C                     MOVE *BLANK    ZAMNTA 21        O/P FIELD
     C                     MOVE '0'       *IN94
     C*
     C                     MOVE *BLANK    ZAMNTB 16        NON-COMMA EDIT
     C                     MOVE *BLANK    ZAMNTC 20        NON-COMMA EDIT
     C                     MOVE *BLANK    ZAMNTD 17        NON-COMMA EDIT
     C                     MOVE *BLANK    ZFLD3  16        NON-COMMA EDIT
     C                     MOVE '00000000'ZFLD1  15
     C                     MOVEL'0000000' ZFLD1
     C                     MOVE *BLANK    ZFLD2  20
     C                     MOVE ' '       ZMINS   1        MINUS CHARCTER
     C                     MOVEA*BLANK    ZEDT
     C                     MOVEA*BLANK    ZED2
     C                     MOVEA*BLANK    ZAMT
     C                     MOVEA*BLANK    Z3
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C*  PROCESS AMOUNT AS A POSTIVE NUMBER EVEN IF NEGATIVE
     C           ZMINUS    IFEQ 'Y'                        **** B1
     C           ZAMNT     IFLT 0                          **** B2
     C                     MOVE '-'       ZMINS
     C                     Z-SUBZAMNT     ZAMNT
     C                     ELSE                            **** X2
     C                     MOVE ' '       ZMINS
     C                     END                             **** E2
     C                     ELSE                            **** X2
     C           ZAMNT     IFLT 0                          **** B2
     C                     Z-SUBZAMNT     ZAMNT
     C                     END                             **** E2
     C                     END                             **** E1
     C*
     C*  SEPARATE INTEGER AND DECIMAL PARTS OF AMOUNT
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B1
     C                     MOVE ZAMNT     ZFLD1
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B2
     C                     MOVE ZAMNT     ZDEC1   1
     C                     MOVELZAMNT     ZAMT1  14
     C                     MOVE ZAMT1     ZFLD1
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B3
     C                     MOVE ZAMNT     ZDEC2   2
     C                     MOVELZAMNT     ZAMT2  13
     C                     MOVE ZAMT2     ZFLD1
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B4
     C                     MOVE ZAMNT     ZDEC3   3
     C                     MOVELZAMNT     ZAMT3  12
     C                     MOVE ZAMT3     ZFLD1
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B5
     C                     MOVE ZAMNT     ZDEC8   8
     C                     MOVELZAMNT     ZAMT8   7
     C                     MOVE ZAMT8     ZFLD1
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C                     END                             **** E1
     C*
     C*  MOVE THE INTEGER FIELD INTO A 5X3 ARRAY FOR EDITING
     C                     MOVEAZFLD1     ZAMT
     C*
     C/SPACE 3
     C*
     C****
     C*
     C*  CHECK IF COMMAS ARE NEEDED OR NOT
     C*
     C****
     C           ZCOMMA    IFEQ 'Y'                        **** E1
     C****
     C*
     C*  IF ZCOMMA  IS 'Y' MOVE COMMAS ETC. INTO A 5X4 EDITED ARRAY
     C*  (FOR ZERO DECIMAL PLACES DO NOT WANT A DECIMAL POINT)
     C*
     C           ZCDP      IFEQ 0                          **** B2
     C           BNDCSP    IFEQ '.'                                                           245692
     C                     MOVEAZCOM,1    ZEDT
     C                     ELSE                                                               245692
     C                     MOVEAZCOM,5    ZEDT                                                245692
     C                     ENDIF                                                              245692
     C                     ELSE
     C           BNDCSP    IFEQ '.'                                                           245692
     C                     MOVEAZCOM,2    ZEDT
     C                     ELSE                                                               245692
     C                     MOVEAZCOM,6    ZEDT                                                245692
     C                     ENDIF                                                              245692
     C                     END                             **** E2
     C*
     C*
     C*  READ THROUGH AMOUNT ARRAY SO AS TO PLACE EDITED DIGITS
     C*  INTO ZEDT. THE ARRAY IS READ 3 CHARACTERS AT A TIME.
     C*  ALL LEADING ZEROES ARE SUPPRESSED.
     C                     DO   5         Z       10       **** B2
     C*
     C           *IN94     IFEQ '1'                        **** B3
     C                     MOVELZAMT,Z    ZEDT,Z
     C                     ELSE
     C*
     C*  BLANK OUT EDITED FIELD IF ZEROES ARE FOUND
     C           ZAMT,Z    IFEQ '000'                      **** B4
     C           Z         IFNE 5                          **** B5
     C                     MOVE '    '    ZEDT,Z
     C                     END                             **** E5
     C                     ELSE
     C*
     C*  WHEN FIRST NON ZERO CHARACTERS ARE REACHED REMOVE LEADING
     C*  ZEROES. READ ARRAY ELEMENT 1 CHARACTER AT A TIME.
     C                     MOVE '1'       *IN94
     C                     Z-ADD1         ZN      10
     C                     MOVEAZAMT,Z    Z3
     C           Z3,ZN     DOWEQ'0'                        **** B5
     C                     MOVE ' '       Z3,ZN
     C                     ADD  1         ZN
     C                     END                             **** E5
     C                     MOVEAZ3        ZEDT,Z
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  PLACE EDITED ARRAY INTO ALPHA FIELD TO INCLUDE DECIMALS.
     C                     MOVEAZEDT      ZFLD2
     C*
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVELZFLD2     ZAMT0  19
     C                     MOVE ZAMT0     ZAMNTC
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B3
     C                     MOVE ZFLD2     ZAMT1A 19
     C                     MOVELZAMT1A    ZAMNTC
     C                     MOVE ZDEC1     ZAMNTC
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B4
     C                     MOVE ZFLD2     ZAMT2A 18
     C                     MOVELZAMT2A    ZAMNTC
     C                     MOVE ZDEC2     ZAMNTC
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B5
     C                     MOVE ZFLD2     ZAMT3A 17
     C                     MOVELZAMT3A    ZAMNTC
     C                     MOVE ZDEC3     ZAMNTC
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B6
     C                     MOVE ZFLD2     ZAMT8A 12
     C                     MOVELZAMT8A    ZAMNTC
     C                     MOVE ZDEC8     ZAMNTC
     C                     END                             **** E6
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C           ZMINUS    IFEQ 'Y'                        **** B2
     C                     MOVELZAMNTC    ZAMNTA
     C                     MOVE ZMINS     ZAMNTA
     C                     ELSE                            **** X2
     C                     MOVE ZAMNTC    ZAMNTA
     C                     END                             **** E2
     C*
     C****                                                 ****
     C*
     C                     ELSE                            **** X1
     C*
     C****                                                 ****
     C*
     C*  ELSE IF ZCOMMA EQUAL 'N':
     C*  MOVE FORMAT LEFT INTO A 6X3 ARRAY - 6TH ELEMENT CONTAINS D.P.
     C*  (FOR ZERO DECIMAL PLACES DO NOT WANT A DECIMAL POINT)
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVEAZCOM,3    ZED2
     C                     ELSE
     C           BNDCSP    IFEQ '.'                                                           245692
     C                     MOVEAZCOM,4    ZED2
     C                     ELSE                                                               245692
     C                     MOVEAZCOM,7    ZEDT                                                245692
     C                     ENDIF                                                              245692
     C                     END                             **** E2
     C*
     C*
     C*  READ THROUGH AMOUNT ARRAY SO AS TO PLACE EDITED DIGITS
     C*  INTO ZED2. THE ARRAY IS READ 3 CHARACTERS AT A TIME.
     C*  ALL LEADING ZEROES ARE SUPPRESSED.
     C                     DO   5         Z       10       **** B2
     C*
     C           *IN94     IFEQ '1'                        **** B3
     C                     MOVELZAMT,Z    ZED2,Z
     C                     ELSE
     C*
     C*  SEARCH FOR FIRST NONE-ZERO CHARACTERS
     C           ZAMT,Z    IFNE '000'                      **** B4
     C*
     C*  WHEN FIRST NON ZERO CHARACTERS ARE REACHED REMOVE LEADING
     C*  ZEROES. READ ARRAY ELEMENT 1 CHARACTER AT A TIME.
     C                     MOVE '1'       *IN94
     C                     Z-ADD1         ZN      10
     C                     MOVEAZAMT,Z    Z3
     C           Z3,ZN     DOWEQ'0'                        **** B5
     C                     MOVE ' '       Z3,ZN
     C                     ADD  1         ZN
     C                     END                             **** E5
     C                     MOVEAZ3        ZED2,Z
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  PLACE EDITED ARRAY INTO ALPHA FIELD TO INCLUDE DECIMALS.
     C                     MOVEAZED2      ZFLD3
     C*
     C*  - ZERO DECIMAL PLACES
     C           ZCDP      IFEQ 0                          **** B2
     C                     MOVELZFLD3     ZAMT0B 15
     C                     MOVE ZAMT0B    ZAMNTB
     C                     ELSE
     C*
     C*  - ONE DECIMAL PLACE
     C           ZCDP      IFEQ 1                          **** B3
     C                     MOVE ZFLD3     ZAMT1B 15
     C                     MOVELZAMT1B    ZAMNTB
     C                     MOVE ZDEC1     ZAMNTB
     C                     ELSE
     C*
     C*  - TWO DECIMAL PLACES
     C           ZCDP      IFEQ 2                          **** B4
     C                     MOVE ZFLD3     ZAMT2B 14
     C                     MOVELZAMT2B    ZAMNTB
     C                     MOVE ZDEC2     ZAMNTB
     C                     ELSE
     C*
     C*  - THREE DECIMAL PLACES
     C           ZCDP      IFEQ 3                          **** B5
     C                     MOVE ZFLD3     ZAMT3B 13
     C                     MOVELZAMT3B    ZAMNTB
     C                     MOVE ZDEC3     ZAMNTB
     C                     ELSE
     C*
     C*  - EIGHT DECIMAL PLACES
     C           ZCDP      IFEQ 8                          **** B6
     C                     MOVE ZFLD3     ZAMT8B  8
     C                     MOVELZAMT8B    ZAMNTB
     C                     MOVE ZDEC8     ZAMNTB
     C                     END                             **** E6
     C                     END                             **** E5
     C                     END                             **** E4
     C                     END                             **** E3
     C                     END                             **** E2
     C*
     C*  INCLUDE MINUS SIGN IF NEEDED
     C           ZMINUS    IFEQ 'Y'                        **** B2
     C                     MOVELZAMNTB    ZAMNTD
     C                     MOVE ZMINS     ZAMNTD
     C                     ELSE                            **** X2
     C                     MOVE ZAMNTB    ZAMNTD
     C                     END                             **** E2
     C*
     C*  FINALLY MOVE NON-COMMA EDITED FIELD INTO O/P FIELD
     C                     MOVE ZAMNTD    ZAMNTA
     C*
     C****
     C                     END                             **** E1
     C****
     C                     ENDSR
     C*
0847 C**
     C********************************************************************
     C/SPACE 3
0848 C********************************************************************
0849 C**
0850 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0851 C**
0852 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0853 C**
0854 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0855 C**
0856 C**   CLEAR DATE FIELDS.
0857 C                     Z-ADD0         ZDATE   60
0858 C                     MOVEL'       ' ZADATE  7
0859 C**
0860 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0861 C                     Z-ADDZDAYNO    ZDAYNO  50
0862 C**
0863 C**   DETERMINE YEAR NUMBER.
0864 C**
0865 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0866 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0867 C   99                GOTO ZDEND2
0868 C**
0869 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0870 C           ZDAYN1    DIV  1461      ZLYR    20
0871 C                     MVR            ZDAYN1           SAVE REMAINING
0872 C**                                                   DAYS
0873 C**   CALCULATE NUMBER OF REMAINING YEARS.
0874 C                     Z-ADD1         ZWRK2   20
0875 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0876 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0877 C  N90      ZWRK2     ADD  1         ZWRK2
0878 C  N90                GOTO ZDTAG1
0879 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0880 C**
0881 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0882 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0883 C**
0884 C**   CALCULATE ACTUAL YEAR NUMBER.
0885 C           ZLYR      MULT 4         ZWRK3   30
0886 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0887 C                     Z-ADDZWRK3     ZYEAR   20
0888 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0889 C**
0890 C**   DETERMINE MONTH NUMBER.
0891 C**
0892 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0893 C                     SETOF                     9293
0894 C   91      ZDAYN1    COMP 59                     9293
0895 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0896 C**
0897 C**   CALCULATE MONTH NUMBER.
0898 C                     Z-ADD2         ZWRK2
0899 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0900 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0901 C  N94      ZWRK2     ADD  1         ZWRK2
0902 C  N94                GOTO ZDTAG2
0903 C           ZWRK2     SUB  1         ZWRK2
0904 C**
0905 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0906 C**
0907 C**   DETERMINE DAY OF MONTH.
0908 C**
0909 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0910 C           ZDAYN1    ADD  1         ZDAYN1
0911 C**
0912 C**   CALCULATE DAY OF MONTH.
0913 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0914 C**
0915 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0916 C   93      ZDAY      ADD  1         ZDAY
0917 C**
0918 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0919 C  N98                MOVELZDAY      ZWRK4   40
0920 C   98                MOVE ZDAY      ZWRK4
0921 C  N98                MOVE ZMTH      ZWRK4
0922 C   98                MOVELZMTH      ZWRK4
0923 C                     MOVELZWRK4     ZDATE
0924 C                     MOVE ZYEAR     ZDATE
0925 C**
0926 C**   FORMAT ALPHA DATE, DDMMMYY.
0927 C           ZDAY      COMP 10                     95
0928 C                     MOVELZDAY      ZWRK5   5
0929 C   95                MOVEL' '       ZWRK5
0930 C                     MOVE ZMNM,ZMTH ZWRK5
0931 C                     MOVELZWRK5     ZADATE
0932 C                     MOVE ZYEAR     ZADATE
0933 C**
0934 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0935 C**
0936 C**
     C********************************************************************
     C/SPACE 3
0937 C********************************************************************
0747 C*********************                                               S01194
0748 C*****ZALIGN*SR.*TO*VALIDATE*AND*RIGHT-ALIGN*NUMERIC*FIELDS.**       S01194
0749 C*********************                                               S01194
     C***********ZALIGN****BEGSR                           *** ZALIGN *** S01194
     C*********************                                               S01194
     C*********************SETOF                     929399               S01194
     C*********************                                               S01194
     C*****SAVE*INPUT*FIELD*IN*ARRAY,*ZA1.**                              S01194
     C*********************MOVEAZFIELD    ZA1                             S01194
     C*********************                                               S01194
     C*****CALCULATION*TO*DEFINE*NUMBER*STRUCTURE*CONTROL*FIELDS.**       S01194
     C*********************Z-ADDZADIG     ZADIG   20                      S01194
     C*********************Z-ADDZADEC     ZADEC   10                      S01194
     C*********************                                               S01194
     C*****CALCULATIONS*TO*DEFINE/CLEAR*FIELDS.**                         S01194
     C*********************MOVE ' '       ZA2                             S01194
     C*********************MOVEAZA2       ZFIELD 16                       S01194
     C*********************Z-ADD0         ZX      20                      S01194
     C*********************Z-ADD0         ZY      20                      S01194
     C*********************                                               S01194
     C*****ENSURE*REQUIRED*STRUCTURE*OF*FIELD*IS*VALID.**                 S01194
     C***********ZADIG*****ADD  ZADEC     ZZ      20                      S01194
     C***********ZZ********COMP 15                   99                   S01194
     C***99****************GOTO ZAEND                                     S01194
     C*********************                                               S01194
     C*****LOOP*TO*FIND*DECIMAL*POINT,*BLANKS*AND*CHARACTERS.**           S01194
     C***********ZATAG1****TAG                             ** ZATAG1 TAG *S01194
     C***********ZX********ADD  1         ZX                              S01194
     C*********************                                               S01194
     C*****CHECK*FOR*DECIMAL*POINT.*ERROR*IF*SECOND*DECIMAL*POINT.**      S01194
     C***********ZA1,ZX****COMP '.'                      90               S01194
     C***90*93*************SETON                     99                   S01194
     C***99****************GOTO ZAEND                                     S01194
     C*********************                                               S01194
     C*********************                                               S01194
     C*****CHECK*FOR*'M'*CONSTANT.*ERROR*IF*NOT*LAST*CHARACTER*ENTERED**  S01194
     C***********ZA1,ZX****COMP 'M'                      96               S01194
     C***96****************DO                                             S01194
     C***********ZX********ADD  1         ZX                              S01194
     C***********ZA1,ZX****COMP ' '                  9999                 S01194
     C***99****************GOTO ZAEND                                     S01194
     C***********ZX********SUB  1         ZX                              S01194
     C***********ZX********COMP 9                    99                   S01194
     C***99****************GOTO ZAEND                                     S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*****CHECK*FOR*'T'*CONSTANT.*ERROR*IF*NOT*LAST*CHARACTER*ENTERED**  S01194
     C***********ZA1,ZX****COMP 'T'                      97               S01194
     C***97****************DO                                             S01194
     C***********ZX********ADD  1         ZX                              S01194
     C***********ZA1,ZX****COMP ' '                  9999                 S01194
     C***99****************GOTO ZAEND                                     S01194
     C***********ZX********SUB  1         ZX                              S01194
     C***********ZX********COMP 12                   99                   S01194
     C***99****************GOTO ZAEND                                     S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*****CLEAR*ALPHAMERIC*CONSTANT*FROM*ZA1**                           S01194
     C***96****************                                               S01194
     C*R*97****************MOVE ' '       ZA1,ZX                          S01194
     C*********************                                               S01194
     C*****CHECK*FOR*BLANKS.*BYPASS*FOR*FIRST*BLANK*AFTER*A*DIGIT.**      S01194
     C***********ZA1,ZX****COMP ' '                      91               S01194
     C***91*92*************GOTO ZATAG2                                    S01194
     C*********************                                               S01194
     C*****CHECK*FOR*NUMERIC,*IF*NOT*'.'*OR*' '.**                        S01194
     C**N90N91***ZA1,ZX****COMP '0'                    99                 S01194
     C**N90N91N99ZA1,ZX****COMP '9'                  99                   S01194
     C***99****************GOTO ZAEND                      NOT NUMERIC    S01194
     C*********************                                               S01194
     C*****STORE*DIGITS*IN*ARRAY*AND*HOW*MANY.**                          S01194
     C*****ZY,*TOTAL*OF*DIGITS*IN*THE*INPUT*FIELD.**                      S01194
     C*****ZZ,*TOTAL*OF*DIGITS*TO*THE*LEFT*OF*DECIMAL*POINT.**            S01194
     C**N90N91***ZY********ADD  1         ZY         92                   S01194
     C**N90N91*************MOVE ZA1,ZX    ZA2,ZY                          S01194
     C***90****************Z-ADDZY        ZZ         93  93               S01194
     C*********************                                               S01194
     C***********ZX********COMP 16                     94  CHECK IF ALL   S01194
     C***94****************GOTO ZATAG1                                    S01194
     C*********************                                               S01194
     C***********ZATAG2****TAG                             ** ZATAG2 TAG *S01194
     C*********************                                               S01194
     C*****IF*'M'*SPECIFIED,*MULTIPLY*ZA1*BY*1*MILLION**                  S01194
     C***96******ZZ********ADD  6         ZZ                              S01194
     C*********************                                               S01194
     C*****IF*'T'*SPECIFIED,*MULTIPLY*ZA1*BY*1*THOUSAND**                 S01194
     C***97******ZZ********ADD  3         ZZ                              S01194
     C*********************                                               S01194
     C*****FILL*IN*ZEROS*IN*ANY*BLANKS*LEFT*OF*DECIMAL*POINT**            S01194
     C***96*93*************                                               S01194
     C*R*97*93***ZZ********DOWGTZY                                        S01194
     C***********ZY********ADD  1         ZY                              S01194
     C*********************MOVE '0'       ZA2,ZY                          S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*****IF*CONSTANT*SPECIFIED*WITH*NO*DECIMAL*POINT*ZEROISE*BLANKS**   S01194
     C***96N93*************DO   6                                         S01194
     C***********ZY********ADD  1         ZY                              S01194
     C*********************MOVE '0'       ZA2,ZY                          S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C***97N93*************DO   3                                         S01194
     C***********ZY********ADD  1         ZY                              S01194
     C*********************MOVE '0'       ZA2,ZY                          S01194
     C*********************END                                            S01194
     C*********************                                               S01194
     C*****IF*NO*DECIMAL*POINT*FOUND,*SET*TOTAL*FIELD*ZZ.**               S01194
     C**N93****************Z-ADDZY        ZZ                              S01194
     C*********************                                               S01194
     C*****CHECK*FOR*EMBEDDED*BLANKS.**                                   S01194
     C***91*92*************MOVEAZA1,ZX    ZFIELD                          S01194
     C***91*92***ZFIELD****COMP ' '                  9999                 S01194
     C***99****************GOTO ZAEND                      EMBEDDED BLANK S01194
     C*********************                                               S01194
     C*****ENSURE*THAT*NUMBER*OF*DIGITS*ENTERED*EITHER*SIDE**             S01194
     C*****OF*DECIMAL*POINT*ARE*NOT*MORE*THAN*ALLOWED.**                  S01194
     C***********ZZ********COMP ZADIG                99                   S01194
     C***********ZY********SUB  ZZ        ZX                              S01194
     C**N99******ZADEC*****SUB  ZX        ZX           9995               S01194
     C***99****************GOTO ZAEND                                     S01194
     C***95****************GOTO ZATAG4                     NO TRAILING    S01194
     C*********************                                BLANKS.        S01194
     C*****FILL*THE*TRAILING*BLANKS*WITH*ZEROS.**                         S01194
     C***********ZY********ADD  ZX        ZZ                              S01194
     C***********ZATAG3****TAG                             ** ZATAG3 TAG *S01194
     C***********ZY********ADD  1         ZY                              S01194
     C*********************MOVE '0'       ZA2,ZY                          S01194
     C***********ZY********COMP ZZ                     94                 S01194
     C***94****************GOTO ZATAG3                                    S01194
     C*********************                                               S01194
     C*****RIGHT-ALIGN*THE*VALUE*BY*MOVING*BACK*TO*ARRAY,*ZA1.**          S01194
     C***********ZATAG4****TAG                             ** ZATAG4 TAG *S01194
     C*********************MOVE '0'       ZA1                             S01194
     C*********************Z-ADD16        ZX                              S01194
     C***********ZATAG5****TAG                             ** ZATAG5 TAG *S01194
     C***********ZY********COMP 0                        94               S01194
     C***94****************GOTO ZATAG6                                    S01194
     C*********************MOVE ZA2,ZY    ZA1,ZX                          S01194
     C***********ZY********SUB  1         ZY                              S01194
     C***********ZX********SUB  1         ZX                              S01194
     C*********************GOTO ZATAG5                                    S01194
     C***********ZATAG6****TAG                             ** ZATAG6 TAG *S01194
     C*********************                                               S01194
     C*****MOVE*VALIDATED*AND*RIGHT-ALIGNED*NUMBER*BACK*INTO*ZFIELD.**    S01194
     C*********************MOVEAZA1       ZFIELD                          S01194
     C*********************                                               S01194
     C*********************SETOF                     9697                 S01194
     C*********************                                               S01194
     C***********ZAEND*****ENDSR                           * ZAEND ENDSR *S01194
     C*********************                                               S01194
     C*********************                                               S01194
     C********************************************************************S01194
     C*SPACE*3*************                                               S01194
0848 C********************************************************************S01194
0938 C*********************                                               S01194
0939 C*****ZSYSTM*SR.*TO*CHAIN*TO*THE*INSTALLATION*CONTROL*DATA*RECORD.** S01194
0940 C*********************                                               S01194
0941 C***********ZSYSTM****BEGSR                           *** ZSYSTM *** S01194
0942 C*********************                                               S01194
0943 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.**                  S01194
0944 C*********************MOVEL'01      'ZTABKY 12                       S01194
0945 C*********************MOVE '  10'    ZTABKY                          S01194
0946 C*********************                                               S01194
0947 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0948 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0949 C*********************                                               S01194
0950 C*****CHECK*SYSTEM*DATE*FORMAT,*DDMMYY*OR*MMDDYY.**                  S01194
0951 C***********DATF******COMP 'M'                      98MMDDYY, 98 ON  S01194
0952 C*********************                                               S01194
0953 C*********************ENDSR                                          S01194
0954 C*********************                                               S01194
0955 C*********************                                               S01194
     C********************************************************************S01194
     C*SPACE*3*************                                               S01194
0956 C********************************************************************S01194
0957 C*********************                                               S01194
0958 C*****TABCHN*SR.*TO*CHAIN*TO*INSTALLATION*CONTROL*DATA*RECORD*5*     S01194
0959 C*********************                                               S01194
0960 C***********TABCHN****BEGSR                           *** TABCHN *** S01194
0961 C*********************                                               S01194
0962 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.**                  S01194
0963 C*********************MOVEL'01      'ZTABKY 12                       S01194
0964 C*********************MOVE '  40'    ZTABKY                          S01194
0965 C*********************                                               S01194
0966 C***********ZTABKY****CHAINTABLE                99    ON NOT THERE   S01194
0967 C**N99******RECI******COMP 'D'                  9999  ON, IS DELETED S01194
0968 C*********************                                               S01194
0969 C*********************ENDSR                                          S01194
0970 C********************************************************************
     C/EJECT                                                              S01117
0970 C********************************************************************S01117
     C**  P/ZSPFB STD SR TO MAKE SPF USER/BRANCHES AVAILABLE TO PGM       S01117
     C**    INPUT FROM EXT.DTAARA- ZBR1 & 2,UP TO 100 BRANCHES,TOP DOWN   S01117
     C**                           ZIN,INDEX OF LOWEST ENTRY FOR ARRAY    S01117
     C**    OUTPUT - ZBR  ARRAY, TOP DOWN                                 S01117
     C**             U, EQ ZIN                                            S01117
     C**                                                            S01117LN0467
     C********** ZSPFB     BEGSR                           **  ZSPFBS01117LN0467
     C********** *NAMVAR   DEFN           ZBRU                      S01117LN0467
     C**********           IN   ZBRU                                S01117LN0467
     C**********           MOVEAZBR1      ZBR,1                     S01117LN0467
     C**********           MOVEAZBR2      ZBR,51                    S01117LN0467
     C**********           MOVE ZIN       U       30                S01117LN0467
     C**********           ENDSR                                    S01117LN0467
     C**                                                            S01117LN0467
     C**************************************************************S01117LN0467
     C** ZBRR SR - RELATED BRANCH MUST BE VALID FOR USER-BOOK/A/C BRS01117LN0467
     C**  INPUT - ZBRCDX - BRANCH CODE                              S01117LN0467
     C**  KNOWN - ZBR - ARRAY OF UP TO 100 BRS, TOPDOWN             S01117LN0467
     C**          U - LOWEST ENTRY IN ARRAY                         S01117LN0467
     C**  OUTPUT -99,IF NO BRS IN ARRAY, OR THIS BR NOT IN ARRAY    S01117LN0467
     C**                                                            S01117LN0467
     C********** ZBRR      BEGSR                           ** ZBRR *S01117LN0467
     C**********           SETOF                     9099           S01117LN0467
     C**********           Z-ADDU         V       30     99ON IF ZERS01117LN0467
     C**                                                                  S01117
     C********** *IN99     IFNE '1'                                 S01117LN0467
     C********** ZBRCDX    LOKUPZBR,V                    90         S01117LN0467
     C********** *IN90     IFNE '1'                                 S01117LN0467
     C**********           SETON                     99             S01117LN0467
     C**********           END                                      S01117LN0467
     C**********           END                                      S01117LN0467
     C**                                                            S01117LN0467
     C*                                                                   LN0467
     C**********           ENDSR                                    S01117LN0467
     C**************************************************************S01117LN0467
     C/EJECT
     C***************************************************************     S01136
     C*                                                                   S01136
     C* #A        -  DRS INITIAL PROCESSING                               S01136
     C*                                                                   S01136
     C* CALLS       -                                                     S01136
     C*                                                                   S01136
     C* CALLED BY   - MAIN PROGRAM                                        S01136
     C*                                                                   S01136
     C* FLDS USED   -                                                     S01136
     C*                                                                   S01136
     C***************************************************************     S01136
     C           #A        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP PROGRAM NAME                                              S01136
     C                     MOVEL'DL0120'  DBPGM                           S01136
     C*                                                                   S01136
     C** RETRIEVE THE EXTERNAL DATAAREA MMOD                              E14702
     C           *NAMVAR   DEFN MMOD      MMODS                           E14702
     C                     IN   MMODS                                     E14702
     C*                                                                   E14702
     C***********MODFD*****IFEQ*'Y'************************B1*******E14702S01319
     C*********************OPEN*FDPMNTLL********************1*******E14702S01319
     C                     OPEN FDMNTHLL                   *1             S01319
     C*********************OPEN*FDINSTLL********************1*******E14702S01319
     C*********************OPEN FDCCYDLL                   *1       E14702S01194
     C*********************OPEN FXTB40LL                   *1       E14702S01194
     C*********************                                         S01136S01194
     C*                                                                   S01136
     C***ACCESS*DRS*INSTALLATION*CONTROL*DATA***********************S01136S01319
     C***********1*********SETLLFDINSTLL********************1*******S01136S01319
     C*********************READ*FDINSTLL*****************61*1*******S01136S01319
     C**************************************************************S01136S01319
     C***IF*RECORD*NOT*FOUND*DATABASE*ERROR*************************S01136S01319
     C************IN61*****IFEQ*'1'************************B*2******S01136S01319
     C***********IDDLTF****OREQ*'*'**************************2******S01136S01319
     C**********           CALL 'AODEALR0'                                S01319              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01319
     C                     PARM '*FIRST ' @OPTN   7                       S01319
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01319              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*********************MOVE*'001'*****DBASE*********************S01136S01319
     C*********************MOVEL'FDINSTLL'DBFILE********************S01136S01319
     C*********************MOVE**BLANKS***DBKEY**************DBERRORS01136S01319
     C*********************MOVE*'1'********INU7*********************S01136S01319
     C*********************MOVE*'1'********INU8*********************S01136S01319
     C*********************GOTO*#A9**************************2******S01136S01319
     C*********************END*****************************E*2******S01136S01319
     C*                                                                   S01136
     C** ACCESS MONTH NAME FILE                                           S01136
     C***********1*********SETLLFDPMNTLL********************1*******S01136S01319
     C*********************READ*FDPMNTLL*****************61*1*******S01136S01319
     C           1         SETLLFDMNTHLL                   *1             S01319
     C                     READ FDMNTHLL                 61*1             S01319
     C*                                                                   S01136
     C** IF RECORD NOT FOUND DATABASE ERROR                               S01136
     C           *IN61     IFEQ '1'                        B*2            S01136
     C***********IDDLTF****OREQ '*'                        **2      S01136S01194
     C                     MOVE '002'     DBASE            ***************S01136
     C*********************MOVEL'FDPMNTLL'DBFILE********************S01136S01319
     C                     MOVEL'FDMNTHLL'DBFILE           *             *S01319
     C                     MOVE *BLANKS   DBKEY            * DBERROR 002 *S01136
     C                     MOVE '1'       *INU7            *             *S01136
     C                     MOVE '1'       *INU8            ***************S01136
     C                     EXSR *PSSR                      **2            S01194
     C                     GOTO #A9                        **2            S01136
     C                     END                             E*2            S01136
      *                                                                   CGL011
      ** Access Switchable Features file and check if CGL011              CGL011
      ** is switched on or not.                                           CGL011
      *                                                                   CGL011
     C                     CALL 'AOSARDR0'                                CGL011
     C                     PARM *BLANKS   PRTCD   7                       CGL011
     C                     PARM '*VERIFY' POTPN   7                       CGL011
     C                     PARM 'CGL011'  PSARD   6                       CGL011
     C           SCSARD    PARM SCSARD    DSFDY                           CGL011
      *                                                                   CGL011
     C           PRTCD     IFEQ *BLANKS                                   CGL011
     C                     MOVE 'Y'       CGL011  1                       CGL011
     C                     ELSE                                           CGL011
     C                     MOVE 'N'       CGL011                          CGL011
      *                                                                   CGL011
      ** Database Error, if Return Code is not blanks or *NRF             CGL011
      *                                                                   CGL011
     C           PRTCD     IFNE '*NRF   '                                 CGL011
     C                     MOVEL'006'     DBASE            ***************CGL011
     C                     MOVEL'SCSARDPD'DBFILE           * DB ERROR 006*CGL011
     C                     MOVEL'CGL011  'DBKEY            ***************CGL011
     C                     EXSR *PSSR                                     CGL011
     C                     ENDIF                                          CGL011
     C                     ENDIF                                          CGL011
      *                                                                   CGL011
      ** Access Switchable Features file and check if CSD007              CSD007
      ** is switched on or not.                                           CSD007
      *                                                                   CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   @RTCD   7                       CSD007
     C                     PARM '*VERIFY' @OPTN   7                       CSD007
     C                     PARM 'CSD007'  @SARD   6                       CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           @RTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007  1                       CSD007
     C                     ELSE                                           CSD007
     C                     MOVE 'N'       CSD007                          CSD007
      *                                                                   CSD007
      ** Database Error, if Return Code is not blanks or *NRF             CSD007
      *                                                                   CSD007
     C           @RTCD     IFNE '*NRF   '                                 CSD007
     C                     MOVEL'SCSARDPD'DBFILE                          CSD007
     C                     MOVEL'007'     DBASE                           CSD007
     C                     MOVEL'CSD007  'DBKEY                           CSD007
     C                     MOVE *ON       *INU7                           CSD007
     C                     MOVE *ON       *INU8                           CSD007
     C                     MOVE *ON       *INLR                           CSD007
     C                     EXSR *PSSR                                     CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
     C*                                                                   S01136
     C***ACCESS*TABLE*FILE**                                        S01136S01194
     C************LOVAL****SETLLFXTB40LL                   B1       S01136S01194
     C*********************READ FXTB40LL                 61*1       S01136S01194
     C*********************                                         S01136S01194
     C***IF*RECORD*NOT*FOUND*DATABASE*ERROR**                       S01136S01194
     C************IN61*****IFEQ '1'                        B*2      S01136S01194
     C*********************MOVE '003'     DBASE            *********S01136S01194
     C*********************MOVEL'FXTB40LL'DBFILE           *        S01136S01194
     C*********************MOVE *BLANKS   DBKEY            * DBERRORS01136S01194
     C*********************MOVE '1'       *INU7            *        S01136S01194
     C*********************MOVE '1'       *INU8            *********S01136S01194
     C*********************GOTO #A9                        **2      S01136S01194
     C*********************END                             E*2      S01136S01194
     C*                                                                   S01136
     C*********************END*****************************E1*******E14702S01319
     C*                                                                   S01136
     C***RETRIEVE THE EXTERNAL DATAAREA MMOD                       S01136 E14702
     C********** *NAMVAR   DEFN MMOD      MMODS                    S01136 E14702
     C**********           IN   MMODS                              S01136 E14702
     C**********                                                   S01136 E20251
     C***OPEN*APPROPRIATE DEALS FILE DEPENDING ON MMOD             S01136 E20251
     C********** MODS      IFEQ 'YN'                       B1      S01136 E20251
     C**********           OPEN FXCUSDLL                   *1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'NY'                       B1      S01136 E20251
     C**********           OPEN MMCUSDLL                   *1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'YY'                       B1      S01136 E20251
     C**********           OPEN CACUSDLL                   *1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C***OPEN*MIDAS DEALS                                          S01136 E20251
     C********** MODS      IFEQ 'NN'                       B1      S01136 E20251
     C**********           OPEN CUSDL                      *1      S01136 E20251
     C**********           END                             E1      S01136 E20251
     C**********                                                   S01136 E20251
     C**********           OPEN FDCCYDLL                           S01136 E14702
     C*                                                                   E20251
     C*********************OPEN CACUSDLL                   *1       E20251BHF486
      *                                                                   S01311
      *   Only open CACUSDL1 if the program is NOT called as an           S01311
      *   Exposure Management linked enquiry                              S01311
      *   ELSE                                                            S01311
      *   Open the relevant Exposure Management file                      S01311
      *                                                                   S01311
     C           *IN80     IFEQ '0'                                       S01311
     C/COPY WNCPYSRC,DLH00203
     C                     OPEN CACUSDL1                   *1             BHF486
     C/COPY WNCPYSRC,DLH00204
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C                     OPEN EMCUSFXL                                  S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01332
     C                     OPEN EMCUSMML                                  S01311
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'FR'                                      S01332
     C                     OPEN EMCUSFRL                                  S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C                     OPEN EMCUSIRL                                  S01332
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C*                                                                   S01136
     C/COPY WNCPYSRC,DLH00205
     C           #A9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* #BBA        -  FILE ACCESS ROUTINE                            *   S01136
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -  LOAD                                           *   S01136
     C*                                                               *   S01136
     C* FLDS USED      @CRKY  - CUSTOMER KEY FOR FILE READ            *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #BBA      BEGSR                                          S01136
     C*                                                                   S01136
     C** INITIALISE RECORD ID AND FIELD INDICATORS                        S01136
     C                     MOVE '0'       *IN04                           S01136
     C                     MOVE '0'       *IN05                           S01136
     C                     MOVE '0'       *IN06                           S01136
     C                     MOVE '0'       *IN07                           S01136
     C                     MOVE '0'       *IN23                           S01136
     C                     MOVE '0'       *IN24                           S01136
     C                     MOVE '0'       *IN25                           S01136
     C                     MOVE '0'       *IN26                           S01136
     C/COPY WNCPYSRC,DL0120C022
     C*                                                                   S01136
     C** INITIALISE DTYP AS IT IS USED TO CALCULATE THE NUMBER OF LINES   S01136
     C** THAT EACH DEAL TYPE TAKES ON THE SCREEN. THIS VALUE MAY BE       S01136
     C** WRONG IF DTYP IS NOT RESET.                                      S01136
     C                     MOVE '  '      DTYP                            S01136
     C*                                                                   S01136
     C** SET UP CUSTOMER NUMBER READE KEY                                 S01136
     C           @CRKY     KLIST                                          S01136
     C                     KFLD           CNUM                            S01136
     C                     KFLD           SBRCAX                          LN0467
     C*                                                                   S01136
     C* ACCESS THE FILE DEPENDING UPON MMOD DATA AREA                     S01136
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'NN'                               S01136 E20251
     C**********                                                   S01136 E20251
     C********** *IN71     IFEQ '0'                                S01136 E20251
     C********** CNUM      READECUSDL                    41        S01136 E20251
     C**********           ELSE                                    S01136 E20251
     C**********           READPCUSDL                    41        S01136 E20251
     C**********           END                                     S01136 E20251
     C**********                                                   S01136 E20251
     C**********           END                                     S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'YN'                               S01136 E20251
     C**********                                                   S01136 E20251
     C********** *IN71     IFEQ '0'                                S01136 E20251
     C********** @CRKY     READEFXCUSDLL                 41        S01136 E20251
     C**********           MOVE RECGMT    @INDS   8                S01136 E20251
     C**********           ELSE                                    S01136 E20251
     C**********           READPFXCUSDLL                 41        S01136 E20251
     C**********           END                                     S01136 E20251
     C**********                                                   S01136 E20251
     C**********           END                                     S01136 E20251
     C**********                                                   S01136 E20251
     C********** MODS      IFEQ 'NY'                               S01136 E20251
     C**********                                                   S01136 E20251
     C********** *IN71     IFEQ '0'                                S01136 E20251
     C********** @CRKY     READEMMCUSDLL                 41        S01136 E20251
     C**********           MOVE RECHMT    @INDS                    S01136 E20251
     C**********           ELSE                                    S01136 E20251
     C**********           READPMMCUSDLL                 41        S01136 E20251
     C**********           END                                     S01136 E20251
     C**********                                                   S01136 E20251
     C**********           END                                     S01136 E20251
     C*                                                                   S01136
     C********** MODS      IFEQ 'YY'                                      E20251
     C*                                                                   S01136
     C           *IN71     IFEQ '0'                                       S01136
     C********** CNUM      READECUSDL                    41        S01136 E20251
     C***********@CRKY     READECACUSDLL                 41         S01136LN0467
     C           SBRCAX    IFEQ 'ALL'                                     LN0467
     C           @MBIN     OREQ 'N'                        B2             LN0467
      *                                                                   S01311
      *  If it is an Exposure Management Enquiry, read either the         S01311
      *  FX or the MM file                                                S01311
      *                                                                   S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C           CNUM      READEEMCUSFXL                 41               S01311
     C                     MOVE RECJMT    @INDS                           S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C           CNUM      READEEMCUSMML                 41               S01311
      *                                                                   CDL006
      ** Test if transaction is fiduciary or not                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN41     ANDEQ'0'                                       CDL006
      *                                                                   CDL006
     C                     MOVE 'Y'       WWFID   1                       CDL006
      *                                                                   CDL006
     C           HKTYPE    IFEQ 'FL'                                      CDL006
     C           HKTYPE    OREQ 'DP'                                      CDL006
     C           HKTYPE    OREQ 'LP'                                      CDL006
     C           HKTYPE    OREQ 'FT'                                      CDL006
     C           HKTYPE    OREQ 'DT'                                      CDL006
     C           HKTYPE    OREQ 'LT'                                      CDL006
      *                                                                   CDL006
     C           *IN41     DOWEQ'0'                                       CDL006
     C           WWFID     ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
      ** If the deal type is Fiduciary                                    CDL006
      *                                                                   CDL006
     C           CNUM      READEEMCUSMML                 41               CDL006
      *                                                                   CDL006
     C           HKTYPE    IFNE 'FL'                                      CDL006
     C           HKTYPE    ANDNE'DP'                                      CDL006
     C           HKTYPE    ANDNE'LP'                                      CDL006
     C           HKTYPE    ANDNE'FT'                                      CDL006
     C           HKTYPE    ANDNE'DT'                                      CDL006
     C           HKTYPE    ANDNE'LT'                                      CDL006
     C                     MOVE 'N'       WWFID                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDDO                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0120C002
     C                     MOVE RECKMT    @INDS                           S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'FR'                                      S01332
     C           CNUM      READEEMCUSFRL                 41               S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C           CNUM      READEEMCUSIRL                 41               S01332
     C                     ELSE                                           S01332
     C/COPY WNCPYSRC,DLH00206
     C           CNUM      READECACUSDL1                 41               LN0467
     C                     MOVE RECIMT    @INDS                           S01311
     C/COPY WNCPYSRC,DLH00207
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C                     ELSE                                           LN0467
      *                                                                   S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C           @CRKY     READEEMCUSFXL                 41               S01311
     C                     MOVE RECJMT    @INDS                           S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C           @CRKY     READEEMCUSMML                 41               S01311
      *                                                                   CDL006
      ** Test if transaction is fiduciary or not                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN41     ANDEQ'0'                                       CDL006
      *                                                                   CDL006
     C                     MOVE 'Y'       WWFID                           CDL006
      *                                                                   CDL006
     C           HKTYPE    IFEQ 'FL'                                      CDL006
     C           HKTYPE    OREQ 'DP'                                      CDL006
     C           HKTYPE    OREQ 'LP'                                      CDL006
     C           HKTYPE    OREQ 'FT'                                      CDL006
     C           HKTYPE    OREQ 'DT'                                      CDL006
     C           HKTYPE    OREQ 'LT'                                      CDL006
      *                                                                   CDL006
     C           *IN41     DOWEQ'0'                                       CDL006
     C           WWFID     ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
      ** If the deal is Fiduciary                                         CDL006
      *                                                                   CDL006
     C           @CRKY     READEEMCUSMML                 41               CDL006
      *                                                                   CDL006
     C           HKTYPE    IFNE 'FL'                                      CDL006
     C           HKTYPE    ANDNE'DP'                                      CDL006
     C           HKTYPE    ANDNE'LP'                                      CDL006
     C           HKTYPE    ANDNE'FT'                                      CDL006
     C           HKTYPE    ANDNE'DT'                                      CDL006
     C           HKTYPE    ANDNE'LT'                                      CDL006
     C                     MOVE 'N'       WWFID                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDDO                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0120C003
     C                     MOVE RECKMT    @INDS                           S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'FR'                                      S01332
     C           @CRKY     READEEMCUSFRL                 41               S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C           @CRKY     READEEMCUSIRL                 41               S01332
     C                     ELSE                                           S01332
     C/COPY WNCPYSRC,DLH00208
     C           @CRKY     READECACUSDL1                 41               LN0467
     C                     MOVE RECIMT    @INDS   8                       S01311
     C/COPY WNCPYSRC,DLH00209
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C                     END                                            LN0467
     C**********           MOVE RECIMT    @INDS                    S01136 E20251
     C**********           MOVE RECIMT    @INDS   8                E20251 S01311
     C                     ELSE                                           S01136
     C*********************READPCUSDL                    41        S01136 E20251
     C*********************READPCACUSDLL                 41         E20251BHF486
      *                                                                   S01311
      ***If*it*is*an*Exposure*Management*Enquiry,*read*either*the*  S01311S01332
      ***FX*or*the*MM*file*                                         S01311S01332
      *  If it is an Exposure Management Enquiry, read either the         S01332
      *  FX, MM, FRA or IRS File                                          S01332
      *                                                                   S01311
     C           FXMM      IFEQ 'FX'                                      S01311
     C                     READPEMCUSFXL                 41               S01311
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'MM'                                      S01311
     C                     READPEMCUSMML                 41               S01311
      *                                                                   CDL006
      ** Test if transaction is fiduciary or not                          CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN41     ANDEQ'0'                                       CDL006
      *                                                                   CDL006
     C                     MOVE 'Y'       WWFID                           CDL006
      *                                                                   CDL006
     C           HKTYPE    IFEQ 'FL'                                      CDL006
     C           HKTYPE    OREQ 'DP'                                      CDL006
     C           HKTYPE    OREQ 'LP'                                      CDL006
     C           HKTYPE    OREQ 'FT'                                      CDL006
     C           HKTYPE    OREQ 'DT'                                      CDL006
     C           HKTYPE    OREQ 'LT'                                      CDL006
      *                                                                   CDL006
     C           *IN41     DOWEQ'0'                                       CDL006
     C           WWFID     ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
      ** If the deal is Fiduciary                                         CDL006
      *                                                                   CDL006
     C                     READPEMCUSMML                 41               CDL006
      *                                                                   CDL006
     C           HKTYPE    IFNE 'FL'                                      CDL006
     C           HKTYPE    ANDNE'DP'                                      CDL006
     C           HKTYPE    ANDNE'LP'                                      CDL006
     C           HKTYPE    ANDNE'FT'                                      CDL006
     C           HKTYPE    ANDNE'DT'                                      CDL006
     C           HKTYPE    ANDNE'LT'                                      CDL006
     C                     MOVE 'N'       WWFID                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDDO                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,DL0120C004
     C                     ELSE                                           S01311
     C           FXMM      IFEQ 'FR'                                      S01332
     C                     READPEMCUSFRL                 41               S01332
     C                     ELSE                                           S01332
     C           FXMM      IFEQ 'IR'                                      S01332
     C           FXMM      OREQ 'CC'                                      S01332
     C                     READPEMCUSIRL                 41               S01332
     C                     ELSE                                           S01332
     C/COPY WNCPYSRC,DLH00210
     C                     READPCACUSDL1                 41               BHF486
     C/COPY WNCPYSRC,DLH00211
     C                     END                                            S01332
     C                     END                                            S01332
     C                     END                                            S01311
     C                     END                                            S01311
     C                     END                                            S01136
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0120CCP5                                           S01408
     C*                                                                   S01408
     C*                                                                   S01136
     C**********           END                                     S01136 E20251
     C*                                                                   S01136
     C           #BBA9     ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#B**********-**FORMAT*FXDEALP0*OR*FXDEALP1*FOR*LINE01******S01136 E20251
     C* #B          -  FORMAT FXDEALP0 FOR LINE01                     *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #B        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C*******************  MOVE *BLANKS   DTYPW   5                S01136 S01157
     C                     MOVE *BLANKS   DTYPW                           S01157
     C                     MOVELFHTYPE    DTYPW                           S01136
     C                     MOVE *BLANKS   STWK    3                       S01136
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE FHSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE FHCLAS    CLASW                                               CDL038
     C                     MOVE ' '       BYSLW                                               CDL038
     C*                                                                   S01136
     C                     MOVE FHDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT REMAINING F-X FIELDS.                                     S01136
     C*                                                                   S01136
     C** FORMAT DEAL VALUE AND DEAL DONE DATE.                            S01136
     C                     EXSR #K                                        S01136
     C*                                                                   S01136
     C** OBTAIN BUY/SELL CURRENCY AND AMOUNT.                             S01136
     C                     EXSR ZA0670                                    S01136
     C*                                                                   S01136
     C** ACCESS CURRENCY TABLE                                            S01136
     C*********************MOVE @@DBCC    SSCCY   3                 S01136S01194
     C*********************EXSR ZA0300                              S01136S01194
     C                     MOVE @@DBCC    XXCCY   3                       S01194
     C                     EXSR #L                                        S01194
     C*                                                                   S01136
     C           *INU7     CABEQ'1'       #B9                             S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C** FORMAT THE PURCHASE AMOUNT                                       S01136
     C                     MOVE @@DBCC    @@CCY                           S01136
     C*********************Z-ADDCDP       @@CDP                     S01136S01194
     C                     Z-ADDA6NBDP    @@CDP                           S01194
     C                     Z-ADD@@DBAM    @@IAMT                          S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET UP FIELD FOR THE DISPLAY.                                    S01136
     C                     MOVE @@DBCC    CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           FHFEDF    IFEQ 'Y'                        B1             S01136
     C***********CCY*******IFEQ USCY                       B*2      S01136S01194
     C           CCY       IFEQ BLUSCY                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C                     MOVEL'PURCHASE'NARR1                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELFHDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #B9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#C**********-**FORMAT*MMDELDP0*OR MMDELDP1 FOR LINE01      S01136 E20251
     C* #C          -  FORMAT MMDELDP0 FOR LINE01         *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #C        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C******************   MOVE *BLANKS   DTYPW   5                S01136 S01157
     C                     MOVE *BLANKS   DTYPW                           S01157
     C******************** MOVELHKTYPE    DTYPW                    S01136 E22567
     C                     MOVELHKMTYP    DTYPW                           E22567
     C                     MOVE *BLANKS   STWK    3                       S01136
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HKSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HKCLAS    CLASW                                               CDL038
     C                     MOVE ' '       BYSLW                                               CDL038
     C                     MOVE HKDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT THE DATES                                                 S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HKCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HKFEDF    IFEQ 'Y'                        B1             S01136
     C***********CCY*******IFEQ USCY                       B*2      S01136S01194
     C           CCY       IFEQ BLUSCY                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE LDI AMOUNT AND EDIT.                                        S01136
     C                     Z-ADDHKAMNP    @@IAMT 150                      S01136
     C                     MOVE HKCCY     @@CCY   3                       S01136
     C                     Z-ADD16        @@CRET  20                      S01136
     C                     Z-ADDHKCYDP    @@CDP   10                      S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELHKDADN    RDNO                            S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C           #C9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#D**********-**FORMAT*MMDENBP0*OR*MMDENBP1 FOR LINE01      S01136 E20251
     C* #D          -  FORMAT MMDENBP0 FOR LINE01         *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #D        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C*******************  MOVE *BLANKS   DTYPW   5                S01136 S01157
     C                     MOVE *BLANKS   DTYPW                           S01157
     C******************** MOVELHLTYPE    DTYPW                    S01136 E22567
     C                     MOVELHLMTYP    DTYPW                           E22567
     C                     MOVE *BLANKS   STWK    3                       S01136
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HLSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HLCLAS    CLASW                                               CDL038
     C                     MOVE ' '       BYSLW                                               CDL038
     C                     MOVE HLDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT ASSOCIATED DATES                                          S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HLCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HLFEDF    IFEQ 'Y'                        B1             S01136
     C***********CCY*******IFEQ USCY                       B*2      S01136S01194
     C           CCY       IFEQ BLUSCY                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE NAB AMOUNT AND EDIT.                                        S01136
     C                     MOVE HLAMNP    @@IAMT 150                      S01136
     C                     MOVE HLCCY     @@CCY   3                       S01136
     C                     Z-ADD16        @@CRET  20                      S01136
     C                     MOVE HLCYDP    @@CDP   10                      S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELHLDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #D9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#E**********-**FORMAT*MMDENSP0*OR MMDENSP1 FOR LINE01      S01136 E20251
     C* #E          -  FORMAT MMDENSP0 FOR LINE01         *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -  LINE01                                         *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #E        BEGSR                                          S01136
     C*                                                                   S01136
     C**   DEAL TYPE TEXT                                                 S01136
     C*******************  MOVE *BLANKS   DTYPW   5                S01136 S01157
     C                     MOVE *BLANKS   DTYPW                           S01157
     C*********************MOVELHMTYPE    DTYPW                    S01136 E22567
     C                     MOVELHMMTYP    DTYPW                           E22567
     C                     MOVE *BLANKS   STWK    3                       S01136
     C                     MOVEL'-'       STWK                            S01136
     C                     MOVE HMSTYP    STWK                            S01136
     C                     MOVE STWK      DTYPW                           S01136
     C                     MOVE HMCLAS    CLASW                                               CDL038
     C                     MOVE ' '       BYSLW                                               CDL038
     C                     MOVE HMDN38    DLNO                            S01136
     C*                                                                   S01136
     C** FORMAT ASSOCIATED DATES                                          S01136
     C                     EXSR #K                                        S01136
     C                     MOVEL@MDT      NARR1                           S01136
     C                     MOVE HMCCY     CCY                             S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           HMFEDF    IFEQ 'Y'                        B1             S01136
     C***********CCY*******IFEQ USCY                       B*2      S01136S01194
     C           CCY       IFEQ BLUSCY                     B*2            S01194
     C                     MOVE 'F'       FFIN             **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** TAKE NAS AMOUNT AND EDIT.                                        S01136
     C                     Z-ADDHMAMNP    @@IAMT                          S01136
     C                     MOVE HMCCY     @@CCY                           S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     Z-ADDHMCYDP    @@CDP                           S01136
     C                     EXSR ZA0750                                    S01136
     C                     MOVE @@ADSP    AMT1W                           S01136
     C*                                                                   S01136
     C** SET ASSOCIATED DEAL NUMBER                                       S01136
     C                     MOVELHMDADN    RDNO                            S01136
     C*                                                                   S01136
     C           #E9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#F**********-**FORMAT*FXDEALP0*OR*FXDEALP1**FOR*LINE02*****S01136 E20251
     C* #F          -  FORMAT FXDEALP0 FOR LINE02                     *   E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #F        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C                     EXSR #J                                        S01136
      *                                                                                       CDL099
      ** If CDL099 exists and deal type is not FX option then format                          CDL099
      ** sell date.                                                                           CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           FHTYPE    IFNE 'OP'                                                          CDL099
     C           FHTYPE    ANDNE'OT'                                                          CDL099
     C           USDAT     ANDNE0                                                             CDL099
     C                     Z-ADDUSDAT     @@DTIN                                              CDL099
     C                     EXSR ZA0660                                                        CDL099
     C                     MOVEA@@DATE    LIN,18                                              CDL099
     C                     ENDIF                                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                                       CDL099
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0120CCP3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01136
     C** CHECK DEAL TYPE FOR F-X.IS IT AN OPTION...?                      S01136
     C           FHTYPE    IFEQ 'OP'                       B1             S01136
     C                     MOVEATXT,1     LIN,7            *1             S01136
     C*                                                                   S01136
     C** FORMAT OPTION TO DATE                                            S01136
     C                     Z-ADD@ODAT     @@DTIN           *1             S01136
     C                     EXSR ZA0660                     *1             S01136
     C                     MOVEA@@DATE    LIN,18           *1             S01136
     C*                                                                   S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** SET UP FIELD FOR THE DISPLAY.                                    S01136
     C                     MOVEATXT,2     LIN,30                          S01136
     C                     MOVEA@@DSCC    LIN,35                          S01136
     C*                                                                   S01136
     C** IF FEDERAL FUNDS INDICATOR ON AND CURRENCY EQUAL US CURRENCY     S01136
     C           FHFEDF    IFEQ 'Y'                        B1             S01136
     C***********@@DSCC****IFEQ USCY                       B*2      S01136S01194
     C           @@DSCC    IFEQ BLUSCY                     B*2            S01194
     C                     MOVEA'F'       LIN,41           **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C** ACCESS CURRENCY TABLE                                            S01136
     C*********************MOVE @@DSCC    SSCCY   3                 S01136S01194
     C*********************EXSR ZA0300                              S01136S01194
     C                     MOVE @@DSCC    XXCCY   3                       S01194
     C                     EXSR #L                                        S01194
     C*                                                                   S01136
     C           *INU7     CABEQ'1'       #F9                             S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C** FORMAT THE PURCHASE AMOUNT                                       S01136
     C                     MOVE @@DSCC    @@CCY                           S01136
     C*********************Z-ADDCDP       @@CDP                     S01136S01194
     C                     Z-ADDA6NBDP    @@CDP                           S01194
     C                     Z-ADD@@DSAM    @@IAMT                          S01136
     C                     Z-ADD16        @@CRET                          S01136
     C                     EXSR ZA0750                                    S01136
     C*                                                                   S01136
     C** @@ADSP  21A FIELD IS MOVED IN TO  SLAMWF 16A FIELD               S01136
     C** AS SALE AMOUNT DOESN'T ALIGN WITH PURCHASE AMOUNT                S01136
0725 C                     MOVE @@ADSP    SLAMWF                          S01119
     C                     MOVEASLAMWF    LIN,42                          S01136
     C*                                                                   S01136
     C           #F9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#G**********-**FORMAT*MMDELDP0 OR MMDELDP1 FOR LINE02      S01136 E20251
     C* #G          -  FORMAT MMDELDP0 FOR LINE02         *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #G        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT FOR LOANS/DEPOSIT/CD ISSUE?                               S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS
     C                     EXSR #J                                        S01136
     C/COPY WNCPYSRC,DL0120C012
     C*                                                                   S01136
     C** FORMAT BASE RATE FIELD                                           S01136
     C                     MOVEATXT,3     LIN,8                           S01136
     C*                                                                   S01136
     C** FORMAT THE INTEREST RATE/SPREAD                                  S01136
     C                     MOVEATXT,4     LIN,28                          S01136
     C           HKBSRC    IFEQ *BLANKS                    B1             S01136
     C********** HKBSRC    OREQ '00'                       *1                          E27537 CSD103
     C           HKBSRC    OREQ '00'                                                        MD057842
     C**********           MOVEA'00'      LIN,19           *1                        S01136 MD057842
     C                     MOVEA'  '      LIN,19                                            MD057842
     C                     MOVE HKIIRT    @@INPR           *1             S01136
     C                     EXSR MM1013                     *1             S01136
     C                     MOVEA@@OUTR    LIN,44           *1             S01136
     C*                                                                   S01136
     C                     ELSE                            X1             S01136
     C                     MOVEAHKBSRC    LIN,19           *1             S01136
     C                     MOVE HKSPRD    @@INPR           *1             S01136
     C                     EXSR MM1013                     *1             S01136
     C                     MOVEA@@OUTR    LIN,44           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           #G9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01378
     C*****************************************************************   S01378
     C*                                                               *   S01378
     C* PFMT        -  Format 5,0 field to a 5A field with            *   S01378
     C*                leading zeros suppressed                       *   S01378
     C* CALLS                                                         *   S01378
     C*                                                               *   S01378
     C* CALLED BY   -                                                 *   S01378
     C*                                                               *   S01378
     C* FLDS USED                                                     *   S01378
     C*                                                               *   S01378
     C*****************************************************************   S01378
     C           PFMT      BEGSR                                          S01378
      *                                                                   S01378
      ** reset work fields                                                S01378
     C                     MOVE *BLANKS   @OUT                            S01378
     C                     Z-ADD*ZERO     J                               S01378
      *                                                                   S01378
      ** transfer numeric input field to character array                  S01378
     C           *LIKE     DEFN PSZE      @INNUM                          S01378
     C                     MOVE @INNUM    @INCHR  5                       S01378
     C                     MOVEA@INCHR    @IN                             S01378
      *                                                                   S01378
      ** work through field looking for first non zero character          S01378
     C           J         DOUEQ5                          B1             S01378
     C                     ADD  1         J                *1             S01378
      *                                                                   S01378
      ** once first non zero character is found fill up @OUT and exit     S01378
     C           @IN,J     IFNE '0'                        B*2            S01378
     C                     MOVEA@IN,J     @OUT,J           **2            S01378
     C                     Z-ADD5         J                **2            S01378
     C                     END                             E*2            S01378
     C                     END                             E1             S01378
     C                     MOVEA@OUT      @OUTCR  5                       S01378
      *                                                                   S01378
     C                     ENDSR                                          S01378
     C*****************************************************************   S01378
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#H**********-**FORMAT*MMDENBP0*OR MMDENBP1 LINE 02         S01136 E20251
     C* #H          -  FORMAT MMDENBP0 LINE 02            *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -                                                 *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #H        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS          .                         S01136
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** FORMAT THE YIELD.                                                S01136
     C                     MOVEATXT,5     LIN,8                           S01136
     C           HLMTYP    IFEQ 'C1'                                      087231
     C           HLMTYP    OREQ 'C2'                                      087231
     C           HLMTYP    OREQ 'BP'                                      087231
     C           HLMTYP    OREQ 'BD'                                      087231
     C                     MOVE HLINTR    @@INPR                          S01136
     C                     ELSE                                           087231
     C                     MOVE HLDCRT    @@INPR                          087231
     C                     END                                            087231
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,13                          S01136
     C*                                                                   S01136
     C** FORMAT THE INTEREST RATE/SPREAD.                                 S01136
     C                     MOVEATXT,4     LIN,28                          S01136
     C/COPY WNCPYSRC,DL0120C023
     C                     MOVE HLFRAT    @@INPR                          S01136
     C/COPY WNCPYSRC,DL0120C024
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,44                          S01136
     C*                                                                   S01136
     C** If parcelled NA set up parcel fields                             S01378
     C           HLPCLI    IFEQ 'P'                                       S01378
     C                     MOVEATXT,12    LIN,58                          S01378
     C                     Z-ADDHLPSZE    @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     MOVEA@OUTCR    LIN,63                          S01378
     C                     END                                            S01378
     C*                                                                   S01378
     C           #H9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C**#I**********-**FORMAT*MMDENSP0*OR MMDENSP1                 S01136 E20251
     C* #I          -  FORMAT MMDENSP0                    *               E20251
     C*                                                               *   S01136
     C* CALLS                                                         *   S01136
     C*                                                               *   S01136
     C* CALLED BY   -  LINE01                                         *   S01136
     C*                                                               *   S01136
     C* FLDS USED                                                     *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #I        BEGSR                                          S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C                     EXSR #J                                        S01136
     C*                                                                   S01136
     C** FORMAT THE YIELD.                                                S01136
     C                     MOVEATXT,5     LIN,8                           S01136
     C                     MOVE HMINTR    @@INPR                          S01136
     C                     EXSR MM1013                                    S01136
     C                     MOVEA@@OUTR    LIN,13                          S01136
     C*                                                                   S01136
     C** If parcelled NA set up parcelling fields                         S01378
     C           HMPCLI    IFEQ 'P'                                       S01378
     C                     MOVEATXT,12    LIN,56                          S01378
     C                     Z-ADDHMPSZE    @INNUM                          S01378
     C                     EXSR PFMT                                      S01378
     C                     MOVEA@OUTCR    LIN,61                          S01378
     C                     END                                            S01378
     C*                                                                   S01378
     C           #I9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* #K          - FORMATING OF DEAL DONE AND VALUE DATE           *   S01136
     C*                                                               *   S01136
     C* CALLS       - ZA0660                                          *   S01136
     C*                                                               *   S01136
     C* CALLED BY   - #B                                              *   S01136
     C*             - #C                                              *   S01136
     C*             - #D                                              *   S01136
     C*             - #E                                              *   S01136
     C*                                                               *   S01136
     C* FLDS USED   @VDAT   - VALUE DATE                              *   S01136
     C*             @DDAT   - DEAL DONE DATE                          *   S01136
     C*             @MDAT   - MATURITY DATE                           *   S01136
     C*             @@DTIN  - INPUT DATE TO ZA0660                    *   S01136
     C*             @@DATE  - OUTPUT DATE FROM ZA0660                 *   S01136
     C*             DDATE   - DEAL DONE DATE                          *   S01136
     C*             VDATE   - VALUE DATE                              *   S01136
     C*             ODATE   - OPTION TO DATE                          *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #K        BEGSR                                          S01136
     C*                                                                   S01136
     C** FORMAT DEAL VALUE AND DEAL DONE DATE.                            S01136
     C                     MOVE @VDAT     @@DTIN                          S01136
     C                     EXSR ZA0660                                    S01136
     C                     MOVE @@DATE    VDATE                           S01136
     C/COPY WNCPYSRC,DLH00290
     C*                                                                   S01136
     C                     MOVE @DDAT     @@DTIN                          S01136
     C                     EXSR ZA0660                                    S01136
     C                     MOVE @@DATE    DDATE                           S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B1             S01136
     C           @INDS     OREQ 'MMDENBP0'                 X1             S01136
     C           @INDS     OREQ 'MMDELDP1'                                S01311
     C           @INDS     OREQ 'MMDENBP1'                                S01311
     C/COPY WNCPYSRC,DLH00285
     C********** @INDS     OREQ 'MMDELDP1'                 X1      S01136 E20251
     C********** @INDS     OREQ 'MMDENBP1'                 X1      S01136 E20251
     C*                                                                   S01136
     C           @MDAT     IFNE *ZEROS                     B*2            S01136
     C                     MOVE @MDAT     @@DTIN           **2            S01136
     C                     EXSR ZA0660                     **2            S01136
     C                     MOVE @@DATE    @MDT    7        **2            S01136
     C                     ELSE                            X*2            S01136
     C*                                                                   S01136
     C           @INDS     IFEQ 'MMDELDP0'                 B**3           S01136
     C           @INDS     OREQ 'MMDELDP1'                                S01311
     C/COPY WNCPYSRC,DLH00286
     C********** @INDS     OREQ 'MMDELDP1'                 X**3    S01136 E20251
     C*                                                                   S01136
     C           HKNTCE    IFEQ 000                        B***4          S01136
     C                     MOVE ' CALL  ' @MDT             ****4          S01136
     C                     ELSE                            X***4          S01136
     C                     MOVELHKNTCE    @MDT             ****4          S01136
     C                     MOVE 'DAYS'    @MDT             ****4          S01136
     C                     END                             E***4          S01136
     C*                                                                   S01136
     C                     ELSE                            X**3           S01136
     C*                                                                   S01136
     C                     MOVE ' CALL  ' @MDT             ***3           S01136
     C*                                                                   S01136
     C                     END                             E**3           S01136
     C*                                                                   S01136
     C                     END                             E*2            S01136
     C*                                                                   S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           #K9       ENDSR                                          S01136
     C****************************************************************    S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* #J          - SET UP DEAL STATUS                              *   S01136
     C*                                                               *   S01136
     C* CALLS       -                                                 *   S01136
     C*                                                               *   S01136
     C* CALLED BY   - #F                                              *   S01136
     C*             - #G                                              *   S01136
     C*             - #H                                              *   S01136
     C*             - #I                                              *   S01136
     C*                                                               *   S01136
     C* FLDS USED   TEXT    - DISPLAY FIELD                           *   S01136
     C*             @FEDF   - FEDERAL FUND WORK FIELD                 *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           #J        BEGSR                                          S01136
     C*                                                                   S01136
     C** CHECK IF DEAL HAS BEEN DELETED                                   S01136
     C           DLREC     IFEQ 'D'                        B1             S01136
     C           FHLCD     IFEQ BJRDNB                                    155954
     C           HKLCD     OREQ BJRDNB                                    155954
     C           HLLCD     OREQ BJRDNB                                    155954
     C           HMLCD     OREQ BJRDNB                                    155954
     C                     MOVE 'DELETED 'TEXT             *1             S01136
     C                     ELSE                                           155954
     C                     MOVE 'REVERSED'TEXT                            155954
     C                     END                                            155954
     C**********           MOVE HEX20     ZF2              *1                          S01136 259968
     C**********           MOVELHEX21     ZF1              *1                          S01136 259968
     C**********           MOVELHEX22     LIN,1            *1                          S01136 259968
     C                     MOVE '0'       *IN54            *1             S01136
     C                     ELSE                            X1             S01136
     C*                                                                   S01136
     C** SET UP DEAL STATUS INDICATORS                                    S01136
     C           RECIC     LOKUPTABA      TABB           56               S01136
     C           *IN56     IFEQ '1'                        B1             S01136
     C                     MOVE TABB      TEXT             *1             S01136
     C**********           MOVE HEX20     ZF2              **2                         S01136 259968
     C**********           MOVELHEX21     ZF1              **2                         S01136 259968
     C**********           MOVELHEX22     LIN,1            **2                         S01136 259968
     C                     MOVE '0'       *IN54            **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           #J9       ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C/COPY WNCPYSRC,DL0120C015
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C*       SUBROUTINE ZA0670 - THIS SUBROUTINE IS USED TO FIND     *   S01136
     C*       WHICH CCY AND WHICH AMOUNT IS BUY AND WHICH IS SELL.    *   S01136
     C*                                                               *   S01136
     C*       IF DEAL FIRST AMOUNT IS >0 THEN FIRST IS BUY            *   S01136
     C*       ELSE FIRST IS SELL.                                     *   S01136
     C*                                                               *   S01136
      *  (c) Finastra International Limited 2001                      *
     C*                                                               *   S01136
     C*       CALLED BY: #BBC FORMATING OF DRS DEALS  FOR OUTPUT      *   S01136
     C*                                                               *   S01136
     C*       CALLS:                                                  *   S01136
     C*       INPUT: FHDAM1 - DEAL FIRST AMOUNT                       *   S01136
     C*              FHDAM2 - DEAL SECOND AMOUNT                      *   S01136
     C*              FHCCY1 - DEAL FIRST CURRENCY                     *   S01136
     C*              FHCCY2 - DEAL SECOND CURRENCY                    *   S01136
     C*      OUTPUT: @@DBAM - DEAL BUY AMOUNT                         *   S01136
     C*              @@DSAM - DEAL SELL AMOUNT                        *   S01136
     C*              @@DBCC - DEAL BUY CURRENCY                       *   S01136
     C*              @@DSCC - DEAL SELL CURRENCY                      *   S01136
     C*        USES:                                                  *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C*                                                                   S01136
     C*                                                                   S01136
     C           ZA0670    BEGSR                                          S01136
     C           FHDAM1    IFGT 0                                         S01136
     C                     Z-ADDFHDAM1    @@DBAM 150                      S01136
     C                     MOVE FHCCY1    @@DBCC  3                       S01136
     C                     Z-SUBFHDAM2    @@DSAM 150                      S01136
     C                     MOVE FHCCY2    @@DSCC  3                       S01136
     C                     ELSE                                           S01136
     C                     Z-SUBFHDAM1    @@DSAM                          S01136
     C                     MOVE FHCCY1    @@DSCC                          S01136
     C                     Z-ADDFHDAM2    @@DBAM                          S01136
     C                     MOVE FHCCY2    @@DBCC                          S01136
     C                     END                                            S01136
     C*                                                                   S01136
     C           ZA0679    ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C****************************************************************    S01136
     C*                                                              *    S01136
     C*                                                              *    S01136
     C*     MIDAS/DRS - STANDING DATA MODULE                         *    S01136
     C*                                                              *    S01136
     C*     ZA0750 -  CONVERT AMOUNT TO DISPLAY -38                  *    S01136
     C*                                                              *    S01136
     C*     AMEND NO. 000001                  DATE   04/07/86        *    S01136
     C*                                                              *    S01136
     C*       CALLED BY: #BBC FORMATING OF DRS DEALS  FOR OUTPUT     *    S01136
     C*                                                              *    S01136
     C*       CALLS:                                                 *    S01136
     C*                                                              *    S01136
     C*       INPUT: @@IAMT 15,0 (INPUT AMOUNT)                      *    S01136
     C*              @@CCY  3A   (INPUT CURRENCY)                    *    S01136
     C*              @@CRET 2,0  (NUMBER OF CHARACTERS TO RETURN)    *    S01136
     C*              @@CDP  1,0  (CURRENCY DECIMAL PLACES)           *    S01136
     C*                                                              *    S01136
     C*      OUTPUT: @@ADSP 21A    (AMOUNT TO DISPLAY)               *    S01136
     C*                                                              *    S01136
     C*        USES:                                                 *    S01136
     C*                                                              *    S01136
     C****************************************************************    S01136
     C*                                                                   S01136
     C           ZA0750    BEGSR                                          S01136
     C*                                                                   S01136
     C*          INITIALISE ARRAYS                                        S01136
     C*                                                                   S01136
     C                     MOVEA*BLANKS   @E                              S01136
     C                     MOVEA*BLANKS   @C                              S01136
     C*****                                                        S01136 E20901
     C*****      MOVE SIGN TO DISPLAY AMOUNT                       S01136 E20901
     C*****                                                        S01136 E20901
     C*****      @@IAMT    IFGT 0                          B1      S01136 E20901
     C*****                MOVE '+'       @E,21            *1      S01136 E20901
     C*****                END                             E1      S01136 E20901
     C*****                                                        S01136 E20901
     C*****      AFTER '-' SIGN PLACED IN  @E CHANGE @@IAMT TO +VE S01136 E20901
     C*****                                                        S01136 E20901
     C*****      @@IAMT    IFLT 0                          B1      S01136 E20901
     C*****                MOVE '-'       @E,21            *1      S01136 E20901
     C*****                Z-SUB@@IAMT    @@IAMT           *1      S01136 E20901
     C*****                END                             E1      S01136 E20901
     C******                                                       S01136 E20901
     C*****      @@IAMT    IFEQ 0                          B1      S01136 E20901
     C*****                MOVE ' '       @E,21            *1      S01136 E20901
     C*****                END                             E1      S01136 E20901
     C*                                                                   E20901
     C*          AFTER '-' SIGN PLACED IN  @E CHANGE @@IAMT TO +VE        E20901
     C*                AND MOVE BLANK TO SIGN FIELD                       E20901
     C*                                                                   E20901
     C           @@IAMT    IFLT 0                          B1             E20901
     C                     Z-SUB@@IAMT    @@IAMT           *1             E20901
     C                     END                             E1             E20901
     C                     MOVE ' '       @E,21            *1             E20901
     C*                                                                   S01136
     C*          MOVE INPUT AMOUNT TO @D                                  S01136
     C*                                                                   S01136
     C                     MOVEA@@AMDS    @D                              S01136
     C*                                                                   S01136
     C*          MOVE DECIMAL PORTION OF AMOUNT TO @E                     S01136
     C*                                                                   S01136
     C                     Z-ADD15        @@C     20                      S01136
     C                     Z-ADD20        @@D     20                      S01136
     C*                                                                   S01136
     C           20        SUB  @@CDP     @@MAX   20                      S01136
     C           @@D       DOWGT@@MAX                      B1             S01136
     C                     MOVE @D,@@C    @E,@@D           *1             S01136
     C                     SUB  1         @@C              *1             S01136
     C                     SUB  1         @@D              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE DECIMAL SEPARATOR TO @E                             S01136
     C*                                                                   S01136
     C           @@CDP     IFNE 0                          B1             S01136
     C*********************MOVE*IDDCSP****@E,@@D************1*******S01136S01319
     C                     MOVE BNDCSP    @E,@@D           *1             S01319
     C                     SUB  1         @@D              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          FIND POSITION OF LAST CHARACTER TO BE MOVED              S01136
     C*                                                                   S01136
     C                     Z-ADD1         @@E     20                      S01136
     C*                                                                   S01136
     C           @@E       DOWLT15                         B1             S01136
     C           @D,@@E    ANDEQ'0'                        *1             S01136
     C                     ADD  1         @@E              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE INTEGER PORTION OF AMOUNT TO @E                     S01136
     C*                                                                   S01136
     C                     Z-ADD0         @@CNT1  20                      S01136
     C                     Z-ADD0         @@CNT2  20                      S01136
     C*                                                                   S01136
     C           @@C       DOWGT@@E                        B1             S01136
     C                     MOVE @D,@@C    @E,@@D           *1             S01136
     C                     ADD  1         @@CNT1           *1             S01136
     C                     SUB  1         @@C              *1             S01136
     C                     SUB  1         @@D              *1             S01136
     C*                                                                   S01136
     C*          INSERT THOUSAND SEPARATORS                               S01136
     C*                                                                   S01136
     C           @@CNT1    DIV  3         @@RES   20       *1             S01136
     C                     MVR            @@REMD  10       *1             S01136
     C           @@REMD    IFEQ 0                          B*2            S01136
     C           @@CNT2    ANDLT5                          **2            S01136
     C*********************MOVE*IDTHSP****@E,@@D*************2******S01136S01319
     C                     MOVE BNTHSP    @E,@@D           **2            S01319
     C                     ADD  1         @@CNT2           **2            S01136
     C                     Z-ADD@@D       @@F     20       **2            S01136
     C                     SUB  1         @@D              **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE LAST CHARACTER                                      S01136
     C*                                                                   S01136
     C                     MOVE @D,@@C    @E,@@D                          S01136
     C*                                                                   S01136
     C*          IF NUMBER OF CHARACTERS MOVED IS GREATER THAN NUMBER     S01136
     C*        TO BE RETURNED DROP THOUSAND SEPARATORS TILL SATISFIED     S01136
     C*                                                                   S01136
     C           22        SUB  @@D       @@CMOV  20                      S01136
     C           @@CMOV    SUB  @@CRET    @@DIFF  20                      S01136
     C           @@DIFF    IFGT 0                          B1             S01136
     C                     DO   @@DIFF                     B*2            S01136
     C                     Z-ADD1         @@G     20       **2            S01136
     C                     Z-ADD2         @@H     20       **2            S01136
     C           @@G       DOWLE21                         B**3           S01136
     C                     MOVE @E,@@G    @C,@@H           ***3           S01136
     C                     ADD  1         @@G              ***3           S01136
     C                     ADD  1         @@H              ***3           S01136
     C           @@G       IFEQ @@F                        B***4          S01136
     C                     ADD  1         @@G              ****4          S01136
     C                     END                             E***4          S01136
     C                     END                             E**3           S01136
     C                     MOVEA@C        @E               **2            S01136
     C                     ADD  4         @@F              **2            S01136
     C                     END                             E*2            S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C*          MOVE @E TO DISPLAY FIELD                                 S01136
     C*                                                                   S01136
     C                     MOVEA@E        @@ADSP 21                       S01136
     C           ZA0759    ENDSR                                          S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C********                                                      S01136S01194
     C********SUBROUTINE ZA0300 - THIS SUBROUTINE CHAINS THE        S01136S01194
     C********CURRENCIES TABLE FILE LF/FDCCYDLL FOR CURRENCY DETAILSS01136S01194
     C********INDICATOR 80 IS SET ON IF THE RECORD IS NOT PRESENT ORS01136S01194
     C********IS FLAGGED FOR DELETION.                              S01136S01194
     C********IF INDICATOR IS SET ON INFORMATION ABOUT THE NATURE   S01136S01194
     C********OF THE ATTEMPTED FILE ACCESS WILL BE PLACED IN THE LDAS01136S01194
     C********                                                      S01136S01194
     C********CALLS       -                                         S01136S01194
     C********                                                      S01136S01194
     C********CALLED BY   - #A                                      S01136S01194
     C********                                                      S01136S01194
     C********FIELDS USED : SS0300 - KEY USED TO ACCESS LF/FDCCYDLL S01136S01194
     C********              SS0301 - FIELD USED IN SETTING UP KEY   S01136S01194
     C********                                                      S01136S01194
     C**************************************************************S01136S01194
     C********                                                      S01136S01194
     C********   ZA0300    BEGSR                                    S01136S01194
     C********                                                      S01136S01194
     C***SET*OF CHAIN FAIL INDICATOR                                S01136S01194
     C********             SETOF                     60             S01136S01194
     C********                                                      S01136S01194
     C****SET*UP KEY TO BE USED IN CHAIN                            S01136S01194
     C********             MOVE '0'       *IN60                     S01136S01194
     C********             MOVEL'20      'SS0300 12                 S01136S01194
     C********             MOVE '1'       SS0301  4                 S01136S01194
     C********             MOVELSSCCY     SS0301                    S01136S01194
     C********             MOVE SS0301    SS0300                    S01136S01194
     C********                                                      S01136S01194
     C********   SS0300    CHAINFDCCYDLL             60             S01136S01194
     C********                                                      S01136S01194
     C****CHECK LOGICAL DELETE FLAG BLANK                           S01136S01194
     C********   RECI      IFEQ '*'                        B1       S01136S01194
     C********             MOVE '1'       *IN60            *1       S01136S01194
     C********             END                             E1       S01136S01194
     C********                                                      S01136S01194
     C***DEAL*WITH DATA BASE ERROR                                  S01136S01194
     C********   *IN60     IFEQ '1'                        *********S01136S01194
     C********             MOVEL'FDCCYDLL'DBFILE           *        S01136S01194
     C********             MOVELSS0300    DBKEY            * DBERRORS01136S01194
     C********             MOVEL'908'     DBASE            *        S01136S01194
     C********             END                             *********S01136S01194
     C********                                                      S01136S01194
     C********   ZA0309    ENDSR                                    S01136S01194
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01194
     C*       SUBROUTINE #L - THIS SUBROUTINE CHAINS THE CURRENCIES   *   S01194
     C*       FILE VIA THE ACCESS PROGRAM.                            *   S01194
     C*       INDICATOR 60 IS SET ON IF THE RECORD IS NOT PRESENT.    *   S01194
     C*       IF INDICATOR IS SET ON INFORMATION ABOUT THE NATURE     *   S01194
     C*       OF THE ATTEMPTED FILE ACCESS WILL BE PLACED IN THE LDA. *   S01194
     C*                                                               *   S01194
     C*       CALLS       - AOCURRR0                                  *   S01194
     C*                                                               *   S01194
     C*       CALLED BY   - #B, #F                                    *   S01194
     C*                                                               *   S01194
     C*       FIELDS USED : XXCCY  - INPUT PARM FOR ACCESS PROGRAM    *   S01194
     C*                     @RTCD  - OUTPUT PARM FOR ACCESS PROGRAM   *   S01194
     C*                                                               *   S01194
     C*****************************************************************   S01194
     C*                                                                   S01194
     C           #L        BEGSR                                          S01194
     C*                                                                   S01194
     C**  SET OFF INDICATOR                                               S01194
     C                     MOVE '0'       *IN60                           S01194
     C*                                                                   S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM XXCCY     @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C***********          PARM           SDCURR                          S01194
     C*                                                                   S01194
     C**  CHECK FOR ERROR ON RETURN                                       S01194
     C           @RTCD     IFNE *BLANKS                    B1             S01194
     C                     MOVE '1'       *IN60            *1             S01194
     C                     MOVEL'SDCURRPD'DBFILE           *************  S01194
     C                     MOVELXXCCY     DBKEY            * DBERR 908 *  S01194
     C                     MOVEL'908'     DBASE            *************  S01194
     C                     SETON                     U7U8LR*1             S01194
     C                     EXSR *PSSR                      *1             S01194
     C                     END                             E1             S01194
     C*                                                                   S01194
     C           #L9       ENDSR                                          S01194
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* MM1013 - Subroutine to convert a rate to display, with sign   *   S01136
     C*                                                               *   S01136
     C* CALLED BY : #BBC FORMATING OF DRS DEALS FOR OUTPUT            *   S01136
     C*                                                               *   S01136
     C* CALLS :                                                       *   S01136
     C*                                                               *   S01136
     C* INPUT  : @@INPR Rate to be edited.                            *   S01136
     C*                                                               *   S01136
     C* OUTPUT : @@OUTR Edited output rate.                           *   S01136
     C*                                                               *   S01136
     C* USES :   @@INPR Rate to be edited.                            *   S01136
     C*          @@OUTR Edited output rate.                           *   S01136
     C*          @@DECS Field to hold decimal digits for input rate.  *   S01136
     C*          @@INTS Field to hold integers for input rate.        *   S01136
     C*          @@N    Counter field.                                *   S01136
     C*          @@Q    Second counter field.                         *   S01136
     C*          @@STRP Rate start position after zero suppression.   *   S01136
     C*          @W     Work array.                                   *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           MM1013    BEGSR                                          S01136
     C*                                                                   S01136
     C**  Define fields used.                                             S01136
     C                     Z-ADD@@INPR    @@INPR 117                      S01136
     C                     MOVE *BLANKS   @@OUTR 13                       S01136
     C                     MOVE *BLANKS   @@DECS  7                       S01136
     C                     MOVE *BLANKS   @@INTS  4                       S01136
     C                     Z-ADD0         @@N     20                      S01136
     C                     Z-ADD0         @@Q     20                      S01136
     C                     Z-ADD0         @@STRP  20                      S01136
     C*                                                                   S01136
     C**  Initialise work array.                                          S01136
     C                     MOVEA*BLANKS   @W                              S01136
     C*                                                                   S01136
     C**  If the rate is negative the sign must be printed.               S01136
     C           @@INPR    IFLT 0                          B1             S01136
     C                     MOVE '-'       @W,13            *1             S01136
     C                     Z-SUB@@INPR    @@INPR           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C**  Seperate integers and decimal digits into two fields.           S01136
     C                     MOVE @@INPR    @@DECS                          S01136
     C                     MOVEL@@INPR    @@INTS                          S01136
     C*                                                                   S01136
     C**  Move integers, decimal seperator and decimal digits into        S01136
     C**  work array.                                                     S01136
     C                     MOVEA@@INTS    @W                              S01136
     C*********************MOVE*IDDCSP****@W,5**********************S01136S01319
     C                     MOVE BNDCSP    @W,5                            S01319
     C                     MOVEA@@DECS    @W,6                            S01136
     C*                                                                   S01136
     C**  Remove leading zeros from the rate and replace with blanks.     S01136
     C                     Z-ADD1         @@N                             S01136
     C           @@N       DOWLE3                          B1             S01136
     C           @W,@@N    ANDEQ'0'                        X1             S01136
     C                     MOVE *BLANK    @W,@@N           *1             S01136
     C                     ADD  1         @@N              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C                     Z-ADD@@N       @@STRP                          S01136
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0120CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   S01136
     C**  Truncate trailing zeros and replace with blanks. If rate is     S01136
     C**  an integer a single zero after the decimal place should be      S01136
     C**  displayed.                                                      S01136
     C                     Z-ADD12        @@N                             S01136
     C           @@N       DOWGE7                          B1             S01136
     C           @W,@@N    ANDEQ'0'                        X1             S01136
     C                     MOVE *BLANK    @W,@@N           *1             S01136
     C                     SUB  1         @@N              *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0120CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01136
     C**  Right justify the array.                                        S01136
     C                     Z-ADD12        @@Q                             S01136
     C           @@N       IFNE @@Q                        B1             S01136
     C           @@N       DOWGE@@STRP                       B2           S01136
     C                     MOVE @W,@@N    @W,@@Q             *2           S01136
     C                     MOVE *BLANK    @W,@@N             *2           S01136
     C                     SUB  1         @@N                *2           S01136
     C                     SUB  1         @@Q                *2           S01136
     C                     END                               E1           S01136
     C                     END                             E2             S01136
     C*                                                                   S01136
     C**  Move the final array into the output field.                     S01136
     C                     MOVEA@W        @@OUTR                          S01136
     C*                                                                   S01136
     C           M10139    ENDSR                           **M10139**     S01136
     C*****************************************************************   S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
     C*                                                               *   S01136
     C* ZA0660 - THIS SUBROUTINE CONVERTS DATE FORMAT YYYYMMDD TO     *   S01136
     C*          DDMMMYY FORMAT                                       *   S01136
     C*                                                               *   S01136
     C* CALLED BY :                                                   *   S01136
     C*                                                               *   S01136
     C* CALLS :                                                       *   S01136
     C*                                                               *   S01136
     C* INPUT  : @@DTIN DATE INPUT (YYYYMMDD)  - IN DATA STRUCTURE    *   S01136
     C*                                                               *   S01136
     C* OUTPUT : @@DATE DATE OUTPUT (DDMMMYY)                         *   S01136
     C*                                                               *   S01136
     C* USES :   @@MTH  MONTH NUMBER                                  *   S01136
     C*          @@MNM  MONTH SHORTNAME                               *   S01136
     C*          @@DAY  DAY NUMBER                                    *   S01136
     C*          @@YYYY YEAR (4 CHARACTER)                            *   S01136
     C*          @@DAT5 5A WORKFIELD                                  *   S01136
     C*          @MN    ARRAY OF MONTH SHORTNAMES                     *   S01136
     C*                                                               *   S01136
     C*     LAST AMEND NO. ME1257              DATE 02/04/87          *   S01136
     C*     When date input is zero set output date to blanks         *   S01136
     C*                                                               *   S01136
     C*****************************************************************   S01136
     C           ZA0660    BEGSR                                          S01136
     C*                                                                   S01136
     C           @@DTIN    IFNE 0                          B1             S01136
     C                     MOVE @@YYYY    @@DATE  7        *1             S01136
     C                     MOVE @MN,@@MTH @@DAT5  5        *1             S01136
     C                     MOVEL@@DAY     @@DAT5           *1             S01136
     C                     MOVEL@@DAT5    @@DATE           *1             S01136
     C                     ELSE                            X1             S01136
     C                     MOVE *BLANKS   @@DATE           *1             S01136
     C                     END                             E1             S01136
     C*                                                                   S01136
     C           ZA0669    ENDSR                           **ZA0669 TAG **S01136
     C/EJECT                                                              S01136
     C*****************************************************************   S01136
0739  *    RETSR SR END OF PROGRAM PROCESSING                             S01311
      **   CALLED FROM   CMDSR                                            S01311
      **   CALLS SR                                                       S01311
0418  *    This is a standard link enquiry subroutine for ending the      S01311
0418  *    program.                                                       S01311
0418  *    Indicators used                                                S01311
0418  *    LR  seton - terminate program                                  S01311
0741  *                                                                   S01311
0740 C           RETSR     BEGSR                                          S01311
0741  *                                                                   S01311
0742 C                     SETON                     LR                   S01311
0392  **  Access DL Data Area                                             S01311
0405 C           *LOCK     IN   DLSDS                                     S01311
0402 C                     MOVE RETNWF    RETND                           S01311
0405 C                     OUT  DLSDS                                     S01311
0743 C                     RETRN                                          S01311
0744  *                                                                   S01311
0745 C                     ENDSR                                          S01311
0746 C********************************************************************S01311
     C*                                                                   S01136
     C* *PSSR    -   ROUTINE CALLED ON FILE / PROGRAM ERROR               S01136
     C*                                                                   S01136
     C* CALLS           -                                                 S01136
     C*                                                                   S01136
     C* CALLED BY       -                                                 S01136
     C*                                                                   S01136
     C* FLDS USED       -                                                 S01136
     C*                                                                   S01136
     C*****************************************************************   S01136
     C           *PSSR     BEGSR                                          S01136
      *                                                                   S01311
      * Update Linked Enquiry Data Area with Return Code set to 'E',      S01311
      * set on error switch, dump program and return to calling           S01311
      * program                                                           S01311
      *                                                                   S01136
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
      *                                                                   S01311
     C           *LOCK     IN   DLSDS                                     S01311
     C                     MOVE 'E'       RETND                           S01311
     C                     OUT  DLSDS                                     S01311
      *                                                                   S01311
     C                     SETON                     U7U8LR               S01131
     C                     DUMP                                           S01136
     C                     END                                            S01131
      *                                                                   S01131
     C/COPY WNCPYSRC,DL0120C013
     C                     RETRN                                          S01131
      *                                                                   S01131
     C                     ENDSR                                          S01136
     C*                                                                   S01136
     C*****************************************************************   S01136
     ***ERR**********                                                     S01117
ENTER**USTOMER**************************INVALID CUSTOMER NUMBER           S01117
INVAL***SHORTNAME************************ NO DEALS ARE HELD FOR THIS CUSTOS01117
INVAL***ENTRY CANNOT BOTH BE BLANK******INVALID ENTRY - ENTER 'Y'         S01117
INVAL***ENTRY - ENTER '1'
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** TXT
OPTION TO
SALE
BASE RATE
INTEREST/SPREAD
YIELD
CEILING RATE
FLOOR RATE
OUR BASE RATE
THEIR BASE RATE
CONTRACT RATE
REFERENCE RATE
P'SZ                                                                      S01378
     X/COPY WNCPYSRC,DL0120X001
** ERR
ENTER CUSTOMER
INVALID CUSTOMER NUMBER
INVALID SHORTNAME
* NO DEALS ARE HELD FOR THIS CUSTOMER *
INVALID ENTRY CANNOT BOTH BE BLANK
INVALID ENTRY - ENTER 'Y'
INVALID ENTRY - ENTER '1'
USER IS NOT AUTHORISED TO ANY BOOKING BRANCHES                            LN0467
USER IS NOT AUTHORISED TO THE BOOKING BRANCH                              LN0467
INVALID BRANCH CODE                                                       LN0467
NO BANK AUTHORIZATION FOR USER                                            LN0467
* NO FX DEALS ARE HELD FOR THIS CUSTOMER *                                S01311
* NO MM DEALS ARE HELD FOR THIS CUSTOMER *                                S01311
* NO FRAs FOR THIS CUSTOMER *                                             S01332
* NO IRS' FOR THIS CUSTOMER *                                             S01332
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** ZCOM - EDIT FORMAT FOR AMOUNT FIELD
   ,   ,   ,   ,  0
   ,   ,   ,   ,  0.
              0
              0.
   .   .   .   .  0                                                                           245692
   .   .   .   .  0,                                                                          245692
              0,                                                                              245692
** TABLE TABA & TABB FOR DEAL STATUS NARRATIVES                           S01136
CCOMP                                                                     S01136
AAUTH                                                                     S01136
RREAUTH                                                                   S01136
EEXPIRED                                                                  S01136
MMATURED                                                                  S01136
NHIST                                                                     E20251
