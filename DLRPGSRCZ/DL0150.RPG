0001 H            DH
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Foreign currency positions enquiry')          *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *  DL0150 - CURRENCY POSITIONS ENQUIRY                          *
      *                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. CER059             Date 19Jul10               *
      *  Prev Amend No. CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 249181             Date 09Sep04               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL014             Date 29Jul03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 197434             Date 09Oct01               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      *                 180788             Date 30Aug00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 154702             Date 29Apr99               *
     F*                 152017             Date 31Dec98               *
     F*                 143532             Date 28SEP98               *
     F*                 139777             Date 30Jul98               *
     F*                 CEU012             Date 16Feb98               *
     F*                 S01408             Date 04Apr96               *
     F*                 058826             Date 13Oct95               *
     F*                 S01408             DATE 20JAN95               *
     F*                 S01408             DATE 18MAY94               *
     F*                 063281             DATE 22FEB94               *
     F*                 057188             DATE 27SEP93               *
     F*                 LN0541             DATE 24SEP90               *
     F*                 E43458             DATE 11APR90               *
     F*                 E10778             DATE 11APR90               *
     F*                 E12637             DATE 11APR90               *
0009 F*                 S01199             DATE 27FEB90               *
     F*                 E130               DATE 01DEC89               *
     F*                 E112               DATE 28NOV89               *
     F*                 E119               DATE 27NOV89               *
0009 F*                 E00044             DATE 15NOV89               *
0009 F*                 E28                DATE 03NOV89               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  249181 - Webfacing changes.                                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL014 - Exclude Interest from Net Position.                 *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  197434 - Array index error on SF0021. Increase maximum       *
      *           number of branches from 100 to 900.                 *
      *  180788 - GLOLPEL1 and GLOLPEL2 are overridden to OLPOS4  and *
      *           OLPOS5 . Applied fix 149887. Update PF/GLOLEMPD     *
      *           with the updated PF/OLPOSOA when F5 is pressed.     *
      *           Recompiled due to the introduction of two new       *
      *           logical files.                                      *
     F*  154702 - Incorrect amount for consolidated EUR ccy --> EXX , *
     F*           columns 'Unmatured Spot' & 'Forwards' .             *
     F*           Applied associated fix #159232 .                    *
     F*  152017 - Wrong net spot for consolidated euro                *
     F*  143532 - EMU: program should set indicator *IN87 off, if     *
     F*           Multiply/Divide indicator is 'M'.                   *
     F*  139777 - EMU: Wrong amounts being shown for consolidated     *
     F*           Euro currency in FX Positions enquiry screen        *
     F*  CEU012 - EMU Position/Risk Enquiries                         *
     F*  S01408 - Core hook DL0150CCP1 added                          *
     F*           Core hook DL0150IIP1 added                          *
     F*  058826 - OLPOS1 IS NOT UNLOCKED AFTER F3 IS TAKEN, CAUSING   *
     F*           REMOTE WSTN TO HANG WHEN SIGNING OFF.               *
     F*  S01408 - Core hook DL0150FFPG added                          *
     F*           Core hook DL0150IIPG added                          *
     F*           Core hook DL0150CV02 added                          *
     F*  S01408 - Core hook DL0150CVSF added                          *
     F*           Core hook DL0150CVSR added                          *
     F*           Core hook DL0150CV01 added                          *
     F*  063281 - Fix to exclude holidays when calculating            *
     F*           spot/forward days.                                  *
     F*  057188 - Open position for all currencies was severely       *
     F*           wrong. *IN87 was set incorrectly and was not        *
     F*           reset for each currency. This resulted in mis-      *
     F*           placed decimal positions.                           *
     F*  LN0541 - IF REQUEST IS BY ALL COMPANIES SHOULD SAY SO.       *
     F*  S01199 - RECOMPILE FOR  HELP SYSTEM                       *
     F*  E43458 - FIX INCORPORATED WITHIN RE-WRITING OF PROGRAM       *
0010 F*  E10778 - ENQUIRIES RESULT IN ARRAY INDEX ERROR               *
0010 F*           (FIX INCORPORATED WITHIN THE RE-WRITING OF          *
0010 F*           PROGRAM).                                           *
     F*  E12637 - ARRAY INDEX ERROR CAUSED BY USER DELIBERATELY       *
     F*           SKIPPING MORE THAN 16 DAYS IN NEXT DAY SETUP.       *
     F*  E130   - MULTIPLY/DIVIDE INDICATOR CORRECTION                *
     F*  E112   - FIX TO PREVENT DEVICE ERROR WHEN NOTHING ENTERED    *
     F*           MBIN-Y                                              *
     F*  E119   - SET LOWER LIMITS ON CCY FILE BEFORE READ.           *
     F*  E00044 - ALLOW CURSOR TO BE POSITIONED ON FIELD IN ERROR     *
     F*           ON DISPLAY FILE                                     *
     F*  E28    - FIX TO PROVIDE CORRECT MULTI-BRANCHING DISPLAYS     *
0010 F*  S01194 - STANDING DATA CHANGES.                              *
0010 F*  S01117 - SECURITY PROFILE FACILITY CHANGES.                  *
0010 F*  S01117 - MULTIBRANCH CHANGES.                                *
     F*                                                               *
0011 F*****************************************************************
0012 F* ID F  C  H  L   Function Of Indicators
0013 F*        01     OLPOS - FX Detail Record
0014 F*        02     OLPOS - INT Detail Record
0020 F*        32     Display Constant  'All Branches'
0021 F*        33         "       "     'Branch  XXX '
0022 F*        34         "       "     'Company XXX '
0022 F*        35         "       "     'AS AT'
0023 F*        37     Error Indicator
0019 F*     40-42     Multipurpose
0022 F*     50-53     Currency Has 0-3 D.P.
0023 F*        60     Do Not Include Base CCY In The Total
     F*        66     Found A Position Data Equal To Run date
     F*        70     Subfile Display
     F*        71     Subfile Clear
     F*        72     Subfile Rollup
     F*        74     Protect Branch And Company
     F*        75     Input Currency In Error
     F*        76       "   Branch   "    "
     F*        77       "   Company  "    "
     F*     78 79     Internal Work Indicators
     F*        81   ALL COMPANIES
     F*        KC   Cmd/3 Exit From Program
     F*        KE   Cmd/5 Redisplay Screen
     F*        LR   Exit From Program
     F*****************************************************************
     F/SPACE 3
     F/COPY WNCPYSRC,DL0150F001
     FSDCURRL0IF  E           K        DISK
0017 FOLPOS1  IF  F     400  6AI     2 DISK
0017 FOLPOS2  IF  F     400  6AI     2 DISK
     FGLOLPEL1IF  F     403  6AI     2 DISK         KINFSR *PSSR      UC  CEU012
      **  GL Online Positions by CCY/BRCA                                 CEU012
      *                                                                   CEU012
     FGLOLPEL2IF  F     403  6AI     2 DISK         KINFSR *PSSR      UC  CEU012
      **  GL Online Positions by CCY/CMPYM                                CEU012
      *                                                                   CEU012
0026 FDL0150FMCF  E                    WORKSTN
     F                                        RRN   KSFILE DL0150C
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0150FFPG                                           S01408
     F*                                                                   S01408
     F*****************************************************************
      *    Mutliply/Divide Indicator
0051 E********************MD        150  1 0                              E130
0051 E                    MD        150  1                                E130
      *    Currency
0032 E                    XCY       150  3  ASPR    15 8
     E*                                                                   063281
     E** Spot Days                                                        063281
     E*                                                                   063281
     E                    XSD       150  2 0                              063281
      *    Factors
0033 E                    FCT       150  7 0
      *    Foreign Echange Values
0035 E                    OFI        16 15 0
0036 E                    OFO        16 15 0
     E/COPY WNCPYSRC,DL0150E001
      *    Interest Values
0038 E                    OII        16 15 0
0039 E                    OIO        16 15 0
     E/COPY WNCPYSRC,DL0150E002
      *    Position File Dates
     E                    ODT        19  5 0
      *    Company
     E                    ZCO       100  3
      *    Branch
     E**********          ZBR       100  3  A                                                 197434
     E                    ZBR       900  3  A                                                 197434
      *    Error Messages
0043 E                    ERR     1   9 42
      *    Screen Data
0045 E                    CYO       999  3  A
0046 E                    NET       999 12 0
0047 E                    UMT       999 12 0
0048 E                    FWD       999 12 0
     E/COPY WNCPYSRC,DL0150E003
0049 E                    INT       999 12 0
     E/COPY WNCPYSRC,DL0150E004
0050 E                    OVL       999 12 0
      *    Internal Work Arrays
0035 E                    IOFI       16 15 0
0036 E                    IOFO       16 15 0
     E/COPY WNCPYSRC,DL0150E005
0038 E                    IOII       16 15 0
0039 E                    IOIO       16 15 0
     E/COPY WNCPYSRC,DL0150E006
     E                    IODT       16  5 0
0041 E                    ARRWRK     16 15 0
      *                                                                   CEU012
      **  Consolidated dates                                              CEU012
      *                                                                   CEU012
     E                    COFI       16 15 0                              CEU012
     E                    COFO       16 15 0                              CEU012
     E                    COII       16 15 0                              CEU012
     E                    COIO       16 15 0                              CEU012
     E                    CODT       16  5 0A                             CEU012
     E                    WARR       16 15 0                              CEU012
     E/COPY WNCPYSRC,DL0150E007
      *                                                                   CEU012
     E/COPY WNCPYSRC,DL0150E008
     E                    CPY@    1   1 80
     E*                                                                   063281
     E** For calculation of working days forward in particular            063281
     E** currency and location.                                           063281
     E*                                                                   063281
     E/COPY ZSRSRC,ZHOLE                                                  063281
     E*****************************************************************
      /EJECT
     I*****************************************************************
0052  *
0111  *
0094  **   Positions File
0112 IOLPOS1  NS  01   1 CD   5 C0   6 C1
0113 I       OR   02   1 CD   5 C0   6 C2
0114 I                                        1   1 RECI
0115 I                                        2   4 CCY
0116 I                                        5   60RECN
0117 I                                    P   7  140PCOB
     I                                    P  15  62 ODT
0119  *
0120  **   Foreign Exchange Position Values.
0121 I                                    P  63 190 OFI
0122 I                                    P 191 318 OFO
     I/COPY WNCPYSRC,DL0150I001
0123  *
0124  **   Interest Position Values.
0125 I                                    P  63 190 OII
0126 I                                    P 191 318 OIO
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0150IIPG                                           S01408
     I*                                                                   S01408
0128  *
0129 I                                    P 398 4000TNLU
0130  *
0131  **   Catchall
0132 I        NS
0095  *
0094  **   Positions File
0112 IOLPOS2  NS  01   1 CD   5 C0   6 C1
0113 I       OR   02   1 CD   5 C0   6 C2
0114 I                                        1   1 RECI
0115 I                                        2   4 CCY
0116 I                                        5   60RECN
0117 I                                    P   7  140PCOB
     I                                    P  15  62 ODT
0119  *
0120  **   Foreign Exchange Position Values.
0121 I                                    P  63 190 OFI
0122 I                                    P 191 318 OFO
     I/COPY WNCPYSRC,DL0150I002
0123  *
0124  **   Interest Position Values.
0125 I                                    P  63 190 OII
0126 I                                    P 191 318 OIO
     I/COPY WNCPYSRC,DL0150I003
0127  *
0129 I                                    P 398 4000TNLU
0130  *
0131  **   Catchall
0132 I        NS
0130  *
     IGLOLPEL1NS  01   1 CD   5 C0   6 C1                                 CEU012
     I       OR   02   1 CD   5 C0   6 C2                                 CEU012
     I                                        1   1 RECI                  CEU012
     I                                        2   4 CCY                   CEU012
     I                                        5   60RECN                  CEU012
     I                                    P   7  140PCOB                  CEU012
     I                                    P  15  62 ODT                   CEU012
      *                                                                   CEU012
      **   Foreign Exchange Position Values.                              CEU012
     I                                    P  63 190 OFI                   CEU012
     I                                    P 191 318 OFO                   CEU012
      *                                                                   CEU012
      **   Interest Position Values.                                      CEU012
     I                                    P  63 190 OII                   CEU012
     I                                    P 191 318 OIO                   CEU012
      *                                                                   CEU012
     I                                    P 398 4000TNLU                  CEU012
     I                                      401 4020SSNB                  CEU012
     I                                      403 403 INCY                  CEU012
      *                                                                   CEU012
      **   Catchall                                                       CEU012
     I        NS                                                          CEU012
      *                                                                   CEU012
     IGLOLPEL2NS  01   1 CD   5 C0   6 C1                                 CEU012
     I       OR   02   1 CD   5 C0   6 C2                                 CEU012
     I                                        1   1 RECI                  CEU012
     I                                        2   4 CCY                   CEU012
     I                                        5   60RECN                  CEU012
     I                                    P   7  140PCOB                  CEU012
     I                                    P  15  62 ODT                   CEU012
      *                                                                   CEU012
      **   Foreign Exchange Position Values.                              CEU012
     I                                    P  63 190 OFI                   CEU012
     I                                    P 191 318 OFO                   CEU012
      *                                                                   CEU012
      **   Interest Position Values.                                      CEU012
     I                                    P  63 190 OII                   CEU012
     I                                    P 191 318 OIO                   CEU012
      *                                                                   CEU012
     I                                    P 398 4000TNLU                  CEU012
     I                                      401 4020SSNB                  CEU012
     I                                      403 403 INCY                  CEU012
      *                                                                   CEU012
      **   Catchall                                                       CEU012
     I        NS                                                          CEU012
      *                                                                   CEU012
0139  **   Positions File Key List
0140 I            DS
0141 I                                        1   6 OLBRCM
     I                                        1   3 SCCYI
     I                                        4   6 SBRCM
     I*                                                                   139777
     I** Positions File Key List for EURO                                 139777
     I            DS                                                      139777
     I                                        1   6 KEURO                 139777
     I                                        1   3 KECURR                139777
     I                                        4   6 KEBRCA                139777
     I/EJECT
     ISDBANK    E DSSDBANKPD
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM
     I*
     ISDCOMP    E DSSDCOMPPD
     I* COMPANY DETAILS ACCESSED VIA ACCESS PROGRAM
     I*
     ISDBRCH    E DSSDBRCHPD
     I* BRANCH DETAILS ACCESSED VIA ACCESS PROGRAM
     I*
     ISDCURR    E DSSDCURRPD
     I* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM
     I*
     ISDGELR    E DSSDGELRPD                                              CEU012
      ** General ledger details                                           CEU012
      *                                                                   CEU012
     ISCSARD    E DSSCSARDPD                                              CEU012
      **  Switchable Features File                                        CEU012
      *                                                                   CEU012
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*
     I**  Following Data Structure will also be defined in                063281
     I**  copy element of ZHOLDS, thus no need to define it               063281
     I**  twice.                                                          063281
     I*                                                                   063281
     I***DSSDY*****E*DSDSSDY*****************                      S01194 063281
     I**SECOND*DS*FOR*ACCESS*PROGRAMS,*LONG*DATA*STRUCTURE*********S01194 063281
      *
      **   Users Workstation From Status Data Structure
     IPSDS       SDS
     I                                      244 246 WSID
      *
      **   External Data Area Of Companies For This User.(top down)
     IZCMP        DS
     I                                        1   1 ZCHC
     I                                        2   4 ZINC
     I                                        5 154 ZCO1
     I                                      155 304 ZCO2
      *
      **   External Data Area Of Branches For This User.(top down)
     IZBRU        DS
     I                                        1   1 ZCHB
     I                                        2   4 ZIN
     I                                        5 154 ZBR1
     I                                      155 304 ZBR2
      *                                                                                       197434
     IZBRU1       DS                                                                          197434
      *                                                                                       197434
      ** Bank Level Functions / Booking Branches 1                                            197434
      *                                                                                       197434
     I                                        1 255 ZBR11                                     197434
     I                                      256 510 ZBR12                                     197434
     I                                      511 765 ZBR13                                     197434
     I                                      7661020 ZBR14                                     197434
     I                                     10211275 ZBR15                                     197434
     I                                     12761530 ZBR16                                     197434
     I                                     15311785 ZBR17                                     197434
     I                                     17861998 ZBR18                                     197434
     IZBRU2       DS                                                                          197434
      *                                                                                       197434
      ** Bank Level Functions / Booking Branches 2                                            197434
      *                                                                                       197434
     I                                        1 255 ZBR21                                     197434
     I                                      256 402 ZBR22                                     197434
      *
      **  External Data Area Of Default Branch For User                   E28
     IZMUSER      DS                                                      E28
     I                                        1  17 ZDUM                  E28
     I                                       11  13 ZDFB                  E28
      *                                                                   E28
      *
      **   Branch and Customer Entered Into Format
     I            DS
     I                                        1   6 SCIN
     I                                        1   3 SBRC
     I                                        4   6 SCMP
      *                                                                   CEU012
     I/COPY WNCPYSRC,DL0150I004
      *  Data Structure for LDA                                           CEU012
     ILDA       E DSLDA                         256                       CEU012
      *                                                                   CEU012
     IRUNDAT      DS
     I*  DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.
     I                                       13  13 @MBIN
     I*                                                                   063281
     I** For calculation of working days forward in particular            063281
     I** currency and location.                                           063281
     I*                                                                   063281
     I/COPY ZSRSRC,ZHOLI                                                  063281
     I/COPY ZSRSRC,ZHOLDS                                                 063281
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0150IIP1                                           S01408
     I*                                                                   S01408
     ISVAL1       DS                            200                                           CDL014
     I                                        1   1 SVAL11                                    CDL014
      ** DS for AOSVALR0                                                                      CDL014
      *                                                                                       CDL014
     I              'XcludeIntFrmNetPostn'C         SVALKK                                    CDL014
      *                                                                                       CDL014
      *****************************************************************
0143  /EJECT
      *****************************************************************
      *
      *    First Cycle Processing
      *
     C                     EXSR INIT
     C/COPY WNCPYSRC,DL0150C023
      *
     C           *INKC     DOUEQ'1'
      *
      *    Display and Process First Screen Input
      *
     C                     EXSR DISP1
      *
      *    Display and Process Second Screen Input
      *
     C           *INKC     IFEQ '0'
     C                     EXSR SCR2
     C                     END
      *
     C                     END
      *
      *    End Program If User Takes CMD/3
      *
     C*** For some reason, OLPOS1 is not unlocked for remote job.         058826
     C                     CLOSEOLPOS1                                    058826
     C                     MOVE '1'       *INLR
      *
      *****************************************************************
0143  /EJECT
      *****************************************************************
      *
      *    Display First Screen and Validate Users Input
      *
0193 C           DISP1     BEGSR                                       *
      *
     C           *IN37     DOUEQ'0'                        No Error
     C                     MOVE '0'       *IN35
     C                     WRITEDL0150A                    Heading
     C                     WRITEDL0150E                    Dummy
     C                     EXFMTDL0150D                    Footing
     C           *INKC     IFEQ '0'                        No Cmd/3
     C                     EXSR SRNVAL                     Srn Validate
     C                     END                             Ifend/3
     C  NKC                END                             Doend/3
      *
     C                     ENDSR
      *
      *****************************************************************
0143  /EJECT
      *****************************************************************
      *
      *    Display Second Screen and Validate Users Input
      *
0193 C           SCR2      BEGSR                                       *
      *
      *    Reset Change Indicator If Branch/Company Not Entered
      *
     C           SCIN      IFEQ *BLANK
     C                     MOVE '1'       *IN30
     C                     END
      *
      *    Display Second Screen Until Input Error Or CMD/3 Found
      *
     C           *INKC     DOUEQ'1'
      *
      *    If Selection Is Made On Branch Or Company Then Call An
      *    External Program To Build An Query File.Otherwise Bulid
      *    Screen from All Records In The Positions File.
      *
     C           *IN30     IFEQ '1'
     C           SCIN      IFNE *BLANK
     C                     EXSR BLQRYF                     Open Query
     C                     EXSR SRNBLD                     Scrn Build
     C                     ELSE
     C                     EXSR SRNBLD                     Scrn Build
     C                     END
     C                     END
      *
     C                     EXSR DISP2
      *
      *    If CMD/5 Issued Rebuild Screen From Last Valid Input
      *
     C           *INKE     IFEQ '1'
     C                     MOVE CUCS      SCUC
     C                     MOVE BRCS      SBRC
     C                     MOVE CMPS      SCMP
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     EXSR SRNVAL                     Validation
     C/COPY WNCPYSRC,DL0150C024
     C                     END
      *
     C  N37                END
      *
     C                     ENDSR
      *****************************************************************
0143  /EJECT
      *****************************************************************
      *
      *    Build Subfile Screen From Selection Input
      *
0193 C           SRNBLD    BEGSR                                       *
      *
      *    Reset Indicatores and Work Arrays
     C/COPY WNCPYSRC,DL0150C026
      *
     C                     MOVEA'00'      *IN,79
     C                     Z-ADD0         ICOB
0224 C                     Z-ADD0         OVTOT  150
     C                     MOVE *BLANK    IOFI
     C                     MOVE *BLANK    IOFO
     C/COPY WNCPYSRC,DL0150C001
     C                     MOVE *BLANK    IOII
     C                     MOVE *BLANK    IOIO
     C                     MOVE *BLANK    IODT
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     MOVE *BLANK    COFI                            CEU012
     C                     MOVE *BLANK    COFO                            CEU012
     C                     MOVE *BLANK    COII                            CEU012
     C                     MOVE *BLANK    COIO                            CEU012
     C***********          MOVE *BLANK    CODT                     CEU012 139777
     C                     Z-ADD0         CCOB   150                      CEU012
     C                     ENDIF                                          CEU012
     C                     MOVE *BLANK    NET
     C                     MOVE *BLANK    UMT
     C                     MOVE *BLANK    FWD
     C                     MOVE *BLANK    INT
     C/COPY WNCPYSRC,DL0150C002
     C                     MOVE *BLANK    OVL
     C                     MOVE SCUC      CUCS    3
     C                     MOVE SBRC      BRCS    3
     C                     MOVE SCMP      CMPS    3
     C                     MOVE *BLANK    SCUC
      *
      *    Clear Screen Subfile
      *
     C                     MOVE '1'       *IN71
     C                     WRITEDL0150B
     C                     MOVE '0'       *IN71
      *
      *    Set Data Base Curser In Positions File If All Branches/
      *    Companies Required
      *
     C           SCIN      IFEQ *BLANK
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           *LOVAL    SETGTGLOLPEL2                                  CEU012
     C                     ELSE                                           CEU012
     C           *LOVAL    SETGTOLPOS2                                   *
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     END
      *
     C           *IN42     DOUEQ'1'
      *
     C                     MOVEA'00'      *IN,01
      *
     C           SCIN      IFEQ *BLANK
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     READ GLOLPEL2                 42               CEU012
     C                     ELSE                                           CEU012
     C                     READ OLPOS2                   42              *
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     ELSE
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     READ GLOLPEL1                 42               CEU012
     C                     ELSE                                           CEU012
0247 C                     READ OLPOS1                   42
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     END
      *
      *    At End Of File Write Rccord To Screen Arrays
      *
     C           *IN42     IFEQ '1'
     C           *IN79     ANDEQ'1'
0256 C                     EXSR PROC01
0257 C                     EXSR PROC02
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     EXSR SRPR03                                    CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     END
      *
      *    Process Only Valid '01/02' Positions Records
      *
     C           *IN42     IFEQ '0'
     C           *IN01     ANDEQ'1'
     C           *IN02     OREQ '1'
      *
     C           *IN78     IFEQ '0'
     C                     MOVE CCY       PCCY    3
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     MOVE INCY      WINCY   1                       CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     END
      *
      *    On Change Of Currency Write Detail Record To Screen Arrays
      *
     C           CCY       IFNE PCCY
      *
     C           *IN79     IFEQ '1'
0256 C                     EXSR PROC01
0257 C                     EXSR PROC02
     C                     END
      *
     C                     MOVE *BLANK    IOFI             Clear Array
     C                     MOVE *BLANK    IOFO               "     "
     C/COPY WNCPYSRC,DL0150C003
     C                     MOVE *BLANK    IOII               "     "
     C                     MOVE *BLANK    IOIO               "     "
     C/COPY WNCPYSRC,DL0150C004
     C                     MOVE *BLANK    IODT               "     "
     C                     Z-ADD0         ICOB             Tot Position
     C                     MOVE CCY       PCCY    3        Currency
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     MOVE INCY      WINCY   1                       CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     MOVE '0'       *IN79            Rec Found
     C                     END
      *
      *    Build Detail Arrays Of Screen Data By Currency
      *
     C           *IN01     IFEQ '1'
     C                     ADD  OFI       IOFI
     C                     ADD  OFO       IOFO
     C/COPY WNCPYSRC,DL0150C005
     C                     ELSE
     C                     ADD  OII       IOII
     C                     ADD  OIO       IOIO
     C/COPY WNCPYSRC,DL0150C006
     C                     END
      *
     C                     MOVE ODT       IODT
     C                     ADD  PCOB      ICOB   150
     C                     MOVEA'11'      *IN,78
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           PCCY      ANDEQBKEURO                                    CEU012
     C           *IN01     IFEQ '1'                                       CEU012
     C                     ADD  OFI       COFI                            CEU012
     C                     ADD  OFO       COFO                            CEU012
     C                     ELSE                                           CEU012
     C                     ADD  OII       COII                            CEU012
     C                     ADD  OIO       COIO                            CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     MOVE ODT       CODT                            CEU012
     C                     ADD  PCOB      CCOB   150                      CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           WINCY     ANDEQ'Y'                                       CEU012
     C                     EXSR SRXNET                                    CEU012
     C                     ENDIF                                          CEU012
      *
     C                     END
      *
     C                     END
      *
      *    At End Of File Write Screen Arrays To Subfile
      *
     C                     DO   INDEX     Y       30
     C                     MOVE XCY,Y     SCCY
     C           CUCS      COMP XCY,Y                    31
     C                     MOVE NET,Y     SNET
     C                     MOVE UMT,Y     SUMT
     C                     MOVE FWD,Y     SFWD
     C/COPY WNCPYSRC,DL0150C007
     C           CDL014    IFNE 'Y'                                                           CDL014
     C                     MOVE INT,Y     SINT
     C                     ENDIF                                                              CDL014
     C/COPY WNCPYSRC,DL0150C008
     C                     MOVE OVL,Y     SOVL
     C/COPY WNCPYSRC,DL0150C030
     C                     Z-ADDY         RRN
     C/COPY WNCPYSRC,DL0150C013
     C                     WRITEDL0150C
     C                     END
0263  *
0264 C           OVTOT     DIV  1000      OPNPOS    H
     C/COPY WNCPYSRC,DL0150C025
     C                     TIME           DTIME
     C                     ENDSR
      *****************************************************************
0143  /EJECT
0319  *****************************************************************
      *
      *    Bulid Open Query File Of Data Selected And Open User
      *    Controlled File 'OLPOS1'
      *
0193 C           BLQRYF    BEGSR
     C           SELECT    PLIST
     C                     PARM           SBRC
     C                     PARM           SCMP
     C                     CLOSEOLPOS1
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     CLOSEGLOLPEL1                                  CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     CALL 'DLC0150' SELECT
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     OPEN GLOLPEL1                                  CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     OPEN OLPOS1
     C                     ENDSR
      *****************************************************************
0143  /EJECT
      *****************************************************************
      *
      *    Display Second Screen To User.If Currency Has Been Entered
      *    Display respective Subfile Page.
      *
0193 C           DISP2     BEGSR                                       *
      *
     C           CUCS      IFNE *BLANK
     C                     Z-ADD1         RRN
     C           CUCS      LOKUPXCY,RRN                  73
     C                     ELSE
     C                     Z-ADD1         RRN
     C                     END
     C                     MOVEA'000'     *IN,32
     C           SCIN      COMP *BLANK                   32
     C           SBRC      COMP *BLANK               3333
     C           SCMP      COMP *BLANK               3434
     C                     MOVE '1'       *IN35
     C                     WRITEDL0150A                    Heading
     C                     WRITEDL0150B                    Detail
     C                     MOVE *BLANK    SBRC                            E28
     C                     MOVE *BLANK    SCMP                            E28
     C/COPY WNCPYSRC,DL0150C014
     C                     EXFMTDL0150D                    Footing
      *
     C                     ENDSR
      *****************************************************************
0143  /EJECT
0319  *****************************************************************
      *
      *    Calculate From Positions '01' Records The Unmatured and
      *    Forward Positions.
0327  *
0328 C           PROC01    BEGSR
0329  *
      *    Reset 'X' To Equal Index Position Of Currency In Array
      *
     C                     Z-ADD0         Z       20
     C                     Z-ADD1         X
     C           PCCY      LOKUPXCY,X                    73
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0150CV02                                           S01408
     C*                                                                   S01408
0339  *
0340  *    Unmatured Spot Position
      *
     C           *IN66     DOUEQ'0'
     C                     ADD  1         Z
     C           IODT,Z    COMP BJRDNB                 66
     C**                                                                  E12637
     C**  IF Z HAS NOT REACHED 16 THEN LOOP AGAIN                         E12637
     C**                                                                  E12637
     C   66      Z         COMP 16                     66                 E12637
     C                     END
     C*                                                                   063281
     C                     SETOF                     66                   063281
     C                     Z-ADD0         ZZ      20                      063281
     C           *IN66     DOUEQ'0'                                       063281
     C                     ADD  1         ZZ                              063281
     C*                                                                   063281
     C                     Z-ADDBJRDNB    ZDAYNO                          063281
     C                     Z-ADDXSD,X     ZNRDYS                          063281
     C                     MOVE BJLCCY    ZCCY                            063281
     C                     MOVE *BLANK    ZLOC                            063281
     C                     EXSR ZFWDT                                     063281
     C*                                                                   063281
     C           IODT,ZZ   COMP ZDYNBR                 66                 063281
     C   66      ZZ        COMP 16                     66                 063281
     C                     END                                            063281
     C*                                                                   063281
     C***********IOFI,Z    SUB  IOFO,Z    UNMAT  150                      063281
     C                     Z-ADD*ZERO     IOFIX  150                      063281
     C                     Z-ADD*ZERO     IOFOX  150                      063281
     C           Z         DO   ZZ        Z0      20                      063281
     C                     ADD  IOFI,Z0   IOFIX  150                      063281
     C                     ADD  IOFO,Z0   IOFOX  150                      063281
     C                     END                                            063281
     C           IOFIX     SUB  IOFOX     UNMAT  150                      063281
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,DL0150CVSF                                           S01408
     C*                                                                   S01408
0342  *
0343  *    Forward Position.
0342  *
0344 C           ICOB      DIV  FCT,X     NET,X     H
0345 C                     Z-ADDICOB      PCOBSV 150
0346 C           IOFI      SUB  IOFO      ARRWRK
0347 C                     XFOOTARRWRK    WORK15 150
0348 C           WORK15    SUB  UNMAT     FORWRD 150
0342  *
0349 C           END01     ENDSR
0342  *
      *****************************************************************
0143  /EJECT
0350  *****************************************************************
0353  *
      *    Calculate From Positions '02' Records The Interest and
      *    Overall Positions.
0353  *
0354 C           PROC02    BEGSR
     C/COPY WNCPYSRC,DL0150C009
0355  *
0356  *    Interest Position.
0359  *
0357 C           IOII      SUB  IOIO      ARRWRK
0358 C                     XFOOTARRWRK    INTRST 150
     C/COPY WNCPYSRC,DL0150C010
0359  *
0360  *    Overall POsitions
      *
0361 C           UNMAT     ADD  FORWRD    OVRALL 150
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,DL0150CVSR                                           S01408
     C*                                                                   S01408
     C           CDL014    IFNE 'Y'                                                           CDL014
0362 C           PCOBSV    ADD  INTRST    WORK15
     C                     ELSE                                                               CDL014
0362 C                     Z-ADDPCOBSV    WORK15                                              CDL014
     C                     ENDIF                                                              CDL014
     C/COPY WNCPYSRC,DL0150C031
0363 C           OVRALL    ADD  WORK15    OVRALL
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,DL0150CV01                                           S01408
     C*                                                                   S01408
0364  *
0365  *    Convert Overall To Base CCY & Accumulate Open Position.
      *
0366 C***********MD,X      COMP 0                        88               E130
     C************IN88     IFEQ '1'                                       E130
     C           MD,X      IFEQ 'D'                                       E130
0367 C           OVRALL    DIV  SPR,X     WORK15    H
     C                     ELSE
0368 C           OVRALL    MULT SPR,X     WORK15    H
     C                     END
      *
0369  *    Except When CCY is Base Currency
0372  *
     C           BJCYCD    COMP PCCY                     60
     C           *IN60     IFEQ '0'
0371 C           OVTOT     ADD  WORK15    OVTOT
     C                     END
0372  *
0373  *    Build Screen Arrays From Position Results
0372  *
0376 C           UNMAT     DIV  FCT,X     UMT,X     H
0377 C           FORWRD    DIV  FCT,X     FWD,X     H
     C/COPY WNCPYSRC,DL0150C011
0378 C           INTRST    DIV  FCT,X     INT,X     H
     C/COPY WNCPYSRC,DL0150C012
0379 C           OVRALL    DIV  FCT,X     OVL,X     H
     C/COPY WNCPYSRC,DL0150C021
0380  *
0381 C           END02     ENDSR
0372  *
      *****************************************************************
      /EJECT                                                              CEU012
      *****************************************************************   CEU012
      * SRPR03  -  Process Consolidated Euro Ccy                      *   CEU012
      * Called by: SRNBLD                                             *   CEU012
      * Calls    : None                                               *   CEU012
      *****************************************************************   CEU012
      *                                                                   CEU012
     C           SRPR03    BEGSR                                          CEU012
      *                                                                   CEU012
      **  Initialise X to the last position in the currencies array       CEU012
      *                                                                   CEU012
     C                     Z-ADD0         Z       20                      CEU012
     C                     Z-ADDINDEX     X                               CEU012
      *                                                                   CEU012
      **  Unmatured Spot Position                                         CEU012
      *                                                                   CEU012
     C           *IN66     DOUEQ'0'                                       CEU012
     C                     ADD  1         Z                               CEU012
      *                                                                   CEU012
     C********** BJRDNB    IFGE CODT,Z                              CEU012154702
     C********** 16        ORGE Z                                   CEU012154702
     C           CODT,Z    IFGE BJRDNB                                    154702
     C           Z         ORGE 16                                        154702
      *                                                                   154702
     C                     MOVE *OFF      *IN66                           CEU012
     C                     ELSE                                           CEU012
     C                     MOVE *ON       *IN66                           CEU012
     C                     ENDIF                                          CEU012
     C                     ENDDO                                          CEU012
      *                                                                   CEU012
     C                     MOVE *OFF      *IN66                           CEU012
     C                     Z-ADD0         ZZ      20                      CEU012
     C           *IN66     DOUEQ'0'                                       CEU012
     C                     ADD  1         ZZ                              CEU012
      *                                                                   CEU012
     C                     Z-ADDBJRDNB    ZDAYNO                          CEU012
     C                     Z-ADDXSD,X     ZNRDYS                          CEU012
     C                     MOVE BJLCCY    ZCCY                            CEU012
     C                     MOVE *BLANK    ZLOC                            CEU012
     C                     EXSR ZFWDT                                     CEU012
      *                                                                   CEU012
     C********** ZDYNBR    IFGE CODT,ZZ                             CEU012154702
     C********** 16        ORGE ZZ                                  CEU012154702
     C           CODT,ZZ   IFGE ZDYNBR                                    154702
     C           ZZ        ORGE 16                                        154702
      *                                                                   CEU012
     C                     MOVE *OFF      *IN66                           CEU012
     C                     ELSE                                           CEU012
     C                     MOVE *ON       *IN66                           CEU012
     C                     ENDIF                                          CEU012
     C                     ENDDO                                          CEU012
      *                                                                   CEU012
     C                     Z-ADD*ZERO     IOFIX  150                      CEU012
     C                     Z-ADD*ZERO     IOFOX  150                      CEU012
     C           Z         DO   ZZ        Z0      20                      CEU012
     C                     ADD  COFI,Z0   IOFIX  150                      CEU012
     C                     ADD  COFO,Z0   IOFOX  150                      CEU012
     C                     ENDDO                                          CEU012
     C           IOFIX     SUB  IOFOX     UNMAT  150                      CEU012
      *                                                                   CEU012
      **  Forward Position.                                               CEU012
      *                                                                   CEU012
     C           CCOB      DIV  FCT,X     NET,X     H                     CEU012
     C                     Z-ADDCCOB      PCOBSV 150                      CEU012
     C           COFI      SUB  COFO      WARR                            CEU012
     C                     XFOOTWARR      WORK15 150                      CEU012
     C           WORK15    SUB  UNMAT     FORWRD 150                      CEU012
      *                                                                   CEU012
      **  Interest Position.                                              CEU012
      *                                                                   CEU012
     C           COII      SUB  COIO      WARR                            CEU012
     C                     XFOOTWARR      INTRST 150                      CEU012
      *                                                                   CEU012
      **  Overall POsitions                                               CEU012
      *                                                                   CEU012
     C           UNMAT     ADD  FORWRD    OVRALL 150                      CEU012
     C/COPY WNCPYSRC,DL0150C032
      *                                                                   CEU012
     C           CDL014    IFNE 'Y'                                                           CDL014
     C           PCOBSV    ADD  INTRST    WORK15                          CEU012
     C                     ELSE                                                               CDL014
     C                     Z-ADDPCOBSV    WORK15                                              CDL014
     C                     ENDIF                                                              CDL014
     C/COPY WNCPYSRC,DL0150C029
     C           OVRALL    ADD  WORK15    OVRALL                          CEU012
     C/COPY WNCPYSRC,DL0150C027
      *                                                                   CEU012
      **  Convert Overall To Base CCY & Accumulate Open Position.         CEU012
      *                                                                   CEU012
     C           MD,X      IFEQ 'D'                                       CEU012
     C           OVRALL    DIV  SPR,X     WORK15    H                     CEU012
     C                     ELSE                                           CEU012
     C           OVRALL    MULT SPR,X     WORK15    H                     CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
      **  Except When CCY is Base Currency                                CEU012
      *                                                                   CEU012
     C           BJCYCD    IFEQ XCY,X                                     CEU012
     C           OVTOT     ADD  WORK15    OVTOT                           CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
      **  Build Screen Arrays From Position Results                       CEU012
      *                                                                   CEU012
     C           UNMAT     DIV  FCT,X     UMT,X     H                     CEU012
     C           FORWRD    DIV  FCT,X     FWD,X     H                     CEU012
     C           INTRST    DIV  FCT,X     INT,X     H                     CEU012
     C           OVRALL    DIV  FCT,X     OVL,X     H                     CEU012
     C/COPY WNCPYSRC,DL0150C020
      *                                                                   CEU012
     C                     ENDSR                                          CEU012
      *                                                                   CEU012
      *****************************************************************   CEU012
      /EJECT                                                              CEU012
      *****************************************************************   CEU012
      *                                                               *   CEU012
      * SRXNET  -  Converting amounts to Euro equivalent amt.         *   CEU012
      *                                                               *   CEU012
      * Called by: SRNBLD                                             *   CEU012
      * Calls    : EU0200                                             *   CEU012
      *                                                               *   CEU012
      *****************************************************************   CEU012
      *                                                                   CEU012
     C           SRXNET    BEGSR                                          CEU012
      *                                                                   CEU012
      **  Reset 'X' To Equal Index Position Of Ccy In Array               CEU012
      *                                                                   CEU012
     C***********IODT,1    IFLE CODT,1                              CEU012152017
      *                                                                   CEU012
     C                     Z-ADDPCOB      PFRAM                           CEU012
     C                     Z-ADD001       WDBASE  30                      CEU012
     C                     EXSR SREURO                                    CEU012
      *                                                                   CEU012
     C                     ADD  POUTA     CCOB                            CEU012
      *                                                                   CEU012
     C***********          ENDIF                                    CEU012152017
      *                                                                   CEU012
     C                     Z-ADD1         V       20                      CEU012
     C                     Z-ADD1         E       20                      CEU012
     C           V         DOWLE16                                        CEU012
     C           IODT,V    LOKUPCODT,E                 1010               CEU012
     C           *IN10     IFEQ '1'                                       CEU012
     C                     MOVE CODT,E    CODT,E                          CEU012
      *                                                                   CEU012
     C           *IN01     IFEQ '1'                                       CEU012
      *                                                                   CEU012
     C                     Z-ADDOFI,V     PFRAM                           CEU012
     C                     Z-ADD002       WDBASE                          CEU012
     C                     EXSR SREURO                                    CEU012
     C                     ADD  POUTA     COFI,E                          CEU012
      *                                                                   CEU012
     C                     Z-ADDOFO,V     PFRAM                           CEU012
     C                     Z-ADD003       WDBASE                          CEU012
     C                     EXSR SREURO                                    CEU012
     C                     ADD  POUTA     COFO,E                          CEU012
      *                                                                   CEU012
     C                     ELSE                                           CEU012
      *                                                                   CEU012
     C                     Z-ADDOII,V     PFRAM                           CEU012
     C                     Z-ADD004       WDBASE                          CEU012
     C                     EXSR SREURO                                    CEU012
     C                     ADD  POUTA     COII,E                          CEU012
      *                                                                   CEU012
     C                     Z-ADDOIO,V     PFRAM                           CEU012
     C                     Z-ADD005       WDBASE                          CEU012
     C                     EXSR SREURO                                    CEU012
     C                     ADD  POUTA     COIO,E                          CEU012
      *                                                                   CEU012
     C                     ENDIF                                          CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     ADD  1         V                               CEU012
      *                                                                   CEU012
     C                     ENDDO                                          CEU012
      *                                                                   CEU012
     C                     ENDSR                                          CEU012
      *                                                                   CEU012
      *****************************************************************   CEU012
0143  /EJECT
0382  *****************************************************************
      *
      *    Initialise Program Sub-Routine
      *
     C           INIT      BEGSR
      *
     C                     MOVEACPY@      BIS@   80
      *
     C** GET MULTI BRANCH INDICATOR FROM DATA AREA - RUNDAT
     C           *NAMVAR   DEFN           LDA                             CEU012
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C*
      *                                                                   CEU012
      ** Initialise LDA                                                   CEU012
      *                                                                   CEU012
     C           *LOCK     IN   LDA                                       CEU012
     C                     MOVEL'DL0150  'DBPGM                           CEU012
     C                     MOVE *BLANKS   DBFILE                          CEU012
     C                     MOVE *BLANKS   DBKEY                           CEU012
     C                     Z-ADD*ZEROS    DBASE                           CEU012
     C                     OUT  LDA                                       CEU012
      *                                                                   CEU012
     C                     SETOF                     40
     C                     MOVE *BLANK    ERRMSG 42
     C                     TIME           DTIME
0156  *    Read Bank Record.
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C************         PARM           SDBANK
      *    If Bank Record not found...
     C           @RTCD     IFNE *BLANK
     C                     SETON                     40
     C                     END
      *
      *   If Multi Branch Flag Is 'Y-yes' Get Valid Branches
      *
      *
      *
     C           @MBIN     IFEQ 'Y'
     C                     MOVE '0'       *IN74                           E28
     C                     MOVE '1'       *IN39                           E28
     C                     EXSR ZSPFB
     C                     ELSE
     C                     MOVE '1'       *IN74
     C                     MOVE '0'       *IN39                           E28
     C                     END
0160  *
0157 C                     Z-ADD0         X       30
     C/COPY WNCPYSRC,DL0150C015
      *                                                                   CEU012
      ** Check if Position/Risk Enquiries & Reports switchable            CEU012
      ** feature is on.                                                   CEU012
      *                                                                   CEU012
     C                     MOVE 'N'       CEU012  1                       CEU012
     C                     CALL 'AOSARDR0'                                CEU012
     C                     PARM *BLANKS   @RTCD                           CEU012
     C                     PARM '*VERIFY' @OPTN                           CEU012
     C                     PARM 'CEU012'  @SARD   6                       CEU012
     C           SCSARD    PARM SCSARD    DSFDY                           CEU012
      *                                                                   CEU012
     C           @RTCD     IFEQ *BLANKS                                   CEU012
     C                     MOVE 'Y'       CEU012                          CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C           @RTCD     IFNE *BLANKS                                   CEU012
     C           @RTCD     ANDNE'*NRF   '                                 CEU012
      *                                                                   CEU012
      ** Call to program ended in error                                   CEU012
      *                                                                   CEU012
     C           *LOCK     IN   LDA                                       CEU012
     C                     MOVEL'CEU012'  DBKEY            ************   CEU012
     C                     MOVE 'SCSARDPD'DBFILE           * DBERR 06 *   CEU012
     C                     Z-ADD06        DBASE            ************   CEU012
     C                     MOVEL'DL0150'  DBPGM                           CEU012
     C                     OUT  LDA                                       CEU012
     C                     SETON                     U7U8LR               CEU012
     C                     EXSR *PSSR                                     CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
      ** Retrieve general ledger details                                  CEU012
      *                                                                   CEU012
     C**********           CALL 'AOGELRR0'                                CEU012              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                           CEU012
     C                     PARM '*FIRST ' @OPTN                           CEU012
     C           SDGELR    PARM SDGELR    DSSDY                           CEU012
     C           @RTCD     IFNE *BLANKS                                   CEU012
     C           *LOCK     IN   LDA                                       CEU012
     C                     MOVEL'SDGELRPD'DBFILE           ************   CEU012
     C                     Z-ADD07        DBASE            * DBERR 07 *   CEU012
     C                     MOVEL'*FIRST'  DBKEY            ************   CEU012
     C                     EXSR *PSSR                                     CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C                     OPEN GLOLPEL1                                  CEU012
     C                     OPEN GLOLPEL2                                  CEU012
     C                     ENDIF                                          CEU012
      *                                                                   139777
      ** Get on-line position dates for EURO.                             139777
      *                                                                   139777
     C           CEU012    IFEQ 'Y'                                       139777
     C                     MOVE BKEURO    KECURR                          139777
     C                     MOVE *BLANKS   KEBRCA                          139777
     C           KEURO     SETLLGLOLPEL1                                  139777
     C                     READ GLOLPEL1                 42               139777
     C           CCY       IFEQ BKEURO                                    139777
     C                     MOVE ODT       CODT                            139777
     C                     ELSE                                           139777
     C                     MOVE *BLANK    CODT                            139777
     C                     ENDIF                                          139777
     C                     ENDIF                                          139777
      *                                                                   CEU012
     C                     MOVE 'N'       WEUROI  1                       CEU012
     C                     MOVE 'N'       WCDEUI  1                       CEU012
      *
      *    Read All Records In The Currency Code File And Build
      *    Program Arrays Of Currency/Spot Rate and Factor.
0160  *
     C           *LOVAL    SETLLSDCURRL0                                  E119
0161 C           *IN40     DOUEQ'1'
0163 C                     READ SDCURRL0                 40
0160  *
     C           *IN40     IFEQ '0'
     C           A6DLCI    ANDEQ'Y'
      *                                                                   CEU012
     C           *IN40     OREQ '1'                                       CEU012
     C           WEUROI    ANDEQ'Y'                                       CEU012
      *                                                                   CEU012
      ** Move saved consolidated euro ccy details to fields               CEU012
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           *IN40     ANDEQ'1'                                       CEU012
     C           WEUROI    ANDEQ'Y'                                       CEU012
      *                                                                   CEU012
     C                     MOVELW6CYCD    A6CYCD                          CEU012
     C                     MOVELW6SPDY    A6SPDY                          CEU012
     C                     MOVELW6SPRT    A6SPRT                          CEU012
     C                     MOVELW6NBDP    A6NBDP                          CEU012
     C                     MOVELW6MDIN    A6MDIN                          CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           A6CYCD    ANDEQBKEURO                                    CEU012
     C           WEUROI    ANDEQ'N'                                       CEU012
      *                                                                   CEU012
     C                     MOVELA6CYCD    W6CYCD  3                       CEU012
     C                     MOVELA6SPDY    W6SPDY  30                      CEU012
     C                     MOVELA6SPRT    W6SPRT 138                      CEU012
     C                     MOVELA6NBDP    W6NBDP  10                      CEU012
     C                     MOVELA6MDIN    W6MDIN  1                       CEU012
     C                     MOVE 'Y'       WEUROI                          CEU012
      *                                                                   CEU012
     C                     ELSE                                           CEU012
      *                                                                   CEU012
0168 C           X         ADD  1         X
     C                     MOVE A6CYCD    XCY,X
     C*                                                                   063281
     C** Spot date for currency                                           063281
     C*                                                                   063281
     C                     Z-ADDA6SPDY    XSD,X                           063281
     C*                                                                   063281
     C           A6NBDP    COMP 1                      5051
     C           A6NBDP    COMP 2                    53  52
     C   50                Z-ADDA6SPRT    SPR,X
     C**IF*MULTIPLY/DIVIDE*IND*IS*'M'*THEN*SETON*IND*87.***************   057188
     C* If MULT/DIV Indicator is 'M' then set off Indicator 87.           057188
     C* otherwise set it on.                                              057188
     C           A6MDIN    IFEQ 'M'
     C                     SETOF                     87                   057188
     C                     ELSE                                           057188
     C                     SETON                     87
     C                     END
     C   51 87   A6SPRT    MULT 10        SPR,X
     C   52 87   A6SPRT    MULT 100       SPR,X
     C   53 87   A6SPRT    MULT 1000      SPR,X
     C   51N87   A6SPRT    DIV  10        SPR,X
     C   52N87   A6SPRT    DIV  100       SPR,X
     C   53N87   A6SPRT    DIV  1000      SPR,X
     C                     MOVE A6MDIN    MD,X
0186 C   50                Z-ADD1000      FCT,X
0187 C   51                Z-ADD10000     FCT,X
0188 C   52                Z-ADD100000    FCT,X
0189 C   53                Z-ADD1000000   FCT,X
     C/COPY WNCPYSRC,DL0150C016
      *                                                                   CEU012
     C                     ENDIF                                          CEU012
     C                     END
0190 C                     END
      *                                                                   CEU012
     C           CEU012    IFEQ 'Y'                                       CEU012
     C           WEUROI    ANDEQ'Y'                                       CEU012
      *                                                                   CEU012
     C           X         ADD  1         X                               CEU012
     C                     MOVE BKEUCP    XCY,X                           CEU012
      *                                                                   CEU012
      ** Spot date for currency                                           CEU012
      *                                                                   CEU012
     C                     Z-ADDA6SPDY    XSD,X                           CEU012
      *                                                                   CEU012
     C           A6NBDP    COMP 1                      5051               CEU012
     C           A6NBDP    COMP 2                    53  52               CEU012
     C           *IN50     IFEQ *ON                                       CEU012
     C                     Z-ADDA6SPRT    SPR,X                           CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
      ** If MULT/DIV Indicator is 'M' then set off Indicator 87.          CEU012
      **  otherwise set it on.                                            CEU012
      *                                                                   CEU012
     C           A6MDIN    IFEQ 'M'                                       CEU012
     C**********           MOVE *ON       *IN87                     CEU012143532
     C                     MOVE *OFF      *IN87                           143532
     C                     ELSE                                           CEU012
     C                     MOVE *ON       *IN87                           CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C           *IN87     IFEQ *ON                                       CEU012
      *                                                                   CEU012
     C                     SELEC                                          CEU012
     C           *IN51     WHEQ *ON                                       CEU012
     C           A6SPRT    MULT 10        SPR,X                           CEU012
      *                                                                   CEU012
     C           *IN52     WHEQ *ON                                       CEU012
     C           A6SPRT    MULT 100       SPR,X                           CEU012
      *                                                                   CEU012
     C                     OTHER                                          CEU012
     C           *IN53     IFEQ *ON                                       CEU012
     C           A6SPRT    MULT 1000      SPR,X                           CEU012
     C                     ENDIF                                          CEU012
     C                     ENDSL                                          CEU012
      *                                                                   CEU012
     C                     ELSE                                           CEU012
      *                                                                   CEU012
     C                     SELEC                                          CEU012
     C           *IN51     WHEQ *ON                                       CEU012
     C           A6SPRT    DIV  10        SPR,X                           CEU012
      *                                                                   CEU012
     C           *IN52     WHEQ *ON                                       CEU012
     C           A6SPRT    DIV  100       SPR,X                           CEU012
      *                                                                   CEU012
     C                     OTHER                                          CEU012
     C           *IN53     IFEQ *ON                                       CEU012
     C           A6SPRT    DIV  1000      SPR,X                           CEU012
     C                     ENDIF                                          CEU012
     C                     ENDSL                                          CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     MOVE A6MDIN    MD,X                            CEU012
      *                                                                   CEU012
     C                     SELEC                                          CEU012
     C           *IN50     WHEQ *ON                                       CEU012
     C                     Z-ADD1000      FCT,X                           CEU012
      *                                                                   CEU012
     C           *IN51     WHEQ *ON                                       CEU012
     C                     Z-ADD10000     FCT,X                           CEU012
      *                                                                   CEU012
     C           *IN52     WHEQ *ON                                       CEU012
     C                     Z-ADD100000    FCT,X                           CEU012
      *                                                                   CEU012
     C                     OTHER                                          CEU012
     C           *IN53     IFEQ *ON                                       CEU012
     C                     Z-ADD1000000   FCT,X                           CEU012
     C/COPY WNCPYSRC,DL0150C017
     C                     ENDIF                                          CEU012
     C                     ENDSL                                          CEU012
     C/COPY WNCPYSRC,DL0150C022
      *                                                                   CEU012
     C                     ENDIF                                          CEU012
0191  *
     C                     Z-ADDX         INDEX   30
      *                                                                                       CDL014
      ** Check if 'XcludeIntFrmNetPostn' is ON                                                CDL014
     C                     CALL 'AOSVALR0'                                                    CDL014
     C                     PARM           @RTCD                                               CDL014
     C                     PARM SVALKK    SVALK1 20                                           CDL014
     C                     PARM           SVAL1 200                                           CDL014
     C                     PARM *BLANK    SVALK2 20                                           CDL014
     C                     PARM           SVAL2 200                                           CDL014
     C                     PARM *BLANK    SVALK3 20                                           CDL014
     C                     PARM           SVAL3 200                                           CDL014
     C                     PARM *BLANK    SVALK4 20                                           CDL014
     C                     PARM           SVAL4 200                                           CDL014
     C                     PARM *BLANK    SVALK5 20                                           CDL014
     C                     PARM           SVAL5 200                                           CDL014
     C                     PARM *BLANK    SVALK6 20                                           CDL014
     C                     PARM           SVAL6 200                                           CDL014
     C                     PARM *BLANK    SVALK7 20                                           CDL014
     C                     PARM           SVAL7 200                                           CDL014
     C                     PARM *BLANK    SVALK8 20                                           CDL014
     C                     PARM           SVAL8 200                                           CDL014
     C                     PARM *BLANK    SVALK9 20                                           CDL014
     C                     PARM           SVAL9 200                                           CDL014
     C                     PARM *BLANK    SVALK0 20                                           CDL014
     C                     PARM           SVAL10200                                           CDL014
     C           @RTCD     IFNE *BLANK                                                        CDL014
     C           *LOCK     IN   LDA                                                           CDL014
     C                     MOVEL'SDSVALPD'DBFILE                                              CDL014
     C                     MOVEL'07'      DBASE                                               CDL014
     C                     MOVELSVALKK    DBKEY                                               CDL014
     C                     OUT  LDA                                                           CDL014
     C                     SETON                     U7U8LR                                   CDL014
     C                     EXSR *PSSR                                                         CDL014
     C                     ENDIF                                                              CDL014
      *                                                                                       CDL014
     C           SVAL11    IFEQ 'Y'                                                           CDL014
     C                     MOVE 'Y'       CDL014  1                                           CDL014
     C                     MOVE *ON       *IN41                                               CDL014
     C                     ELSE                                                               CDL014
     C                     MOVE 'N'       CDL014                                              CDL014
     C                     MOVE *OFF      *IN41                                               CDL014
     C                     ENDIF                                                              CDL014
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0150CCP1                                           S01408
     C*                                                                   S01408
     C                     ENDSR
      *****************************************************************
      /EJECT                                                              CEU012
      *****************************************************************   CEU012
      * SREURO  -  Converting amounts to Euro equivalent amt.         *   CEU012
      * Called by: SRNBLD                                             *   CEU012
      * Calls    : EU0200                                             *   CEU012
      *****************************************************************   CEU012
      *                                                                   CEU012
     C           SREURO    BEGSR                                          CEU012
      *                                                                   CEU012
     C                     MOVE *BLANKS   PRTCD                           CEU012
     C                     MOVE PCCY      PFRCY                           CEU012
     C                     MOVE BKEURO    PTOCY                           CEU012
     C                     Z-ADD0         POUTA                           CEU012
     C                     Z-ADD0         PINTA                           CEU012
     C                     Z-ADD0         PEXRT                           CEU012
     C                     MOVE *BLANKS   PMDIN                           CEU012
      *                                                                   CEU012
     C                     CALL 'EU0200'               1111               CEU012
     C                     PARM           PRTCD   7                       CEU012
     C                     PARM           PFRAM  183                      CEU012
     C                     PARM           PFRCY   3                       CEU012
     C                     PARM           PTOCY   3                       CEU012
     C                     PARM           POUTA  150                      CEU012
     C                     PARM           PINTA  183                      CEU012
     C                     PARM           PEXRT  159                      CEU012
     C                     PARM           PMDIN   1                       CEU012
      *                                                                   CEU012
     C           PRTCD     IFNE *BLANKS                                   CEU012
     C                     MOVEL'*CALL   'DBFILE                          CEU012
     C                     MOVEL'EU0200  'DBKEY             ************  CEU012
     C                     Z-ADDWDBASE    DBASE             * DBERR NN *  CEU012
     C                     EXSR *PSSR                       ************  CEU012
     C                     END                                            CEU012
     C                     ENDSR                                          CEU012
      *                                                                   CEU012
      *****************************************************************   CEU012
0143  /EJECT
0389  *****************************************************************
0390  *
0391  *    Validation Of User Input.
0392  *
0393 C           SRNVAL    BEGSR
0392  *
     C                     MOVEA'000'     *IN,75           Scrn Errors
     C                     MOVE '0'       *IN37
     C                     MOVEA'000'     *IN,32
     C           SCIN      COMP *BLANK                   32
     C           SBRC      COMP *BLANK               3333
     C           SCMP      COMP *BLANK               3434
0392  *
0392  *    Establish If Entered Currency Exist If Control Array
      *                                                                   S01194
      ** PROCESS FOR USE OF '?'                                           S01194
     C           SCUC      IFEQ '?'                                       S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM *BLANKS   @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM SCUC      @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
      *                                                                   S01194
      ** RETURN SELECTED CCY TO THE SCREEN FIELD                          S01194
     C                     MOVELA6CYCD    SCUC                            S01194
     C                     END                                            S01194
     C                     END                                            S01194
      *
     C                     Z-ADD1         X
     C           SCUC      LOKUPXCY,X                    73
     C           *IN73     IFEQ '0'
     C           CEU012    IFEQ 'N'                                       CEU012
     C           CEU012    OREQ 'Y'                                       CEU012
     C           SCUC      ANDNEBKEUCP                                    CEU012
     C                     MOVE ERR,1     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'100'     *IN,75
     C                     GOTO SRNVL9
     C                     END                                            CEU012
     C                     END
      *
      *    If Multi Branch If  Y-YES' Perform Branch Validation
      *
     C           @MBIN     IFEQ 'Y'
      *
      *    Chech User Is Authorised To All Branches/Companies
      *
      *
     C********** SBRC      IFEQ *BLANK ********************               E28
     C********** SCMP      ANDEQ*BLANK ********************               E28
     C********** ZCHB      ANDNE'Y'    ********************               E28
     C           SBRC      IFEQ 'ALL'                                     E28
     C           ZCHB      ANDNE'Y'                                       E28
     C           SCMP      OREQ 'ALL'                                     E28
     C           ZCHB      ANDNE'Y'                                       E28
     C                     MOVE ERR,2     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'011'     *IN,75
     C                     GOTO SRNVL9
     C                     END
      *
      *    Branch And Company Must Be Entered
      *
     C           SBRC      IFNE *BLANK
     C           SCMP      ANDNE*BLANK
     C                     MOVE ERR,3     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'011'     *IN,75
     C                     GOTO SRNVL9
     C                     END
      *
      * If Branch Is Blank Default To Default User Branch                 E28
      *                                                                   E28
     C           *NAMVAR   DEFN           ZMUSER                          E28
     C                     IN   ZMUSER                                    E28
     C           SBRC      IFEQ *BLANK                                    E28
     C           SCMP      ANDEQ*BLANK                                    E28
     C                     MOVE ZDFB      SBRC                            E28
     C                     MOVE '1'       *IN30                           E112
     C                     END                                            E28
      *
      *    Check Branch Is Valid And User Is Authorised To Access Data
      *
     C           SBRC      IFNE *BLANK
     C           SBRC      ANDNE'ALL'                                     E28
      *
     C                     MOVE SBRC      ZBRCDX  3
      *    Access Branch Record.
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           ZBRCDX
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*************        PARM           SDBRCH
      *
     C           @RTCD     IFNE *BLANKS
     C                     MOVE ERR,4     ERRMSG           INVALID BRANCH
     C                     MOVE '1'       *IN37
     C                     MOVEA'010'     *IN,75
      *                  ========
     C                     ELSE
      *                  ========
      ** PROCESS FOR USE OF '?'
     C                     MOVELA8BRCD    ZBRCDX
     C                     MOVELA8BRCD    SBRC
      *    Call Security Profile Facility prog.
     C                     CALL 'ZVBBU'
     C                     PARM           ZBRCDX
     C                     PARM           @ERR    10
      *
     C           @ERR      IFEQ 1
0160 C                     MOVE ERR,8     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'010'     *IN,75
     C                     GOTO SRNVL9
     C                     END
      *
     C           @ERR      IFEQ 2
0160 C                     MOVE ERR,5     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'010'     *IN,75
     C                     GOTO SRNVL9
     C                     END
     C                     END
     C                     END
      *
      *    Check Company Is Valid And User Is Authorised To View Data
      *
     C           SCMP      IFNE *BLANK
     C           SCMP      ANDNE'ALL'                                     E28
      *
     C                     MOVE SCMP      ZCMPYX  3
0156  *    Access Company Record.
     C                     CALL 'AOCOMPR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           ZCMPYX
     C           SDCOMP    PARM SDCOMP    DSFDY
     C************         PARM           SDCOMP
      *
     C           @RTCD     IFNE *BLANKS
     C                     MOVE ERR,6     ERRMSG           INVALID COMPANY
     C                     MOVE '1'       *IN37
     C****                 MOVEA'010'     *IN,75                          E00044
     C                     MOVEA'001'     *IN,75                          E00044
      *                  ========
     C                     ELSE
      *                  ========
      ** PROCESS FOR USE OF '?'
     C                     MOVELAPCMCD    ZCMPYX
     C                     MOVELAPCMCD    SCMP
      *    Call Security Profile Facility prog.
     C                     CALL 'ZVCOU'
     C                     PARM           ZCMPYX
     C                     PARM           @ERR    10
      *
     C           @ERR      IFEQ 1
0160 C                     MOVE ERR,9     ERRMSG
     C                     MOVE '1'       *IN37
     C                     MOVEA'001'     *IN,75
     C                     GOTO SRNVL9
     C                     END
      *
     C           @ERR      IFEQ 2
0160 C                     MOVE ERR,7     ERRMSG           NOT AUTHORISED
     C                     MOVE '1'       *IN37
     C                     MOVEA'001'     *IN,75
     C                     END
     C                     END
     C                     END
      *
      *     If Branch Or Company ALL Reset To Blank
      *
     C           SBRC      IFEQ 'ALL'                                     E28
     C                     MOVE *BLANK    SBRC                            E28
     C                     END                                            E28
      *
     C           SCMP      COMP 'ALL'                    81               LN0541
     C           SCMP      IFEQ 'ALL'                                     E28
     C                     MOVE *BLANK    SCMP                            E28
     C                     END                                            E28
      *
     C                     END
      *
0404 C           SRNVL9    ENDSR
     C********************************************************************
      /EJECT                                                              CEU012
      *****************************************************************   CEU012
      * *PSSR  - Program exception error routine                      *   CEU012
      *          Called automatically if a program error occurs,      *   CEU012
      *          or directly by the program code using EXSR.          *   CEU012
      *          This subroutine DUMPs the program just once.         *   CEU012
      *****************************************************************   CEU012
     C           *PSSR     BEGSR                                          CEU012
      *                                                                   CEU012
     C                     MOVE '1'       *INU7                           CEU012
     C                     MOVE '1'       *INU8                           CEU012
      *                                                                   CEU012
     C           @RUN      IFEQ *BLANK                                    CEU012
     C                     MOVE 'Y'       @RUN    1                       CEU012
     C                     DUMP                                           CEU012
     C                     CALL 'DBERRCTL'                                CEU012
     C                     ENDIF                                          CEU012
      *                                                                   CEU012
     C                     MOVE '1'       *INLR                           CEU012
     C                     RETRN                                          CEU012
      *                                                                   CEU012
     C                     ENDSR                                          CEU012
      ********************************************************************CEU012
      /EJECT
     C********************************************************************
     C**  P/ZSPFB STD SR TO MAKE SPF USER/BKG.BRS AVAILABLE TO PGM
     C**    INPUT FROM EXT.DTAARA- ZBR1 & 2,UP TO 100 BRANCHES,TOP DOWN
     C**                           ZIN, INDEX OF LOWEST ENTRY FOR ARRAY
     C**    OUTPUT - ZBR  ARRAY, TOP DOWN
     C**             U, EQ ZIN
     C**
     C           ZSPFB     BEGSR                           **  ZSPFB **
     C           *NAMVAR   DEFN           ZBRU
     C                     IN   ZBRU
     C                     MOVEAZBR1      ZBR,1
     C                     MOVEAZBR2      ZBR,51
     C                     MOVE ZIN       U       30
      *                                                                                       197434
      ** Set up the array ZBR by branches in data areas ZBRU1 and ZBRU2                       197434
      *                                                                                       197434
     C           *NAMVAR   DEFN           ZBRU1                                               197434
     C                     IN   ZBRU1                                                         197434
     C                     Z-ADD101       W       30                                          197434
     C                     MOVEAZBR11     ZBR,W                                               197434
     C                     Z-ADD186       W                                                   197434
     C                     MOVEAZBR12     ZBR,W                                               197434
     C                     Z-ADD271       W                                                   197434
     C                     MOVEAZBR13     ZBR,W                                               197434
     C                     Z-ADD356       W                                                   197434
     C                     MOVEAZBR14     ZBR,W                                               197434
     C                     Z-ADD441       W                                                   197434
     C                     MOVEAZBR15     ZBR,W                                               197434
     C                     Z-ADD526       W                                                   197434
     C                     MOVEAZBR16     ZBR,W                                               197434
     C                     Z-ADD611       W                                                   197434
     C                     MOVEAZBR17     ZBR,W                                               197434
     C                     Z-ADD696       W                                                   197434
     C                     MOVEAZBR18     ZBR,W                                               197434
      *                                                                                       197434
     C           *NAMVAR   DEFN           ZBRU2                                               197434
     C                     IN   ZBRU2                                                         197434
     C                     Z-ADD767       W                                                   197434
     C                     MOVEAZBR21     ZBR,W                                               197434
     C                     Z-ADD852       W                                                   197434
     C                     MOVEAZBR22     ZBR,W                                               197434
      *                                                                                       197434
     C                     ENDSR
     C/COPY WNCPYSRC,DL0150C018
      /EJECT
     C/COPY WNCPYSRC,DL0150C019
     C*                                                                   063281
     C** For calculation of working days forward in particular            063281
     C** currency and location.                                           063281
     C*                                                                   063281
     C/COPY ZSRSRC,ZACCH                                                  063281
     C/COPY ZSRSRC,ZFWDT                                                  063281
0719 C********************************************************************
**       ERR - ERROR MESSAGES.
*      NEW/INVALID CURRENCY CODE         *
USER NOT AUTHORISED TO BANK LEVEL FUNCTION
 ERROR - BOTH BRANCH AND COMPANY ENTERED
*       INVALID BRANCH CODE              *
*   USER NOT AUTHORISED TO BRANCH        *
*       INVALID COMPANY CODE             *
*   USER NOT AUTHORISED TO COMPANY       *
*   USER NOT AUTHORISED TO ANY BRANCH    *
*   USER NOT AUTHORISED TO ANY COMPANY   *
     X/COPY WNCPYSRC,DL0150X001
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
