0001 H***********                                                         CDL006
     H        1                                                           CDL006
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deal amendments enquiry')                     *
      *****************************************************************
      *                                                               *
      *  Midas - Dealing Module                                       *
      *                                                               *
      *     DL0185 - DEAL AMENDMENTS ENQUIRY                          *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 248298             Date 21Jun07               *
      *                 249182             Date 24Jul07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL033             Date 04Jul05               *
      *                 221673             Date 04Jul05               *
      *                 BUG8057            Date 08Aug05               *
      *                 BUG8033            Date 30Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20May04               *
      *                 CDL022             Date 08Feb04               *
      *                 CDL020             Date 08Feb04               *
      *                 CDL017             Date 23Feb04               *
      *                 CAAA03             Date 22Apr04               *
      *                 BG2171             Date 01Sep03               *
      *                 CGL029             Date 01Sep03               *
      *                 CDL010             Date 02Aug02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 14Dec99               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU003             Date 05Nov97               *
      *                 S01408             DATE 30Sep96               *
      *                 S01408             DATE 23Aug96               *
     F*                 S01408             DATE 19AUG96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 081657             DATE 11JAN95               *
     F*                 047815             DATE 19JUN93               *
     F*                 S01311             DATE 14FEB91               *
     F*                 S01194             DATE 15AUG89               *
     F*                    S01117                    DATE 15/08/89       *S01117
     F*                    S01199                    DATE 08/03/89       *
0010 F*                                                                  *
      *****************************************************************
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhanced Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           Partially applied 245692 (Use Dealing ICD to format *
      *           amounts)                                            *
      *  248298 - Add the Window processing                           *
      *  249182 - Ensure that the negative sign for SC amendment is   *
      *           retained.                                           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  221673 - Display negative sign for SC deal amendment.        *
      *           Applied fix 220497.                                 *
      *  BUG8057 - Wrong Early Maturiy Date on Enquiry Screen         *
      *  BUG8033 - The Actual Interest Rate field has no decimal place*
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL022 - Deal Amendment Changes                              *
      *           Base Rate code for all deal Amendment Types         *
      *  CDL020 - Apply Base Rate at Value Date                       *
      *           Actual base rate for EM Record ==> *IN47            *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Dep/loans*
      *           Review DL0185FM buffer (use *IN46 + New Fields)     *
      *  CAAA03 - Webfacing Changes.                                  *
      *  BG2171 - Recompilations omitted by BUG1832                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in MMDEAMPP.*
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  CEU003 - EMU Dealing Settlement Ccy Conversion               *
     F*  S01408 - Core Hook DL0185CP13 Added                             *S01194
     F*  S01408 - Core Hook DL0185CCP9 Added                             *S01194
     F*         - Core Hook DL0185CP10 Added                             *S01194
     F*         - Core Hook DL0185CP11 Added                             *S01194
     F*         - Core Hook DL0185CP12 Added                             *S01194
     F*         - Core Hook DL0185EEP1 Added                             *S01194
     F*         - Core Hook DL0185EEP2 Added                             *S01194
     F*         - Core Hook DL0185FFP3 Added                             *S01194
     F*         - Core Hook DL0185FFP4 Added                             *S01194
     F*         - Core Hook DL0185IIP5 Added                             *S01194
     F*         - Core Hook DL0185IIP6 Added                             *S01194
     F*         - Core Hook DL0185OOP1 Added                             *S01194
     F*         - Core Hook DL0185OOP2 Added                             *S01194
     F*  S01408 - Core Hook DL0185CCP8 Added                             *S01194
     F*         - Core Hook DL0185CCP7 Added                             *S01194
     F*         - Core Hook DL0185CCP6 Added                             *S01194
     F*         - Core Hook DL0185CCP5 Added                             *S01194
     F*         - Core Hook DL0185CCP4 Added                             *S01194
     F*         - Core Hook DL0185CCP3 Added                             *S01194
     F*         - Core Hook DL0185CCP2 Added                             *S01194
     F*         - Core Hook DL0185CCP1 Added                             *S01194
     F*         - Core Hook DL0185FFP2 Added                             *S01194
     F*         - Core Hook DL0185FFP1 Added                             *S01194
     F*         - Core Hook DL0185IIP4 Added                             *S01194
     F*         - Core Hook DL0185IIP3 Added                             *S01194
     F*         - Core Hook DL0185IIP2 Added                             *S01194
     F*         - Core Hook DL0185IIP1 Added                             *S01194
     A*  CAC001 - Profit Centre Accounting Development:             *
     A*           Display new field 'Funding Rate/Spread' for       *
     A*           Spread Rate deal amendments if Analytical         *
     A*           Accounting is switched on.                        *
     F*  081657 - When deciding upon which settlement instruction type*  *
     F*           to display, no consideration is made to amendment   *
     F*           type itself. Processing added is same as MM0081,    *
     F*           subroutine #ZB                                      *
     F*  047815 - Deal amendments entered but not yet authorised are  *
     F*           not shown in enquiry.                               *
     F*           FIX:  Use MMDEAMLL instead of DEAMS                 *
     F*           REOPEN DETAILS:  Settlements instruction shown is   *
     F*           for 00 settlements as DEALSDC/SETP was the one      *
     F*           used.  Use settlement from MMDEAMPP instead.        *
     F*           Note:  DEAM was not yet authorised, DEAMSDI does    *
     F*           not contain the rec yet                             *
     F*     S01311  -  Amended to allow linked enquiry for Exposure      *
     F*                Management Release 10                             *
     F*                                                                  *
     F*     S01194  -  STANDING DATA CHANGES.                            *S01194
0010 F*                                                                  *S01194
     F*     S01117  -  MULTIBRANCHING                                    *S01117
0010 F*                                                                  *S01117
0010 F*     S01199  -  HELP SYSTEM.                                      *
0010 F*                                                                  *S01117
0011 F********************************************************************
0015 F*L0185FMCF  F     309            WORKSTN      KPASS  *NOIND         S01117
     F/COPY WNCPYSRC,DL0185FFP3                                           S01408
     F***DL0185FMCF**F     313            WORKSTN      KPASS  *NOINS01117 CAC001
     F***DL0185FMCF**F     328            WORKSTN      KPASS  *NOINCAC001 CEU003
     F***DL0185FMCF**F     335            WORKSTN      KPASS  *NOINCEU003 CDL006
     F***DL0185FMCF  F     448            WORKSTN      KPASS  *NOIND                   CDL006 CGL029
     F*DL0185FMCF*F**** 454            WORKSTN      KPASS  *NOIND                      CGL029 CDL017
     F*DL0185FMCF*F**** 464            WORKSTN      KPASS  *NOIND                      CDL017 CDL020
     F*DL0185FMCF*F**** 477            WORKSTN      KPASS  *NOIND                     CDL020 BUG8057
     F*DL0185FMCF*F**** 478            WORKSTN      KPASS  *NOIND                     BUG8057 CER043
     FDL0185FMCF  F     489            WORKSTN      KPASS  *NOIND                             CER043
     F/COPY WNCPYSRC,DL0185FFP4                                           S01408
0016 F*
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0185FFP1                                           S01408
     F*                                                                   S01408
     F***DEAMS   IF  F     837 14AI     2 DISK                     CAC001 CDL006
     F***DEAMS** IF  F     877 14AI     2 DISK                                         CDL006 CGL029
     F*DEAMS**IF**F**** 933 14AI     2 DISK                                            CGL029 CDL017
     F*DEAMS**IF**F**** 959 14AI     2 DISK                                            CDL017 CDL020
     FDEAMS   IF  F     965 14AI     2 DISK                                                   CDL020
     F*                                                                   S01408
0017 F***DEAMS***IF  F     200 14AI     2 DISK                            CAC001
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0185FFP2                                           S01408
     F*                                                                   S01408
     FMMDEAMLLIF  E           K        DISK                               047815
0018 F*LINT   IF  F     256  7AI     2 DISK                       *****   S01194
0019 F*ABLE   IF  F      96 12AI     2 DISK                       *****   S01194
     F***DEALS** IF  F     500  6AI     2 DISK                                         S01117 CGL029
     F***DEALS   IF  F    2325  6AI     2 DISK                                         CGL029 CDL022
     FDEALS   IF  F    2540  6AI     2 DISK                                                   CDL022
0020 F/EJECT
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F* 01            WORKSTN FILE
0023 F* 02            DEAMS- LIVE DETAIL
0024 F**03*           CLINT                                       *****   S01194
0025 F**04*           TABLE                                       *****   S01194
0026 F* 05            CURRENCIES RECORD 1
0013 F* 06   USED TO CONDITION FIRST TIME PASS THROUGH RPG CALC CYCLE   *
0014 F* 07   SET ON IF ERROR DURING READ FROM THE WORK STATION          *
     F* 08   Set On if CEU003 is supported via AOSARDR0                   CEU003
0028 F*    10         BASE RATE TYPE ZERO
0029 F*    11         RATE/SPREAD ZERO
     F*       19      BRANCH CODE ON RELATED DEAL INVALID FOR THIS USER   S01117
0030 F*       20      DEAL NO. NOT NUMERIC
0031 F*       22      SEQUENCE NO.NOT MORE THAN ZERO OR NOT NUMERIC
0032 F*       23      CHAIN FAIL TO DEAMS OR RECORD EXPIRED
0033 F*       24      CHAIN FAIL TO CLINT
0034 F*       25      CHAIN FAIL TO CURRENCIES 1    TABLE,TG
0035 F*       26      0 DEC.POS.
0036 F*       27      1 DEC.POS.
0037 F*       28      2 DEC.POS.
0038 F*       29      3 DEC.POS.
     F*       30      Analytical Accounting is on.                        CAC001
     F*       31      Interest Spread/Rate Flag = 'Y' for 'SC' Amendmnt   CAC001
     F*       32      Funding  Spread/Rate Flag = 'Y' for 'SC' Amendmnt   CAC001
     F*       33      Funding Spread Rate = 0                             CAC001
0039 F*       43      NOT AN ERROR
0040 F*       44      INHIBITS DETAIL OUTPUT FOR SCREEN
0040 F*       46      CDL017 - Deal Amendment type EM for IT, TD, IP, TI  CDL017
0040 F*       47      CDL020 is activated                                 CDL020
     F*       50      PGM CALLED AS LINKED ENQ & FIRST TIME IN            S01311
     F*       51      PROGRAM CALLED AS A LINKED ENQUIRY                  S01311
     F*       52      CHAIN FAILURE ON DEALS FILE                         S01311
0041 F*       60      SUCCESSFUL LOKUP FOR AMENDMENT TYPE
0042 F*       99      VALUE DATE NOT A VALID DATE
0043 E/EJECT
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,DL0185EEP1                                           S01408
0044 E******************* TABLET  1   5  2   TABTYP 23    AMTYPE TABLE                        CDL022
0044 E                    TABLET  1   7  2   TABTYP 23    AMTYPE TABLE                        CDL022
     E/COPY WNCPYSRC,DL0185EEP2                                           S01408
0047 E*
0048 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0049 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0050 E**
0051 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E*
     E                    TABNUM 11  11  2 0             SETTLEMENT CODES
     E                    TABSIN  1  11 20               SETTLEMENT INSTR
     E                    @YD     4   4  5 0A                             047815
     E*                                                                   047815
     E**  Array for SR. ZA0710 - Cumulative days in year for 4 year       047815
     E**  period                                                          047815
     E*                                                                   047815
     E                    @MD    13  13  5 0A                             047815
     E*                                                                   047815
     E**  Array for SR. ZA0710 - Cumulative days in year per month        047815
0045 E*
0046 E                    MSGR        4  4                MESSAGES ARRAY
     E*
     E/COPY ZSRSRC,ZSEDITZ1                                                                   CER043
0052 E/EJECT
0053 I**DL0185FMNS**01   2 C0   3 C0                                      S01199
     I****************************************1   1 *IN07                 S01199
0054 I****************************************4   9 DLNUM                 S01199
0055 I***************************************10  15 VDATE                 S01199
0056 I***************************************16  18 DASN1                 S01199
0053 IDL0185FMNS  01   1 C0   2 C0                                        S01199
0054 I                                        3   8 DLNUM                 S01199
0055 I                                        9  14 VDATE                 S01199
0056 I                                       15  17 DASN1                 S01199
0057 I*    CATCHALL
0058 I        NS
0059 I*
0060 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0061 I*
0062 I*DEAMS***NS  02   1 CD                                              047815
0063 I*******OR   05   1 CR                                               047815
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0185IIP2                                           S01408
     I*                                                                   S01408
     IDEAMS   NS                                                          047815
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0185IIP3                                           S01408
     I*                                                                   S01408
0064 I                                        1   1 RECI
0065 I                                        2   70DLNO
0066 I                                        8  120VDAT
0067 I                                       13  150DASN
0068 I                                       16  17 DTYP
0069 I                                       18  19 DLST
0070 I                                       20  21 AMTP
0071 I                                       22  220PSEQ
0072 I**********                             23  240BRTT            10                        CSD103
0072 I                                       23  24 BRTT            10                        CSD103
0073 I                                    P  25  307RTSP            11
0074 I                                       31  33 CCY
0075 I                                    P  34  400DAAM
0076 I                                       41  41 MOGI
0077 I**********                             42  470CNUM                                      CSD027
0077 I                                       42  47 CNUM                                      CSD027
0078 I                                       48  490SETP
0079 I**********                             50  61 OSAC                                      CGL029
     I                                       50  61 OSACQQ                                    CGL029
0080 I                                       62  71 TSEN
0081 I                                       72  81 FACO
0082 I                                       82 116 SPI
     I                                      117 119 OSBR                  S01117
0083 I                                    P 139 1410NAAD
0084 I                                      142 1440NASN
0085 I                                      145 145 DAIN
0086 I                                    P 191 1930ORED
0087 I                                    P 194 1960LCD
0088 I                                      197 197 CHTP
0089 I                                    P 198 2000TNLU
     I                                    P 830 8357FSRP            33    CAC001
     I                                      836 836 IRCF                  CAC001
     I                                      837 837 FRCF                  CAC001
     I                                      844 845 FCGC                  CDL006
     I                                      846 865 FCGD                  CDL006
     I                                    P 866 8720FCGA                  CDL006
     I                                    P 873 8770FCGT                  CDL006
     I                                      880 897 OSAC                                      CGL029
     I                                      934 934 PENLTY                CDL017
     I                                    P 935 9370EMDAT                 CDL017
     I                                    P 958 9630BRTE                  CDL020
0090 I*
0091 I*
0092 I*****CATCHALL                                                       047815
0093 I********NS                                                          047815
     I*                                                                   047815
     IMMDEAMP0                                                            047815
     I              HNDA38                          DLNO                  047815
     I              HNCCY                           CCY                   047815
     I              HNDS38                          DASN                  047815
     I              HNMTYP                          AMTP                  047815
     I              HNINTR                          RTSP            11    047815
     I              HNCNUM                          CNUM                  047815
     I              HNSTCY                          STCY                  CEU003
     I              HNIC72                          IC72                  CEU003
     I/COPY WNCPYSRC,DL0185IIP5                                           S01408
     I              HNFSRP                          FSRP            33    CAC001
     I              HNIRCF                          IRCF                  CAC001
     I              HNFRCF                          FRCF                  CAC001
     I/COPY WNCPYSRC,DL0185I001
      * TAKE MMDEAMP0 Details to show same as API                         CDL017
     I              HNPENP                          PENLTY                CDL017
     I              HNEMDT                          EMDAT                 CDL017
0094 I*****                                                       *****   S01194
0095 I*****                                                       *****   S01194
0096 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.           *****   S01194
0097 I*****                                                       *****   S01194
0098 I*LINT   NS  03   1 CD   8 CA                                *****   S01194
0099 I*****                                   1   1 RECI          *****   S01194
0100 I*****                                   2   70CNUM          *****   S01194
0101 I*****                                   8   8 RCDT          *****   S01194
0102 I*****                                   9  28 CRNM          *****   S01194
0103 I*****                                  29  38 CTWN          *****   S01194
0104 I*****                                  39  48 CSNM          *****   S01194
0105 I*****                                  49  56 CASK          *****   S01194
0106 I*****                                  57  68 TELX          *****   S01194
0107 I*****                                  69  80 CSID          *****   S01194
0108 I*****                                  81  82 ACOC          *****   S01194
0109 I*****                                  83  83 CBSI          *****   S01194
0110 I*****                                  84  85 CCTZ          *****   S01194
0111 I*****                                  86  87 CLOC          *****   S01194
0112 I*****                                  88  930CPAR          *****   S01194
0113 I*****                                  94  960BRCD          *****   S01194
0114 I*****                                  97  980LINS          *****   S01194
0115 I*****                                  99 1010LIND          *****   S01194
0116 I*****                               P 102 1040DASU          *****   S01194
0117 I*****                               P 105 1070CDIC          *****   S01194
0118 I*****                               P 108 1100DADE          *****   S01194
0119 I*****                                 111 111 CMIN          *****   S01194
0120 I*****                                 112 112 CTYP          *****   S01194
0121 I*****                                 113 124 TELF          *****   S01194
0122 I*****                                 125 133 CHID          *****   S01194
0123 I*****                                 134 136 CHAB          *****   S01194
0124 I*****                               P 250 2520LCD           *****   S01194
0125 I*****                                 253 253 CHTP          *****   S01194
0126 I*****                               P 254 2560TNLU          *****   S01194
0127 I*****                                                       *****   S01194
0128 I*****                                                       *****   S01194
0129 I*****CATCHALL                                               *****   S01194
0130 I*****   NS                                                  *****   S01194
     I*****                                                       *****   S01194
     I*                                                                   S01117
     I*    DEALS FILE                                                     S01117
     I*                                                                   S01117
     IDEALS   NS                                                          S01117
     I                                        8   8 RCDTD                 S01117
     I                                       17  19 BRCA                  S01117
     I                                      162 164 EORBR                 S01117
     I                                      401 403 ORBR                  S01117
0131 I*****                                                       *****   S01194
0132 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0133 I*****                                                       *****   S01194
0134 I*ABLE   NS  04   2 C0   3 C1  12 C1                         *****   S01194
0135 I*****  AND      13 C0                                       *****   S01194
0136 I*****                                   1   1 RECI          *****   S01194
0137 I*****                                   2   30RECT          *****   S01194
0138 I*****                                  12  130RCDE          *****   S01194
0139 I*****                                  14  66 TITL          *****   S01194
0140 I*****                                  67  67 DATF          *****   S01194
0141 I*****                                  68  700DFBR          *****   S01194
0142 I*****                                  74  74 MODI1         *****   S01194
0143 I*****                                  75  75 MODI2         *****   S01194
0144 I*****                                  76  76 MODI3         *****   S01194
0145 I*****                               P  77  790RUND          *****   S01194
0146 I*****                                  80  86 RUNA          *****   S01194
0147 I*****                                  87  870SFLG          *****   S01194
0148 I*****                               P  90  920LCD           *****   S01194
0149 I*****                                  93  93 CHTP          *****   S01194
0150 I*****                               P  94  960TNLU          *****   S01194
     I*****                                                       S01117  S01194
     I*****                                                       S01117  S01194
     I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.       S01117  S01194
     I*****                                                       S01117  S01194
     I*ABLE   NS       1 CD   2 C0   3 C1                         S01117  S01194
     I*****  AND      12 C1  13 C1                                S01117  S01194
     I*****                                   1   1 RECI          S01117  S01194
     I*****                                  53  53 MBIN          S01117  S01194
     I*****                                                       S01117  S01194
     I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       S01117  S01194
     I*****                                                       S01117  S01194
     I*ABLE   NS       1 CD   2 C0   3 C1                         S01117  S01194
     I*****  AND      12 C4  13 C0                                S01117  S01194
     I*****                                   1   1 RECI          S01117  S01194
     I*****                                  62  62 OBUV          S01117  S01194
0151 I*****                                                       *****   S01194
0152 I*****                                                       *****   S01194
0153 I*****TABLE FILE - CURRENCIES RECORD 1.                      *****   S01194
0154 I*****                                                       *****   S01194
0155 I*ABLE   NS  05   1 CD   2 C2   3 C0                         *****   S01194
0156 I*****  AND      13 C1                                       *****   S01194
0157 I*****                                   1   1 RECI          *****   S01194
0158 I*****                                   2   30RECT          *****   S01194
0159 I*****                                  10  12 CCY           *****   S01194
0160 I*****                                  13  130SREC          *****   S01194
0161 I*****                                  14  27 CCNM          *****   S01194
0162 I*****                               P  28  348SPOT          *****   S01194
0163 I*****                                  35  37 CCYS          *****   S01194
0164 I*****                                  38  380CDP           *****   S01194
0165 I*****                                  39  390TNOT          *****   S01194
0166 I*****                                  40  40 DCCY          *****   S01194
0167 I*****                                  41  44 SRC1          *****   S01194
0168 I*****                                  45  48 SRC2          *****   S01194
0169 I*****                                  49  520TACC          *****   S01194
0170 I*****                                  53  560TEQV          *****   S01194
0171 I*****                                  57  600SWQV          *****   S01194
0172 I*****                                  61  640TAC4          *****   S01194
0173 I*****                                  65  680TAC5          *****   S01194
0174 I*****                                  69  69 HIND          *****   S01194
0175 I*****                               P  70  768PART          *****   S01194
0176 I*****                                  77  780SSNO          *****   S01194
0177 I*****                               P  79  858ERLC          *****   S01194
0178 I*****                               P  90  920LCD           *****   S01194
0179 I*****                                  93  93 CHTP          *****   S01194
0180 I*****                               P  94  960TNLU          *****   S01194
0181 I*****                                                       *****   S01194
0182 I*****                                                       *****   S01194
0183 I*****CATCHALL                                               *****   S01194
0184 I*****   NS                                                  *****   S01194
0185 I*****                                                       *****   S01194
     I**
     I/COPY WNCPYSRC,DL0185IIP6                                           S01408
      *                                                                   CDL006
      ** Local data area for database error details                       CDL006
      *                                                                   CDL006
     ILDA         DS                            256                       CDL006
     I                                      134 183 DBLOT                 CDL006
     I                                      134 141 DBFILE                CDL006
     I                                      142 170 DBKEY                 CDL006
     I                                      171 180 DBPGM                 CDL006
     I                                      181 1830DBASE                 CDL006
     ISDBANK    E DSSDBANKPD                                              S01194
     I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
     I*                                                                   S01194
     ISDGELR    E DSSDGELRPD                                              S01194
     I* GENERAL LEDGER DETAILS ACCESSED VIA ACCESS PROGRAM                S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I* CUSTOMER DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              CAC001
     I** MIDAS MODULES DETAILS                                            CAC001
     I*                                                                   CAC001
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01408
     ISCSARD    E DSSCSARDPD                                              CEU003
      **  External data structures for Switchable Features Details        CEU003
     ISDDEAL    E DSSDDEALPD                                                                  CER043
     I              QQACCD                          QQDACC                                    CER043
      ** External DS for DEALING Details                                                      CER043
      ***                                                                                     CER043
     I/COPY WNCPYSRC,DL0185IIP1                                           S01408
     I*                                                                   S01408
     I*                                                                   S01194
     I**   RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE.
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I**
     IRUNDAT      DS                                                      S01194
     I** DATA STRUCTURE FOR MULTIBRANCH INDICATOR USING RUNDAT.           S01194
     I                                       13  13 @MBIN                 S01194
     IDLSDS     E DSDLDTA                                                 S01311
      *  Data structure for linked enquiry                                S01311
     I*                                                                   047815
     I            DS                                                      047815
     I*                                                                   047815
     I**  Data structure for SR. ZA0710 - field is @@Z71Y                 047815
     I*                                                                   047815
     I                                        1   40@@Z71Y                047815
     I                                        1   10@@SSY1                047815
     I                                        2   20@@SSY2                047815
     I                                        3   30@@SSY3                047815
     I                                        4   40@@SSY4                047815
     I            DS                                                      047815
     I*                                                                   047815
     I**  Data structure for SR. ZA0710 - field is @@VDT                  047815
     I*                                                                   047815
     I                                        1   80@@VDT                 047815
     I                                        1   40@@YR                  047815
     I                                        5   60@@Z71M                047815
     I                                        7   80@@Z71D                047815
     I/COPY ZSRSRC,ZSEDITZ2                                                                   CER043
     I*                                                                   S01408
     I/COPY WNCPYSRC,DL0185IIP4                                           S01408
     I*                                                                   S01408
     I*                                                                   047815
     I* Define the data structure to pass data to WN0010 and return pgm                       248298
     I*                                                                                       248298
     I/COPY QWINDSRC,DL0185DTA                                                                248298
     I/EJECT
     C**
     C** GET MULTI BRANCH INDICATOR FROM DATA AREA - RUNDAT               S01194
     C           *NAMVAR   DEFN           RUNDAT                          S01194
     C                     IN   RUNDAT                                    S01194
      *                                                                   CDL006
      ** Dataarea LDA                                                     CDL006
      *                                                                   CDL006
     C           *NAMVAR   DEFN           LDA                             CDL006
      *                                                                   S01311
      * Retrieve data area to determine if called as a linked enquiry     S01311
      *                                                                   S01311
     C           *NAMVAR   DEFN           DLSDS                           S01311
     C                     IN   DLSDS                                     S01311
     C                     MOVE RQDTD     FXMMDL  2                       S01311
      *                                                                   CDL006
      ** Prepare LDA                                                      CDL006
      *                                                                   CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     MOVEL*BLANK    DBLOT                           CDL006
     C                     MOVEL'DL0185'  DBPGM                           CDL006
     C                     OUT  LDA                                       CDL006
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP1                                           S01408
     C*                                                                   S01408
      *                                                                   S01311
     C                     EXSR HELPSR                     ** HELPSR **
      *                                                                   CDL006
      ** Reset Indicators for the next processing.                        CDL006
      *                                                                   CDL006
     C           HNOMDT    IFEQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE '1'       *IN44                           CDL006
     C                     MOVE '0'       *IN45                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL017
      ***  CDL017 - Ensure *IN46 is set off                               CDL017
      *                                                                   CDL017
     C                     SETOF                     46                   CDL017
0187 C*    RESET INDICATORS
0189 C  N06                SETON                     06
0190 C                     SETOF                     07
0191 C                     SETON                     4344
     C                     SETOF                     19                   S01117
0192 C                     SETOF                     202399
0193 C*
0194 C*    FIRST CYCLE CALCS.
0195 C   01                GOTO NOTFC
0196 C*
0197 C*
     C                     MOVEACPY@      BIS@   80
0198 C*    GET DATE FORMAT
0199 C*****                EXSR ZSYSTM                            *****   S01194
0200 C*****                                                       *****   S01194
     C*****                                                       S01117  S01194
     C****OBTAIN MULTIBRANCH IND.                                 S01117  S01194
     C*****                MOVE *BLANKS   ZTABKY                  S01117  S01194
     C*****                MOVEL'01'      ZTABKY                  S01117  S01194
     C*****                MOVE '11'      ZTABKY                  S01117  S01194
     C*****      ZTABKY    CHAINTABLE                99           S01117  S01194
     C**                                                          S01117  S01194
     C**  OBTAIN ORIGINATING BRANCH VALIDATION FLAG               S01117  S01194
     C**                                                          S01117  S01194
     C*****                MOVE *BLANKS   ZTABKY                  S01117  S01194
     C*****                MOVEL'01'      ZTABKY                  S01117  S01194
     C*****                MOVE '40'      ZTABKY                  S01117  S01194
     C*****      ZTABKY    CHAINTABLE                99           S01117  S01194
     C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*
     C* CALL ACCESS PROG. FOR GENERAL LEDGER DETAILS.                     S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
      *                                                                                       CER043
      *  Retrieve DEALING ICD details                                                         CER043
      *                                                                                       CER043
     C                     CALL 'AODEALR1'                                                    CER043
     C                     PARM '*DBERR ' @RTCD   7                                           CER043
     C                     PARM '*FIRST ' @OPTN   7                                           CER043
     C           SDDEAL    PARM SDDEAL    DSFDY                                               CER043
      *                                                                   CEU003
      ** Access Switchable Feature Details                                CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   PRTCD   7                       CEU003
     C                     PARM '*VERIFY 'POPTN   7                       CEU003
     C                     PARM 'CEU003'  PSARD   6                       CEU003
     C           SCSARD    PARM SCSARD    DSSDY                           CEU003
      *                                                                   CEU003
     C           PRTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     MOVE '1'       *IN08                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     MOVE '0'       *IN08                           CEU003
     C                     ENDIF                                          CEU003
      *                                                                   CDL006
      ** Access Switchable Feature Details, Check if CDL006 is            CDL006
      ** switch on.                                                       CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD                           CDL006
     C                     PARM '*VERIFY 'POPTN                           CDL006
     C                     PARM 'CDL006'  PSARD                           CDL006
     C           SCSARD    PARM SCSARD    DSSDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     ELSE                                           CDL006
     C           PRTCD     IFNE '*NRF '                                   CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     Z-ADD001       DBASE            ***************CDL006
     C                     MOVEL'SCSARDPD'DBFILE           **DB ERROR 001*CDL006
     C                     MOVELPSARD     DBKEY            ***************CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDE002
      ** Access SAR details file to determine if CDE002 is switched on    CDE002
      *                                                                   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   PRTCD   7                       CDE002
     C                     PARM '*VERIFY' POPTN   7                       CDE002
     C                     PARM 'CDE002'  PSARD   6                       CDE002
     C           SCSARD    PARM SCSARD    DSFDY                           CDE002
      *                                                                   CDE002
     C                     MOVE 'N'       CDE002  1                       CDE002
     C           PRTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002                          CDE002
     C                     ENDIF                                          CDE002
      *                                                                   CDL020
      ** Verify if CDL020 is Enabled                                      CDL020
      *                                                                   CDL020
     C                     CALL 'AOSARDR0'                                CDL020
     C                     PARM *BLANKS   PRTCD                           CDL020
     C                     PARM '*VERIFY 'POPTN                           CDL020
     C                     PARM 'CDL020'  PSARD                           CDL020
      *                                                                   CDL020
     C                     MOVE *OFF      *IN47            = CDL020       CDL020
     C           PRTCD     IFEQ *BLANKS                                   CDL020
     C                     MOVE *ON       *IN47                           CDL020
     C                     ENDIF                                          CDL020
      *                                                                                       CDL033
      ** Check if CDL033 is on                                                                CDL033
      *                                                                                       CDL033
     C                     MOVE 'N'       CDL033                                              CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   PRTCD                                               CDL033
     C                     PARM '*VERIFY 'POPTN                                               CDL033
     C                     PARM 'CDL033'  PSARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSSDY                                               CDL033
      *                                                                                       CDL033
     C           PRTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033  1                                           CDL033
     C                     ELSE                                                               CDL033
     C           PRTCD     IFNE '*NRF '                                                       CDL033
     C           *LOCK     IN   LDA                                                           CDL033
     C                     Z-ADD002       DBASE                                               CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVELPSARD     DBKEY                                               CDL033
     C                     OUT  LDA                                                           CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CER043
      ** Access AOSARDR0 and check if CER043 is installed                                     CER043
      *                                                                                       CER043
     C                     CALL 'AOSARDR0'                                                    CER043
     C                     PARM *BLANKS   PRTCD                                               CER043
     C                     PARM '*VERIFY' POPTN                                               CER043
     C                     PARM 'CER043'  PSARD                                               CER043
     C           SCSARD    PARM SCSARD    DSFDY                                               CER043
      *                                                                                       CER043
     C           PRTCD     IFEQ *BLANKS                                                       CER043
     C                     MOVEL'Y'       CER043  1                                           CER043
     C                     MOVE *OFF      *IN48                                               CER043
     C                     ELSE                                                               CER043
     C                     MOVEL'N'       CER043                                              CER043
     C                     MOVE *ON       *IN48                                               CER043
     C                     ENDIF                                                              CER043
      *                                                                                       CER043
     C           PRTCD     IFNE *BLANKS                                                       CER043
     C           PRTCD     ANDNE'*NRF    '                                                    CER043
     C           *LOCK     IN   LDA                                                           CER043
     C                     MOVE 'SCSARDPD'DBFILE                                              CER043
     C                     MOVEL'003'     DBASE                                               CER043
     C                     MOVEL'CER043'  DBKEY                                               CER043
     C                     OUT  LDA                                                           CER043
     C                     EXSR *PSSR                                                         CER043
     C                     ENDIF                                                              CER043
      *                                                                                       CER043
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP2                                           S01408
     C*                                                                   S01408
0829 C**   I.E. IND 98 ON IF DATE FORMAT IND = 'M'                        S01194
0829 C           BJDFIN    COMP 'M'                      98               S01194
      *                                                                   CAC001
      ** Call access program for Midas modules details                    CAC001
      *                                                                   CAC001
     C                     CALL 'AOMMODR0'                                CAC001
     C                     PARM '*DBERR ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C                     MOVE '1'       *IN30                           CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN30                           CAC001
     C                     END                                            CAC001
0384 C*
0201 C*    OUTPUT INITIAL SCREEN
0202 C                     SETON                     01
     C/COPY WNCPYSRC,DL0185CP12                                           S01408
      *                                                                   S01311
      * If called as a linked enquiry move contents of DLSDS data area    S01311
      * into relevant fields                                              S01311
      *                                                                   S01311
     C           FXMMDL    IFNE *BLANKS                                   S01311
     C                     MOVELRQDTD     DNDAT  14                       S01311
     C                     MOVELDNDAT     DNDAT2 11                       S01311
     C                     MOVELDNDAT2    DLNUM                           S01311
     C                     MOVE DNDAT2    ZDAYNO                          S01311
     C                     MOVE DNDAT     DASN1                           S01311
     C*                                                                   047815
     C** Convert value date to YYYYMMDD format                            047815
     C*                                                                   047815
     C                     Z-ADDZDAYNO    @@DAYN  50                      047815
     C                     EXSR ZA0710                                    047815
     C*                                                                   047815
     C                     SETON                     5051                 S01311
     C                     GOTO NOTFC                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
0204 C*
0205 C*    SKIP REST OF CALCS.THIS CYCLE
0206 C                     GOTO END
0207 C*
0208 C*    DETAIL CALCULATIONS
0209 C           NOTFC     TAG                             ** NOTFC TAG **
0210 C*
0211 C*****IF*CMD/3*GO*TO*END                                             S01311
0212 C***KC*******         SETON                     LR                   S01311
0213 C***KC*******         GOTO END                                       S01311
     C/COPY WNCPYSRC,DL0185C002
      *                                                                   S01311
      * Validate command keys                                             S01311
      *                                                                   S01311
     C                     EXSR CMD                                       S01311
0214 C*
0215 C*
0216 C*    VALIDATE INPUT DATA
0217 C*
0218 C*    DEAL NO. MUST BE NUMERIC
0219 C                     MOVELDLNUM     WORK1   70
0220 C                     MOVELWORK1     WORK2   6
0221 C           DLNUM     COMP WORK2                2020
0222 C*
0223 C*
0224 C*    VALUE DATE MUST BE A VALID DATE
     C           *IN50     IFNE '1'                                       S01311
0225 C                     MOVE VDATE     ZDATE
0226 C                     EXSR ZDATE1
     C*                                                                   047815
     C** Convert value date to YYYYMMDD format                            047815
     C*                                                                   047815
     C                     Z-ADDZDAYNO    @@DAYN                          047815
     C                     EXSR ZA0710                                    047815
     C*                                                                   047815
     C                     END                                            S01311
     C                     SETOF                     50                   S01311
0227 C*
0228 C*
0229 C*    SEQUENCE NO. MUST BE NUMERIC
0230 C                     MOVELDASN1     WRK4    40
0231 C                     MOVELWRK4      WRK3    3
0232 C           DASN1     COMP WRK3                 2222
0233 C*    SEQUENCE NO. MUST BE GREATER THAN 0
0234 C  N22      WRK4      COMP 0                      2222
0235 C*
0236 C*    IF ANY ERRORS AT THIS STAGE SKIP TO ERROR MESSAGES
0237 C   20
0238 COR 99
0239 COR 22                GOTO ERROR
0240 C*
0241 C*    CHAIN TO DEAL AMENDMENTS FILE
0242 C                     MOVELDLNUM     WORK3  11
0243 C                     MOVE ZDAYNO    WORK3
0244 C                     MOVELWORK3     KEY    14
0245 C                     MOVE DASN1     KEY
     C                     MOVE DLNUM     @DLNO   60                      047815
     C                     MOVE DASN1     @DASN   30                      047815
     C/COPY WNCPYSRC,DL0185CCP9                                           S01408
0246 C***********KEY       CHAINDEAMS                23                   047815
     C                     SETOF                     10                   047815
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP6                                           S01408
     C*                                                                   S01408
     C           KEY       CHAINDEAMS                02                   047815
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP8                                           S01408
     C*                                                                   S01408
     C*                                                                   047815
     C           KEY1      KLIST                                          047815
     C                     KFLD           @DLNO                           047815
     C                     KFLD           @@YR                            047815
     C                     KFLD           @@Z71M                          047815
     C                     KFLD           @@Z71D                          047815
     C                     KFLD           @DASN                           047815
     C*                                                                   047815
     C           KEY1      CHAINMMDEAMLL             23                   047815
     C*                                                                   047815
     C                     Z-ADDHNAMNP    DAAM                            047815
     C                     MOVE DAAM      ZFLD15                                              CER043
     C   26                Z-ADD0         ZDECS                                               CER043
     C   27                Z-ADD1         ZDECS                                               CER043
     C   28                Z-ADD2         ZDECS                                               CER043
     C   29                Z-ADD3         ZDECS                                               CER043
     C                     MOVE 'J'       ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDDAAM 17                                           CER043
      *                                                                                       CER043
     C*                                                                   047815
     C           HNDDLT    IFEQ 'D'                                       047815
     C                     SETON                     05                   047815
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP7                                           S01408
     C*                                                                   S01408
     C                     END                                            047815
     C*                                                                   047815
     C           *IN02     IFEQ '1'                                       047815
     C                     SETON                     10                   047815
     C                     END                                            047815
     C*                                                                   047815
0247 C*    CHECK WE HAVEN'T CHAINED TO A DELETED RECORD
0248 C*
0249 C*    IS RECORD REVERSED
0250 C   05                MOVEA'REVERSED'MSGR
     C   05                MOVEL'  REVERS'WK10A  10
     C   05                MOVE 'ED'      WK10A
     C   05                MOVELWK10A     MSG
0251 C   05                SETOF                     43
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP3                                           S01408
     C*                                                                   S01408
0252 C*    IF CHAIN FAILED OR CHAINED A DELETED RECORD SO ERROR SITUATION.
0253 C   23                GOTO ERROR
     C*                                                                   S01117
     C*    CHAIN DEALS FOR BK. BRANCH ON RELATED DEAL                     S01117
     C***********DLNUM     CHAINDEALS                98           S01117  S01311
     C           DLNUM     CHAINDEALS                52           S01117  S01311
     C***IF*MBIN*=*Y*VALIDATE*BK.BR. FOR USER                     S01117  S01194
     C** IF @MBIN = Y,VALIDATE BK.BR. FOR USER                            S01194
     C**                                                                  S01117
     C*****      MBIN      IFEQ 'Y'                               S01117  S01194
     C           @MBIN     IFEQ 'Y'                                       S01117
     C*****                MOVE BRCD      ZBRCDX  3               *****   S01117
     C                     MOVE BRCA      ZBRCDX  3                       S01117
     C                     CALL 'ZVBBU'                                   S01117
     C                     PARM           ZBRCDX                          S01117
     C                     PARM           @ERR    10                      S01117
     C**  IF BR.CODE NOT VALID FOR THIS USER SEND ERROR MSG.              S01117
     C           @ERR      IFNE 0                                         S01117
     C                     SETON                     19    INVALID BR.    S01117
     C                     GOTO ERROR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   047815
     C** Determine THEIR payment instruction                              047815
     C*                                                                   047815
     C           HNOMDT    IFEQ 'CD'                       ** IF01        047815
     C           HNOMDT    OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C*                                                                   047815
     C           HNTYPE    IFEQ 'PI'                       ** IF02        047815
     C                     MOVE HNMCRI    TSEN   10                       047815
     C                     ELSE                            ** ELSE02      047815
     C*                                                                   047815
     C           HNTYPE    IFEQ 'PD'                       ** IF03        047815
     C                     MOVE HNMCPI    TSEN                            047815
     C                     ELSE                            ** ELSE03      047815
     C                     MOVE *BLANKS   TSEN                            047815
     C                     END                             ** END03       047815
     C*                                                                   047815
     C                     END                             ** END02       047815
     C*                                                                   047815
     C                     ELSE                            ** ELSE01      047815
     C*                                                                   047815
     C           HNOMDT    IFEQ 'CL'                       ** IF02        047815
     C           HNOMDT    OREQ 'DL'                                      047815
     C           HNOMDT    OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C*                                                                   047815
     C           HNTYPE    IFEQ 'PD'                       ** IF03        047815
     C                     MOVE HNMCRI    TSEN                            047815
     C                     ELSE                            ** ELSE03      047815
     C*                                                                   047815
     C           HNTYPE    IFEQ 'PI'                       ** IF04        047815
     C                     MOVE HNMCPI    TSEN                            047815
     C                     ELSE                            ** ELSE04      047815
     C                     MOVE *BLANKS   TSEN                            047815
     C                     END                             ** END04       047815
     C*                                                                   047815
     C                     END                             ** END03       047815
     C*                                                                   047815
     C                     ELSE                            ** ELSE02      047815
     C*                                                                   047815
     C           HNOMDT    IFEQ 'IT'                       ** IF03        047815
     C           HNOMDT    OREQ 'TD'                                      047815
     C           HNOMDT    OREQ 'CI'                                      047815
     C/COPY WNCPYSRC,DL0185C003
     C           HNOMDT    OREQ 'CF'                                                          CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
     C           HNOMDT    OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C*                                                                   047815
     C           HNTYPE    IFEQ 'SI'                       ** IF04        047815
     C                     MOVE HNMCPI    TSEN                            047815
     C                     ELSE                            ** ELSE04      047815
     C                     MOVE *BLANKS   TSEN                            047815
     C                     END                             ** END04       047815
     C*                                                                   047815
     C                     ELSE                            ** ELSE03      047815
     C*                                                                   047815
     C           HNOMDT    IFEQ 'IP'                       ** IF04        047815
     C           HNOMDT    OREQ 'TI'                                      047815
     C           HNOMDT    OREQ 'LN'                                      047815
     C           HNOMDT    OREQ 'C1'                                      047815
     C           HNOMDT    OREQ 'C2'                                      047815
     C           HNOMDT    OREQ 'BP'                                      047815
     C           HNOMDT    OREQ 'BD'                                      047815
     C           HNOMDT    OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C*                                                                   047815
     C           HNTYPE    IFEQ 'SI'                       ** IF05        047815
     C                     MOVE HNMCRI    TSEN                            047815
     C                     ELSE                            ** ELSE05      047815
     C                     MOVE *BLANKS   TSEN                            047815
     C                     END                             ** END05       047815
     C*                                                                   047815
     C                     ELSE                            ** ELSE04      047815
     C*                                                                   047815
     C                     MOVE *BLANKS   TSEN                            047815
     C*                                                                   047815
     C                     END                             ** END04       047815
     C*                                                                   047815
     C                     END                             ** END03       047815
     C*                                                                   047815
     C                     END                             ** END02       047815
     C*                                                                   047815
     C                     END                             ** END01       047815
      *                                                                                       CER043
      ** Format the rates for display                                                         CER043
      *                                                                                       CER043
     C                     MOVE RTSP      ZFLD15                                              CER043
     C                     Z-ADD7         ZDECS                                               CER043
     C                     MOVE *BLANK    ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDRTSP 12                                           CER043
      *                                                                                       CER043
     C                     MOVE FSRP      ZFLD15                                              CER043
     C                     Z-ADD7         ZDECS                                               CER043
     C                     MOVE *BLANK    ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDFSRP 12                                           CER043
     C*                                                                   047815
      *                                                                   CDL017
      ***  CDL017 - Display Penalty Pay/Receive, Early Maturity date      CDL017
      *                                                                   CDL017
     C           HNTYPE    IFEQ 'EM'                                      CDL017
     C                     MOVE PENLTY    DDPNTY  1                       CDL017
     C                     Z-ADDZDAYNO    TEMPDT  50       Save in case   CDL017
     C                     Z-ADDEMDAT     ZDAYNO                          CDL017
     C                     EXSR ZDATE2                                    CDL017
     C**********           MOVE ZADATE    DDEMDT  6                                   CDL017 BUG8057
     C                     MOVE ZADATE    DDEMDT  7                                          BUG8057
     C                     Z-ADDTEMPDT    ZDAYNO                          CDL017
     C                     SETON                     46                   CDL017
     C                     ENDIF                                          CDL017
      *                                                                   CDL022
      ***  CDL022 - Deal Amendment Changes - use MMDEAMPP details         CDL022
      *                                                                   CDL022
     C                     MOVE HNBSRT    DDBSRT  2                       CDL022
      *                                                                   CDL020
      *** CDL020 is enable : Base Rate Interest Rate + Spread Rate        CDL020
      *                                                                   CDL020
     C  N45 47   HNBRTE    ADD  RTSP      DDAIR  117                      CDL020
     C                     MOVE DDAIR     ZFLD15                                              CER043
     C                     Z-ADD7         ZDECS                                               CER043
     C                     MOVE *BLANK    ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDAIR1 12                                           CER043
0254 C*
0255 C*
0256 C*    CHAIN CLINT FOR CUSTOMER NAME & CUSTOMER TOWN.
0257 C                     MOVELCNUM      CKEY    7
0258 C*****                MOVE 'A'       CKEY                    *****   S01194
0259 C*****      CKEY      CHAINCLINT                24           *****   S01194
0327 C* CALL ACCESS PROG. FOR CUSTOMER DETAILS.                           S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CKEY      @CKEY  10                       S01194
     C                     PARM           @CSTAT  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*
     C*                                                                   047815
     C***Receipt*settlement*method*for*DEPOSIT                      047815081657
     C***Pay*settment*method*for*LOAN                               047815081657
     C**********                                                    047815081657
     C********** HNOMDT    IFEQ 'IT'                       ** IF01  047815081657
     C********** HNOMDT    OREQ 'TD'                                047815081657
     C********** HNOMDT    OREQ 'CD'                                047815081657
     C********** HNOMDT    OREQ 'CI'                                047815081657
     C**********           Z-ADDHNRSTM    SETP                      047815081657
     C**********           ELSE                            ** ELSE01047815081657
     C********** HNOMDT    IFEQ 'LN'                       ** IF02  047815081657
     C********** HNOMDT    OREQ 'DL'                                047815081657
     C********** HNOMDT    OREQ 'IP'                                047815081657
     C********** HNOMDT    OREQ 'TI'                                047815081657
     C********** HNOMDT    OREQ 'CL'                                047815081657
     C**********           Z-ADDHNPSTM    SETP                      047815081657
     C**********           END                             ** END02 047815081657
     C**********           END                             ** END01 047815081657
     C*                                                                   081657
     C                     EXSR SETTYP                                    081657
     C*                                                                   081657
     C           @RPIND    IFEQ 'P'                                       081657
     C                     Z-ADDHNPSTM    SETP                            081657
     C                     ELSE                                           081657
     C                     Z-ADDHNRSTM    SETP                            081657
     C                     ENDIF                                          081657
     C*                                                                   081657
     C           SETP      LOKUPTABNUM    TABSIN         69
     C   69                MOVE TABSIN    SETINS 20
      *                                                                   S01408
     C/COPY WNCPYSRC,DL0185CP13                                           S01408
      *                                                                   S01408
0260 C*
0261 C*    CHAIN  CURRENCIES  FOR NO.OF DEC.POS.
0262 C*****                MOVEL'20      'CUCY   11
0263 C*****                MOVE CCY       CUCY
0264 C*****                MOVELCUCY      CUKY   12
0265 C*****                MOVE '1'       CUKY
0266 C*****      CUKY      CHAINTABLE                25           *****   S01194
0327 C* CALL ACCESS PROG. FOR CURRENCY DETAILS.                           S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCY       @CUKEY  3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0267 C*
0268 C*    SET INDICATORS FOR NO.OF DEC.POS.
0269 C*****      CDP       COMP 1                      2627       *****   S01194
0269 C           A6NBDP    COMP 1                      2627               S01194
0270 C*****      CDP       COMP 2                    29  28       *****   S01194
0270 C           A6NBDP    COMP 2                    29  28               S01194
     C/COPY WNCPYSRC,DL0185CP10                                           S01408
0271 C*
0272 C*    DECODE AMENDMENT TYPE
0273 C           AMTP      LOKUPTABLET    TABTYP         60
0274 C                     MOVE TABTYP    AMTYPE 23
      *                                                                   CDL006
      ** If switchable feature CDL006 is installed (switched on)          CDL006
      ** setup details to be displayed, only if Deal Type processed       CDL006
      ** are FT,DT and LT, Otherwise display original screen.             CDL006
      *                                                                   CDL006
     C           HNOMDT    IFEQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     MOVE '1'       *IN45                           CDL006
     C                     MOVELAMTYPE    SAMTYP 23                       CDL006
     C                     Z-ADDDAAM      SDAAM  130                      CDL006
     C                     Z-ADDDASN      SDASN   30                      CDL006
     C**********           Z-ADDBRTT      SBRTT   20                                   CDL006 CSD103
     C                     MOVE BRTT      SBRTT   2                                           CSD103
     C                     Z-ADDRTSP      SRTSP  117                      CDL006
     C                     MOVELCCY       SCCY    3                       CDL006
     C                     MOVELFCGC      SFCGC   2                       CDL006
     C                     MOVELFCGD      SFCGD  20                       CDL006
     C                     Z-ADDFCGA      SFCGA  130                      CDL006
     C                     Z-ADDFCGT      SFCGT   90                      CDL006
     C                     ELSE                                           CDL006
     C                     MOVE '0'       *IN45                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                                       CER043
     C                     MOVE SRTSP     ZFLD15                                              CER043
     C                     Z-ADD7         ZDECS                                               CER043
     C                     MOVE *BLANK    ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDSRTS 12                                           CER043
      *                                                                                       CER043
     C                     MOVE DAAM      ZFLD15                                              CER043
     C   26                Z-ADD0         ZDECS                                               CER043
     C   27                Z-ADD1         ZDECS                                               CER043
     C   28                Z-ADD2         ZDECS                                               CER043
     C   29                Z-ADD3         ZDECS                                               CER043
     C                     MOVE 'J'       ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDDAAM 17                                           CER043
      *                                                                                       CER043
     C                     MOVE SDAAM     ZFLD15                                              CER043
     C   26                Z-ADD0         ZDECS                                               CER043
     C   27                Z-ADD1         ZDECS                                               CER043
     C   28                Z-ADD2         ZDECS                                               CER043
     C   29                Z-ADD3         ZDECS                                               CER043
     C                     MOVE 'J'       ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDSDAM 17                                           CER043
      *                                                                                       CER043
     C                     MOVE SFCGA     ZFLD15                                              CER043
     C   26                Z-ADD0         ZDECS                                               CER043
     C   27                Z-ADD1         ZDECS                                               CER043
     C   28                Z-ADD2         ZDECS                                               CER043
     C   29                Z-ADD3         ZDECS                                               CER043
     C                     MOVE 'J'       ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDSFCG 17                                           CER043
      *                                                                                       CER043
     C                     MOVE SFCGT     ZFLD15                                              CER043
     C   26                Z-ADD0         ZDECS                                               CER043
     C   27                Z-ADD1         ZDECS                                               CER043
     C   28                Z-ADD2         ZDECS                                               CER043
     C   29                Z-ADD3         ZDECS                                               CER043
     C                     MOVE 'J'       ZECODE                                              CER043
     C                     EXSR ZSEDIT                                                        CER043
     C                     MOVE ZOUT21    DDSFCT 13                                           CER043
0275 C*
0276 C*    OUTPUT DETAIL SO SET OFF IND.44
0277 C                     SETOF                     44
0278 C*
0279 C*    CONVERT DATE FROM DAY NO. TO DDMMMYY FORMAT
0280 C                     EXSR ZDATE2
0281 C*
0282 C                     GOTO END
0283 C*
0284 C*    ERROR
0285 C           ERROR     TAG                             ** ERROR TAG **
0286 C                     SETOF                     43
0287 C*
0288 C*    GET ERROR CODES INTO MSG FIELD FOR OUTPUT.
0289 C*    SET & DEFINE INDEX.
0290 C                     Z-ADD1         X       10
0291 C   20                MOVE ' 268'    MSGR,X
0292 C   20      X         ADD  1         X
0293 C   99                MOVE ' 269'    MSGR,X
0294 C   99      X         ADD  1         X
0295 C   22                MOVE ' 270'    MSGR,X
0296 C   22      X         ADD  1         X
0297 C***23                MOVE ' 271'    MSGR,X                          S01117
0298 C***23                SETON                     209922               S01117
     C           *IN23     IFEQ '1'                                       S01117
     C                     MOVE ' 271'    MSGR,X                          S01117
     C                     SETON                     209922               S01117
     C                     ADD  1         X                               S01117
     C                     END                                            S01117
     C           *IN19     IFEQ '1'                                       S01117
     C                     MOVE ' 287'    MSGR,X                          S01117
     C                     SETON                     20                   S01117
     C                     END                                            S01117
0299 C*
0300 C                     MOVEAMSGR      MSG1   16
0301 C                     MOVELMSG1      MSG    78
0302 C*    NOW CLEAR ARRAY & MSG1 FOR NEXT TIME
0303 C*****                MOVE '    '    MSGR                    *****   S01194
0304 C*****                MOVEAMSGR      MSG1                    *****   S01194
0304 C                     MOVE *BLANKS   MSG1                            S01194
0305 C*
0306 C           END       TAG                             *** END TAG ***
0303 C                     MOVEA*BLANKS   MSGR,1                          S01194
0307 C                     TIME           TID     60
     C/COPY WNCPYSRC,DL0185CP11                                           S01408
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
      *                                                                   CAC001
     C                     MOVE '0'       *IN31                           CAC001
     C                     MOVE '0'       *IN32                           CAC001
      *                                                                   CAC001
     C           AMTP      IFEQ 'SC'                                      CAC001
     C           IRCF      ANDEQ'N'                                       CAC001
     C                     MOVE '1'       *IN32                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C           AMTP      IFEQ 'SC'                                      CAC001
     C           FRCF      ANDEQ'N'                                       CAC001
     C                     MOVE '1'       *IN31                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
0308 C*****************************************************************
     C/COPY WNCPYSRC,DL0185C001
     C/EJECT
      *****************************************************************   081657
      *                                                               *   081657
      *  SUBROUTINE: SETTYP -  Find out whether an amendment sett.    *   081657
      *                        is pay or receive                      *   081657
      *                                                               *   081657
      *  FIELDS USED:    @RPIND -  Receipt/payment indicator          *   081657
      *                                                               *   081657
      *  CALLED BY :  Main Processing                                 *   081657
      *  CALLS     :  Nothing                                         *   081657
      *                                                               *   081657
      *****************************************************************   081657
      *                                                                   081657
     C           SETTYP    BEGSR                                          081657
      *                                                                   081657
      ** Original MIDAS type is CD or ID (Internal)                       081657
     C           HNOMDT    IFEQ 'CD'                       B*1            081657
     C           HNOMDT    OREQ 'ID'                       B*1            081657
     C           HNOMDT    OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   081657
     C           HNTYPE    IFEQ 'PI'                       B*2            081657
     C                     MOVE 'R'       @RPIND            *2            081657
     C                     ELSE                            X*2            081657
     C           HNTYPE    IFEQ 'PD'                       B*3            081657
     C                     MOVE 'P'       @RPIND            *3            081657
     C                     END                             E*3            081657
     C                     END                             E*2            081657
     C           HNTYPE    IFEQ 'SI'                       B*2            081657
     C                     MOVE 'P'       @RPIND            *2            081657
     C                     END                             E*2            081657
      *                                                                   081657
     C                     GOTO SETEND                      *1            081657
     C                     END                             E*1            081657
      *                                                                   081657
      ** Original MIDAS type is CL , DL or IL (Internal)                  081657
     C           HNOMDT    IFEQ 'CL'                       B*1            081657
     C           HNOMDT    OREQ 'DL'                       B*1            081657
     C           HNOMDT    OREQ 'IL'                       B*1            081657
     C           HNOMDT    OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           HNOMDT    OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   081657
     C           HNTYPE    IFEQ 'PD'                       B*2            081657
     C                     MOVE 'R'       @RPIND            *2            081657
     C                     ELSE                            X*2            081657
     C           HNTYPE    IFEQ 'PI'                       B*3            081657
     C                     MOVE 'P'       @RPIND            *3            081657
     C                     END                             E*3            081657
     C                     END                             E*2            081657
     C           HNTYPE    IFEQ 'SI'                       B*2            081657
     C                     MOVE 'R'       @RPIND            *2            081657
     C                     END                             E*2            081657
      *                                                                   081657
     C                     GOTO SETEND                      *1            081657
     C                     END                             E*1            081657
      *                                                                   081657
      ** Original MIDAS type is IT,TD or CI.                              081657
     C           HNOMDT    IFEQ 'IT'                       B*1            081657
     C           HNOMDT    OREQ 'TD'                       B*1            081657
     C           HNOMDT    OREQ 'CI'                       B*1            081657
     C/COPY WNCPYSRC,DL0185C004
     C           HNOMDT    OREQ 'CF'                                                          CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
     C           HNOMDT    OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   081657
     C           HNTYPE    IFEQ 'SI'                       B*2            081657
     C                     MOVE 'P'       @RPIND            *2            081657
     C                     END                             E*2            081657
      *                                                                   081657
     C                     GOTO SETEND                      *1            081657
     C                     END                             E*1            081657
      *                                                                   081657
      ** Original MIDAS type is IP,TI,LN,C1,C2,BP or BD.                  081657
     C           HNOMDT    IFEQ 'IP'                       B*1            081657
     C           HNOMDT    OREQ 'TI'                       B*1            081657
     C           HNOMDT    OREQ 'LN'                       B*1            081657
     C           HNOMDT    OREQ 'C1'                       B*1            081657
     C           HNOMDT    OREQ 'C2'                       B*1            081657
     C           HNOMDT    OREQ 'BP'                       B*1            081657
     C           HNOMDT    OREQ 'BD'                       B*1            081657
     C           HNOMDT    OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   081657
     C           HNTYPE    IFEQ 'SI'                       B*2            081657
     C                     MOVE 'R'       @RPIND            *2            081657
     C                     END                             E*2            081657
      *                                                                   081657
     C                     GOTO SETEND                      *1            081657
     C                     END                             E*1            081657
      *                                                                   081657
      ** Original MIDAS type is other than above.                         081657
     C                     MOVE ' '       @RPIND  1                       081657
      *                                                                   081657
     C           SETEND    ENDSR                           **#ZB9**       081657
     C*****************************************************************
0309 C*  HELPSR SR. SUBROUTINE TO READ THE SCREEN AND ENABLE HELP
     C*
     C****************************************************************
     C           HELPSR    BEGSR                           ** HELPSR **
     C*    ALLOW HELP
     C**
     C           *IN06     IFEQ '1'
     C************IN07*****DOUEQ'0'                                       S01199
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP4                                           S01408
     C*                                                                   S01408
0188 C   06                READ DL0185FM                 07
     C************IN07     IFEQ '1'                                       S01199
     C*********************MOVELMSG       HERCD 160                       S01199
     C*********************MOVEL'DL0185'  HBPGM   8                       S01199
     C*********************CALL 'MHELP'                                   S01199
     C*********************PARM           HBPGM                           S01199
     C*********************PARM           HERCD                           S01199
     C*********************END                                            S01199
     C*********************END                                            S01199
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0185CCP5                                           S01408
     C                     CALL 'WN0010'                                                      248298
     C                     PARM 'DL0185'  #PGM   10                                           248298
     C                     PARM *BLANK    FKEY    2                                           248298
     C                     PARM 'E'       ACTION  1                                           248298
     C                     PARM           DATA                                                248298
     C                     PARM *BLANK    #RTRN   7                                           248298
     C                     PARM           SPARE 256                                           248298
      *                                                                                       248298
      **  If CA03 pressed, exit from program.                                                 248298
      *                                                                                       248298
     C           #RTRN     IFEQ 'Y2U9999'                                                     248298
     C                     MOVE '1'       *INKC                                               248298
     C                     ENDIF                                                              248298
      *                                                                                       248298
     C*                                                                   S01408
0195 C   01                GOTO HELPND
     C                     END
     C           HELPND    ENDSR                           ** HELPND **
     C*---------------------------------------------------------------*   S01311
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *---------------------------------------------------------------*   S01311
      *                                                               *   S01311
      *  CMD - SUBROUTINE TO VALIDATE COMMAND KEYS                    *   S01311
      *                                                               *   S01311
      *  Calls      RETSR   - Process command keys                    *   S01311
      *                                                               *   S01311
      *  Called by  MAIN    - Main processing                         *   S01311
      *                                                               *   S01311
      *---------------------------------------------------------------*   S01311
0741  *                                                                   S01311
0740 C           CMD       BEGSR                                          S01311
      *                                                                   S01311
      *   Validate Command Keys                                           S01311
      *                                                                   S01311
     C           *INKA     IFEQ '1'                                       S01311
     C                     MOVE 'S'       RETNWF  1                       S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
     C           *INKC     IFEQ '1'                                       S01311
     C                     MOVE 'Q'       RETNWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
     C           *INKL     IFEQ '1'                                       S01311
     C                     MOVE 'U'       RETNWF                          S01311
     C                     EXSR RETSR                                     S01311
     C                     END                                            S01311
      *                                                                   S01311
     C                     ENDSR                                          S01311
     C*---------------------------------------------------------------*   S01311
      /EJECT                                                              S01311
      *---------------------------------------------------------------*   S01311
      *                                                               *   S01311
      *  RETSR - SUBROUTINE TO PROCESS COMMAND KEYS                   *   S01311
      *                                                               *   S01311
      *  Called by  CMD     - Command key validation subroutine       *   S01311
      *                                                               *   S01311
      *---------------------------------------------------------------*   S01311
0741  *                                                                   S01311
0740 C           RETSR     BEGSR                                          S01311
0741  *                                                                   S01311
0742 C                     SETON                     LR                   S01311
0392  *  Access DL Data Area                                              S01311
0405 C           *LOCK     IN   DLSDS                                     S01311
0402 C                     MOVE RETNWF    RETND                           S01311
0405 C                     OUT  DLSDS                                     S01311
0743 C                     RETRN                                          S01311
0744  *                                                                   S01311
0745 C                     ENDSR                                          S01311
     C*---------------------------------------------------------------*   S01311
     C*****************************************************************
      /EJECT                                                              CDL006
      *****************************************************************   CDL006
      *                                                               *   CDL006
      * *PSSR    - TO PROCESS DATA BASE ERRORS                        *   CDL006
      *                                                               *   CDL006
      *****************************************************************   CDL006
      *                                                                   CDL006
     C           *PSSR     BEGSR                                          CDL006
     C           WRUN      IFEQ *BLANK                                    CDL006
     C                     MOVE 'Y'       WRUN    1                       CDL006
     C                     DUMP                                           CDL006
     C                     END                                            CDL006
     C**                                                                  CDL006
     C                     MOVE '1'       *INU7                           CDL006
     C                     MOVE '1'       *INU8                           CDL006
     C                     MOVE '1'       *INLR                           CDL006
     C                     RETRN                                          CDL006
     C                     ENDSR                                          CDL006
     C/EJECT
0310 C********************************************************************
0311 C**
0817 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RE*****   S01194
0818 C*****                                                       *****   S01194
0819 C*****      ZSYSTM    BEGSR                           *** ZSY*****   S01194
0820 C*****                                                       *****   S01194
0821 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0822 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0823 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0824 C*****                                                       *****   S01194
0825 C*****      ZTABKY    CHAINTABLE                99    ON NOT *****   S01194
0826 C*****      RECI      COMP 'D'                  9999  ON, IS *****   S01194
0827 C*****                                                       *****   S01194
0828 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0829 C*****      DATF      COMP 'M'                      98MMDDYY,*****   S01194
0830 C*****                                                       *****   S01194
0831 C*****                ENDSR                                  *****   S01194
0832 C*****                                                       *****   S01194
0833 C*****                                                       *****   S01194
0330 C********************************************************************
0331 C**
0332 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
0333 C**              CONVERT TO A NUMBER OF DAYS.
0334 C**
0335 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0336 C**
0337 C           ZDATE1    BEGSR                           *** ZDATE1 ***
0338 C**
0339 C**   CLEAR DAY NUMBER.
0340 C                     Z-ADD0         ZDAYNO  50
0341 C**
0342 C**   CALCULATION TO DEFINE INPUT DATE FIELD.
0343 C                     Z-ADDZDATE     ZDATE   60
0344 C**
0345 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
0346 C                     MOVE ZDATE     ZYEAR   20
0347 C  N98                MOVELZDATE     ZDAY    20
0348 C   98                MOVELZDATE     ZMTH    20
0349 C                     MOVE ZDATE     ZWRK4   40
0350 C  N98                MOVELZWRK4     ZMTH
0351 C   98                MOVELZWRK4     ZDAY
0352 C**
0353 C**   ENSURE MONTH IS VALID.
0354 C           ZMTH      COMP 0                      9999
0355 C  N99      ZMTH      COMP 12                   99
0356 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0357 C**
0358 C**   CHECK FOR 30 DAY MONTHS.
0359 C           ZMTH      COMP 4                        90IF 90 ON, 30
0360 C  N90      ZMTH      COMP 6                        90DAY MONTH.
0361 C  N90      ZMTH      COMP 9                        90
0362 C  N90      ZMTH      COMP 11                       90
0363 C**
0364 C**   ENSURE DAY IS VALID.
0365 C           ZDAY      COMP 0                      9999
0366 C   90N99   ZDAY      COMP 30                   99
0367 C  N90N99   ZDAY      COMP 31                   99
0368 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0369 C**
0370 C**   CHECK FOR LEAP YEAR AND FEBRUARY.
0371 C           ZYEAR     ADD  28        ZYEAR
0372 C           ZYEAR     DIV  4         ZLYR    20
0373 C                     MVR            ZLY     10     91LEAP YR, 91 ON
0374 C           ZMTH      COMP 2                    93  92FEB., 92 ON
0375 C**                                                   PAST FEB, 93 ON
0376 C**   IF FEBUARY FURTHER VALIDATE DAY.
0377 C  N91 92   ZDAY      COMP 28                   99
0378 C   91 92   ZDAY      COMP 29                   99
0379 C   99                GOTO ZDEND1                     BYPASS IF ERROR
0380 C**
0381 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
0382 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
0383 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
0384 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
0385 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
0386 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
0387 C**
0388 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
0389 C**
0390 C**
0391 C********************************************************************
0392 C**
0393 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0394 C**
0395 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0396 C**
0397 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0398 C**
0399 C**   CLEAR DATE FIELDS.
0400 C                     Z-ADD0         ZDATE   60
0401 C                     MOVEL'       ' ZADATE  7
0402 C**
0403 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0404 C                     Z-ADDZDAYNO    ZDAYNO  50
0405 C**
0406 C**   DETERMINE YEAR NUMBER.
0407 C**
0408 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0409 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0410 C   99                GOTO ZDEND2
0411 C**
0412 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0413 C           ZDAYN1    DIV  1461      ZLYR    20
0414 C                     MVR            ZDAYN1           SAVE REMAINING
0415 C**                                                   DAYS
0416 C**   CALCULATE NUMBER OF REMAINING YEARS.
0417 C                     Z-ADD1         ZWRK2   20
0418 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0419 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0420 C  N90      ZWRK2     ADD  1         ZWRK2
0421 C  N90                GOTO ZDTAG1
0422 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0423 C**
0424 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0425 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0426 C**
0427 C**   CALCULATE ACTUAL YEAR NUMBER.
0428 C           ZLYR      MULT 4         ZWRK3   30
0429 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0430 C                     Z-ADDZWRK3     ZYEAR   20
0431 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0432 C**
0433 C**   DETERMINE MONTH NUMBER.
0434 C**
0435 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0436 C                     SETOF                     9293
0437 C   91      ZDAYN1    COMP 59                     9293
0438 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0439 C**
0440 C**   CALCULATE MONTH NUMBER.
0441 C                     Z-ADD2         ZWRK2
0442 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0443 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0444 C  N94      ZWRK2     ADD  1         ZWRK2
0445 C  N94                GOTO ZDTAG2
0446 C           ZWRK2     SUB  1         ZWRK2
0447 C**
0448 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0449 C**
0450 C**   DETERMINE DAY OF MONTH.
0451 C**
0452 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0453 C           ZDAYN1    ADD  1         ZDAYN1
0454 C**
0455 C**   CALCULATE DAY OF MONTH.
0456 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0457 C**
0458 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0459 C   93      ZDAY      ADD  1         ZDAY
0460 C**
0461 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0462 C  N98                MOVELZDAY      ZWRK4   40
0463 C   98                MOVE ZDAY      ZWRK4
0464 C  N98                MOVE ZMTH      ZWRK4
0465 C   98                MOVELZMTH      ZWRK4
0466 C                     MOVELZWRK4     ZDATE
0467 C                     MOVE ZYEAR     ZDATE
0468 C**
0469 C**   FORMAT ALPHA DATE, DDMMMYY.
0470 C           ZDAY      COMP 10                     95
0471 C                     MOVELZDAY      ZWRK5   5
0472 C   95                MOVEL' '       ZWRK5
0473 C                     MOVE ZMNM,ZMTH ZWRK5
0474 C                     MOVELZWRK5     ZADATE
0475 C                     MOVE ZYEAR     ZADATE
0476 C**
0477 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0478 C**
0479 C**
0480 C********************************************************************
      /EJECT                                                              047815
     C*****************************************************************   047815
     C*                                                               *   047815
     C*  Subroutine:  ZA0710 - Calculate Midas day no.                *   047815
     C*                        to DRS (YYYYMMDD) format               *   047815
     C*                                                               *   047815
     C*       Subroutine ZA0710 expects field '@@DAYN' to be          *   047815
     C*       passed to it in 5,0 format.  If the above fiels is less *   047815
     C*       than 1 it returns 1 in field '@@RTN'.  The main program *   047815
     C*       should check for this condition and do the necessary.   *   047815
     C*       If '@@RTN' is not equal to 1 it returns the field       *   047815
     C*       '@@VDT'  in 'YYYYMMDD' format.                          *   047815
     C*                                                               *   047815
     C*  Called by  : Main Controlling Routine                        *   047815
     C*                                                               *   047815
     C*  Calls      : none                                            *   047815
     C*                                                               *   047815
     C*  Note: Field to be defined by external routine is             *   047815
     C*                                                               *   047815
     C*       1) @@DAYN   length 5,0.                                 *   047815
     C*                                                               *   047815
     C*       Fields used and already defined in the routine are:     *   047815
     C*                                                               *   047815
     C*       1) @@VDT    lenght 8,0 defined by a DS.                 *   047815
     C*       2) @@RTN    lenght 1,0.                                 *   047815
     C*       3) @@I      length 2,0 used to access array @YD         *   047815
     C*       4) @@J      length 2,0 used to access array @MD         *   047815
     C*       5) @@Z71Y   lenght 4,0 defined by a DS.                 *   047815
     C*       6) @@RDAY   length 5,0.                                 *   047815
     C*       7) @@LEAP   length 1,0.                                 *   047815
     C*                                                               *   047815
     C*       Indicators used are:                                    *   047815
     C*                                                               *   047815
     C*       1) 80       check for low and equal on array @YD        *   047815
     C*       2) 81       check for low on array @MD.                 *   047815
     C*                                                               *   047815
     C*  Input Field:       @@DAYN                                    *   047815
     C*                                                               *   047815
     C*  Output Field:      @@VDT                                     *   047815
     C*                                                               *   047815
     C*  Work Fields:       @@RTN                                     *   047815
     C*                     @@Z71Y                                    *   047815
     C*                     @@RDAY                                    *   047815
     C*                     @@LEAP                                    *   047815
     C*                     @@I                                       *   047815
     C*                     @@J                                       *   047815
     C*                                                               *   047815
     C*  Arrays used:       @YD compile time array.                   *   047815
     C*                     @MD compile time array.                   *   047815
     C*                                                               *   047815
     C*****************************************************************   047815
     C*                                                                   047815
     C           ZA0710    BEGSR                                          047815
     C*                                                                   047815
     C                     SETOF                     8081                 047815
     C                     Z-ADD0         @@RTN   10                      047815
     C                     Z-ADD0         @@VDT                           047815
     C                     Z-ADD1         @@I     20                      047815
     C                     Z-ADD1         @@J     20                      047815
     C                     Z-ADD1         @@LEAP  10                      047815
     C*                                                                   047815
     C           @@DAYN    CABEQ0         ZA0719                          047815
     C*                                                                   047815
     C           @@DAYN    IFLT 1                                         047815
     C                     Z-ADD1         @@RTN                           047815
     C                     GOTO ZA0719                                    047815
     C                     END                                            047815
     C*                                                                   047815
     C** Division to determine whether it is a leap year                  047815
     C*                                                                   047815
     C           @@DAYN    DIV  1461      @@Z71Y                          047815
     C                     MVR            @@RDAY  50                      047815
     C*                                                                   047815
     C** Calculating year                                                 047815
     C*                                                                   047815
     C           @@Z71Y    MULT 4         @@Z71Y                          047815
     C                     ADD  1972      @@Z71Y                          047815
     C*                                                                   047815
     C** Checking if year is greater than or equal to 2100                047815
     C*                                                                   047815
     C           @@Z71Y    IFGE 2100                                      047815
     C                     ADD  @@SSY2    @@RDAY                          047815
     C                     END                                            047815
     C*                                                                   047815
     C** LOKUP array @YD to see how many years of a four year cycle       047815
     C** have passed                                                      047815
     C*                                                                   047815
     C           @@RDAY    LOKUP@YD,@@I                8080               047815
     C*                                                                   047815
     C** If year is a leap year SSLEAP is set to zero                     047815
     C*                                                                   047815
     C           *IN80     IFEQ '0'                                       047815
     C                     Z-ADD0         @@LEAP                          047815
     C                     END                                            047815
     C*                                                                   047815
     C** Add index to year to give correct year and adjust '@@RDAY'       047815
     C*                                                                   047815
     C           @@LEAP    IFEQ 1                                         047815
     C           @@RDAY    SUB  @YD,@@I   @@RDAY                          047815
     C                     ADD  @@I       @@Z71Y                          047815
     C                     END                                            047815
     C*                                                                   047815
     C** Processing for a leap year                                       047815
     C*                                                                   047815
     C           @@LEAP    IFEQ 0                                         047815
     C*                                                                   047815
     C** If '@@RDAY' = 60 date must be 29TH of February                   047815
     C*                                                                   047815
     C           @@RDAY    IFEQ 60                                        047815
     C                     Z-ADD29        @@Z71D                          047815
     C                     Z-ADD2         @@Z71M                          047815
     C                     GOTO ZA0711                                    047815
     C                     END                                            047815
     C*                                                                   047815
     C** If '@@RDAY' > 60 date is after 29TH of February,conversion can   047815
     C** proceed as usual after subtracting the extra day for the leap    047815
     C** year. NOTE : '@@RDAY' < 60 conversion proceeds as usual.         047815
     C*                                                                   047815
     C           @@RDAY    IFGT 60                                        047815
     C           @@RDAY    SUB  1         @@RDAY                          047815
     C                     END                                            047815
     C*                                                                   047815
     C                     END                                            047815
     C*                                                                   047815
     C** If day '@@DAYN' is exactly divisible by 1461 (number of days     047815
     C** in 4 YEARS) then date must be last day of previous four year     047815
     C** group                                                            047815
     C*                                                                   047815
     C           @@RDAY    IFEQ 0                                         047815
     C                     Z-ADD31        @@Z71D                          047815
     C                     Z-ADD12        @@Z71M                          047815
     C                     SUB  1         @@Z71Y                          047815
     C                     GOTO ZA0711                                    047815
     C                     END                                            047815
     C*                                                                   047815
     C** Look up array array @MD to determine which month '@@RDAY'        047815
     C** occurs in                                                        047815
     C*                                                                   047815
     C           @@RDAY    LOKUP@MD,@@J                81                 047815
     C                     Z-ADD@@J       @@Z71M                          047815
     C           @@RDAY    SUB  @MD,@@J   @@Z71D                          047815
     C*                                                                   047815
     C** DS @@VDT  is returned in YYYYMMDD format                         047815
     C*                                                                   047815
     C           ZA0711    TAG                                            047815
     C*                                                                   047815
     C                     MOVE @@Z71Y    @@YR                            047815
     C*                                                                   047815
     C           ZA0719    ENDSR                                          047815
     C*****************************************************************   047815
0481 C*
0482 C/EJECT
     C/COPY ZSRSRC,ZSEDITZ4                                                                   CER043
0483 ODL0185FMD        01NLR
0484 O                                   K8 'DL0185F1'
     O                         *IN51      1                               S01311
     O                         *IN44      2                               S01311
     O                         *IN45      3                               CDL006
     O***********              *IN43      3                        S01311 CAC001
     O***********              *IN20      4                        S01311 CAC001
     O***********              *IN99      5                        S01311 CAC001
     O***********              *IN22      6                        S01311 CAC001
0485 O***********                         7 '00'                          S01311
0486 O***********              TID       15 '  .  .  '                    S01311
0487 O***********              WSID      18                               S01311
0488 O***********              DLNO      26                               S01311
0489 O***********              CNUM      32                               S01311
0490 O*****                    CRNM      52                ****   S01194  S01311
0490 O***********              BBCRNM    52                       S01194  S01311
0491 O*****                    CTWN      62                ****   S01194  S01311
0491 O***********              BBCRTN    62                       S01194  S01311
0492 O***********              ZADATE    69                               S01311
0493 O***********              DASN      72                               S01311
0494 O***********              AMTYPE    95                               S01311
0495 O***********              BRTT      97                               S01311
0496 O***********         10             97 '  '                          S01311
0497 O***********              RTSP     109 '  0 .       '                S01311
0498 O***********         11   RTSP  Z  109                               S01311
0499 O***********              CCY      112                               S01311
0500 O***********         26   DAAM     129 ' ,   ,   ,   , 0 '           S01311
0501 O***********         27   DAAM     129 '   ,   ,   , 0 . '           S01311
0502 O***********         28   DAAM     129 '  ,   ,   , 0 .  '           S01311
0503 O***********         29   DAAM     129 ' ,   ,   , 0 .   '           S01311
0504 O***********              SETINS   149                               S01311
0505 O***********              OSAC     161                               S01311
0506 O*****                    TSEN     171                               S01117
0507 O*****                    FACO     181                               S01117
0508 O*****                    SPI      216                               S01117
0509 O*****           N43      MSG      294                               S01117
0510 O*****            44      DLNUM    300                               S01117
0511 O*****            44      VDATE    306                               S01117
0512 O*****            44      DASN1    309                               S01117
     O***********              OSBR     164                        S01117 S01311
     O***********              TSEN     174                        S01117 S01311
     O***********              FACO     184                        S01117 S01311
     O***********              SPI      219                        S01117 S01311
     O***********     N43      MSG      297                        S01117 S01311
     O***********      44      DLNUM    303                        S01117 S01311
     O***********      44      VDATE    309                        S01117 S01311
     O***********      44      DASN1    312                        S01117 S01311
0485 O***********                         8 '00'                   S01311 CAC001
0486 O***********              TID       16 '  .  .  '             S01311 CAC001
0487 O***********              WSID      19                        S01311 CAC001
0488 O***********              DLNO      27                        S01311 CAC001
0489 O***********              CNUM      33                        S01311 CAC001
0490 O***********              BBCRNM    53                        S01311 CAC001
0491 O***********              BBCRTN    63                        S01311 CAC001
0492 O***********              ZADATE    70                        S01311 CAC001
0493 O***********              DASN      73                        S01311 CAC001
0494 O***********              AMTYPE    96                        S01311 CAC001
0495 O***********              BRTT      98                        S01311 CAC001
0496 O***********         10             98 '  '                   S01311 CAC001
0497 O***********              RTSP     110 '  0 .       '         S01311 CAC001
0498 O***********         11   RTSP  Z  110                        S01311 CAC001
     C/COPY WNCPYSRC,DL0185OOP1                                           S01408
0499 O***********              CCY      113                        S01311 CAC001
0500 O***********         26   DAAM     130 ' ,   ,   ,   , 0 '    S01311 CAC001
0501 O***********         27   DAAM     130 '   ,   ,   , 0 . '    S01311 CAC001
0502 O***********         28   DAAM     130 '  ,   ,   , 0 .  '    S01311 CAC001
0503 O***********         29   DAAM     130 ' ,   ,   , 0 .   '    S01311 CAC001
0504 O***********              SETINS   150                        S01311 CAC001
0505 O***********              OSAC     162                        S01311 CAC001
     O***********              OSBR     165                        S01311 CAC001
     O***********              TSEN     175                        S01311 CAC001
     O***********              FACO     185                        S01311 CAC001
     O***********              SPI      220                        S01311 CAC001
     O***********     N43      MSG      298                        S01311 CAC001
     O***********      44      DLNUM    304                        S01311 CAC001
     O***********      44      VDATE    310                        S01311 CAC001
     O***********      44      DASN1    313                        S01311 CAC001
     O***********              *IN30      3                        CAC001 CDL006
     O                         *IN30      4                               CDL006
     O***********              *IN32      4                        CAC001 CDL006
     O                         *IN32      5                               CDL006
     O***********              *IN31      5                        CAC001 CDL006
     O                         *IN31      6                               CDL006
     O***********              *IN43      6                        CAC001 CEU003
     O***********              *IN20      7                        CAC001 CEU003
     O***********              *IN99      8                        CAC001 CEU003
     O***********              *IN22      9                        CAC001 CEU003
     O***********              *IN08      6                        CEU003 CDL006
     O***********              *IN08      7                        CDL006 CDL017
     O***********              *IN43      7                        CEU003 CDL006
     O***********              *IN43      8                        CDL006 CDL017
     O***********              *IN20      8                        CEU003 CDL006
     O***********              *IN20      9                        CDL006 CDL017
     O***********              *IN99      9                        CEU003 CDL006
     O***********              *IN99     10                        CDL006 CDL017
     O***********              *IN22     10                        CEU003 CDL006
     O***********              *IN22     11                        CDL006 CDL017
     O***********                        11 '00'                   CAC001 CEU003
     O***********              TID       19 '  .  .  '             CAC001 CEU003
     O***********              WSID      22                        CAC001 CEU003
     O***********              DLNO      30                        CAC001 CEU003
     O***********              CNUM      36                        CAC001 CEU003
     O***********              BBCRNM    56                        CAC001 CEU003
     O***********              BBCRTN    66                        CAC001 CEU003
     O***********              ZADATE    73                        CAC001 CEU003
     O***********              DASN      76                        CAC001 CEU003
     O***********              AMTYPE    99                        CAC001 CEU003
     O***********              BRTT     101                        CAC001 CEU003
     O***********         10            101 '  '                   CAC001 CEU003
     O***********        N32   RTSP     113 '  0 .       '         CAC001 CEU003
     O***********      30N31   FSRP     125 '  0 .       '         CAC001 CEU003
     O***********              CCY      128                        CAC001 CEU003
     O***********         26   DAAM     145 ' ,   ,   ,   , 0 '    CAC001 CEU003
     O***********         27   DAAM     145 '   ,   ,   , 0 . '    CAC001 CEU003
     O***********         28   DAAM     145 '  ,   ,   , 0 .  '    CAC001 CEU003
     O***********         29   DAAM     145 ' ,   ,   , 0 .   '    CAC001 CEU003
     O***********              SETINS   165                        CAC001 CEU003
     O***********              OSAC     177                        CAC001 CEU003
     O***********              OSBR     180                        CAC001 CEU003
     O***********              TSEN     190                        CAC001 CEU003
     O***********              FACO     200                        CAC001 CEU003
     O***********              SPI      235                        CAC001 CEU003
     O***********     N43      MSG      313                        CAC001 CEU003
     O***********      44      DLNUM    319                        CAC001 CEU003
     O***********      44      VDATE    325                        CAC001 CEU003
     O***********      44      DASN1    328                        CAC001 CEU003
     O***********                        12 '00'                   CEU003 CDL006
     O********                           13 '00'                   CDL006 CDL017
     O***********              TID       20 '  .  .  '             CEU003 CDL006
     O********                 TID       21 '  .  .  '             CDL006 CDL017
     O***********              WSID      23                        CEU003 CDL006
     O********                 WSID      24                        CDL006 CDL017
     O***********              DLNO      31                        CEU003 CDL006
     O********                 DLNO      32                        CDL006 CDL017
     O***********              CNUM      37                        CEU003 CDL006
     O********                 CNUM      38                        CDL006 CDL017
     O***********              BBCRNM    57                        CEU003 CDL006
     O********                 BBCRNM    58                        CDL006 CDL017
     O***********              BBCRTN    67                        CEU003 CDL006
     O********                 BBCRTN    68                        CDL006 CDL017
     O***********              ZADATE    74                        CEU003 CDL006
     O********                 ZADATE    75                        CDL006 CDL017
     O***********              DASN      77                        CEU003 CDL006
     O***********              AMTYPE   100                        CEU003 CDL006
     O***********              BRTT     102                        CEU003 CDL006
     O********           N45   DASN      78                        CDL006 CDL017
     O********            45   SDASN     81                        CDL006 CDL017
     O********           N45   AMTYPE   104                        CDL006 CDL017
     O********            45   SAMTYP   127                        CDL006 CDL017
     O********           N45   BRTT     129                        CDL006 CDL017
     O********            45   SBRTT    131                        CDL006 CDL017
     O***********         10            102 '  '                   CEU003 CDL006
     O********         10N45            129 '  '                   CDL006 CDL017
     O********         10 45            131 '  '                   CDL006 CDL017
     O***********              RTSP     114 '  0 .       '         CEU003 CDL006
     O********           N45   RTSP     143 '  0 .       '         CDL006 CDL017
     O**********         N45   RTSP     143 '  0 .       -'                            221673 CER043
     O/COPY WNCPYSRC,DLH00298
     O                   N45   DDRTSP   143                                                   CER043
     O/COPY WNCPYSRC,DLH00299
     O********            45   SRTSP    155 '  0 .       '         CDL006 CDL017
     O********         11 45   SRTSP Z  155                        CDL006 CDL017
     O**********          45   SRTSP    155 '  0 .       -'                            221673 CER043
     O/COPY WNCPYSRC,DLH00300
     O                    45   DDSRTS   155                                                   CER043
     O/COPY WNCPYSRC,DLH00301
     O***********         11   RTSP  Z  114                        CEU003 CDL006
     O********            11   RTSP  Z  143                        CDL006 CDL017
     O***********      30N31   FSRP     126 '  0 .       '         CEU003 CDL006
     O********         30N31   FSRP     167 '  0 .       '         CDL006 CDL017
     O********            33   FSRP  Z  167                        CDE002 CDL017
     O***********              CCY      129                        CEU003 CDL006
     O********           N45   CCY      170                        CDL006 CDL017
     O********            45   SCCY     173                        CDL006 CDL017
     O***********         26   DAAM     146 ' ,   ,   ,   , 0 '    CEU003 CDL006
     O***********         27   DAAM     146 '   ,   ,   , 0 . '    CEU003 CDL006
     O***********         28   DAAM     146 '  ,   ,   , 0 .  '    CEU003 CDL006
     O***********         29   DAAM     146 ' ,   ,   , 0 .   '    CEU003 CDL006
     O********        N45 26   DAAM     190 ' ,   ,   ,   , 0 '    CDL006 CDL017
     O********        N45 27   DAAM     190 '   ,   ,   , 0 . '    CDL006 CDL017
     O********        N45 28   DAAM     190 '  ,   ,   , 0 .  '    CDL006 CDL017
     O********        N45 29   DAAM     190 ' ,   ,   , 0 .   '    CDL006 CDL017
     O********         45 26   SDAAM    207 ' ,   ,   ,   , 0 '    CDL006 CDL017
     O********         45 27   SDAAM    207 '   ,   ,   , 0 . '    CDL006 CDL017
     O********         45 28   SDAAM    207 '  ,   ,   , 0 .  '    CDL006 CDL017
     O********         45 29   SDAAM    207 ' ,   ,   , 0 .   '    CDL006 CDL017
     O********            45   SFCGC    209                        CDL006 CDL017
     O********            45   SFCGD    229                        CDL006 CDL017
     O********         45 26   SFCGA    246 ' ,   ,   ,   , 0 '    CDL006 CDL017
     O********         45 27   SFCGA    246 '   ,   ,   , 0 . '    CDL006 CDL017
     O********         45 28   SFCGA    246 '  ,   ,   , 0 .  '    CDL006 CDL017
     O********         45 29   SFCGA    246 ' ,   ,   , 0 .   '    CDL006 CDL017
     O********         45 26   SFCGT    259 ' ,   ,   , 0 '        CDL006 CDL017
     O********         45 27   SFCGT    259 '   ,   , 0 . '        CDL006 CDL017
     O********         45 28   SFCGT    259 '  ,   , 0 .  '        CDL006 CDL017
     O********         45 29   SFCGT    259 ' ,   , 0 .   '        CDL006 CDL017
     O***********              SETINS   166                        CEU003 CDL006
     O********                 SETINS   279                        CDL006 CDL017
     O***********      08      STCY     169                        CEU003 CDL006
     O********         08      STCY     282                        CDL006 CDL017
     O***********              OSAC     181                        CEU003 CDL006
     O**********               OSAC     294                                            CDL006 CGL029
     O********                 OSAC     300                                            CGL029 CDL017
     O***********              OSBR     184                        CEU003 CDL006
     O**********               OSBR     297                                            CDL006 CGL029
     O********                 OSBR     303                                            CGL029 CDL017
     O***********              TSEN     194                        CEU003 CDL006
     O**********               TSEN     307                                            CDL006 CGL029
     O********                 TSEN     313                        CGL029 CDL017
     O***********              FACO     204                        CEU003 CDL006
     O**********               FACO     317                                            CDL006 CGL029
     O********                 FACO     323                        CGL029 CDL017
     O***********              SPI      239                        CEU003 CDL006
     O**********               SPI      352                                            CDL006 CGL029
     O********                 SPI      358                        CGL029 CDL017
     O***********      08      IC72     242                        CEU003 CDL006
     O**********       08      IC72     355                                            CDL006 CGL029
     O********         08      IC72     361                        CGL029 CDL017
     O***********     N43      MSG      320                        CEU003 CDL006
     O**********      N43      MSG      433                                            CDL006 CGL029
     O********        N43      MSG      439                        CGL029 CDL017
     O***********      44      DLNUM    326                        CEU003 CDL006
     O***********      44      VDATE    332                        CEU003 CDL006
     O***********      44      DASN1    335                        CEU003 CDL006
     O********         44      DLNUM    439                                            CDL006 CGL029
     O********         44      VDATE    445                                            CDL006 CGL029
     O********         44      DASN1    448                                            CDL006 CGL029
     O********         44      DLNUM    445                                            CGL029 CDL017
     O********         44      VDATE    451                                            CGL029 CDL017
     O********         44      DASN1    454                                            CGL029 CDL017
      *                                                                   CDL020
      ****  Add CDL020 and CDL022 Changes                          CDL022&CDL020
      *                                                                   CDL020
     O                         *IN46      7                               CDL020
     O                         *IN47      8                               CDL020
     O**********               *IN08      9                                            CDL020 CER043
     O**********               *IN43     10                                            CDL020 CER043
     O**********               *IN20     11                                            CDL020 CER043
     O**********               *IN99     12                                            CDL020 CER043
     O**********               *IN22     13                                            CDL020 CER043
     O**********                         15 '00'                                       CDL020 CER043
     O**********               TID       23 '  .  .  '                                 CDL020 CER043
     O**********               WSID      26                                            CDL020 CER043
     O**********               DLNO      34                                            CDL020 CER043
     O**********               CNUM      40                                            CDL020 CER043
     O**********               BBCRNM    60                                            CDL020 CER043
     O**********               BBCRTN    70                                            CDL020 CER043
     O**********               ZADATE    77                                            CDL020 CER043
     O**********         N45   DASN      80                                            CDL020 CER043
     O**********          45   SDASN     83                                            CDL020 CER043
     O**********         N45   AMTYPE   106                                            CDL020 CER043
     O**********          45   SAMTYP   129                                            CDL020 CER043
     O**********         N45   BRTT     131                                            CDL020 CER043
     O**********          45   SBRTT    133                                            CDL020 CER043
     O**********       10N45            131 '  '                                       CDL020 CER043
     O**********       10 45            133 '  '                                       CDL020 CER043
     O**********         N45   RTSP     145 '  0 .       '                             CDL020 249182
     O**********          45   SRTSP    157 '  0 .       '                             CDL020 249182
     O**********         N45   RTSP     145 '  0 .       -'                            249182 CER043
     O**********          45   SRTSP    157 '  0 .       -'                            249182 CER043
     O**********       11 45   SRTSP Z  157                                            CDL020 CER043
     O**********          11   RTSP  Z  145                                            CDL020 CER043
     O**********       30N31   FSRP     169 '  0 .       '                             CDL020 CER043
     O**********          33   FSRP  Z  169                                            CDL020 CER043
     O**********         N45   CCY      172                                            CDL020 CER043
     O**********          45   SCCY     175                                            CDL020 CER043
     O**********      N45 26   DAAM     192 ' ,   ,   ,   , 0 '                        CDL020 CER043
     O**********      N45 27   DAAM     192 '   ,   ,   , 0 . '                        CDL020 CER043
     O**********      N45 28   DAAM     192 '  ,   ,   , 0 .  '                        CDL020 CER043
     O**********      N45 29   DAAM     192 ' ,   ,   , 0 .   '                        CDL020 CER043
     O**********       45 26   SDAAM    209 ' ,   ,   ,   , 0 '                        CDL020 CER043
     O**********       45 27   SDAAM    209 '   ,   ,   , 0 . '                        CDL020 CER043
     O**********       45 28   SDAAM    209 '  ,   ,   , 0 .  '                        CDL020 CER043
     O**********       45 29   SDAAM    209 ' ,   ,   , 0 .   '                        CDL020 CER043
     O**********          45   SFCGC    211                                            CDL020 CER043
     O**********          45   SFCGD    231                                            CDL020 CER043
     O**********      N44N45 46DDPNTY   232                                            CDL020 CER043
     O**********      N44N45 46DDEMDT   238                                           CGL020 BUG8057
     O**********      N44N45   DDBSRT   240                                           CGL022 BUG8057
     O**********      N44N45 47DDAIR Z  252                                           CGL020 BUG8033
     O**********      N44N45 47DDAIR    252 '  0 .       '                           BUG8033 BUG8057
     O**********       45 26   SFCGA    269 ' ,   ,   ,   , 0 '                       CGL020 BUG8057
     O**********       45 27   SFCGA    269 '   ,   ,   , 0 . '                       CGL020 BUG8057
     O**********       45 28   SFCGA    269 '  ,   ,   , 0 .  '                       CGL020 BUG8057
     O**********       45 29   SFCGA    269 ' ,   ,   , 0 .   '                       CGL020 BUG8057
     O**********       45 26   SFCGT    282 ' ,   ,   , 0 '                           CGL020 BUG8057
     O**********       45 27   SFCGT    282 '   ,   , 0 . '                           CGL020 BUG8057
     O**********       45 28   SFCGT    282 '  ,   , 0 .  '                           CGL020 BUG8057
     O**********       45 29   SFCGT    282 ' ,   , 0 .   '                           CGL020 BUG8057
     O**********               SETINS   302                                           CGL020 BUG8057
     O**********       08      STCY     305                                           CGL020 BUG8057
     O**********               OSAC     323                                           CGL020 BUG8057
     O**********               OSBR     329                                           CGL020 BUG8057
     O**********               TSEN     339                                           CGL020 BUG8057
     O**********               FACO     349                                           CGL020 BUG8057
     O**********               SPI      384                                           CGL020 BUG8057
     O**********       08      IC72     378                                           CGL029 BUG8057
     O**********      N43      MSG      462                                           CGL029 BUG8057
     O**********       44      DLNUM    468                                           CGL029 BUG8057
     O**********       44      VDATE    474                                           CGL029 BUG8057
     O**********       44      DASN1    477                                           CGL029 BUG8057
     O**********      N44N45 46DDEMDT   239                                           BUG8057 CER043
     O**********      N44N45   DDBSRT   241                                           BUG8057 CER043
     O**********      N44N45 47DDAIR    253 '  0 .       '                            BUG8057 CER043
     O**********       45 26   SFCGA    270 ' ,   ,   ,   , 0 '                       BUG8057 CER043
     O**********       45 27   SFCGA    270 '   ,   ,   , 0 . '                       BUG8057 CER043
     O**********       45 28   SFCGA    270 '  ,   ,   , 0 .  '                       BUG8057 CER043
     O**********       45 29   SFCGA    270 ' ,   ,   , 0 .   '                       BUG8057 CER043
     O**********       45 26   SFCGT    283 ' ,   ,   , 0 '                           BUG8057 CER043
     O**********       45 27   SFCGT    283 '   ,   , 0 . '                           BUG8057 CER043
     O**********       45 28   SFCGT    283 '  ,   , 0 .  '                           BUG8057 CER043
     O**********       45 29   SFCGT    283 ' ,   , 0 .   '                           BUG8057 CER043
     O**********               SETINS   303                                           BUG8057 CER043
     O**********       08      STCY     306                                           BUG8057 CER043
     O**********               OSAC     324                                           BUG8057 CER043
     O**********               OSBR     327                                           BUG8057 CER043
     O**********               TSEN     337                                           BUG8057 CER043
     O**********               FACO     347                                           BUG8057 CER043
     O**********               SPI      382                                           BUG8057 CER043
     O**********       08      IC72     385                                           BUG8057 CER043
     O**********      N43      MSG      463                                           BUG8057 CER043
     O**********       44      DLNUM    469                                           BUG8057 CER043
     O**********       44      VDATE    475                                           BUG8057 CER043
     O**********       44      DASN1    478                                           BUG8057 CER043
      *                                                                                       CER043
     O                         *IN48      9                                                   CER043
     O/COPY WNCPYSRC,DLH00302
     O                         *IN08     10                                                   CER043
     O                         *IN43     11                                                   CER043
     O                         *IN20     12                                                   CER043
     O                         *IN99     13                                                   CER043
     O                         *IN22     14                                                   CER043
     O                                   16 '00'                                              CER043
     O                         TID       24 '  .  .  '                                        CER043
     O                         WSID      27                                                   CER043
     O                         DLNO      35                                                   CER043
     O                         CNUM      41                                                   CER043
     O                         BBCRNM    61                                                   CER043
     O                         BBCRTN    71                                                   CER043
     O                         ZADATE    78                                                   CER043
     O                   N45   DASN      81                                                   CER043
     O                    45   SDASN     84                                                   CER043
     O                   N45   AMTYPE   107                                                   CER043
     O                    45   SAMTYP   130                                                   CER043
     O                   N45   BRTT     132                                                   CER043
     O                    45   SBRTT    134                                                   CER043
     O                 10N45            132 '  '                                              CER043
     O                 10 45            134 '  '                                              CER043
     O                   N45   DDRTSP   146                                                   CER043
     O                    45   DDSRTS   158                                                   CER043
     O                 11 45   DDSRTS   158                                                   CER043
     O                    11   DDRTSP   146                                                   CER043
     O                 30N31   DDFSRP   170                                                   CER043
     O                    33   DDFSRP   170                                                   CER043
     O                   N45   CCY      173                                                   CER043
     O                    45   SCCY     176                                                   CER043
     O                N45      DDDAAM   193                                                   CER043
     O                 45      DDSDAM   210                                                   CER043
     O                    45   SFCGC    212                                                   CER043
     O                    45   SFCGD    232                                                   CER043
     O                N44N45 46DDPNTY   233                                                   CER043
     O                N44N45 46DDEMDT   240                                                   CER043
     O                N44N45   DDBSRT   242                                                   CER043
     O                N44N45 47DDAIR1   254                                                   CER043
     O                 45      DDSFCG   271                                                   CER043
     O                 45      SFCGT    284                                                   CER043
     O                         SETINS   304                                                   CER043
     O                 08      STCY     307                                                   CER043
     O                         OSAC     325                                                   CER043
     O                         OSBR     328                                                   CER043
     O                         TSEN     338                                                   CER043
     O                         FACO     348                                                   CER043
     O                         SPI      383                                                   CER043
     O                 08      IC72     386                                                   CER043
     O                N43      MSG      464                                                   CER043
     O                 44      DLNUM    470                                                   CER043
     O                 44      VDATE    476                                                   CER043
     O                 44      DASN1    479                                                   CER043
     O                N48      BBCSSN   489                                                   CER043
      *                                                                                       CER043
A    C/COPY WNCPYSRC,DL0185OOP2                                           S01408
0513 O*
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** RELATED TABLES FOR AMENDMENT TYPES
SCRATE CHANGE
PIPRINCIPAL INCREASE
PDPRINCIPAL DECREASE
CIINTEREST CAPITALISATION
SIINTEREST DUE DATE
EMEARLY MATURITY                                                                              CDL017
BCBASE RATE CHANGE                                                                            CDL022
     X/COPY WNCPYSRC,DL0185X001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   TABNUM -- SETTLEMENT TYPE CODES
0001021203041405060708
**   TABSIN -- SETTLEMENT TYPE INSTRUCTIONS
TO BE ADVISED
NOSTRO ACCOUNT
CHEQUE TO BE SENT
CHEQUE -- COLLECT
COMPENSATING DEAL
CURRENT ACCOUNT
CURRENT ACCOUNT-RET
SPECIFIED ACCOUNT
SUSPENSE ACCOUNT
CHIPS
SWIFT
** @YD  USED BY SR. ZA0680 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZA0680 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
