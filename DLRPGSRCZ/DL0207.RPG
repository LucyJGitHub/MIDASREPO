     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Todays deals Fixed & Non-Fixed Deposits')     *
      *****************************************************************
      *                                                               *
      *  Midas Dealing Module                                         *
      *                                                               *
      *       DL0207  - List of Today's Deals                         *
      *                 Fixed Deposits and Non-Fixed Deposits         *
      *                 (Based on DL0205)                             *
      *                                                               *
      *  (c) Finastra International Limited 2004                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD040757           Date 25Aug16               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR1077561          Date 08Feb13               *
      *                 AR645214           Date 21Dec12               *
      *                 AR916521           Date 13Dec12               *
      *                 CRE073             Date 06Dec10               *
      *                 261285             Date 31Jul09               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      *                 BUG13691           Date 03Apr07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG9013            Date 13Jun06               *
      *                 239244             Date 31May06               *
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10282           Date 04Feb06               *
      *                 BUG7957            Date 07Jul05               *
      *                 CDL038             Date 10May05               *
      *                 BUG7866            Date 15Jul05               *
      *                 BUG7749            Date 24Jun05               *
      *                 BUG7484            Date 21Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG6235            Date 05Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG4662            Date 08Nov04               *
      *                 CDL016  *CREATE    Date 06Oct04               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD040757 - DLC0601G 0001-0003 component failed during COB    *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  AR1077561 - Avoid DB error 027                               *
      *  AR645214 - Database error when getting the account code for  *
      *             a closed retail account.  Apply fix 256776.       *
      *             (Child: AR645215)                                 *
      *  AR916521 - DLC0601G failed due to dropped account. Suppress  *
      *             database error on missing/closed account. Just    *
      *             print text 'missing/closed account'.              *
      *             (Child: AR916522)                                 *
      *  CRE073 - Interest Rate Rounding                              *
      *  261285 - Database Error on closed Nostro due to AONOSTR0     *
      *           hard coded Return Code.                             *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG13691 - COB Error on SDNOSTPD                             *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG9013- Use Short Term Rate/Effective Int. Rate for RS and  *
      *           RX deals if specified.                              *
      *  239244 - When trailer does not match, do not halt COB.       *
      *           Show audit report for information purposes only.    *
      *           Patterned fix after 236008.                         *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10282 - Fix field CLAS for DEALSDC.                       *
      *  BUG7957 - DLC0601G failed                                    *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BUG7866 - OCBC 70343: DL0207 List of Today's Deals -         *
      *            Fixed Deposit & Non-Fixed                          *
      *  BUG7749 - Prevent DB error in SDNOSTPD                       *
      *  BUG7484 - Additional fix for BUG6235.                        *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG6235 - DBASE error 027. Incorrect settlement details for  *
      *            Negotiable Assets and IRS.                         *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG4662- DB Error upon calling AONOSTR0 due to blank nostro  *
      *           code.                                               *
      *  CDL016 - Automatic Rollover of Fixed Term Loans/Deposits     *
      *                                                               *
      *****************************************************************
     FDTRSD   IP  F      40  1AI     1 DISK
     FDTRIXHH IS  F      40  1AI     1 DISK
     F***DEALS***IF  F    2325  6AI     2 DISK                                               BUG6235
     F*DEALS**IF**F****2540**6AI*****2*DISK                                           BUG6235 CDL038
     FDEALS   IF  F    2606  6AI     2 DISK                                                   CDL038
     FDLDEALL5IF  E           K        DISK
     FMMDEALLLIF  E           K        DISK         KINFSR *PSSR
     F                                              KINFDS INHDS
     FFXDEALLLIF  E           K        DISK         KINFSR *PSSR
     FACNUM   IF  F     117 10AI     2 DISK
     F*
     FDL0207P1O   F     132     OF     PRINTER      KPRTCTLPRTDS      UC
     F                                              KINFDS SPOOL
     FDL0207AUO   F     132     OA     PRINTER      KINFDS SPOOLU
     F*
     F*
     F*
     F*
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            DEAL TRANS.INDEX DETAIL RECORD
     F* 02            REPORT REQUESTED IS 'TD' ONLY
     F* 03            INSTALLATION CONTROL DATA RECORD 1
     F* 04            REPORT REQUESTED IS NON-TD ONLY
     F* 05            CUSTOMER RECORD 'A'
     F* 06            DEALS - FOREIGN EXCHANGE RECORD
     F* 07            DEALS - LOAN/DEPOSIT RECORD
     F* 08            DEALS - NEGOTIABLE ASSET PURCHASED RECORD
     F* 09            DEALS - NEGOTIABLE ASSET SOLD RECORD
     F* 10            DEALS - TRAILER RECORD
     F* 11            DEALS - FRA/IRS RECORD
     F* 12            RETAIL ACCOUNT NUMBER RECORD
     F* 13            FLOOR DEAL TYPE 'RF'
     F* 16            PRINT O/R ID IF IT IS NOT BLANK
     F* 17            PAYMENT SETTLEMENT TYPE 14
      *       18      CLE025 is Installed                             *
     F*    19         S01471 IS INSTALLED
     F*    20         BASE CURRENCY FOUND IN ARRAY
     F*    21         SAR S01453 Installed
     F*    22         ZERO NOTICE DAYS ,'CALL', ON LOAN/DEPOSIT RECORD
     F*    23         ZERO MATURITY DATE ON LOAN/DEP. RECORD
     F*    24         BASE CURRENCY HAS 0 DECIMAL PLACES
     F*    25         BASE CURRENCY HAS 1 DECIMAL PLACES
     F*    26         List All FX Deals Only
     F*    27         List All MM Deals Only
     F*    28         BASE CURRENCY HAS 2 DECIMAL PLACES
     F*    29         BASE CURRENCY HAS 3 DECIMAL PLACES
     F*       30      MBIN = Y  MULTIBRANCH
     F*       31      ROLLOVER SWITCH
     F*       33      INDICATOR FOR FR, RR,RP,RF - SOLD IF ON
     F*       34      DEAL TYPE IS 'OP' - FX OPTION
     F*       35      ZERO DECIMAL PLACES FOR CURRENCY - PURCHASE FOR FX
     F*                                                - OUR FOR FRA/IRS
     F*       36      ZERO DECIMAL PLACES FOR FX SALE CURRENCY
     F*       37      DEAL TYPE IS 'OT' - OPTION TAKEDOWN
     F*       38      CHANGE TYPE IS AMEND
     F*       39      LOAN/DEP. RECORD IS FOR NOTICE DEAL
     F*       40      LOAN/DEP. OR NA PURCHASED RECORD
     F*       41      SKIP FIRST CYCLE PROCESSING
     F*       42      FAILED CHAIN TO DEALS FILE
     F*       43      CHANGE TYPE IS INSERT
     F*       44      CHANGE TYPE IS DELETE
     F*       45      Feature CDL006 (Fiduciary Deposit) activated.
     F*       46      1 DECIMAL PLACE  FOR CURRENCY - PURCHASE FOR FX
     F*                                             - OUR FOR FRA/IRS
     F*       47      2 DECIMAL PLACES FOR CURRENCY - PURCHASE FOR FX
     F*                                             - OUR FOR FRA/IRS
     F*       48      3 DECIMAL PLACES FOR CURRENCY - PURCHASE FOR FX
     F*                                             - OUR FOR FRA/IRS
     F*       49      FAILED CHAIN TO CUSTOMER MASTER FILE
     F*       51      CONTROLS FOR INSERTED RECORDS OUT OF BALANCE
     F*       52      CONTROLS FOR DELETED  RECORDS OUT OF BALANCE
     F*       53      1 DECIMAL PLACE  FOR FX SALE CURRENCY
     F*       54      2 DECIMAL PLACES FOR FX SALE CURRENCY
     F*       55      3 DECIMAL PLACES FOR FX SALE CURRENCY
     F*       56      1ST LEG SWAP EXPIRED
     F*       59      Portfolio Management is swicthed on.
     F*       61      FRA/IRS TYPE RX DEAL
     F*       62      FRA/IRS TYPE RP, RF, AND RR DEAL
     F*       63      FRA/IRS RATE 1 FIXED ( N63 RATE 1 FLOATING )
     F*       64      FRA/IRS RATE 2 FIXED ( N64 RATE 2 FLOATING )
     F*       65      IRS TYPE RX - 0 DECIMAL PLACES FOR THEIR AMOUNT
     F*       66                  - 1  "   "  PLACE   "    "    "  "
     F*       67                  - 2  "   "  PLACES  "    "    "  "
     F*       68                  - 3  "   "  PLACES  "    "    "  "
     F*       69      FRA/IRS FLOOR RATE PRESENT FOR TYPE RF, RP, RR DEAL
     F*       70      TEST FOR DETAIL RECORD READ
      *       74      Print CDL020 Details
     F*       75      DRS DEAL - DEAL TYPE FOUND ON DEAL TYPES ARRAY
     F*       76      Print Details
     F*       77      NOSTRO XFER
     F*       78      BASE CCY OVERRIDE USED + DEAL < 30 DAYS FWD
     F*       79      Print file DL0207P1 is OPEN
     F*       80      Analytical Accounting is switched on
     F*       81      Funding Profit Centre is blank
     F*       82      FX Netting installed
      *       83      CHAIN for DLDEALL5                              *
      *       84      Print CDL016 Bloked indicator Details
      *       85      Print CDL016 Details
      *       86      Print CDL019 Details
      *       87      Print CDL017 Details
     F*    U1         INTERIM REPORT
     F********************************************************************
     E*
     E***  TABLES AND ARRAYS
     E*
     E                    CPY@    1   1 80
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    TABTYP 30  30  2
     E                    TABTZP  8   8  2
     E                    L01        80  1
     E                    L22        22  1
     E/COPY ZSRSRC,ZFRPEDZ1
     E**
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - HEADER RECORD.
     I*
     IDTRIXHH NS
     I*
     I*    DEAL TRANSACTIONS INDEX FILE - DETAIL RECORD.
     I*
     IDTRSD   NS  01   1 CD   2 CD  20 C
     I                                        1   1 RECI
     I                                        2   2 RCDT
     I                                        3   80DLNO
     I                                        9  130VDAT
     I                                       14  160DASN
     I                                       17  17 CHTP1
     I                                       18  18 CNRQ
     I                                       19  19 CNPR
     I                                       20  20 REPR
     I                                       22  250TIM
     I                                       26  26 DADI
     I                                       27  270PRI1
     I                                       28  280PRI2
     I                                       29  290PRI3
     I                                       35  37 DBRCA L1
     I                                    P  38  400TNLU
     I*
     I*    CATCHALL
     I*
     IDTRSD   NS
     I*
     I*
     I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
     I*
     IDEALS   NS  06   1 CD   8 CB
     I       OR        1 CE   8 CB
     I       OR        1 CM   8 CB
     I       OR        1 CR   8 CB
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                       17  19 BRCA
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320OTDT
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 PUCY
     I                                    P  49  550PUAM
     I                                    P  56  628EXRT
     I                                       86  88 SLCY
     I                                    P  89  950SLAM
     I                                    P 117 1230BCEQ
     I                                    P 131 1378LCXR
     I                                      138 1390PCST
     I                                      140 151 OPCAQQ
     I                                      152 161 TSCN
     I                                      162 1630SCST
     I                                      164 175 OSCAQQ
     I                                      176 185 TPCN
     I                                    P 192 1980ORPA
     I                                    P 205 2110ORSA
     I                                      212 2120FSLI
     I                                    P 241 2470SPPD
     I                                    P 248 2540SPLA
     I                                      255 257 SPLC
     I                                      285 2900SODN
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC
     I                                      403 4080LNKDN
     I                                      409 4100RSTM
     I                                      411 422 RONSQQ
     I                                      423 430 RIBN
     I                                      431 465 RIBA
     I**********                            466 4710ROBN                                      CSD027
     I**********                            472 4770ROCN                                      CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM
     I                                      480 491 PONSQQ
     I                                      492 499 PIBN
     I                                      500 534 PIBA
     I**********                            535 5400POBN                                      CSD027
     I**********                            541 5460POCN                                      CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN
     I                                      555 589 RCRA
     I                                      590 597 RVNO
     I                                      598 605 AWBN
     I                                      606 640 AWBA
     I                                      641 648 BENN
     I                                      649 683 BENA
     I                                      684 718 DTP1
     I                                      719 753 DTP2
     I                                      754 788 DTP3
     I                                      789 823 DTP4
     I                                      824 826 DCHG
     I                                      827 861 BTB1
     I                                      862 896 BTB2
     I                                      897 931 BTB3
     I                                      932 966 BTB4
     I                                      9671001 BTB5
     I                                     10021036 BTB6
     I                                     10371039 ORBR
     I                                     10401043 PRFC
     I                                     10441046 ROBR
     I                                     10471049 POBR
     I                                    P106710702MGPT
     I                                     10811081 MGBS
     I                                    P110711138BDBS
     I                                    P112811312BDBF
     I                                    P113211352SDBF
     I                                     11501153 PTFR
     I                                     11591159 NETBY
     I                                     11601178 NETBR
     I                                     11791179 NETSL
     I                                     11801198 NETSR
     I                                     11991199 MATCH
     I                                     12921309 OPCA
     I                                     13101327 OSCA
     I                                     13281345 RONS
     I                                     13461363 PONS
     I                                     13641367 CLAS                                      CDL038
     I*
     I*
     I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
     I*
     IDEALS   NS  07   1 CD   8 CC
     I       OR        1 CE   8 CC
     I       OR        1 CM   8 CC
     I       OR        1 CR   8 CC
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                       17  19 BRCA
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320MDAT            23
     I                                       33  340CDAS
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550PCPL
     I                                       56  56 INTC
     I**********                             63  640BRTT                                      CSD103
     I                                       63  64 BRTT                                      CSD103
     I                                    P  65  707BRTE
     I                                    P  71  767RTSP
     I                                    P  77  827INTR
     I                                       83  850NOTD            22
     I                                       86 105 RNNA
     I**********                            106 1110CHNA                                      CSD027
     I                                      106 111 CHNA                                      CSD027
     I                                      112 1140FACT
     I                                      115 1160FCNO
     I                                    P 117 1230OPAM
     I                                    P 124 1308BCXR
     I                                    P 131 1378LCXR
     I                                      138 1390SDST
     I                                      140 151 OSDAQQ
     I                                      152 161 TSTN
     I                                      162 1630MDST
     I                                      164 175 OMDAQQ
     I                                      176 185 TMAN
     I                                      186 1910RODN
     I                                    P 192 1980RODA
     I                                      199 2040RBDN
     I                                    P 205 2110RBDA
     I                                      212 2120ICBS
     I                                      213 213 IPFR
     I                                    P 214 2200TOTI
     I                                    P 221 2230NIDT
     I                                    P 224 2260IBDT
     I                                    P 227 2290SLID
     I                                    P 230 2360AIPD
     I                                    P 237 2390DLRC
     I                                    P 240 2420IACD
     I                                    P 243 2490AITC
     I                                    P 250 2560AIAN
     I                                    P 257 2630AIAP
     I                                    P 264 2700IPRD
     I                                    P 271 2770IPRM
     I                                    P 278 2840ICTD
     I                                    P 294 2960DAVD
     I                                      297 2990DASN
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      345 3460INTF
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 413 DBLN
     I                                      414 414 DRID
     I                                      415 420 DDMR
     I                                      421 422 BOKC
     I                                      423 4280LNKDN
     I                                      429 4300RSTM
     I                                      431 442 RONSQQ
     I                                      443 450 RIBN
     I                                      451 485 RIBA
     I**********                            486 4910ROBN                                      CSD027
     I**********                            492 4970ROCN                                      CSD027
     I                                      486 491 ROBN                                      CSD027
     I                                      492 497 ROCN                                      CSD027
     I                                      498 4990PSTM
     I                                      500 511 PONSQQ
     I                                      512 519 PIBN
     I                                      520 554 PIBA
     I**********                            555 5600POBN                                      CSD027
     I**********                            561 5660POCN                                      CSD027
     I                                      555 560 POBN                                      CSD027
     I                                      561 566 POCN                                      CSD027
     I                                      567 574 RCRN
     I                                      575 609 RCRA
     I                                      610 617 RVNO
     I                                      618 625 AWBN
     I                                      626 660 AWBA
     I                                      661 668 BENN
     I                                      669 703 BENA
     I                                      704 738 DTP1
     I                                      739 773 DTP2
     I                                      774 808 DTP3
     I                                      809 843 DTP4
     I                                      844 846 DCHG
     I                                      847 881 BTB1
     I                                      882 916 BTB2
     I                                      917 951 BTB3
     I                                      952 986 BTB4
     I                                      9871021 BTB5
     I                                     10221056 BTB6
     I                                     10571059 ORBR
     I                                     10601063 PRFC
     I                                     10641066 ROBR
     I                                     10671069 POBR
     I                                     10751075 AURO
     I                                     10761076 IPDS
     I                                     10771077 ROFQ
     I                                     107810790RLDN
     I                                     10801114 CNNA
     I                                     11151116 IMET
     I                                     11171131 INSAQQ
     I                                     11321141 INOS
     I                                     11431146 PTFR
      * Analytical Accounting fields
     I                                    P115511607FSRP
     I                                     11611161 FSGN
     I                                     11621165 FPRC
      *
      ** Dealing Fiduciary fields
      *
     I                                     12401241 FCGC
     I                                     12421261 FCGD
     I                                    P126212680FCGA
     I                                     12741275 FCMC
     I                                     12761295 FCMD
     I                                    P129613020FCMA
     I                                    P157115730OMDT
     I                                    P157415800PENA
     I                                     15811590 BUSR
     I*
     I                                     17211738 OSDA
     I                                     17391756 OMDA
     I                                     17571774 RONS
     I                                     17751792 PONS
     I                                     17931813 INSA
     I                                     18141814 FSROLI
     I                                     18151834 FSSOFD
     I                                     18351835 FSBLKA
     I                                    P183618380FSCAND
     I                                     18391839 FSPNPR
     I                                     18401840 FSFBRT
     I**********                           18981901 CLAS                             CDL038 BUG10282
     I                                     20102013 CLAS                                    BUG10282
     I                                    P212321287CNSP                                      CRE073
     I                                     21292135 RDMT                                      CRE073
     I                                     21362139 RDFD                                      CRE073
     I*
     I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
     I*
     IDEALS   NS  08   1 CD   8 CD
     I       OR        1 CE   8 CD
     I       OR        1 CM   8 CD
     I       OR        1 CR   8 CD
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160ISCN                                      CSD027
     I                                       11  16 ISCN                                      CSD027
     I                                       17  19 BRCA
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320MDAT
     I                                       33  340IDAS
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550PUPR
     I                                    P  57  627YRAT
     I                                    P  71  767RTSP
     I                                    P  77  827INTR
     I                                       86 105 RNNA
     I**********                            106 1110PCUS                                      CSD027
     I                                      106 111 PCUS                                      CSD027
     I                                      112 1140FACT
     I                                      115 1160FCNO
     I                                    P 117 1230FVAL
     I                                    P 124 1308BCXR
     I                                    P 131 1378LCXR
     I                                      138 1390SDST
     I                                      140 151 OSDAQQ
     I                                      152 161 TSTN
     I                                      162 1630MDST
     I                                      164 175 OMDAQQ
     I                                      176 185 TMAN
     I                                    P 192 1980DISA
     I                                    P 205 2110DPTD
     I                                      212 2120ICBS
     I                                      213 213 IPFR
     I                                    P 214 2200TOTI
     I                                    P 221 2230NIDT
     I                                    P 224 2260IBDT
     I                                    P 227 2290SLID
     I                                    P 230 2360AIPD
     I                                    P 237 2390DLRC
     I                                    P 240 2420IACD
     I                                    P 243 2490AITC
     I                                    P 250 2560AIAN
     I                                    P 257 2630AIAP
     I                                    P 264 2700IPRD
     I                                    P 271 2770IPRM
     I                                    P 278 2840SAPRX
     I                                      285 2900ASDN
     I                                    P 291 2930SADT
     I                                    P 294 2960DAVD
     I                                      297 2990DASN
     I                                      300 309 FACO
     I                                      310 344 SPI
     I                                      345 3460INTF
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC
     I                                      403 4080LNKDN
     I                                      409 4100RSTM
     I                                      411 422 RONSQQ
     I                                      423 430 RIBN
     I                                      431 465 RIBA
     I**********                            466 4710ROBN                                      CSD027
     I**********                            472 4770ROCN                                      CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM
     I                                      480 491 PONSQQ
     I                                      492 499 PIBN
     I                                      500 534 PIBA
     I**********                            535 5400POBN                                      CSD027
     I**********                            541 5460POCN                                      CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN
     I                                      555 589 RCRA
     I                                      590 597 RVNO
     I                                      598 605 AWBN
     I                                      606 640 AWBA
     I                                      641 648 BENN
     I                                      649 683 BENA
     I                                      684 718 DTP1
     I                                      719 753 DTP2
     I                                      754 788 DTP3
     I                                      789 823 DTP4
     I                                      824 826 DCHG
     I                                      827 861 BTB1
     I                                      862 896 BTB2
     I                                      897 931 BTB3
     I                                      932 966 BTB4
     I                                      9671001 BTB5
     I                                     10021036 BTB6
     I                                     10371039 ORBR
     I                                     10401043 PRFC
     I                                     10441046 ROBR
     I                                     10471049 POBR
     I                                     10551055 PCLI
     I                                    P105910650OPUP
      * Analytical Accounting fields
     I                                    P106910747FSRP
     I                                     10751075 FSGN
     I                                     10761079 FPRC
     I**********                           11821199 OMDA                                     BUG4662
     I**********                           12001217 OSDA                                     BUG4662
     I**********                           12181235 RONS                                     BUG4662
     I**********                           12361253 PONS                                     BUG4662
     I                                     12451262 OSDA                                     BUG4662
     I                                     12631280 OMDA                                     BUG4662
     I                                     12811298 RONS                                     BUG4662
     I                                     12991316 PONS                                     BUG4662
     I                                     13171320 CLAS                                      CDL038
     I*
     I*
     I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
     I*
     IDEALS   NS  09   1 CD   8 CE
     I       OR        1 CE   8 CE
     I       OR        1 CM   8 CE
     I       OR        1 CR   8 CE
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                       17  19 BRCA
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  48 CCY
     I                                    P  49  550SAPR
     I                                    P  57  627YRAT
     I                                    P  77  827INTR
     I                                       86 105 RNNA
     I**********                            106 1110ISCN                                      CSD027
     I                                      106 111 ISCN                                      CSD027
     I                                    P 117 1230FVAL
     I                                      138 1390SETP
     I                                      140 151 OSACQQ
     I                                      152 161 TSEN
     I                                      162 164 ORBR
     I                                      165 167 ROBR
     I                                      168 171 PRFC
     I                                      285 2900RPDN
     I                                      370 370 DNSI
     I                                      371 371 DSTI
     I                                      372 372 CNFI
     I                                      373 373 ACEI
     I                                      374 374 TLXI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                      401 402 BOKC
     I                                      403 4080LNKDN
     I                                      409 4100RSTM
     I                                      411 422 RONSQQ
     I                                      423 430 RIBN
     I                                      431 465 RIBA
     I**********                            466 4710ROBN                                      CSD027
     I**********                            472 4770ROCN                                      CSD027
     I                                      466 471 ROBN                                      CSD027
     I                                      472 477 ROCN                                      CSD027
     I                                      478 4790PSTM
     I                                      480 491 PONSQQ
     I                                      492 499 PIBN
     I                                      500 534 PIBA
     I**********                            535 5400POBN                                      CSD027
     I**********                            541 5460POCN                                      CSD027
     I                                      535 540 POBN                                      CSD027
     I                                      541 546 POCN                                      CSD027
     I                                      547 554 RCRN
     I                                      555 589 RCRA
     I                                      590 597 RVNO
     I                                      598 605 AWBN
     I                                      606 640 AWBA
     I                                      641 648 BENN
     I                                      649 683 BENA
     I                                      684 718 DTP1
     I                                      719 753 DTP2
     I                                      754 788 DTP3
     I                                      789 823 DTP4
     I                                      824 826 DCHG
     I                                      827 861 BTB1
     I                                      862 896 BTB2
     I                                      897 931 BTB3
     I                                      932 966 BTB4
     I                                      9671001 BTB5
     I                                     10021036 BTB6
     I                                     10381038 PCLI
     I                                     10481065 OSAC
     I                                     10661083 RONS
     I                                     10841101 PONS
     I                                     11021105 CLAS                                      CDL038
     I*
     I*
     I*    DEALS FILE - DETAIL - FRA/IRS
     I*
     IDEALS   NS  11   1 CD   8 CG
     I       OR        1 CE   8 CG
     I       OR        1 CM   8 CG
     I       OR        1 CR   8 CG
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                       17  19 BRCA
     I                                       20  21 DTYP
     I                                       22  23 DLST
     I                                    P  24  260DDAT
     I                                    P  27  290VDAT
     I                                    P  30  320MDAT
     I                                       33  340CDAS
     I                                       35  38 BRKC
     I                                    P  39  450BAGE
     I                                       46  510LNKDN
     I                                       52  52 HEDIN
     I                                       53  53 TAXI
     I                                       54  56 UCUCY
     I                                    P  57  630UPAMT
     I**********                             64  650UBRTT                                     CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT
     I                                    P  72  777UBRTE
     I                                    P  78  837URTSP
     I                                       84  84 USPIN
     I                                    P  85  907UEINR
     I                                       91  910UICBS
     I                                       92  930UFRFD
     I                                    P  94  960UINFD
     I                                    P  97  990USLIP
     I                                    P 100 1020UNICD
     I                                    P 103 1050UICBD
     I                                      106 106 UICFR
     I                                      107 1080UICFD
     I                                    P 109 1110UNIPD
     I                                    P 112 1140UIPBD
     I                                      115 115 UIPFR
     I                                      116 1170UIPFD
     I                                    P 118 1248UBCXR
     I                                    P 125 1270UIACD
     I                                    P 128 1340UIALC
     I                                    P 135 1410UAITC
     I                                    P 142 1480UAIPD
     I                                    P 149 1550UAIAN
     I                                    P 156 1620UAIAP
     I                                    P 163 1690UIPRD
     I                                    P 170 1760UIPRM
     I                                    P 177 1830UNSAM
     I                                    P 184 1900UTAXD
     I                                    P 191 1970UTAXM
     I                                      198 200 TCUCY
     I                                    P 201 2070TPAMT
     I**********                            208 2090TBRTT                                     CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT
     I                                    P 216 2217TBRTE
     I                                    P 222 2277TRTSP
     I                                      228 228 TSPIN
     I                                    P 229 2347TEINR
     I                                      235 2350TICBS
     I                                      236 2370TFRFD
     I                                    P 238 2400TINFD
     I                                    P 241 2430TSLIP
     I                                    P 244 2460TNICD
     I                                    P 247 2490TICBD
     I                                      250 250 TICFR
     I                                      251 2520TICFD
     I                                    P 253 2550TNIPD
     I                                    P 256 2580TIPBD
     I                                      259 259 TIPFR
     I                                      260 2610TIPFD
     I                                    P 262 2688TBCXR
     I                                    P 269 2710TIACD
     I                                    P 272 2780TIALC
     I                                    P 279 2850TAITC
     I                                    P 286 2920TAIPD
     I                                    P 293 2990TAIAN
     I                                    P 300 3060TAIAP
     I                                    P 307 3130TIPRD
     I                                    P 314 3200TIPRM
     I                                    P 321 3270TNSAM
     I                                    P 328 3340TTAXD
     I                                    P 335 3410TTAXM
     I                                    P 342 3477CLRAT
     I                                    P 348 3537FLRAT
     I                                    P 354 3550AVPER
     I                                    P 356 3638TIRAT
     I                                    P 364 3697AACRT
     I                                      370 3710RSETM
     I                                      372 383 URACQQ
     I                                      384 393 CPPBK
     I                                      394 3950PSETM
     I                                      396 407 UPACQQ
     I                                      408 417 CPRBK
     I                                      418 427 FACO
     I                                      428 462 SPI
     I                                    P 463 4650SDCAR
     I                                    P 466 4680ULPCD
     I                                    P 469 4710TLPCD
     I                                    P 472 4780UAEXA
     I                                    P 479 4850TAEXA
     I                                      569 569 BYSL
     I                                      570 570 UDNSI
     I                                      571 571 TDNSI
     I                                      572 572 UDSTI
     I                                      573 573 TDSTI
     I                                      574 574 CNFI
     I                                      575 575 ACEI
     I                                      576 576 TLXI
     I                                    P 587 5880LSWC
     I                                    P 589 5900LSWS
     I                                    P 591 5930ORED
     I                                    P 594 5960LCD
     I                                      597 597 CHTP
     I                                    P 598 6000TNLU
     I                                      601 602 BOKC
     I                                      603 605 ORBR
     I                                      606 608 ROBR
     I                                      609 611 POBR
     I                                      612 615 PRFC
     I                                      616 616 UINPM
     I                                    P 617 6190UNPCD
     I                                      620 620 TINPM
     I                                    P 621 6230TNPCD
     I                                    P 624 6260UPVD
     I                                    P 627 6330UPFE
     I                                      634 634 UPPR
     I                                    P 635 6410UPAD
     I                                    P 642 6440BODD
     I                                    P 645 6470BOVD
     I                                    P 648 6540BOAM
     I                                      655 655 BAPR
     I                                    P 656 6630OUSI
     I                                    P 664 6710OUSA
     I                                    P 672 6790TUSI
     I                                    P 680 6870TUSA
     I                                      688 688 URFIN
     I                                      689 689 TRFIN
     I                                    P 690 6957UOBRT
     I                                    P 696 7017TOBRT
     I                                    P 702 7080UOPAM
     I                                    P 709 7150TOPAM
     I                                      716 7170RSTM
     I                                      718 729 RONSQQ
     I                                      730 737 RIBN
     I                                      738 772 RIBA
     I**********                            773 7780ROBN                                      CSD027
     I**********                            779 7840ROCN                                      CSD027
     I                                      773 778 ROBN                                      CSD027
     I                                      779 784 ROCN                                      CSD027
     I                                      785 7860PSTM
     I                                      787 798 PONSQQ
     I                                      799 806 PIBN
     I                                      807 841 PIBA
     I**********                            842 8470POBN                                      CSD027
     I**********                            848 8530POCN                                      CSD027
     I                                      842 847 POBN                                      CSD027
     I                                      848 853 POCN                                      CSD027
     I                                      854 861 RCRN
     I                                      862 896 RCRA
     I                                      897 904 RVNO
     I                                      905 912 AWBN
     I**********                           22012201 FIDSTS                                   BUG6235
     I**********                           22542271 RONS                                     BUG6235
     I**********                           22722289 PONS                                     BUG6235
     I**********                           22902307 UPACC                                    BUG6235
     I**********                           23082325 URACC                                    BUG6235
     I                                     22112211 FIDSTS                                   BUG6235
     I                                     24692486 URACC                                    BUG6235
     I                                     24872504 UPACC                                    BUG6235
     I                                     25052522 RONS                                     BUG6235
     I                                     25232540 PONS                                     BUG6235
     I                                     26032606 CLAS                                      CDL038
     I*
     I*
     I*    DEALS FILE -TRAILER RECORD.
     I*
     IDEALS   NS  10   1 CT
     I                                        1   1 RECI
     I                                        2   70DLNO
     I                                        8   8 RCDT
     I                                        9  100RCDC
     I**********                             11  160CNUM                                      CSD027
     I                                       11  16 CNUM                                      CSD027
     I                                    P  17  190NORE
     I                                    P  20  220FLSZ
     I                                    P  23  250NLRB
     I                                    P  26  280NINS
     I                                    P  29  310NDEL
     I                                    P  32  340NLRA
     I                                    P  35  420VLBF
     I                                    P  43  440VLBL
     I                                    P  45  520VRIF
     I                                    P  53  540VRIL
     I                                    P  55  620VRDF
     I                                    P  63  640VRDL
     I                                    P  65  720VLAF
     I                                    P  73  740VLAL
     I                                    P  75  770DTMR
     I                                    P  78  800ITMR
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I*
     I*
     I*    DEALS FILE - CATCHALL.
     I*
     IDEALS   NS
     I*
     I** Core hook for externalisation.
     I*
     I*
     I*
     I*
     I*
     I*
     I*    ACNUM FILE - RETAIL ACCOUNT NO. RECORD
     I*
     I***ACNUM**   NS  81   1 CD                                                            AR645214
     IACNUM   NS  81                                                                        AR645214
     I                                       21  300ACOD
     I*
     I*
     I*    ACNUM FILE - CATCHALL
     I*
     IACNUM   NS
     I*
     I*
     I*    DATA STRUCTURES FOR AMOUNT FIELDS
     I            DS
     I                                        1  130AMT
     I                                        1  130PUAM
     I                                        1  130PCPL
     I                                        1  130PUPR
     I                                        1  130UPAMT
     I*
     I            DS
     I                                        1  130AMTA
     I                                        1  130SLAM
     I                                        1  130SAPR
     ILDA         DS                            256
     I**  Local data area for data base errors.
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 183 DBASE
     I*
     ISPOOL       DS
     I**   FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILE
     I                                    B 123 1240SFNUM
     I**
     ISPOOLU      DS
     I**   FILE INFORMATION DATA STRUCTURE
     I                                       83  92 SFILEU
     I                                    B 123 1240SFNUMU
     I**
     IPRTDS       DS
     I* PRINT CONTROL FOR DL0207P1
     I                                        8   90CURLIN
     I*
     I**
     I** DEFINE THE EXTERNAL DATA AREA MMOD
     I**ODS       DS                             64
     IMMODS       DS                            256
     I                                       13  14 MODS
     I*
     I** INFORMATION DATA STRUCTURE FOR MM DEALS FORMAT ACCESSED
     I*
     IINHDS       DS
     I                                     *RECORD  RECHMT
     I*
     I*
     ISDBRCH    E DSSDBRCHPD
     I** External DS for BRANCH Details
     I*
     ISDBANK    E DSSDBANKPD
     I** EXTERNAL DS FOR BANK DETAILS
     I*
     ISDCURR    E DSSDCURRPD
     I** EXTERNAL DS FOR CURRENCY DETAILS
     I*
     ISDNOST    E DSSDNOSTPD
     I              QQACCD                          QQACC1
     I** EXTERNAL DS FOR NOSTRO DETAILS
     I*
     ISDRETL    E DSSDRETLPD
     I              QQACCD                          QQACC2
     I** EXTERNAL DS FOR RETAIL SD DETAILS
     I*
     ISDACOD    E DSSDACODPD
     I              QQACCD                          QQACC3
     I** EXTERNAL DS FOR ACCOUNT CODE DETAILS
     I*
     ISDCUST    E DSSDCUSTPD
     I** EXTERNAL DS FOR CUSTOMER DETAILS
     I              QQDFAC                          QQDFAX
     I*
     ISDPORT    E DSSDPORTPD
     I** External DS for Portfolio Management ICD.
     I*
     ISDMMOD    E DSSDMMODPD
     I** External DS for Module Details.
     I*
     ISDGELR    E DSSDGELRPD
     I** External DS for General Ledger Details.
     I*
     IDSFDY     E DSDSFDY
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     I*
     IRUNDAT      DS
     I                                       13  13 @MBIN
     I*
     ISCSARD    E DSSCSARDPD
     I** DATA STRUCTURE FOR ROLLOVER SWITCH ON FILE
     I*
     I*
     I** Constants for PF/RSACMTPD Narrative text.
     I*
     I              'Up-Front Fee'        C         @UPFNT
     I              'Premium'             C         @PREM
     I              'Buy-Out Amount'      C         @BYOUT
     I              'payment due'         C         @PAYDU
     I              'receipt due'         C         @RECDU
     I*
     I/COPY ZSRSRC,ZFRPEDZ2
     I*
     I*
     I/EJECT
     C*    ALL CYCLES AFTER FIRST
     C*
     C*
     C           *ENTRY    PLIST
     C                     PARM           TYPE    2
     C                     PARM           STPE    1
     C                     PARM           SEQ     5
     C                     PARM           BRNCH   3
     C*
     C                     MOVE 'DL0207 ' DBPGM  10
      *
     C*
     C   41                GOTO TAG1
     C*
     C*    FIRST CYCLE
     C                     SETON                     41
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA
     C*
     C                     MOVE 'N'       S01434  1
     C                     SETOF                     31
     C*
     C*    Check FX Netting switch on
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM '*MSG   ' @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM 'CDL002'  @SARD
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '
     C           *LOCK     IN   LDA                        ***************
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 011 *
     C                     MOVEL'011'     DBASE            ***************
     C                     MOVEL'CDL002'  DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDL002  1
     C                     MOVE *ON       *IN82
     C                     ELSE
     C                     MOVE 'N'       CDL002
     C                     MOVE *OFF      *IN82
     C                     ENDIF
     C*
     C*
      ***  Hardcode CDL016
      *
     C                     MOVE 'Y'       CDL016  1
     C                     MOVE '1'       *IN18
      *
      ***  Check if CDL019 is enabled
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'CDL019'  @SARD
      *
     C                     MOVE 'N'       CDL019  1
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDL019
     C                     ENDIF
      *
      ***  Check if CDL020 is enabled
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'CDL020'  @SARD
      *
     C                     MOVE 'N'       CDL020  1
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDL020
     C                     ENDIF
     C*
     C** Access GL details to determine if originating branch used
     C*
     C                     CALL 'AOGELRR1'
     C                     PARM           UUAPRC  7        B:Return Cd
     C                     PARM '*FIRST'  UUAPOP  7        I:Option
     C           SDGELR    PARM *BLANK    DSSDY
     C           UUAPRC    IFNE *BLANKS
     C           *LOCK     IN   LDA                        ***************
     C                     MOVEL'SDGELRPD'DBFILE           * DBERROR 009 *
     C                     MOVEL'009'     DBASE            ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C                     MOVE '0'       *IN32
     C           BKOBRU    IFEQ 'Y'
     C                     MOVE '1'       *IN32
     C                     END
     C*
     C** Access SAR details file to determine if S01471 (include
     C** fields on report) is on.
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01471'  @SARD
     C           SCSARD    PARM SCSARD    DSFDY
     C           @RTCD     IFNE *BLANKS
     C           @RTCD     ANDNE'*NRF   '
     C           *LOCK     IN   LDA                        ***************
     C                     MOVEL'SCSARDPD'DBFILE           * DBERROR 006 *
     C                     MOVEL'006'     DBASE            ***************
     C                     MOVEL'S01471'  DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C           @RTCD     IFEQ *BLANK
     C                     SETON                     19
     C                     MOVEL'Y'       S01471  1
     C                     ELSE
     C                     SETOF                     19
     C                     MOVEL'N'       S01471
     C                     END
      *
      ** Access SAR details file to determine if CDE002 is switched on
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*VERIFY' POPTN   7
     C                     PARM 'CDE002'  PSARD   6
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C                     MOVE 'N'       CDE002  1
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDE002
     C                     ENDIF
     C*
     C**   INITIALIZE FX AND MM DEAL INDICATORS
     C*
     C                     MOVE '0'       *IN26
     C                     MOVE '0'       *IN27
     C*
     C**   CHECK DEAL AND SET CORRESPONDING INDICATOR
     C*
     C           TYPE      IFEQ 'FX'
     C                     MOVE '1'       *IN26
     C                     ELSE
     C           TYPE      IFEQ 'MM'
     C                     MOVE '1'       *IN27
     C                     END
     C                     END
     C*
     C** Check if switchable feature CIR001 is switched on
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'CIR001'  @SARD   6
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '
     C           *LOCK     IN   LDA
     C                     MOVEL'SCSARDPD'DBFILE           ***************
     C                     MOVEL'009'     DBASE            * DB ERROR 009*
     C                     MOVEL'CIR001'  DBKEY            ***************
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CIR001  1
     C                     MOVE '1'       *IN16
     C                     ELSE
     C                     MOVE 'N'       CIR001
     C                     MOVE '0'       *IN16
     C                     END
      *
      ** Access Switchable Feature Details, Check if CDL006 is
      ** switch on.
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD   7
     C                     PARM '*VERIFY 'POPTN   7
     C                     PARM 'CDL006'  PSARD   6
     C           SCSARD    PARM SCSARD    DSSDY
      *
     C           PRTCD     IFNE *BLANKS
     C           PRTCD     ANDNE'*NRF '
     C           *LOCK     IN   LDA
     C                     MOVEL'012'     DBASE
     C                     MOVEL'SCSARDPD'DBFILE
     C                     MOVELPSARD     DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDL006  1
     C                     MOVE '1'       *IN45
     C                     ELSE
     C                     MOVE 'N'       CDL006
     C                     MOVE '0'       *IN45
     C                     ENDIF
      *
      ** Check if switchable feature CIR006 is switched on
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'CIR006'  @SARD   6
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '
     C           *LOCK     IN   LDA
     C                     MOVEL'SCSARDPD'DBFILE           ************
     C                     MOVEL'013'     DBASE            * DBERR 13 *
     C                     MOVEL'CIR006'  DBKEY            ************
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
      *
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CIR006  1
     C                     ELSE
     C                     MOVE 'N'       CIR006
     C                     ENDIF
     C*
     C*
     C** ACCESS BANK DETAILS
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE           ************
     C                     MOVEL'002'     DBASE            * DBERR 02 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@OPTN     DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     C*
     C** IF S01471 IS PRESENT, ACCESS BASE CURRENCY DETAILS
     C           S01471    IFEQ 'Y'
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM           BJCYCD
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVEL'005'     DBASE            * DBERR 05 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVEL@OPTN     DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
     C           A6NBDP    COMP 1                      2425
     C           A6NBDP    COMP 2                    29  28
     C                     END
     C                     END
     C**
     C**  GET RUNDAT to access MULTI-BRANCHING flag.
     C**
     C           *NAMVAR   DEFN           RUNDAT
     C                     IN   RUNDAT
     C*
     C*    SETON INDICATOR FOR PRINTING, IF MULTIBRANCHING = YES
     C*
     C           @MBIN     IFEQ 'Y'
     C                     MOVE '1'       *IN30
     C                     END
     C*
     C** RETRIEVE THE EXTERNAL DATA AREA MMOD
     C           *NAMVAR   DEFN MMOD      MMODS
     C                     IN   MMODS
     C*
     C**   GET TIME IF I/C REPORT
     C                     TIME           TIME    60
     C*
     C           CDL016    IFEQ 'Y'
     C*
     C**  INITIALISE NARRATIVE IF RECORD NOT ON S/RENUM
     C                     MOVEL'MISSING 'NARR1  16
     C                     MOVE '/ CLOSED'NARR1
     C                     MOVE 'ACCOUNT 'NARR2  25
     C                     MOVELNARR1     NARR2
     C*
     C*    ACCESS SDGELRPD FOR COMPUTER SUSPENSE ACCOUNT CODE.
     C*
     C                     CALL 'AOGELRR0'
     C                     PARM *BLANK    @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDGELR    PARM SDGELR    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE '020'     DBASE            **********
     C                     MOVEL'*FIRST ' DBOPTN  7        *  020   *
     C                     MOVEL'*FIRST ' DBKEY            **********
     C                     MOVEL'SDGELRPD'DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     ELSE
     C*
     C** VERIFY PRESENCE IN ACCOUNT CODES FILE.
     C                     CALL 'AOACODR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BKACCD    @AFNB  10
     C           SDACOD    PARM SDACOD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE '021'     DBASE            **********
     C                     MOVEL@OPTN     DBOPTN  7        *  021   *
     C                     MOVELBKACCD    DBKEY            **********
     C                     MOVEL'SDACODPD'DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE BKACCD    SPSNAM 25
     C                     END
     C*
     C*    ACCESS SDRETLPD FOR PRIME CURRENT ACCOUNT NAME.
     C*
     C                     CALL 'AORETLR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE '022'     DBASE            **********
     C                     MOVEL'*FIRST ' DBOPTN  7        *  022   *
     C                     MOVEL'*FIRST ' DBKEY            **********
     C                     MOVEL'SDRETLPD'DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     ELSE
     C*
     C** VERIFY PRESENCE IN ACCOUNT CODES FILE.
     C                     CALL 'AOACODR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM BKACCD    @AFNB  10
     C           SDACOD    PARM SDACOD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE '023'     DBASE            **********
     C                     MOVEL@OPTN     DBOPTN  7        *  023   *
     C                     MOVELBMACCD    DBKEY            **********
     C                     MOVEL'SDACODPD'DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE BMACCD    CURNAM 25
     C                     END
     C*
     C           STPE      IFEQ 'Y'
     C                     MOVE '1'       *IN02
     C                     ELSE
     C           STPE      IFEQ 'N'
     C                     MOVE '1'       *IN04
     C                     END
     C                     END
     C*
     C                     END
     C*
     C**    S01453 not required for type 'MM'
     C*
     C           TYPE      IFEQ 'MM'                       *B1
     C*
     C                     MOVE '0'       *IN21
     C*
     C                     ELSE                            *X1
     C*
     C**    Check if SAR S01453 is installed
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01453'  @SARD   6
     C                     PARM           DSFDY
     C*
     C**    SAR S01453 is installed
     C*
     C           @RTCD     IFEQ *BLANK                     *B2
     C                     MOVE '1'       *IN21
     C                     ELSE                            *X2
     C*
     C**    SAR S01453 is not installed
     C*
     C           @RTCD     IFEQ '*NRF'                     *B3
     C                     MOVE '0'       *IN21
     C                     ELSE                            *X3
     C*
     C**    Database error processing
     C*
     C           *LOCK     IN   LDA                        ***************
     C                     MOVEL'SCSARDPD'DBFILE           *             *
     C                     MOVEL'004'     DBASE            * DBERROR 04  *
     C                     MOVEL'S01453'  DBKEY            *             *
     C                     MOVEL@OPTN     DBOPTN           ***************
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END                             *E3
     C*
     C                     END                             *E2
     C*
     C                     END                             *E1
     C*
     C*    Check Deposit Breakdown Penalty
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM 'CDL007'  @SARD   6
     C           SCSARD    PARM SCSARD    DSFDY
     C*
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CDL007  1
     C                     MOVE *ON       *IN71
     C                     ELSE
     C                     MOVE 'N'       CDL007
     C                     MOVE *OFF      *IN71
     C                     ENDIF
      *
      ** Access AOSARDR0 and check if CIR008 is installed
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*VERIFY' POPTN
     C                     PARM 'CIR008'  PSARD
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           PRTCD     IFNE *BLANKS
     C           PRTCD     ANDNE'*NRF    '
     C           *LOCK     IN   LDA
     C                     MOVE 'SCSARDPD'DBFILE
     C                     MOVEL'014'     DBASE
     C                     MOVEL'CIR008'  DBKEY
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ENDIF
      *
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CIR008  1
     C                     ELSE
     C                     MOVE 'N'       CIR008
     C                     ENDIF
      *
      ** Check if enhancement CLE025 (Credit Lines) is on
      *
     C                     CALL 'AOSARDR0'
     C                     PARM *BLANKS   PRTCD
     C                     PARM '*VERIFY' POPTN
     C                     PARM 'CLE025'  PSARD
     C           SCSARD    PARM SCSARD    DSFDY
      *
     C           PRTCD     IFNE *BLANKS
     C           PRTCD     ANDNE'*NRF   '
     C           *LOCK     IN   LDA
     C                     MOVEL'SCSARDPD'DBFILE
     C                     MOVEL'CLE025'  DBKEY
     C                     MOVE '015'     DBASE
     C                     OUT  LDA
     C                     ENDIF
      *
     C           PRTCD     IFEQ *BLANKS
     C                     MOVE 'Y'       CLE025  1
     C                     ELSE
     C                     MOVE 'N'       CLE025
     C                     ENDIF
      *                                                                                       CRE073
      ** Determine if CRE073 Interest Rate Rounding feature is on.                            CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   PRTCD                                               CRE073
     C                     PARM '*VERIFY' POPTN                                               CRE073
     C                     PARM 'CRE073'  PSARD                                               CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFNE *BLANKS                                                       CRE073
     C           PRTCD     ANDNE'*NRF   '                                                     CRE073
     C           *LOCK     IN   LDA                                                           CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'CRE073'  DBKEY                                               CRE073
     C                     MOVE '016'     DBASE                                               CRE073
     C                     OUT  LDA                                                           CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANKS                                                       CRE073
     C                     MOVE *ON       *IN97                                               CRE073
     C                     ELSE                                                               CRE073
     C                     MOVE *OFF      *IN97                                               CRE073
     C                     ENDIF                                                              CRE073
      *
      ** Access Module details
     C                     CALL 'AOMMODR0'
     C                     PARM '*DBERR ' @RTCD   7          B:Return code
     C                     PARM '*FIRST'  @OPTN   7          I:Option
     C           SDMMOD    PARM SDMMOD    DSFDY              O:Rec format
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDMMODPD'DBFILE           *************
     C                     MOVEL'007'     DBASE            * DBERR 007 *
     C                     MOVEL@OPTN     DBOPTN  7        *************
     C                     OUT  LDA
     C                     SETON                     U7U8
     C                     EXSR *PSSR
     C                     END
      *
      ** Check if Analytical Accounting is switched on.
      ** or Revenue Analysis is installed
      *
     C           BGN0ST    IFEQ 'Y'
     C           CDE002    OREQ 'Y'
     C                     MOVE *ON       *IN80
     C                     ELSE
     C                     MOVE *OFF      *IN80
     C                     ENDIF
      *
     C           BGN4ST    IFEQ 'Y'
     C                     MOVE *ON       *IN72
     C                     MOVE *ON       *IN59
     C                     ELSE
     C                     MOVE *OFF      *IN72
     C                     MOVE *OFF      *IN59
     C                     ENDIF
     C*
     C** Get non-Portfolio reference if PM is switched on.
     C*
     C           BGPFMG    IFEQ 'Y'
      *
     C                     MOVE *ON       *IN59
      *
      ** Access PM ICD File.
     C                     CALL 'AOPORTR0'
     C                     PARM '*DBERR ' @RTCD   7          B:Return code
     C                     PARM '*FIRST'  @OPTN   7          I:Option
     C           SDPORT    PARM SDPORT    DSFDY              O:Rec format
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDPORTPD'DBFILE           *************
     C                     MOVEL'008'     DBASE            * DBERR 008 *
     C                     MOVEL@OPTN     DBOPTN  7        *************
     C                     OUT  LDA
     C                     SETON                     U7U8
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*
     C*
     C*
     C*
     C*    DEALS RECORD PROCESSING
     C           TAG1      TAG                             ** TAG TAG1  **
     C                     SETOF                     760607
     C                     SETOF                     080911
     C                     SETOF                     8584
     C                     SETOF                     87
     C                     SETOF                     86
     C                     SETOF                     74
     C  N01                GOTO END
      *
     C           CDL016    IFEQ 'Y'
     C                     MOVE '0'       *IN83
     C*********************MOVE *BLANKS   SVIDO   8
     C                     END
     C*
     C                     MOVE *BLANKS   RRCSTS  1
      *
     C           *IN30     IFEQ '1'
     C   L1                CALL 'AOBRCHR1'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM DBRCA     @DSNB   3
     C           SDBRCH    PARM SDBRCH    DSSDY
     C*
     C   L1      @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL@DSNB     DBKEY  29        ***************
     C                     MOVEL'SDBRCHPD'DBFILE  8        * DBERROR 001 *
     C                     MOVE '001'     DBASE   3        ***************
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     SETON                     57
     C                     END
     C                     END
      *
     C   L1 57             SETON                     58U7U8
     C   U7 U8             SETON                     LR
     C   U7 U8             GOTO END
     C**
     C           CDL016    IFEQ 'Y'
     C                     EXSR INDOFF
     C                     END
     C*
     C                     SETOF                     060708* CHAIN TO
     C                     SETOF                     093940   DEALS
     C                     SETOF                     8584
     C                     SETOF                     87
     C                     SETOF                     86
     C                     SETOF                     74
     C                     SETOF                     1169
     C                     SETOF                     77
     C                     SETOF                     33
     C                     SETOF                     20
     C                     MOVE ' '       SKIP    1
     C                     MOVE '0'       *IN45
     C           DLNO      CHAINDEALS                42        FILE
     C   42                GOTO END
     C*
     C           DTYP      IFEQ 'CI'
     C**********           Z-ADDCHNA      CNUM                                                CSD027
     C                     MOVE CHNA      CNUM                                                CSD027
     C                     END
     C*
     C           BRNCH     IFNE 'ALL'
     C           BRNCH     ANDNE*BLANKS
     C           BRNCH     ANDNEDBRCA
     C                     MOVE 'Y'       SKIP
     C                     MOVE '1'       *IN45
     C                     GOTO ACCUM
     C                     END
      *
     C**    INITIALIZE PRINT DETAILS INDICATOR
     C*
     C                     MOVE '1'       *IN76
     C*
     C*
     C**    PROCESSING FOR FX DEALS
     C*
     C           TYPE      IFEQ 'FX'
     C*
     C**    IF DEAL TYPE IS NX OR NOT FOREIGN EXCHANGE RECORD
     C*
     C           DTYP      IFEQ 'NX'
     C           *IN06     OREQ '0'
     C                     MOVE '0'       *IN76
     C                     END
     C*
     C*
     C*
     C                     END
      *
      ** If CLE025 is on, set Facility fields
      *
     C           CLE025    IFEQ 'Y'
     C           *IN06     IFEQ *ON
     C           *IN07     OREQ *ON
     C           *IN11     OREQ *ON
      *
      ** Access deals extension file for facility details
      *
     C                     MOVELDLNO      WDLNO   6
     C           WDLNO     CHAINDLDEALL5             83
      *
     C           *IN83     IFEQ *OFF
     C                     MOVE F1FCCU    RMCAC   6
     C                     MOVE F1FACT    RMCAT   3
     C                     MOVE F1FCNO    RMCAS   2
     C                     ELSE
     C                     MOVE *BLANKS   RMCAC
     C                     MOVE *BLANKS   RMCAT
     C                     MOVE *BLANKS   RMCAS
     C                     ENDIF
      *
     C                     ENDIF
     C                     ENDIF
      *
      * SETUP Netting fields
     C           CDL002    IFEQ 'Y'
     C           *IN06     ANDEQ*ON
     C           NETBY     IFEQ 'Y'
     C                     MOVEL'***NETTE'BYNETT 12
     C                     MOVE 'D***'    BYNETT
     C                     ELSE
     C                     MOVE *BLANKS   BYNETT
     C                     END
     C           NETSL     IFEQ 'Y'
     C                     MOVEL'***NETTE'SLNETT 12
     C                     MOVE 'D***'    SLNETT
     C                     ELSE
     C                     MOVE *BLANKS   SLNETT
     C                     END
     C                     END
     C*
     C**    PROCESSING FOR MM DEALS
     C*
     C           TYPE      IFEQ 'MM'
     C*
     C**    IF DEAL IS NOT LOAN/DEPOSIT, NEGOTIABLE ASSET PURCHASED,
     C**       AND NEGOTIABLE ASSET SOLD RECORD
     C*
     C           *IN07     IFEQ '0'
     C           *IN08     ANDEQ'0'
     C           *IN09     ANDEQ'0'
     C                     MOVE '0'       *IN76
     C                     END
     C*
     C           *IN76     IFEQ '1'
     C           STPE      IFEQ 'Y'
     C           DTYP      ANDNE'TD'
     C           STPE      OREQ 'N'
     C           DTYP      ANDEQ'TD'
     C                     MOVE '0'       *IN76
     C                     END
     C                     END
     C*
     C                     END
     C*
     C           CDL016    IFEQ 'Y'
     C           TYPE      IFEQ '  '
     C*
     C           STPE      IFEQ 'Y'
     C           DTYP      ANDNE'TD'
     C           STPE      OREQ 'N'
     C           DTYP      ANDEQ'TD'
     C                     MOVE '0'       *IN76
     C                     END
     C*
     C                     END
     C*
     C           *IN03     IFEQ '0'
     C           STPE      IFEQ 'Y'
     C           DTYP      ANDEQ'TD'
     C                     MOVE '1'       *IN03
     C                     END
     C                     END
     C*
     C                     END
     C*
     C***IF DRS ON SYSTEM - OUTPUT STATUS OF DEALS
     C***
     C           MODS      IFNE 'NN'
     C                     EXSR #BAB
     C                     END
     C*
     C           DTYP      IFEQ 'CX'
     C           S01471    ANDEQ'Y'
     C                     MOVE '1'       *IN20
     C                     END
     C           CDL016    IFEQ 'Y'
     C           DTYP      IFEQ 'TD'
     C                     MOVE '1'       *IN85
     C                     END
     C*
     C                     END
     C*
     C*    CHECK FOR NOTICE DEAL
     C   07 23   NOTD      COMP 0                    39
     C*
     C*    CLEAR DATA STRUCTURE FIELDS
     C   07
     COR 11
     COR 08                SETON                     40
     C   40                Z-ADD0         AMTA
     C   09                Z-ADD0         AMT
     C*
     C           S01471    IFEQ 'Y'
     C                     MOVE DDAT      ZDAYNO           * DEAL
     C                     EXSR ZDATE2                        DATE
     C                     MOVE ZADATE    DADATE  7            CONVERSION
     C                     END
     C*
     C                     MOVE VDAT      ZDAYNO           * VALUE
     C                     EXSR ZDATE2                        DATE
     C                     MOVE ZADATE    VADATE  7            CONVERSION
     C*
     C           CDL007    IFEQ 'Y'
     C           *IN72     ANDEQ*ON
     C           OMDT      ANDNE*ZEROS
     C                     MOVE OMDT      ZDAYNO           * VALUE
     C                     EXSR ZDATE2                        DATE
     C                     MOVE ZADATE    POMDT   7            CONVERSION
     C                     ELSE
     C                     MOVE *BLANKS   POMDT
     C                     ENDIF
     C*
     C           CDL007    IFEQ 'Y'
     C           PENA      ANDNE*ZEROS
     C                     MOVE *ON       *IN73
     C                     ELSE
     C                     MOVE *OFF      *IN73
     C                     ENDIF
     C*
      *
      ***  CDL016 - Print fixed term deals (*IN85 is *ON)
      ***  CDL016 - Print Loan/deposits 'BLOCKED' (*IN84 is *ON)
      *
     C           CDL016    IFEQ 'Y'
     C           *IN07     ANDEQ*ON                        DEALSDC
      *
     C*                    SETOF                         84 'BLOCKED' ?
     C           FSBLKA    IFEQ 'Y'                        Loan.deposit is
     C                     SETON                         84 Blocked
     C                     ENDIF
      *
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'TI'
     C                     SETON                         85 Print
      *
      ***  Rollover indicator
      *
     C                     MOVE FSROLI    PROLI   1
      *
      ***  Source of Funds
      *
     C                     MOVELFSSOFD    PSOFD  20 P
     C                     ENDIF
     C                     ENDIF
      *
      ***  CDL017 - Print fixed term deals (*IN87 is *ON)
     C           *IN07     IFEQ *ON                        DEALSDC
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'TI'
     C                     SETON                         87 Print
      *
      ***  Cancellation Date if entered
      *
     C                     MOVE *BLANKS   PCANCD
     C           FSCAND    IFNE *ZEROS
     C                     Z-ADDFSCAND    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    PCANCD  7
     C                     ENDIF                           FSCAND
      *
      ***  Penalty Pay/Receive Indicator
      *
     C                     MOVE *BLANKS   PPENPR  7
     C                     SELEC
     C           FSPNPR    WHEQ 'P'
     C                     MOVEL'PAY    ' PPENPR
     C           FSPNPR    WHEQ 'R'
     C                     MOVEL'RECEIVE' PPENPR
     C                     ENDSL
     C                     ENDIF
     C                     ENDIF
      *
      ***  CDL019 - Print fixed term deals and internal deposits (*IN86)
      *
     C           CDL019    IFEQ 'Y'
     C           *IN07     ANDEQ*ON                        DEALSDC
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'ID'
     C           DTYP      OREQ 'IL'
     C                     SETON                         86
      *
      ***  Base Rate at value Date Indicator
      *
     C                     MOVE FSFBRT    PFBRT   1
     C                     ENDIF
     C                     ENDIF
      *
      ***  CDL020 - Print fixed term deals and internal deposits (*IN74)
      *
     C           CDL019    IFEQ 'Y'
     C           *IN07     ANDEQ*ON                        DEALSDC
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'ID'
     C           DTYP      OREQ 'IL'
     C                     SETON                         74
     C                     ENDIF
     C                     ENDIF
     C*
      *
      ** Get non-Portfolio reference if PM is switched on.
      *
     C           BGPFMG    IFEQ 'Y'
     C           BGN4ST    OREQ 'Y'
      *
     C           PTFR      IFEQ '9997'
     C           BGN4ST    ANDNE'Y'
     C                     MOVE FCR997    RRPTFR  4
     C                     ELSE
     C                     MOVE PTFR      RRPTFR
     C                     END
     C                     END
     C*
     C   09
     COR 07 23             GOTO ACCUM
     C   06                MOVE OTDT      ZDAYNO
     C*                                                    * MATURITY
     C   40                MOVE MDAT      ZDAYNO              DATE
     C                     EXSR ZDATE2                         CONVERSION
     C*
     C*      FOR FRA/IRS 'S, DETERMINE REPORT AMOUNT, RATE & CURRENCY
     C*      FIELD VALUES, DEPENDING ON DEAL TYPE
     C*
     C           *IN11     IFEQ '1'
     C*
     C**  DETERMINE RATE
     C*
     C**  FOR CAPS, COLLARS AND FLOORS - FLOATING RATE SHOWN
     C*
     C           DTYP      IFEQ 'RP'
     C           DTYP      OREQ 'RR'
     C           DTYP      OREQ 'RF'
     C                     SETON                     62
     C                     SETOF                     64
     C********** UBRTT     IFNE 0                                                             CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C**********           Z-ADDUBRTT     FLT2    20                                          CSD103
     C                     MOVE UBRTT     FLT2    2                                           CSD103
     C                     TESTB'4'       UDSTI          69
     C                     ELSE
     C**********           Z-ADDTBRTT     FLT2                                               BUG7866
     C                     TESTB'4'       TDSTI          69
     C*                                                                                      BUG7866
     C* Show Base Rate                                                                       BUG7866
     C*                                                                                      BUG7866
     C********** TBRTT     IFNE 0                                                     BUG7866 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C**********           Z-ADDTBRTT     FLT2                                        BUG7866 CSD103
     C                     MOVE TBRTT     FLT2                                                CSD103
     C                     ELSE                                                              BUG7866
     C                     Z-ADDTBRTE     FIX2                                               BUG7866
     C                     SETON                     64                                      BUG7866
     C                     ENDIF                                                             BUG7866
     C                     END
     C*
     C* FOR ALL OTHER FRA/IRS TYPES    - 'OURS' & 'THEIRS' RATES SHOWN
     C*
     C                     ELSE
     C                     SETOF                     62
     C*'OURS'
     C********** UBRTT     IFNE 0                                                             CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C**********           Z-ADDUBRTT     FLT1    20                                          CSD103
     C                     MOVE UBRTT     FLT1    2                                           CSD103
     C                     SETOF                     63
      *                                                                                      BUG9013
      ** Check if Short Term Rate was specified.                                             BUG9013
      *                                                                                      BUG9013
     C           DTYP      IFEQ 'RS'                                                         BUG9013
     C           DTYP      OREQ 'RX'                                                         BUG9013
     C                     TESTB'1'       UDNSI      12                                      BUG9013
      *                                                                                      BUG9013
     C           *IN12     IFEQ '1'                                                          BUG9013
     C**********           Z-ADD0         FLT1                                        BUG9013 CSD103
     C                     MOVE *BLANKS   FLT1                                                CSD103
     C                     Z-ADDUEINR     FIX1                                               BUG9013
     C                     MOVE '1'       *IN63                                              BUG9013
     C                     ENDIF                                                             BUG9013
      *                                                                                      BUG9013
     C                     ENDIF                                                             BUG9013
      *                                                                                      BUG9013
     C                     ELSE
     C                     Z-ADDUEINR     FIX1   117
     C                     SETON                     63
     C                     END
     C*'THEIRS'
     C********** TBRTT     IFNE 0                                                             CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C**********           Z-ADDTBRTT     FLT2                                                CSD103
     C                     MOVE TBRTT     FLT2                                                CSD103
     C                     SETOF                     64
      *                                                                                      BUG9013
      ** Check if Short Term Rate was specified.                                             BUG9013
      *                                                                                      BUG9013
     C           DTYP      IFEQ 'RS'                                                         BUG9013
     C           DTYP      OREQ 'RX'                                                         BUG9013
     C                     TESTB'1'       TDNSI      17                                      BUG9013
      *                                                                                      BUG9013
     C           *IN17     IFEQ '1'                                                          BUG9013
     C**********           Z-ADD0         FLT2                                               BUG9013
     C                     MOVE *BLANKS   FLT2                                                CSD103
     C                     Z-ADDTEINR     FIX2                                               BUG9013
     C                     MOVE '1'       *IN64                                              BUG9013
     C                     ENDIF                                                             BUG9013
      *                                                                                      BUG9013
     C                     ENDIF                                                             BUG9013
      *                                                                                      BUG9013
     C                     ELSE
     C**********           Z-ADDTEINR     FIX2   117                                         BUG7866
     C**********           SETON                     64                                      BUG7866
     C                     Z-ADDTEINR     FIX2   117                                         BUG9013
     C                     MOVE '1'       *IN64                                              BUG9013
     C**********                                                                     BUG7866 BUG9013
     C**Buy/Sell*Indicator*determines*the*kind*of*interest*rate                      BUG7866 BUG9013
     C**to*be*shown*in*the*report                                                    BUG7866 BUG9013
     C**********                                                                     BUG7866 BUG9013
     C**********           Z-ADD*ZERO     FIX2   117                                 BUG7866 BUG9013
     C********** BYSL      IFEQ 'S'                                                  BUG7866 BUG9013
     C**********           Z-ADDUEINR     FIX2                                       BUG7866 BUG9013
     C**********           ELSE                                                      BUG7866 BUG9013
     C**********           Z-ADDTEINR     FIX2                                       BUG7866 BUG9013
     C**********           ENDIF                                                     BUG7866 BUG9013
     C**********           SETON                     64                              BUG7866 BUG9013
     C**********                                                                     BUG7866 BUG9013
     C                     END
     C*
     C                     END
     C*
     C* SET OFF SALES INDICATOR AND FLOOR DEAL TYPE INDICATOR
     C*
     C                     SETOF                     3313
     C*
     C*UNIQUE INDICATOR FOR FR,RR,RP,RF 'SALES'.
     C*
     C           BYSL      IFEQ 'S'
     C                     SETON                     33
     C                     END
     C*
     C**   IF FLOOR DEAL (RF) OUTPUT FLOOR RATE NOT CEILING RATE
     C*
     C           DTYP      IFEQ 'RF'
     C                     SETON                     13
     C                     END
     C**
     C* FOR TYPE 'RX' - SECOND (THEIR) CURRENCY & AMOUNT SHOWN
     C*
     C           DTYP      IFEQ 'RX'
     C                     SETON                     61
     C*    GET DECIMAL PLACES FOR THEIR CURRENCY
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM TCUCY     @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFEQ *BLANK
     C           A6NBDP    COMP 1                      6566
     C           A6NBDP    COMP 2                    68  67
     C                     END
     C*
     C                     ELSE
     C                     SETOF                     61
     C                     END
     C**
     C*
      ** If CIR008 is installed, output Deal Status Field
      *
     C           CIR008    IFEQ 'Y'
     C                     MOVE FIDSTS    RRCSTS
     C                     ENDIF
      *
     C                     END
     C*
     C*
     C*    SKIP TOTALLING FOR AMEND RECORD
     C           ACCUM     TAG                             ** ACCUM TAG **
     C                     SETOF                     3437
     C                     SETOF                     4344
     C*
     C*    CHECK FOR FX OPTION DEAL
     C   06      DTYP      COMP 'OP'                     34
     C*
     C*    CHECK FOR OPTION TAKEDOWN
     C   06N34   DTYP      COMP 'OT'                     37
     C*
     C           CHTP1     COMP 'A'                      38
     C   38                GOTO QRECT
     C*    HASH TOTALLING
     C           CHTP1     COMP 'R'                  434344
     C**
     C**   IF SWAP REVERSAL,HAD 1ST LEG EXPIRED
     C**   IE.VALUE LESS THAN TODAY, ORIG. ENTRY NOT TODAY
     C                     SETOF                     56
     C   44      DTYP      COMP 'SW'                     56
     C   44N56   DTYP      COMP 'PS'                     56
     C   56      VDAT      COMP BJRDNB                 56
     C*
     C*
     C   56      ORED      COMP BJRDNB               5656
     C   43      ICT       ADD  1         ICT     50
     C   44      DCT       ADD  1         DCT     50
     C*
     C*    SKIP HASH TOTALLING FOR OPTION TAKEDOWN
     C   37                GOTO QRECT
     C   06 34 43          Z-ADDORPA      AMT
     C   06 34 43          Z-ADDORSA      AMTA
     C                     MOVE AMT       ZZAMT
     C   09                MOVE SAPR      ZZAMT
     C   43                MOVE ITOTI     ZZTOTI
     C   43                MOVE ITOTD     ZZTOTD
     C   44                MOVE DTOTI     ZZTOTI
     C   44                MOVE DTOTD     ZZTOTD
     C                     EXSR GLZADD
     C   43                MOVE ZZTOTI    ITOTI  150
     C   43                MOVE ZZTOTD    ITOTD   30
     C   44                MOVE ZZTOTI    DTOTI  150
     C   44                MOVE ZZTOTD    DTOTD   30
     C*
     C           QRECT     TAG                             ** QRECTTAG  **
     C*
     C           SKIP      IFEQ 'Y'
     C                     MOVE '0'       *IN76
     C                     GOTO END
     C                     END
     C*
     C           RCCT      ADD  1         RCCT    50       * RECORD COUNT
      *
      ** If parcelled NA purchase trade use original purchase price
      ** (during CoB PSZE on NA purchse is reduced to reflect NAs sold)
     C           *IN08     IFEQ '1'
     C           PCLI      ANDEQ'P'
     C                     Z-ADDOPUP      AMT
     C                     END
      *
     C**   CHECK FOR NOSTRO XFER
     C   06      DTYP      COMP 'NX'                     77
     C**   CHECK FOR BASE CCY OVERRIDE
     C   06                TESTB'4'       DSTI           78
      *
      *
     C   06 78   VDAT      SUB  BJRDNB    DYFWD   50
     C   06 78   DYFWD     COMP 30                     78
      *
     C*
     C*    GET DECIMAL PLACES FOR CURRENCY - PURCHASE CCY FOR FX
     C*                                    - OUR CCY FOR FRA/IRS
     C   06                MOVE PUCY      KCCY    3
     C   07
     COR 08
     COR 09                MOVE CCY       KCCY
     C   11                MOVE UCUCY     KCCY
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM KCCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C                     GOTO CUST
     C                     END
     C           A6NBDP    COMP 1                      3546
     C           A6NBDP    COMP 2                    48  47
     C  N06                GOTO CUST
     C*
     C*    GET DECIMAL PLACES FOR FX SALE CURRENCY
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SLCY      @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C           @RTCD     IFNE *BLANK
     C                     GOTO CUST
     C                     END
     C           A6NBDP    COMP 1                      3653
     C           A6NBDP    COMP 2                    55  54
     C*
     C*    CHAIN TO CUSTOMER MASTER FILE
     C           CUST      TAG                             ** TAG CUST  **
     C                     SETOF                     05
     C                     MOVELCNUM      CKEY    7
     C   08                MOVELISCN      CKEY
     C*
     C                     CALL 'AOCUSTR0'                 **2
     C                     PARM '*MSG   ' @RTCD   7        **2
     C                     PARM '*KEY   ' @OPTN   7        **2
     C                     PARM CKEY      @KEY1  10        **2
     C                     PARM *BLANKS   @KYST   7        **2
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C           @RTCD     IFEQ *BLANK
     C                     MOVE '1'       *IN05
     C                     MOVE '0'       *IN49
      *
     C                     ELSE
     C                     MOVE '1'       *IN49
     C                     END
     C*
     C           CDL016    IFEQ 'Y'
     C*
     C*    STORE THE CUSTOMER #, NAME AND TOWN IN CASE CHANGED
     C*    IF SETTLEMENT THROUGH NOSTRO
     C**********           MOVE BBCUST    WCNUM   60                                          CSD027
     C                     MOVE BBCUST    WCNUM   6                                           CSD027
     C                     MOVE BBCRNM    WCRNM  20
     C                     MOVE BBCRTN    WCTWN  10
     C*
     C*    DETERMINE WHETHER LOAN OR DEPOSIT FOR 07 RECORD
     C           *IN07     IFEQ '1'
     C                     EXSR LNDEP
     C                     END
     C                     Z-ADD0         WST1                                               BUG7957
     C                     MOVE *BLANKS   OURAC1                                             BUG7957
     C                     Z-ADD0         WST2                                              MD040757
     C                     MOVE *BLANKS   OURAC2                                            MD040757
     C*
     C**   PAYMENT SETTLEMENT INSTRUCTION
     C           *IN06     IFEQ '1'                        FOREX
     C                     Z-ADDSCST      WST1    20
     C                     MOVE OSCA      OURAC1 18
     C                     END
     C*
     C           *IN07     IFEQ '1'                        LOANS
     C           IN31      IFEQ '1'
     C                     Z-ADDSDST      WST1
     C                     MOVE OSDA      OURAC1
     C                     END
     C           IN32      IFEQ '1'
     C                     Z-ADDMDST      WST1             DEPOSIT
     C                     MOVE OMDA      OURAC1
     C                     END
     C                     END
     C*
     C           *IN08     IFEQ '1'
     C**********           Z-ADDSDST      WST1             N.A. PURCHASED                    BUG6235
     C**********           MOVE OSDA      OURAC1                                             BUG6235
     C                     Z-ADDPSTM      WST1             N.A. PURCHASED                    BUG6235
     C                     MOVE PONS      OURAC1                                             BUG6235
     C                     END
      *                                                                                      BUG6235
     C           *IN09     IFEQ '1'                                                          BUG6235
     C                     Z-ADDPSTM      WST1             N.A. SOLD                         BUG6235
     C                     MOVE PONS      OURAC1                                             BUG6235
     C                     ENDIF                                                             BUG6235
      *                                                                                      BUG6235
     C           *IN11     IFEQ '1'                                                          BUG6235
     C**********           Z-ADDPSTM      WST1             IRS                      BUG6235 BUG13691
     C**********           MOVE PONS      OURAC1                                    BUG6235 BUG13691
     C                     Z-ADDRSTM      WST1             IRS                              BUG13691
     C                     MOVE RONS      OURAC1                                            BUG13691
     C                     ENDIF                                                             BUG6235
     C*
     C                     EXSR SETPAY
     C*
     C           IN73      IFEQ '1'
     C                     EXSR NOSTR1                     *01 02 07 08 12
     C                     END
     C*
     C           IN59      IFEQ '1'
     C                     EXSR PROAC1                     *05
     C                     END
     C*
     C           IN17      IFEQ '1'
     C                     EXSR PRORT1                     *14
     C                     END
     C*
     C*    CHECK A/C SEQ NO. OTHER THAN 01 FOR LOAN/DEPOSIT AND N.A PURCH
     C           *IN07     IFEQ '1'
     C           CDAS      ANDNE01
     C           *IN08     OREQ '1'
     C           IDAS      ANDNE01
     C                     MOVE '1'       *IN79
     C                     END
     C*
     C*    RECEIPT SETTLEMENT INSTRUCTION
     C           RECIPT    TAG                             ** RECIPT TAG**
     C*
     C           *IN06     IFEQ '1'                        FOREX
     C                     Z-ADDPCST      WST2    20       FOREX
     C                     MOVE OPCA      OURAC2 18
     C                     END
     C*
     C           *IN07     IFEQ '1'
     C           IN31      IFEQ '1'                        LOANS
     C                     Z-ADDMDST      WST2
     C                     MOVE OMDA      OURAC2
     C                     END
     C           IN32      IFEQ '1'                        DEPOSIT
     C                     Z-ADDSDST      WST2
     C                     MOVE OSDA      OURAC2
     C                     END
     C                     END
     C*
     C           *IN08     IFEQ '1'                        N.A. PURCHASED
     C                     Z-ADDMDST      WST2
     C                     MOVE OMDA      OURAC2
     C                     END
     C*
     C           *IN09     IFEQ '1'                        N.A. SOLD
     C                     Z-ADDSETP      WST2
     C                     MOVE OSAC      OURAC2
     C                     END
      *                                                                                      BUG7484
     C           *IN11     IFEQ '1'                                                          BUG7484
     C**********           Z-ADDRSTM      WST2                                      BUG7484 BUG13691
     C**********           MOVE RONS      OURAC2                                    BUG7484 BUG13691
     C                     Z-ADDPSTM      WST2                                              BUG13691
     C                     MOVE PONS      OURAC2                                            BUG13691
     C                     ENDIF                                                             BUG7484
     C*
     C                     EXSR SETREC
     C*
     C           IN83      IFEQ '1'                        *01 02 07 08 12
     C                     EXSR NOSTR2
     C                     END
     C*
     C           IN86      IFEQ '1'                        *05
     C                     EXSR PROAC2
     C                     END
     C*
     C           IN87      IFEQ '1'                        *14
     C                     EXSR PRORT2
     C                     END
     C*
     C                     END
     C*
     C           END       TAG                             **  TAG END  **
     C*
     C*******************************************************************
     C           *INL1     IFEQ '1'
     C                     CLOSEDL0207P1
     C                     SETOF                     79
     C           BRNCH     IFEQ 'ALL'
     C           BRNCH     OREQ *BLANKS
     C           BRNCH     OREQ DBRCA
     C                     SETON                     70
     C                     SETON                     79
     C                     OPEN DL0207P1
     C                     Z-ADD0         PAGE
     C                     Z-ADDSFNUM     ZSNUM   60
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM DBRCA     @PARM   3
     C                     PARM           SFILE
     C                     PARM           ZSNUM
     C                     PARM           ZSERR   1
     C**        (EXECUTED FOR EACH OUTPUT BRANCH)
     C*
     C           ZSERR     IFEQ 'Y'
     C                     SETON                     U7U8LR
     C                     RETRN
     C                     END
     C*
     C                     END
     C                     END
     C*
     C**    Determine sign for margin & forward points
     C*
     C           *IN21     IFEQ '1'                        B1
     C           *IN06     ANDEQ'1'                        *1
     C*
     C           MGPT      IFLT *ZERO                      B2
     C                     Z-SUBMGPT      MGPT             *2
     C                     END                             E2
     C*
     C           BDBF      IFLT *ZERO                      B2
     C                     Z-SUBBDBF      BDBF             *2
     C                     MOVE '-'       BDBFS   1        *2
     C                     ELSE                            X2
     C                     MOVE '+'       BDBFS            *2
     C                     END                             E2
     C*
     C           SDBF      IFLT *ZERO                      B2
     C                     Z-SUBSDBF      SDBF             *2
     C                     MOVE '-'       SDBFS   1        *2
     C                     ELSE                            X2
     C                     MOVE '+'       SDBFS            *2
     C                     END                             E2
     C*
     C                     END                             E1
      *
      **  If Funding Profit Centre is blank, do not output Funding
      **  Info on the report.
      *
     C           BGN0ST    IFEQ 'Y'
     C           CDE002    OREQ 'Y'
      **  Initialise the funding profit centre ind to the default value
     C                     MOVE '1'       *IN81
      *
     C           *IN07     IFEQ '1'
     C           *IN08     OREQ '1'
      *
     C           FPRC      IFEQ *BLANKS
     C           FSRP      ANDEQ*ZEROS
     C                     MOVE '1'       *IN81
     C                     ELSE
     C                     MOVE '0'       *IN81
     C                     ENDIF
      *
     C                     ENDIF
     C                     ENDIF
     C*
     C*   IF S01471 IS PRESENT, PRINT THE SETTLEMENT INSTRUCTIONS
     C*
     C           S01471    IFEQ 'Y'
     C                     CLEARROCNA
     C                     CLEARPOCNA
     C                     CLEARPSTMA
     C                     CLEARRSTMA
     C                     CLEARRONSA
     C                     CLEARPONSA
     C                     CLEARAWBNA
     C                     CLEARBENNA
      *
      ** Set up settlement details for non-FRA/IRS deals
      *
     C           *IN11     IFEQ *OFF
      *
     C           RSTM      IFNE *ZEROS
     C                     MOVE RSTM      RSTMA   2
     C                     END
     C**
     C**  PRINT EITHER ORDERING CUSTOMER OR ORDERING BANK, WHICHEVER
     C**  IS NON-BLANK.
     C**
     C********** ROCN      IFNE *ZEROS                                                        CSD027
     C           ROCN      IFNE *BLANKS                                                       CSD027
     C                     MOVE ROCN      ROCNA   6
     C                     END
     C********** ROBN      IFNE *ZEROS                                                        CSD027
     C           ROBN      IFNE *BLANKS                                                       CSD027
     C                     MOVE ROBN      ROCNA
     C                     END
     C           PSTM      IFNE *ZEROS
     C                     MOVE PSTM      PSTMA   2
     C                     END
     C********** POCN      IFNE *ZEROS                                                        CSD027
     C           POCN      IFNE *BLANKS                                                       CSD027
     C                     MOVE POCN      POCNA   6
     C                     END
     C********** POBN      IFNE *ZEROS                                                        CSD027
     C           POBN      IFNE *BLANKS                                                       CSD027
     C                     MOVE POBN      POCNA
     C                     END
     C           RONS      IFNE *ZEROS
     C                     MOVE RONS      RONSA  18
     C                     END
     C           PONS      IFNE *ZEROS
     C                     MOVE PONS      PONSA  18
     C                     END
     C           BENN      IFNE *BLANKS
     C                     MOVE BENN      BENNA   8
     C                     END
     C           AWBN      IFNE *BLANKS
     C                     MOVE AWBN      AWBNA   8
     C                     END
     C*
     C*
      *
      ** Set up settlement details for FRA/IRS deals
     C                     ELSE
      *
     C           RSETM     IFNE *ZEROS
     C                     MOVE RSETM     RSTMA   2
     C                     END
     C           URACC     IFNE *ZEROS
     C                     MOVE URACC     RONSA
     C                     END
     C           PSETM     IFNE *ZEROS
     C                     MOVE PSETM     PSTMA   2
     C                     END
     C           UPACC     IFNE *ZEROS
     C                     MOVE UPACC     PONSA
     C                     END
     C********** ROCN      IFNE *ZEROS                                                        CSD027
     C           ROCN      IFNE *BLANKS                                                       CSD027
     C                     MOVE ROCN      ROCNA   6
     C                     END
     C********** ROBN      IFNE *ZEROS                                                        CSD027
     C           ROBN      IFNE *BLANKS                                                       CSD027
     C                     MOVE ROBN      ROCNA   6
     C                     END
     C********** POCN      IFNE *ZEROS                                                        CSD027
     C           POCN      IFNE *BLANKS                                                       CSD027
     C                     MOVE POCN      POCNA   6
     C                     END
     C********** POBN      IFNE *ZEROS                                                        CSD027
     C           POBN      IFNE *BLANKS                                                       CSD027
     C                     MOVE POBN      POCNA   6
     C                     END
     C           FACO      IFNE *BLANKS
     C                     MOVELFACO      BENNA   8
     C                     END
     C           AWBN      IFNE *BLANKS
     C                     MOVE AWBN      AWBNA
     C                     ENDIF
      *
     C                     END
     C*
     C           CIR001    IFEQ 'Y'
     C*
     C                     MOVEA'00'      *IN,14
     C           *IN11     IFEQ *ON                         B1
     C                     EXSR #LUFBO                       1
     C                     ENDIF                            E1
     C*
     C                     END
     C                     END
      *
      ** Setup Fiduciary details for printing if feature CDL006
      ** is installed.
      *
     C           CDL006    IFEQ 'Y'
      *
     C                     MOVE '0'       *IN82
      *
     C           *IN45     IFEQ '1'
     C           *IN07     ANDEQ'1'
     C           DTYP      ANDEQ'FT'
     C           *IN45     OREQ '1'
     C           *IN07     ANDEQ'1'
     C           DTYP      ANDEQ'DT'
     C           *IN45     OREQ '1'
     C           *IN07     ANDEQ'1'
     C           DTYP      ANDEQ'LT'
      *
     C                     MOVE '1'       *IN82
      *
     C                     MOVELFCGC      R0FCGC  2
     C                     MOVELFCGD      R0FCGD 20
     C                     Z-ADDFCGA      R0FCGA 130
     C                     MOVELFCMC      R0FCMC  2
     C                     MOVELFCMD      R0FCMD 20
     C                     Z-ADDFCMA      R0FCMA 130
     C                     ELSE
     C                     MOVEL*BLANKS   R0FCGC
     C                     MOVEL*BLANKS   R0FCGD
     C                     Z-ADD*ZEROS    R0FCGA
     C                     MOVEL*BLANKS   R0FCMC
     C                     MOVEL*BLANKS   R0FCMD
     C                     Z-ADD*ZEROS    R0FCMA
      *
     C                     ENDIF
      *
     C                     ENDIF
      *
     C                     EXSR #GSTRC
     C*
      *
     C**
     C*    COMPARE PROGRAM AND FILE CONTROLS
     CLR                   SETON                     OF60
     CLR                   MOVE 999999    DLNO
     CLR         DLNO      CHAINDEALS                42
     C*
     C**  Check file controls only if report is for all branches
     C**  and if all deals have been selected.
     C*
     CLR                   SETOF                     505152
     CLR         BRNCH     IFEQ *BLANKS
     CLR         BRNCH     OREQ 'ALL'
     C*
     CLR         TYPE      IFNE 'FX'
     CLR         TYPE      ANDNE'MM'
     C*
     CLR                   SETON                     50
     C*
     CLR         ICT       COMP NINS                 5151
     CLRN51      ITOTI     COMP VRIF                 5151
     CLRN51      ITOTD     COMP VRIL                 5151
     C*
     CLR         DCT       COMP NDEL                 5252
     CLRN52      DTOTI     COMP VRDF                 5252
     CLRN52      DTOTD     COMP VRDL                 5252
     C*
     CLR                   END
     CLR                   END
     C*
     C***LR*51**                                              * CONTROLS OUT                  239244
     C***OR*52**              SETON                     U8       OF BALANCE                   239244
     CLR         *IN51     IFEQ '1'                                                           239244
     CLR         *IN52     OREQ '1'                                                           239244
     CLR                   MOVE '1'       *IN88                                               239244
     CLR                   ENDIF                                                              239244
     C*
     C** ONLY REPORT AUDIT FILE TO RCF IF PRODUCED
     C*
     CLR         *IN70     IFEQ '0'
     CLR         *INU1     OREQ '1'
     CLR         *INU7     OREQ '1'
     C** ENSURE SPOOL FILE RECORDED BY RCF
     CLR                   Z-ADDSFNUMU    ZSNUMU  60
     CLR                   CALL 'ZSFILE'
     CLR                   PARM           SEQ     5
     CLR                   PARM *BLANKS   @PARM
     CLR                   PARM           SFILEU
     CLR                   PARM           ZSNUMU
     CLR                   PARM           ZSERR   1
     C*
     CLR         ZSERR     IFEQ 'Y'
     CLR                   SETON                     U7U8LR
     CLR                   RETRN
     CLR                   END
     CLR                   END
     C*
     C** READ BANK DETAILS VIA ACCESS PROGRAM (WHEN EMPTY FILES)
     C*
     CLRN49                CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     CLRN49      BJDFIN    COMP 'M'                      98MMDDYY, 98 ON
     CLRN49      @RTCD     IFNE *BLANK
     C*RN49****************MOVEL'SDBANKPD'DBFILE 10        *************
     CLRN49      *LOCK     IN   LDA
     CLRN49                MOVEL'SDBANKPD'DBFILE           *************
     CLRN49                MOVEL'003'     DBASE            * DBERR 003 *
     CLRN49                MOVEL@OPTN     DBOPTN  7        *************
     CLRN49                MOVEL@OPTN     DBKEY  29
     CLRN49                MOVEL'DL0207 ' DBPGM
     CLRN49                OUT  LDA
     CLRN49                EXSR *PSSR
     CLRN49                SETON                     99
     CLR                   END
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #LUFBO - Up-front fees and Buy-outs.                         *
     C*                                                               *
     C*  Called by  : main processing.                                *
     C*                                                               *
     C*  Calls      : #LUPFR - Process Up-Front Fees.                 *
     C*               #LBYOU - Process Buy-Outs.                      *
     C*                                                               *
     C*****************************************************************
     C*
     C           #LUFBO    BEGSR
     C*
     C                     MOVEA'00'      *IN,14
     C                     Z-ADD1         L1      30
     C*
     C           DTYP      IFEQ 'RS'                       B1
     C           DTYP      OREQ 'RX'                        1
     C           DTYP      OREQ 'RP'                        1
     C           DTYP      OREQ 'RR'                        1
     C           DTYP      OREQ 'RF'                        1
     C                     MOVE UCUCY     WLCYCD  3
     C           UPVD      IFNE 0                          B2
     C                     MOVE *ON       *IN14             2
     C*
     C**  Put up-front details into first extra detail line
     C*
     C                     EXSR #LUPFR                      2
     C                     MOVEAL01       RLDTL1 80         2
     C*
     C           BOVD      IFNE 0                          B3
     C           DTYP      ANDNE'RP'                        3
     C           DTYP      ANDNE'RR'                        3
     C           DTYP      ANDNE'RF'                        3
     C           CIR006    ANDEQ'N'
     C           BOVD      ORNE 0
     C           CIR006    ANDEQ'Y'
     C                     MOVE *ON       *IN15             3
     C*
     C**  Put buy-out details into 2nd extra detail line
     C*
     C                     EXSR #LBYOU                      3
     C                     MOVEAL01       RLDTL2 80         3
     C                     ENDIF                           E3
     C                     ELSE                            X2
     C*
     C           BOVD      IFNE 0                          B3
     C                     MOVE *ON       *IN14             3
     C*
     C**  Put buy-out details into only extra detail line
     C*
     C                     EXSR #LBYOU                      3
     C                     MOVEAL01       RLDTL1 80         3
     C*
     C                     ENDIF                           E3
     C                     ENDIF                           E2
     C                     ENDIF                           E1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #LUPFR - Process Up-Front fees.                              *
     C*                                                               *
     C*  Called by  : #LUFBO - Up-front fees and Buy-outs.            *
     C*                                                               *
     C*  Calls      : ZDATE2 - Convert a day number to date format.   *
     C*               #LCHKR - Check for blanks in text.              *
     C*               #LFAMT - Format amounts.                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           #LUPFR    BEGSR
     C*
     C                     MOVE *BLANKS   L01
     C                     Z-ADDUPVD      ZDAYNO
     C                     EXSR ZDATE2
     C*
     C           DTYP      IFEQ 'RS'
     C                     MOVEA@UPFNT    L01,1
     C                     EXSR #LCHKR
     C                     Z-ADDUPFE      ZFLD15
     C                     EXSR #LFAMT
     C                     MOVEAZOUT22    L01,L1
     C                     EXSR #LCHKR
     C           UPPR      IFEQ 'P'
     C                     MOVEA@PAYDU    L01,L1
     C                     ELSE
     C                     MOVEA@RECDU    L01,L1
     C                     ENDIF
     C                     EXSR #LCHKR
     C                     MOVEAZADATE    L01,L1
     C                     ENDIF
      *
     C           DTYP      IFEQ 'RX'
     C                     MOVEA@UPFNT    L01,1
     C                     EXSR #LCHKR
     C           UPPR      IFEQ 'P'
     C                     MOVE UCUCY     WLCYCD
     C                     ELSE
     C                     MOVE TCUCY     WLCYCD
     C                     ENDIF
     C                     Z-ADDUPFE      ZFLD15
     C                     EXSR #LFAMT
     C                     MOVEAZOUT22    L01,L1
     C                     EXSR #LCHKR
     C                     MOVEAWLCYCD    L01,L1
     C                     EXSR #LCHKR
     C           UPPR      IFEQ 'P'
     C                     MOVEA@PAYDU    L01,L1
     C                     ELSE
     C                     MOVEA@RECDU    L01,L1
     C                     ENDIF
     C                     EXSR #LCHKR
     C                     MOVEAZADATE    L01,L1
     C                     ENDIF
      *
     C           DTYP      IFEQ 'RP'
     C           DTYP      OREQ 'RR'
     C           DTYP      OREQ 'RF'
     C                     MOVEA@PREM     L01,1
     C                     EXSR #LCHKR
     C                     Z-ADDUPFE      ZFLD15
     C                     EXSR #LFAMT
     C                     MOVEAZOUT22    L01,L1
     C                     EXSR #LCHKR
     C           UPPR      IFEQ 'P'
     C                     MOVEA@PAYDU    L01,L1
     C                     ELSE
     C                     MOVEA@RECDU    L01,L1
     C                     ENDIF
     C                     EXSR #LCHKR
     C                     MOVEAZADATE    L01,L1
     C                     ENDIF
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #LBYOU - Process Buy-Outs.                                   *
     C*                                                               *
     C*  Called by  : #LUFBO - Up-front fees and Buy-outs.            *
     C*                                                               *
     C*  Calls      : #LCHKR - Check for blanks in text.              *
     C*               #LFAMT - Format amounts.                        *
     C*                                                               *
     C*****************************************************************
     C*
     C           #LBYOU    BEGSR
     C*
     C                     MOVE *BLANKS   L01
     C                     Z-ADDBOVD      ZDAYNO
     C                     EXSR ZDATE2
     C*
     C                     MOVEA@BYOUT    L01,1
     C                     EXSR #LCHKR
     C*
     C           DTYP      IFEQ 'RS'
      *
      **  Include caps/collars/floors
      *
     C           DTYP      OREQ 'RP'
     C           CIR006    ANDEQ'Y'
     C           DTYP      OREQ 'RR'
     C           CIR006    ANDEQ'Y'
     C           DTYP      OREQ 'RF'
     C           CIR006    ANDEQ'Y'
     C                     Z-ADDBOAM      ZFLD15
     C                     EXSR #LFAMT
     C                     MOVEAZOUT22    L01,L1
     C                     EXSR #LCHKR
     C           BAPR      IFEQ 'P'
     C                     MOVEA@PAYDU    L01,L1
     C                     ELSE
     C                     MOVEA@RECDU    L01,L1
     C                     ENDIF
     C                     EXSR #LCHKR
     C                     MOVEAZADATE    L01,L1
     C                     ENDIF
     C*
     C           DTYP      IFEQ 'RX'
     C           BAPR      IFEQ 'P'
     C                     MOVE UCUCY     WLCYCD
     C                     ELSE
     C                     MOVE TCUCY     WLCYCD
     C                     ENDIF
     C                     Z-ADDBOAM      ZFLD15
     C                     EXSR #LFAMT
     C                     MOVEAZOUT22    L01,L1
     C                     EXSR #LCHKR
     C                     MOVEAWLCYCD    L01,L1
     C                     EXSR #LCHKR
     C           BAPR      IFEQ 'P'
     C                     MOVEA@PAYDU    L01,L1
     C                     ELSE
     C                     MOVEA@RECDU    L01,L1
     C                     ENDIF
     C                     EXSR #LCHKR
     C                     MOVEAZADATE    L01,L1
     C                     ENDIF
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #LFAMT - Format amounts.                                     *
     C*                                                               *
     C*  Called by  : #LUPFR - Process Up-Front Fees.                 *
     C*               #LBYOU - Process Buy-Outs.                      *
     C*                                                               *
     C*  Calls      : ZFRPED                                          *
     C*                                                               *
     C*****************************************************************
     C*
     C           #LFAMT    BEGSR
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM WLCYCD    @AJCD   3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDCURRPD'DBFILE           **************
     C                     MOVEL'010'     DBASE            * DBERROR 10 *
     C                     MOVEL@OPTN     DBOPTN  7        **************
     C                     MOVEL@OPTN     DBKEY
     C                     MOVEL'DL0207 ' DBPGM
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     ELSE
     C*
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZFRPED
     C                     MOVELZOUT25    ZOUT22
     C*
     C                     MOVEA*BLANKS   L22
     C                     MOVEAZOUT22    L22
     C           ' '       CHECKZOUT22    L2      30
     C                     MOVE *BLANKS   ZOUT22
     C                     MOVEAL22,L2    ZOUT22
     C                     END
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  #LCHKR - Check for blanks in text.                           *
     C*                                                               *
     C*  Called by  : #LUPFR - Process Up-Front Fees.                 *
     C*               #LBYOU - Process Buy-Outs.                      *
     C*                                                               *
     C*  Calls      : none.                                           *
     C*                                                               *
     C*****************************************************************
     C*
     C           #LCHKR    BEGSR
     C*
     C                     MOVEAL01,1     FLDA   80
     C           ' '       CHEKRFLDA      L1
     C                     ADD  2         L1
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*
     C*
     C*****************************************************************
     C*                                                               *
     C* #BAB  - FORMATTING OF CURRENT STATUS OF DRS DEALS             *
     C*                                                               *
     C*****************************************************************
     C           #BAB      BEGSR
     C*
     C**ASSUME DEAL STATUS OF 'A' = AUTHORISED
     C*
     C                     MOVE 'A'       RRCSTS
     C*
     C**FORMAT STATUS OF DELETED DEALS
     C*
     C           CHTP      IFEQ 'R'                        B1
     C*
     C           MODS      IFEQ 'YN'                       B*2
     C           MODS      OREQ 'YY'                       **2
     C**CHECK FOR FX DEAL TYPE
     C           DTYP      LOKUPTABTZP                   75**2
     C*
     C           *IN75     IFEQ '1'                        B**3
     C           DLNO      CHAINFXDEALLL             63    ***3
     C           *IN63     IFEQ '0'                        B**4
     C                     MOVE FHDSTS    RRCSTS           ***4
     C*
     C                     END                             E**4
     C*
     C                     END                             E**3
     C*
     C                     END                             E*2
     C*
     C           MODS      IFEQ 'NY'                       B*2
     C           MODS      OREQ 'YY'                       **2
     C           DTYP      LOKUPTABTYP                   75**2
     C           *IN75     IFEQ '1'                        B**3
     C           DLNO      CHAINMMDEALLL             63    ***3
     C           *IN63     IFEQ '0'                        B**4
     C*
     C           RECHMT    IFEQ 'MMDELDPP'                 B***5
     C                     MOVE HKDSTS    RRCSTS           ****5
     C                     END                             E***5
     C*
     C           RECHMT    IFEQ 'MMDENBPP'                 B***5
     C                     MOVE HLDSTS    RRCSTS           ****5
     C                     END                             E***5
     C*
     C           RECHMT    IFEQ 'MMDENSPP'                 B***5
     C                     MOVE HMDSTS    RRCSTS           ****5
     C                     END                             E***5
     C*
     C*
     C                     END                             E**4
     C*
     C                     END                             E**3
     C*
     C                     END                             E*2
     C*
     C                     END                             E1
     C*
     C           #BAB9     ENDSR
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C**
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C           GLZADD    BEGSR                           *** GLZADD ****
     C*
     C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     C   91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     C                     EXSR GLZSUM
     C           ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C           GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     C                     SETOF                     919293
     C                     SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     C           ZZAMTI    COMP 0                      9293
     C   93      ZZAMTD    COMP 0                      9293
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     C           ZZTOTI    COMP 0                      9193
     C   93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     C   93                Z-ADDZZAMTI    ZZTOTI
     C   93                Z-ADDZZAMTD    ZZTOTD
     C   93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     C   91N92
     CORN91 92             GOTO ZZOFPS
     C*
     C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     C           ZZWK2     COMP 999                  93    '93' = CARRY
     C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
     C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     C  N99                Z-ADDZZWK2     ZZTOTD
     C  N99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     C   99                Z-ADD0         ZZAMT  153
     C                     GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     C           ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     C   92                Z-SUBZZAMTI    ZZAMTI 150
     C   92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     C   91                Z-SUBZZTOTI    ZZTOTI
     C   91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     C           ZZTOTI    COMP ZZAMTI               93  95
     C   95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     C   95                Z-ADD0         ZZTOTI
     C   95                Z-ADD0         ZZTOTD
     C   95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     C   93      ZZAMTD    COMP ZZTOTD               94
     C   93 94   ZZTOTI    SUB  1         ZZTOTI
     C   93 94   ZZTOTD    ADD  1000      ZZWK2
     C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     C  N93      ZZTOTD    COMP ZZAMTD               94
     C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
     C  N93 94   ZZAMTD    ADD  1000      ZZWK2
     C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     C                     SETOF                     94
     C   93 91
     CORN93 92             SETON                     94
     C   94                Z-SUBZZTOTI    ZZTOTI
     C   94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     C   92                Z-SUBZZAMTI    ZZAMTI
     C   92                Z-SUBZZAMTD    ZZAMTD
     C           ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     C                     SETOF                     96
     C           ZZTOTD    COMP 0                        91
     C   91      ZZTOTI    COMP 0                      96
     C   96                MOVE '.000-'   ZZNEGD  5
     C                     ENDSR                             ** ENDSR **
     C********************************************************************
     C**
     C**   LNDEP SR. TO DETERMINE WHETHER LOAN OR DEPOSIT FOR 07 RECORD
     C**
     C           LNDEP     BEGSR                           ***  LNDEP  ***
      *
     C                     MOVE '0'       IN31    1
     C                     MOVE '0'       IN32    1
      *
     C           DTYP      IFEQ 'IP'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'LN'
     C           DTYP      OREQ 'CL'
     C           DTYP      OREQ 'DL'
     C                     MOVE '1'       IN31
     C                     ELSE
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'CI'
     C           DTYP      OREQ 'CD'
     C           DTYP      OREQ 'CF'                                                       AR1077561
     C                     MOVE '1'       IN32
     C                     ENDIF
     C                     ENDIF
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SETPAY SR. TO SETON INDICATOR 71-76, 27 ACCORDING TO
     C**   DIFFERENT PAYMENT SETTLEMENT TYPE
     C**
     C           SETPAY    BEGSR                           *** SETPAY ****
     C**
      *
     C                     MOVE '0'       IN71
     C                     MOVE '0'       IN72
     C                     MOVE '0'       IN73
     C                     MOVE '0'       IN74
     C                     MOVE '0'       IN50
     C                     MOVE '0'       IN59
     C                     MOVE '0'       IN17
      *
     C           WST1      IFEQ 00
     C                     MOVE '1'       IN71    1
     C                     ELSE
     C           WST1      IFEQ 06
     C                     MOVE '1'       IN72    1
     C                     ELSE
     C           WST1      IFEQ 01
     C           WST1      OREQ 02
     C           WST1      OREQ 07
     C           WST1      OREQ 08
     C           WST1      OREQ 12
     C                     MOVE '1'       IN73    1
     C                     ELSE
     C           WST1      IFEQ 03
     C                     MOVE '1'       IN74    1
     C                     ELSE
     C           WST1      IFEQ 04
     C                     MOVE '1'       IN50    1
     C                     ELSE
     C           WST1      IFEQ 05
     C                     MOVE '1'       IN59    1
     C                     ELSE
     C           WST1      IFEQ 14
     C                     MOVE '1'       IN17    1
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C*
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   NOSTR1 SR. TO PROCESS PAYMENT SETTLEMENT THRU NOSTRO
     C**
     C           NOSTR1    BEGSR                           *** NOSTR1 ****
     C           *IN06     IFEQ '1'
     C                     MOVE SLCY      NOSCCY  3
     C                     END
     C*
     C           *IN07     IFEQ '1'
     C           *IN08     OREQ '1'
     C                     MOVE CCY       NOSCCY
     C                     END
     C*
     C           *IN11     IFEQ *ON                                                          BUG7749
     C                     MOVE TCUCY     NOSCCY                                             BUG7749
     C                     ENDIF                                                             BUG7749
      *                                                                                      BUG7749
     C                     MOVELOURAC1    NOSCD   2
     C*
     C**   GET NOSTRO REPORT NAME IF INPUT NOSTRO CODE NOT BLANK
     C*
     C           NOSCD     IFEQ *BLANKS
     C                     MOVE '1'       IN28
     C                     ELSE
     C                     EXSR NOSTRO
     C                     MOVE NOSCD     NOSCD1  2
     C**********           MOVE NOSNAM    NOSNM1 20                                         AR916521
     C                     MOVE NOSNAM    NOSNM1 25                                         AR916521
     C                     END
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   PROAC1 SR. TO PROCESS PAYMENT SETTLEMENT THRU ANY A/C
     C**
     C           PROAC1    BEGSR                           *** PROAC1 ****
     C**
     C                     MOVE OURAC1    WOURAC 18
     C                     EXSR PROCAC
     C                     MOVE A5ACCN    ACKN1  25
      *                                                                                     AR916521
      ** If IN20 is on, a/c is missing or closed & dropped                                  AR916521
      *                                                                                     AR916521
     C           IN20      IFEQ '1'                                                         AR916521
     C                     MOVE *BLANKS   ACKN1                                             AR916521
     C                     MOVE NARR2     ACKN1                                             AR916521
     C                     ENDIF                                                            AR916521
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   PRORT1 SR. TO PROCESS PAYMENT SETTLEMENT THRU RETAIL A/C
     C**
     C           PRORT1    BEGSR                           *** PRORT1 ****
     C                     MOVE OURAC1    WOURAC
     C                     EXSR PROCRT
     C                     MOVE A5ACCN    ACKN1
     C**
     C**  IF IND. 19 ON, A/C IS MISSING OR CLOSED & DROPPED
     C           IN19      IFEQ '1'
     C                     MOVE NARR2     ACKN1
     C                     END
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SETREC SR. TO SETON INDICATOR 81-87 ACCORDING TO
     C**   DIFFERENT RECEIPT SETTLEMENT TYPE
     C**
     C           SETREC    BEGSR                           *** SETREC ****
     C**
      *
     C                     MOVE '0'       IN81
     C                     MOVE '0'       IN82
     C                     MOVE '0'       IN83
     C                     MOVE '0'       IN84
     C                     MOVE '0'       IN85
     C                     MOVE '0'       IN86
     C                     MOVE '0'       IN87
      *
     C           WST2      IFEQ 00
     C                     MOVE '1'       IN81    1
     C                     ELSE
     C           WST2      IFEQ 06
     C                     MOVE '1'       IN82    1
     C                     ELSE
     C           WST2      IFEQ 01
     C           WST2      OREQ 02
     C           WST2      OREQ 07
     C           WST2      OREQ 08
     C           WST2      OREQ 12
     C                     MOVE '1'       IN83    1
     C                     ELSE
     C           WST2      IFEQ 03
     C                     MOVE '1'       IN84    1
     C                     ELSE
     C           WST2      IFEQ 04
     C                     MOVE '1'       IN85    1
     C                     ELSE
     C           WST2      IFEQ 05
     C                     MOVE '1'       IN86    1
     C                     ELSE
     C           WST2      IFEQ 14
     C                     MOVE '1'       IN87    1
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ENDSR
     C**
     C**
      ********************************************************************
      **
      **   #GSTRC SR. TO PRINT ACCORDING TO
      **   DIFFERENT RECEIPT SETTLEMENT TYPE
      **
     C           #GSTRC    BEGSR                                       ***
      *
     C                     MOVE *BLANKS   GOURC
     C                     MOVE *BLANKS   GNOSN
     C                     MOVE *BLANKS   GSPSN
      *
     C           IN81      IFEQ '1'
     C           IN85      ANDEQ'0'
     C           IN83      OREQ '1'
     C           IN85      ANDEQ'0'
     C           IN84      OREQ '1'
     C           IN85      ANDEQ'0'
     C           IN86      OREQ '1'
     C           IN85      ANDEQ'0'
     C           IN87      OREQ '1'
     C           IN85      ANDEQ'0'
     C           IN85      OREQ '1'
      *
     C                     MOVE OURAC2    GOURC  18
     C                     MOVE *BLANKS   OURAC2
      *
     C                     ENDIF
      *
     C           IN83      IFEQ '1'
     C           IN88      ANDEQ'0'
      *
     C**********           MOVE NOSNM2    GNOSN  20                                         AR916521
     C                     MOVE NOSNM2    GNOSN  25                                         AR916521
     C                     MOVE *BLANKS   NOSNM2
     C                     SETON                     86
      *
     C                     ELSE
      *
     C                     SETOF                     86
     C           IN82      IFEQ '1'
     C                     MOVE SPSNAM    GSPSN  25
     C                     ELSE
     C           IN85      IFEQ '1'
     C                     MOVE CURNAM    GSPSN
     C                     ELSE
     C           IN86      IFEQ '1'
     C           IN87      OREQ '1'
     C                     MOVE ACKN2     GSPSN
     C                     MOVE *BLANKS   ACKN2
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C                     MOVE *BLANKS   GOURA
     C                     MOVE *BLANKS   GNOSM
     C                     MOVE *BLANKS   GSPSM
      *
     C           *IN09     IFEQ '0'
     C           IN71      ANDEQ'0'
      *
     C                     MOVE OURAC1    GOURA  18
     C                     MOVE *BLANKS   OURAC1
      *
     C                     ENDIF
      *
     C           IN73      IFEQ '1'
     C           IN28      ANDEQ'0'
      *
     C**********           MOVE NOSNM1    GNOSM  20                                         AR916521
     C                     MOVE NOSNM1    GNOSM  25                                         AR916521
     C                     MOVE *BLANKS   NOSNM1
     C                     SETON                     84
      *
     C                     ELSE
      *
     C                     SETOF                     84
     C           IN72      IFEQ '1'
     C                     MOVE SPSNAM    GSPSM  25
     C                     ELSE
     C           IN50      IFEQ '1'
     C                     MOVE CURNAM    GSPSM
     C                     ELSE
     C           IN59      IFEQ '1'
     C           IN17      OREQ '1'
     C                     MOVE ACKN1     GSPSM
     C                     MOVE *BLANKS   ACKN1
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
      *
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   NOSTR2 SR. TO PROCESS RECEIPT SETTLEMENT THRU NOSTRO
     C**
     C           NOSTR2    BEGSR                           *** NOSTR2 ****
     C**
     C           *IN06     IFEQ '1'
     C                     MOVE PUCY      NOSCCY
     C                     END
     C*
     C           *IN07     IFEQ '1'
     C           *IN08     OREQ '1'
     C           *IN09     OREQ '1'
     C                     MOVE CCY       NOSCCY
     C                     END
     C*
     C           *IN11     IFEQ *ON                                                          BUG7749
     C                     MOVE UCUCY     NOSCCY                                             BUG7749
     C                     ENDIF                                                             BUG7749
      *                                                                                      BUG7749
     C                     MOVELOURAC2    NOSCD
     C*    GET NOSTRO REPORT NAME IF INPUT NOSTRO CODE NOT BLANK
     C           NOSCD     IFEQ *BLANKS
     C                     MOVE '1'       IN88
     C                     ELSE
     C                     EXSR NOSTRO
     C                     MOVE NOSCD     NOSCD2  2
     C**********           MOVE NOSNAM    NOSNM2 20                                         AR916521
     C                     MOVE NOSNAM    NOSNM2 25                                         AR916521
     C                     END
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   PROAC2 SR. TO PROCESS RECEIPT SETTLEMENT THRU ANY A/C
     C**
     C           PROAC2    BEGSR                           *** PROAC2 ****
     C**
     C                     MOVE OURAC2    WOURAC
     C                     EXSR PROCAC
     C                     MOVE A5ACCN    ACKN2  25
      *                                                                                     AR916521
      ** If IN20 is on, a/c is missing or closed and dropped                                AR916521
      *                                                                                     AR916521
     C           IN20      IFEQ '1'                                                         AR916521
     C                     MOVE *BLANKS   ACKN2                                             AR916521
     C                     MOVE NARR2     ACKN2                                             AR916521
     C                     ENDIF                                                            AR916521
      *                                                                                     AR916521
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   PRORT2 SR. TO PROCESS RECEIPT SETTLEMENT THRU RETAIL A/C
     C**
     C           PRORT2    BEGSR                           *** PRORT2 ****
     C**
     C                     MOVE OURAC2    WOURAC
     C                     EXSR PROCRT
     C                     MOVE A5ACCN    ACKN2
     C**
     C**  IF IND. 19 ON, A/C IS MISSING OR CLOSED & DROPPED
     C           IN19      IFEQ '1'
     C                     MOVE NARR2     ACKN2
     C                     END
     C*
     C                     ENDSR
     C**
     C********************************************************************
     C**   NOSTRO SR. TO GET THE NOSTRO REPORT NAME FROM
     C**   S/TABLE-NOSTRO DETAILS AND S/CLINT
     C**
     C           NOSTRO    BEGSR                           *** NOSTRO ****
     C**
     C                     CALL 'AONOSTR0'
     C**********           PARM '*DBERR ' @RTCD   7                                           261285
     C                     PARM '*BLANKS' @RTCD   7                                           261285
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM *BLANKS   @KEYA   6
     C                     PARM NOSCCY    @KEYB   3
     C                     PARM *BLANKS   @KEYC   4
     C                     PARM *BLANKS   @KEYD   2
     C                     PARM NOSCD     @KEYE   2
     C                     PARM *BLANKS   @KEYF   3
     C                     PARM *BLANKS   @KEYG  10
     C                     PARM *BLANKS   @KEYH   1
     C           SDNOST    PARM SDNOST    DSFDY
     C*****************************************************************                       261285
     C***********DATABASE*ERROR*IF*RECORD*IS*NOT*FOUND*****************                       261285
     C********** @RTCD     IFNE *BLANK                                                        261285
     C**********           MOVEL'SDNOSTPD'DBFILE           ************                       261285
     C**********           MOVEL'025'     DBASE            * DBERR 25 *                       261285
     C**********           MOVEL@OPTN     DBOPTN  7        ************                       261285
     C**********           MOVEL@KEYB     DBKEY                                               261285
     C**********           MOVE @KEYE     DBKEY                                               261285
     C**********           SETON                     U7U8LR                                   261285
     C**********           EXSR *PSSR                                                         261285
     C**********           END                                                                261285
     C*
     C********** @RTCD     IFNE *BLANK                                               261285 AR916521
     C           @RTCD     IFEQ *BLANK                                                      AR916521
     C                     MOVELA7CUST    CKEY
     C                     CALL 'AOCUSTR0'
     C                     PARM *BLANKS   @RTCD   7        **2
     C                     PARM '*KEY   ' @OPTN   7        **2
     C                     PARM CKEY      @KEY1  10        **2
     C                     PARM *BLANKS   @KYST   7        **2
     C           SDCUST    PARM SDCUST    DSSDY
     C           @RTCD     IFNE *BLANKS
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVEL'026'     DBASE            * DBERR 26 *
     C                     MOVEL@OPTN     DBOPTN  7        ************
     C                     MOVELCKEY      DBKEY
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     END
     C**********           MOVE BBCRNM    NOSNAM 20                                         AR916521
     C                     MOVE BBCRNM    NOSNAM 25                                         AR916521
     C                     ELSE                                                               261285
     C**********           MOVE *BLANKS   NOSNAM                                     261285 AR916521
     C                     MOVE NARR2     NOSNAM                                            AR916521
     C                     ENDIF                                                              261285
     C*
     C           NOSEND    ENDSR                           *** NOSEND ****
     C**
     C********************************************************************
     C**
     C**   PROCAC SR. TO GET ACCOUNT NAME FOR SETTLEMENT TYPE 05
     C**
     C           PROCAC    BEGSR                           *** PROCAC ****
     C*
     C                     MOVE WOURAC    WACNO  12
     C                     MOVELWACNO     WACOD  10
     C*
     C                     MOVE '0'       IN20    1                                         AR916521
     C                     CALL 'AOACODR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM WACOD     @AFNB  10
     C           SDACOD    PARM SDACOD    DSFDY
     C           @RTCD     IFNE *BLANK
     C**********           MOVE '027'     DBASE            ******                           AR916521
     C**********           MOVEL@OPTN     DBOPTN  7        *  027                           AR916521
     C**********           MOVELWACOD     DBKEY            ******                           AR916521
     C**********           MOVEL'SDACODPD'DBFILE                                            AR916521
     C**********           SETON                     U7U8LR                                 AR916521
     C**********           EXSR *PSSR                                                       AR916521
     C                     MOVE '1'       IN20                                              AR916521
     C                     END
     C                     ENDSR
     C**
     C********************************************************************
     C**   PROCRT SR. TO GET ACCOUNT NAME FOR SETTLEMENT TYPE 14
     C**
     C           PROCRT    BEGSR                           *** PROCRT ****
     C                     SETOF                     99
     C                     MOVELWOURAC    ZACKEY 10
     C                     MOVE '0'       IN19    1
     C           ZACKEY    CHAINACNUM                82
     C***********DATABASE*ERROR*IF*RECORD*IS*NOT*FOUND*****************                     AR916521
     C           *IN82     IFEQ '1'                        ***************
     C                     MOVE '1'       IN19
     C**********           MOVEL'028'     DBASE            ** DBASE 28  **                  AR916521
     C**********           MOVEL'ACNUM'   DBFILE           ***************                  AR916521
     C**********           MOVELZACKEY    DBKEY                                             AR916521
     C**********           SETON                     U7U8LR                                 AR916521
     C**********           EXSR *PSSR                                                       AR916521
     C                     GOTO RTEND                                                       AR916521
     C                     END
     C*
     C                     MOVELACOD      ZTBKY2 10
     C                     CALL 'AOACODR0'
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM ZTBKY2    @AFNB  10
     C           SDACOD    PARM SDACOD    DSFDY
     C           @RTCD     IFNE *BLANK
     C                     MOVE '029'     DBASE            **********
     C                     MOVEL@OPTN     DBOPTN  7        *  029   *
     C                     MOVELZTBKY2    DBKEY            **********
     C                     MOVEL'SDACODPD'DBFILE
     C                     SETON                     U7U8LR
     C                     EXSR *PSSR
     C                     END
     C*
     C           RTEND     ENDSR                           *** RTEND *****
     C*
     C********************************************************************
     C**
     C**   INDOFF SR.   SETOFF INDICATOR 20, 71-76, 27, 28 79-88
     C**
     C           INDOFF    BEGSR                           **** INDOFF ***
     C                     SETOF                     85
     C                     MOVE '0'       IN28    1
     C                     MOVE '0'       IN81
     C                     MOVE '0'       IN82
     C                     MOVE '0'       IN83
     C                     MOVE '0'       IN84
     C                     MOVE '0'       IN85
     C                     MOVE '0'       IN86
     C                     MOVE '0'       IN87
     C                     MOVE '0'       IN88    1
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C*                                                               *
     C* *PSSR    - PROGRAM ERROR DUMP                                 *
     C*                                                               *
     C* CALLS             -                                           *
     C*                                                               *
     C* CALLED BY         -                                           *
     C*                                                               *
     C* FLDS USED         -                                           *
     C*                                                               *
     C*****************************************************************
     C           *PSSR     BEGSR
     C*
     C           @DUMP     IFEQ *BLANKS
     C                     MOVE 'Y'       @DUMP   1
     C                     SETON                     U7U8LR
     C                     DUMP
     C                     RETRN
     C                     END
     C*
     C                     ENDSR
     C****************************************************************
     C/EJECT
     C/COPY ZSRSRC,ZFRPEDZ3
     C/EJECT
     ODL0207P1H   03   L1 79
     O       AND      N45
     O       OR        OFNL1
     O       AND      N45
     O       OR        60 OF L1
     O       AND      N45
     O                                   24 'REFERENCE DL0207P1'
     O                         BJURPT    89
     O                                  104 'DATE'
     O                         BJMRDT   112
     O                                  122 'PAGE'
     O                         PAGE  Z  127
     O        H   05   L1 79
     O       AND      N45
     O       OR        OFNL1
     O       AND      N45
     O       OR        60 OF L1
     O       AND      N45
     O                 U1                20 '** INTERIM **'
     O                 U1      TIME      30 '  :  :  '
     O                                   67 'LIST OF TODAY''S'
     O                N26N27             73 ' DEALS'
     O                N26N27 02          90 '- FIXED DEPOSITS'
     O                N26N27 04          93 '- NON-FIXED DEPOSIT'
     O                 26                76 ' FX DEALS'
     O                 27                76 ' MM DEALS'
     O                 27 02             93 '- FIXED DEPOSITS'
     O                 27 03             96 '- NON-FIXED DEPOSIT'
     O        H   06   L1 79
     O       AND      N45
     O       OR        OFNL1
     O       AND      N45
     O       OR        60 OF L1
     O       AND      N45
     O                N26N27             73 '---------------------'
     O                 26                76 '------------------------'
     O                 27                76 '------------------------'
     O        H   08   L1 79
     O       AND      N45
     O       OR        OFNL1
     O       AND      N45
     O       OR        60 OF L1
     O       AND      N45
     O                 30NLR             12 'BRANCH'
     O                 30NLR   DBRCA     16
     O                 30NLRN58A8BRNM    48
     O                 30NLR 58          37 'INVALID BRANCH CODE'
     O        H   10   L1NLR 79
     O       AND      N45
     O       OR        OFNL1NLR
     O       AND      N45
     O**********          30 32          15 'ORIG.'                                           CDL038
     O**********          30N32          15 '     '                                           CDL038
     O**********                         36 'DEAL   DEAL   VALUE'                             CDL038
     O                    30 32          11 'ORG.'                                            CDL038
     O                    30N32          11 '    '                                            CDL038
     O                                   17 'DEAL'                                            CDL038
     O                                   36 'DEAL       VALUE'                                CDL038
     O                N26                46 'MATURITY'
     O                                   50 'CCY'
     O                                   71 'PURCHASE/'
     O                                  125 'SALE      ACTION'
     O*
     O        H   1113 L1NLR 79
     O       AND      N45
     O       OR        OFNL1NLR
     O       AND      N45
     O**********                          9 ' CUSTOMER'                                       CDL038
     O**********          30             14 '  BR.'                                           CDL038
     O**********                         22 '  NUMBER'                                        CDL038
     O**********                         36 'TYPE    DATE'                                    CDL038
     O                                    6 ' CUST.'                                          CDL038
     O                    30             10 'BR.'                                             CDL038
     O                                   18 '  NUMBER'                                        CDL038
     O                                   36 'TYPE        DATE'                                CDL038
     O                N26                43 'DATE'
     O                                   70 'DEP.AMT.'
     O                N27                95 'RATE   O/R    CCY'
     O                                  125 'AMOUNT    STATUS'
     O                                  131 'TIME'
     O*
     O        H   1315 L1NLR 19
     O       AND       79
     O       OR        OFNL1NLR
     O       AND       19
     O                                   23 '-----------------------'
     O                                   46 '-----------------------'
     O                                   69 '-----------------------'
     O                                   92 '-----------------------'
     O                                  115 '-----------------------'
     O                                  132 '-----------------'
     O        DF 1     01N42N49
     O       AND       76 79
     O       OR  1     01N42 76
     O       AND       80
     O       OR  2     01N42 49
     O       AND       76
     O       OR  2     01N42 49
     O       AND      N14N15 76
     O       AND       16
     O       OR  1     01N42 49
     O       AND       14 76 16
     O       OR  1     01N42 49
     O       AND       15 76 16
     O                         CNUM       6
     O                    08   ISCN       6
     O**********          30 32ORBR      14                                                   CDL038
     O**********          30N32BRCA      14                                                   CDL038
     O**********               DLNO      22                                                   CDL038
     O**********               DTYP      25                                                   CDL038
     O**********                         26 '-'                                               CDL038
     O**********               DLST      28                                                   CDL038
     O**********               BYSL   B  29                                                   CDL038
     O                    30 32ORBR      10                                                   CDL038
     O                    30N32BRCA      10                                                   CDL038
     O                         DLNO      18                                                   CDL038
     O                         DTYP      21                                                   CDL038
     O                                   22 '-'                                               CDL038
     O                         DLST      24                                                   CDL038
     O                         CLAS      28                                                   CDL038
     O                 11      BYSL      30                                                   CDL038
     O                 08      PCLI      30
     O                 09      PCLI      30
     O                         VADATE    38
     O                N09      ZADATE    46
     O                 06N34N37          46 '       '
     O                 07 23 39NOTD  3   41
     O                 07 23 39          42 ' '
     O                 07 23 39          46 'DAYS'
     O                 07 22 23          46 ' CALL  '
     O                         KCCY      50
     O                 09                50 '   '
     O                 35N09N33AMT       67 ' ,   ,   ,   , 0 '
     O                 46N09N33AMT       69 '   ,   ,   , 0 . '
     O                 47N09N33AMT       70 '  ,   ,   , 0 .  '
     O                 48N09N33AMT       71 ' ,   ,   , 0 .   '
     O                 06N77   EXRT  L   86
     O                 07      INTR  L   85
     O                 08      YRAT  L   85
     O                 09      YRAT  L   85
     O                 11N62 63FIX1  L   85
     O                 11N62N63FLT1      81
     O                 11 62N13CLRAT L   85
     O                 11 62 13FLRAT L   85
     O                 06 78 43          88 '***'
     O                 06N77   SLCY      95
     O                 09      KCCY      95
     O                 33                50 '   '
     O                 33      KCCY      95
     O                 35 33   AMT      113 ' ,   ,   ,   , 0 '
     O                 46 33   AMT      115 '   ,   ,   , 0 . '
     O                 47 33   AMT      116 '  ,   ,   , 0 .  '
     O                 48 33   AMT      117 ' ,   ,   , 0 .   '
     O                 35N40N06AMTA     113 ' ,   ,   ,   , 0 '
     O                 46N40N06AMTA     115 '   ,   ,   , 0 . '
     O                 47N40N06AMTA     116 '  ,   ,   , 0 .  '
     O                 48N40N06AMTA     117 ' ,   ,   , 0 .   '
     O                 06 36   AMTA     113 ' ,   ,   ,   , 0 '
     O                 06 53   AMTA     115 '   ,   ,   , 0 . '
     O                 06 54   AMTA     116 '  ,   ,   , 0 .  '
     O                 06 55   AMTA     117 ' ,   ,   , 0 .   '
     O                 38               125 'AMEND '
     O                 43               125 'INSERT'
     O                 44               125 'DELETE'
     O                         TIM      132 '  .  '
     O*                                                                                      BUG7866
     O** Report Detail is moved from the 4th to the 2nd line                                 BUG7866
     O*                                                                                      BUG7866
     O        D  1     05N42N49                                                              BUG7866
     O       AND      N69 01 76                                                              BUG7866
     O       AND      N18                                                                    BUG7866
     O       AND       79                                                                    BUG7866
     O       AND      N21                                                                    BUG7866
     O       OR  1     69 13N14                                                              BUG7866
     O       AND      N15 76 16                                                              BUG7866
     O       OR  1     69 13 14                                                              BUG7866
     O       AND       76 16                                                                 BUG7866
     O       OR  1     69 13 15                                                              BUG7866
     O       AND       76 16                                                                 BUG7866
     O       OR  1     69 13 76                                                              BUG7866
     O       AND      N18                                                                    BUG7866
     O       OR  1     69N13 76                                                              BUG7866
     O       AND      N18                                                                    BUG7866
     O       OR  1     06N21 76                                                              BUG7866
     O       AND      N18                                                                    BUG7866
     O       OR  1     06 21 76                                                              BUG7866
     O       AND      N18                                                                    BUG7866
     O       OR  1    N06 21 76                                                              BUG7866
     O       OR  1     11 76                                                                 BUG7866
     O                N18      WCRNM     21                                                  BUG7866
     O                N18      WCTWN     32                                                  BUG7866
     O** REPORT FIELDS ADDED FOR ROLLOVER                                                    BUG7866
     O*                                                                                      BUG7866
     O                 31 07             53 'ROLLOVER: AUTO ='                               BUG7866
     O                 31 07   AURO      55                                                  BUG7866
     O                 31 07             74 'INTEREST PAID '                                 BUG7866
     O                 31 07             86 'SEPARATELY ='                                   BUG7866
     O                 31 07   IPDS      88                                                  BUG7866
     O                 59 06            110 'PORTFOLIO REFERENCE'                            BUG7866
     O                 59 06   RRPTFR   116                                                  BUG7866
     O                 59 07            110 'PORTFOLIO REFERENCE'                            BUG7866
     O                 59 07   RRPTFR   116                                                  BUG7866
     O*                                                                                      BUG7866
     O                         RRCSTS   122                                                  BUG7866
     O*                                                                                      BUG7866
     O                 11 64   FIX2  L   85                                                  BUG7866
     O                 11N64   FLT2      81                                                  BUG7866
     O                 11 61   TCUCY     95                                                  BUG7866
     O                 11 61 65TPAMT    113 ' ,   ,   ,   , 0 '                              BUG7866
     O                 11 61 66TPAMT    115 '   ,   ,   , 0 . '                              BUG7866
     O                 11 61 67TPAMT    116 '  ,   ,   , 0 .  '                              BUG7866
     O                 11 61 68TPAMT    117 ' ,   ,   , 0 .   '                              BUG7866
      *                                                                                      BUG7866
     O        D  1     05N42N49
     O       AND      N69 18 76
     O       AND       01
     O       OR  2     69 13 76
     O       AND       18 01
     O       OR  1     69N13 76
     O       AND       18 01
     O                         WCRNM     21
     O                         WCTWN     32
     O                                   48 'PAYMENT :'
     O                N09      WST1      51
     O                         GOURA     71
     O**********          84   GNOSM     95                                                 AR916521
     O                    84   GNOSM    100                                                 AR916521
     O                   N84   GSPSM    100
     O                    85            114 'Blocked Ind : '
     O                    85   FSBLKA B 116
     O*****************83               126 'O/R BY :'
     O*****************83      SVIDO  B 138
     O*
     O        D  2     05N42N49
     O       AND       76 18 01
     O                                   48 'RECEIPT :'
     O                         WST2      51
     O                         GOURC     71
     O**********          86   GNOSN     95                                                 AR916521
     O                    86   GNOSN    100                                                 AR916521
     O                   N86   GSPSN    100
     O                    85            114 'Rollover Ind : '
     O                    85   FSROLI B 116
     O        D  1     05N42N49                                                               CRE073
     O       AND       01 97 76                                                               CRE073
     O       AND      N06                                                                     CRE073
     O                                   62 'CONTRACTUAL SPREAD RATE'                         CRE073
     O                         CNSP  L   84                                                   CRE073
     O        D  1     05N42N49                                                               CRE073
     O       AND       01 97 76                                                               CRE073
     O       AND      N06                                                                     CRE073
     O                                   63 'ROUNDING METHOD FRAC/DEC'                        CRE073
     O                         RDMT      79                                                   CRE073
     O                         RDFD      84                                                   CRE073
     O********D* 1     05N42N49                                                              BUG7866
     O*******AND      N69 01 76                                                              BUG7866
     O*******AND      N18                                                                    BUG7866
     O*******AND       79                                                                    BUG7866
     O*******AND      N21                                                                    BUG7866
     O*******OR* 1     69 13N14                                                              BUG7866
     O*******AND      N15 76 16                                                              BUG7866
     O*******OR* 1     69 13 14                                                              BUG7866
     O*******AND       76 16                                                                 BUG7866
     O*******OR* 1     69 13 15                                                              BUG7866
     O*******AND       76 16                                                                 BUG7866
     O*******OR* 1     69 13 76                                                              BUG7866
     O*******AND      N18                                                                    BUG7866
     O*******OR* 1     69N13 76                                                              BUG7866
     O*******AND      N18                                                                    BUG7866
     O*******OR* 1     06N21 76                                                              BUG7866
     O*******AND      N18                                                                    BUG7866
     O*******OR* 1     06 21 76                                                              BUG7866
     O*******AND      N18                                                                    BUG7866
     O*******OR* 1    N06 21 76                                                              BUG7866
     O**********      N18      WCRNM     21                                                  BUG7866
     O**********      N18      WCTWN     32                                                  BUG7866
     O***REPORT*FIELDS ADDED FOR ROLLOVER                                                    BUG7866
     O**********                                                                             BUG7866
     O**********       31 07             53 'ROLLOVER: AUTO ='                               BUG7866
     O**********       31 07   AURO      55                                                  BUG7866
     O**********       31 07             74 'INTEREST PAID '                                 BUG7866
     O**********       31 07             86 'SEPARATELY ='                                   BUG7866
     O**********       31 07   IPDS      88                                                  BUG7866
     O**********       59 06            110 'PORTFOLIO REFERENCE'                            BUG7866
     O**********       59 06   RRPTFR   116                                                  BUG7866
     O**********       59 07            110 'PORTFOLIO REFERENCE'                            BUG7866
     O**********       59 07   RRPTFR   116                                                  BUG7866
     O**********                                                                             BUG7866
     O**********               RRCSTS   122                                                  BUG7866
     O**********                                                                             BUG7866
     O**********       11 64   FIX2  L   85                                                  BUG7866
     O**********       11N64   FLT2      81                                                  BUG7866
     O**********       11 61   TCUCY     95                                                  BUG7866
     O**********       11 61 65TPAMT    113 ' ,   ,   ,   , 0 '                              BUG7866
     O**********       11 61 66TPAMT    115 '   ,   ,   , 0 . '                              BUG7866
     O**********       11 61 67TPAMT    116 '  ,   ,   , 0 .  '                              BUG7866
     O**********       11 61 68TPAMT    117 ' ,   ,   , 0 .   '                              BUG7866
      *
     O        D  1     07 76 45
     O       AND       82
     O                 45                34 'CHARGE CODE : '
     O                 45      R0FCGC    36
     O                 45                44 'DESC. :'
     O                 45      R0FCGD    64
     O                 45                81 'CHARGE AMNT : '
     O                 35 45   R0FCGA    99 ' ,   ,   ,   , 0 '
     O                 46 45   R0FCGA   101 '   ,   ,   , 0 . '
     O                 47 45   R0FCGA   102 '  ,   ,   , 0 .  '
     O                 48 45   R0FCGA   103 ' ,   ,   , 0 .   '
      *
     O        D  1     07 76 45
     O       AND       82
     O                 45                34 'COMM.  CODE : '
     O                 45      R0FCMC    36
     O                 45                44 'DESC. :'
     O                 45      R0FCMD    64
     O                 45                81 'COMM.  AMNT : '
     O                 35 45   R0FCMA    99 ' ,   ,   ,   , 0 '
     O                 46 45   R0FCMA   101 '   ,   ,   , 0 . '
     O                 47 45   R0FCMA   102 '  ,   ,   , 0 .  '
     O                 48 45   R0FCMA   103 ' ,   ,   , 0 .   '
      *
     O        D  1     07 76 45
     O       AND      N82
     O*
     O        D  2     69N13 76
     O       AND      N80
     O       OR  1     69N13 76
     O       AND       80
     O       OR  2     69N13N14
     O       AND      N15 76 16
     O       OR  1     69N13 14
     O       AND       76 16
     O       OR  1     69N13 15
     O       AND       76 16
     O                         FLRAT L   85
     O        D  1     14 15 76
     O       AND       16
     O       OR  1     14 80 76
     O       AND       16
     O       OR  2     14N15 76
     O       AND       16
     O                         RLDTL1    81
     O        D  2     15 76 16
     O       AND      N80
     O       OR  1     15 76 16
     O       AND       80
     O                         RLDTL2    81
     O*
     O        D  2     06 21 76
     O       AND      N82N80
     O       OR  1     06 21 76
     O       AND       82N80
     O       OR  1     06 21 76
     O       AND       80
     O                                   06 'Margin'
     O                         MGPT  L   21
     O                         MGBS      22
     O                                   41 'DL base spot rate'
     O                         BDBS  L   57
     O                                   79 'Buy DL base fwd pts'
     O                         BDBF  L   89
     O                         BDBFS     90
     O                                  112 'Sell DL base fwd pts'
     O                         SDBF  L  122
     O                         SDBFS    123
      *
      ** Output FX Netting fields to printer file
      *
     O        D  2     06 21 76
     O       AND       82N80
     O       OR  1     06 21 76
     O       AND       82 80
     O                                   20 'Manually Matched:'
     O                         MATCH     22
     O                         BYNETT    59
     O                         NETBR     79
     O                         SLNETT   104
     O                         NETSR    124
      *
      ** Output Analytical Accounting Fields to Printer File
      *
     O        D  1     07 80 76
     O       AND      N81
     O       OR  1     08 80 76
     O       AND      N81
     O       OR  2     81 80 76
     O                                   13 'Profit Centre'
     O                         PRFC      19
      *
     O        D  2     07 80 76
     O       AND      N81
     O       OR  2     08 80 76
     O       AND      N81
     O                                   19 'Funding Spread/Rate'
     O                                   26 ' / Sign'
     O                         FSRP  L   40
     O                         FSGN      41
     O                                   67 'Funding Profit Centre'
     O                         FPRC      74
      *
      ** Output Breakdown Deposit information to Printer File
      *
     O        D  1     07 71 76
     O                                   22 'Breakdown Information:'
     O                                   31 'Penalty'
     O                 35 73   PENA      57 ' ,   ,   ,   , 0 '
     O                 46 73   PENA      58 '   ,   ,   , 0 . '
     O                 47 73   PENA      59 '  ,   ,   , 0 .  '
     O                 48 73   PENA      60 ' ,   ,   , 0 .   '
     O                 72                80 'Last BreakDown User'
     O                 72      BUSR      91
     O                 72               115 'Original Maturity Date'
     O                 72      POMDT    123
      *
     O        D  1     05N42N49
     O       AND      N69 19 76
     O       AND       01
     O       OR  2     69 13 19
     O       AND       76 01
     O       OR  1     69N13 19
     O       AND       76 01
     O                                   11 'DEAL DATE: '
     O                         DADATE    18
     O                                   30 'BROKER: '
     O                         BRKC      34
     O                                   56 'ACCOUNT SEQUENCE: '
     O                         CDAS      58
     O                 07                80 'TOTAL INTEREST: '
     O                 20                84 'DEALT BASE CURRENCY '
     O                 20                96 'EQUIVALENT: '
     O                 07 35   TOTI      97 ' ,   ,   ,   , 0 '
     O                 07 46   TOTI      98 '   ,   ,   , 0 . '
     O                 07 47   TOTI      99 '  ,   ,   , 0 .  '
     O                 07 48   TOTI     100 ' ,   ,   , 0 .   '
     O                 20 24   BCEQ     113 ' ,   ,   ,   , 0 '
     O                 20 25   BCEQ     114 '   ,   ,   , 0 . '
     O                 20 28   BCEQ     115 '  ,   ,   , 0 .  '
     O                 20 29   BCEQ     116 ' ,   ,   , 0 .   '
     O*
     O        D  1     05N42N49
     O       AND      N69 19 76
     O       AND       01
     O                                   24 'RECEIPT INSTRUCTIONS:   '
     O                                   35 'SETT. METH.: '
     O                         RSTMA     37
     O                                   50 'OUR NOSTRO: '
     O                         RONSA     63
     O                                   80 'ORD. BANK/CUST: '
     O                         ROCNA     86
     O*
     O        D  1     05N42N49
     O       AND      N69 19 76
     O       AND       01
     O                                   22 'PAYMENT INSTRUCTIONS: '
     O                                   35 'SETT. METH.: '
     O                         PSTMA     37
     O                                   50 'OUR NOSTRO: '
     O                         PONSA     63
     O                                   80 'ORD. BANK/CUST: '
     O                         POCNA     86
     O                                  102 'A/C WITH BANK: '
     O                         AWBNA    110
     O                                  124 'BENEFICIARY: '
     O                         BENNA    132
     O*
     O        D 12     05N42N49
     O       AND      N69 19 76
     O       AND       01
     O                                   23 '-----------------------'
     O                                   46 '-----------------------'
     O                                   69 '-----------------------'
     O                                   92 '-----------------------'
     O                                  115 '-----------------------'
     O                                  132 '-----------------'
     O*
     O        T 2      L1 01N03
     O       AND       02
     O       AND      N45
     O       OR        LR 70N03
     O       AND       02
     O       AND      N45
     O                                   56 '*** NO FIXED '
     O                                   75 'DEPOSIT DEALS EXIST'
     O                                   95 ' FOR THIS BRANCH ***'
     O        T 3      L1 01 79
     O       AND      N45
     O       OR        LR 70 79
     O       AND      N45
     O                                   61 '*** END OF'
     O                                   83 ' REPORT FOR BRANCH ***'
     O*
     ODL0207AUT 00     LRNU1
     O       OR       N70 LR
     O       AND      N45
     O       OR        U7 U8
     O                                   24 'REFERENCE DL0207AU'
     O                         BJURPT    89
     O                                  104 'DATE'
     O                         BJMRDT   112
     O                                  122 'PAGE'
     O                         PAGE1 Z  127
     O        T   05   LRNU1
     O       OR       N70 LR
     O       AND      N45
     O       OR        U7 U8
     O                                   67 'LIST OF TODAY''S'
     O                N26N27             73 ' DEALS'
     O                 26                76 ' FX DEALS'
     O                 27                76 ' MM DEALS'
     O        T   06   LRNU1
     O       OR       N70 LR
     O       AND      N45
     O       OR        U7 U8
     O                N26N27             73 '---------------------'
     O                 26                76 '------------------------'
     O                 27                76 '------------------------'
     O        TF00     LRNU1
     O        T  236   LRNU1
     O                                   18 'RUN CONTROLS'
     O                                   72 '------------ REPORT'
     O                                   83 '-----------'
     O                 50               116 '--------- FILE CONTROL'
     O                 50               124 '--------'
     O        T  2     LRNU1
     O                                   59 'NUMBER'
     O                                   84 'VALUE'
     O                 50                99 'NUMBER'
     O                 50               124 'VALUE'
     O        T  2     LRNU1
     O                                   30 'RECORDS LISTED IN THIS'
     O                                   37 'REPORT'
     O                         RCCT  3   59
     O        T  2     LRNU1 50
     O                                   28 'RECORDS BEFORE INPUT'
     O                                   34 'CYCLE'
     O                         NLRB  3   99
     O                         VLBF  4  121
     O                         VLBL     124
     O        T  2     LRNU1 50
     O                                   24 'RECORDS INSERTED'
     O                         ICT   3   59
     O                         ITOTI 4   81
     O                         ITOTD     84
     O                         NINS  3   99
     O                         VRIF  4  121
     O                         VRIL     124
     O                 51               128 '***'
     O        T  2     LRNU1 50
     O                                   23 'RECORDS DELETED'
     O                         DCT   3   59
     O                         DTOTI 4   81
     O                         DTOTD     84
     O                         NDEL  3   99
     O                         VRDF  4  121
     O                         VRDL     124
     O                 52               128 '***'
     O        T     52 LR U8NU1
     O       AND       50
     O       OR     52 LRNU8NU1
     O       AND       50
     O                                   27 'RECORDS AFTER INPUT'
     O                                   33 'CYCLE'
     O                         NLRA  3   99
     O                         VLAF  4  121
     O                         VLAL     124
     O        T 1      88 LR                                                                  239244
     O                                   71 '*** DIFFERENCE IN CALCUL'                        239244
     O                                   91 'ATED AND TRAILER ***'                            239244
     O** OUTPUT DATABASE ERROR IF NECESSARY
     O        T 3      LR U7 U8
     O                                   71 '*** PRINT TERMINATED ***'
     O        T 1      LR U7 U8
     O                                   57 'DATABASE ERROR'
     O                         DBASE     61
     O                                   67 'FILE'
     O                         DBFILE    78
     O        T 13     LR U7 U8
     O                                   49 'OPTION'
     O                         DBOPTN    57
     O                                   66 'KEY'
     O                         DBKEY     96
     O*
     O        T 3      LRN70NU7
     O                                   73 '** NO DETAILS TO REPORT'
     O                                   76 ' **'
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2004
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** TABTYP - TABLE OF DEAL TYPES FOR MONEY MARKET
IPCLDLTIBDDATAC1C2BPITTDCILNCDTBCSBSBRTSRATRILIDFLDPLPFTDTLT  S01136S01354
** TABTZP - TABLE OF FX DEALS ONLY
FPFSPISICXOPOTSW
