0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Base rate changes extract')                   *
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Dealing Module                                       *
0005 F*                                                               *
0006 F*    DL0250 - BASE RATE CHANGES EXTRACT                         *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0009 F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 MD031713           Date 23Jun15               *
      *                 CGL165             Date 17Feb15               *
      *                 AR814519           Date 13Mar15               *
      *                 MD031598           Date 23Feb15               *
      *                 MD031283           Date 23Feb15               *
      *                 MD031123A          Date 24Nov14               *
      *                 MD031856           Date 26Jan15               *
      *                 CDL096             Date 22Sep14               *
      *                 CIR018             Date 31Aug14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD026719           Date 19Aug14               *
      *                 AR1045065A         Date 18Jul14               *
      *                 AR755195           Date 18Jul14               *
      *                 CRE073             Date 06Dec10               *
      *                 AR762808C          Date 11Jun11               *
      *                 AR762808B          Date 09Jun11               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 229360             Date 09Sep04               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 227642             Date 23Aug04               *
      *                 236317             Date 08Dec05               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG10282           Date 04Feb06               *
      *                 CAS009             Date 04May04               *
      *                 CDL038             Date 10May05               *
      *                 BUG7563R (Re-open) Date 01Ju105               *
      *                 CDL033             Date 10Feb05               *
      *                 BUG7533R (Re-open) Date 29Jun05               *
      *                 BUG7722            Date 23Jun05               *
      *                 BUG7564            Date 15Jun05               *
      *                 BUG7563            Date 15Jun05               *
      *                 BUG7533            Date 14Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL019             Date 03Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 204923             Date 29Apr02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 23May01                  *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 174276             Date 07Feb00                  *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CSW011             Date 09MAY97                  *
     F*                 CSW005             Date 01Aug96                  *
     F*                 S01408             DATE 15AUG96                  *
     F*                 083921             Date 01Jul96                  *SA1157
     F*                 097779             Date 05Mar96                  *
     F*                 046671             DATE 16JUL93                  *
     F*                 E49965             DATE 01FEB93                  *
     F*                 E39372             DATE 30APR92                  *SA1157
     F*                 E25955               DATE  11SEP91               *SA1157
     F*                 E26465               DATE  06AUG91               *SA1157
     F*                 LN0815               DATE  10OCT90               *SA1157
     F*                 LN0135               DATE  23MAY90               *SA1157
     F*                 E250                 DATE  1MAR90                *SA1157
     F*                 E111/S01194          DATE  27NOV89               *SA1157
     F*                 SA1157               DATE  04/10/88              *SA1157
     F*                 S01117               DATE  22/02/89              *S01117
     F*                 S01194               DATE  22/02/89              *S01194
     F*                 E14920               DATE  01/09/88              *
     F*                 S01119               DATE  15/06/87              *
     F*                 S01125               DATE  11/11/86              *
     F*                 S01093               DATE  24/09/86              *
     F*                                                                  *
     F*------------------------------------------------------------------*
     F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  MD031713 - MM deal shows incorrect interest accrued/paid     *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  AR814519 - Allow negative base rate. Applied for MD033488.   *
      *  MD031598 - Additional fix to use historic rate when maturity *
      *             date same as run date                             *
      *  MD031283 - Different wrong/strange base rates applied to the *
      *             backdated MM deals on a value date                *
      *  MD031123A - DEAM BC(Base Rate change) not reflected on time  *
      *             deposit                                           *
      *           - use the new base rate from BC amendment           *
      *  MD031856 - Enhance fix MD026719.                             *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CIR018 - Daily Rate Change Frequency on SIRS                 *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  MD026719 - Deal takes base rate as per wrong date.           *
      *             Extract base rate change regardless if fix base   *
      *             rate is 'Y' when deal value date is equal to rate *
      *             change vale date.                                 *
      *           - Applied for MD028339.                             *
      *  AR1045065A - Access First the current base rate then historic*
      *               base rate if not found and remove fix 229360.   *
      *               (Child:AR1045066).                              *
      *             - Applied for MD028339.                           *
      *  AR755195 - Ensure such things                                *
      *           - base rate changes are done even if deal is        *
      *             fixed term when CDL019 is ON                      *
      *           - base rate changes are done when CDL033 and        *
      *             CDL019 are ON and there is no rate change date    *
      *             (Child:AR755196)                                  *
      *           - Applied for MD028339.                             *
      *  CRE073 - Interest Rate Rounding                              *
      *  AR762808C - Decimal data error in DLC0606B 00001             *
      *  AR762808B - Decimal data error in DLC0606B 00001             *
      *  229360 - If deal type is FIXED Loan/Deposit (IP, IT, TD, TI  *
      *           or CI), do not update the Base Rate on DAMBRDI.     *
      *           Applied fix 221370.                                 *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  227642 - New value 'A' for rate fixing indicator when short  *
      *           term rate is amended.  Update base rate if RFIN is  *
      *           'A' since this means base rate not picked up in I/C.*
      *  236317 - Divide by zero error.                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG10282 - Fix field CLAS for DEALSDC.                       *
      *  CAS009 - Effective Interest Rate/Amortised Cost Accounting   *
      *  CDL038 - Extended Deal Sub Type                              *
      *  BUG7563R - CDL028 Interpolated Rate is incorrect (Re-open)   *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  BUG7533R- CDL028 fld INTVAL not reset (Re-open)              *
      *  BUG7722- CDL028 Stub deals have a problem when there are     *
      *           just 2 interest periods.                            *
      *  BUG7564- CDL028 Interpolated Rate has rounding errors        *
      *  BUG7563- CDL028 Interpolated Rate is incorrect for End Stubs *
      *  BUG7533- CDL028 fld INTVAL not reset when reading a new deal *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations                       *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *         - Input specifications wrong for end fields of DEALSDC*
      *         - DEALSDG wrongly defined for new fields              *
      *  CGL029 - Increase Account Code to 10 digits (Recompile)      *
      *  CAS006 - Hedge Accounting Phase B (Recompile)                *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  204923 - Rate Fix Days Adjustment (OIS)                      *
     F*  CSD006 - Use long DS with SDBSRTPD.                          *
     F*  174276 - Open SDBANKL1 as keyed, otherwise DLC0605 fails.    *
     F*  CSW011 - FRA MT34n only Message Generation                   *
     F*  CSW005 - MG34n and MG36n message generation                  *
     F*  S01408 - Core Hook DL0250CCP3 Added                             *
     F*         - Core Hook DL0250CCP2 Added                             *
     F*         - Core Hook DL0250CCP1 Added                             *
     F*  083921 - Base rate was output as zero when rate fix date     *
     F*           falling on holiday.                                 *
     F*  097779 - The spread for THEIR details is not shown when      *
     F*           there is no spread for OUR details for deal type    *
     F*           RX, RS - re-initialise *IN61 when FIDMBR is called  *
     F*           the second time.                                    *
     F*  046671 - The heading appeared on the first page then         *
     F*           followed by the information on the next page.       *
     F*           Happens only if the first record to be printed      *
     F*           is an FRA/IRS deal.                                 *
     F*     E49965 - BOOKING BRANCH ADDED TO DEAMSDI/MMDEAMPP            *
     F*     E39372  -  P1 PRTF NOT PRINTING HEADING OR DATE              *
     F*     E25955 (BH2515) - If no details to report P1 was not         *E25955
     F*                       printing a header                          *E25955
     F*     E26465  -  FRA/IRS BOUGHT/SOLD INDICATOR DEFINED IN THE      *
     F*                WRONG POSITION IN THE INPUT FILE                  *
     F*     LN0815 - P1 HAS NO 'END OF REPORT'.                          *LN0815
     F*              INCORRECT VALUE PASSED IN PARM 'SEQ' FOR ZSFILE     *LN0815
     F*     LN0135 - REMOVE 'END OF REPORT' ON AUDIT REPORT (REVERSE     *LN0135
     F*              E14920)                                             *LN0135
     F*     E250    -   REMOVE UNNECESSARY PARAMETER                     *
     F*     E111/S01194 - SDBSRTL1 SHOULD BE KEYED                       *
0011 F*     SA1157  -  (i)  FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL'  *SA1157
     F*                     INTO 'RR' (COLLAR), 'RP' (CAP) AND 'RF'      *SA1157
     F*                     (FLOOR).                                     *SA1157
     F*                (ii) ALTER REPORT TO DISPLAY BUY/SELL INDICATOR   *SA1157
     F*                     NEXT TO THE DEAL SUB TYPE (eg. 'FR-01B')     *SA1157
     F*                (iii)ALLOW REPORT FOR DEALS 'FR' FOR ZERO         *SA1157
     F*                     RATE FIX DAYS & VAL DATE = RUN DATE          *SA1157
     F*     S01117  -  MULTIBRANCHING                                    *S01117
     F*     S01194  -  NEW STANDING DATA - ADD ACCESS PROGRAMS           *S01194
     F*     E14920  -  ADDITION OF 'END OF REPORT'                       *E14920
     F*     S01119  -  INCORPORATION OF FRA/IRS DEALS                    *S01119
     F*     S01125  -  CHANGE PRIMARY FILE TO TABTB10                    *S01093
     F*     S01093  -  IMPROVEMENTS TO PGM EFFICIENCY.PRIMARY FILE IS    *S01093
     F*                A LOGICAL VIEW OF DEALSDC SELECTING LIVE DEALS    *S01093
     F*                WITH NON-ZERO BASE RATE CODE. NO HASH TOTALLING   *S01093
     F*                IS PERFORMED.                                     *S01093
0011 F*                                                                  *
0012 F********************************************************************
0013 F*LUPDDA*IP**F*****400  6AI     2 DISK                               S01093
     F*LUPDDC*IS**F*****400  6AI     2 DISK                               S01093
     F*                                                               *
     F*****************************************************************
0014 F*****TABLE   IF  F      96 12AI     2 DISK                          S01194
0015 F*****TABLE2  IF  F      96 12AI     2 DISK                          S01194
0016 F*****CLINT   IF  F     256  7AI     2 DISK                          S01194
0017 FDAMBRDH O   F     200 14AI     2 DISK                      A
     F*DAMBRDIO***F*****200*14AI*****2*DISK**********************A                            CDL038
     FDAMBRDI O   F     222 14AI     2 DISK                      A                            CDL038
     FDAMBRDJ O   F     200 14AI     2 DISK                      A
0018 F*L0250P1O   F     128     OF     PRINTER                      S01124S01119
0018 F*L0250P1O***F     132     OF     PRINTER                      S01119S01117
0018 FDL0250AUO   F     128     OA     PRINTER      KINFDS SPOOLU         S01117
0018 FDL0250P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0014 F*****TABTB10 IP  F      96 12AI     2 DISK                    SO1125S01194
     F*SDBANKL1IP**E****************    DISK                        SO1194174276
     FSDBANKL1IP  E           K        DISK                               174276
     F*SDBSRTL1IF**E****************    DISK                              E111
     FSDBSRTL1IF  E           K        DISK                               S01194
     F*EALSBRCIS  F     400  6AI     2 DISK                         S01125S01119
     F*DEALSBRCIS**F****600**6AI**   2 DISK                         S01119CSW005
     F**ALSBRCIP  F     400  6AI     2 DISK                               S01125
     F***DEALSBRCIS  F     689  6AI     2 DISK                                         CSW005 CGL029
     F*DEALSBRCIS**F***  689  6AI     2 DISK                              CSW005   CDL019
     F*DEALSBRCIS**F****2540**6AI*****2 DISK                                            CDL019CDL028
     F*DEALSBRCIS**F***2602**6AI*****2*DISK                                            CDL028 CDL038
     FDEALSBRCIS  F    2606  6AI     2 DISK                                                   CDL038
     FDEALSC  IF  E           K        DISK                           UC                      CDL033
      *                                                                                       CAS009
      ** Midas MM Effective Interest Rate by Tran Ref                                         CAS009
      *                                                                                       CAS009
     FMMEIRDL9UF  E           K        DISK         KINFSR *PSSR                              CAS009
     FSDBSHSL1IF  E           K        DISK                                                 MD031283
     F/COPY WNCPYSRC,DL0250F001
     FDEAMS   IF  E           K        DISK                                                MD031123A
0019 F*
0020 F*
0021 F**01************TABLE*FILE**-*INSTALLATION*CONTROL*DATA*RECORD*1.   S01194
0022 F**02************************-*INSTALLATION*CONTROL*DATA*RECORD*2.   S01194
0023 F**03************************-*INSTALLATION*CONTROL*DATA*RECORD*5.   S01194
0024 F**04************************-*CURRENCY*RECORD*1.*****************   S01194
0025 F**05************************-*BASE*RATE*RECORD.******************   S01194
0026 F**06************************-*CATCHALL.**************************   S01194
0027 F**07************TABLE2*FILE*-*BASE*RATE*RECORD.******************   S01194
0028 F**08************************-*CATCHALL.**************************   S01194
0029 F**09************CLINT*FILE**-*CUSTOMER*STANDING*DATA*RECORD.*****   S01194
0030 F**10******      DLUPD FILE  - DETAIL RECORD TYPE 'C' - LIVE         S01093
0030 F* 10            DEALSDC     - LIVE RECORD                           S01093
0031 F**11******                  - TRAILER RECORD.                       S01093
0032 F**12******                  - DETAIL RECORD - NOT TYPE 'C' - LIVE   S01093
0033 F**13******                  - CATCHALL.                             S01093
0034 F**14******                  - HEADER                                S01093
     F*   N14        P1 NOT OPENED/WRITTEN TO SO 'NO DETAILS TO REPORT'   S01117
0034 F* 15            DLUPDDG FILE (FRA/IRS DEALS)                        S01119
     F*    16         BUY/SELL CONDITIONING INDICATOR                     SA1157
0035 F*    19         DEALS MATURITY DATE IS ZERO
0036 F*       20      ACCRUALS/PROFIT DATE LESS THAN EVENT CONTROL DATE
0037 F********21******END*OF*TABLE*FILE*-*SEQUENTIAL*ACCESS************   S01194
0037 F*       21      END OF BASE RATE FILE - SEQUENTIAL ACCESS           S01194
0038 F*       22      CCY NEW VALUE DATE LESS THAN EVENT CONTROL DATE
0039 F*       23      CURRENCY IN CURRENCY ARRAY DURING LOADING
0040 F*       24      EMPTY CURRENCY ARRAY
0041 F*    25         BASE RATE TYPE ZERO OR NEGATIVE
0042 F*       26      CURRENCY FOUND IN CURRENCY ARRAY
0043 F*       27      DEALS RECORD TO BE GENERATED INDICATOR ON
0044 F*       28      CCY NEW VALUE DATE LESS THAN OR EQUAL TO CTRL DATE
0045 F*       29      FAILED CHAIN TO CUSTOMER MASTER FILE
0046 F*       30      VALUE DATE OF RATE CHANGE LESS THAN CONTROL DATE
0047 F*       31      BASE RATES FACILITY NOT USED
0048 F*       32      INHIBIT OUTPUT OF PRINT HEADINGS
0049 F********33******TABLE*RECORD*CODE*21*****************************   S01194
0050 F*       36      ACCRUAL CONTROL DATE EQUALS VALUE DATE
0051 F*       34      DEALS RECORD PRINTED
0052 F*       35      OUTPUT PRINT HEADINGS ON FIRST PAGE
0053 F*       40      SKIP FIRST CYCLE CALCULATIONS
0054 F*       41      RECORD COUNTS OUT OF BALANCE
0055 F*       42      RECORD COUNTS OUT OF BALANCE
0056 F*       43      RECORD VALUES OUT OF BALANCE
0057 F*       50      CURRENCY HAS 0 DECIMAL PLACES
0058 F*       51      CURRENCY HAS 1 DECIMAL PLACE
0059 F*       52      CURRENCY HAS 2 DECIMAL PLACES
0060 F*       53      CURRENCY HAS 3 DECIMAL PLACES
     F*       54      INITIAL RATE SET                                    S01119
     F********55******BACKVALUED*RL*AVERAGE*WITH*BV*AMENDMENT*     S01119 SA1157
     F*       55      BACKVALUED RR/RP/RF AVERAGE WITH BV AMENDMENT       SA1157
     F*       56      AVERAGE RATE AMENDED                                S01119
     F*       57      USE OLD RATE FOR FRA/IRS DEAL FIX DATES             S01119
0060 F*       60      WORK INDICATOR                                      S01119
0060 F*       61      DO NOT PRINT ZERO SPREAD RATE                       S01119
      *       71      Early fixing, rundate is less than                                      CDL033
      *               event control date                                                      CDL033
      *       72      Condition printing of DBKEY                                             CDL033
      *       73      On if CDL033 is on.                                                     CDL033
     F/COPY WNCPYSRC,DL0250F002
     E                    CPY@    1   1 80
0061 E                    CCYA      150  3               CURRENCY ARRAY
0062 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0063 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0064 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**********          FXTERM  5   5  2                                         CDL033 AR1045065A
     E                    FXTERM  6   6  2                                                AR1045065A
0065 E**
0066 I*****                                                               S01194
0067 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0068 I*****                                                               S01194
0069 I*ABLE** NS  01   2 C0   3 C1  12 C1                           S01125S01194
0069 I*****TABTB10 NS  01   2 C0   3 C1  12 C1                      S01125S01194
0070 I*****  AND      13 C0                                               S01194
0071 I*****                                   1   1 RECI                  S01194
0072 I*****                                   2   30RECT                  S01194
0073 I*****                                  12  130RCDE                  S01194
0074 I*****                                  14  66 TITL                  S01194
0075 I*****                                  67  67 DATF                  S01194
0076 I*****                                  68  700DFBR                  S01194
0077 I*****                                  74  74 MODI1                 S01194
0078 I*****                                  75  75 MODI2                 S01194
0079 I*****                                  76  76 MODI3                 S01194
0080 I*****                               P  77  790RUND                  S01194
0081 I*****                                  80  86 RUNA                  S01194
0082 I*****                                  87  870SFLG                  S01194
0083 I*****                               P  90  920LCD                   S01194
0084 I*****                                  93  93 CHTP                  S01194
0085 I*****                               P  94  960TNLU                  S01194
0086 I*****                                                               S01194
0087 I*****                                                               S01194
0088 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               S01194
0089 I*****                                                               S00119
0090 I*****   NS  02   1 CD   2 C0   3 C1                                 S01125
0090 I*****TABLE   NS  02   1 CD   2 C0   3 C1                      S01125S01194
0091 I*****  AND      12 C1  13 C1                                        S01194
0092 I*****                                   1   1 RECI                  S01194
0093 I*****                                   2   30RECT                  S01194
0094 I*****                                  12  130RCDE                  S01194
0095 I*****                                  14  16 BCCY                  S01194
0096 I*****                                  17  19 BCYL                  S01194
0097 I*****                                  20  22 HOCY                  S01194
0098 I*****                                  23  280HEAD                  S01194
0099 I*****                               P  29  310APDA                  S01194
0100 I*****                                  35  35 APFQ                  S01194
0101 I*****                               P  36  380LOGS                  S01194
0102 I*****                                  39  40 CUZR                  S01194
0103 I*****                               P  41  430DNWD                  S01194
0104 I*****                                  44  460BVLP                  S01194
0105 I*****                                  47  49 LOCY                  S01194
0106 I*****                                  50  510FDAY                  S01194
0107 I*****                                  86  86 ISAV                  S01194
0108 I*****                               P  87  890LLOG                  S01194
0109 I*****                               P  90  920LCD                   S01194
0110 I*****                                  93  93 CHTP                  S01194
0111 I*****                               P  94  960TNLU                  S01194
0112 I*****                                                               S01194
0113 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.               S01194
0114 I*****                                                               S01194
0115 I*****TABLE   NS  03   1 CD   2 C0   3 C1                            S01194
0116 I*****  AND      12 C4  13 C0                                        S01194
0117 I*****                                   1   1 RECI                  S01194
0118 I*****                                   2   30RECT                  S01194
0119 I*****                                  12  130RCDE                  S01194
     I*****                                  14  14 IRFRA           S01119S01194
0120 I*****                                  18  210CSAC                  S01194
0121 I*****                                  22  22 TLII                  S01194
0122 I*****                                  23  23 MCRI                  S01194
0123 I*****                               P  24  250MCEP                  S01194
0124 I*****                                  26  270MCLP                  S01194
0125 I*****                                  28  28 FRDI                  S01194
0126 I*****                                  29  29 BRCF                  S01194
0127 I*****                                  30  350PSCN                  S01194
0128 I*****                                  36  380DLBR                  S01194
0129 I*****                                  39  420FRPA                  S01194
0130 I*****                                  43  460FRPC                  S01194
0131 I*****                                  47  49 USCY                  S01194
0132 I*****                                  50  52 STCY                  S01194
0133 I*****                               P  53  553MBGE                  S01194
0134 I*****                               P  90  920LCD                   S01194
0135 I*****                                  93  93 CHTP                  S01194
0136 I*****                               P  94  960TNLU                  S01194
0137 I*****                                                               S01194
0138 I*****                                                               S01194
0139 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0140 I*****                                                               S01194
0141 I*****   NS  04   1 CD   2 C2   3 C0                                 S01194
0142 I*****  AND      13 C1                                               S01194
0143 I*****                                   1   1 RECI                  S01194
0144 I*****                                   2   30RECT                  S01194
0145 I*****                                  10  12 CCY                   S01194
0146 I*****                                  13  130SREC                  S01194
0147 I*****                                  14  27 CCNM                  S01194
0148 I*****                               P  28  348SPOT                  S01194
0149 I*****                                  35  37 CCYS                  S01194
0150 I*****                                  38  380CDP                   S01194
0151 I*****                                  39  390TNOT                  S01194
0152 I*****                                  40  40 DCCY                  S01194
0153 I*****                                  41  44 SRC1                  S01194
0154 I*****                                  45  48 SRC2                  S01194
0155 I*****                                  49  520TACC                  S01194
0156 I*****                                  53  560TEQV                  S01194
0157 I*****                                  57  600SWQV                  S01194
0158 I*****                                  61  640TAC4                  S01194
0159 I*****                                  65  680TAC5                  S01194
0160 I*****                                  69  69 HIND                  S01194
0161 I*****                               P  70  768PART                  S01194
0162 I*****                                  77  780SSNO                  S01194
0163 I*****                               P  79  858ERLC                  S01194
0164 I*****                               P  90  920LCD                   S01194
0165 I*****                                  93  93 CHTP                  S01194
0166 I*****                               P  94  960TNLU                  S01194
0167 I*****                                                               S01194
0168 I*****                                                               S01194
0169 I*****TABLE FILE - BASE RATE RECORD.                                 S01194
0170 I*****                                                               S01194
0171 I*****   NS  05   1 CD   2 C2   3 C1                                 S01194
0172 I*****                                   1   1 RECI                  S01194
0173 I*****                                   2   30RECT                  S01194
0174 I*****                                   9  11 CCY                   S01194
0175 I*****                                  12  130BRTT                  S01194
0176 I*****                               P  14  197BRTE                  S01194
0177 I*****                               P  20  220VDRC                  S01194
0178 I*****                                  23  23 RCIN                  S01194
0179 I*****                                  24  53 BRTN                  S01194
0180 I*****                               P  54  597NBRT                  S01194
0181 I*****                               P  60  620VDNR                  S01194
0182 I*****                               P  90  920LCD                   S01194
0183 I*****                                  93  93 CHTP                  S01194
0184 I*****                               P  94  960TNLU                  S01194
0185 I*****                                                               S01194
0186 I*****CATCHALL.                                                      S01194
0187 I*****   NS  06                                                      S01194
0188 I*****                                                               S01194
0189 I*****                                                               S01194
0190 I*****TABLE FILE - BASE RATE RECORD.                                 S01194
0191 I*****                                                               S01194
0192 I*****TABLE2  NS  07   1 CD   2 C2   3 C1                            S01194
0193 I*****                                   1   1 RECI                  S01194
0194 I*****                                   2   30RECT                  S01194
0195 I*****                                   9  11 CCY                   S01194
0196 I*****                                  12  130BRTT                  S01194
0197 I*****                               P  14  197BRTE                  S01194
0198 I*****                               P  20  220VDRC                  S01194
0199 I*****                                  23  23 RCIN                  S01194
0200 I*****                                  24  53 BRTN                  S01194
0201 I*****                               P  54  597NBRT                  S01194
0202 I*****                               P  60  620VDNR                  S01194
0203 I*****                               P  90  920LCD                   S01194
0204 I*****                                  93  93 CHTP                  S01194
0205 I*****                               P  94  960TNLU                  S01194
0206 I*****                                                               S01194
0207 I*****CATCHALL.                                                      S01194
0208 I*****   NS  08                                                      S01194
0209 I*****                                   2   30RECT                  S01194
0210 I*****                                                               S01194
0211 I*****CLIENT FILE - CUSTOMER STANDING DATA RECORD.                   S01194
0212 I*****                                                               S01194
0213 I*****CLINT   NS  09   1 CD   8 CA                                   S01194
0214 I*****                                   1   1 RECI                  S01194
0215 I*****                                   2   70CNUM                  S01194
0216 I*****                                   8   8 RCDT                  S01194
0217 I*****                                   9  28 CRNM                  S01194
0218 I*****                                  29  38 CTWN                  S01194
0219 I*****                                  39  48 CSNM                  S01194
0220 I*****                                  49  56 CASK                  S01194
0221 I*****                                  57  68 TELX                  S01194
0222 I*****                                  69  80 CSID                  S01194
0223 I*****                                  81  82 ACOC                  S01194
0224 I*****                                  83  83 CBSI                  S01194
0225 I*****                                  84  85 CCTZ                  S01194
0226 I*****                                  86  87 CLOC                  S01194
0227 I*****                                  88  930CPAR                  S01194
0228 I*****                                  94  960BRCD                  S01194
0229 I*****                                  97  980LINS                  S01194
0230 I*****                                  99 1010LIND                  S01194
0231 I*****                               P 102 1040DASU                  S01194
0232 I*****                               P 105 1070CDIC                  S01194
0233 I*****                               P 108 1100DADE                  S01194
0234 I*****                                 111 111 CMIN                  S01194
0235 I*****                                 112 112 CTYP                  S01194
0236 I*****                                 113 124 TELF                  S01194
0237 I*****                                 125 133 CHID                  S01194
0238 I*****                                 134 136 CHAB                  S01194
0239 I*****                               P 250 2520LCD                   S01194
0240 I*****                                 253 253 CHTP                  S01194
0241 I*****                               P 254 2560TNLU                  S01194
0242 I*****                                                               S01194
0243 I*****CATCHALL                                                       S01194
0244 I*****   NS                                                          S01194
0245 I*****                                                               S01194
0246 I*****DEALS FILE - HEADER RECORD.                                    S01093
0247 I*****                                                               S01093
0248 I*LUPDDA*NS**14***1 CH                                               S01093
0249 I******                                  1   1 RECI                  S01093
0250 I******                                  2   70DLNO                  S01093
0251 I******                                  8   8 RCDT                  S01093
0252 I******                                  9  100RCDC                  S01093
0253 I******                                 11  160CNUM                  S01093
0254 I******                              P 394 3960LCD                   S01093
0255 I******                                397 397 CHTP                  S01093
0256 I******                              P 398 4000TNLU                  S01093
0257 I*
0258 I*
0259 I*
0260 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0261 I*
0262 I*LUPDDC*NS**10***1 CD   8 CC                                        S01093
0262 IDEALSBRCNS  10   1 CD   8 CC                                        S01093
0263 I                                        1   1 RECI
0264 I                                        2   70DLNO
0265 I                                        8   8 RCDT
0266 I                                        9  100RCDC
0267 I**********                             11  160CNUM                                      CSD027
0267 I                                       11  16 CNUM                                      CSD027
0268 I***************************************17  190BRCD                  S01117
0268 I                                       17  19 BRCA                  S01117
0269 I                                       20  21 DTYP
0270 I                                       22  23 DLST
0271 I                                    P  24  260DDAT
0272 I                                    P  27  290VDAT
0273 I                                    P  30  320MDAT            19
0274 I                                       33  340CDAS
0275 I                                       35  38 BRKC
0276 I                                    P  39  450BAGE
0277 I                                       46  48 CCYDC
0278 I                                    P  49  550PCPL
0279 I                                       56  56 INTC
0280 I**********                             63  640BRTT          2525                        CSD103
0280 I                                       63  64 BRTT                                      CSD103
0281 I                                    P  65  707BRTE
0282 I                                    P  71  767RTSP
0283 I                                    P  77  827INTR
0284 I                                       83  850NOTD
0285 I                                       86 105 RNNA
0286 I**********                            106 1110CHNA                                      CSD027
0286 I                                      106 111 CHNA                                      CSD027
0287 I                                      112 1140FACT
0288 I                                      115 1160FCNO
0289 I                                    P 117 1230OPAM
0290 I                                    P 124 1308BCXR
0291 I                                    P 131 1378LCXR
0292 I                                      138 1390SDST
0293 I**********                            140 151 OSDA                                      CGL029
0293 I                                      140 151 OSDAQQ                                    CGL029
0294 I                                      152 161 TSTN
0295 I                                      162 1630MDST
0296 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0297 I                                      176 185 TMAN
0298 I                                      186 1910RODN
0299 I                                    P 192 1980RODA
0300 I                                      199 2040RBDN
0301 I                                    P 205 2110RBDA
0302 I                                      212 2120ICBS
0303 I                                      213 213 IPFR
0304 I                                    P 214 2200TOTI
0305 I                                    P 221 2230NIDT
0306 I                                    P 224 2260IBDT
0307 I                                    P 227 2290SLID
0308 I                                    P 230 2360AIPD
0309 I                                    P 237 2390DLRC
0310 I                                    P 240 2420IACD
0311 I                                    P 243 2490AITC
0312 I                                    P 250 2560AIAN
0313 I                                    P 257 2630AIAP
0314 I                                    P 264 2700IPRD
0315 I                                    P 271 2770IPRM
0316 I                                    P 278 2840ICTD
0317 I                                    P 294 2960DAVD
0318 I                                      297 2990DASN
0319 I                                      300 309 FACO
0320 I                                      310 344 SPI
0321 I                                      345 3460INTF
0322 I                                      370 370 DNSI
0323 I                                      371 371 DSTI
0324 I                                      372 372 CNFI
0325 I                                      373 373 ACEI
0326 I                                      374 374 TLXI
0327 I                                    P 391 3930ORED
0328 I                                    P 394 3960LCD
0329 I                                      397 397 CHTP
0330 I                                    P 398 4000TNLU
     I*********                            16721689 OMDA                               CGL029 CDL019
     I*********                            16901707 OSDA                               CGL029 CDL019
     I                                     17211738 OSDA                                      CDL019
     I                                     17391756 OMDA                                      CDL019
0330 I                                     18401840 FSFBRT                CDL019
     I**********                           18981901 CLAS                             CDL038 BUG10282
     I                                     20102013 CLAS                                    BUG10282
     I                                    P212321287CNSP                                      CRE073
     I                                     21292135 RDMT                                      CRE073
     I                                     21362139 RDFD                                      CRE073
0364 I*
0365 I*****DELETED RECORD                                                 S01093
     I*****                                                               S01093
0366 I*****   NS  13   1 C*                                               S01093
0359 I*****                                                               S01093
0360 I*****DETAIL RECORD - NOT TYPE 'C'.                                  S01093
0361 I*****                                                               S01093
0362 I*****   NS  12   1 CD                                               S01093
     I*
0367 I*    CATCHALL.
0368 I***     NS
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     I        NS  15   1 CD   8 CG                                        S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I***************************************17  190BRCD            S01119S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I**********                             64  650UBRTT                              S01119 CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I**********                            208 2090TBRTT                              S01119 CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I***********                           567 567 BYSL            SA1157E26465
     I                                      569 569 BYSL                  E26465
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                      688 688 URFIN                 CSW005
     I                                      689 689 TRFIN                 CSW005
     I*********                            22902307 UPACC                               CGL029CDL019
     I*********                            23082325 URACC                               CGL029CDL019
     I                                     24692486 UPACC                                     CDL019
     I                                     24872504 URACC                                     CDL019
     I                                    P255125530FSOSDT                                    CDL028
     I**********                          P255425550FSOS1B                             CDL028 CSD103
     I                                     25542555 FSOS1B                                    CSD103
     I                                    P255625580FSOS1D                                    CDL028
     I**********                          P255925600FSOS2B                             CDL028 CSD103
     I                                     25592560 FSOS2B                                    CSD103
     I                                    P256125630FSOS2D                                    CDL028
     I                                    P256425660FSOEDT                                    CDL028
     I**********                          P256725680FSOE1B                             CDL028 CSD103
     I                                     25672568 FSOE1B                                    CSD103
     I                                    P256925710FSOE1D                                    CDL028
     I**********                          P257225730FSOE2B                             CDL028 CSD103
     I                                     25722573 FSOE2B                                    CSD103
     I                                    P257425760FSOE2D                                    CDL028
     I                                    P257725790FSTSDT                                    CDL028
     I**********                          P258025810FSTS1B                             CDL028 CSD103
     I                                     25802581 FSTS1B                                    CSD103
     I                                    P258225840FSTS1D                                    CDL028
     I**********                          P258525860FSTS2B                             CDL028 CSD103
     I                                     25852586 FSTS2B                                    CSD103
     I                                    P258725890FSTS2D                                    CDL028
     I                                    P259025920FSTEDT                                    CDL028
     I**********                          P259325940FSTE1B                             CDL028 CSD103
     I                                     25932594 FSTE1B                                    CSD103
     I                                    P259525970FSTE1D                                    CDL028
     I**********                          P259825990FSTE2B                             CDL028 CSD103
     I                                     25982599 FSTE2B                                    CSD103
     I                                    P260026020FSTE2D                                    CDL028
     I                                     26032606 CLAS                                      CDL038
     I/COPY WNCPYSRC,DL0250I001
     IDEAMSDIF                                                                             MD031123A
     I              RECI                            RECIDM                                 MD031123A
     I              DLNO                            DLNODM                                 MD031123A
     I              VDAT                            VDATDM                                 MD031123A
     I              DASN                            DASNDM                                 MD031123A
     I              DTYP                            DTYPDM                                 MD031123A
     I              DLST                            DLSTDM                                 MD031123A
     I              AMTP                            AMTPDM                                 MD031123A
     I              BRTT                            BRTTDM                                 MD031123A
     I              RTSP                            RTSPDM                                 MD031123A
     I              CNUM                            CNUMDM                                 MD031123A
     I              BRCA                            BRCADM                                 MD031123A
     I              FSRP                            FSRPDM                                 MD031123A
     I              STCY                            STCYDM                                 MD031123A
     I              PSTM                            PSTMDM                                 MD031123A
     I              PONS                            PONSDM                                 MD031123A
     I              PIBN                            PIBNDM                                 MD031123A
     I              PIBA                            PIBADM                                 MD031123A
     I              POBN                            POBNDM                                 MD031123A
     I              POCN                            POCNDM                                 MD031123A
     I              RCRN                            RCRNDM                                 MD031123A
     I              RCRA                            RCRADM                                 MD031123A
     I              RVNO                            RVNODM                                 MD031123A
     I              AWBN                            AWBNDM                                 MD031123A
     I              AWBA                            AWBADM                                 MD031123A
     I              BENN                            BENNDM                                 MD031123A
     I              BENA                            BENADM                                 MD031123A
     I              DTP1                            DTP1DM                                 MD031123A
     I              DTP2                            DTP2DM                                 MD031123A
     I              DTP3                            DTP3DM                                 MD031123A
     I              DTP4                            DTP4DM                                 MD031123A
     I              DCHG                            DCHGDM                                 MD031123A
     I              BTB1                            BTB1DM                                 MD031123A
     I              BTB2                            BTB2DM                                 MD031123A
     I              BTB3                            BTB3DM                                 MD031123A
     I              BTB4                            BTB4DM                                 MD031123A
     I              BTB5                            BTB5DM                                 MD031123A
     I              BTB6                            BTB6DM                                 MD031123A
     I              BRTE                            BRTEDM                                 MD031123A
     I              ROBN                            ROBNDM                                 MD031123A
     I              ROCN                            ROCNDM                                 MD031123A
     I              CLAS                            CLASDM                                 MD031123A
     I              CNSP                            CNSPDM                                 MD031123A
     I              CNSG                            CNSGDM                                 MD031123A
     I              RDMT                            RDMTDM                                 MD031123A
     I              RDFD                            RDFDDM                                 MD031123A
     I              ORED                            OREDDM                                  MD031713
0315 I*                                                                   S01194
     ISPOOL       DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 243 2460SWRIT                 S01117
     I@BINRY      DS                                                      S01117
     I** DEFINE A BLANK BINARY FIELD FOR USE WITH SWRIT                   S01117
     I                                    B   1   40@BKBIN                S01117
     ISPOOLU      DS                                                      S01117
     I** FILE INFORMATION DATA STRUCTURE                                  S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      *                                                                                     MD031283
      ** Named constants                                                                    MD031283
      *                                                                                     MD031283
     I              'UseHistRateforBVDeal'C         SVBVAL                                  MD031283
      *                                                                                     MD031283
     ISDGELR    E DSSDGELRPD                                              S01194
     I** EXTERNAL DS FOR GENERAL LEDGER DETAILS                           S01194
     I*                                                                   S01194
     ISDTRAD    E DSSDTRADPD                                              S01194
     I** EXTERNAL DS FOR TRADING DETAILS                                  S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I** EXTERNAL DS FOR MIDAS MODULES DETAILS                            S01194
     I*                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01194
     I*                                                                   S01194
     ISDBSRT    E DSSDBSRTPD                                              S01194
     I** EXTERNAL DS FOR BASE RATE DETAILS                                S01194
     I*                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01194
     I*
     ISCSARD    E DSSCSARDPD                                              CSW005
      ** SAR descriptions                                                 CSW005
      *                                                                   CSW005
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0369 I/EJECT
0370 C*
     C********** *ENTRY    PLIST                                    S01117E250
     C**********           PARM           SEQ     5                 S01117E250
     C*                                                                   S01117
0371 C*    FIRST CYCLE CALCULATIONS.
0372 C   40                GOTO FCEND
0373 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
      *                                                                   CSW005
      ** Determine if switchable feature CSW005 is on                     CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD   7                       CSW005
     C                     PARM '*VERIFY' @OPTN   7                       CSW005
     C                     PARM 'CSW005'  @SARD   6                       CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFNE *BLANK                                    CSW005
     C           @RTCD     ANDNE'*NRF   '                                 CSW005
     C                     MOVEL'SCSARDPD'DBFILE 10        ************   CSW005
     C                     MOVEL'06'      DBASE   2        * DBERR 06 *   CSW005
     C                     MOVEL@OPTN     DBOPTN  7        ************   CSW005
     C                     GOTO ERROR                                     CSW005
     C                     END                                            CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANK                                    CSW005
     C                     MOVE 'Y'       CSW005  1                       CSW005
     C                     ELSE                                           CSW005
     C                     MOVE 'N'       CSW005                          CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW011
      ** Determine if switchable feature CSW011 is on                     CSW011
      *                                                                   CSW011
     C                     CALL 'AOSARDR0'                                CSW011
     C                     PARM *BLANKS   @RTCD   7                       CSW011
     C                     PARM '*VERIFY' @OPTN   7                       CSW011
     C                     PARM 'CSW011'  @SARD   6                       CSW011
     C           SCSARD    PARM SCSARD    DSFDY                           CSW011
      *                                                                   CSW011
     C           @RTCD     IFEQ *BLANK                                    CSW011
     C                     MOVE 'Y'       CSW011  1                       CSW011
     C                     ELSE                                           CSW011
     C                     MOVE 'N'       CSW011                          CSW011
     C                     ENDIF                                          CSW005
      *                                                                   CDL019
      ** Determine if switchable feature CDL019 is on                     CDL019
     C                     CALL 'AOSARDR0'                                CDL019
     C                     PARM *BLANKS   @RTCD   7                       CDL019
     C                     PARM '*VERIFY' @OPTN   7                       CDL019
     C                     PARM 'CDL019'  @SARD   6                       CDL019
     C           SCSARD    PARM SCSARD    DSFDY                           CDL019
      *                                                                   CDL019
     C           @RTCD     IFEQ *BLANK                                    CDL019
     C                     MOVE 'Y'       CDL019  1                       CDL019
     C                     ELSE                                           CDL019
     C                     MOVE 'N'       CDL019                          CDL019
     C                     ENDIF                                          CDL019
      *                                                                   CSW005
      *                                                                                       CAS009
      ** Access SAR Details File to determine if CAS009 is installed                          CAS009
      *                                                                                       CAS009
     C                     CALL 'AOSARDR0'                                                    CAS009
     C                     PARM *BLANKS   PRTCD   7                                           CAS009
     C                     PARM '*VERIFY' POPTN   7                                           CAS009
     C                     PARM 'CAS009'  PSARD   6                                           CAS009
     C           SCSARD    PARM SCSARD    DSFDY                                               CAS009
      *                                                                                       CAS009
      ** Handle Datebase Error.                                                               CAS009
      *                                                                                       CAS009
     C           PRTCD     IFNE *BLANK                                                        CAS009
     C           PRTCD     ANDNE'*NRF   '                                                     CAS009
     C                     MOVEL'SCSARDPD'DBFILE                                              CAS009
     C                     MOVEL'07'      DBASE                                               CAS009
     C                     MOVELPOPTN     DBOPTN                                              CAS009
     C                     GOTO ERROR                                                         CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** CAS009 is installed                                                                  CAS009
      *                                                                                       CAS009
     C           PRTCD     IFEQ *BLANK                                                        CAS009
     C                     MOVE 'Y'       CAS009  1                                           CAS009
     C                     ELSE                                                               CAS009
     C                     MOVE 'N'       CAS009                                              CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
      ** Access SAR Details File to determine if CRE073 is installed                          CRE073
      *                                                                                       CRE073
     C                     CALL 'AOSARDR0'                                                    CRE073
     C                     PARM *BLANKS   PRTCD   7                                           CRE073
     C                     PARM '*VERIFY' POPTN   7                                           CRE073
     C                     PARM 'CRE073'  PSARD   6                                           CRE073
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE073
      *                                                                                       CRE073
      ** Handle Datebase Error.                                                               CRE073
      *                                                                                       CRE073
     C           PRTCD     IFNE *BLANK                                                        CRE073
     C           PRTCD     ANDNE'*NRF   '                                                     CRE073
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE073
     C                     MOVEL'12'      DBASE                                               CRE073
     C                     MOVELPOPTN     DBOPTN                                              CRE073
     C                     GOTO ERROR                                                         CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
      ** CRE073 is installed                                                                  CRE073
      *                                                                                       CRE073
     C           PRTCD     IFEQ *BLANK                                                        CRE073
     C                     MOVE *ON       *IN11                                               CRE073
     C                     ELSE                                                               CRE073
     C                     MOVE *OFF      *IN11                                               CRE073
     C                     ENDIF                                                              CRE073
      *                                                                                       CRE073
     C/COPY WNCPYSRC,DL0250C005
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
     C                     MOVE 'N'       CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE *ON       *IN73                                               CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     OPEN DEALSC                                                        CDL033
     C                     ELSE                                                               CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '07'      DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY  29                                           CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *IN72                                               CDL033
     C                     GOTO ERROR                                                         CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Access SAR Details File to determine if CIR018 is installed                          CIR018
      *                                                                                       CIR018
     C                     CALL 'AOSARDR0'                                                    CIR018
     C                     PARM *BLANKS   PRTCD   7                                           CIR018
     C                     PARM '*VERIFY' POPTN   7                                           CIR018
     C                     PARM 'CIR018'  PSARD   6                                           CIR018
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR018
      *                                                                                       CIR018
      ** CIR018 is installed                                                                  CIR018
     C           PRTCD     IFEQ *BLANK                                                        CIR018
     C                     MOVE 'Y'       CIR018  1                                           CIR018
     C                     ELSE                                                               CIR018
     C                     MOVE 'N'       CIR018                                              CIR018
     C                     ENDIF                                                              CIR018
      *                                                                                       CIR018
      ** Access SAR Details File to determine if CDL020 is installed                        MD031283
      *                                                                                     MD031283
     C                     MOVE 'N'       CDL020  1                                         MD031283
     C                     MOVE 'N'       HSTRAT  1                                         MD031283
      *                                                                                     MD031283
     C                     CALL 'AOSARDR0'                                                  MD031283
     C                     PARM *BLANKS   PRTCD                                             MD031283
     C                     PARM '*VERIFY' POPTN                                             MD031283
     C                     PARM 'CDL020'  PSARD                                             MD031283
     C           SCSARD    PARM SCSARD    DSFDY                                             MD031283
      *                                                                                     MD031283
      ** CDL020 is installed                                                                MD031283
      *                                                                                     MD031283
     C           PRTCD     IFEQ *BLANK                                                      MD031283
     C                     MOVE 'Y'       CDL020                                            MD031283
      *                                                                                     MD031283
      ** Set flag for historic base rate system value                                       MD031283
      *                                                                                     MD031283
     C                     CALL 'AOSVALR0'                                                  MD031283
     C                     PARM           PRTCD   7                                         MD031283
     C                     PARM SVBVAL    POP01  20                                         MD031283
     C                     PARM           PVL01 200                                         MD031283
     C                     PARM *BLANK    POP02  20                                         MD031283
     C                     PARM           PVL02 200                                         MD031283
     C                     PARM *BLANK    POP03  20                                         MD031283
     C                     PARM           PVL03 200                                         MD031283
     C                     PARM *BLANK    POP04  20                                         MD031283
     C                     PARM           PVL04 200                                         MD031283
     C                     PARM *BLANK    POP05  20                                         MD031283
     C                     PARM           PVL05 200                                         MD031283
     C                     PARM *BLANK    POP06  20                                         MD031283
     C                     PARM           PVL06 200                                         MD031283
     C                     PARM *BLANK    POP07  20                                         MD031283
     C                     PARM           PVL07 200                                         MD031283
     C                     PARM *BLANK    POP08  20                                         MD031283
     C                     PARM           PVL08 200                                         MD031283
     C                     PARM *BLANK    POP09  20                                         MD031283
     C                     PARM           PVL09 200                                         MD031283
     C                     PARM *BLANK    POP10  20                                         MD031283
     C                     PARM           PVL10 200                                         MD031283
      *                                                                                     MD031283
     C           PRTCD     IFEQ *BLANKS                                                     MD031283
     C                     MOVELPVL01     HSTRAT                                            MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C           HSKEY1    KLIST                                                            MD031283
     C                     KFLD           BACYCD                                            MD031283
     C                     KFLD           BRTT                                              MD031283
     C                     KFLD           VDAT                                              MD031283
      *                                                                                     MD031283
     C           HSKEY2    KLIST                                                            MD031283
     C                     KFLD           BACYCD                                            MD031283
     C                     KFLD           BRTT                                              MD031283
      *                                                                                     MD031283
0374 C*    ACCESS INSTALLATION CONTROL DATA RECORD 1.
0375 C***                  EXSR ZSYSTM                                    S01125
0544 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01125
0545 C***********DATF******COMP 'M'                      98MMDDYY   S01125S01194
0545 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0376 C*
0377 C*    SET UP OUTPUT AND RECORD COUNT FIELDS.
0378 C                     Z-ADD2         DLTOT   50
0379 C                     Z-ADD0         CNORE   50
0380 C                     Z-ADD0         ZERO5   50
0381 C                     Z-ADD0         ZERO13 130
     C                     Z-ADD0         ZERO2   20                                       AR762808B
     C                     Z-ADD0         ZERO3   30                                       AR762808B
     C                     Z-ADD0         ZERO15 150                                       AR762808B
     C                     MOVE *BLANKS   ZZ001   1                                        AR762808B
     C                     MOVE *BLANKS   ZZ003   3                                        AR762808B
     C                     MOVE *BLANKS   ZZ010  10                                        AR762808B
     C                     MOVE *BLANKS   ZZ012  12                                        AR762808B
     C                     MOVE *BLANKS   ZZ018  18                                        AR762808B
     C                     MOVE *BLANKS   ZZ022  22                                        AR762808B
     C                     MOVE *BLANKS   ZZ035  35                                        AR762808B
     C                     MOVE *BLANKS   ZZ039  39                                        AR762808B
     C                     MOVE *BLANKS   ZZ094  94                                        AR762808B
     C                     MOVE *BLANKS   ZZ174 174                                        AR762808B
     C**   OUTPUT DAMBR HEADER                                            S01093
     C                     EXCPTHEADER                                    S01093
0382 C*
0383 C*****ACCESS DEALING MODULE INSTALLATION CONTROL DATA RECORD.        S01194
0384 C******************** MOVEL'01      'TABKEY 12                       S01194
0385 C******************** MOVE '  40'    TABKEY                          S01194
0386 C******************** EXSR TABCHN                                    S01194
0387 C***06*************** GOTO ERROR                                     S01194
     C** ACCESS TRADING DETAILS AND MIDAS MODULES DETAILS VIA ACCESS      S01194
     C** PROGRAMS                                                         S01194
     C*                                                                   S01194
     C                     CALL 'AOTRADR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDTRAD    PARM SDTRAD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDTRADPD'DBFILE 10        ************   S01194
     C                     MOVEL'01'      DBASE   2        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBOPTN  7        ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE           ************   S01194
     C                     MOVEL'02'      DBASE            * DBERR 02 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
0388 C*
0389 C*    END IF BASE RATES FACILITY NOT USED
0390 C***********BRCF      COMP 'N'                      31               S01194
0390 C           BLBRCF    COMP 'N'                      31               S01194
0391 C   31                SETON                     LR
      *                                                                                       229360
     C           DTYP      IFEQ 'IP'                                                          229360
     C           DTYP      OREQ 'IT'                                                          229360
     C           DTYP      OREQ 'TD'                                                          229360
     C           DTYP      OREQ 'TI'                                                          229360
     C           DTYP      OREQ 'CI'                                                          229360
     C                     SETON                     64                                       229360
     C                     ELSE                                                               229360
     C                     SETOF                     64                                       229360
     C                     ENDIF                                                              229360
      **********                                                                   229360 AR1045065A
     C***64*****                                                                   229360 AR1045065A
     C***OR*31**           GOTO END                                                229360 AR1045065A
0392 C***31*****           GOTO END                                                           229360
     C   31                GOTO END                                                       AR1045065A
0393 C*
0394 C*****SET*UP*KEY*FIELDS*FOR*TABLE*AND*CLINT.*****                    S01194
0395 C*********************MOVE '1'       CKEY1   4                       S01194
0396 C*********************MOVE 'A'       CLKEY   7                       S01194
0397 C************************************************                    S01194
0398 C*****ACCESS*INSTALLATION*CONTROL*DATA*RECORD*2.*                    S01194
0399 C*********************MOVE '  11'    TABKEY                          S01194
0400 C*********************EXSR TABCHN                                    S01194
     C*                                                                   S01194
     C**********           CALL 'AOGELRR0'                                S01194              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                           S01194              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
0401 C*
0402 C*    CALCULATE EVENT CONTROL DATE.
0403 C***********DNWD      SUB  1         EVCD    50                      S01194
0404 C***********APDA      COMP EVCD                   20                 S01194
0405 C***20******          Z-ADDAPDA      EVCD                            S01194
0403 C           BJDNWD    SUB  1         EVCD    50                      S01194
0404 C           BKAPDT    COMP EVCD                   20                 S01194
0405 C   20                Z-ADDBKAPDT    EVCD                            S01194
     C/COPY WNCPYSRC,DL0250C016
0406 C*
0407 C*****READ*BASE*RATES*TABLE.*****************                        S01194
0408 C*********************MOVEL'21      'TABKEY                          S01194
0409 C*********************MOVE '    '    TABKEY                          S01194
0410 C***********TABKEY    SETLLTABLE2                                    S01194
     C** READ BASE RATE DETAILS - DO NOT USE ACCESS PROGRAM SINCE         S01194
     C** READING ENTIRE FILE                                              S01194
     C*                                                                   S01194
     C*********  1         SETLLSDBSRTL1                                  E111
     C           *LOVAL    SETLLSDBSRTL1                                  S01194
0411 C*
0412 C           READ      TAG                             ** READ TAG ***
0413 C*
0414 C*********************SETOF                     0708                 S01194
0415 C*********************READ TABLE2                   21               S01194
0416 C***08******RECT******COMP 21                       33               S01194
0417 C***08*33*************GOTO READ                                      S01194
0418 C***08****************                                               S01194
0419 C**OR*21**************GOTO ARCHK                                     S01194
     C                     READ SDBSRTL1                 21               S01194
     C   21                GOTO ARCHK                                     S01194
     C*                                                                   S01194
0420 C***********VDNR******COMP EVCD                   2222               S01194
0420 C           BAVDNR    COMP EVCD                   2222               S01194
0421 C*
0422 C*    LOAD CURRENCY ARRAY.
0423 C***22******CCY*******LOKUPCCYA                     23               S01194
0423 C   22      BACYCD    LOKUPCCYA                     23               S01194
0424 C   22N23   X         ADD  1         X       30
0425 C***22N23*************MOVE CCY       CCYA,X                          S01194
0425 C   22N23             MOVE BACYCD    CCYA,X                          S01194
0426 C                     GOTO READ
0427 C*
     C/COPY WNCPYSRC,DL0250C012
0428 C*    CHECK CURRENCY ARRAY IS NOT EMPTY.
0429 C           ARCHK     TAG                             ** ARCHK TAG **
0430 C*
     C***********IRFRA*****IFNE 'Y'                                 S01119S01194
     C           BGFIIN    IFNE 'Y'                                       S01194
     C           CDL033    ANDNE'Y'                                                           CDL033
     C/COPY WNCPYSRC,DL0250C013
0431 C           CCYA,1    COMP '   '                    24
0432 C   24                SETON                     LR32
0433 C   LR                GOTO END
     C                     END                                            S01119
0434 C*
     C/COPY WNCPYSRC,DL0250C003
0435 C*
0436 C*    END OF FIRST CYCLE PROCESSING.
0437 C*
0438 C           FCEND     TAG                             ** FCEND TAG **
0439 C*
0440 C   35                SETOF                     35
0441 C*
0442 C*****ACCUMULATE RECORD COUNT AND HASH TOTALS.******                 S01093
0443 C***13                GOTO END                                       S01093
0444 C***        CNORE     ADD  1         CNORE                           S01093
0445 C**N10N12             GOTO END                                       S01093
0446 C***        CNLRA     ADD  1         CNLRA   50                      S01093
0447 C***                  MOVE PCPL      ZZAMT                           S01093
0448 C***                  EXSR GLZADD                                    S01093
0449 C***12                GOTO END                                       S01093
0449 C*****BYPASS*PROCESSING*IF*NOT*LIVE*DEAL*********************  S01093S01119
0449 C* N10                GOTO END                                 S01093S01119
0449 C**   BYPASS PROCESSING IF NOT LIVE MM OR FRA/IRS DEAL               S01119
0449 C  N10N15             GOTO END                                       S01119
0450 C*
0451 C*
0452 C*    RESET OUTPUT INDICATORS.
0453 C                     SETOF                     2728
     C/COPY WNCPYSRC,DL0250C004
      *                                                                                     AR755195
      ** If CDL019 and CDL033 are OFF, then fixed term deals should not be                  AR755195
      ** processed.                                                                         AR755195
      *                                                                                     AR755195
     C           CDL019    IFEQ 'N'                                                         AR755195
     C           CDL033    ANDEQ'N'                                                         AR755195
     C           DTYP      IFEQ 'IP'                                                        AR755195
     C           DTYP      OREQ 'IT'                                                        AR755195
     C           DTYP      OREQ 'TD'                                                        AR755195
     C           DTYP      OREQ 'TI'                                                        AR755195
     C           DTYP      OREQ 'CI'                                                        AR755195
     C                     GOTO END                                                         AR755195
     C                     ENDIF                                                            AR755195
     C                     ENDIF                                                            AR755195
      *                                                                                     AR755195
     C*                                                                   S01119
     C* IF FRA/IRS DEAL ENCOUNTERED, PROCESS ACCORDINGLY AND SKIP THIS    S01119
     C*                                                                   S01119
     C                     MOVE '0'       *IN36                           S01119
     C*                                                                   S01119
     C           *IN15     IFEQ '1'                                       S01119
     C                     MOVE '0'       *IN61                           S01119
     C                     MOVE '   '     SPDI                            S01119
     C                     EXSR FRAIRS                                    S01119
     C                     GOTO END                                       S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0250C014
      *                                                                                       CDL033
      ** Process CF deals separately.                                                         CDL033
      *                                                                                       CDL033
     C           DTYP      LOKUPFXTERM                   69                                   CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C********** DTYP      ANDEQ'CF'                                               CDL033 AR1045065A
     C********** CDL033    OREQ 'Y'                                                CDL033 AR1045065A
     C           *IN69     ANDEQ*ON                                                           CDL033
     C                     MOVE *OFF      *IN61                                               CDL033
     C                     MOVE *OFF      *IN71                                               CDL033
     C                     EXSR SRFRCD                                                        CDL033
     C**********           GOTO END                                                CDL033 AR1045065A
     C   69                GOTO END                                                       AR1045065A
     C           XKRCDT    IFNE 0                                                           AR755195
     C                     GOTO END                                                         AR755195
     C                     ENDIF                                                            AR755195
     C                     ENDIF                                                              CDL033
0454 C*
      ****If*CDL019*is*on*and*rate*has*been*fixed*do*not*extract*******              CDL019 MD026719
      ****a*base*rate*change*record.***********************************              CDL019 MD026719
     C********** CDL019    IFEQ 'Y'                                                  CDL019 MD026719
     C********** FSFBRT    ANDEQ'Y'                                                  CDL019 MD026719
     C**********           GOTO END                                                  CDL019 MD026719
     C**********           ENDIF                                                     CDL019 MD026719
      **********                                                                     CDL019 MD026719
0455 C*    CHECK BASE RATE TYPE AND CURRENCY FOR DEALS FILE RECORDS.
0456 C*    25 SET ON INPUT.
0457 C   25                GOTO END
0458 C           CCYDC     LOKUPCCYA                     26
0459 C  N26                GOTO END
      *                                                                                    MD031123A
      ** Access Deals Amendment File for BC Type                                           MD031123A
      *                                                                                    MD031123A
     C           KDEAMS    KLIST                                                           MD031123A
     C                     KFLD           DLNO                                             MD031123A
     C                     KFLD           BJRDNB                                           MD031123A
     C           KDEAMS    SETLLDEAMSDIF                                                   MD031123A
     C           DLNO      READEDEAMS                    42                                MD031123A
      *                                                                                    MD031123A
     C           *IN42     DOWEQ'0'                                                        MD031123A
      *                                                                                    MD031123A
     C           RECIDM    IFEQ 'D'                                                        MD031123A
     C           AMTPDM    ANDEQ'BC'                                                       MD031123A
     C           VDATDM    ANDEQBJRDNB                                                     MD031123A
     C********** BRTTDM    ANDNE0                                                   MD031123A CSD103
     C**********           Z-ADDBRTTDM    BRTT                                      MD031123A CSD103
     C           BRTTDM    ANDNE*BLANKS                                                       CSD103
     C                     MOVE BRTTDM    BRTT                                                CSD103
     C                     ENDIF                                                           MD031123A
      *                                                                                    MD031123A
     C           DLNO      READEDEAMS                    42                                MD031123A
     C                     ENDDO                                                           MD031123A
0460 C*
0461 C*****ACCESS*BASE*RATES*TABLE.****************                       S01194
0462 C*********************MOVEL'21     ' TABKEY                          S01194
0463 C*********************MOVELCCYDC     BRWRK   5                       S01194
0464 C*********************MOVE BRTT      BRWRK                           S01194
0465 C*********************MOVE BRWRK     TABKEY                          S01194
0466 C*********************EXSR TABCHN                                    S01194
0467 C***76****************************************                       S01194
0468 C**OR*06**************GOTO ERROR                                     S01194
     C** ACCESS BASE RATES DETAILS VIA ACCESS PROGRAM                     S01194
     C*                                                                   S01194
     C                     MOVELBRTT      @DWNB            NUMERIC TO ALPHS01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C                     PARM           @DWNB   2                       S01194
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBSRTPD'DBFILE           ************   S01194
     C                     MOVEL'03'      DBASE            * DBERR 03 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@AJCD     DBKEY1  3                       S01194
     C                     MOVEL@DWNB     DBKEY2  2                       S01194
     C                     GOTO ERROR                                     S01194
     C                     END                                            S01194
      *                                                                                     MD026719
      **  If CDL019 is on and rate has been fixed do not extract                            MD026719
      **  a base rate change record.                                                        MD026719
      *                                                                                     MD026719
     C           CDL019    IFEQ 'Y'                                                         MD026719
     C           FSFBRT    ANDEQ'Y'                                                         MD026719
     C           ORED      ANDNEBJRDNB                                                      MD031856
     C           VDAT      ANDLTBJRDNB                                                      MD031856
     C********** BAVDNR    ANDNEVDAT                                               MD026719 MD031856
     C                     GOTO END                                                         MD026719
     C                     ENDIF                                                            MD026719
      *                                                                                     MD026719
0469 C*
0470 C*    CHECK DEALS TO BE GENERATED INDICATOR AND NEW VALUE DATE.
0471 C*********************TESTB'14'      RCIN         2727               S01194
     C           BADLLC    IFEQ 'Y'                                       S01194
     C           BADLRC    OREQ 'Y'                                       S01194
     C                     MOVE '1'       *IN27                           S01194
     C                     END                                            S01194
0472 C  N27                GOTO END
     C/COPY WNCPYSRC,DL0250C002
0476 C*
     C  N19      MDAT      COMP IACD                 28
     C  N19N28             GOTO END
0473 C***********VDNR******COMP EVCD                   2828               S01194
0474 C**N19*28***VDNR******COMP MDAT                   28                 S01194
     C           BAVDNR    COMP EVCD                   2828               S01194
     C  N19 28   BAVDNR    COMP MDAT                   28                 S01194
      *                                                                                     MD031283
      ** Do not skip new MM deals with back-valued maturity                                 MD031283
      ** and maturity same as rundate                                                       MD031598
      ** if system value = 'Y'                                                              MD031283
      *                                                                                     MD031283
     C           ORED      IFEQ BJRDNB                                                      MD031283
     C********** MDAT      ANDLTBJRDNB                                             MD031283 MD031598
     C           MDAT      ANDLEBJRDNB                                                      MD031598
     C           HSTRAT    ANDEQ'Y'                                                         MD031283
     C   10N19N28          SETON                     28                                     MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
0475 C  N28                GOTO END
     C/COPY WNCPYSRC,DL0250C015
      *                                                                                       CAS009
      ** If a BR record is produced in DAMBRDI,                                               CAS009
      ** update the EIR recalculation indicator to 'Y'.                                       CAS009
      *                                                                                       CAS009
     C           CAS009    IFEQ 'Y'                                                           CAS009
     C           *IN10     ANDEQ'1'                                                           CAS009
     C           *IN27     ANDEQ'1'                                                           CAS009
     C           *IN28     ANDEQ'1'                                                           CAS009
      *                                                                                       CAS009
     C           DLNO      CHAINMMEIRDL9             41                                       CAS009
      *                                                                                       CAS009
     C           *IN41     IFEQ '0'                                                           CAS009
     C           EIRCAL    ANDNE'Y'                                                           CAS009
     C                     MOVE 'Y'       EIRCAL                                              CAS009
     C                     UPDATMMEIRDD0                                                      CAS009
     C                     ENDIF                                                              CAS009
      *                                                                                       CAS009
     C                     ENDIF                                                              CAS009
0476 C*
0477 C  N34                SETON                     35
0478 C  N34                SETON                     34
0479 C*
0480 C*    ACCUMULATE NUMBER OF RECORDS ON DEALS FILE.
0481 C           DLTOT     ADD  1         DLTOT
0482 C*
0483 C*    CHECK NUMBER OF DECIMAL PLACES FOR CURRENCY OF PRINCIPAL
0484 C*    AMOUNT.
0485 C*********************MOVEL'20      'TABKEY                          S01194
0486 C*********************MOVELCCYDC     CKEY1                           S01194
0487 C*********************MOVE CKEY1     TABKEY                          S01194
0488 C*********************EXSR TABCHN                                    S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
0489 C***********CDP*******COMP 1                      5051               S01194
0490 C***********CDP*******COMP 2                    53  52               S01194
     C           A6NBDP    COMP 1                      5051               S01194
     C           A6NBDP    COMP 2                    53  52               S01194
0491 C*
0492 C*****OBTAIN*CUSTOMER*DETAILS*FROM*CLINT.*********                   S01194
0493 C*********************MOVELCNUM      CLKEY   7                       S01194
0494 C***********CLKEY*****CHAINCLINT                29                   S01194
     C** OBTAIN CUSTOMER DETAILS VIA ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C                     MOVELCNUM      @KEY1            NUMERIC TO ALPHS01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KYST   7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0250CCP1                                           S01408
     C*                                                                   S01408
0495 C*
0496 C*    CALCULATE AND FORMAT VALUE DATE APPLIED.
0497 C***********VDNR******COMP IACD                 3036                 S01194
     C           BAVDNR    COMP IACD                 3036                 S01194
     C** INVESTIGATE WARNING REQUIRED WHEN VAL DATE OF RATE CHANGE PRIOR
     C** TO ACCRUAL CONTROL DATE OF DEAL-EXCEPT WHEN DEAL IS FWD VALUED
     C   36      VDAT      COMP IACD                   36
     C***IF*DEAL*IS*FWD*VALUED*THEN*IACD*>*VDNR*IE*VAL*DATE*OF*RATE*CHANGES01194
     C** IF DEAL IS FWD VALUED THEN IACD > BAD0NB IE VAL DATE OF RATE CHANS01194
     C** APPLIED TO DEAL WILL BE IACD.DL0280 HAS BEEN CHANGED TO
     C** RECOGNISE SUCH CASES AND TO APPLY RATE CHANGE EVEN THOUGH IT IS
     C** AFTER EVCD AND DEAL HAS NOT STARTED
0499 C                     Z-ADDIACD      ZDAYNO
0500 C***30****************Z-ADDVDNR      ZDAYNO                          S01194
     C   30                Z-ADDBAVDNR    ZDAYNO                          S01194
     C/COPY WNCPYSRC,DL0250C001
0501 C                     EXSR ZDATE2
0502 C                     MOVE ZADATE    VDATA   7
     C/COPY WNCPYSRC,DL0250C006
      *                                                                                     MD031283
      ** Use historic base rate                                                             MD031283
      ** for back-valued MM deals if system value = 'Y'                                     MD031283
      *                                                                                     MD031283
     C           ORED      IFEQ BJRDNB                                                      MD031283
     C           VDAT      ANDLTBJRDNB                                                      MD031283
     C           VDAT      ANDLTBAVDNR                                                      MD031283
     C           HSTRAT    ANDEQ'Y'                                                         MD031283
     C           *IN10     ANDEQ'1'                                                         MD031283
     C           *IN27     ANDEQ'1'                                                         MD031283
     C           *IN28     ANDEQ'1'                                                         MD031283
      *                                                                                     MD031283
     C                     EXSR SRBVAL                                                      MD031283
      *                                                                                     MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
0503 C                     GOTO END
0504 C*
0505 C*    SET ERROR INDICATORS.
0506 C           ERROR     TAG                             ** ERROR TAG **
0507 C                     SETON                     LRU7U8
     C                     EXSR *PSSR                                     S01194
0508 C           END       TAG                             ** END TAG **
     C/COPY WNCPYSRC,DL0250C008
     C*                                                                   S01117
     CLR         DLTOT     SUB  2         ONLRA   50
     C*                                                                   S01117
     C** ENSURE SPOOL FILE RECORDED BY RCF ONCE - ONLY IF P1 IS WRITTEN   S01117
     C** TO AND THAT AU FILE REPORTS 'NO DETAILS' IF NOTHING WRITTEN TO   S01117
     C** P1. SWRIT IS INCREMENTED FOR EVERY SUCCESSFUL WRITE TO THE       S01117
     C** FILE - IF IT IS BLANK (OR 0) THEN NOTHING HAS BEEN WRITTEN TO    S01117
     C** THE FILE. UNABLE TO COMPARE SWRIT TO *BLANKS SO USE @BKBIN -     S01117
     C** AN UNITIALISED BINARY FIELD.                                     S01117
     CLR                   MOVE '0'       *IN14                           S01117
     CLR         SWRIT     IFNE 0                                         S01117
     CLR         SWRIT     ANDNE@BKBIN                                    S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C***LR****************PARM *BLANKS   SEQ     5                S01117 LN0815
     CLR                   PARM           SEQ     5                       LN0815
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR                   MOVE '1'       *IN14                           S01117
     CLR                   END                                            S01117
0509 C*                                                                   S01117
     C** ENSURE TOTALS SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     C***LR****************PARM *BLANKS   SEQ     5                S01117 LN0815
     CLR                   PARM           SEQ     5                       LN0815
     CLR                   PARM *BLANK    @PARM   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C/COPY WNCPYSRC,DL0250C007
     C*                                                                   S01117
0519 C********************************************************************S01119
     C/EJECT                                                              S01119
0519 C********************************************************************S01119
     C* S/R FRAIRS                                                        S01119
     C* CALLED FROM MAIN PROCESSING IF DEAL IS FROM PF/DEALSDG            S01119
     C*                                                                   S01119
     C* CALLS: RLAVER, FIDMBR                                             S01119
     C*                                                                   S01119
     C* PURPOSE: TO PROCESS FRA/IRS DEAL TYPES AND TEST IF ANY LF/DAMBR   S01119
     C* RECORDS ARE NECESSARY                                             S01119
     C*                                                                   S01119
0519 C********************************************************************S01119
     C*                                                                   S01119
     C           FRAIRS    BEGSR                            *** FRAIRS ***S01119
     C*                                                                   SA1157
     C** IF DEAL TYPE IS AN FRA OR RR,RP,RF THEN SET ON BUY/SELL          SA1157
     C** CONDITIONING IND.                                                SA1157
     C*                                                                   SA1157
     C                     MOVE 'N'       INTVAL                                             BUG7533
     C                     MOVE *OFF      *IN59                                              BUG7533
     C                     MOVE '0'       *IN16                           SA1157
     C           DTYP      IFEQ 'FR'                                      SA1157
     C           DTYP      OREQ 'RR'                                      SA1157
     C           DTYP      OREQ 'RP'                                      SA1157
     C           DTYP      OREQ 'RF'                                      SA1157
     C                     MOVE '1'       *IN16                           SA1157
     C                     END                                            SA1157
     C*                                                                   S01119
     C**IF*DEAL*TYPE*IS*'RL',*THEN*IT*MAY*BE*AVERAGE*RATE*METHOD*  S01119 SA1157
     C* IF DEAL TYPE IS RR,RP OR RF THEN IT MAY BE AVERAGE RATE METHOD    SA1157
     C* AND SHOULD BE PROCESSED AS NON-FRA/IRS DEALS                      S01119
     C* ALL DEALS BUT THIS ARE PROCESSED BY THE SAME METHOD               S01119
     C*                                                                   S01119
     C**         DTYP      IFEQ 'RL'                               S01119 SA1157
     C           DTYP      IFEQ 'RR'                                      SA1157
     C           DTYP      OREQ 'RP'                                      SA1157
     C           DTYP      OREQ 'RF'                                      SA1157
     C*                                                                   S01119
     C* CHECK OUR DETAILS FOR BASE RATE TYPE                              S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C* CHECK OUR DETAILS FOR AVERAGE RATE                                S01119
     C*                                                                   S01119
     C                     TESTB'3'       UDSTI          60               S01119
     C  N60                GOTO RLNAVE                                    S01119
     C*                                                                   S01119
     C* CHECK OUR DETAILS FOR CURRENCY MATCHING ARRAY VALUE               S01119
     C*                                                                   S01119
     C           UCUCY     LOKUPCCYA                     60               S01119
     C  N60                GOTO FIEND                                     S01119
     C*                                                                   S01119
     C* PROCESS AS FOR NON-FRA/IRS DEALS USING S/R RLAVER                 S01119
     C*                                                                   S01119
     C                     Z-ADDUINFD     INFD    50                      S01119
     C                     Z-ADDUPAMT     PCPL                            S01119
     C**********           Z-ADDUBRTT     BRTT                                         S01119 CSD103
     C                     MOVE UBRTT     BRTT                                                CSD103
     C                     Z-ADDURTSP     RTSP                            S01119
     C                     MOVE UCUCY     CCYDC                           S01119
     C                     MOVE USPIN     SPIN    1                       S01119
     C                     Z-ADD2         SEQN                            S01119
     C                     EXSR RLAVER                                    S01119
     C                     GOTO FIEND                                     S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* CHECK THR DETAILS FOR BASE RATE TYPE                              S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C* CHECK THR DETAILS FOR AVERAGE RATE METHOD                         S01119
     C*                                                                   S01119
     C                     TESTB'3'       TDSTI          60               S01119
     C  N60                GOTO RLNAVE                                    S01119
     C*                                                                   S01119
     C* CHECK THR DETAILS FOR CURRENCY MATCHING ARRAY                     S01119
     C*                                                                   S01119
     C           TCUCY     LOKUPCCYA                     60               S01119
     C  N60                GOTO FIEND                                     S01119
     C*                                                                   S01119
     C* PERFORM S/R RLAVER ON THEIR DETAILS                               S01119
     C*                                                                   S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C                     Z-ADDTPAMT     PCPL                            S01119
     C**********           Z-ADDTBRTT     BRTT                                         S01119 CSD103
     C                     MOVE TBRTT     BRTT                                                CSD103
     C                     MOVE TCUCY     CCYDC                           S01119
     C                     Z-ADDTRTSP     RTSP                            S01119
     C                     MOVE TSPIN     SPIN    1                       S01119
     C                     Z-ADD1         SEQN                            S01119
     C                     EXSR RLAVER                                    S01119
     C                     GOTO FIEND                                     S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**END*OF*SPECIAL*PROCESSING*FOR*DEAL*TYPE*RL*                S01119 SA1157
     C* END OF SPECIAL PROCESSING FOR DEAL TYPE RR/RP/RF                  SA1157
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           RLNAVE    TAG                              ** RLNAVE *** S01119
     C*          -------------                                            S01119
     C/COPY WNCPYSRC,DL0250C009
     C*                                                                   S01119
     C* CHECK OUR DETAILS FOR BASE RATE TYPE                              S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C* PROCESS OUR DETAILS USING FRA/IRS SUBROUTINE                      S01119
     C*                                                                   S01119
     C                     Z-ADDUIACD     IACD                            S01119
     C                     Z-ADDUINFD     INFD    50                      S01119
     C**********           Z-ADDUBRTT     BRTT                                         S01119 CSD103
     C                     MOVE UBRTT     BRTT                                                CSD103
     C                     Z-ADDUPAMT     PCPL                            S01119
     C                     Z-ADDURTSP     RTSP                            S01119
     C                     MOVE UCUCY     CCYDC                           S01119
     C                     MOVE USPIN     SPIN    1                       S01119
     C                     Z-ADD2         SEQN                            S01119
     C                     MOVE UICFR     WICFR   1                                           204923
      *                                                                   CSW005
      ** If CSW005 is on (equal to 'Y')                                   CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C                     MOVE URFIN     WRFIN   1                       CSW005
     C                     ENDIF                                          CSW005
      *                                                                                       CDL028
      ** Reset Interpolate Rate Flag & Output Indicator                                       CDL028
      *                                                                                       CDL028
     C                     MOVE 'N'       INTVAL  1                                           CDL028
     C                     MOVE *OFF      *IN59                                               CDL028
      *                                                                                       CDL028
      ** Our Start Stub Date processing                                                       CDL028
      *                                                                                       CDL028
     C           UNICD     IFEQ FSOSDT                                                        CDL028
     C           INFD      ANDLEVDAT                                                          CDL028
      *                                                                                       CDL028
     C           FSOSDT    IFNE *ZERO                                                         CDL028
     C********** FSOS1B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSOS1B    ANDNE*BLANKS                                                       CSD103
     C           FSOS1D    ANDNE*ZERO                                                         CDL028
     C********** FSOS2B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSOS2B    ANDNE*BLANKS                                                       CSD103
     C           FSOS2D    ANDNE*ZERO                                                         CDL028
     C                     MOVE 'Y'       INTVAL                                              CDL028
      *                                                                                       CDL028
     C                     Z-ADDFSOSDT    WSDT    50                                          CDL028
     C**********           Z-ADDFSOS1B    WS1B    20                                   CDL028 CSD103
     C                     MOVE FSOS1B    WS1B    2                                           CSD103
     C                     Z-ADDFSOS1D    WS1D    50                                          CDL028
     C**********           Z-ADDFSOS2B    WS2B    20                                   CDL028 CSD103
     C                     MOVE FSOS2B    WS2B    2                                           CSD103
     C                     Z-ADDFSOS2D    WS2D    50                                          CDL028
     C                     Z-ADDFSOSDT    WMD1    50                                         BUG7563
     C                     Z-ADDFSOS1D    WMD2    50                                         BUG7563
     C                     ENDIF                                                              CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Our End Stub Date processing                                                         CDL028
      *                                                                                       CDL028
     C           UNICD     IFEQ FSOEDT                                                        CDL028
     C           BJRDNB    ANDGTVDAT                                                         BUG7722
      *                                                                                       CDL028
     C           FSOEDT    IFNE *ZERO                                                         CDL028
     C********** FSOE1B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSOE1B    ANDNE*BLANKS                                                       CSD103
     C           FSOE1D    ANDNE*ZERO                                                         CDL028
     C********** FSOE2B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSOE2B    ANDNE*BLANKS                                                       CSD103
     C           FSOE2D    ANDNE*ZERO                                                         CDL028
     C                     MOVE 'Y'       INTVAL                                              CDL028
      *                                                                                       CDL028
     C                     Z-ADDFSOEDT    WSDT                                                CDL028
     C**********           Z-ADDFSOE1B    WS1B                                         CDL028 CSD103
     C                     MOVE FSOE1B    WS1B                                                CSD103
     C                     Z-ADDFSOE1D    WS1D                                                CDL028
     C**********           Z-ADDFSOE2B    WS2B                                         CDL028 CSD103
     C                     MOVE FSOE2B    WS2B                                                CSD103
     C                     Z-ADDFSOE2D    WS2D                                                CDL028
     C                     Z-ADDMDAT      WMD1                                               BUG7563
     C**********           Z-ADDFSOEDT    WMD2                                       BUG7563BUG7563R
     C                     Z-ADDFSOE1D    WMD2                                              BUG7563R
     C                     ENDIF                                                              CDL028
     C                     ENDIF                                                              CDL028
     C*                                                                   S01119
     C* DO NOT TERMINATE UNLESS U7 AS BOTH SETS OF DETAILS MAY CONTAIN BRTS01119
     C*                                                                   S01119
     C                     EXSR FIDMBR                                    S01119
     C                     END                                            S01119
     C   U7                GOTO FIEND                                     S01119
      *                                                                                      BUG7533
      ** Reset Interpolate Rate Flag & Output Indicator                                      BUG7533
      *                                                                                      BUG7533
     C                     MOVE 'N'       INTVAL                                             BUG7533
     C                     MOVE *OFF      *IN59                                              BUG7533
     C*                                                                   S01119
     C* CHECK THR DETAILS FOR BASE RATE TYPE                              S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C* PROCESS THR DETAILS USING FRA/IRS SUBROUTINE                      S01119
     C*                                                                   S01119
     C                     Z-ADDTIACD     IACD                            S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C**********           Z-ADDTBRTT     BRTT                                         S01119 CSD103
     C                     MOVE TBRTT     BRTT                                                CSD103
     C                     Z-ADDTPAMT     PCPL                            S01119
     C                     Z-ADDTRTSP     RTSP                            S01119
     C                     MOVE TCUCY     CCYDC                           S01119
     C                     MOVE TSPIN     SPIN    1                       S01119
     C                     Z-ADD1         SEQN    30                      S01119
     C                     MOVE TICFR     WICFR                                               204923
      *                                                                   CSW005
      ** If CSW005 is on (equal to 'Y')                                   CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           CSW011    OREQ 'Y'                                       CSW011
     C                     MOVE TRFIN     WRFIN   1                       CSW005
     C                     ENDIF                                          CSW005
      *                                                                                       CDL028
      ** Their Start Stub Date processing                                                     CDL028
      *                                                                                       CDL028
     C           TNICD     IFEQ FSTSDT                                                        CDL028
     C           INFD      ANDLEVDAT                                                          CDL028
      *                                                                                       CDL028
     C           FSTSDT    IFNE *ZERO                                                         CDL028
     C********** FSTS1B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSTS1B    ANDNE*BLANKS                                                       CSD103
     C           FSTS1D    ANDNE*ZERO                                                         CDL028
     C********** FSTS2B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSTS2B    ANDNE*BLANKS                                                       CSD103
     C           FSTS2D    ANDNE*ZERO                                                         CDL028
     C                     MOVE 'Y'       INTVAL                                              CDL028
      *                                                                                       CDL028
     C                     Z-ADDFSTSDT    WSDT                                                CDL028
     C**********           Z-ADDFSTS1B    WS1B                                         CDL028 CSD103
     C                     MOVE FSTS1B    WS1B                                                CSD103
     C                     Z-ADDFSTS1D    WS1D                                                CDL028
     C**********           Z-ADDFSTS2B    WS2B                                         CDL028 CSD103
     C                     MOVE FSTS2B    WS2B                                                CSD103
     C                     Z-ADDFSTS2D    WS2D                                                CDL028
     C                     Z-ADDFSTSDT    WMD1                                               BUG7563
     C                     Z-ADDFSTS1D    WMD2                                               BUG7563
     C                     ENDIF                                                              CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Their End Stub Date processing                                                       CDL028
      *                                                                                       CDL028
     C           TNICD     IFEQ FSTEDT                                                        CDL028
     C           BJRDNB    ANDGTVDAT                                                         BUG7722
      *                                                                                       CDL028
     C           FSTEDT    IFNE *ZERO                                                         CDL028
     C********** FSTE1B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSTE1B    ANDNE*BLANKS                                                       CSD103
     C           FSTE1D    ANDNE*ZERO                                                         CDL028
     C********** FSTE2B    ANDNE*ZERO                                                  CDL028 CSD103
     C           FSTE2B    ANDNE*BLANKS                                                       CSD103
     C           FSTE2D    ANDNE*ZERO                                                         CDL028
     C                     MOVE 'Y'       INTVAL                                              CDL028
      *                                                                                       CDL028
     C                     Z-ADDFSTEDT    WSDT                                                CDL028
     C**********           Z-ADDFSTE1B    WS1B                                         CDL028 CSD103
     C                     MOVE FSTE1B    WS1B                                                CSD103
     C                     Z-ADDFSTE1D    WS1D                                                CDL028
     C**********           Z-ADDFSTE2B    WS2B                                         CDL028 CSD103
     C                     MOVE FSTE2B    WS2B                                                CSD103
     C                     Z-ADDFSTE2D    WS2D                                                CDL028
     C                     Z-ADDMDAT      WMD1                                               BUG7563
     C**********           Z-ADDFSTEDT    WMD2                                       BUG7563BUG7563R
     C                     Z-ADDFSTE1D    WMD2                                              BUG7563R
     C                     ENDIF                                                              CDL028
     C                     ENDIF                                                              CDL028
     C*                                                                   097779
     C** Initialize value of *IN61                                        097779
     C*                                                                   097779
     C                     MOVE '0'       *IN61                           097779
     C                     EXSR FIDMBR                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           FIEND     ENDSR                           *** FIEND ***  S01119
0519 C********************************************************************S01119
     C/EJECT                                                              S01119
0519 C********************************************************************S01119
     C* S/R RLAVER                                                        S01119
     C**CALLED*FROM*S/R*FRAIRS*IF*RL*DEAL*USES*AVERAGE*RATES*       S01119SA1157
     C* CALLED FROM S/R FRAIRS IF RR/RP/RF DEAL USES AVERAGE RATES  S01119SA1157
     C*                                                                   S01119
     C* CALLS:                                                            S01119
     C*                                                                   S01119
     C* PURPOSE: TO PRODUCE LF/DAMBR RECORDS SIMILAR TO NON-FRA/IRS ONES  S01119
     C* AND REPORT SUCH                                                   S01119
     C*                                                                   S01119
0519 C********************************************************************S01119
     C*                                                                   S01119
     C           RLAVER    BEGSR                           *** RLAVER *** S01119
     C*                                                                   S01119
     C* CHECK THAT DATES NECESSITATE PROCESSING                           S01119
     C*                                                                   S01119
     C           EVCD      IFLT VDAT                                      S01119
     C                     GOTO RLAEND                                    S01119
     C                     END                                            S01119
0460 C*                                                                   S01119
0461 C*****ACCESS*BASE*RATES*TABLE.******************               S01119S01194
0460 C***********************************************               S01119S01194
0462 C*********************MOVEL'21     ' TABKEY                    S01119S01194
0463 C*********************MOVELCCYDC     BRWRK   5                 S01119S01194
0464 C*********************MOVE BRTT      BRWRK                     S01119S01194
0465 C*********************MOVE BRWRK     TABKEY                    S01119S01194
0466 C*********************EXSR TABCHN                              S01119S01194
0467 C************IN76*****IFEQ '1'                                 S01119S01194
0468 C************IN06*****OREQ '1'                                 S01119S01194
     C** ACCESS BASE RATES DETAILS VIA ACCESS PROGRAM                     S01194
     C*                                                                   S01194
     C                     MOVELBRTT      @DWNB            NUMERIC TO ALPHS01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C                     PARM           @DWNB   2                       S01194
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBSRTPD'DBFILE           ************   S01194
     C                     MOVEL'04'      DBASE            * DBERR 04 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@AJCD     DBKEY1                          S01194
     C                     MOVEL@DWNB     DBKEY2                          S01194
     C                     SETON                     U7U8LR               S01119
     C                     EXSR *PSSR                                     S01194
     C                     GOTO RLAEND                                    S01119
     C                     END                                            S01119
0469 C*                                                                   S01119
0470 C* CHECK DEALS TO BE GENERATED INDICATOR AND INITIAL RATE SET IND    S01119
0469 C*                                                                   S01119
0471 C*********************TESTB'14'      RCIN         6060               S01119
     C           BADLLC    IFEQ 'Y'                                       S01194
     C           BADLRC    OREQ 'Y'                                       S01194
     C                     MOVE '1'       *IN60                           S01194
     C                     END                                            S01194
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          54               S01119
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI          54               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C   54N60             GOTO RLAEND                                    S01119
     C*                                                                   S01119
     C* IF VALUE DATE OF CHANGE IS GREATER  THAN MATURITY DATE-SKIP       S01119
     C*                                                                   S01119
     C***********VDNR******IFGT MDAT                                S01119S01194
     C           BAVDNR    IFGT MDAT                                      S01194
0472 C                     GOTO RLAEND                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN54     IFEQ '0'                                       S01119
     C* SET OUTPUT FIELDS FOR FILE AND REPORT - IF INITAIL RATE NOT SET   S01119
     C* INVESTIGATE IF BV DEAL WITH BACK VALUED AMEND                     S01119
     C                     Z-ADDVDAT      ODATE                           S01119
     C***********ORED******COMP RUND                     55         S01119S01194
     C******55***VDAT******COMP RUND                   55           S01119S01194
     C******55*60VDNR******COMP RUND                   36           S01119S01194
     C******55*************Z-ADDRUND      ODATE                     S01119S01194
     C           ORED      COMP BJRDNB                   55               S01194
     C      55   VDAT      COMP BJRDNB                 55                 S01194
     C      55 60BAVDNR    COMP BJRDNB                 36                 S01194
     C      55             Z-ADDBJRDNB    ODATE                           S01194
     C                     ELSE                                           S01119
     C* SET OUTPUT FIELDS FOR FILE AND REPORT - DATE LATER OF FIX DATE,   S01119
     C* VALUE DATE OF BASE RATE CHANGE- INITIAL RATE SET                  S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'1'       UDNSI          56               S01119
     C                     ELSE                                           S01119
     C                     TESTB'1'       TDNSI          56               S01119
     C                     END                                            S01119
     C           *IN56     IFEQ '0'                                       S01119
     C***********VDNR******IFGT INFD                                S01119S01194
     C*********************Z-ADDVDNR      ODATE   50                S01119S01194
     C           BAVDNR    IFGT INFD                                      S01194
     C                     Z-ADDBAVDNR    ODATE   50                      S01194
     C                     ELSE                                           S01119
     C                     Z-ADDINFD      ODATE                           S01119
     C                     END                                            S01119
     C***********VDNR******COMP INFD                   36           S01119S01194
     C           BAVDNR    COMP INFD                   36                 S01194
     C                     ELSE                                           S01119
     C***********VDNR******COMP RUND                   36           S01119S01194
     C*********************Z-ADDRUND      ODATE                     S01119S01194
     C           BAVDNR    COMP BJRDNB                 36                 S01194
     C                     Z-ADDBJRDNB    ODATE                           S01194
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* FORMAT REPORT DETAILS                                             S01119
0482 C*                                                                   S01119
0483 C*    CHECK NUMBER OF DECIMAL PLACES FOR CURRENCY OF PRINCIPAL       S01119
0484 C*    AMOUNT.                                                        S01119
0482 C*                                                                   S01119
0485 C*********************MOVEL'20      'TABKEY                    S01119S01194
0486 C*********************MOVELCCYDC     CKEY1                     S01119S01194
0487 C*********************MOVE CKEY1     TABKEY                    S01119S01194
0488 C*********************EXSR TABCHN                              S01119S01194
0489 C***********CDP*******COMP 1                      5051         S01119S01194
0490 C***********CDP*******COMP 2                    53  52         S01119S01194
     C                     CALL 'AOCURRR0'                          S01194S01194
     C                     PARM '*MSG   ' @RTCD   7                 S01194S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           A6NBDP    COMP 1                      5051               S01194
     C           A6NBDP    COMP 2                    53  52               S01194
0491 C*                                                                   S01119
0492 C*****OBTAIN*CUSTOMER*DETAILS*FROM*CLINT.**************        S01119S01194
0491 C******************************************************        S01119S01194
0493 C*********************MOVELCNUM      CLKEY   7                 S01119S01194
0494 C***********CLKEY*****CHAINCLINT                29             S01119S01194
     C** OBTAIN CUSTOMER DETAILS VIA ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C                     MOVELCNUM      @KEY1            NUMERIC TO ALPHS01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KEYST  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0250CCP2                                           S01408
     C*                                                                   S01408
0491 C*                                                                   S01119
0491 C*    CONVERT DATE                                                   S01119
0491 C*                                                                   S01119
0499 C                     Z-ADDODATE     ZDAYNO                          S01119
0501 C                     EXSR ZDATE2                                    S01119
0502 C                     MOVE ZADATE    VDATA   7                       S01119
     C**                                                                  S01119
     C*  DO NOT PRINT ZERO SPREAD RATE                                    S01119
     C**                                                                  S01119
     C           SPIN      IFEQ ' '                                       S01119
     C********** BRTT      ANDGT0                                                      S01119 CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           RTSP      ANDEQ0                                         S01119
     C                     MOVE '1'       *IN61                           S01119
     C                     END                                            S01119
     C**                                                                  S01119
     C*     FORMAT SPREAD INDICATOR                                       S01119
     C**                                                                  S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C                     MOVE 'SUB'     SPDI    3                       S01119
     C                     END                                            S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C                     MOVE 'PCT'     SPDI                            S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0250C010
     C*                                                                   S01119
     C* OUTPUT TO FILE AND REPORT, INCLUDING MESSAGE IF NECESSARY         S01119
     C*                                                                   S01119
     C**N34******          SETON                     34OF          S01119 046671
     C  N34                SETON                     34                   046671
     C                     EXCPTBRFRA                                     S01119
     C                     ADD  1         DLTOT                           S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C           RLAEND    ENDSR                           *** RLAEND *** S01119
0519 C********************************************************************S01119
     C/EJECT                                                              S01119
0519 C********************************************************************S01119
     C* S/R FIDMBR                                                        S01119
     C**CALLED*FROM*S/R*FRAIRS*FOR*ALL*DEALS*EXCEPT*RL*WITH*AVERA  S01119 SA1157
     C* CALLED FROM S/R FRAIRS FOR ALL DEALS EXCEPT RR, RP OR RF WITH     SA1157
     C* AVERAGE RATE                                                      SA1157
     C*                                                                   S01119
     C* CALLS:                                                            S01119
     C*                                                                   S01119
     C* PURPOSE: TO PRODUCE LF/DAMBR RECORDS OF TYPE 'FI'                 S01119
     C* AND REPORT SUCH                                                   S01119
     C*                                                                   S01119
0519 C********************************************************************S01119
     C*                                                                   S01119
     C           FIDMBR    BEGSR                           *** FIDMBR *** S01119
     C*                                                                   S01119
     C* CHECK FR FIX DATE AGAINST EVENT                                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI          54               S01119
     C*                                                                   SA1157
     C* IF OUR RATE FIX DAYS IS ZERO & VAL DATE EQUALS RUN DATE           SA1157
     C*  SETOF *IN54                                                      SA1157
     C*                                                                   SA1157
     C           *IN54     IFEQ '1'                                       SA1157
     C           UFRFD     ANDEQ0                                         SA1157
     C           VDAT      ANDEQBJRDNB                                    SA1157
     C                     MOVE '0'       *IN54                           SA1157
     C                     MOVE '1'       *IN70                           SA1157
     C                     END                                            SA1157
     C*                                                                   SA1157
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI          54               S01119
     C*                                                                   SA1157
     C* IF THEIR RATE FIX DAYS IS ZERO & VAL DATE EQUALS RUN DATE         SA1157
     C*  SETOF *IN54                                                      SA1157
     C*                                                                   SA1157
     C           *IN54     IFEQ '1'                                       SA1157
     C           TFRFD     ANDEQ0                                         SA1157
     C           VDAT      ANDEQBJRDNB                                    SA1157
     C                     MOVE '0'       *IN54                           SA1157
     C                     MOVE '1'       *IN70                           SA1157
     C                     END                                            SA1157
     C*                                                                   SA1157
     C                     END                                            S01119
     C           *IN54     IFEQ '1'                                       S01119
     C           INFD      ORGT EVCD                                      S01119
     C                     GOTO DMREND                                    S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* CHECK THAT EVENT DATE IS BETWEEN FIX DATE AND NEXT INTEREST DATE  S01119
     C*                                                                   S01119
     C           DTYP      IFNE 'FR'                                      S01119
     C*                                                                   S01119
     C                     MOVE *BLANK    WPASS                                               204923
     C           DTYP      IFEQ 'RS'                                                          204923
     C           VDAT      ANDEQBJRDNB                                                        204923
     C           WICFR     ANDEQ'O'                                                           204923
      *                                                                                       204923
      ** Access currency details                                                              204923
      *                                                                                       204923
     C                     CALL 'AOCURRR0'                                                    204923
     C                     PARM *BLANKS   PRTCD   7                                           204923
     C                     PARM '*KEY  '  POPTN   7                                           204923
     C                     PARM UCUCY     PCURR   3                                           204923
     C           SDCURR    PARM SDCURR    DSSDY                                               204923
      *                                                                                       204923
     C           A6FXDY    IFNE 0                                                             204923
     C                     MOVEL'Y'       WPASS   1                                           204923
     C                     ENDIF                                                              204923
     C                     ENDIF                                                              204923
      *                                                                                       204923
     C           INFD      IFNE 0                                         S01119
     C           CSW005    ANDEQ'N'                                       CSW005
     C           CSW011    ANDEQ'N'                                       CSW011
      *                                                                   CSW005
     C           INFD      ORNE 0                                         CSW005
     C           DTYP      ANDNE'RS'                                      CSW005
     C           DTYP      ANDNE'RX'                                      CSW005
     C           CSW005    ANDEQ'Y'                                       CSW005
      *                                                                   CSW011
     C           INFD      ORNE 0                                         CSW011
     C           DTYP      ANDNE'RS'                                      CSW011
     C           DTYP      ANDNE'RX'                                      CSW011
     C           CSW011    ANDEQ'Y'                                       CSW011
      *                                                                   CSW005
     C           INFD      ORNE 0                                         CSW005
     C           DTYP      ANDEQ'RS'                                      CSW005
     C           WRFIN     ANDEQ*BLANK                                    CSW005
     C           CSW005    ANDEQ'Y'                                       CSW005
      *                                                                   CSW011
     C           INFD      ORNE 0                                         CSW011
     C           DTYP      ANDEQ'RS'                                      CSW011
     C           WRFIN     ANDEQ*BLANK                                    CSW011
     C           CSW011    ANDEQ'Y'                                       CSW011
      *                                                                   CSW005
     C           INFD      ORNE 0                                         CSW005
     C           DTYP      ANDEQ'RX'                                      CSW005
     C           WRFIN     ANDEQ*BLANK                                    CSW005
     C           CSW005    ANDEQ'Y'                                       CSW005
      *                                                                   CSW011
     C           INFD      ORNE 0                                         CSW011
     C           DTYP      ANDEQ'RX'                                      CSW011
     C           WRFIN     ANDEQ*BLANK                                    CSW011
     C           CSW011    ANDEQ'Y'                                       CSW011
      *                                                                   CSW005
     C           INFD      ORNE 0                                                             227642
     C           DTYP      ANDEQ'RS'                                                          227642
     C           WRFIN     ANDEQ'A'                                                           227642
     C           CSW005    ANDEQ'Y'                                                           227642
      *                                                                                       227642
     C           INFD      ORNE 0                                                             227642
     C           DTYP      ANDEQ'RS'                                                          227642
     C           WRFIN     ANDEQ'A'                                                           227642
     C           CSW011    ANDEQ'Y'                                                           227642
      *                                                                                       227642
     C           INFD      ORNE 0                                                             227642
     C           DTYP      ANDEQ'RX'                                                          227642
     C           WRFIN     ANDEQ'A'                                                           227642
     C           CSW005    ANDEQ'Y'                                                           227642
      *                                                                                       227642
     C           INFD      ORNE 0                                                             227642
     C           DTYP      ANDEQ'RX'                                                          227642
     C           WRFIN     ANDEQ'A'                                                           227642
     C           CSW011    ANDEQ'Y'                                                           227642
      *                                                                                       227642
     C           INFD      IFGT EVCD                                      S01119
     C           WPASS     OREQ 'Y'                                                           204923
     C                     GOTO DMREND                                    S01119
     C                     END                                            S01119
     C                     ELSE                                           S01119
     C                     GOTO DMREND                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
0460 C*                                                             S01119S01194
      ** Calculate the Interpolated Rate                                                      CDL028
      *                                                                                       CDL028
     C           INTVAL    IFEQ 'Y'                                                           CDL028
     C                     EXSR INTRTE                                                        CDL028
     C                     ELSE                                                               CDL028
      *                                                                                       CDL028
0461 C*****ACCESS*BASE*RATES*TABLE.****************                 S01119S01194
0460 C*********************************************                 S01119S01194
0462 C*********************MOVEL'21     ' TABKEY                    S01119S01194
0463 C*********************MOVELCCYDC     BRWRK   5                 S01119S01194
0464 C*********************MOVE BRTT      BRWRK                     S01119S01194
0465 C*********************MOVE BRWRK     TABKEY                    S01119S01194
0466 C*********************EXSR TABCHN                              S01119S01194
0467 C************IN76*****IFEQ '1'                                 S01119S01194
0468 C************IN06*****OREQ '1'                                 S01119S01194
     C** ACCESS BASE RATES DETAILS VIA ACCESS PROGRAM                     S01194
     C*                                                                   S01194
     C                     MOVELBRTT      @DWNB            NUMERIC TO ALPHS01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C                     PARM           @DWNB   2                       S01194
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C           @RTCD     IFNE *BLANKS                                   S01194
     C                     MOVEL'SDBSRTPD'DBFILE           ************   S01194
     C                     MOVEL'05'      DBASE            * DBERR 05 *   S01194
     C                     MOVEL@OPTN     DBOPTN           ************   S01194
     C                     MOVEL@AJCD     DBKEY1                          S01194
     C                     MOVEL@DWNB     DBKEY2                          S01194
     C                     SETON                     U7U8LR               S01119
     C                     EXSR *PSSR                                     S01194
     C                     GOTO DMREND                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* DETERMINE WHICH RATE TO USE- OLD OR NEW                           S01119
0482 C*                                                                   S01119
0467 C***********INFD******COMP VDNR                   57           S01119S01194
     C           INFD      COMP BAVDNR                 57                 S01194
      *                                                                                       CIR018
      * If Daily Rate Change frequency need to see if the base rate                           CIR018
      * is changing before the next working day and if so we need to                          CIR018
      * pick up the new rate                                                                  CIR018
     C           CIR018    IFEQ 'Y'                                                           CIR018
     C           WICFR     ANDEQ'D'                                                           CIR018
     C           BAVDNR    ANDGTBJRDNB                                                        CIR018
     C           BAVDNR    ANDLTBJDNWD                                                        CIR018
     C                     SETOF                     57                                       CIR018
     C                     Z-ADDBAVDNR    INFD                                                CIR018
     C                     ENDIF                                                              CIR018
      *                                                                                       CDL028
     C                     ENDIF                                                              CDL028
     C*                                                                   S01119
     C* FORMAT REPORT DETAILS                                             S01119
0482 C*                                                                   S01119
0483 C*    CHECK NUMBER OF DECIMAL PLACES FOR CURRENCY OF PRINCIPAL       S01119
0484 C*    AMOUNT.                                                        S01119
0482 C*                                                                   S01119
0485 C*********************MOVEL'20      'TABKEY                    S01119S01194
0486 C*********************MOVELCCYDC     CKEY1                     S01119S01194
0487 C*********************MOVE CKEY1     TABKEY                    S01119S01194
0488 C*********************EXSR TABCHN                              S01119S01194
0489 C***********CDP*******COMP 1                      5051         S01119S01194
0490 C***********CDP*******COMP 2                    53  52         S01119S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM CCYDC     @AJCD   3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C           A6NBDP    COMP 1                      5051               S01194
     C           A6NBDP    COMP 2                    53  52               S01194
0491 C*                                                                   S01119
0492 C*****OBTAIN*CUSTOMER*DETAILS*FROM*CLINT.*********             S01119S01194
0491 C*************************************************             S01119S01194
0493 C*********************MOVELCNUM      CLKEY   7                 S01119S01194
0494 C***********CLKEY     CHAINCLINT                29             S01119S01194
     C** OBTAIN CUSTOMER DETAILS VIA ACCESS PROGRAM                       S01194
     C*                                                                   S01194
     C                     MOVELCNUM      @KEY1            NUMERIC TO ALPHS01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C                     PARM           @KEY1  10                       S01194
     C                     PARM           @KEYST  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0250CCP3                                           S01408
     C*                                                                   S01408
0491 C*                                                                   S01119
0491 C*    CONVERT DATE                                                   S01119
0491 C*                                                                   S01119
0499 C                     Z-ADDINFD      ZDAYNO                          S01119
0501 C                     EXSR ZDATE2                                    S01119
0502 C                     MOVE ZADATE    VDATA   7                       S01119
     C**                                                                  S01119
     C*  DO NOT PRINT ZERO SPREAD RATE                                    S01119
     C**                                                                  S01119
     C           SPIN      IFEQ ' '                                       S01119
     C********** BRTT      ANDGT0                                                      S01119 CSD103
     C           BRTT      ANDNE*BLANKS                                                       CSD103
     C           RTSP      ANDEQ0                                         S01119
     C                     MOVE '1'       *IN61                           S01119
     C                     END                                            S01119
     C**                                                                  S01119
     C*     FORMAT SPREAD INDICATOR                                       S01119
     C**                                                                  S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C                     MOVE 'SUB'     SPDI    3                       S01119
     C                     END                                            S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C                     MOVE 'PCT'     SPDI                            S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0250C011
     C*                                                                   S01119
     C* OUTPUT TO LF/DAMBR AND REPORT                                     S01119
     C*                                                                   S01119
     C**N34******          SETON                     34OF          S01119 046671
     C  N34                SETON                     34                   046671
     C                     EXCPTFIFRA                                     S01119
     C                     ADD  1         DLTOT                           S01119
     C*                                                                   S01119
     C* REPORT EXCEPTION IF REQUIRED                                      S01119
     C*                                                                   S01119
     C***********INFD******IFGT RUND                                      S01194
     C           INFD      IFGT BJRDNB                                    S01194
     C                     EXCPTEARLY                                     S01119
     C                     MOVE '0'       *IN70                           SA1157
     C                     END                                            S01119
     C*                                                                   S01119
     C           DMREND    ENDSR                                          S01119
0519 C********************************************************************S01119
     C/COPY WNCPYSRC,DL0250C017
0519 C/EJECT                                                              S01119
      ********************************************************************                    CDL028
      *                                                                  *                    CDL028
      * SR/INTRTE - Calculate the Interpolated Rate                      *                    CDL028
      *                                                                  *                    CDL028
      ********************************************************************                    CDL028
      *                                                                                       CDL028
     C           INTRTE    BEGSR                                                              CDL028
      *                                                                                       CDL028
      ** Access 1st Base Rate                                                                 CDL028
      *                                                                                       CDL028
     C                     MOVELWS1B      @DWNB                                               CDL028
      *                                                                                       CDL028
     C                     CALL 'AOBSRTR0'                                                    CDL028
     C                     PARM '*MSG   ' @RTCD                                               CDL028
     C                     PARM '*KEY   ' @OPTN                                               CDL028
     C                     PARM CCYDC     @AJCD                                               CDL028
     C                     PARM           @DWNB                                               CDL028
     C           SDBSRT    PARM SDBSRT    DSSDY                                               CDL028
      *                                                                                       CDL028
     C           @RTCD     IFNE *BLANKS                                                       CDL028
     C                     MOVEL'SDBSRTPD'DBFILE           ************                       CDL028
     C                     MOVEL'07'      DBASE            * DBERR 07 *                       CDL028
     C                     MOVEL@OPTN     DBOPTN           ************                       CDL028
     C                     MOVEL@AJCD     DBKEY1                                              CDL028
     C                     MOVEL@DWNB     DBKEY2                                              CDL028
     C                     SETON                     U7U8LR                                   CDL028
     C                     EXSR *PSSR                                                         CDL028
     C                     GOTO INTEND                                                        CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Determine which Rate to use - Old or New                                             CDL028
      *                                                                                       CDL028
     C           INFD      COMP BAVDNR                 58                                     CDL028
     C           *IN58     IFEQ *ON                                                           CDL028
     C                     Z-ADDBACBSR    WS1R   117                                          CDL028
     C                     ELSE                                                               CDL028
     C                     Z-ADDBANBRT    WS1R                                                CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Access 2nd Base Rate                                                                 CDL028
      *                                                                                       CDL028
     C                     MOVELWS2B      @DWNB                                               CDL028
      *                                                                                       CDL028
     C                     CALL 'AOBSRTR0'                                                    CDL028
     C                     PARM '*MSG   ' @RTCD                                               CDL028
     C                     PARM '*KEY   ' @OPTN                                               CDL028
     C                     PARM CCYDC     @AJCD                                               CDL028
     C                     PARM           @DWNB                                               CDL028
     C           SDBSRT    PARM SDBSRT    DSSDY                                               CDL028
      *                                                                                       CDL028
     C           @RTCD     IFNE *BLANKS                                                       CDL028
     C                     MOVEL'SDBSRTPD'DBFILE           ************                       CDL028
     C                     MOVEL'08'      DBASE            * DBERR 08 *                       CDL028
     C                     MOVEL@OPTN     DBOPTN           ************                       CDL028
     C                     MOVEL@AJCD     DBKEY1                                              CDL028
     C                     MOVEL@DWNB     DBKEY2                                              CDL028
     C                     SETON                     U7U8LR                                   CDL028
     C                     EXSR *PSSR                                                         CDL028
     C                     GOTO INTEND                                                        CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Determine which Rate to use - Old or New                                             CDL028
      *                                                                                       CDL028
     C           INFD      COMP BAVDNR                 58                                     CDL028
     C           *IN58     IFEQ *ON                                                           CDL028
     C                     Z-ADDBACBSR    WS2R   117                                          CDL028
     C                     ELSE                                                               CDL028
     C                     Z-ADDBANBRT    WS2R                                                CDL028
     C                     ENDIF                                                              CDL028
      *                                                                                       CDL028
      ** Start Stub Date - Value Date                                                         CDL028
     C           WSDT      SUB  VDAT      STVL    50                                          CDL028
      *                                                                                       CDL028
      ** 1st Term End Date - Value Date                                                       CDL028
     C           WS1D      SUB  VDAT      D1VL    50                                          CDL028
      *                                                                                       CDL028
      ** 2nd Term End Date - Value Date                                                       CDL028
     C           WS2D      SUB  VDAT      D2VL    50                                          CDL028
      *                                                                                       CDL028
      ** Multiplier difference                                                                CDL028
     C***********STVL******SUB**D1VL******MDIF****50                                   CDL028BUG7563
     C           WMD1      SUB  WMD2      MDIF    50                                         BUG7563
      *                                                                                       CDL028
      ** Divider difference                                                                   CDL028
     C           D2VL      SUB  D1VL      DDIF    50                                          CDL028
      *                                                                                       CDL028
      ** 2nd Base Rate - 1st Base Rate                                                        CDL028
     C           WS2R      SUB  WS1R      BRDF   117                                          CDL028
      *                                                                                       CDL028
      ** Interpolated Rate                                                                    CDL028
     C***********BRDF******DIV**DDIF******WRTE1**117                                   CDL028BUG7564
     C***********WRTE1*****MULT*MDIF******WRTE2**117                                   CDL028BUG7564
     C***********WRTE2*****ADD**WS1R******IRTEW**115                                   CDL028BUG7564
      *                                                                                      BUG7564
     C           DDIF      IFNE 0                                                             236317
     C           BRDF      DIV  DDIF      WRTE1  309H                                        BUG7564
     C                     ELSE                                                               236317
     C                     Z-ADD0         WRTE1                                               236317
     C                     ENDIF                                                              236317
     C           WRTE1     MULT MDIF      WRTE2  309H                                        BUG7564
     C           WRTE2     ADD  WS1R      IRTEW  115H                                        BUG7564
      *                                                                                       CDL028
     C                     Z-ADDIRTEW     IRTE   117                                          CDL028
      *                                                                                       CDL028
      ** Output Rate                                                                          CDL028
     C                     MOVE *ON       *IN59                                               CDL028
      *                                                                                       CDL028
     C           INTEND    ENDSR                                                              CDL028
     C/EJECT                                                                                  CDL028
0519 C********************************************************************
0520 C*****************************************************               S01194
0521 C*****SR.*TO*RANDOM*ACCESS*TABLE*FILE.****************               S01194
0522 C*****************************************************               S01194
0523 C***********TABCHN****BEGSR                                          S01194
0524 C*********************                                               S01194
0525 C*********************SETOF                     010203               S01194
0526 C*********************SETOF                     040506               S01194
0527 C***********TABKEY****CHAINTABLE                76                   S01194
0528 C*********************                                               S01194
0529 C*********************ENDSR                                          S01194
0530 C*********************                                               S01194
0531 C********************************************************************
0532 C**
     C******  ZSYSTM REMOVED AS TABT10 IS NOW PRIMARY FILE  ******        S01125
     C**                                                                  S01125
0533 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01125
0534 C**                                                                  S01125
0535 C**         ZSYSTM    BEGSR                           *** ZSYSTM *** S01125
0536 C**                                                                  S01125
0537 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    S01125
0538 C**                   MOVEL'01      'ZTABKY 12                       S01125
0539 C**                   MOVE '  10'    ZTABKY                          S01125
0540 C**                                                                  S01125
0541 C**         ZTABKY    CHAINTABLE                99    ON NOT THERE   S01125
0542 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01125
0543 C**                                                                  S01125
0544 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01125
0545 C**         DATF      COMP 'M'                      98MMDDYY, 98 ON  S01125
0546 C**                                                                  S01125
0547 C**                   ENDSR                                          S01125
0548 C**                                                                  S01125
0549 C**                                                                  S01125
0550 C********************************************************************S01125
0551 C**
0552 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0553 C**
0554 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0555 C**
0556 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0557 C**
0558 C**   CLEAR DATE FIELDS.
0559 C                     Z-ADD0         ZDATE   60
0560 C                     MOVEL'       ' ZADATE  7
0561 C**
0562 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0563 C                     Z-ADDZDAYNO    ZDAYNO  50
0564 C**
0565 C**   DETERMINE YEAR NUMBER.
0566 C**
0567 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0568 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0569 C   99                GOTO ZDEND2
0570 C**
0571 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0572 C           ZDAYN1    DIV  1461      ZLYR    20
0573 C                     MVR            ZDAYN1           SAVE REMAINING
0574 C**                                                   DAYS
0575 C**   CALCULATE NUMBER OF REMAINING YEARS.
0576 C                     Z-ADD1         ZWRK2   20
0577 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0578 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0579 C  N90      ZWRK2     ADD  1         ZWRK2
0580 C  N90                GOTO ZDTAG1
0581 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0582 C**
0583 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0584 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0585 C**
0586 C**   CALCULATE ACTUAL YEAR NUMBER.
0587 C           ZLYR      MULT 4         ZWRK3   30
0588 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0589 C                     Z-ADDZWRK3     ZYEAR   20
0590 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0591 C**
0592 C**   DETERMINE MONTH NUMBER.
0593 C**
0594 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0595 C                     SETOF                     9293
0596 C   91      ZDAYN1    COMP 59                     9293
0597 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0598 C**
0599 C**   CALCULATE MONTH NUMBER.
0600 C                     Z-ADD2         ZWRK2
0601 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0602 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0603 C  N94      ZWRK2     ADD  1         ZWRK2
0604 C  N94                GOTO ZDTAG2
0605 C           ZWRK2     SUB  1         ZWRK2
0606 C**
0607 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0608 C**
0609 C**   DETERMINE DAY OF MONTH.
0610 C**
0611 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0612 C           ZDAYN1    ADD  1         ZDAYN1
0613 C**
0614 C**   CALCULATE DAY OF MONTH.
0615 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0616 C**
0617 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0618 C   93      ZDAY      ADD  1         ZDAY
0619 C**
0620 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0621 C  N98                MOVELZDAY      ZWRK4   40
0622 C   98                MOVE ZDAY      ZWRK4
0623 C  N98                MOVE ZMTH      ZWRK4
0624 C   98                MOVELZMTH      ZWRK4
0625 C                     MOVELZWRK4     ZDATE
0626 C                     MOVE ZYEAR     ZDATE
0627 C**
0628 C**   FORMAT ALPHA DATE, DDMMMYY.
0629 C           ZDAY      COMP 10                     95
0630 C                     MOVELZDAY      ZWRK5   5
0631 C   95                MOVEL' '       ZWRK5
0632 C                     MOVE ZMNM,ZMTH ZWRK5
0633 C                     MOVELZWRK5     ZADATE
0634 C                     MOVE ZYEAR     ZADATE
0635 C**
0636 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0637 C**
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRCD - Generate base rate change record for deals on       *                       CDL033
      *           rate fix date                                       *                       CDL033
      *                                                               *                       CDL033
      *  Called by : - Main processing                                *                       CDL033
      *                                                               *                       CDL033
      *  Calls     : - AOBSRTR0                                       *                       CDL033
      *              - AOCUSTR0                                       *                       CDL033
      *              - AOCURRR0                                       *                       CDL033
      *              - ZDATE2                                         *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRCD    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Retrieve extension details of deal.                                                  CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C           DLNO      CHAINDEALSC               60                                       CDL033
      *                                                                                       CDL033
     C           *IN60     IFEQ *ON                                                           CDL033
     C                     MOVE '08'      DBASE                                               CDL033
     C                     MOVELDLNO      DBKEY                                               CDL033
     C                     MOVEL'DEALSC  'DBFILE                                              CDL033
     C                     MOVE *ON       *IN72                                               CDL033
     C                     GOTO ERROR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** No further processing required if rate fix date has                                  CDL033
      ** not been reached, or is equal to zero or it has                                      CDL033
      ** already been processed.                                                              CDL033
      *                                                                                       CDL033
     C           XKRCFR    IFEQ ' '                                                       AR1045065A
     C                     MOVE *OFF      *IN69                                           AR1045065A
     C                     GOTO EFRCD                                                     AR1045065A
     C                     ENDIF                                                          AR1045065A
      *                                                                                   AR1045065A
     C           XKINFD    IFGT EVCD                                                          CDL033
     C           XKINFD    OREQ *ZERO                                                         CDL033
     C           XKINFF    OREQ 'Y'                                                           CDL033
     C                     GOTO EFRCD                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Retrieve base rate details.                                                          CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     MOVELBRTT      @DWNB                                               CDL033
     C                     CALL 'AOBSRTR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*KEY   ' @OPTN                                               CDL033
     C                     PARM CCYDC     @AJCD                                               CDL033
     C                     PARM           @DWNB                                               CDL033
     C           SDBSRT    PARM SDBSRT    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '09'      DBASE                                               CDL033
     C                     MOVEL@AJCD     DBKEY1                                              CDL033
     C                     MOVEL@DWNB     DBKEY2                                              CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SDBSRTPD'DBFILE                                              CDL033
     C                     GOTO ERROR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** If rate fix date falls before value date of new                                      CDL033
      ** rate, use old base rate.                                                             CDL033
      *                                                                                       CDL033
     C           XKINFD    IFLT BAVDNR                                                        CDL033
     C                     Z-ADDBACBSR    WBRTE  117                                          CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDBANBRT    WBRTE                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Retrieve customer details.                                                           CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     MOVELCNUM      @KEY1                                               CDL033
     C                     CALL 'AOCUSTR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*KEY   ' @OPTN                                               CDL033
     C                     PARM           @KEY1                                               CDL033
     C                     PARM           @KEYST                                              CDL033
     C           SDCUST    PARM SDCUST    DSSDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '10'      DBASE                                               CDL033
     C                     MOVEL@KEY1     DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SDCUSTPD'DBFILE                                              CDL033
     C                     MOVE *ON       *IN72                                               CDL033
     C                     GOTO ERROR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Retrieve currency details to determine number of                                     CDL033
      ** decimal places for principal amount.                                                 CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     CALL 'AOCURRR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*KEY   ' @OPTN                                               CDL033
     C                     PARM CCYDC     @AJCD                                               CDL033
     C           SDCURR    PARM SDCURR    DSSDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '11'      DBASE                                               CDL033
     C                     MOVEL@AJCD     DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SDCURRPD'DBFILE                                              CDL033
     C                     MOVE *ON       *IN72                                               CDL033
     C                     GOTO ERROR                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     MOVE *OFF      *IN50                                               CDL033
     C                     MOVE *OFF      *IN51                                               CDL033
     C                     MOVE *OFF      *IN52                                               CDL033
     C                     MOVE *OFF      *IN53                                               CDL033
      *                                                                                       CDL033
     C                     SELEC                                                              CDL033
     C           A6NBDP    WHLT 1                                                             CDL033
     C                     MOVE *ON       *IN50                                               CDL033
     C           A6NBDP    WHEQ 1                                                             CDL033
     C                     MOVE *ON       *IN51                                               CDL033
     C           A6NBDP    WHEQ 2                                                             CDL033
     C                     MOVE *ON       *IN52                                               CDL033
     C           A6NBDP    WHGT 2                                                             CDL033
     C                     MOVE *ON       *IN53                                               CDL033
     C                     ENDSL                                                              CDL033
      *                                                                                       CDL033
      ** Do not print zero spread rate.                                                       CDL033
      *                                                                                       CDL033
     C           RTSP      IFEQ *ZERO                                                         CDL033
     C                     MOVE *ON       *IN61                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Report exception if required.                                                        CDL033
      *                                                                                       CDL033
     C           XKINFD    IFGT BJRDNB                                                        CDL033
     C                     MOVE *ON       *IN71                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Format rate fix date.                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKINFD    ZDAYNO                                              CDL033
     C                     EXSR ZDATE2                                                        CDL033
     C                     MOVE ZADATE    VDATA                                               CDL033
      *                                                                                       CDL033
      ** Output to LF/DAMBR and report.                                                       CDL033
      *                                                                                       CDL033
     C                     EXCPTFICI                                                          CDL033
     C                     ADD  1         DLTOT                                               CDL033
      *                                                                                       CDL033
     C           EFRCD     ENDSR                                                              CDL033
      *****************************************************************                     MD031283
      *                                                               *                     MD031283
      *  SRBVAL - Generate base rate change record for back-valued    *                     MD031283
      *           deals                                               *                     MD031283
      *                                                               *                     MD031283
      *  Called by : - Main processing                                *                     MD031283
      *                                                               *                     MD031283
      *  Calls     : - ZDATE2                                         *                     MD031283
      *                                                               *                     MD031283
      *****************************************************************                     MD031283
      *                                                                                     MD031283
     C           SRBVAL    BEGSR                                                            MD031283
      *                                                                                     MD031283
      ** Process event for deal value date                                                  MD031283
      *                                                                                     MD031283
     C           HSKEY1    SETLLSDBSHSL1                                                    MD031283
     C           HSKEY1    READESDBSHSL1                 62                                 MD031283
      *                                                                                     MD031283
     C           *IN62     IFEQ *ON                                                         MD031283
     C           HSKEY1    SETLLSDBSHSL1                                                    MD031283
     C           HSKEY2    REDPESDBSHSL1                 62                                 MD031283
      *                                                                                     MD031283
     C           *IN62     IFEQ *ON                                                         MD031283
     C                     Z-ADD0         G0CBSR                                            MD031283
     C                     ENDIF                                                            MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C                     Z-ADDVDAT      ZDAYNO                                            MD031283
     C                     EXSR ZDATE2                                                      MD031283
     C                     MOVE ZADATE    VDATA                                             MD031283
      *                                                                                     MD031283
      ** Output to DAMBRDI and report.                                                      MD031283
      *                                                                                     MD031283
     C                     EXCPTBKVAL                                                       MD031283
      *                                                                                     MD031283
      ** Process event for rate changes in historic table                                   MD031283
      *                                                                                     MD031283
     C                     MOVE 'N'       MDATF   1                                         MD031283
      *                                                                                     MD031283
     C           HSKEY1    SETGTSDBSHSL1                                                    MD031283
     C           HSKEY2    READESDBSHSL1                 62                                 MD031283
      *                                                                                     MD031283
     C           *IN62     DOWEQ*OFF                                                        MD031283
      *                                                                                     MD031283
     C           G0CHGD    IFEQ 'Y'                                                         MD031283
     C           G0HIDT    ANDLTBAVDNR                                                      MD031283
     C           G0HIDT    OREQ BAVDNR                                                      MD031283
      *                                                                                     MD031283
     C           G0HIDT    IFEQ BAVDNR                                                      MD031283
     C                     Z-ADDBANBRT    G0CBSR                                            MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C                     Z-ADDG0HIDT    ZDAYNO                                            MD031283
     C                     EXSR ZDATE2                                                      MD031283
     C                     MOVE ZADATE    VDATA                                             MD031283
      *                                                                                     MD031283
      ** Output to DAMBRDI and report.                                                      MD031283
      *                                                                                     MD031283
     C                     EXCPTBKVAL                                                       MD031283
     C                     ADD  1         DLTOT                                             MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C           HSKEY2    READESDBSHSL1                 62                                 MD031283
      *                                                                                     MD031283
      ** Additional check for back-valued maturity                                          MD031283
      *                                                                                     MD031283
     C           *IN19     IFEQ *OFF                                                        MD031283
     C           MDAT      ANDLTBJRDNB                                                      MD031283
     C           MDAT      ANDLEG0HIDT                                                      MD031283
      *                                                                                     MD031283
     C                     MOVE 'Y'       MDATF                                             MD031283
     C                     LEAVE                                                            MD031283
      *                                                                                     MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
     C                     ENDDO                                                            MD031283
      *                                                                                     MD031283
      ** Process event for run date except back-valued maturity                             MD031283
      ** and maturity same as rundate                                                       MD031598
      *                                                                                     MD031283
     C           BAVDNR    IFEQ BJRDNB                                                      MD031283
     C           MDATF     ANDEQ'N'                                                         MD031283
     C           MDAT      ANDNEBJRDNB                                                      MD031598
      *                                                                                     MD031283
     C                     Z-ADDBANBRT    G0CBSR                                            MD031283
     C                     Z-ADDBJRDNB    ZDAYNO                                            MD031283
      *                                                                                     MD031283
     C                     EXSR ZDATE2                                                      MD031283
     C                     MOVE ZADATE    VDATA                                             MD031283
      *                                                                                     MD031283
      ** Output to DAMBRDI and report.                                                      MD031283
      *                                                                                     MD031283
     C                     EXCPTBKVAL                                                       MD031283
     C                     ADD  1         DLTOT                                             MD031283
     C                     ENDIF                                                            MD031283
      *                                                                                     MD031283
      ** Set off deals indicator so records will not duplicate                              MD031283
      *                                                                                     MD031283
     C                     MOVE '0'       *IN10                                             MD031283
      *                                                                                     MD031283
     C                     ENDSR                                                            MD031283
0638 C**
0639 C********************************************************************
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
0642 C**   SR. GLZADD REMOVED                                             S01093
0643 C***********GLZADD    BEGSR                           *** GLZADD ****S01093
0656 C********************************************************************
0662 C**   SR. GLZSUM REMOVED                                             S01093
0663 C***********GLZSUM    BEGSR                           *** GLZSUM ****S01093
0763 C********************************************************************
0764 C/EJECT
0765 O**DL0250P1D**203** 35N31N32                                  S01124 E25955
0765 O*L0250P1H**203***1P                                           E25955E39372
0765 ODL0250P1E  203           HEADER                                     E39372
0766 O       OR        OF
0767 O***********************************22 'REFERENCE DL0250'            S01117
0767 O                                   24 'REFERENCE DL0250P1'          S01117
0768 O*************************TITL      89                               S01194
0768 O                         BJURPT    89                               S01194
0769 O                                  104 'DATE'
0770 O*************************RUNA     112                               S01194
0770 O                         BJMRDT   112                               S01194
0771 O                                  122 'PAGE'
0772 O                         PAGE  Z  127
0773 O********D**1     35N31N32                                           E25955
0773 O********H  1     1P                                           E25955E39372
0773 O        E  1             HEADER                                     E39372
0774 O       OR        OF
0775 O                                   65 'BASE RATE CHANGES'
0776 O                                   75 '--- DEALS'
0777 O********D**2     35N31N32                                           E25955
0777 O********D  2     1P                                           E25955E39372
0773 O        E  1             HEADER                                     E39372
0778 O       OR        OF
0779 O                                   65 '-----------------'
0780 O                                   75 '----------'
0781 O********D**1*****35N31N32                                           046671
0773 O        E  1             HEADER                                     046671
0782 O       OR        OF
0783 O                                   50 'DEAL  DEAL'
0784 O**************************         97 'BASE RATE  SPREAD'           S01119
0785 O**************************        110 'VALUE DATE'                  S01119
0784 O***********************************84 'RATE'                 S01119 CDL038
     O***********************************90 'AMEND'                S01119 CDL038
     O                                   86 'RATE'                        CDL038
     O                                   92 'AMEND'                       CDL038
0784 O                                   99 'SPREAD'                      S01119
0784 O                                  106 'SPD'                         S01119
0785 O                                  117 'VALUE DATE'                  S01119
0786 O********D**2*****35N31N32                                           S01119
0786 O********D**1*****35N31N32                                    S01119 046671
0773 O        E  1             HEADER                                     046671
0787 O       OR        OF
0788 O                                   12 'CUSTOMER'
0789 O*************************          55 'NUMBER TYPE  CCY'            SA1157
0789 O***********************************56 'NUMBER TYPE   CCY'    SA1157 CDL038
0790 O*************************          86 'AMOUNT    TYPE'              S01119
0791 O*************************         108 'APPLIED'                     S01119
0790 O***********************************84 'AMOUNT  TYPE'         S01119 CDL038
0790 O***********************************90 'TYPE'                 S01119 CDL038
     O                                   61 'NUMBER TYPE        CCY'      CDL038
     O                                   86 'AMOUNT  TYPE'                CDL038
     O                                   92 'TYPE'                        CDL038
0790 O                                  106 'IND'                         S01119
0791 O                                  114 'APPLIED'                     S01119
0792 O********D**1*****10*27*28                                           S01119
0792 O        D 10     10 27 28                                           S01119
     O*******AND      N64                                                          229360 AR1045065A
0793 O                         CNUM       6
0794 O*************************CRNM      27                               S01194
0795 O*************************CTWN      38                               S01194
0794 O                         BBCRNM    27                               S01194
0795 O                         BBCRTN    38                               S01194
0796 O                         DLNO      45
0797 O                         DTYP      48
0798 O                                   49 '-'
0799 O                         DLST      51
     O                         CLAS      55                               CDL038
     O                 16      BYSL      57                               CDL038
     O                 50      PCPL      78 ' ,   ,   ,   , 0 '           CDL038
     O                 51      PCPL      80 '   ,   ,   , 0 . '           CDL038
     O                 52      PCPL      81 '  ,   ,   , 0 .  '           CDL038
     O                 53      PCPL      82 ' ,   ,   , 0 .   '           CDL038
     O                         CCYDC     61                               CDL038
     O                         BRTT      85                               CDL038
     O*****************16******BYSL      52                        SA1157 CDL038
0800 O***********************  CCYDC     55                               SA1157
0800 O*************************CCYDC     56                        SA1157 CDL038
0801 O*****************50******PCPL      75 ' ,   ,   ,   , 0 '           CDL038
0802 O*****************51******PCPL      77 '   ,   ,   , 0 . '           CDL038
0803 O*****************52******PCPL      78 '  ,   ,   , 0 .  '           CDL038
0804 O*****************53******PCPL      79 ' ,   ,   , 0 .   '           CDL038
0805 O*****************        BRTT      85                               S01119
0806 O*****************        RTSP  3  100                               S01119
0807 O*****************        VDATA    108                               S01119
0808 O*****************36               126 '** INVESTIGATE **'           S01119
0805 O*************************BRTT      83                        S01119 CDL038
     O                                   90 'BR'                          S01119
     O/COPY WNCPYSRC,DL0250O008
0806 O**********               RTSP  3  102                                            S01119 CDL033
     O                N73      RTSP  3  102                                                   CDL033
     O                 73      RTSP  N  104                                                   CDL033
     O/COPY WNCPYSRC,DL0250O009
0807 O                         VDATA    114                               S01119
0808 O                 36               132 '** INVESTIGATE **'           S01119
0792 O        D 10     10 27 28                                                               CRE073
     O       AND      N64 11                                                                  CRE073
     O                                   53 'CONT. SPREAD'                                    CRE073
     O                         CNSP  3   66                                                   CRE073
     O                                   91 'ROUNDING METHOD FRAC/DEC'                        CRE073
     O                         RDMT      99                                                   CRE073
     O                         RDFD     104                                                   CRE073
0792 O********EF10*************BRFRA                               S01119 046671
0792 O        E 10             BRFRA                                      046671
0793 O                         CNUM       6                               S01119
0794 O*************************CRNM      27                         S01119S01194
0795 O*************************CTWN      38                         S01119S01194
     O                         BBCRNM    27                               S01194
     O                         BBCRTN    38                               S01194
0796 O                         DLNO      45                               S01119
0797 O                         DTYP      48                               S01119
0798 O                                   49 '-'                           S01119
0799 O                         DLST      51                               S01119
     O                         CLAS      55                               CDL038
     O                 16      BYSL      57                               CDL038
     O                 50      PCPL      78 ' ,   ,   ,   , 0 '           CDL038
     O                 51      PCPL      80 '   ,   ,   , 0 . '           CDL038
     O                 52      PCPL      81 '  ,   ,   , 0 .  '           CDL038
     O                 53      PCPL      82 ' ,   ,   , 0 .   '           CDL038
     O                         CCYDC     61                               CDL038
     O                         BRTT      85                               CDL038
     O*****************16******BYSL      52                        SA1157 CDL038
0800 O************************ CCYDC     55                        S01119 SA1157
0800 O*************************CCYDC     56                        SA1157 CDL038
0801 O*****************50******PCPL      75 ' ,   ,   ,   , 0 '    S01119 CDL038
0802 O*****************51******PCPL      77 '   ,   ,   , 0 . '    S01119 CDL038
0803 O*****************52******PCPL      78 '  ,   ,   , 0 .  '    S01119 CDL038
0804 O*****************53******PCPL      79 ' ,   ,   , 0 .   '    S01119 CDL038
0805 O*************************BRTT      83                        S01119 CDL038
     O                                   90 'FI'                          S01119
     O/COPY WNCPYSRC,DL0250O010
0806 O**********         N61   RTSP  3  102                                          S01119 AR814519
     O                   N61   RTSP  N  102                                                 AR814519
     O/COPY WNCPYSRC,DL0250O011
0806 O                         SPDI     106                               S01119
0807 O                         VDATA    114                               S01119
0808 O                 36               132 '** INVESTIGATE **'           S01119
     O        E 10             BKVAL                                                        MD031283
     O                         CNUM       6                                                 MD031283
     O                         BBCRNM    27                                                 MD031283
     O                         BBCRTN    38                                                 MD031283
     O                         DLNO      45                                                 MD031283
     O                         DTYP      48                                                 MD031283
     O                                   49 '-'                                             MD031283
     O                         DLST      51                                                 MD031283
     O                         CLAS      55                                                 MD031283
     O                 16      BYSL      57                                                 MD031283
     O                 50      PCPL      78 ' ,   ,   ,   , 0 '                             MD031283
     O                 51      PCPL      80 '   ,   ,   , 0 . '                             MD031283
     O                 52      PCPL      81 '  ,   ,   , 0 .  '                             MD031283
     O                 53      PCPL      82 ' ,   ,   , 0 .   '                             MD031283
     O                         CCYDC     61                                                 MD031283
     O                         BRTT      85                                                 MD031283
     O                                   90 'BR'                                            MD031283
     O                N73      RTSP  3  102                                                 MD031283
     O                 73      RTSP  N  104                                                 MD031283
     O                         VDATA    114                                                 MD031283
     O                 36               132 '** INVESTIGATE **'                             MD031283
0792 O        E 10     11      BKVAL                                                        MD031283
     O                                   53 'CONT. SPREAD'                                  MD031283
     O                         CNSP  3   66                                                 MD031283
     O                                   91 'ROUNDING METHOD FRAC/DEC'                      MD031283
     O                         RDMT      99                                                 MD031283
     O                         RDFD     104                                                 MD031283
0792 O********EF10*************FIFRA                               S01119 046671
0792 O        E 10             FIFRA                                      046671
0793 O                         CNUM       6                               S01119
0794 O*************************CRNM      27                         S01119S01194
0795 O*************************CTWN      38                         S01119S01194
     O                         BBCRNM    27                               S01194
     O                         BBCRTN    38                               S01194
0796 O                         DLNO      45                               S01119
0797 O                         DTYP      48                               S01119
0798 O                                   49 '-'                           S01119
0799 O                         DLST      51                               S01119
     O                         CLAS      55                               CDL038
     O                 16      BYSL      57                               CDL038
     O                 50      PCPL      78 ' ,   ,   ,   , 0 '           CDL038
     O                 51      PCPL      80 '   ,   ,   , 0 . '           CDL038
     O                 52      PCPL      81 '  ,   ,   , 0 .  '           CDL038
     O                 53      PCPL      82 ' ,   ,   , 0 .   '           CDL038
     O                         CCYDC     61                               CDL038
     O                         BRTT      85                               CDL038
     O*****************16******BYSL      52                        SA1157 CDL038
0800 O***********************  CCYDC     55                        S01119 SA1157
0800 O*************************CCYDC     56                        SA1157 CDL038
0801 O*****************50******PCPL      75 ' ,   ,   ,   , 0 '    S01119 CDL038
0802 O*****************51******PCPL      77 '   ,   ,   , 0 . '    S01119 CDL038
0803 O*****************52******PCPL      78 '  ,   ,   , 0 .  '    S01119 CDL038
0804 O*****************53******PCPL      79 ' ,   ,   , 0 .   '    S01119 CDL038
0805 O*************************BRTT      83                        S01119 CDL038
     O                                   90 'FI'                          S01119
     O/COPY WNCPYSRC,DL0250O012
0806 O**********         N61   RTSP  3  102                                          S01119 AR814519
     O                   N61   RTSP  N  102                                                 AR814519
     O/COPY WNCPYSRC,DL0250O013
0806 O                         SPDI     106                               S01119
0807 O                         VDATA    114                               S01119
0792 O        E 00             EARLY                                      S01119
0808 O********                          130 '** EARLY FIX **'      S01119 SA1157
0808 O                N70               132 '** EARLY FIX **'             SA1157
0808 O                 70               132 '** I/C RATE FIX **'          SA1157
     O/COPY WNCPYSRC,DL0250O006
      *                                                                                       CDL033
     O        E 10             FICI                                                           CDL033
     O                         CNUM       6                                                   CDL033
     O                         BBCRNM    27                                                   CDL033
     O                         BBCRTN    38                                                   CDL033
     O                         DLNO      45                                                   CDL033
     O                         DTYP      48                                                   CDL033
     O                                   49 '-'                                               CDL033
     O                         DLST      51                                                   CDL033
     O                         CLAS      55                                                   CDL038
     O                 50      PCPL      78 ' ,   ,   ,   , 0 '                               CDL038
     O                 51      PCPL      80 '   ,   ,   , 0 . '                               CDL038
     O                 52      PCPL      81 '  ,   ,   , 0 .  '                               CDL038
     O                 53      PCPL      82 ' ,   ,   , 0 .   '                               CDL038
     O                         CCYDC     61                                                   CDL038
     O                         BRTT      85                                                   CDL038
     O*************************CCYDC     56                                            CDL033 CDL038
     O*****************50******PCPL      75 ' ,   ,   ,   , 0 '                        CDL033 CDL038
     O*****************51******PCPL      77 '   ,   ,   , 0 . '                        CDL033 CDL038
     O*****************52******PCPL      78 '  ,   ,   , 0 .  '                        CDL033 CDL038
     O*****************53******PCPL      79 ' ,   ,   , 0 .   '                        CDL033 CDL038
     O*************************BRTT      83                                            CDL033 CDL038
     O                                   90 'FI'                                              CDL033
     O                   N61   RTSP  N  104                                                   CDL033
     O                         VDATA    114                                                   CDL033
     O                 71               132 '** EARLY FIX **'                                 CDL033
      *                                                                                       CDL033
     O        E 10     11      FICI                                                           CRE073
     O                                   53 'CONT. SPREAD'                                    CRE073
     O                         CNSP  3   66                                                   CRE073
     O                                   91 'ROUNDING METHOD FRAC/DEC'                        CRE073
     O                         RDMT      99                                                   CRE073
     O                         RDFD     104                                                   CRE073
     O        T 3      LR                                                 LN0815
     O                                   76 '*** END OF REPORT ***'       LN0815
     ODL0250AUT  203   LR                                                 S01117
0809 O********T**203***LR****************                                 S01117
0810 O***********************************22 'REFERENCE DL0250'            S01117
     O                                   24 'REFERENCE DL0250AU'          S01117
0811 O*************************TITL      89                               S01194
0811 O                         BJURPT    89                               S01194
0812 O                                  104 'DATE'
0813 O*************************RUNA     112                               S01194
0813 O                         BJMRDT   112                               S01194
0814 O                                  122 'PAGE'
0815 O*************************PAGE  Z  127                               S01117
0815 O                         PAGE1 Z  127                               S01117
0816 O        T  1     LR
0817 O                                   63 'BASE RATE CHANGES - DEAL'
0818 O                                   86 'S - FILE CONTROL REPORT'
0819 O        T  2     LR
0820 O                                   63 '------------------------'
0821 O                                   86 '-----------------------'
0822 O******  T 21     LRN31N32                                           S01093
0823 O******                             19 'S/DLUPD  -'                  S01093
0824 O******                             33 'RUN CONTROLS'                S01093
0826 O******                            102 'IN PROGRAM'                  S01093
0827 O******  T  2     LRN31N32                                           S01093
0828 O******                             19 '-----------'                 S01093
0829 O******                             33 '------------'                S01093
0831 O******                            102 '----------'                  S01093
0832 O******  T  2     LRN31N32                                           S01093
0833 O******                             42 'TOTAL RECORDS ON FILE'       S01093
0835 O******                   CNORE 3  102                               S01093
0837 O******  T  2     LRN31N32                                           S01093
0838 O******                             43 'DETAIL RECORDS ON FILE'      S01093
0840 O******                   CNLRA 3  102                               S01093
0842 O******  T  2     LRN31N32                                           S01093
0843 O******                             36 'DETAIL RECORDS '             S01093
0844 O******                             46 'HASH TOTAL'                  S01093
0847 O******                   ZZTOTIZ   99                               S01093
0848 O******                   ZZTOTD   102                               S01093
0850 O        T 21     LR
0851 O                                   19 'S/DAMBR  -'
0852 O                                   33 'RUN CONTROLS'
0853 O                                  102 'FILE CREATE'
0854 O        T  2     LR
0855 O                                   16 '-------'
0856 O                                   33 '------------'
0857 O                                  102 '-----------'
0858 O        T  1     LR
0859 O                                   42 'TOTAL RECORDS ON FILE'
0860 O                         DLTOT 3  102
     O        T 3      LRNU7N14                                           S01117
0564 O                                   63 '***   NO DETAILS TO REPO'    S01117
0565 O                                   71 'RT   ***'                    S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O/COPY WNCPYSRC,DL0250O003
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O/COPY WNCPYSRC,DL0250O004
     O                                   46 'KEY'                         S01117
     O**********               DBKEY1    50                               S01117              CDL033
     O**********               DBKEY2    52                               S01117              CDL033
     O**********                         69 'OPTION'                      S01117              CDL033
     O**********               DBOPTN    77                               S01117              CDL033
     O                N73      DBKEY1    50                                                   CDL033
     O                N73      DBKEY2    52                                                   CDL033
     O                N73                69 'OPTION'                                          CDL033
     O                N73      DBOPTN    77                                                   CDL033
     O                 73N72   DBKEY1    50                                                   CDL033
     O                 73N72   DBKEY2    52                                                   CDL033
     O                 73 72   DBKEY     76                                                   CDL033
     O                 73                84 'OPTION'                                          CDL033
     O                 73      DBOPTN    92                                                   CDL033
     O*****   T 3      LR                                          E14920 LN0135
     O*****                              76 '*** END OF REPORT ***'E14920 LN0135
     O/COPY WNCPYSRC,DL0250O005
0861 O*AMBRDH*DADD*****14                                                 S01093
0861 ODAMBRDH EADD             HEADER                                     S01093
0862 O                                    1 'A'
0863 O                                    7 '000000'
0864 O                         ZERO5     12
0865 O                                   15 '000'
0866 O                         ZERO5     18P
0867 O                                   19 '0'
     O                         ZZ174    193                                                AR762808B
0868 O**********               ZERO5    194P                                               AR762808B
     O                         ZERO5    196P                                               AR762808B
     O                         ZZ001    197                                                AR762808B
0869 O                         ZERO5    200P
0870 ODAMBRDI DADD     10 27 28
     O       AND      N64                                                                     229360
0871 O                                    1 'D'
0872 O                         DLNO       7
     O/COPY WNCPYSRC,DL0250O001
0873 O                         IACD      12
0874 O*****************30******VDNR      12                               S01194
0874 O                 30      BAVDNR    12                               S01194
     O/COPY WNCPYSRC,DL0250O002
0875 O                                   15 '000'
0876 O                         DTYP      17
0877 O                         DLST      19
0878 O                                   21 'BR'
0879 O                                   22 '5'
0880 O                         BRTT      24
0881 O*************************NBRT      30P                              S01194
0881 O                         BANBRT    30P                              S01194
0882 O*************************CCY       33                               S01194
     O                         BACYCD    33                               S01194
0883 O                         ZERO13    40P
0884 O                                   41 'G'
0885 O                         CNUM      47
     O                         ZERO2     49                                                AR762808B
     O                         ZZ012     61                                                AR762808B
     O                         ZZ010     71                                                AR762808B
     O                         ZZ010     81                                                AR762808B
     O                         ZZ035    116                                                AR762808B
     O                         ZZ022    138                                                AR762808B
     O                         ZERO5    141P                                               AR762808B
     O                         ZERO3    144                                                AR762808B
     O                         ZZ001    145                                                AR762808B
     O                         BRCA     148                               S01117
     O                         BRCA     151                               E49965
     O                         ZZ039    190                                                AR762808B
0886 O*************************RUND     193P                              S01194
0886 O                         BJRDNB   193P                              S01194
     O                         ZERO5    196P                                               AR762808B
     O                         ZZ001    197                                                AR762808B
     O                         ZERO5    200P                                               AR762808B
     O                         ZZ018    218                                                AR762808B
     O                         CLAS     222                               CDL038
0870 ODAMBRDI EADD             BRFRA                                      S01119
0871 O                                    1 'D'                           S01119
0872 O                         DLNO       7                               S01119
0873 O                         ODATE     12                               S01119
0875 O                         SEQN      15                               S01119
0876 O                         DTYP      17                               S01119
0877 O                         DLST      19                               S01119
0878 O                                   21 'FI'                          S01119
0879 O                                   22 '5'                           S01119
0880 O                         BRTT      24                               S01119
0881 O*************************NBRT      30P                        S01119S01194
0881 O                         BANBRT    30P                              S01194
0882 O*************************CCY       33                         S01119S01194
     O                         BACYCD    33                               S01194
0883 O                         ZERO13    40P                              S01119
0884 O                                   41 'G'                           S01119
0885 O                         CNUM      47                               S01119
     O                         ZERO2     49                                                AR762808B
     O                         ZZ012     61                                                AR762808B
     O                         ZZ010     71                                                AR762808B
     O                         ZZ010     81                                                AR762808B
     O                         ZZ035    116                                                AR762808B
     O                         ZZ022    138                                                AR762808B
     O                         ZERO5    141P                                               AR762808B
     O                         ZERO3    144                                                AR762808B
     O                         ZZ001    145                                                AR762808B
     O                         BRCA     148                               S01117
     O                         BRCA     151                               E49965
     O                         ZZ039    190                                                AR762808B
0886 O*************************RUND     193P                        S01119S01194
0886 O                         BJRDNB   193P                              S01194
     O                         ZERO5    196P                                               AR762808B
     O                         ZZ001    197                                                AR762808B
     O                         ZERO5    200P                                               AR762808B
     O                         ZZ018    218                                                AR762808B
     O                         CLAS     222                               CDL038
0870 ODAMBRDI EADD             FIFRA                                      S01119
0871 O                                    1 'D'                           S01119
0872 O                         DLNO       7                               S01119
0873 O                         INFD      12                               S01119
0875 O                         SEQN      15                               S01119
0876 O                         DTYP      17                               S01119
0877 O                         DLST      19                               S01119
0878 O                                   21 'FI'                          S01119
0879 O                                   22 '5'                           S01119
0880 O                         BRTT      24                               S01119
0881 O*************************NBRT      30P                        S01119S01194
0881 O                         BANBRT    30P                              S01194
0881 O*****************57      BRTE      30P                        S01119083921
0881 O                 57      BACBSR    30P                              083921
0881 O                 59      IRTE      30P                                                  CDL028
0882 O*************************CCY       33                         S01119S01194
     O                         BACYCD    33                               S01194
0883 O                         ZERO13    40P                              S01119
0884 O                                   41 'G'                           S01119
0885 O                         CNUM      47                               S01119
     O                         ZERO2     49                                                AR762808B
     O                         ZZ012     61                                                AR762808B
     O                         ZZ010     71                                                AR762808B
     O                         ZZ010     81                                                AR762808B
     O                         ZZ035    116                                                AR762808B
     O                         ZZ022    138                                                AR762808B
     O                         ZERO5    141P                                               AR762808B
     O                         ZERO3    144                                                AR762808B
     O                         ZZ001    145                                                AR762808B
     O                         BRCA     148                               S01117
     O                         BRCA     151                               E49965
     O                         ZZ039    190                                                AR762808B
0886 O*************************RUND     193P                        S01119S01194
0886 O                         BJRDNB   193P                              S01194
     O                         ZERO5    196P                                               AR762808B
     O                         ZZ001    197                                                AR762808B
     O                         ZERO5    200P                                               AR762808B
     O                         ZZ018    218                                                AR762808B
     O                         CLAS     222                               CDL038
     O/COPY WNCPYSRC,DL0250O007
      *                                                                                       CDL033
     ODAMBRDI EADD             FICI                                                           CDL033
     O                                    1 'D'                                               CDL033
     O                         DLNO       7                                                   CDL033
     O                         XKINFD    12                                                   CDL033
     O                                   15 '000'                                             CDL033
     O                         DTYP      17                                                   CDL033
     O                         DLST      19                                                   CDL033
     O                                   21 'FI'                                              CDL033
     O                                   22 '5'                                               CDL033
     O                         BRTT      24                                                   CDL033
     O                         WBRTE     30P                                                  CDL033
     O                         BACYCD    33                                                   CDL033
     O                         ZERO13    40P                                                  CDL033
     O                                   41 'G'                                               CDL033
     O                         CNUM      47                                                   CDL033
     O                         ZERO2     49                                                AR762808B
     O                         ZZ012     61                                                AR762808B
     O                         ZZ010     71                                                AR762808B
     O                         ZZ010     81                                                AR762808B
     O                         ZZ035    116                                                AR762808B
     O                         ZZ022    138                                                AR762808B
     O                         ZERO5    141P                                               AR762808B
     O                         ZERO3    144                                                AR762808B
     O                         ZZ001    145                                                AR762808B
     O                         BRCA     148                                                   CDL033
     O                         BRCA     151                                                   CDL033
     O                         ZZ039    190                                                AR762808B
     O                         BJRDNB   193P                                                  CDL033
     O                         ZERO5    196P                                               AR762808B
     O                         ZZ001    197                                                AR762808B
     O                         ZERO5    200P                                               AR762808B
     O                         ZZ018    218                                                AR762808B
     O                         CLAS     222                                                   CDL038
      *                                                                                       CDL033
     ODAMBRDI EADD             BKVAL                                                        MD031283
     O                                    1 'D'                                             MD031283
     O                         DLNO       7                                                 MD031283
     O                         ZDAYNO    12                                                 MD031283
     O                                   15 '000'                                           MD031283
     O                         DTYP      17                                                 MD031283
     O                         DLST      19                                                 MD031283
     O                                   21 'BR'                                            MD031283
     O                                   22 '5'                                             MD031283
     O                         BRTT      24                                                 MD031283
     O                         G0CBSR    30P                                                MD031283
     O                         BACYCD    33                                                 MD031283
     O                         ZERO13    40P                                                MD031283
     O                                   41 'G'                                             MD031283
     O                         CNUM      47                                                 MD031283
     O                         ZERO2     49                                                 MD031283
     O                         ZZ012     61                                                 MD031283
     O                         ZZ010     71                                                 MD031283
     O                         ZZ010     81                                                 MD031283
     O                         ZZ035    116                                                 MD031283
     O                         ZZ022    138                                                 MD031283
     O                         ZERO5    141P                                                MD031283
     O                         ZERO3    144                                                 MD031283
     O                         ZZ001    145                                                 MD031283
     O                         BRCA     148                                                 MD031283
     O                         BRCA     151                                                 MD031283
     O                         ZZ039    190                                                 MD031283
     O                         BJRDNB   193P                                                MD031283
     O                         ZERO5    196P                                                MD031283
     O                         ZZ001    197                                                 MD031283
     O                         ZERO5    200P                                                MD031283
     O                         ZZ018    218                                                 MD031283
     O                         CLAS     222                                                 MD031283
      *                                                                                     MD031283
0887 ODAMBRDJ TADD     LR
0888 O                                    1 'T'
0889 O                                    7 '999999'
0890 O                                   12 '99999'
0891 O                                   15 '999'
0892 O                         DLTOT     18P
     O                         ZERO5     21P                                               AR762808B
     O                         ZERO5     24P                                               AR762808B
     O                         ZERO5     27P                                               AR762808B
     O                         ZERO5     30P                                               AR762808B
     O                         ZERO5     33P                                               AR762808B
     O                         ZERO5     36P                                               AR762808C
     O**********               ZZ003     36                                      AR762808B AR762808C
     O                         ONLRA     39P
     O                         ZERO15    47P                                               AR762808B
     O                         ZERO3     49P                                               AR762808B
     O                         ZERO15    57P                                               AR762808B
     O                         ZERO3     59P                                               AR762808B
     O                         ZERO15    67P                                               AR762808B
     O                         ZERO3     69P                                               AR762808B
     O                         ZERO15    77P                                               AR762808B
     O                         ZERO3     79P                                               AR762808B
     O                         ZERO15    87P                                               AR762808B
     O                         ZERO3     89P                                               AR762808B
     O                         ZERO15    97P                                               AR762808B
     O                         ZERO3     99P                                               AR762808B
     O                         ZZ094    193                                                AR762808B
0893 O                         ZERO5    196P
     O                         ZZ001    197                                                AR762808B
0894 O                         ZERO5    200P
      ** ADD CF IN FXTERM ARRAY                                                           AR1045065A
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** FXTERM - Fixed-term Deals                                                                  CDL033
ITIPTDTICICF
