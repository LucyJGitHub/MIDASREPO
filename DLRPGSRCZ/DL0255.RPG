0001 H        1                                                           S01194
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Base rates table update')
0002 F********************************************************************DL0255
0003 F*                                                                  *DL0255
     F*  Midas - Dealing Module
0005 F*                                                                  *DL0255
0006 F*    DL0255 - UPDATE BASE RATE TABLE RECORDS                       *DL0255
0007 F*                                                                  *DL0255
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                                  *DL0255
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CSD027             Date 09Dec05               *
      *  Prev Amend No. CDL038             Date 10May05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CAP038             Date - 17mAR0              *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01314             Date - 13dEC9              *
0010 F*                   S01251       DATE - 03FEB90                    *CL0329
0010 F*                   S01168       DATE - 13/03/89                   *CL0329
     F*                   LN0245       DATE - 25MAY90                    *E47
     F*                   E47          DATE - 03JAN90                    *E47
     F*                   E115/S01194  DATE - 27NOV89                    *S01194
     F*                   S01194       DATE - 08/03/89                   *S01194
     F*                                                                  *DL0255
     F********************************************************************DL0255
     F*                                                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*    CAP038 - Conversion of SD inputs into modular structure    *
     F*             to use as APIs.                                   *
     F*    S01314      - Incorporation changes - db error processing  *
     F*                                          added                *
     F*    S01251      - SYNON FIELD/PROGRAM NAME CHANGES             *
     F*    S01168      - UPDATE SD SYNON FILES                           *
     F*    LN0245      - CORRECT FORMAT NAME                             *E47
     F*    E47         - AMEND SO BOTH NEW SD AND OLD TABLE FILES ARE    *E47
     F*                  UPDATED                                         *E47
     F*    E115/S01194 - USE L0 LOGICAL FOR UPDATES                      *DL0255
     F*    S01194      - RELEASE 10 NEW STANDING DATA,                   *DL0255
     F*****************************************************************
0013 F***DAMBR** IP  F     200 14AI     2 DISK                                         DL0255 CGL029
     F*DAMBR**IP**F*****212*14AI     2 DISK                                            CGL029 CDL038
     FDAMBR   IP  F     222 14AI     2 DISK                                                   CDL038
     F*SDBSRTL1UF**E*******             DISK                              S01194
     FSDBSRTL0UF  E                    DISK                               E115
0014 F*****TABLE   UF  F      96 12AI     2 DISK                          S01194
     FTABLETK UF  E           K        DISK                               E47
0015 F*                                                                   DL0255
0016 F* ID F  C  H  L    FUNCTION OF INDICATORS                           DL0255
0017 F**01************TABLE*-*INSTALLATION*CONTROL*DATA*RECORD*1.***      S01194
0018 F**02******************-*BASE*RATE*DETAIL*RECORD.**************      S01194
0019 F**03******************-*CATCHALL.*****************************      S01194
0020 F* 04            DAMBR - DETAIL RECORD.                              DL0255
0021 F* 05                  - CATCHALL.                                   DL0255
0022 F*                                                                   DL0255
0023 F********20******END*OF*TABLE*FILE*FOR*READ*OPERATION.*********      S01194
0023 F*       20      END OF BASE RATES FILE FOR READ OPERATION.          S01194
0024 F********21******TABLE*FILE*RECORD*TYPE*IS*NOT*21.************       S01194
0025 F********22******VALUE*DATE*OF*NEW*RATE*CHANGE*IS*LESS*THAN*OR*EQUAL S01194
0026 F****************TO*RUN*DATE.**********************************      S01194
0023 F*       24      CHAIN FAIL ON TABLE FILE                            E47
0023 F*       25      UPDATE RECORD ON TABLE FILE                         E47
0027 F*       LR      END OF DAMBR FILE OR DAMBR DETAIL RECORD READ.      S01194
     E                    CPY@    1   1 80
0028 I*                                                                   DL0255
0029 I*                                                                   DL0255
0030 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.*****          S01194
0031 I**********************************************************          S01194
0032 I*ABLE***NS**01***2*C0***3*C1**12*C1***********************          S01194
0033 I*******AND******13*C0*************************************          S01194
0034 I****************************************1   1 RECI                  S01194
0035 I****************************************2   30RECT                  S01194
0036 I***************************************12  130RCDE                  S01194
0037 I***************************************14  66 TITL                  S01194
0038 I***************************************67  67 DATF                  S01194
0039 I***************************************68  700DFBR                  S01194
0040 I***************************************74  74 MODI1                 S01194
0041 I***************************************75  75 MODI2                 S01194
0042 I***************************************76  76 MODI3                 S01194
0043 I************************************P  77  790RUND                  S01194
0044 I***************************************80  86 RUNA                  S01194
0045 I***************************************87  870SFLG                  S01194
0046 I************************************P  90  920LCD                   S01194
0047 I***************************************93  93 CHTP                  S01194
0048 I************************************P  94  960TNLU                  S01194
0049 I***************************************                             S01194
0050 I***************************************                             S01194
0051 I*****TABLE*FILE*-*BASE*RATE*RECORD.****                             S01194
0052 I***************************************                             S01194
0053 I********NS**02***1*CD***2*C2***3*C1****                             S01194
0054 I*************************************** 1   1 RECI                  S01194
0055 I*************************************** 2   30RECT                  S01194
0056 I*************************************** 9  11 CCY                   S01194
0057 I***************************************12  130BRTT                  S01194
0058 I************************************P  14  197BRTE                  S01194
0059 I************************************P  20  220VDRC                  S01194
0060 I***************************************23  23 RCIN                  S01194
0061 I***************************************24  53 BRTN                  S01194
0062 I************************************P  54  597NBRT                  S01194
0063 I************************************P  60  620VDNR                  S01194
0064 I************************************P  90  920LCD                   S01194
0065 I***************************************93  93 CHTP                  S01194
0066 I************************************P  94  960TNLU                  S01194
0067 I***************************************                             S01194
0068 I***************************************                             S01194
0069 I*****CATCHALL.*************************                             S01194
0070 I***************************************                             S01194
0071 I********NS**03*************************                             S01194
0072 I*************************************** 1   1 RECI                  S01194
0073 I*************************************** 2   30RECT                  S01194
0029 I*                                                                   DL0255
0074 I*                                                                   DL0255
0077 I*    DEALS AMENDMENT FILE - HEADER RECORD.                          DL0255
0078 I*                                                                   DL0255
0079 IDAMBR   NS  04   1 CA                                               DL0255
0080 I                                        1   1 RECI                  DL0255
0081 I                                        2   70DLNO                  DL0255
0082 I                                        8  120VDAT                  DL0255
0083 I                                       13  150DASN                  DL0255
0084 I                                       16  17 DTYP                  DL0255
0085 I                                       18  19 DLST                  DL0255
0086 I                                       20  21 AMTP                  DL0255
0087 I                                       22  220PSEQ                  DL0255
0088 I                                       23  240BRTT                  DL0255
0089 I                                    P  25  307RTSP                  DL0255
0090 I                                       31  33 CCY                   DL0255
0091 I                                    P  34  400DAAM                  DL0255
0092 I                                       41  41 MOGI                  DL0255
0093 I**********                             42  470CNUM                  DL0255              CSD027
0093 I                                       42  47 CNUM                  DL0255              CSD027
0094 I                                       48  490SETP                  DL0255
0095 I**********                             50  61 OSAC                               DL0255 CGL029
     I                                       50  61 OSACQQ                                    CGL029
0096 I                                       62  71 TSEN                  DL0255
0097 I                                       72  81 FACO                  DL0255
0098 I                                       82 116 SPI                   DL0255
0099 I                                    P 139 1410NAAD                  DL0255
0100 I                                      142 1440NASN                  DL0255
0101 I                                      145 145 DAIN                  DL0255
0102 I                                    P 191 1930ORED                  DL0255
0103 I                                    P 194 1960LCD                   DL0255
0104 I                                      197 197 CHTP                  DL0255
0105 I                                    P 198 2000TNLU                  DL0255
     I                                      201 212 OSAC                                      CGL029
     I                                      219 222 CLAS                                      CDL038
0106 I*                                                                   DL0255
0107 I*                                                                   DL0255
0108 I*    CATCHALL.                                                      DL0255
0109 I*                                                                   DL0255
0110 I        NS                                                          DL0255
     I*                                                                   S01194
     I*SDBANK****E DSSDBANKD0                                             E115
     I***EXTERNAL*DS*FOR BANK DETAILS                                     E115
     I*                                                                   S01194
     IRUNDAT      DS                             13                       S01194
     I* DATA STRUCTURE FOR RUNDATE                                        S01194
     I                                    P   8  100@RUND                 S01194
     I*                                                                   S01194
     I           UDS                                                      S01314
     I**  Local data area for data base errors.                           S01314
     I                                      134 141 DBFILE                S01314
     I                                      142 170 DBKEY                 S01314
     I                                      171 180 DBPGM                 S01314
     I                                      181 1830DBASE                 S01314
0028 I*                                                                   S01314
0028 IDBERR       DS                              5                       S01314
0028 I                                        1   3 BACYCD                S01314
0028 I                                        4   50RCOD                  S01314
0029 I*                                                                   S01314
     C                     MOVEACPY@      BIS@   80
0112 C*    IGNORE ALL NON-HEADER DAMBR RECORDS.                           DL0255
0113 C   04                SETON                     LR23                 DL0255
0114 CLRN23                GOTO END                                       DL0255
0115 C*                                                                   DL0255
0116 C*****ACCESS*INSTALLATION*CONTROL*DATA*RECORD*1.****                 S01194
0117 C*****LR**************MOVEL'01      'TABKEY 12                       S01194
0118 C*****LR**************MOVE '  10'    TABKEY                          S01194
0119 C*****LR****TABKEY****SETLLTABLE                                     S01194
0120 C*****LR**************READ TABLE                    20               S01194
0121 C*****LRN01***********SETON                     U7U8                 S01194
0122 C*****LRN01***********GOTO END                                       S01194
0123 C*********************                                               S01194
0124 C*****ACCESS*BASE*RATES*TABLE.*************                          S01194
0125 C*****LR**************MOVEL'21      'TABKEY                          S01194
0126 C*****LR**************MOVE '    '    TABKEY                          S01194
0127 C*****LR****TABKEY****SETLLTABLE                                     S01194
0128 C*********************                                               S01194
0129 C*****LR****READ******TAG                             ** READ TAG ***S01194
0130 C*********************                                               S01194
0131 C*****LR**************SETOF                     0203                 S01194
0132 C*****LR**************READ TABLE                    20               S01194
0133 C*****LR*03*RECT******COMP 21                   2121                 S01194
0134 C*****LR*20***********                                               S01194
0135 C*****OR*03*21********GOTO END                                       S01194
0136 C*****LR*03***********GOTO READ                                      S01194
0130 C*                                                                   S01194
0115 C*                                                                   DL0255
     C** GET RUN DATE FROM DATA AREA - RUNDATE                            S01194
     C*                                                                   S01194
     CLR                   IN   RUNDAT                                    S01194
     CLR         *NAMVAR   DEFN           RUNDAT                          S01194
     C*                                                                   S01194
     C** ACCESS BASE RATES FILE                                           S01194
     C*                                                                   S01194
     C*R*********1         SETLLSDBSRTL1                                  E115
     CLR         1         SETLLSDBSRTL0                                  S01194
0128 C*                                                                   S01194
0129 CLR         READ      TAG                             ** READ TAG ***S01194
0130 C*                                                                   S01194
     C*R****************** READ SDBSRTL1                 20               E115
     CLR                   READ SDBSRTL0                 20               S01194
     C*                                                                   S01194
     CLR         *IN20     IFEQ '1'                                       S01194
     CLR                   GOTO END                                       S01194
     CLR                   END                                            S01194
     C*                                                                   S01194
     CLR                   MOVE '0'       *IN25                           E47
     CLR                   MOVELBABSRC    RCOD    20                      E47
     CLR         TABKEY    KLIST                                          E47
     CLR                   KFLD           BACYCD                          E47
     CLR                   KFLD           RCOD                            E47
0137 C*                                                                   DL0255
0138 C*    CHECK DEALS RECORDS TO BE GENERATED INDICATOR AND VALUE DATE   DL0255
0139 C*    OF NEW RATE CHANGE.                                            DL0255
0140 C*****LR**************TESTB'14'      RCIN         2222               S01194
0141 C*****LR*22*VDNR******COMP RUND                   2222               S01194
0142 C*                                                                   S01194
0143 C*****SET*OFF*INDICATOR*AND*OUTPUT*TO*TABLE*FILE.********            S01194
0144 C*****LR*22***********BITOF'14'      RCIN                            S01194
     CLR         BADLLC    IFEQ 'Y'                                       S01194
     CLR         BADLRC    OREQ 'Y'                                       S01194
     C*                                                                   S01194
     CLR         BAVDNR    IFLE @RUND                                     S01194
     C*                                                                   S01194
     C*R***********        MOVE '0'       *IN25                           E47
     C** SET FILEDS TO NO AND UPDATE RECORD                               S01194
     CLR                   MOVE 'N'       BADLLC                          S01194
     CLR                   MOVE 'N'       BADLRC                          S01194
     CLR         TABKEY    CHAINTABLETK              24                   E47
     CLR         *IN24     IFEQ '1'                                       E47
     C*LR*******************GOTO ENDT                              E47    S01314
     CLR                   MOVE 'TABLETK' DBFILE           ************   S01314
     CLR                   MOVE 'DL0255  'DBPGM            *          *   S01314
     CLR                   MOVELDBERR     DBKEY            *DBERROR 01*   S01314
0137 CLR                   Z-ADD1         DBASE            ************   S01314
0137 CLR                   SETON                     U7U8                 S01314
     CLR                   EXSR *PSSR                                     S01314
0137 CLR                   GOTO END                                       S01314
     CLR                   END                                            E47
     CLR                   BITOF'14'      RCIN                            E47
     CLR                   MOVE '1'       *IN25                           E47
0148 C*LR********ENDT******TAG                             ** ENDTTAG E47 S01314
     CLR                   END                                            S01194
     C*                                                                   S01194
     CLR                   END                                            S01194
     C*                                                                   S01194
0145 CLR                   EXCPT                                          DL0255
0146 CLR                   GOTO READ                                      DL0255
0147 C*                                                                   DL0255
0148 CLR         END       TAG                             ** END TAG ****DL0255
1048 C*                                                                   S01314
1024 C*    ERROR DUMP SUBROUTINE.                                         S01314
1048 C*                                                                   S01314
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01314
1020 C           @RUN      IFEQ *BLANK                                    S01314
1021 C                     MOVE 'Y'       @RUN    1                       S01314
1020 C                     DUMP                                           S01314
1021 C                     END                                            S01314
1022 C                     ENDSR                           *** *PSSR **   S01314
0149 O*****TABLE***E***********                                           S01194
0150 O*************************RCIN      23                               S01194
     O*BAREDH*E**********                                                 E115
     O*@BAREDG*E*********                                                 S01194
     O*@BSRTH4 E*********                                              E47LN0245
     O@BAREDG E                                                           LN0245
     O                         BADLLC                                     S01194
     O                         BADLRC                                     S01194
0149 OTABLETKFE        25                                                 E47
0150 O                         RCIN                                       E47
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
