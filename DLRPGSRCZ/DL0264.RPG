     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deal amendments update - phase 1')            *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0264 - DEAL AMENDMENTS FILE UPDATE - PHASE 1               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD050459           Date 12Mar20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 AR598353           Date 04Jun15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD026719           Date 19Aug14               *
      *                 AR853123           Date 01Nov11               *
      *                 CRE073             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 229360             Date 09Sep04               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 245960             Date 23Apr07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 05Jul06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 BUG4092            Date 14Sep04               *
      *                 CDL022             Date 21Apr04               *
      *                 CDL017             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU003             Date 03Dec97               *
      *                 CAC001             Date 01Feb96               *
     F*                 091546             Date 30Apr96               *
     F*                 096561             DATE 12DEC95               *
     F*                 090645             DATE 07AUG95               *
     F*                 081661             DATE 24FEB95               *
     F*                 051496             DATE 03MAY94               *
     F*                 060528             DATE 11MAR94               *
     F*                 046303             DATE 13JAN94               *
     F*                 E38323             DATE 29JUL92               *
     F*                 S01354             DATE 08JAN92               *
     F*                 E21923             DATE 22JUL90               *
     F*                 E21501             DATE 27MAR90               *
     F*                 LN0353             DATE 12JUN90               *
     F*                 LN0135             DATE 23MAY90               *
     F*                 E19743             DATE 18APR90               *
     F*                 S01227             DATE 18APR90               *
     F*                 S01177             DATE 05/05/89              *
     F*                 S01194             DATE  9/03/89              *
     F*                 S01117             DATE  9/03/89              *
     F*                 S01195             DATE  9/03/89              *
     F*                 E10495             DATE 20/03/87              *
     F*                 E43355             DATE 06/03/87              *
     F*                 E10351             DATE 27/02/87              *
     F*                 E47258             DATE 05/06/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD050459 - Generate MT320 message for Amendment Type 'BC'    *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  AR598353 - Generate MT320 message for Amendment Type 'EM'.   *
      *             Applied for MD034571                              *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  MD026719 - Deal takes base rate as per wrong date.           *
      *             Reverse fix 229360.                               *
      *           - Applied for MD028339.                             *
      *  AR853123 - Amendment of Base Rate was not reflected          *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,DLH00036                                 *
      *             WNCPYSRC,DLH00037                                 *
      *             WNCPYSRC,DLH00038                                 *
      *             WNCPYSRC,DLH00039                                 *
      *             WNCPYSRC,DLH00040                                 *
      *             WNCPYSRC,DLH00041                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (recompiled)                                        *
      *  229360 - Ignore DEAMS record if amendment type = 'BR' and    *
      *           and FIXED deal type. Applied fix 221370.            *
      *  245960 - For SC deal amendment types, verify first if the    *
      *           value date is within telex notice before output to  *
      *           DAINDDL.                                            *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type                              *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  BUG4092- File DAUPDDI is defined with incorrect length       *
      *           after changes for CDL017 and CDL022.                *
      *  CDL022 - Deal Amendment Changes                              *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  CEU003 - EMU DL Settlement Currency Conversion:              *
     F*           New fields STCY (Settlement currency) and IC72 (In  *
     F*           Currency in field 72) added to input file DEAMS and *
     F*           also written out to file DAUPDDI. Check using call  *
     F*           to AOSARDR0 if SAR CEU003 is installed. Use the     *
     F*           settlement currency not the transaction currency    *
     F*           when calculating the telex notice date.             *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Suppress Rate Change Advices for Spread Change      *
     F*           deal amendments if there is no change in Interest   *
     F*           Spread/Rate.                                        *
     F*  091546 - Cover MT202's not being produced for deal amendments*
     F*           because CVMR not included in internal definition of *
     F*           file DEAMS, causing the value to be set to blanks   *
     F*           on output. Define posn 829 on DEAMS as CVMR.        *
     F*  096561 - Incorrect branch on some Deal amendment postings.   *
     F*  090645 - Payment message generated for back-valued           *
     F*           transaction. Check that value date is equal to or   *
     F*           later than next working day.                        *
     F*  081661 - Pay/Receive messages not being generated for deal   *
     F*           amendments where telex notice daye NE 0 in deal ccy.*
     F*  051496 - Output processing sequence to DAIND                 *
     F*  060528 - Ensure that the program would not output the        *
     F*           word 'AMENDMENT' on all deal amendment advices.     *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  E38323 - Recompilation of the program done due to a          *
     F*           change in ZFWDT subroutine                          *
     F*  S01354 - Add Internal Funding Deals                          *
     F*  E21923 - OUTPUT PAY/RECEIVE TELEX IF EVENT DATE LESS THAN    *
     F*           OR EQUAL TO (DNWD(DNWD)) -1 + TELEX NOTICE DAYS.    *
     F*  E21501 - 'LR' INDICATOR MISSING FROM LINE WHICH ADDS         *
     F*           2 TO FILE CONTROL FOR DAINDEX, CAUSING 2 TO         *
     F*           ADDED EVERY CYCLE. (DUPLICATE OF LN0353)            *
     F*  LN0353 - WAS ADDING 2 TO NO OF RECS (DAINDEX) FOR EVERY      *
     F*           RECORD READ INCLUDING HEADER AND TRAILER            *
     F*  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
     F*  E19743 - FILE CONTROLS IN DL1705 OUT OF BALANCE. THE         *
     F*           OUTPUT TO FILE DAINDEX (WHICH ACTS AS INPUT         *
     F*           TO DL1705) IS INCORRECT.                            *
     F*  S01227 - EXTENDED SETTLEMENTS INCORPORATION FIX              *
     F*  S01177 - TO REFLECT THE CHANGES MADE TO THE DEAL AND DEAL    *
     F*           AMENDMENTS FILES - CHANGES INVOLVE THE EXTENSION    *
     F*           OF THE FILES TO INCLUDE THE NEW SETTLEMENT FIELDS.  *
     F*  S01194 - NEW STANDING DATA - ADD ACCESS PROGRAMS             *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  S01195 - R10 - NEW HOLIDAY PROCESSING                        *
     F*  E10495 - INCORRECT RECORD BEING DROPPED FROM DEAL            *
     F*           AMENDMENTS FILE.                                    *
     F*  E43355 - INTEREST CAPITALISATION CONFS NOT PRODUCED          *
     F*  E10351 - IF REVERSED DEAL AMENDMENT WITH A VALUE DATE IN     *
     F*           THE FUTURE FILES GO OUT OFF BALANCE.                *
     F*  E47258 - D.B. ERROR IN EOD CONFS WHEN REV CONF IS PRINTED    *
     F*           AND RELATED DEAL HAS BEEN MATURED/DROPPED.          *
     F*                                                               *
     F*****************************************************************
0013 F*EAMS***IP**F*****200 14AI     2 DISK                               S01177
0013 F*EAMS***IP**F*****828 14AI     2 DISK                         S01177091546
0013 F***DEAMS***IP**F     829 14AI     2 DISK                     091546 CAC001
     F***********EAMS   IP  F     837 14AI     2 DISK              CAC001 CEU003
0013 F***DEAMS***IP  F     843 14AI     2 DISK                     CEU003 CDL006
     F***DEAMS** IP  F     877 14AI     2 DISK                                         CDL006 CGL029
     F***DEAMS** IP  F     933 14AI     2 DISK                                         CGL029BUG4092
     F*DEAMS***IP**F*****963*14AI*****2*DISK                                          BUG4092 CDL038
     F***DEAMS** IP  F     967 14AI     2 DISK                                       CDL038 AR853123
     FDEAMS   IP  F     985 14AI     2 DISK                                                 AR853123
0014 F*EALS***IF**F*****400  6AI     2 DISK                               S01117
0014 F*EALS***IF**F*****500  6AI     2 DISK                         S01117S01177
0014 F*EALS***IF**F****1048**6AI     2 DISK                         S01177S01227
0014 FDEALS   IF  F    1056  6AI     2 DISK                               S01227
0015 F**********TABLE   IF  F      96 12AI     2 DISK                     S01194
0016 F**********TABLED  IF  F      96 12AI     2 DISK                     S01194
     FSDCURRL1IF  E           K        DISK
     F/COPY WNCPYSRC,DL0264F001
0017 FDAUPDHH O   F     200            DISK                      A
     F*AUPDDI*O***F*****200************DISK                      A        S01177
     F*AUPDDI*O***F*****828************DISK                      A  S01177091546
     F***DAUPDDI*O***F     829            DISK                     091546 CAC001
     F******AUPDDI O   F     837            DISK               A   CAC001 CEU003
     F***DAUPDDI*O   F     843            DISK                   A CEU003 CDL006
     F***DAUPDDI O   F     877            DISK                      A                  CDL006 CGL029
     F***DAUPDDI O   F     933            DISK                      A                  CGL029BUG4092
     F*DAUPDDI*O***F*****963************DISK**********************A                   BUG4092 CDL038
     F***DAUPDDI O   F     967            DISK                      A                CDL038 AR853123
     FDAUPDDI O   F     985            DISK                      A                          AR853123
     FDAUPDDJ O   F     200            DISK                      A
0018 FDAINDHH O   F      40            DISK                      A
     FDAINDDL O   F      40            DISK                      A
     FDAINDEX O   F      40            DISK                      A
     FDL0264AUO   F     128     OF     PRINTER
0019 F*L0264P1O** F     128     OF     PRINTER                  S01124    S01117
0020 F*
0021 F* ID F  C  H  L    FUNCTION OF INDICATORS
0022 F*
0023 F******* 01            TABLE - INSTALLATION CONTROL DATA RECORD 1.   S01194
0024 F********02                  - INSTALLATION CONTROL DATA RECORD 2.   S01194
0025 F******* 03                  - INSTALLATION CONTROL DATA RECORD 5.   S01194
0026 F*********04                  - CURRENCIES RECORD 1.                 S01194
0027 F*********05                  - HOLIDAYS RECORD.                     S01194
0028 F* 06            DEAMS - HEADER.
0029 F* 07                  - DETAIL RECORD TYPE D.
0030 F* 08                  - DETAIL RECORD TYPE R.
0031 F* 09                  - TRAILER.
0032 F* 10                  - CATCHALL.
0033 F**11************DEALS - DETAIL RECORD - TYPE D,E OR M.              E47258
0033 F* 11            DEALS - DETAIL RECORD - TYPE D OR E.                E47258
0034 F* 12                  - DETAIL RECORD - TYPE R.
0035 F**13******************- TRAILER.                                    E47258
0034 F* 13                  - DETAIL RECORD - TYPE M.                     E47258
0036 F*
0037 F***************** 14      TABLE FILE READ INDICATOR.                S01194
0038 F*       20      WORK
0039 F*       21      AMENDMENT TYPE IS PI.
0040 F*       22      AMENDMENT TYPE IS PD.
0041 F*       23      AMENDMENT TYPE IS SI.
0042 F*       24      AMENDMENT TYPE IS SC.
0043 F*       25      AMENDMENT TYPE IS CI.
0044 F*       26      AMENDMENT TYPE IS PI,PD OR SC.
0045 F*       27      AMENDMENT TYPE IS SI OR CI.
0046 F*       28      TELEX IND. IS ON - DEAMS.
0047 F*       29      SETTLEMENT TYPE ON DEAMS IS 01,07,OR 08.
0048 F*       30      WORKING DAYS LE TELEX NOTICE DAYS - DEAL AMD. CCY.
0049 F*       31            '      LE       '      '    - LOCAL CCY.
0050 F*       32      COMMENCEMENT CONFIRMATION IND. IS ON - DEAMS
0051 F*       33      REVERSAL CONF. IND IS ON - DEAMS.
0052 F*       34      CONF. CONTROL IND IS ON - DEAMS.
0053 F********35***** MATURITY CONF. IND IS 'Y' IN ICDR5.                 S01194
0054 F********36******DEAL*TYPE*IS*IT,*IP,*TD,*TI,*CD,*CL*OR*DL.          S01354
0054 F*       36      DEAL TYPE IS IT, IP, TD, TI, CD, CL, DL, IL OR ID   S01354
0055 F*       37      WORKING DAYS TO MAT. GT 'MAT.CONFS.TO GO'- ICDR5.
0056 F*       38      PAY/REC REPORTING REQD
0057 F*       40      1ST CYCLE
0058 F*       41      FILE CONTROLS DIFFERENCE - DEAMS NO.OR VALUE.
0059 F*       42             '         '       - DAUPD NO.OF RECS.
0060 F*       60      OUTPUT TO DAIND.
0061 F*       61      OUTPUT TO DAUPD.
     F*       70      DEALING-TO-CHIPS INTERFACE
     F*       71      PAYCHP SR. WORK INDICATOR
     F*       72      PAYCHP SR. WORK INDICATOR
     F*       73      SUPPRESS CHIPS PAYMENT OUTPUT
0062 F*       76      CHAIN FAIL.
0063 F*
     E                    CPY@    1   1 80
0064 E*
0065 E********************DTPA    7   7  2               DEAL TYPES ARRAY S01354
0065 E***********         DTPA    9   9  2               DEAL TYPESS01354 CDL006
     E                    DTPA   15  15  2               DEAL TYPES ARRAY CDL006
     E/COPY WNCPYSRC,DL0264E001
0066 E**
0067 E                    HCCY       25  3               HOLIDAY CURENCIES
0068 E*
0069 E                    INT         3 15 0             INTEGER HASH
0070 E*
0071 E                    DEC         3  3 0             DECIMAL HASH
0072 E                    CCYA      150  3
0073 E                    TXDA      150  5 0
     E*                                                                   S01195
     E** Calculation of number of working days forward from today         S01195
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     I*                                                                   S01194
0075 I********                                                            S01194
0076 I******** TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.           S01194
0077 I********                                                            S01194
0078 I********TABLE   NS  01   2 C0   3 C1  12 C1                         S01194
0079 I********       AND      13 C0                                       S01194
0080 I********                                        1   1 RECI          S01194
0081 I********                                        2   30RECT          S01194
0082 I********                                       12  130RCDE          S01194
0083 I********                                       14  66 TITL          S01194
0084 I********                                       67  67 DATF          S01194
0085 I*****                                  68  700DFBR                  S01194
     I********                                       68  70 DFBM   S01117 S01194
     I********                                       72  72 CHIM          S01194
0086 I********                                       74  74 MODI1         S01194
0087 I********                                       75  75 MODI2         S01194
0088 I********                                       76  76 MODI3         S01194
0089 I********                                    P  77  790RUND          S01194
0090 I********                                       80  86 RUNA          S01194
0091 I********                                       87  870SFLG          S01194
0092 I********                                    P  90  920LCD           S01194
0093 I********                                       93  93 CHTP          S01194
0094 I********                                    P  94  960TNLU          S01194
0095 I*********                                                           S01194
0096 I*********                                                           S01194
0097 I*********    TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.       S01194
0098 I*********                                                           S01194
0099 I********        NS  02   1 CD   2 C0   3 C1                         S01194
0100 I********       AND      12 C1  13 C1                                S01194
0101 I********                                        1   1 RECI          S01194
0102 I********                                        2   30RECT          S01194
0103 I********                                       12  130RCDE          S01194
0104 I********                                       14  16 BCCY          S01194
0105 I********                                       17  19 BCYL          S01194
0106 I********                                       20  22 HOCY          S01194
0107 I********                                       23  280HEAD          S01194
0108 I********                                    P  29  310APDA          S01194
0109 I********                                       35  35 APFQ          S01194
0110 I********                                    P  36  380LOGS          S01194
0111 I********                                       39  40 CUZR          S01194
0112 I********                                    P  41  430DNWD          S01194
0113 I********                                       44  460BVLP          S01194
0114 I********                                       47  49 LOCY          S01194
0115 I********                                       50  510FDAY          S01194
0116 I********                                       86  86 ISAV          S01194
0117 I********                                    P  87  890LLOG          S01194
0118 I********                                    P  90  920LCD           S01194
0119 I********                                       93  93 CHTP          S01194
0120 I********                                    P  94  960TNLU          S01194
0121 I*********                                                           S01194
0122 I*********                                                           S01194
0123 I*********    TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       S01194
0124 I*********                                                           S01194
0125 I********        NS  03   1 CD   2 C0   3 C1                         S01194
0126 I********       AND      12 C4  13 C0                                S01194
0127 I********                                        1   1 RECI          S01194
0128 I********                                        2   30RECT          S01194
0129 I********                                       12  130RCDE          S01194
0130 I********                                       18  210CSAC          S01194
0131 I********                                       22  22 TLII          S01194
0132 I********                                       23  23 MCRI          S01194
0133 I********                                    P  24  250MCEP          S01194
0134 I********                                       26  270MCLP          S01194
0135 I********                                       28  28 FRDI          S01194
0136 I********                                       29  29 BRCF          S01194
0137 I********                                       30  350PSCN          S01194
0138 I********                               36  380DLBR           S01117 S01194
0138 I********                                       36  38 DLBR   S01117 S01194
0139 I********                                       39  420FRPA          S01194
0140 I********                                       43  460FRPC          S01194
0141 I********                                       47  49 USCY          S01194
0142 I********                                       50  52 STCY          S01194
0143 I********                                    P  53  553MBGE          S01194
0144 I********                                    P  90  920LCD           S01194
0145 I********                                       93  93 CHTP          S01194
0146 I********                                    P  94  960TNLU          S01194
0147 I*********                                                           S01194
0148 I*********                                                           S01194
0149 I***********   INPUT SPECS. FOR HOLIDAYS TABLE MOVED ABOVE THOSE     S01194
0150 I*********    TABLE FILE - HOLIDAY RECORD.                           S01194
0151 I*********       E-EXCLUDE, I-INCLUDE.                               S01194
0152 I*********                                                           S01194
0153 I********        NS  05   1 CD   2 C2   3 C2                         S01194
0154 I********       AND      14 CE                                       S01194
0155 I********       OR   05   1 CD   2 C2   3 C2                         S01194
0156 I********       AND      14 CI                                       S01194
0157 I********                                        1   1 RECI          S01194
0158 I********                                        2   30RECT          S01194
0159 I********                                        8  120HOL           S01194
0160 I********                                       13  130SREC          S01194
0161 I********                                       14  14 INEX          S01194
0162 I********                                       15  89 HCCY          S01194
0163 I********                                    P  90  920LCD           S01194
0164 I********                                       93  93 CHTP          S01194
0165 I********                                    P  94  960TNLU          S01194
0166 I*********                                                           S01194
0167 I*********                                                           S01194
0168 I**********                                                          S01194
0169 I**********   CATCHALL.                                              S01194
0170 I********        NS                                                  S01194
0171 I********                                        1   1 RECI          S01194
0172 I**********                                                          S01194
0173 I**********                                                          S01194
0174 I*********    TABLE FILE - CURRENCIES RECORD 1.                      S01194
0175 I*********                                                           S01194
0176 I********TABLED  NS  04   1 CD   2 C2   3 C0                         S01194
0177 I********       AND      13 C1                                       S01194
0178 I********                                        1   1 RECI          S01194
0179 I********                                        2   30RECT          S01194
0180 I********                                       10  12 CCY           S01194
0181 I********                                       13  130SREC          S01194
0182 I********                                       14  27 CCNM          S01194
0183 I********                                    P  28  348SPOT          S01194
0184 I********                                       35  37 CCYS          S01194
0185 I********                                       38  380CDP           S01194
0186 I********                                       39  390TNOT          S01194
0187 I********                                       40  40 DCCY          S01194
0188 I********                                       41  44 SRC1          S01194
0189 I********                                       45  48 SRC2          S01194
0190 I********                                       49  520TACC          S01194
0191 I********                                       53  560TEQV          S01194
0192 I********                                       57  600SWQV          S01194
0193 I********                                       61  640TAC4          S01194
0194 I********                                       65  680TAC5          S01194
0195 I********                                       69  69 HIND          S01194
0196 I********                                    P  70  768PART          S01194
0197 I********                                       77  780SSNO          S01194
0198 I********                                    P  79  858ERLC          S01194
0199 I********                                    P  90  920LCD           S01194
0200 I********                                       93  93 CHTP          S01194
0201 I********                                    P  94  960TNLU          S01194
0202 I*********                                                           S01194
0203 I*********                                                           S01194
0204 I*********   CATCHALL.                                               S01194
0205 I*********                                                           S01194
0206 I********        NS                                                  S01194
0207 I********                                        1   1 RECI          S01194
0208 I*********                                                           S01194
0209 I*
0210 I*    DEALS AMENDMENT FILE - HEADER.
0211 I*
0212 IDEAMS   NS  06   1 CA
0213 I                                        1 200 LOT
0214 I*
0215 I*
0216 I*    DEALS AMENDMENT FILE - DETAIL RECORD.
0217 I*
0218 I        NS  07   1 CD
0219 I       OR   08   1 CR
0220 I                                        1   1 RECI
0221 I                                        2   70DLNO
0222 I                                        8  120VDAT
0223 I                                       13  150DASN
0224 I                                       16  17 DTYP
0225 I                                       18  19 DLST
0226 I                                       20  21 AMTP
0227 I                                       22  220PSEQ
0228 I                                       23  240BRTT
0229 I                                    P  25  307RTSP
0230 I                                       31  33 CCY
0231 I                                    P  34  400DAAM
0232 I                                       41  41 MOGI
0233 I**********                             42  470CNUM                                      CSD027
0233 I                                       42  47 CNUM                                      CSD027
0234 I                                       48  490SETP
0235 I**********                             50  61 OSAC                                      CGL029
     I                                       50  61 OSACQQ                                    CGL029
0236 I                                       62  71 TSEN
0237 I                                       72  81 FACO
0238 I                                       82 116 SPI
0238 I                                      117 119 OSBR                  S01117
     I*******************************       120 122 BRCA                  S01117
     I                                      120 122 BRCA                  096561
0239 I                                    P 139 1410NAAD
0240 I                                      142 1440NASN
0241 I                                      145 145 DAIN
0241 I                                    P 189 1900LSWC                  S01177
0242 I                                    P 191 1930ORED
0243 I                                    P 194 1960LCD
0244 I                                      197 197 CHTP
0245 I                                    P 198 2000TNLU
0244 I                                      201 2020RSTM                  S01177
0244 I**********                            203 214 RONS                               S01177 CGL029
     I                                      203 214 RONSQQ                                    CGL029
0244 I                                      215 222 RIBN                  S01177
0244 I                                      223 257 RIBA                  S01177
0244 I**********                            258 2630ROBN                               S01177 CSD027
0244 I**********                            264 2690ROCN                               S01177 CSD027
0244 I                                      258 263 ROBN                                      CSD027
0244 I                                      264 269 ROCN                                      CSD027
0244 I                                      270 2710PSTM                  S01177
0244 I**********                            272 283 PONS                               S01177 CGL029
     I                                      272 283 PONSQQ                                    CGL029
0244 I                                      284 291 PIBN                  S01177
0244 I                                      292 326 PIBA                  S01177
0244 I**********                            327 3320POBN                               S01177 CSD027
0244 I**********                            333 3380POCN                               S01177 CSD027
0244 I                                      327 332 POBN                                      CSD027
0244 I                                      333 338 POCN                                      CSD027
0244 I                                      339 346 RCRN                  S01177
0244 I                                      347 381 RCRA                  S01177
0244 I                                      382 389 RVNO                  S01177
0244 I                                      390 397 AWBN                  S01177
0244 I                                      398 432 AWBA                  S01177
0244 I                                      433 440 BENN                  S01177
0244 I                                      441 475 BENA                  S01177
0244 I                                      476 510 DTP1                  S01177
0244 I                                      511 545 DTP2                  S01177
0244 I                                      546 580 DTP3                  S01177
0244 I                                      581 615 DTP4                  S01177
0244 I                                      616 618 DCHG                  S01177
0244 I                                      619 653 BTB1                  S01177
0244 I                                      654 688 BTB2                  S01177
0244 I                                      689 723 BTB3                  S01177
0244 I                                      724 758 BTB4                  S01177
0244 I                                      759 793 BTB5                  S01177
0244 I                                      794 828 BTB6                  S01177
     I                                      829 829 CVMR                  091546
     I                                    P 830 8357FSRP                  CAC001
     I                                      836 836 IRCF                  CAC001
     I                                      837 837 FRCF                  CAC001
     I                                      838 840 STCY                  CEU003
     I                                      841 843 IC72                  CEU003
     I                                      844 845 FCGC                  CDL006
     I                                      846 865 FCGD                  CDL006
     I                                    P 866 8720FCGA                  CDL006
     I                                    P 873 8770FCGT                  CDL006
     I                                      880 897 OSAC                                      CGL029
     I                                      898 915 RONS                                      CGL029
     I                                      916 933 PONS                                      CGL029
     I                                    P 968 9737CNSP                                    AR853123
     I                                      974 974 CNSG                                    AR853123
     I                                      975 981 RDMT                                    AR853123
     I                                      982 985 RDFD                                    AR853123
0246 I****************************************1 200 LOT                   S01177
0246 I****************************************1 828 LOTX            S01177091546
0246 I***********                             1 829 LOTX           091546 CAC001
     I***********                             1 837 LOTX           CAC001 CEU003
0246 I***********                             1 843 LOTX           CEU003 CDL006
     I**********                              1 877 LOTX                               CDL006 CGL029
     I**********                              1 933 LOTX                               CGL029BUG4092
     I****************************************1 963 LOTX                              BUG4092 CDL038
     I**********                              1 967 LOTX                             CDL038 AR853123
     I                                        1 985 LOTX                                    AR853123
0247 I*
0248 I*
0249 I*    DEALS AMENDMENT FILE - TRAILER RECORD.
0250 I*
0251 I        NS  09   1 CT
0252 I                                        1   1 RECI
0253 I                                        2   70DLNO
0254 I                                        8  120VDAT
0255 I                                       13  150DASN
0256 I                                    P  16  180NORE
0257 I                                    P  19  210FLSZ
0258 I                                    P  22  240NLRB
0259 I                                    P  25  270NINS
0260 I                                    P  28  300NIPR
0261 I                                    P  31  330NDPR
0262 I                                    P  34  360NDEL
0263 I                                    P  37  390NLRA
0264 I                                    P  40  470VLBF
0265 I                                    P  48  490VLBL
0266 I                                    P  50  570VRIF
0267 I                                    P  58  590VRIL
0268 I                                    P  60  670VRDF
0269 I                                    P  68  690VRDL
0270 I                                    P  70  770VIPF
0271 I                                    P  78  790VIPL
0272 I                                    P  80  870VDPF
0273 I                                    P  88  890VDPL
0274 I                                    P  90  970VLAF
0275 I                                    P  98  990VLAL
0276 I                                    P 194 1960LCD
0277 I                                      197 197 CHTP
0278 I                                    P 198 2000TNLU
0279 I*
0280 I*    CATCHALL.
0281 I*
0282 I        NS  10
0283 I*
0284 I*
0285 I*    DEALS FILE - DETAIL RECORD.
0286 I*
0287 IDEALS   NS  11   1 CD
0288 I       OR   11   1 CE
0289 I***    OR   11   1 CM                                               E47258
0290 I       OR   12   1 CR
0290 I       OR   13   1 CM                                               E47258
0291 I                                       20  21 DTYP
     I                                        9  100RCDC
     I                                    P  30  320MDAT                  E47258
     I/COPY WNCPYSRC,DL0264I002
0292 I*
0293 I        NS
     I*                                                                   S01195
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*                                                                   S01195
     I* External data descriptions for SD file accesses.                  S01194
     I*                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
     I*                                                                   S01194
     ISDDEAL    E DSSDDEALPD                                              S01194
     I*                                                                   S01194
     ISDMMOD    E DSSDMMODPD                                              S01194
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I/COPY WNCPYSRC,DL0264I001
     I*                                                                   S01195
     I/COPY ZSRSRC,ZHOLDS                                                 S01195
     I*                                                                   S01117
     I/EJECT                                                              S01194
0296 C*
0297 C*    FIRST CYCLE PROCESSING.
0298 C   40                GOTO ENDFC
0299 C                     SETON                     40
     C                     MOVEACPY@      BIS@   80
0300 C**********
0301 C**********  ACCESS INSTALLATION CONTROL DATA RECORD 1.
0302 C**********           EXSR ZSYSTM
     C*
     C*                                                                   S01194
     C* Obtain bank details using access object                           S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                     B1             S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        ************   S01194
     C                     MOVE '01'      DBASE   3        * DBERR 01 *   S01194
     C                     MOVEL@OPTN     DBKEY  29        ************   S01194
     C                     MOVEL@OPTN     DBOPTN  7        *1             S01194
     C                     EXSR *PSSR                      *1             S01194
     C                     END                             E1             S01194
     C*                                                                   S01194
     C* Obtain module details using access object                         S01194
     C*                                                                   S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                     B1             S01194
     C                     MOVE 'SDMMODPD'DBFILE           ************   S01194
     C                     MOVE '02'      DBASE            * DBERR 02 *   S01194
     C                     MOVE @OPTN     DBKEY            ************   S01194
     C                     MOVEL@OPTN     DBOPTN  7        *1             S01194
     C                     EXSR *PSSR                      *1             S01194
     C                     END                             E1             S01194
     C*                                                                   S01194
     C* Obtain dealing details using access object                        S01194
     C*                                                                   S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C*                                                                   S01194
     C           @RTCD     IFNE *BLANK                     B1             S01194
     C                     MOVE 'SDDEALPD'DBFILE           ************   S01194
     C                     MOVE '03'      DBASE            * DBERR 03 *   S01194
     C                     MOVE @OPTN     DBKEY            ************   S01194
     C                     MOVEL@OPTN     DBOPTN  7        *1             S01194
     C                     EXSR *PSSR                      *1             S01194
     C                     END                             E1             S01194
      *                                                                   CEU003
      ** Access AOSARDR0 to check if CEU003 is installed                  CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   @RTCD   7                       CEU003
     C                     PARM '*VERIFY' @OPTN   7                       CEU003
     C                     PARM 'CEU003'  @SARD   6                       CEU003
      *                                                                   CEU003
     C           @RTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     END                                            CEU003
     C/COPY WNCPYSRC,DL0264C005
     C*
     C*    CHIPS INTERFACE TEST
     C**********           TESTB'0'       CHIM           70-IS PRESENT    S01194
     C*                                                                   S01194
     C** Check to see if dealing/chips interface is present               S01194
     C           BGCHDL    IFEQ 'Y'                        B1             S01194
     C                     MOVE '1'       *IN70            *1             S01194
     C                     END                             E1             S01194
0303 C**********                                                          S01194
0304 C**********  ACCESS INSTALLATION CONTROL DATA RECORD 2.              S01194
0305 C**********           MOVEL'01      'TABKEY 12                       S01194
0306 C**********           MOVE '  11'    TABKEY                          S01194
0307 C**********           EXSR TABCHN                                    S01194
0308 C**********                                                          S01194
0309 C**********  ACCESS INSTALLATION CONTROL DATA RECORD 5.              S01194
0310 C**********           MOVE '  40'    TABKEY                          S01194
0311 C**********           EXSR TABCHN                                    S01194
     C******* IGNORE MCRI SINCE IT ONLY CONDITIONS SETON OF *IN35         S01194
     C******* & THEN DOESN'T REFER TO *IN35 AGAIN.                        S01194
0312 C********** MCRI      COMP 'Y'                      35               S01194
0313 C*
     C*    DETERMINE DATE OF NEXT NEXT WORKING DAY.                       E21923
     C*                                                                   E21923
     C/COPY WNCPYSRC,DLH00036
     C                     Z-ADDBJDNWD    ZDAYNO                          E21923
     C                     Z-ADD1         ZNRDYS                          E21923
     C                     MOVE BJLCCY    ZCCY                            E21923
     C                     EXSR ZFWDT                                     E21923
     C           ZDYNBR    SUB  1         ZDAYNO                          E21923
     C/COPY WNCPYSRC,DLH00037
     C*                                                                   E21923
0314 C*    ACCESS LOCAL CURRENCY RECORD AND STORE TELEX NOTICE DAYS.
0317 C*                                                                   S01194
0318 C**   SETLL FOR CURRENCIES TABLE                                     S01194
     C**   Load currencies array by reading through currencies
     C**
     C**********           MOVEL'20      'TABKEY                          S01194
0320 C**********           MOVE '       1'TABKEY                          S01194
0321 C********** TABKEY    SETLLTABLED                                    S01194
     C           *LOVAL    SETLLSDCURRL1                                  S01194
0322 C                     Z-ADD0         C       30
0323 C**********           Z-ADDDNWD      ZDAYNO                          S01194
     C*********************Z-ADDBJDNWD    ZDAYNO                    S01194E21923
0324 C           READ      TAG                             * READ TAG *
0325 C**********           SETOF                     0414                 S01194
0325 C                     SETOF                       14                 S01194
0326 C**********           READ TABLED                   14               S01194
     C                     READ SDCURRL1                 14               S01194
0327 C**N04N14***RECI***** COMP 'H'                      14               S01194
0328 C   14                GOTO SETFC
0329 C**N04*******         GOTO READ                                      S01194
0329 C**********           GOTO READ                                S01194081661
0330 C           C         ADD  1         C
0331 C**********           MOVE CCY       CCYA,C                          S01194
0331 C                     MOVE A6CYCD    CCYA,C                          S01194
0332 C**********           Z-ADDTNOT      ZNRDYS                          S01194
0332 C                     Z-ADDA6TXND    ZNRDYS                          S01194
0333 C**********           MOVE CCY       ZCCY                            S01194
0333 C                     MOVE A6CYCD    ZCCY                            S01194
0334 C**********           EXSR ZTXDAY                                    S01195
     C/COPY WNCPYSRC,DLH00038
0334 C                     EXSR ZFWDT                                     S01195
0335 C                     Z-ADDZDYNBR    TXDA,C
     C/COPY WNCPYSRC,DLH00039
0336 C                     GOTO READ
0337 C           SETFC     TAG                             * SETFC TAG *
0338 C                     Z-ADD1         C
0339 C********** LOCY      LOKUPCCYA,C                   14               S01194
0339 C           BJLCCY    LOKUPCCYA,C                   14               S01194
0340 C                     Z-ADDTXDA,C    TXDL    50
0341 C**********           Z-ADDMCLP      ZNRDYS                          S01194
0341 C                     Z-ADDBNMCTG    ZNRDYS                          S01194
0342 C**********           MOVE LOCY      ZCCY                            S01194
0342 C                     MOVE BJLCCY    ZCCY                            S01194
0343 C**********           EXSR ZTXDAY                                    S01194
0343 C                     EXSR ZFWDT                                     S01194
0344 C                     Z-ADDZDYNBR    MCLD    50
0345 C*    SET UP OUTPUT FIELDS FOR DAUPD.
0346 C                     Z-ADD0         ZERO3   30
0347 C                     Z-ADD0         ZERO5   50
0348 C                     Z-ADD0         ZERO15 150
0349 C*
     C*
     C/COPY WNCPYSRC,DL0264C002
0350 C******************************************
0351 C**
0352 C*    END OF FIRST CYCLE PROCESSING.
0353 C*
0354 C           ENDFC     TAG                             ** ENDFC TAG **
0355 C*
0356 C*    RESET OUTPUT INDICATORS.
0357 C                     SETOF                     606138
0358 C                     SETOF                     62
0358 C                     SETOF                     20                   E47258
0359 C*
0360 C**   NO DETAIL PROCESSING FOR HEADER,TRAILER OR CATCHALL.
0361 C   06
0362 COR 09
0363 COR 10                GOTO TOTALS
     C**********                                               /*E47258*/ E10495
     C***IGNORE*DEAMS REC IF DEAL MATURED/DROPPED              /*E47258*/ E10495
     C*  08 76                                                 /*E47258*/ E10495
     C*R 08 13             GOTO TOTALS                         /*E47258*/ E10495
0364 C**
0365 C**   ACCESS RELATED DEAL.
0366 C                     SETOF                     1112
     C/COPY WNCPYSRC,DL0264C006
0367 C           DLNO      CHAINDEALS                76
     C*                                                                   E10495
     C** IGNORE DEAMS REC IF DEAL MATURED/DROPPED                         E10495
     C/COPY WNCPYSRC,DL0264C007
     C   08 76                                                            E10495
     COR 08 13             GOTO TOTALS                                    E10495
0368 C**
0369 C**   IGNORE DEAMS RECORD IF BOTH DEALS &
0370 C**   DEAMS RECORDS REVERSED.
0371 C   08 12             GOTO TOTALS
      *****************************************************************              229360 MD026719
      ***Ignore*DEAMS*record*if*amendment*type*=*'BR'*and*fixed*deal***              229360 MD026719
      ***type*(IP,*IT,*TD,*TI,*CI)*************************************              229360 MD026719
      *****************************************************************              229360 MD026719
     C********** AMTP      IFEQ 'BR'                                                 229360 MD026719
     C********** DTYP      IFEQ 'IP'                                                 229360 MD026719
     C********** DTYP      OREQ 'IT'                                                 229360 MD026719
     C********** DTYP      OREQ 'TD'                                                 229360 MD026719
     C********** DTYP      OREQ 'TI'                                                 229360 MD026719
     C********** DTYP      OREQ 'CI'                                                 229360 MD026719
     C**********           GOTO TOTALS                                               229360 MD026719
     C**********           ENDIF                                                     229360 MD026719
     C**********           ENDIF                                                     229360 MD026719
0372 C**
0373 C**   ELSE OUTPUT RECORD TO DAUPD.
0374 C                     SETON                     61
0375 C**   IF DEAMS RECORD REVERSED, CHECK CONF.
0376 C**   REQUIREMENT ONLY.
0377 C   08                GOTO TAG01
0378 C**
0379 C*
0380 C******************************************
0381 C*
0382 C*    PAY/RECEIVE REPORTING REQUIREMENT.
0383 C**
0384 C**   ONLY REQD. IF AMD.TYPE IS PI,PD OR SI
0385 C**
0386 C*
0387 C*    CHECK AMENDMENT TYPE.
0388 C                     EXSR ATCHK
0389 C  N21N22N23          GOTO TAG01                      NOT PI,PD,SI
0390 C*
0391 C*    CHECK TELEX INDICATOR - NO P/R REPORTING IF ON.
0392 C                     TESTB'1'       DAIN           28
0393 C   28                GOTO TAG01                      ON
0394 C*
0395 C***  CALCULATE NO. OF WORKING DAYS FROM RUN DATE TO VALUE DATE.
0396 C*****
0397 C*****IF GT TELEX NOTICE DAYS FOR LOCAL CCY NO P/R REQD.
0398 C**
     C*                                                                   CEU003
     C*** Use settlement currency not transaction currency when           CEU003
     C*** calculating the telex notice date.                              CEU003
     C*                                                                   CEU003
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C                     MOVE STCY      W#CCY   3                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVE CCY       W#CCY                           CEU003
     C                     ENDIF                                          CEU003
0399 C*    CHECK SETTLEMENT TYPE.
0400 C           SETP      COMP 01                       29
0401 C  N29      SETP      COMP 07                       29
0402 C  N29      SETP      COMP 08                       29
0403 C   29                Z-ADD1         C
0404 C***29******CCY       LOKUPCCYA,C                   14               CEU003
0404 C   29      W#CCY     LOKUPCCYA,C                   14               CEU003
0405 C   29                Z-ADDTXDA,C    TXD     50
0406 C  N29                Z-ADDTXDL      TXD
0407 C           VDAT      COMP TXD                    6060
0408 C**
      * Do not generate message for back-valued transaction               090645
     C/COPY WNCPYSRC,DLH00040
     C           VDAT      IFLT BJDNWD                                    090645
     C/COPY WNCPYSRC,DL0264C001
     C                     MOVE *OFF      *IN60                           090645
     C                     ENDIF                                          090645
     C/COPY WNCPYSRC,DLH00041
      *                                                                   090645
0409 C**   SETT.TYPE IS 01,07,08 - CHECK TX NOTICE DAYS IN DEAL
0410 C**   AMENDMENT CCY.
0411 C**
0412 C*    ACCESS CCY RECORD OF DEAL AMENDMENT CURRENCY.
     C*
     C   60 70             EXSR PAYCHP                     NO O/P IF CHIPS
     C   60 70 73          SETOF                       60  PAY, WRONG DAY
     C*
0413 C   60                BITON'1'       DAIN
0414 C   60                SETON                       38
0415 C*
0416 C******************************************
0417 C*
0418 C*    CONFIRMATION REPORTING REQUIREMENT.
0419 C*
0420 C           TAG01     TAG                             ** TAG01 TAG **
0421 C**
0422 C**   TEST COMMENCEMENT CONF. IND.
0423 C                     TESTB'2'       DAIN           32
     C**                                                                  E47258
     C** IGNORE DEAMS REC IF DEAMS REVERSED & COMM. CONF. NOT PRINTED     E47258
     C**                                    & DEAL BEING MATURED          E47258
     C***08******MDAT      COMP DNWD                   20           E47258S01194
     C*                                                                   S01194
     C** Test to see if maturity date is before the next working day.     S01194
     C   08      MDAT      COMP BJDNWD                 20           E47258S01194
     C   08 20N32          GOTO TOTALS                                    E47258
0424 C**
0425 C**   DETERMINE TYPE OF AMENDMENT.
0426 C                     EXSR ATCHK
0427 C*
0428 C**   AMD. TYPE IS SI OR CI.
0429 C*
0430 C  N27                GOTO TAG03
0431 C           DTYP      LOKUPDTPA                     36
0432 C           VDAT      COMP MCLD                   3737
     C**                                                                  E47258
     C** VALUE DATE OK IF DEAMS REVERSED & DEAL BEING MATURED             E47258
     C   08 20             SETON                       37                 E47258
0433 C***32                                                               E47258
     C   32 07                                                            E47258
0434 CORN36
0445 C**   DISREGARD 'MATURITY CONF REQUIRED' INDICATOR                   E43355
0435 C*RN35****                                                           E43355
0436 CORN37                GOTO TOTALS
0437 C*
0438 C                     TESTB'7'       DAIN           34
0439 C***                  SETON                     6062                 E47258
     C   07                                                               E47258
     COR 08 32             SETON                     6062                 E47258
0440 C*
0441 C                     GOTO SET
0442 C*
0443 C*
0444 C*
0445 C**   AMD. TYPE IS PI, PD OR SC.
0446 C**   CONF. REQD. IF -  RECI IS 'D' & COMMENCEMENT CONF.IND. IS OFF
0447 C**                  -  RECI IS 'R', REVERSAL CONF. IND.IS OFF &
0448 C**                     CONF. CONTROL IND. IS ON.
0449 C**
0450 C*
0451 C           TAG03     TAG                             ** TAG03 TAG **
0452 C*
0453 C  N26                GOTO TOTALS                     NOT PI,PD,SC
     C*                                                                   CAC001
     C** If amendment type is SC and Interest Spread/Rate is unchanged    CAC001
     C** then do not output to DAINDDL                                    CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           AMTP      ANDEQ'SC'                                      CAC001
     C           IRCF      ANDNE'Y'                                       CAC001
     C                     GOTO TOTALS                                    CAC001
     C                     END                                            CAC001
     C*                                                                   CAC001
      ** If SC deal amendment is not within telex notice days  do not                         245960
      ** output to DAINDDL.  Use transaction ccy to verify.                                   245960
      *                                                                                       245960
     C           AMTP      IFEQ 'SC'                                                          245960
     C           AMTP      OREQ 'EM'                                                        AR598353
     C           AMTP      OREQ 'BC'                                                        MD050459
     C                     MOVE CCY       W#CCY                                               245960
     C                     Z-ADD1         C                                                   245960
     C           W#CCY     LOKUPCCYA,C                   14                                   245960
     C                     Z-ADDTXDA,C    TXD     50                                          245960
     C           VDAT      IFGT TXD                                                           245960
     C                     GOTO TOTALS                                                        245960
     C                     ENDIF                                                              245960
     C                     ENDIF                                                              245960
      *                                                                                       245960
0454 C                     TESTB'3'       DAIN           33
0455 C                     TESTB'7'       DAIN           34
0457 C   07N32
0458 COR 08N33 34          SETON                     6062
0459 C*
0460 C******************************************
0461 C**
0462 C**   SET CONF. INDS ON DAUPD.
0463 C           SET       TAG                             ** SET **
     C/COPY WNCPYSRC,DL0264C008
0464 C   07                BITON'27'      DAIN
0465 C   08                BITON'3'       DAIN
0466 C**
0467 C******************************************
0468 C*
0469 C*    MAINTAIN RECORD COUNT TOTALS.
0470 C**
0471 C           TOTALS    TAG                             ** TOTALS TAG *
     C/COPY WNCPYSRC,DLH00138
0472 C**   DEAMS RECS.NOT BROUGHT FORWARD.
0474 C***08 12   RNBF      ADD  1         RNBF    50                      E47258
0474 C*  08N11   RNBF      ADD  1         RNBF    50            /E47258/  E10351
0474 C   08N61   RNBF      ADD  1         RNBF    50                      E10351
0475 C**
0476 C**   TOTAL NO.RECS. ON DAUPD.
0477 C   06
0478 COR 09
0479 COR 61      DNORE     ADD  1         DNORE   50
0480 C**
0481 C**   NO LIVE RECORDS ON DAUPD - D.
0482 C   61 07   DNLRA     ADD  1         DNLRA   50
0483 C**
0484 C**   TOTAL NO.RECS. ON DAIND.
0485 C***06******                                                         E19743
0486 C*R*09******                                                         E19743
0487 C*R*60******NOREI     ADD  1         NOREI   50                      E19743
0487 C   60      NOREI     ADD  1         NOREI   50                      E19743
0488 C*
0489 C*    MAINTAIN HASH TOTALS - DAUPD.
0490 C   07 61 21          Z-ADD2         X       10
0491 C   07 61 21          EXSR HASH
0492 C   07 61 22          Z-ADD3         X
0493 C   07 61 22          EXSR HASH
     C/COPY WNCPYSRC,DL0264C003
0494 C**
0495 C           END       TAG                             ** END TAG **
0496 C**
0497 C******************************************
0498 C**
0499 C**   LR - FILE CONTROL CALCULATIONS.
0500 C**
     C**   ADD TWO TO TOTAL RECS IN DAIND: ONE FOR HEADER AND ONE         E19743
     C**   FOR TRAILER.                                                   E19743
     C************         ADD  2         NOREI                    E19743 LN0353
     CLR                   ADD  2         NOREI                           LN0353
0501 C**   DEAMS - COMPARE NO.OF LIVE RECS.AFTER I/C ON TRAILER TO NO.
0502 C**   OF LIVE RECS.CALCULATED.
0503 C**
0504 C**   CALC.NO.OF LIVE RECORDS - NORE + NINS - NDEL.
0505 C**
0506 CLR         NLRB      ADD  NINS      NLRAD   50
0507 CLR         NLRAD     SUB  NDEL      NLRAD
0508 C**
0509 CLR         NLRA      COMP NLRAD                4141
0510 CLR 41                GOTO NXTLR
0511 C**
0512 C**   DEAMS - VALUE OF CURRENT RECS - VLBF + VRIF - VRDF.
0513 CLR                   Z-ADDVLBF      ZZTOTI
0514 CLR                   Z-ADDVLBL      ZZTOTD
0515 CLR                   Z-ADDVRIF      ZZAMTI
0516 CLR                   Z-ADDVRIL      ZZAMTD
0517 CLR                   EXSR GLZSUM
0518 CLR                   Z-SUBVRDF      ZZAMTI
0519 CLR                   Z-SUBVRDL      ZZAMTD
0520 CLR                   EXSR GLZSUM
0521 CLR                   Z-ADDZZTOTI    INT,1
0522 CLR                   Z-ADDZZTOTD    DEC,1
0523 C**
0524 C**   COMPARE TO FILE VALUES.
0525 CLR                   Z-ADDVLAF      ZZINT
0526 CLR                   Z-ADDVLAL      ZZDEC
0527 CLR                   EXSR GLZCMP
0528 CLR         ZZDIFI    COMP 0                    4141
0529 CLRN41      ZZDIFD    COMP 0                    4141
0530 C**
0531 CLR         NXTLR     TAG                             ** NXTLR **
0532 C**
0533 C**   DAUPD - COMPARE TOTAL NO.OF RECS. ON DEAMS WITH SUM OF RECS.
0534 C**   NOT BROUGHT FORWARD + TOTAL NO.OF RECS. ON DAUPD.
0535 C**
0536 CLR         RNBF      ADD  DNORE     TOT     50
0537 CLR         TOT       COMP NORE                 4242
0538 C**
0539 CLR 41
0540 COR 42                SETON                     U8
0542 C********************************************************************S01194
0543 C**********                                                          S01194
0544 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0545 C**********                                                          S01194
0546 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0547 C**********                                                          S01194
0548 C**********  SET UP KEY FOR INSTALLATION CONTROL RECORD.             S01194
0549 C**********           MOVEL'01      'ZTABKY 12                       S01194
0550 C**********           MOVE '  10'    ZTABKY                          S01194
0551 C**********                                                          S01194
0552 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0553 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0554 C**********                                                          S01194
0555 C**********   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            S01194
0556 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0557 C**********                                                          S01194
0558 C**********           ENDSR                                          S01194
0559 C**********                                                          S01194
0560 C**********                                                          S01194
0569 C********************************************************************
0570 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0571 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0572 C*
0573 C           GLZADD    BEGSR                           *** GLZADD ****
0574 C*
0575 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0576 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0577 C*
0578 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0579 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0580 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0581 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0582 C*
0583 C                     EXSR GLZSUM
0584 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
0585 C*
0586 C********************************************************************
0587 C* SUBROUTINE TO COMPARE AN AMOUNT TO THE TOTAL.
0588 C*      PARAMETERS. I/P - ZZINT - THE INTEGER PORTION OF THE NUMBER.
0589 C*                  I/P - ZZDEC - THE DECIMAL PORTION OF THE NUMBER.
0590 C*                  O/P - ZZDIFI - IS THE INTEGER DIFFERENCE.
0591 C*                  O/P - ZZDIFD - IS THE DECIMAL DIFFERENCE.
0592 C*                  O/P - ZZNEGD - FOR IMMEDIATE PRINTING ONLY.
0593 C*                  O/P - 96 IS SET IF DIFFERENCE IS NEGATIVE.
0594 C*
0595 C*    IF AN ERROR HAS OCCURED ZZDIFI AND ZZDIFD WILL BE ZERO.
0596 C*        '99' - OVERFLOW ERROR
0597 C*        '97' - THE 'SIGN' ZONES OF ZZINT AND ZZDEC ARE DIFFERENT
0598 C*
0599 C           GLZCMP    BEGSR                           *** GLZCMP ****
0600 C                     SETOF                     9799
0601 C                     Z-ADDZZDEC     ZZDEC   30 919293DEFINE ZZDEC
0602 C                     Z-ADDZZINT     ZZINT  150 949596DEFINE ZZINT
0603 C* IF SIGN ZONES DIFFER, SET 97, & RETURN ZERO.
0604 C   91 95
0605 COR 92 94             SETON                     97    ERROR -MIXED
0606 C*                                                           STATUS
0607 C   97                GOTO ZZQUIT                     BRANCH TO ADMIT
0608 C*
0609 C*  SPECIAL CASES DEALT WITH FIRST
0610 C*      EITHER AMOUNTS EQ '0' OR BOTH AMOUNTS 'EQ'
0611 C                     SETOF                     9192
0612 C                     SETOF                     9495
0613 C   93 96             SETON                     91    * IF I/P FIELD
0614 C   91                Z-ADDZZTOTI    ZZDIFI 150       *    ZERO
0615 C   91                Z-ADDZZTOTD    ZZDIFD  30       *
0616 C   91                GOTO ZZSIGN
0617 C*
0618 C           ZZTOTI    COMP ZZINT                    91* IF FIELDS EQ
0619 C   91      ZZTOTD    COMP ZZDEC                    91*
0620 C   91                Z-ADD0         ZZDIFI           *
0621 C   91                Z-ADD0         ZZDIFD           *
0622 C   91                GOTO ZZCEND
0623 C*
0624 C           ZZTOTI    COMP 0                        91* IF TOTAL
0625 C   91      ZZTOTD    COMP 0                        91*    ZERO
0626 C   91                Z-SUBZZINT     ZZDIFI           *
0627 C   91                Z-SUBZZDEC     ZZDIFD           *
0628 C**
0629 C           ZZSIGN    TAG                             *** ZZSIGN ****
0630 C*
0631 C**   IF ZZDIFD IS ZERO, AND ZZDIFI IS NEG. SET UP ZZNEGD.
0632 C                     SETOF                     96
0633 C   91      ZZDIFD    COMP 0                        94
0634 C   94      ZZDIFI    COMP 0                      96
0635 C   96                MOVE '.000-'   ZZNEGD  5
0636 C   91                GOTO ZZCEND
0637 C*      END OF SPECIAL CASES
0638 C*
0639 C* IF ZZTOTALS EQ 'B' AND ZZINT,ZZDEC EQ 'A'   THEN -
0640 C*  TO COMPARE 'A' WITH 'B'
0641 C*     1. STORE ORIGINAL VALUE OF 'B'.
0642 C*     2. NEGATE 'A'.
0643 C*     3. ADD 'A' TO 'B'.
0644 C*     4. 'B' IS NOW THE DIFFERENCE. STORE 'B' IN FIELD 'C'.
0645 C*     5. RESTORE 'B'.
0646 C*            N.B. 'A' EQ ZZINT AND ZZDEC
0647 C*                 'B' EQ ZZTOTI AND ZZTOTD
0648 C*                 'C' EQ ZZDIFI AND ZZDIFD
0649 C*
0650 C*    STEP #1
0651 C                     Z-ADDZZTOTI    ZZSTRI 150
0652 C                     Z-ADDZZTOTD    ZZSTRD  30
0653 C*    STEP #2
0654 C                     Z-SUBZZINT     ZZAMTI 150
0655 C                     Z-SUBZZDEC     ZZAMTD  30
0656 C*    STEP #3
0657 C                     EXSR GLZSUM
0658 C   99                GOTO ZZQUIT
0659 C*    STEP #4
0660 C                     Z-ADDZZTOTI    ZZDIFI
0661 C                     MOVE ZZTOTD    ZZDIFD
0662 C*    STEP #5
0663 C                     Z-ADDZZSTRI    ZZTOTI 150
0664 C                     Z-ADDZZSTRD    ZZTOTD  30
0665 C                     GOTO ZZCEND                     BYPASS ADMIT
0666 C           ZZQUIT    TAG                             ** ZZQUIT TAG**
0667 C                     Z-ADD0         ZZDIFI
0668 C                     Z-ADD0         ZZDIFD
0669 C           ZZCEND    ENDSR                           ** ZZCEND TAG**
0670 C*
0671 C********************************************************************
0672 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0673 C*                        GLZADD, GLZSUB, GLZCMP.
0674 C*          PARAMETERS PASSED -
0675 C*                     I/P ZZAMTI ZZAMTD
0676 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0677 C*
0678 C           GLZSUM    BEGSR                           *** GLZSUM ****
0679 C*
0680 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0681 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0682 C                     SETOF                     919293
0683 C                     SETOF                     949599
0684 C*
0685 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0686 C           ZZAMTI    COMP 0                      9293
0687 C   93      ZZAMTD    COMP 0                      9293
0688 C   93                GOTO ZZSEND                     ZERO BYPASS
0689 C*
0690 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0691 C           ZZTOTI    COMP 0                      9193
0692 C   93      ZZTOTD    COMP 0                      9193
0693 C*
0694 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0695 C   93                Z-ADDZZAMTI    ZZTOTI
0696 C   93                Z-ADDZZAMTD    ZZTOTD
0697 C   93                GOTO ZZSEND                     ZERO BYPASS
0698 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0699 C   91N92
0700 CORN91 92             GOTO ZZOFPS
0701 C*
0702 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0703 C           ZZWK2     COMP 999                  93    '93' = CARRY
0704 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
0705 C*
0706 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0707 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0708 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
0709 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0710 C*
0711 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0712 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0713 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0714 C  N99                Z-ADDZZWK2     ZZTOTD
0715 C  N99                Z-ADDZZWK3     ZZTOTI
0716 C*
0717 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0718 C   99                Z-ADD0         ZZAMT  153
0719 C                     GOTO ZZSEND
0720 C*
0721 C* THE 'SIGNS' ARE DIFFERENT
0722 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
0723 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0724 C*
0725 C   92                Z-SUBZZAMTI    ZZAMTI 150
0726 C   92                Z-SUBZZAMTD    ZZAMTD  30
0727 C*
0728 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0729 C*
0730 C   91                Z-SUBZZTOTI    ZZTOTI
0731 C   91                Z-SUBZZTOTD    ZZTOTD
0732 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0733 C*
0734 C           ZZTOTI    COMP ZZAMTI               93  95
0735 C   95      ZZTOTD    COMP ZZAMTD               93  95
0736 C*
0737 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0738 C   95                Z-ADD0         ZZTOTI
0739 C   95                Z-ADD0         ZZTOTD
0740 C   95                GOTO ZZSEND
0741 C*
0742 C* IF ZZTOT GT. ZZAMT.
0743 C   93      ZZAMTD    COMP ZZTOTD               94
0744 C   93 94   ZZTOTI    SUB  1         ZZTOTI
0745 C   93 94   ZZTOTD    ADD  1000      ZZWK2
0746 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0747 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0748 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0749 C*
0750 C*
0751 C* IF ZZAMT GT. ZZTOT.
0752 C  N93      ZZTOTD    COMP ZZAMTD               94
0753 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
0754 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
0755 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0756 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0757 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0758 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0759 C*
0760 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0761 C                     SETOF                     94
0762 C   93 91
0763 CORN93 92             SETON                     94
0764 C   94                Z-SUBZZTOTI    ZZTOTI
0765 C   94                Z-SUBZZTOTD    ZZTOTD
0766 C**
0767 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0768 C   92                Z-SUBZZAMTI    ZZAMTI
0769 C   92                Z-SUBZZAMTD    ZZAMTD
0770 C           ZZSEND    TAG                             ** ZZSEND TAG *
0771 C**
0772 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0773 C                     SETOF                     96
0774 C           ZZTOTD    COMP 0                        91
0775 C   91      ZZTOTI    COMP 0                      96
0776 C   96                MOVE '.000-'   ZZNEGD  5
0777 C                     ENDSR                             ** ENDSR **
     C*                                                                   S01195
     C** Calculation of number of working days forward from today         S01195
      /COPY ZSRSRC,ZACCH                                                  S01195
      /COPY ZSRSRC,ZFWDT                                                  S01195
0786 C********************************************************************S01194
0787 C**********                                                          S01194
0788 C**********Y SR. TO CALCULATE ANY NUMBER OF DAYS FORWARD THAT ARE    S01194
0789 C**********      WORKING DAYS IN BOTH THE LOCAL CURRENCY AND ANY     S01194
0790 C**********      SPECIFIED CURRENCY.                                 S01194
0791 C**********                                                          S01194
0792 C**********THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING AS   S01194
0793 C********** HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY   S01194
0794 C**********DDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED.   S01194
0795 C**********                                                          S01194
0796 C********** ZTXDAY    BEGSR                           *** ZTXDAY *** S01194
0797 C**********                                                          S01194
0798 C**********   CALCULATIONS TO DEFINE INPUT FIELDS.                   S01194
0799 C**********           Z-ADDZDAYNO    ZDAYNO  50       STARTING DATE  S01194
0800 C**********           MOVE ZCCY      ZCCY    3        DATE CURRENCY  S01194
0801 C**********           Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING S01194
0802 C**********  LOCY DEFINED ON TABLE,TB-11;  AND SHOULD ALREADY HAVE   S01194
0803 C********** BEEN INPUT.                                              S01194
0804 C**********                                           DAYS FORWARD   S01194
0805 C********** CLEAR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.       S01194
0806 C**********           Z-ADD0         ZDCNT   20                      S01194
0807 C**********           Z-ADDZDAYNO    ZDYNBR  50                      S01194
     C**********   SEE MANUAL ON SYSTEM SUBROUTINES                       S01194
     C**********ZNRDYS IS INPUT AS ZERO IT WILL NOW BE TREATED AS ZERO.   S01194
     C**********   FIRST CHECK FOR ZERO NOTICE DAYS                       S01194
     C********** ZNRDYS    COMP 0                        95               S01194
     C***95*****           GOTO ZTXEND                                    S01194
0808 C**********                                                          S01194
0809 C**********LOOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.       S01194
0810 C********** ZTLOP1    TAG                             ** ZTLOP1 TAG *S01194
0811 C**********                                                          S01194
0812 C**********           SETOF                     9596                 S01194
0813 C********** ZDYNBR    ADD  1         ZDYNBR                          S01194
0814 C**********                                                          S01194
0815 C**********SET KEY FOR FIRST HOLIDAY RECORD.                         S01194
0816 C**********           MOVEL'22    '  ZDHKEY 12                       S01194
0817 C**********           MOVELZDYNBR    ZWRK6   6                       S01194
0818 C**********           MOVE '1'       ZWRK6                           S01194
0819 C**********           MOVE ZWRK6     ZDHKEY                          S01194
0820 C**********                                                          S01194
0821 C********** CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                  S01194
0822 C********** ZTHCHN    TAG                             ** ZTHCHN TAG *S01194
0823 C**********                                                          S01194
0824 C********** ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01194
0825 C**N90***** RECI      COMP 'D'                  9090  DELETED        S01194
0826 C**********                                                          S01194
0827 C**********   NO RECORD 1 FOUND, IS NOT A HOLIDAY                    S01194
0828 C***90N95**           GOTO ZTOAGN                                    S01194
0829 C**********                                                          S01194
0830 C********** NO RECORD 2 FOUND                                        S01194
0831 C***90*95*96          GOTO ZTLOP1                     EXC. NOT FOUND S01194
0832 C***90*95N96          GOTO ZTOAGN                     INC. NOT FOUND S01194
0833 C**********                                                          S01194
0834 C********** DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE                 S01194
0835 C********** INEX      COMP 'E'                  92  91               S01194
0836 C**********                                                          S01194
0837 C********** CHECK IF DAY IS HOLIDAY FOR CURRENCY.                    S01194
0838 C********** ZCCY      LOKUPHCCY                     93               S01194
0839 C**N93******LOCY******LOKUPHCCY                     93               S01194
0839 C**N93******BJBPCD    LOKUPHCCY                     93               S01194
0840 C***91*93***          GOTO ZTOAGN                     EXCLUDE FOUND  S01194
0841 C***92*93***          GOTO ZTLOP1                     INCLUDE FOUND  S01194
0842 C**********                                                          S01194
0843 C********** IF EXCLUDE OR INCLUDE NOT FOUND CHECK                    S01194
0844 C********** FOR SECOND HOLIDAY RECORD, IF REQUIRED.                  S01194
0845 C********** '   '     LOKUPHCCY                     94ON IF NO RCD.2 S01194
0846 C**********           MOVE ZDHKEY    ZWRK1   1                       S01194
0847 C********** ZWRK1     COMP '1'                      95               S01194
0848 C***91*95**           SETON                     96                   S01194
0849 C***95N94**           MOVE '2'       ZDHKEY                          S01194
0850 C***95N94****         GOTO ZTHCHN                     GET SECOND REC S01194
0851 C**********                                                          S01194
0852 C***91*****           GOTO ZTLOP1                     EXC. NOT FOUND S01194
0853 C***92*****           GOTO ZTOAGN                     INC. NOT FOUND S01194
0854 C**********                                                          S01194
0855 C********** INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS     S01194
0856 C********** HAVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.         S01194
0857 C********** ZTOAGN    TAG                             ** ZTOAGN TAG *S01194
0858 C**********                                                          S01194
0859 C********** ZDCNT     ADD  1         ZDCNT                           S01194
0860 C********** ZDCNT     COMP ZNRDYS                 97                 S01194
0861 C***97*****           GOTO ZTLOP1                                    S01194
0862 C**********                                                          S01194
0863 C********** ZTXEND    ENDSR                                          S01194
0864 C**********                                                          S01194
0865 C**********                                                          S01194
0866 C********************************************************************S01194
0867 C********************************************************************S01194
0868 C**********                                                          S01194
0869 C**********  TABCHN SR. TO RANDOM ACCESS TABLE FILE.                 S01194
0870 C**********                                                          S01194
0871 C********** TABCHN    BEGSR                                          S01194
0872 C**********                                                          S01194
0873 C**********           SETOF                     03                   S01194
0874 C********** TABKEY    CHAINTABLE                76                   S01194
0875 C**********                                                          S01194
0876 C**********           ENDSR                                          S01194
0877 C**********                                                          S01194
0878 C********************************************************************
0879 C*
0880 C*    ATCHK SR. TO DETERMINE THE AMENDMENT TYPE FOR A DEAL
0881 C*    AMENDMENT RECORD.
0882 C*
0883 C           ATCHK     BEGSR                           ***  ATCHK  ***
0884 C**
0885 C                     SETOF                     2627
0886 C           AMTP      COMP 'PI'                     21
0887 C           AMTP      COMP 'PD'                     22
0888 C           AMTP      COMP 'SI'                     23
0889 C           AMTP      COMP 'SC'                     24
0890 C           AMTP      COMP 'CI'                     25
0891 C**
0892 C*
0893 C   21
0894 COR 22
0895 COR 24                SETON                     26    PI,PD OR SC
0896 C   23
0897 COR 25                SETON                     27    SI OR CI
      *                                                                                       CDL017
      **  Set indicator to produce confirmation for deal amendment EM                         CDL017
     C           AMTP      IFEQ 'EM'                                                          CDL017
     C                     SETON                     26                                       CDL017
     C                     ENDIF                                                              CDL017
      *                                                                                       CDL022
      **  Set indicator to produce confirmation for deal amendment BC                         CDL022
     C           AMTP      IFEQ 'BC'                                                          CDL022
     C                     SETON                     26                                       CDL022
     C                     ENDIF                                                              CDL022
0898 C*
0899 C                     ENDSR
0900 C*
     C*****************************************************************
     C** PAYCHP SR. FOR DEAL AMENDMENTS GENERATING PAY EVENTS, DETERMIN
     C**        IF SETTLED VIA CHIPS. IF CHIPS PAYMENT AND AMENDMENT
     C**        VALUE DATE IS NOT DATE OF NEXT WORKING DAY,SET ON
     C**        IND#73 TO BYPASS DEAL AMEND P-R IND. CREATION
     C**
     C           PAYCHP    BEGSR                           *** PAYCHP *
     C**   RESET BYPASS INDICATOR.
     C                     SETOF                     7372
     C**   DETERMINE IF AMENDED DEAL IS P-R-R OR R-P-P
     C           RCDC      COMP 15                       71
     C  N71      RCDC      COMP 16                       72
     C  N71N72   RCDC      COMP 17                       71
     C**    PAY EVENT AT START
     C   71 21   SETP      COMP 07                       73
     C**    PAY EVENT AT MATURITY OR INTERST
     C   71N21   SETP      COMP 07                       73
     C**
     C**    IF CHIPS PAYMENT, TEST EVENT DATE AGAINST DATE OF
     C**     NEXT WORKING DAY.
     C***73******VDAT      COMP DNWD                 73                   S01194
     C   73      VDAT      COMP BJDNWD               73                   S01194
     C                     ENDSR
     C*
0901 C********************************************************************
0902 C*
0903 C*    HASH SR. TO MAINTAIN HASH TOTALS.
0904 C*
0905 C           HASH      BEGSR                           *** HASH ***
0906 C*
0907 C                     Z-ADDDAAM      ZZAMT
0908 C                     Z-ADDINT,X     ZZTOTI
0909 C                     Z-ADDDEC,X     ZZTOTD
0910 C                     EXSR GLZADD
0911 C                     Z-ADDZZTOTI    INT,X
0912 C                     Z-ADDZZTOTD    DEC,X
0913 C*
0914 C                     ENDSR
     C/COPY WNCPYSRC,DL0264C004
0915 C********************************************************************
     C/EJECT                                                              S01194
     C*****************************************************************   S01194
     C*                                                                   S01194
     C           *PSSR     BEGSR                                          S01194
     C*                                                                   S01194
     C           @RUN      IFEQ *BLANK                                    S01194
     C                     MOVE 'Y'       @RUN    1                       S01194
     C                     MOVE '1'       *INU7                           S01194
     C                     MOVE '1'       *INU8                           S01194
     C                     MOVE '1'       *INLR                           S01194
     C                     DUMP                                           S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     ENDSR                                          S01194
     C*****************************************************************   S01194
0916 C/EJECT
     ODL0264AUT  203   LR                                                 S01117
0917 O*L0264P1T  203   LR                                       S01124    S01117
     O                                   24 'REFERENCE DL0264AU'          S01117
0918 O**********                         22 'REFERENCE DL0264'            S01117
0919 O**********               TITL      89                               S01194
0919 O                         BJURPT    89                               S01194
0920 O                                  104 'DATE'
0921 O**********               RUNA     112                               S01194
0921 O                         BJMRDT   112                               S01194
0922 O                                  122 'PAGE'
0923 O                         PAGE  Z  127
0924 O        T  1     LR
0925 O                                   56 'DEAL AMENDMENTS FILE'
0926 O                                   75 'UPDATE - PHASE 1 -'
0927 O                                   89 'FILE CONTROLS'
0928 O        T  3     LR
0929 O                                   56 '--------------------'
0930 O                                   75 '-------------------'
0931 O                                   89 '--------------'
0932 O        T  1     LR
0933 O                                   28 'S/DEAMS - RUN CONTROLS'
0934 O                                   59 'NUMBER'
0935 O                                   84 'VALUE'
0936 O        T  2     LR
0937 O                                   28 '----------------------'
0938 O                                   59 'OF RECORDS'
0939 O                                   84 'OF RECORDS'
0940 O        T  2     LR
0941 O                                   29 'TOTAL RECORDS ON FILE'
0942 O                         NORE  3   59
0943 O        T  2     LR
0944 O                                   25 'CURRENT RECORDS -'
0945 O                                   46 'START OF INPUT CYCLE'
0946 O                         NLRB  3   59
0947 O                         VLBF  Z   81
0948 O                         VLBL      84
0949 O        T  2     LR
0950 O                                   16 'INSERTED'
0951 O                         NINS  3   59
0952 O                         VRIF  Z   81
0953 O                         VRIL      84
0954 O        T  2     LR
0955 O                                   15 'DELETED'
0956 O                         NDEL  3   59
0957 O                         VRDF  Z   81
0958 O                         VRDL      84
0959 O        T  2     LR
0960 O                                   25 'CURRENT RECORDS -'
0961 O                                   44 'END OF INPUT CYCLE'
0962 O                         NLRA  3   59
0963 O                         VLAF  Z   81
0964 O                         VLAL      84
0965 O        T  2     LR
0966 O                                   25 'CURRENT RECORDS -'
0967 O                                   49 'END OF I/C - CALCULATED'
0968 O                         NLRAD 3   59
0969 O                         INT,1 Z   81
0970 O                         DEC,1     84
0971 O                 41               111 '***   DIFFERENCE   ***'
0972 O        T 21     LR
0973 O                                   28 'S/DAUPD - RUN CONTROLS'
0974 O        T  2     LR
0975 O                                   28 '----------------------'
0976 O        T  2     LR
0977 O                                   27 'RECORDS NOT BROUGHT'
0978 O                                   48 'FORWARD FROM S/DEAMS'
0979 O                         RNBF  3   59
0980 O        T  2     LR
0981 O                                   32 'TOTAL RECORDS ON S/DAUPD'
0982 O                         DNORE 3   59
0983 O                 42               111 '***   DIFFERENCE   ***'
0984 O        T  139   LR
0985 O                                   28 'S/DAIND - RUN CONTROLS'
0986 O        T  2     LR
0987 O                                   28 '----------------------'
0988 O        T 1      LR
0989 O                                   29 'TOTAL RECORDS ON FILE'
0990 O                         NOREI 3   59
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   46 'KEY'                         S01117
     O                         DBKEY     76                               S01117
0991 O*****   T   48   LR                                                 LN0135
0992 O*****                              65 '*** END OF REPORT ***'       LN0135
0993 ODAUPDHH DADD     06
0994 O                         LOT      200
0995 ODAUPDDI DADD     61
0996 O*************************LOT      200                               S01177
0996 O*************************LOTX     828                         S01177091546
0996 O***********              LOTX     829                        091546 CAC001
     O***********              LOTX     837                        CAC001 CEU003
0996 O***********              LOTX     843                        CEU003 CDL006
     O**********               LOTX     877                                            CDL006 CGL029
     O**********               LOTX     933                                            CGL029BUG4092
     O*************************LOTX     963                                           BUG4092 CDL038
     O**********               LOTX     967                                          CDL038 AR853123
     O                         LOTX     985                                                 AR853123
0997 O                         DAIN     145
     O                         FSRP     835P                              CAC001
     O                         IRCF     836                               CAC001
     O                         FRCF     837                               CAC001
0998 ODAUPDDJ TADD     LR
0999 O                                    1 'T'
1000 O                                    7 '999999'
1001 O                                   12 '99999'
1002 O                                   15 '999'
1003 O                         DNORE     18P
1004 O                         FLSZ      21P
1005 O                         DNLRA     24P
1006 O                         ZERO5     27P
1007 O                         ZERO5     30P
1008 O                         ZERO5     33P
1009 O                         ZERO5     36P
1010 O                         DNLRA     39P
1011 O                         INT,1     47P
1012 O                         DEC,1     49P
1013 O                         ZERO15    57P
1014 O                         ZERO3     59P
1015 O                         ZERO15    67P
1016 O                         ZERO3     69P
1017 O                         INT,2     77P
1018 O                         DEC,2     79P
1019 O                         INT,3     87P
1020 O                         DEC,3     89P
1021 O                         INT,1     97P
1022 O                         DEC,1     99P
1023 O                         ZERO5    196P
1024 O                         ZERO5    200P
1025 ODAINDHH DADD     06
1026 O                                    1 'H'
1027 O                                    8 '000000'
1028 ODAINDDL DADD     60
1029 O                                    1 'D'
1030 O                                    2 'A'
1031 O                         DLNO       8
1032 O                         VDAT      13
1033 O                         DASN      16
1034 O                 07N34             17 'I'
1035 O*****************07*34*************17 'A'                           060528
     O                 07 34   CHTP      17                               060528
1036 O                 08                17 'R'
1037 O                    62             18 'C'
1038 O                                   19 'N'
     O                         PSEQ      25                               051496
1039 O                                   29 '000'
1040 O                 21 38             27 '1'
1041 O                 23 38             28 '1'
1042 O                 22 38             29 '1'
     O********************     BRCA      33                               S01117
     O                         OSBR      33                               S01117
     O                         BRCA      37                               096561
1043 ODAINDEX TADD     LR
1044 O                                    1 'T'
1045 O                                    2 'Z'
1046 O                                    8 '999999'
1047 O                         NOREI     11P
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  DEAL TYPES ARRAY
ITIPTDTICDCLDLILIDFLDPLPFTDTLT                                     S01354 CDL006
