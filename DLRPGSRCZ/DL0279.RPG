     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas DL Deals update - phase 1')                      *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Dealing Module                                       *
     F*                                                               *
     F*  DL0279 - DEALS FILE UPDATE - PHASE 1.                        *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD036619           Date 12Mar20               *
      *                 MD051152           Date 02Aug18               *
      *                 MD053295           Date 13Apr19               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 MD047993           Date 23Sep17               *
      *                 MD035545           Date 11Sep15               *
      *                 CGL165             Date 17Feb15               *
      *                 CDL096             Date 22Sep14               *
      *                 CIR018             Date 31Aug14               *
      *                 CDL094             Date 01Sep14               *
      *                 MD027639           Date 19Aug14               *
      *                 MD027692           Date 25Jun14               *
      *                 MD025190           Date 11May14               *
      *                 CIR017             Date 10Apr14               *
      *                 AR316355           Date 15Apr10               *
      *                 AR316628           Date 13Apr10               *
      *                 AR923287           Date 10Jun13               *
      *                 AR996895           Date 25Nov12               *
      *                 AR845022           Date 27Jul12               *
      *                 CRE073             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER016A            Date 19May08               *
      *                 CER048             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      *                 250569             Date 03Oct07               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 248668             Date 26Jun07               *
      *                 246141             Date 26Mar07               *
      *                 246437             Date 19Mar07               *
      *                 164847             Date 30Nov06               *
      *                 237893             Date 30Nov06               *
      *                 236956             Date 30Nov06               *
      *                 233128             Date 30Nov06               *
      *                 232817             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CDL049             Date 05Jul06               *
      *                 BUG11267           Date 05May06               *
      *                 CIR014             Date 11May06               *
      *                 CSD031             Date 10Apr06               *
      *                 227642             Date 23Aug04               *
      *                 CSD027             Date 09Dec05               *
      *                 CIR013             Date 08Apr05               *
      *                 CDL033             Date 10Feb05               *
      *                 236317             Date 08Dec05               *
      *                 BUG7543            Date 16Jun05               *
      *                 BUG7094R *REOPENED Date 04Jul05               *
      *                 CAS009             Date 16May05               *
      *                 CDL038             Date 10May05               *
      *                 BUG7094            Date 23May05               *
      *                 BUG6995            Date 10May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CAS008             Date 16Jun04               *
      *                 TDA099             Date 29Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 217684             Date 12May03               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 204923             Date 29Apr02               *
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      *                 174563             Date 29Oct01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CIR007             Date 11May01               *
      *                 193724             Date 09Jul01               *
      *                 193160             Date 09Jul01               *
      *                 CDE002             Date 05Dec00               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             DATE 15May01               *
      *                 131369             DATE 23Feb01               *
      *                 185166             Date 20Dec00               *
      *                 CIR003             Date 13Sep00               *
      *                 CIR006             Date 13Sep00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 177837             Date 22Jun99               *
      *                 CIR005             Date 21Jan00               *
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSW097             Date 04Jan99               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 156954             Date 15Jun99               *
      *                 CEU003             Date 28Mar98               *
     F*                 121768             DATE 20FEB98               *
     F*                 126017             DATE 14NOV97               *
     F*                 097885             Date 31Jan97               *
     F*                 CSW005             Date 07Jan97               *
     F*                 110874             DATE 25NOV96               *
     F*                 S01408             DATE 03SEP96               *
     F*                 S01408             DATE 23AUG96               *
     F*                 S01408             DATE 15AUG96               *
     F*                 100140             DATE 27JUN96               *
     F*                 S01408             DATE 29MAY96               *
     F*                 S01408             DATE 15MAY96               *
     F*                 S01408             DATE 01APR96               *
     F*                 S01408             DATE 09FEB96               *
     F*                 CIR002             DATE 13JUN95               *
     F*                 CIR001             DATE 13JUN95               *
     F*                 096087             DATE 17JAN96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 S01408             DATE 24JUL95               *
     F*                 060712             DATE 13JUL94               *
     F*                 051696             DATE 08JUL94               *
     F*                 051372             DATE 16JUN94               *
     F*                 058890             DATE 16MAY94               *
     F*                 059357             DATE 21MAR94               *
     F*                 066600             DATE 04FEB94               *
     F*                 066550             DATE 04FEB94               *
     F*                 060995             DATE 02FEB94               *
     F*                 031967             DATE 02FEB94               *
     F*                 S01434             DATE 03NOV93               *
     F*                 S01378             DATE 15OCT92               *
     F*                 E43201             DATE 04SEP92               *
     F*                 038323             DATE 29JUL92               *
     F*                 043304             DATE 13AUG92               *
     F*                 040318             DATE 07AUG92               *
     F*                 AUS021             DATE 07AUG92               *
     F*                 E35983 (FUJ808)    DATE 13FEB92               *
     F*                 E02378             DATE 20JAN92               *
     F*                 S01354             DATE 08JAN92               *
     F*                 E24507             DATE 08MAR91               *
     F*                 E23886             DATE 26JUN91               *
     F*                 E21923             DATE 28JUL90               *
     F*                 E22610             DATE 25JUL90               *
     F*                 E19532             DATE 11MAY90               *
     F*                 E19374             DATE 26JAN90               *
     F*                 LN0794             DATE 26SEP90               *
     F*                 LN0762             DATE 17SEP90               *
     F*                 LN0699             DATE 03SEP90               *
     F*                 LN0698             DATE 31AUG90               *
     F*                 LN0588             DATE 02AUG90               *
     F*                 LN0293             DATE 30MAY90               *
     F*                 LN0135             DATE 23MAY90               *
     F*                 E340               DATE 24APR90               *
     F*                 E19920             DATE 17APR90               *
     F*                 S01195             DATE 01/08/89              *
     F*                 S01194             DATE 01/08/89              *
     F*                 S01117             DATE 01/08/89              *
     F*                 S01157             DATE 01/08/89              *
     F*                 E10475             DATE 19/11/87              *
     F*                 S01119             DATE 16/06/87              *
     F*                 E43355             DATE 06/03/87              *
     F*                 S01093             DATE 24/09/86              *
     F*                 S01124             DATE 00/00/00              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD036619 - Generated interest for pay/rec and confirmation   *
      *             had a difference of .01 with the actual posting   *
      *           - Half-adjust ZINTR and save to #WKINT before       *
      *             adding to AITD to be consistent with DL0280       *
      *  MD051152 - FRA/IRS Interest Calculation Basis 6.             *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date                                    *
      *  MD047993 - Modified MD035545. Removed dependency on Accrue   *
      *             on Last Day indicator.                            *
      *  MD035545 - LE: Interest Calculation in Leap year. Consider   *
      *             Accrue on Last Day Indicator for method 6.        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CIR018 - Daily Rate Change Frequency on SIRS                 *
      *  CDL094 - Enhance Receive Settlement Instructions             *
      *           (Recompiled)                                        *
      *  MD027639 - Missing maturity confirmation.                    *
      *           - Missing maturity confirmation for backvalued      *
      *             maturity of call deals.                           *
      *  MD027692 - Up-Front Fee Values became mandatories during     *
      *             EDIT mode                                         *
      *  MD025190 - FOOB due to field value truncation causing        *
      *             negative result                                   *
      *  CIR017 - SIRS Business Day Conventions for both legs         *
      *  AR316355 - Update field UPPR 'Up-front fee payment/receipt'  *
      *             of Floor and Cap deals if it is blank.            *
      *  AR316628 - RP/RF deals did not pick up the SD Base Rate.     *
      *  AR923287 - Regenerate pay/rec messages when an Interest      *
      *             Adjustment is inserted. (Child: AR923289)         *
      *  AR996895 - Incorrect acrrual interest calculation            *
      *             (Child: AR996897) (Recompile)                     *
      *  AR845022 - Principal changes not yet processed but within    *
      *             telex should be included on the computation of    *
      *             amount. (Child: AR845023)                         *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,DLH00042                                 *
      *             WNCPYSRC,DLH00043                                 *
      *             WNCPYSRC,DLH00044                                 *
      *             WNCPYSRC,DLH00045                                 *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *            to Midas Plus (Recompile)                          *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  250569 - Wrong currency used in Nostro access.               *
      *  248668 - Back-valued pay/receive messages are generated      *
      *           for Up-front fees.                                  *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  246437 - Incorrect interest amount shown on the pay/receive  *
      *           message for Caps, Floors and Collars if the message *
      *           is generated before the initial rate has been fixed.*
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  237893 - Generate pay/receive message for up-front fee of    *
      *           IRS and interest rate caps, collars, and floors.    *
      *           Generate buy-out pay/receive message for caps,      *
      *           collars and floors.                                 *
      *         - Applied fix 236956, 233128 and 232817.              *
      *  236956 - No Pay/Receive message generated for Buy Out of RX  *
      *           deals with Principal Exchange at maturity.          *
      *  233128 - If buy-out value date is equal to next interest     *
      *           payment date, only pay/receipt message for buy-out  *
      *           is generated.  Need to generate interest pay/rec.   *
      *  232817 (Reopen) - If next interest payment date is zero, the *
      *           date on the pay/receipt message is the next interest*
      *           payment date.  It should be the buy-out value date. *
      *  232817 - Pay/receive message for buy-out is not generated.   *
      *           Applied fix 227852.                                 *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  BUG11267 - Back-valued IRS deals do not correctly generate   *
      *             MT362 for the current interest period.            *
      *             (applied in part by 227642)                       *
      *  CIR014 - Mark to Market Cross-currency Interest Rate Swaps   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  227642 - When short term rate is amended on rate fix date,   *
      *           generate an MT362 for current period.               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *  CDL033 - Floating Rate CDs Issued                            *
      *  236317 - Divide by zero on CDL028                            *
      *  BUG7543- CDL028 Interpolated Rate not showing on MT362.      *
      *           Apply CDL028 changes from DL0250 to this program.   *
      *  BUG7094R- For deal types 'RS'& 'RX' & for settlement methods *
      *            01, 07 and 08 only use the deal CCY telex notice   *
      *            days to generate the messages.                     *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  BUG7094- Matching interest payments for 'RS' deals are not   *
      *           matched if CSW005 is on.                            *
      *         - If our and their end dates are not equal but both   *
      *           within telex notice days, the pay message is        *
      *           generated but the receipt message is not. (232980)  *
      *  BUG6995- Set payment produced indicator PMTP to 'Y' only when*
      *           message for principal change date is generated.     *
      *           Use the updated principal from DLPCSCPD for         *
      *           maturity messages.                                  *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CAS008 - IAS 39 Enhancements                                 *
      *  TDA099 - TDA COB Errors                                      *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *  217684 - Authorisation User Malfunction (Recompile)          *
      *  CAS004 - Hedge Accounting Phase A                            *
      *  204923 - Rate Fix Days Adjustment (OIS)                      *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  174563 - Setup field SZINPM when CIR001 is on to produce     *
      *           an MT210.                                           *
      *  CIR007 - Overnight Index Swaps                               *
      *  193724 - Initialise PRI indicators during FRA/IRS processing *
      *           to avoid generation of pay/receive message during   *
      *           rate fixing.                                        *
      *  193160 - Check if rate fix confirmation has been generated   *
      *           (bits 4 and 5 of CNFI) even when Interest Fix Date  *
      *           is in the future to avoid continuous generation of  *
      *           of confirmation.                                    *
      *  CDE002 - Revenue Analysis (recompile)                        *
      *  CSD006 - Use long DS with SDBSRTPD.                          *
     F*  131369 - No maturity confirmation was produced since wrong   *
     F*           MGDAL was computed.  Fix is to move BJRDNB to       *
     F*           ZDAYNO before calling ZFWDT.                        *
      *  185166 - IRS cross ccy (RX) deal pay/receive not generated   *
      *           on correct date when Ours and Theirs have same      *
      *           Interest pay dates but diff Telex notice.           *
      *           Applied fixes 089582, 119765, and 139633.           *
      *  CIR003 - FRA/IRS Pay/Receive Messages for Swaps              *
      *  CIR006 - FRA/IRS Amortisation of Caps/Collars/Floors &       *
      *           Individual Compounding Swaps.                       *
      *  177837 - If a rate fix advice has been produced yesterday    *
      *           (e.g., initial period advice for bacvalued deals)   *
      *           allow a new one to be produced today (if due)       *
      *           for the current period.                             *
      *           Also, update DEALSDG/Base Rate so it appears on     *
      *           MT362.                                              *
      *  CIR005 - FRA/IRS Business Day Conventions                    *
      *  CIR004 - Dealing Calculation Method Change                   *
     F*  CSW097 - SWIFT 97 changes to MT340s and MT360s               *
     F*           Here,  for  RS and RX deals that have not           *
     F*           yet had its value date processed  and a short term  *
     F*           rate has been defined on the floating leg, ensure   *
     F*           that the first rate fix advice is produced here     *
     F*           if not already requested in I/C.                    *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  156954 - Fix 100140 is incomplete.  It doesn't consider if   *
     F*           date format is MMDDYY.                              *
     F*  CEU003 - EMU DL Settlement Currency Conversion:              *
     F*           Amended to use the settlement currency in place of  *
     F*           the transaction currency when calculating the telex *
     F*           notice date.                                        *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  CSW005 - MG34n and MG36n message generation                  *
     F*  110874 - For backvalued IRSs, interest settlement confos     *
     F*           are not produced as interest being considered is    *
     F*           for the past period instead of for the current      *
     F*           period.                                             *
     F*  S01408 - Core Hook DL0279CP29 added                          *
     F*         - Core Hook DL0279FFP2 added                          *
     F*         - Core Hook DL0279OOP2 added                          *
     F*         - Core Hook DL0279OOP3 added                          *
     F*         - Core Hook DL0279OOP4 added                          *
     F*         - Core Hook DL0279OOP5 added                          *
     F*  S01408 - Core Hook DL0279CP28 added                          *
     F*  S01408 - Core Hook DL0279CP27 added                          *
     F*         - Core Hook DL0279CP26 added                          *
     F*         - Core Hook DL0279CP25 added                          *
     F*         - Core Hook DL0279CP24 added                          *
     F*  100140 - Looping problems caused by FRA's fixing on 29th Feb *
     F*           Fix is to ensure that when 1 year is added to 29th  *
     F*           Feb in a leap year, the result is 28th Feb.         *
     F*  S01408 - Core Hook DL0279CP23 added                          *
     F*           Core Hook DL0279CP22 added                          *
     F*         - Core Hook DL0279CP21 added                          *
     F*         - Core Hook DL0279CP20 added                          *
     F*         - Core Hook DL0279CP19 added                          *
     F*         - Core Hook DL0279CP18 added                          *
     F*  S01408 - Core Hook DL0279FFP1 added                          *
     F*         - Core Hook DL0279CP17 added                          *
     F*         - Core Hook DL0279CP16 added                          *
     F*  S01408 - Core Hook DL0279CP14 added                          *
     F*         - Core Hook DL0279CP15 added                          *
     F*  S01408 - Core Hook DL0279OOP1 added                          *
     F*         - Core Hook DL0279EEP1 added                          *
     F*         - Core Hook DL0279IIP1 added                          *
     F*         - Core Hook DL0279CCP1 added                          *
     F*         - Core Hook DL0279CCP2 added                          *
     F*         - Core Hook DL0279CCP3 added                          *
     F*         - Core Hook DL0279CCP4 added                          *
     F*         - Core Hook DL0279CCP5 added                          *
     F*         - Core Hook DL0279CCP6 added                          *
     F*         - Core Hook DL0279CCP7 added                          *
     F*         - Core Hook DL0279CCP8 added                          *
     F*         - Core Hook DL0279CCP9 added                          *
     F*         - Core Hook DL0279CP10 added                          *
     F*         - Core Hook DL0279CP11 added                          *
     F*         - Core Hook DL0279CP12 added                          *
     F*         - Core Hook DL0279CP13 added                          *
     F*  CIR002 - Compounding of Interest.                            *
     F*  CIR001 - Interest Rate Calendars.                            *
     F*  096087 - Array index error in ZF2C (RECOMPILE OVER ZF2C)     *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  S01408 - Addition of core hooks DL0279CCPG.                  *
     F*  060712 - Recompiled due to change in copy source ZF2C.       *
     F*  051696 - Cross-currency IRS deal did not appear on the       *
     F*           Pay/Receive report.  The fix done was to use the    *
     F*           base rate if the effective interest rate of the     *
     F*           deal is zero.                                       *
     F*  051372 - Incorrect FRA settlement amount calculated for      *
     F*           Australian formula (SETF='A') if deal amount is     *
     F*           greater than 99 Million.                            *
     F*  058890 - If currency is not equal to base ccy and telex      *
     F*           notice days are zero, payment messages are still    *
     F*           produced too early.                                 *
     F*  059357 - Indicator '23' was left on by FX options causing    *
     F*           following loans and deposits to be not extracted.   *
     F*  066600 - Was not working out Date Format correctly.          *
     F*  066550 - GLINTC has had historical problems and inaccuracies *
     F*           and is now externaly descibed and changed to use    *
     F*           ZINTDYZ1. See document atached to error no on GEMS  *
     F*  060995 - Settlement sum in FRA was incorrect.  Interest for  *
     F*           excess days (due to holidays, etc.) of a one year   *
     F*           calculation are calculated separately.  Applied     *
     F*           fix 031967 was change to have 10 days for number    *
     F*           of excess days.                                     *
     F*  031967 - PROBLEMS CAN OCCUR WITH SETTLEMENT SUMS FOR FRAS    *
     F*           ENTERED WITH MATURITY DATES JUST GREATER THAN 1     *
     F*           YEAR (DUE TO EXACTLY 1 YEAR BEING A NON-WORKING     *
     F*           DAY) AS MIDAS WILL CALCULATE THIS SUM USING         *
     F*           2 CALCULATIONS (1 YEAR CALC PLUS EXTRA DAYS         *
     F*           CALC) RATHER THAN 1 CALC.                           *
     F*           THIS CAUSES THE INCORRECT AMOUNTS.                  *
     F*  S01434 - ENHANCED ROLLOVER PROCESSING                        *
     F*  S01378 - Facilitates the partial sale of a parcel            *
     F*           of negotiable instruments which have been           *
     F*           previously input to the system as a single          *
     F*           transaction. When NAB is entered the parcel         *
     F*           size defines the number of parcels it may be        *
     F*           split into for selling. The parcel size on the      *
     F*           NAS defines the number of parcels being sold        *
     F*           by the transaction. (was MOF53). If NAB is sold     *
     F*           and its next interest date is greater than sold     *
     F*           date, do not send interest receipt telex.           *
     F*  E43201 - Calculation for 0 telex notice days wrong if Thurs  *
     F*           as will produce those for Monday incorrectly due to *
     F*           SR/ZF2C. Therefore for zero telex notice days,always*
     F*           use (DNWD(DNWD -1) as check date and bypass check   *
     F*           in SR/ZF2C.                                         *
     F*  038323 - Recompilation of the program done due to a          *
     F*           change in ZFWDT subroutine                          *
     F*  043304 - FRA error in calulation of settlement amount for    *
     F*           Settlement formula - U.                             *
     F*  040318 - Settlement Formula for AUD (SETF=A) sometimes       *
     F*           outputs from DLRADS a negative amount; this causes  *
     F*           (eg.) a -ve Receipt which later becomes a Pay.      *
     F*  AUS021 - AUSTRALIAN PRODUCT. Includes two new settlement     *
     F*           formulas for FRAs. Initially includes one for       *
     F*           Australia and one for USA.                          *
     F*  E35983 - Calculation of discounted settlement amounts in     *
     F*           SR.DLRADS is done in wrong order which causes       *
     F*           half-adjust errors and consequent error of +/-      *
     F*           1 cent in settlement amount on confirmation         *
     F*  E02378 - Interest Advices for IRS deals should be conditioned*
     F*           according to the ICD options (Maturity Confirmation *
     F*           Elapsed Period and Maturity Confirmation To Go      *
     F*           Period) - as currently handled by the program.      *
     F*           They should not be conditioned on the Maturity      *
     F*           Confirmation Requested Indicator.                   *
     F*  S01354 - Add Internal funding deal types                     *
     F*  E24507 - Interest Confirmations not produced for Caps,       *
     F*           Collars and Floors : interest is not calculated     *
     F*           to a Rate Change Date , or Maturity ; only to Int   *
     F*           Pay Date , so Confirmations/Pay/Receives missing.   *
     F*           Confirmations suppressed if pay date not today      *
     F*           (RUND) or after today in subroutine BC .            *
     F*           Fix amended : do not produce pay/receives or        *
     F*           confirmations for b/v events which are due to       *
     F*           skipping working days.                              *
     F*  E23886 - Removal of fix E19374, as it was causing Pay/       *
     F*           Receives to be produced each telex day + 1 for      *
     F*           value date.                                         *
     F*  E21923 - E19532 needs improving to allow for a larger        *
     F*           combination of Local CCY holidays and Telex         *
     F*           Notice Days - problems could still arise when       *
     F*           when there is more than one Local Holiday           *
     F*           consecutively or when Telex Notice Days is          *
     F*           non-zero.                                           *
     F*           Output Pay/Receive Telex if Event Date is less      *
     F*           than or equal to (DNWD(DNWD)) - 1 + Telex Notice    *
     F*           Days.                                               *
     F*  E22610 - In SR DLRADS (calculates discounted settlement      *
     F*           amount for FRA's) discount factor for deals         *
     F*           longer than 1 year should use no. of days from      *
     F*           previous year, not current one.                     *
     F*  E19532 - WHEN A VALUE DATE FALLS ON A LOCAL HOLIDAY THAT     *
     F*           IS NOT A DEAL CCY HOLIDAY TELEXES ARE NOT           *
     F*           PRODUCED THE CORRECT NO. OF DAYS IN ADVANCE.        *
     F*           (ONLY OCCURS IF TELEX NOTICE DAYS = 0).             *
     F*           (THIS FIX WAS REMOVED BY E21923)                    *
     F*  E19374 - WHEN AN MM DEAL MATURES, NO PAY/RECEIVE TELEXES1    *
     F*           ARE REPORTED ON DL0308.                             *
     F*  LN0794 - BRCA SHOULD BE OUTPUT TO DLINDDM FOR FRA/IRS        *
     F*  LN0762 - OLD FIELD BRTE SHOULD BE REPLACED BY BACBSR         *
     F*           (CURRENT BASE RATE ON SDBSRTPD)                     *
     F*  LN0699 - ALL CALLS TO AOBSRTR0 HAVE INCORRECT NUMBER OF      *
     F*           PARAMETERS                                          *
     F*  LN0698 - IN SUBROUTINE FRAIRS, TELEX NOTICE DAYS SHOULD      *
     F*           BE SETUP ACCORDING TO SETTLEMENT METHOD USED        *
     F*  LN0588 - IF UNALLOCATED NOSTRO THEN SET LOCATION CODE        *
     F*           (USED TO CALCULATE TELEX NOTICE DATE) TO BLANKS     *
     F*  LN0293 - DLINDDM LAYOUT NEEDS CHANGING AFTER E103 ON         *
     F*           DTRIEPH FILE FORMAT                                 *
     F*  LN0135 - REMOVE 'END OF REPORT' FROM AUDIT REPORT            *
     F*  E340   - TELEX NOT DAYS ARRAY NOT BEING SET UP FOR INTEREST  *
     F*           DATE PROCESSING                                     *
     F*  E19920 - CODE ADDED TO ENSURE BANK TITLE IS PRINTED ON       *
     F*           REPORT WHEN INPUT FILE EMPTY (DEALS).               *
     F*  S01195 - HOLIDAYS PROCESSING.                                *
     F*  S01194 - STANDING DATA CHANGES.                              *
     F*  S01117 - MULTIBRANCHING CHANGES.                             *
     F*  S01157 - FRA/IRS ENHANCEMENTS - SPLIT DEAL TYPE 'RL' INTO    *
     F*           'RR' (COLLAR), 'RP' (CAP) AND 'RF' (FLOOR).         *
     F*  E10475 - WHEN A HOLIDAY RECORD IS OF TYPE EXCLUDE AND        *
     F*           THE DEAL CCY IS FOUND IN THE RECORD,PAY/RECEIVE     *
     F*           TELEXES ARE NOT PRODUCED THE CORRECT NO. OF         *
     F*           DAYS IN ADVANCE.                                    *
     F*  S01119 - ADDITION OF PROCESSING FOR FRA/IRS SUB TYPES        *
     F*  E43355 - INTEREST CAPITALISATION CONFS NOT PRODUCED          *
     F*  S01093 - IMPROVEMENTS TO PGM EFFICIENCY                      *
     F*           (A) OBTAIN CCY DETAILS FROM PRE-EX TIME ARRAYS      *
     F*           (B) DEALS FILE IS PROCESSED AS UPDATE PRIMARY       *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,DL0279F001
      ** OIS Currency Extension File & OIS Held Events File.                                  CIR007
     FDLOEVTL2UF  E           K        DISK                                                   CIR007
     F*EALS***IP  F     400  6AI     2 DISK                               S01093
0013 F****TABTG30*IT**F      40           EDISK                 S01093    S01117
0014 F*ABLE   IF**F      96 12AI     2 DISK                       *****   S01194
0015 F*ABLE2**IF**F      96 12AI     2 DISK                               S01093
0016 F*LUPDDA*O **F     400            DISK                      A        S01093
     F*LUPDDB*O **F     400            DISK                      A        S01093
     F*LUPDDC*O **F     400            DISK                      A        S01093
     F*LUPDDD*O **F     400            DISK                      A        S01093
     F*LUPDDE*O **F     400            DISK                      A        S01093
     F*LUPDDF*O **F     400            DISK                      A        S01093
0017 FDLINDHH O   F      40            DISK                      A
     F*LINDDM O **F      40            DISK                      A        S01119
     FDLINDDM O   F      98            DISK                      A        S01119
     FDLINDZX O   F      40            DISK                      A
0018 F*L0279P1O **F     132     OF     PRINTER                   S01124   S01117
0013 F*EALS   UP**F     400  6AI     2 DISK                      S01093   S01117
0013 F*EALS   UP**F     500  6AI     2 DISK                               S01117
     F*EALS   UP  F     600  6AI     2 DISK                               S01117
     F*DEALS**UP**F****1069  6AI     2 DISK                      S01117   S01434
     F*DEALS***UP  F    1075  6AI     2 DISK                       S01434 CEU003
     F***DEALS***UP  F    2006  6AI     2 DISK                     CEU003 CIR005
     F***DEALS** UP  F    2190  6AI     2 DISK                                         CIR005 CAS004
     F***DEALS** UP  F    2247  6AI     2 DISK                                         CAS004 CAS005
     F***DEALS** UP  F    2441  6AI     2 DISK                                         CAS005 CAS006
     F***DEALS** UP  F    2448  6AI     2 DISK                                         CAS006 CGL029
     F***DEALS** UP  F    2540  6AI     2 DISK                                         CGL029 CAS008
     F***DEALS** UP  F    2540  6AI     2 DISK                                         CGL029BUG7543
     FDEALS   UP  F    2602  6AI     2 DISK                                                  BUG7543
     FDLCFSCPDIF  E           K        DISK                           UC  CIR001
     FDLDTSCPDIF  E           K        DISK                           UC  CIR001
     FDLGXSTL0IF  E           K        DISK                               CIR003
     FDLPCSCL0UF  E           K        DISK                               CIR003
     FDLPCSCPDIF  E           K        DISK                                                 AR845022
     F            DLPCSCD0                          KRENAMEDLPCSCD1                         AR845022
     FDLDEALL5IF  E           K        DISK                                                   CIR014
     F            DLDLDBD0                          KIGNORE                                   CIR014
     F            DLDLDCD0                          KIGNORE                                   CIR014
     FDL0279AUO   F     132     OF     PRINTER                            S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0279FFP1                                           S01408
     F*                                                                   S01408
0019 F*
0020 F* ID F  C  H  L    FUNCTION OF INDICATORS
0021 F**01**          INSTALLATION CONTROL DATA RECORD 1          *****   S01194
0022 F**02**          INSTALLATION CONTROL DATA RECORD 5          *****   S01194
0023 F**03**          TABLE CURRENCIES RECORD 1                   *****   S01194
0024 F**04**          TABLE2 CATCHALL                             *****   S01194
0025 F* 05            DEALS FILE - HEADER
0026 F* 06            DEALS FILE - FOREIGN EXCHANGE
0027 F* 07            DEALS FILE - LOAN/DEPOSIT
0028 F* 08            DEALS FILE - NEGOTIABLE ASSET PURCHASED
0029 F* 09            DEALS FILE - NEGOTIABLE ASSET SOLD
0030 F* 10            DEALS FILE - TRAILER
0031 F* 11            DEALS FILE - CATCHALL
     F* 12            DEALS FILE - FRA/IRS                                S01119
     F********13      CHAIN FAIL FOR BASE RATE TABLE FILE         S01119  S01194
     F*       14      CAPS AVERAGE RATE                                   S01119
     F*       15      AVERAGE RATE AMENDED TODAY                          S01119
     F*       16      INITIAL RATE SET (DNSI BTI 0 - ON)                  S01119
0032 F********20      END OF TABLE2 FILE                          *****   S01194
0033 F********21      END OF CURRENCIES RECORDS ON TABLE FILE     *****   S01194
0034 F*       22      START/PURCH SETTLEMENT TYPE 01,07 OR 08.
0035 F*       23      DEAL TYPE - OP
0036 F********24      CURRENCY IN TABLE                           *****   S01194
0037 F*       25      TELEX INDICATOR ON
0038 F*       26      USED IN DATE COMPARISONS
0039 F*       27      USED IN DATE COMPARISONS
0040 F*       28      OPTION TO DATE ZERO
0041 F********29      DEAL TYPE IN TABLE                          *****   S01194
0042 F*       30      NEXT INTEREST DATE NOT ZERO
0043 F*       31      MATURITY DATE NOT ZERO
0044 F*       32      START/LAST INTEREST DATE ZERO
0045 F*       33      MATURITY CONFIRMATION REQUIRED
0046 F*       34      INTEREST CONFIRMATION REQUIRED
0047 F*       35      MATURITY/SALE SETTLEMENT TYPE IS 01,07 OR 08.
0048 F*       36      DEAL DETAIL RECORD IS A REVERSAL
0049 F*       37      CONFIRMATION CONTROL INDICATOR ON
0050 F*       40      SKIP FIRST CYCLE PROCESSING
0051 F*       41      MATURITY CONFIRMATION INDICATOR 'Y'
0052 F*       42      RECORD ID 'D'
0053 F*       45      LOCAL CURRENCY EQUALS CURRENCY READ FROM TABLE FILE
0054 F*       46      USED IN LOCAL CURRENCY COMPARISON
0055 F*       50      WRITE RECORD TO DEALS INDEX FILE
0056 F*       51      IMBALANCE IN PROGRAM CONTROLS
0057 F*       52      RECORD COUNTS DO NOT BALANCE
      *                                                                                       CDL033
      *       60      Work indicator                                                          CDL033
      *       61      Update of interest amount for CF deals                                  CDL033
      *                                                                                       CDL033
     F*       70      DEALING-TO-CHIPS INTERFACE PRESENT
     F*       71      PAYCHP SR. WORK INDICATOR
     F*       72      PAYCHP SR. WORK INDICATOR
     F*       73      SUPPRESS CHIPS PAYMENT OUTPUT
     F*       74      TLXI bit 4 is ON                                    185166
     F/COPY WNCPYSRC,DL0279FFP2                                           S01408
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279EEP1                                           S01408
      *                                                                   S01408
     E                    CPY@    1   1 80
0058 E***************     TABSET  3   3  2 0             *SETTLEMENT TYPESS01117
0059 E********************TABTYP  7   7  2               * DEAL TYPES     S01354
     E***********         TABTYP  9   9  2               * DEAL TYPS01354 CDL006
     E/COPY WNCPYSRC,DL0279E001
     E**********          TABTYP 15  15  2               * DEAL TYPES                  CDL006 CDL033
     E/COPY WNCPYSRC,DL0279E002
     E                    TABTYP 16  16  2               * DEAL TYPES                         CDL033
0060 E****                CCYA      150  3               * CURRENCIES     S01093
     E****TABTG30*******  CY      1 200  3   CYD    37CCY/CCYDETAILSS01093S01117
      * ARRAYS CN AND TNDA CAN COPE WITH 450 CCY/NOSTRO ELEMENTS          S01117
      * IN THE UNLIKELY EVENT PGM CRASHES BECAUSE A BANK TRADES WITH      S01117
      * LOTS OF CCY'S OR NOSTROS THEN ENLARGE THIS ARRAY.                 S01117
     E                    CN        450  5               * CCY/NOSTRO     S01117
     E                    TNDA      450  5 0             * TX NOTICE DATE S01117
0061 E****************    TNDA      150  5 0             * TX NOTICE DATE S01117
0062 E****************    HCCY       25  3               HOLIDAY CURENCIESS01117
0151 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYS01119
0152 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYS01119
0153 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY S01119
0153 E/COPY ZSRSRC,ZHOLE                                                  S01195
0153 E/COPY ZSRSRC,ZF2CE                                                  S01195
     E/COPY ZSRSRC,ZDATE9Z1                                               066550
     E                    FXT     5   5  2                                                    CDL033
     E/COPY WNCPYSRC,DLH00468
0063 I*
0064 I*****                                                       *****   S01194
0065 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.       *****   S01194
0066 I*****                                                       *****   S01194
0067 I*ABLE   NS  01   2 C0   3 C1  12 C1                         *****   S01194
0068 I*****  AND      13 C0                                       *****   S01194
0069 I*****                                   1   1 RECI          *****   S01194
0070 I*****                                   2   30RECT          *****   S01194
0071 I*****                                  12  130RCDE          *****   S01194
0072 I*****                                  14  66 TITL          *****   S01194
0073 I*****                                  67  67 DATF          *****   S01194
0074 I*****                                  68  700DFBR          S01117  S01194
0074 I*****                                  68  70 DFBM          S01117  S01194
     I*****                                  72  72 CHIM          *****   S01194
0075 I*****                                  74  74 MODI1         *****   S01194
0076 I*****                                  75  75 MODI2         *****   S01194
0077 I*****                                  76  76 MODI3         *****   S01194
0078 I*****                               P  77  790RUND          *****   S01194
0079 I*****                                  80  86 RUNA          *****   S01194
0080 I*****                                  87  870SFLG          *****   S01194
0081 I*****                               P  90  920LCD           *****   S01194
0082 I*****                                  93  93 CHTP          *****   S01194
0083 I*****                               P  94  960TNLU          *****   S01194
0084 I*****                                                       *****   S01194
0085 I*****                                                       *****   S01194
0086 I*ABLE   NS       1 CD   2 C0   3 C1                         *****   S01194
0087 I*****  AND      12 C1  13 C1                                *****   S01194
0088 I*****                                   1   1 RECI          *****   S01194
0089 I*****                                   2   30RECT          *****   S01194
0090 I*****                                  12  130RCDE          *****   S01194
0091 I*****                                  14  16 BCCY          *****   S01194
0092 I*****                                  17  19 BCYL          *****   S01194
0093 I*****                                  20  22 HOCY          *****   S01194
0094 I*****                                  23  280HEAD          *****   S01194
0095 I*****                               P  29  310APDA          *****   S01194
0096 I*****                                  35  35 APFQ          *****   S01194
0097 I*****                               P  36  380LOGS          *****   S01194
0098 I*****                                  39  40 CUZR          *****   S01194
0099 I*****                               P  41  430DNWD          *****   S01194
0100 I*****                                  44  460BVLP          *****   S01194
0101 I*****                                  47  49 LOCY          *****   S01194
0102 I*****                                  50  510FDAY          *****   S01194
0103 I*****                                  86  86 ISAV          *****   S01194
0104 I*****                               P  87  890LLOG          *****   S01194
0105 I*****                               P  90  920LCD           *****   S01194
0106 I*****                                  93  93 CHTP          *****   S01194
0107 I*****                               P  94  960TNLU          *****   S01194
0108 I*****                                                       *****   S01194
0109 I*****                                                       *****   S01194
0110 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 5.       *****   S01194
0111 I*****                                                       *****   S01194
0112 I*ABLE   NS  02   1 CD   2 C0   3 C1                         *****   S01194
0113 I*****  AND      12 C4  13 C0                                *****   S01194
0114 I*****                                   1   1 RECI          *****   S01194
0115 I*****                                   2   30RECT          *****   S01194
0116 I*****                                  12  130RCDE          *****   S01194
0117 I*****                                  18  210CSAC          *****   S01194
0118 I*****                                  22  22 TLII          *****   S01194
0119 I*****                                  23  23 MCRI          *****   S01194
0120 I*****                               P  24  250MCEP          *****   S01194
0121 I*****                                  26  270MCLP          *****   S01194
0122 I*****                                  28  28 FRDI          *****   S01194
0123 I*****                                  29  29 BRCF          *****   S01194
0124 I*****                                  30  350PSCN          *****   S01194
0125 I*****                                  36  380DLBR          S01117  S01194
0125 I*****                                  36  38 DLBR          S01117  S01194
0126 I*****                                  39  420FRPA          *****   S01194
0127 I*****                                  43  460FRPC          *****   S01194
0128 I*****                                  47  49 USCY          *****   S01194
0129 I*****                                  50  52 STCY          *****   S01194
0130 I*****                               P  53  553MBGE          *****   S01194
     I*****                               P  87  892TAXR          *****   S01119
0131 I*****                               P  90  920LCD           *****   S01194
0132 I*****                                  93  93 CHTP          *****   S01194
0133 I*****                               P  94  960TNLU          *****   S01194
0134 I*****TABLE FILE - HOLIDAY RECORD.                           *****   S01195
0135 I*****   E-EXCLUDE, I-INCLUDE.                               *****   S01195
0136 I*****                                                       *****   S01195
0137 I*ABLE   NS       1 CD   2 C2   3 C2                         *****   S01195
0138 I*****  AND      14 CE                                       *****   S01195
0139 I*****  OR        1 CD   2 C2   3 C2                         *****   S01195
0140 I*****  AND      14 CI                                       *****   S01195
0141 I*****                                   1   1 RECI          *****   S01195
0142 I*****                                   2   30RECT          *****   S01195
0143 I*****                                   8  120HOL           *****   S01195
0144 I*****                                  13  130SREC          *****   S01195
0145 I*****                                  14  14 INEX          *****   S01195
0146 I*****                                  15  89 HCCY          *****   S01195
0147 I*****                               P  90  920LCD           *****   S01195
0148 I*****                                  93  93 CHTP          *****   S01195
0149 I*****                               P  94  960TNLU          *****   S01195
0183 I*****                                                       S01119  S01194
0183 I*****TABLE FILE - BASE RATE & VALUE DATE OF RATE CHANGE - F S01119  S01194
0183 I*****                                                       S01119  S01194
     I*ABLE   NS       2 C2   3 C1                                S01119  S01194
0183 I*****                                                       S01119  S01194
     I*****                                   1   1 RECI          S01119  S01194
     I*****                               P  14  197BRTE          S01119  S01194
     I*****                               P  20  220VDRC          S01119  S01194
     I*****                               P  54  597NBRT          S01119  S01194
     I*****                               P  60  620VDNR          S01119  S01194
0150 I*****                                                       S01119  S01194
0151 I*****CATCHALL                                               *****   S01194
0152 I*****   NS                                                  *****   S01194
0153 I*****                                   1   1 RECI          *****   S01194
0154 I*****                                                       *****   S01194
0155 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01093
0156 I******                                                              S01093
0157 I*ABLE2  NS  03   1 CD   2 C2   3 C0                                 S01093
0158 I****** AND      13 C1                                               S01093
0159 I******                                  1   1 RECI                  S01093
0160 I******                                  2   30RECT                  S01093
0161 I******                                 10  12 CCY                   S01093
0162 I******                                 13  130SREC                  S01093
0163 I******                                 14  27 CCNM                  S01093
0164 I******                              P  28  348SPOT                  S01093
0165 I******                                 35  37 CCYS                  S01093
0166 I******                                 38  380CDP                   S01093
0167 I******                                 39  390TNOT                  S01093
0168 I******                                 40  40 DCCY                  S01093
0169 I******                                 41  44 SRC1                  S01093
0170 I******                                 45  48 SRC2                  S01093
0171 I******                                 49  520TACC                  S01093
0172 I******                                 53  560TEQV                  S01093
0173 I******                                 57  600SWQV                  S01093
0174 I******                                 61  640TAC4                  S01093
0175 I******                                 65  680TAC5                  S01093
0176 I******                                 69  69 HIND                  S01093
0177 I******                              P  70  768PART                  S01093
0178 I******                                 77  780SSNO                  S01093
0179 I******                              P  79  858ERLC                  S01093
0180 I******                              P  90  920LCD                   S01093
0181 I******                                 93  93 CHTP                  S01093
0182 I******                              P  94  960TNLU                  S01093
0183 I******                                                              S01093
0184 I******                                                              S01093
0185 I*****CATCHALL.                                                      S01093
0186 I******                                                              S01093
0187 I******  NS  04                                                      S01093
0188 I******                                  1   1 RECI                  S01093
0189 I******                                  2   30RECT                  S01093
0190 I******                                                              S01093
0191 I*
0192 I*    DEALS FILE - HEADER RECORD.
0193 I*
0194 IDEALS   NS  05   1 CH
0195 I                                        1   1 RECI
0196 I                                        2   70DLNO
0197 I                                        8   8 RCDT
0198 I                                        9  100RCDC
0199 I**********                             11  160CNUM                                      CSD027
0199 I                                       11  16 CNUM                                      CSD027
0200 I                                    P 394 3960LCD
0201 I                                      397 397 CHTP
0202 I                                    P 398 4000TNLU
0203 I*****                                   1 256 LOTA          *****   S01117
0204 I*****                                 257 400 LOTB          *****   S01117
0204 I*****                                 257 500 LOTB          *****   S01117
0205 I*
0206 I*
0207 I*    DEALS FILE - DETAIL RECORD - FX SWAPS/OUTRIGHTS.
0208 I*
0209 IDEALS   NS  06   1 CD   8 CB
0210 I       OR        1 CE   8 CB
0211 I       OR        1 CM   8 CB
0212 I       OR        1 CR   8 CB
0213 I                                        1   1 RECI
0214 I                                        2   70DLNO
0215 I                                        8   8 RCDT
0216 I                                        9  100RCDC
0217 I**********                             11  160CNUM                                      CSD027
0217 I                                       11  16 CNUM                                      CSD027
0218 I*****                                  17  190BRCD                  S01117
0218 I                                       17  19 BRCA                  S01117
0219 I                                       20  21 DTYP
0220 I                                       22  23 DLST
0221 I                                    P  24  260DDAT
0222 I                                    P  27  290VDAT
0223 I                                    P  30  320OTDT
0224 I                                       35  38 BRKC
0225 I                                    P  39  450BAGE
0226 I                                       46  48 PUCY
0227 I                                    P  49  550PUAM
0228 I                                    P  56  628EXRT
0229 I                                       86  88 SLCY
0230 I                                    P  89  950SLAM
0231 I                                    P 117 1230BCEQ
0232 I                                    P 131 1378LCXR
0233 I                                      138 1390PCST
0234 I**********                            140 151 OPCA                                      CGL029
     I                                      140 151 OPCAQQ                                    CGL029
0235 I                                      152 161 TSCN
0236 I                                      162 1630SCST
0237 I**********                            164 175 OSCA                                      CGL029
     I                                      164 175 OSCAQQ                                    CGL029
0238 I                                      176 185 TPCN
0239 I                                    P 192 1980ORPA
0240 I                                    P 205 2110ORSA
0241 I                                      212 2120FSLI
0242 I                                    P 241 2470SPPD
0243 I                                    P 248 2540SPLA
0244 I                                      255 257 SPLC
0245 I                                      285 2900SODN
0246 I                                      300 309 FACO
0247 I                                      310 344 SPI
0248 I                                      370 370 DNSI
0249 I                                      371 371 DSTI
0250 I                                      372 372 CNFI
0251 I                                      373 373 ACEI
0252 I                                      374 374 TLXI
0253 I                                    P 391 3930ORED
0254 I                                    P 394 3960LCD
0255 I                                      397 397 CHTP
0256 I                                    P 398 4000TNLU
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 ROBR                  S01117
     I                                     10471049 POBR                  S01123
     I                                     12001202 RSCY                  CEU003
     I                                     12031205 PSCY                  CEU003
     I                                     12061208 IC72                  CEU003
     I                                     12921309 OPCA                                      CGL029
     I                                     13101327 OSCA                                      CGL029
     I                                    P223622380BSDT1                                     CDL099
     I                                    P223922410BSDT2                                     CDL099
     I                                    P224222440BRSD2                                     CDL099
0257 I*****                                   1 256 LOTA          *****   S01117
0258 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
0259 I*
0260 I*
0261 I*    DEALS FILE - DETAIL - TAKINGS/PLACINGS/TIME DEPOSITS/LOANS.
0262 I*
0263 I        NS  07   1 CD   8 CC
0264 I       OR        1 CE   8 CC
0265 I       OR        1 CM   8 CC
0266 I       OR        1 CR   8 CC
0267 I                                        1   1 RECI
0268 I                                        2   70DLNO
0269 I                                        8   8 RCDT
0270 I                                        9  100RCDC
0271 I**********                             11  160CNUM                                      CSD027
0271 I                                       11  16 CNUM                                      CSD027
0272 I*****                                  17  190BRCD                  S01117
0272 I                                       17  19 BRCA                  S01117
0273 I                                       20  21 DTYP
0274 I                                       22  23 DLST
0275 I                                    P  24  260DDAT
0276 I                                    P  27  290VDAT
0277 I                                    P  30  320MDAT
0278 I                                       33  340CDAS
0279 I                                       35  38 BRKC
0280 I                                    P  39  450BAGE
0281 I                                       46  48 CCY
0282 I                                    P  49  550PCPL
0283 I                                       56  56 INTC
0284 I**********                             63  640BRTT                                      CSD103
0284 I                                       63  64 BRTT                                      CSD103
0285 I                                    P  65  707BRTE
0286 I                                    P  71  767RTSP
0287 I                                    P  77  827INTR
0288 I                                       83  850NOTD
0289 I                                       86 105 RNNA
0290 I**********                            106 1110CHNA                                      CSD027
0290 I                                      106 111 CHNA                                      CSD027
0291 I                                      112 1140FACT
0292 I                                      115 1160FCNO
0293 I                                    P 117 1230OPAM
0294 I                                    P 124 1308BCXR
0295 I                                    P 131 1378LCXR
0296 I                                      138 1390SDST
0297 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0298 I                                      152 161 TSTN
0299 I                                      162 1630MDST
0300 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0301 I                                      176 185 TMAN
0302 I                                      186 1910RODN
0303 I                                    P 192 1980RODA
0304 I                                      199 2040RBDN
0305 I                                    P 205 2110RBDA
0306 I                                      212 2120ICBS
0307 I                                      213 213 IPFR
0308 I                                    P 214 2200TOTI
0309 I                                    P 221 2230NIDT
0310 I                                    P 224 2260IBDT
0311 I                                    P 227 2290SLID
0312 I                                    P 230 2360AIPD
0313 I                                    P 237 2390DLRC
0314 I                                    P 240 2420IACD
0315 I                                    P 243 2490AITC
0316 I                                    P 250 2560AIAN
0317 I                                    P 257 2630AIAP
0318 I                                    P 264 2700IPRD
0319 I                                    P 271 2770IPRM
0320 I                                    P 278 2840ICTD
0321 I                                    P 294 2960DAVD
0322 I                                      297 2990DASN
0323 I                                      300 309 FACO
0324 I                                      310 344 SPI
0325 I                                      345 3460INTF
0326 I                                      370 370 DNSI
0327 I                                      371 371 DSTI
0328 I                                      372 372 CNFI
0329 I                                      373 373 ACEI
0330 I                                      374 374 TLXI
0331 I                                    P 391 3930ORED
0332 I                                    P 394 3960LCD
0333 I                                      397 397 CHTP
0334 I                                    P 398 4000TNLU
     I                                     10571059 ORBR                  S01117
     I                                     10601063 PRFC                  S01117
     I                                     10641066 ROBR                  S01117
     I                                     10671069 POBR                  S01123
     I/COPY WNCPYSRC,DL0279I003
     I                                     10721072 JRDFC                                     CDL033
     I                                     10751075 AURO                  S01434
     I                                     10761076 IPDS                  CEU003
     I                                     12251227 STCY                  CEU003
     I                                     12281230 IC72                  CEU003
     I                                     12311233 ISCY                  CEU003
     I                                     12341236 II72                  CEU003
     I                                     17211738 OSDA                                      CGL029
     I                                     17391756 OMDA                                      TDA099
     I                                    P185118530XKRCDT                                    CDL033
     I                                     18791879 XKBSVF                                    CDL033
     I                                    P188218840XKINFD                                    CDL033
     I                                     18851885 XKINFF                                    CDL033
     I                                    P188618910XKBSRF                                    CDL033
     I                                     18921892 XKFRCI                                    CDL033
     I**********                           16901707 OMDA                               CGL029 TDA099
0335 I*****                                   1 256 LOTA          *****   S01117
0336 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
0337 I*
0338 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS PURCHASED.
0339 I*
0340 I        NS  08   1 CD   8 CD
0341 I       OR        1 CE   8 CD
0342 I       OR        1 CM   8 CD
0343 I       OR        1 CR   8 CD
0344 I                                        1   1 RECI
0345 I                                        2   70DLNO
0346 I                                        8   8 RCDT
0347 I                                        9  100RCDC
0348 I**********                             11  160ISCN                                      CSD027
0348 I                                       11  16 ISCN                                      CSD027
0349 I*****                                  17  190BRCD                  S01117
0349 I                                       17  19 BRCA                  S01117
0350 I                                       20  21 DTYP
0351 I                                       22  23 DLST
0352 I                                    P  24  260DDAT
0353 I                                    P  27  290VDAT
0354 I                                    P  30  320MDAT
0355 I                                       33  340IDAS
0356 I                                       35  38 BRKC
0357 I                                    P  39  450BAGE
0358 I                                       46  48 CCY
0359 I                                    P  49  550PUPR
0360 I                                    P  57  627YRAT
0361 I                                    P  71  767RTSP
0362 I                                    P  77  827INTR
0363 I                                       86 105 RNNA
0364 I**********                            106 1110PCUS                                      CSD027
0364 I                                      106 111 PCUS                                      CSD027
0365 I                                      112 1140FACT
0366 I                                      115 1160FCNO
0367 I                                    P 117 1230FVAL
0368 I                                    P 124 1308BCXR
0369 I                                    P 131 1378LCXR
0370 I                                      138 1390SDST
0371 I**********                            140 151 OSDA                                      CGL029
     I                                      140 151 OSDAQQ                                    CGL029
0372 I                                      152 161 TSTN
0373 I                                      162 1630MDST
0374 I**********                            164 175 OMDA                                      CGL029
     I                                      164 175 OMDAQQ                                    CGL029
0375 I                                      176 185 TMAN
0376 I                                    P 192 1980DISA
0377 I                                    P 205 2110DPTD
0378 I                                      212 2120ICBS
0379 I                                      213 213 IPFR
0380 I                                    P 214 2200TOTI
0381 I                                    P 221 2230NIDT
0382 I                                    P 224 2260IBDT
0383 I                                    P 227 2290SLID
0384 I                                    P 230 2360AIPD
0385 I                                    P 237 2390DLRC
0386 I                                    P 240 2420IACD
0387 I                                    P 243 2490AITC
0388 I                                    P 250 2560AIAN
0389 I                                    P 257 2630AIAP
0390 I                                    P 264 2700IPRD
0391 I                                    P 271 2770IPRM
0392 I                                    P 278 2840SAPR
0393 I                                      285 2900ASDN
0394 I                                    P 291 2930SADT
0395 I                                    P 294 2960DAVD
0396 I                                      297 2990DASN
0397 I                                      300 309 FACO
0398 I                                      310 344 SPI
0399 I                                      345 3460INTF
0400 I                                      370 370 DNSI
0401 I                                      371 371 DSTI
0402 I                                      372 372 CNFI
0403 I                                      373 373 ACEI
0404 I                                      374 374 TLXI
0405 I                                    P 391 3930ORED
0406 I                                    P 394 3960LCD
0407 I                                      397 397 CHTP
0408 I                                    P 398 4000TNLU
     I                                     10371039 ORBR                  S01117
     I                                     10401043 PRFC                  S01117
     I                                     10441046 ROBR                  S01117
     I                                     10471049 POBR                  S01123
     I                                     11291131 STCY                  CEU003
     I                                     11321134 IC72                  CEU003
     I                                     12451262 OSDA                                      CGL029
     I                                     12631280 OMDA                                      CGL029
0409 I*****                                   1 256 LOTA          *****   S01117
0410 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
0411 I*
0412 I*
0413 I*    DEALS FILE - DETAIL RECORD - NEGOTIABLE ASSETS SOLD.
0414 I*
0415 I        NS  09   1 CD   8 CE
0416 I       OR        1 CE   8 CE
0417 I       OR        1 CM   8 CE
0418 I       OR        1 CR   8 CE
0419 I                                        1   1 RECI
0420 I                                        2   70DLNO
0421 I                                        8   8 RCDT
0422 I                                        9  100RCDC
0423 I**********                             11  160ISCN                                      CSD027
0423 I                                       11  16 ISCN                                      CSD027
0424 I*****                                  17  190BRCD                  S01117
0424 I                                       17  19 BRCA                  S01117
0425 I                                       20  21 DTYP
0426 I                                       22  23 DLST
0427 I                                    P  24  260DDAT
0428 I                                    P  27  290VDAT
0429 I                                       35  38 BRKC
0430 I                                    P  39  450BAGE
0431 I                                       46  48 CCY
0432 I                                    P  49  550SAPRX
0433 I                                    P  57  627YRAT
0434 I                                    P  77  827INTR
0435 I                                       86 105 RNNA
0436 I**********                            106 1110SCUS                                      CSD027
0436 I                                      106 111 SCUS                                      CSD027
0437 I                                    P 117 1230FVAL
0438 I                                      138 1390SETP
0439 I**********                            140 151 OSAC                                      CGL029
     I                                      140 151 OSACQQ                                    CGL029
0440 I                                      152 161 TSEN
0441 I                                      285 2900RPDN
0442 I                                      370 370 DNSI
0443 I                                      371 371 DSTI
0444 I                                      372 372 CNFI
0445 I                                      373 373 ACEI
0446 I                                      374 374 TLXI
0447 I                                    P 391 3930ORED
0448 I                                    P 394 3960LCD
0449 I                                      397 397 CHTP
0450 I                                    P 398 4000TNLU
     I                                      162 164 ORBR                  S01117
     I                                      165 167 ROBR                  S01117
     I                                      168 171 PRFC                  S01123
     I                                     10421044 STCY                  CEU003
     I                                     10451047 IC72                  CEU003
     I                                     10481065 OSAC                                      CGL029
0451 I*****                                   1 256 LOTA          *****   S01117
0452 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
     I*                                                                   S01119
     I*                                                                   S01119
     I*    DEALS FILE - DETAIL - FRA/IRS                                  S01119
     I*                                                                   S01119
     IDEALS   NS  12   1 CD   8 CG                                        S01119
     I       OR        1 CE   8 CG                                        S01119
     I       OR        1 CM   8 CG                                        S01119
     I       OR        1 CR   8 CG                                        S01119
     I                                        1   1 RECI                  S01119
     I                                        2   70DLNO                  S01119
     I                                        8   8 RCDT                  S01119
     I                                        9  100RCDC                  S01119
     I**********                             11  160CNUM                               S01119 CSD027
     I                                       11  16 CNUM                                      CSD027
     I*****                                  17  190BRCD          S01119  S01117
     I                                       17  19 BRCA                  S01117
     I                                       20  21 DTYP                  S01119
     I                                       22  23 DLST                  S01119
     I                                    P  24  260DDAT                  S01119
     I                                    P  27  290VDAT                  S01119
     I                                    P  30  320MDAT                  S01119
     I                                       33  340CDAS                  S01119
     I                                       35  38 BRKC                  S01119
     I                                    P  39  450BAGE                  S01119
     I                                       46  510LNKDN                 S01119
     I                                       52  52 HEDIN                 S01119
     I                                       53  53 TAXI                  S01119
     I                                       54  56 UCUCY                 S01119
     I                                    P  57  630UPAMT                 S01119
     I**********                             64  650UBRTT                              S01119 CSD103
     I                                       64  65 UBRTT                                     CSD103
     I                                    P  66  717USTRT                 S01119
     I                                    P  72  777UBRTE                 S01119
     I                                    P  78  837URTSP                 S01119
     I                                       84  84 USPIN                 S01119
     I                                    P  85  907UEINR                 S01119
     I                                       91  910UICBS                 S01119
     I                                       92  930UFRFD                 S01119
     I                                    P  94  960UINFD                 S01119
     I                                    P  97  990USLIP                 S01119
     I                                    P 100 1020UNICD                 S01119
     I                                    P 103 1050UICBD                 S01119
     I                                      106 106 UICFR                 S01119
     I                                      107 1080UICFD                 S01119
     I                                    P 109 1110UNIPD                 S01119
     I                                    P 112 1140UIPBD                 S01119
     I                                      115 115 UIPFR                 S01119
     I                                      116 1170UIPFD                 S01119
     I                                    P 118 1248UBCXR                 S01119
     I                                    P 125 1270UIACD                 S01119
     I                                    P 128 1340UIALC                 S01119
     I                                    P 135 1410UAITC                 S01119
     I                                    P 142 1480UAIPD                 S01119
     I                                    P 149 1550UAIAN                 S01119
     I                                    P 156 1620UAIAP                 S01119
     I                                    P 163 1690UIPRD                 S01119
     I                                    P 170 1760UIPRM                 S01119
     I                                    P 177 1830UNSAM                 S01119
     I                                    P 184 1900UTAXD                 S01119
     I                                    P 191 1970UTAXM                 S01119
     I                                      198 200 TCUCY                 S01119
     I                                    P 201 2070TPAMT                 S01119
     I**********                            208 2090TBRTT                              S01119 CSD103
     I                                      208 209 TBRTT                                     CSD103
     I                                    P 210 2157TSTRT                 S01119
     I                                    P 216 2217TBRTE                 S01119
     I                                    P 222 2277TRTSP                 S01119
     I                                      228 228 TSPIN                 S01119
     I                                    P 229 2347TEINR                 S01119
     I                                      235 2350TICBS                 S01119
     I                                      236 2370TFRFD                 S01119
     I                                    P 238 2400TINFD                 S01119
     I                                    P 241 2430TSLIP                 S01119
     I                                    P 244 2460TNICD                 S01119
     I                                    P 247 2490TICBD                 S01119
     I                                      250 250 TICFR                 S01119
     I                                      251 2520TICFD                 S01119
     I                                    P 253 2550TNIPD                 S01119
     I                                    P 256 2580TIPBD                 S01119
     I                                      259 259 TIPFR                 S01119
     I                                      260 2610TIPFD                 S01119
     I                                    P 262 2688TBCXR                 S01119
     I                                    P 269 2710TIACD                 S01119
     I                                    P 272 2780TIALC                 S01119
     I                                    P 279 2850TAITC                 S01119
     I                                    P 286 2920TAIPD                 S01119
     I                                    P 293 2990TAIAN                 S01119
     I                                    P 300 3060TAIAP                 S01119
     I                                    P 307 3130TIPRD                 S01119
     I                                    P 314 3200TIPRM                 S01119
     I                                    P 321 3270TNSAM                 S01119
     I                                    P 328 3340TTAXD                 S01119
     I                                    P 335 3410TTAXM                 S01119
     I                                    P 342 3477CLRAT                 S01119
     I                                    P 348 3537FLRAT                 S01119
     I                                    P 354 3550AVPER                 S01119
     I                                    P 356 3638TIRAT                 S01119
     I                                    P 364 3697AACRT                 S01119
     I                                      370 3710RSETM                 S01119
     I**********                            372 383 URACC                              S01119 CGL029
     I                                      372 383 URACQQ                                    CGL029
     I                                      384 393 CPPBK                 S01119
     I                                      394 3950PSETM                 S01119
     I**********                            396 407 UPACC                              S01119 CGL029
     I                                      396 407 UPACQQ                                    CGL029
     I                                      408 417 CPRBK                 S01119
     I                                      418 427 FACO                  S01119
     I                                      428 462 SPI                   S01119
     I                                    P 463 4650SDCAR                 S01119
     I                                    P 466 4680ULPCD                 S01119
     I                                    P 469 4710TLPCD                 S01119
     I                                    P 472 4780UAEXA                 S01119
     I                                    P 479 4850TAEXA                 S01119
     I/COPY WNCPYSRC,DL0279I002
     I                                      569 569 BYSL                                      246437
     I                                      570 570 UDNSI                 S01119
     I                                      571 571 TDNSI                 S01119
     I                                      572 572 UDSTI                 S01119
     I                                      573 573 TDSTI                 S01119
     I                                      574 574 CNFI                  S01119
     I                                      575 575 ACEI                  S01119
     I                                      576 576 TLXI                  S01119
     I                                      577 577 SETF                  AUS021
     I                                    P 587 5880LSWC                  S01119
     I                                    P 589 5900LSWS                  S01119
     I                                    P 591 5930ORED                  S01119
     I                                    P 594 5960LCD                   S01119
     I                                      597 597 CHTP                  S01119
     I                                    P 598 6000TNLU                  S01119
     I                                      616 616 UINPM                 CIR001
     I                                    P 617 6190UNPCD                 CIR001
     I                                      620 620 TINPM                 CIR001
     I                                    P 621 6230TNPCD                 CIR001
     I                                    P 624 6260UPVD                  CIR001
     I                                    P 627 6330UPFE                  CIR001
     I                                      634 634 UPPR                  CIR001
     I                                    P 635 6410UPAD                  CIR001
     I                                    P 642 6440BODD                  CIR001
     I                                    P 645 6470BOVD                  CIR001
     I                                    P 648 6540BOAM                  CIR001
     I                                      655 655 BAPR                  CIR001
     I                                    P 656 6630OUSI                  CIR001
     I                                    P 664 6710OUSA                  CIR001
     I                                    P 672 6790TUSI                  CIR001
     I                                    P 680 6870TUSA                  CIR001
     I                                      688 688 URFIN                 CSW005
     I                                      689 689 TRFIN                 CSW005
     I                                     19951995 VDEI                  CIR003
     I                                     19961996 MDEI                  CIR003
     I                                     19971997 PDEI                  CIR003
     I                                     19982000 RSCY                  CEU003
     I                                     20012003 PSCY                  CEU003
     I                                     20042006 IC72                  CEU003
     I                                     20952096 L1AMCN                CIR005
     I                                     21592160 L2AMCN                CIR005
     I                                     24692486 URACC                                     CGL029
     I                                     24872504 UPACC                                     CGL029
     I                                    P255125530FSOSDT                                   BUG7543
     I**********                          P255425550FSOS1B                            BUG7543 CSD103
     I                                     25542555 FSOS1B                                    CSD103
     I                                    P255625580FSOS1D                                   BUG7543
     I**********                          P255925600FSOS2B                            BUG7543 CSD103
     I                                     25592560 FSOS2B                                    CSD103
     I                                    P256125630FSOS2D                                   BUG7543
     I                                    P256425660FSOEDT                                   BUG7543
     I**********                          P256725680FSOE1B                            BUG7543 CSD103
     I                                     25672568 FSOE1B                                    CSD103
     I                                    P256925710FSOE1D                                   BUG7543
     I**********                          P257225730FSOE2B                            BUG7543 CSD103
     I                                     25722573 FSOE2B                                    CSD103
     I                                    P257425760FSOE2D                                   BUG7543
     I                                    P257725790FSTSDT                                   BUG7543
     I**********                          P258025810FSTS1B                            BUG7543 CSD103
     I                                     25802581 FSTS1B                                    CSD103
     I                                    P258225840FSTS1D                                   BUG7543
     I**********                          P258525860FSTS2B                            BUG7543 CSD103
     I                                     25852586 FSTS2B                                    CSD103
     I                                    P258725890FSTS2D                                   BUG7543
     I                                    P259025920FSTEDT                                   BUG7543
     I**********                          P259325940FSTE1B                            BUG7543 CSD103
     I                                     25932594 FSTE1B                                    CSD103
     I                                    P259525970FSTE1D                                   BUG7543
     I**********                          P259825990FSTE2B                            BUG7543 CSD103
     I                                     25982599 FSTE2B                                    CSD103
     I                                    P260026020FSTE2D                                   BUG7543
     I/COPY WNCPYSRC,DL0279I001
0451 I*****                                   1 256 LOTA          S01119  S01117
0410 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
     I*****                                 501 600 LOTC          S01119  S01117
0453 I*
0454 I*
0455 I*    DEALS FILE -TRAILER RECORD.
0456 I*
0457 I        NS  10   1 CT
0458 I                                        1   1 RECI
0459 I                                        2   70DLNO
0460 I                                        8   8 RCDT
0461 I                                        9  100RCDC
0462 I**********                             11  160CNUM                                      CSD027
0462 I                                       11  16 CNUM                                      CSD027
0463 I                                    P  17  190NORE
0464 I                                    P  20  220FLSZ
0465 I                                    P  23  250NLRB
0466 I                                    P  26  280NINS
0467 I                                    P  29  310NDEL
0468 I                                    P  32  340NLRA
0469 I                                    P  35  420VLBF
0470 I                                    P  43  440VLBL
0471 I                                    P  45  520VRIF
0472 I                                    P  53  540VRIL
0473 I                                    P  55  620VRDF
0474 I                                    P  63  640VRDL
0475 I                                    P  65  720VLAF
0476 I                                    P  73  740VLAL
0477 I                                    P  75  770DTMR
0478 I                                    P  78  800ITMR
0479 I                                    P 394 3960LCD
0480 I                                      397 397 CHTP
0481 I                                    P 398 4000TNLU
0482 I*****                                   1 256 LOTA          *****   S01117
0483 I*****                                 257 400 LOTB          *****   S01117
     I*****                                 257 500 LOTB          *****   S01117
0484 I*
0485 I*
0486 I*    DEALS FILE - CATCHALL.
0487 I*
0488 I        NS  11
0489 I*
0490 I*
0491 I*
0492 I*    DATA STRUCTURE - DEAL AMOUNTS.
0493 I            DS
0494 I                                        1  130AMT
0495 I                                        1  130PUAM
0496 I                                        1  130PCPL
0497 I                                        1  130PUPR
0498 I                                        1  130SAPRX
     I                                        1  130UPAMT                 S01119
0499 I*
0500 I*
0501 I*    DATA STRUCTURE - SETTLEMENT TYPES.
0502 I*
0503 I            DS
      * SETTLEMENT METHOD (1ST SIDE OF SETTLEMENT DETAILS)                S01117
0504 I                                        1   20STYP1
0505 I                                        1   20PCST
0506 I                                        1   20SDST
0507 I                                        1   20SETP
     I                                        1   20PSETM                 S01119
      * SETTLEMENT DETAILS (1ST SIDE OF SETTLEMENT DETAILS)               S01117
     I**********                              3  14 OPCA                               S01117 CGL029
     I**********                              3  14 OSDA                               S01117 CGL029
     I**********                              3  14 OSAC                               S01117 CGL029
     I**********                              3  14 UPACC                              S01117 CGL029
     I                                        3  20 OPCA                                      CGL029
     I                                        3  20 OSDA                                      CGL029
     I                                        3  20 OSAC                                      CGL029
     I                                        3  20 UPACC                                     CGL029
      * NOSTRO CODE (1ST SIDE OF SETTLEMENT DETAILS)                      S01117
     I                                        3   4 SNOS1                 S01117
      * SETTLEMENT METHOD (2ND SIDE OF SETTLEMENT DETAILS)                S01117
     I**********                             15  160STYP2                              S01117 CGL029
     I**********                             15  160SCST                               S01117 CGL029
     I**********                             15  160MDST                               S01117 CGL029
     I**********                             15  160RSETM                              S01117 CGL029
     I                                       21  220STYP2                                     CGL029
     I                                       21  220SCST                                      CGL029
     I                                       21  220MDST                                      CGL029
     I                                       21  220RSETM                                     CGL029
      * SETTLEMENT DETAILS (2ND SIDE OF SETTLEMENT DETAILS)               S01117
     I**********                             17  28 OSCA                               S01117 CGL029
     I**********                             17  28 OMDA                               S01117 CGL029
     I**********                             17  28 URACC                              S01117 CGL029
     I                                       23  40 OSCA                                      CGL029
     I                                       23  40 OMDA                                      CGL029
     I                                       23  40 URACC                                     CGL029
      * NOSTRO CODE (2ND SIDE OF SETTLEMENT DETAILS)                      S01117
     I**********                             17  18 SNOS2                              S01117 CGL029
     I                                       23  24 SNOS2                                     CGL029
      *                                                                   S01117
0508 I*********                               3   40STYP2                 S01117
0509 I*********                               3   40SCST                  S01117
0510 I*********                               3   40MDST                  S01117
     I*********                               3   40RSETM          S01119 S01117
     I*****CURRENCY DETAILS FROM TABTG10                   *******S01119  S01194
     ICYDDS       DS                                                      S01119
     I*****                                   1   10CDP    *******S01119  S01194
     I*****                               P   2   88SPOT   *******S01119  S01194
     I*****                                   9   90MDIN   *******S01119  S01194
     I*****                               P  10  168ERLC   *******S01119  S01194
     I**********                             17  170TNOT                               S01119 CGL029
     I                                       23  230TNOT                                      CGL029
     I*****                                  18  31 CCNM   *******S01119  S01194
     I*****                                  32  35 TEAC   *******S01119  S01194
     I*****                                  36  370SSNO   *******S01119  S01194
0392 ISDBANK    E DSSDBANKPD                                              S01194
0393 I* BANK DETAILS ACCESSED VIA ACCESS PROGRAM                          S01194
0393 I*                                                                   S01194
     I/COPY WNCPYSRC,DL0279I004
      *                                                                                       CDL033
      ** Externally described DS for General Ledger ICD Details                               CDL033
      *                                                                                       CDL033
     ISDGELR    E DSSDGELRPD                                                                  CDL033
     I              QQACCD                          QQACCE                                    CDL033
      *                                                                                       CDL033
0392 ISDBSRT    E DSSDBSRTPD                                              S01194
0393 I* BASE RATE DETAILS ACCESSED VIA ACCESS PROGRAM                     S01194
0393 I*                                                                   S01194
0392 ISDCURR    E DSSDCURRPD                                              S01194
0393 I* CURRENCY DETAILS ACCESSED VIA ACCESS PROGRAM                      S01194
0393 I*                                                                   S01194
0392 ISDDEAL    E DSSDDEALPD                                              S01194
0393 I* DEALING DETAILS ACCESSED VIA ACCESS PROGRAM                       S01194
0393 I*                                                                   S01194
0392 ISDMMOD    E DSSDMMODPD                                              S01194
0393 I* MODULE DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
0393 I*                                                                   S01194
0392 ISDNOST    E DSSDNOSTPD                                              S01194
0393 I* NOSTRO DETAILS ACCESSED VIA ACCESS PROGRAM                        S01194
     I              QQACCD                          QQACCX                                    CGL029
     I*
     ISCSARD    E DSSCSARDPD                                              CIR001
      ** SAR descriptions                                                 CIR001
      *                                                                   CIR001
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
0393 I*                                                                   S01194
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I/COPY ZSRSRC,ZF2CI                                                  S01195
     I/COPY ZSRSRC,ZINTDYZ1                                               066550
     I/COPY ZSRSRC,ZDATE9Z2                                               066550
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279IIP1                                           S01408
      ** Data Structure for OIS Held Events File.                                             CIR007
     IL4EREC      DS                                                                          CIR007
     I                                    P  21  270EAMT                                      CIR007
     I                                       28  30 ECCY                                      CIR007
     I                                    P  57  630OTHA                                      CIR007
     I                                       64  66 OTHC                                      CIR007
      *                                                                   S01408
     I              'LECalcBasis6LeapYear'C         WPARML                                  MD035545
0511 I/EJECT
     I/COPY WNCPYSRC,DL0279I005
0512 C*
0513 C*    COUNT OF RECORDS READ.
0514 C           RECN      ADD  1         RECN    50
     C/COPY WNCPYSRC,DL0279C094
0515 C*
0516 C*    SKIP FIRST CYCLE PROCESSING.
0517 C   40                GOTO ENDFC
0518 C*
0519 C**************************
0520 C*
0521 C*    FIRST CYCLE PROCESSING
     C                     MOVEACPY@      BIS@   80
      *                                                                   CIR001
     C           IRSCFL    KLIST                                          CIR001
     C                     KFLD           DLNO                            CIR001
     C                     KFLD           OTIN                            CIR001
     C                     KFLD           PRDT                            CIR001
      *                                                                   CIR001
     C           IRSDTL    KLIST                                          CIR001
     C                     KFLD           DLNO                            CIR001
     C                     KFLD           OTIN                            CIR001
     C                     KFLD           RCIP                            CIR001
     C                     KFLD           PRDT                            CIR001
      *                                                                   CIR001
     C           IRSDTP    KLIST                                          CIR001
     C                     KFLD           DLNO                            CIR001
     C                     KFLD           OTIN                            CIR001
     C                     KFLD           RCIP                            CIR001
      *                                                                   CIR003
     C           WDLKEY    KLIST                                          CIR003
     C                     KFLD           DLNO                            CIR003
     C                     KFLD           KEDCD                           CIR003
      *                                                                   CIR003
     C           WDLPKY    KLIST                                          CIR003
     C                     KFLD           DLNO                            CIR003
     C                     KFLD           KUOTIN                          CIR003
     C                     KFLD           KPRDT                           CIR003
0522 C*
0523 C*****ACCESS INSTALLATION CONTROL DATA RECORD 1.             *****   S01194
0524 C*****                EXSR ZSYSTM                            *****   S01194
0525 C*****                                                       *****   S01194
0526 C*****ACCESS INSTALLATION CONTROL DATA RECORD 2.             *****   S01194
0527 C*****                MOVEL'01      'TABKEY 12               *****   S01194
0528 C*****                MOVE '  11'    TABKEY                  *****   S01194
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'001'     DBASE   3        * DBERR 001 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@OPTN     DBKEY  29                       S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
     C* Correctly work out Date Format                                    066600
     C*                                                                   066600
     C           BJDFIN    COMP 'M'                      98MMDDYY,*98*ON  066600
     C/COPY WNCPYSRC,DL0279C038
      ** Access AOSARDR0 and check if CIR007 is installed                                     CIR007
     C                     CALL 'AOSARDR0'                                                    CIR007
     C                     PARM *BLANKS   PRTCD                                               CIR007
     C                     PARM '*VERIFY' POPTN                                               CIR007
     C                     PARM 'CIR007'  PSARD                                               CIR007
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR007
     C           PRTCD     IFNE *BLANKS                                                       CIR007
     C           PRTCD     ANDNE'*NRF    '                                                    CIR007
     C                     MOVE 'SCSARDPD'DBFILE           ***************                    CIR007
     C                     MOVEL'020'     DBASE            * DB ERROR 20 *                    CIR007
     C                     MOVEL'CIR007'  DBKEY            ***************                    CIR007
     C                     SETON                     U7U8LR                                   CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
     C           PRTCD     IFEQ *BLANKS                                                       CIR007
     C                     MOVE 'Y'       CIR007  1                                           CIR007
     C                     ELSE                                                               CIR007
     C                     MOVE 'N'       CIR007                                              CIR007
     C                     ENDIF                                                              CIR007
     C*                                                                   066600
      *                                                                   CIR001
      ** Access AOSARDR0 to check if CIR001 is switched on                CIR001
      *                                                                   CIR001
     C                     CALL 'AOSARDR0'                                CIR001
     C                     PARM *BLANKS   @RTCD   7                       CIR001
     C                     PARM '*VERIFY' @OPTN   7                       CIR001
     C                     PARM 'CIR001'  @SARD   6                       CIR001
     C           SCSARD    PARM SCSARD    DSFDY                           CIR001
      *                                                                   CIR001
     C           @RTCD     IFEQ *BLANKS                                   CIR001
     C                     MOVE 'Y'       CIR001  1                       CIR001
     C                     OPEN DLCFSCPD                                  CIR001
     C                     OPEN DLDTSCPD                                  CIR001
     C                     ELSE                                           CIR001
     C                     MOVE 'N'       CIR001                          CIR001
     C                     END                                            CIR001
      *                                                                   CIR002
      ** Access AOSARDR0 to check if CIR002 is switched on                CIR002
      *                                                                   CIR002
     C                     CALL 'AOSARDR0'                                CIR002
     C                     PARM *BLANKS   @RTCD   7                       CIR002
     C                     PARM '*VERIFY' @OPTN   7                       CIR002
     C                     PARM 'CIR002'  @SARD   6                       CIR002
     C           SCSARD    PARM SCSARD    DSFDY                           CIR002
      *                                                                   CIR002
     C           @RTCD     IFEQ *BLANKS                                   CIR002
     C                     MOVE 'Y'       CIR002  1                       CIR002
     C                     ELSE                                           CIR002
     C                     MOVE 'N'       CIR002                          CIR002
     C                     END                                            CIR002
     C/COPY WNCPYSRC,DL0279C041
      *                                                                   CEU003
      ** Access AOSARDR0 to check if CEU003 is installed                  CEU003
      *                                                                   CEU003
     C                     CALL 'AOSARDR0'                                CEU003
     C                     PARM *BLANKS   @RTCD   7                       CEU003
     C                     PARM '*VERIFY' @OPTN   7                       CEU003
     C                     PARM 'CEU003'  @SARD   6                       CEU003
      *                                                                   CEU003
     C           @RTCD     IFEQ *BLANKS                                   CEU003
     C                     MOVE 'Y'       CEU003  1                       CEU003
     C                     ELSE                                           CEU003
     C                     MOVE 'N'       CEU003                          CEU003
     C                     END                                            CEU003
      *                                                                   CEU003
     C/COPY WNCPYSRC,DL0279C010
      *                                                                   CIR002
      ** Access AOSARDR0 to check if CSW005 is switched on                CSW005
      *                                                                   CSW005
     C                     CALL 'AOSARDR0'                                CSW005
     C                     PARM *BLANKS   @RTCD   7                       CSW005
     C                     PARM '*VERIFY' @OPTN   7                       CSW005
     C                     PARM 'CSW005'  @SARD   6                       CSW005
     C           SCSARD    PARM SCSARD    DSFDY                           CSW005
      *                                                                   CSW005
     C           @RTCD     IFEQ *BLANKS                                   CSW005
     C                     MOVE 'Y'       CSW005  1                       CSW005
     C                     ELSE                                           CSW005
     C                     MOVE 'N'       CSW005                          CSW005
     C                     END                                            CSW005
      *                                                                   CIR004
      ** Access Switchable Features Details                               CIR004
      *                                                                   CIR004
     C                     CALL 'AOSARDR0'                                CIR004
     C                     PARM *BLANKS   PRTCD   7                       CIR004
     C                     PARM '*VERIFY 'POPTN   7                       CIR004
     C                     PARM 'CIR004'  PSARD   6                       CIR004
     C           SCSARD    PARM SCSARD    DSFDY                           CIR004
     C           PRTCD     IFEQ *BLANKS                                   CIR004
     C                     MOVE 'Y'       CIR004  1                       CIR004
     C                     ELSE                                           CIR004
     C                     MOVE 'N'       CIR004                          CIR004
     C                     ENDIF                                          CIR004
      *                                                                   CIR005
      ** Check if switchable feature CIR005 is switched on                CIR005
      *                                                                   CIR005
     C                     CALL 'AOSARDR0'                                CIR005
     C                     PARM *BLANKS   @RTCD                           CIR005
     C                     PARM '*VERIFY' @OPTN                           CIR005
     C                     PARM 'CIR005'  @SARD                           CIR005
     C           SCSARD    PARM SCSARD    DSFDY                           CIR005
      *                                                                   CIR005
     C           @RTCD     IFNE *BLANK                                    CIR005
     C           @RTCD     ANDNE'*NRF   '                                 CIR005
     C                     MOVEL'SCSARDPD'DBFILE           ************   CIR005
     C                     MOVEL'007'     DBASE            * DBERR 07 *   CIR005
     C                     MOVEL'CIR005'  DBKEY            ************   CIR005
     C                     MOVE *ON       *INU7                           CIR005
     C                     MOVE *ON       *INU8                           CIR005
     C                     MOVE *ON       *INLR                           CIR005
     C                     EXSR *PSSR                                     CIR005
     C                     GOTO END                                       CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C           @RTCD     IFEQ *BLANKS                                   CIR005
     C                     MOVE 'Y'       CIR005  1                       CIR005
     C                     ELSE                                           CIR005
     C                     MOVE 'N'       CIR005                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR003
      ** Check if CIR017 is switched on                                                       CIR017
      *                                                                                       CIR017
     C                     CALL 'AOSARDR0'                                                    CIR017
     C                     PARM           @RTCD                                               CIR017
     C                     PARM '*VERIFY' @OPTN                                               CIR017
     C                     PARM 'CIR017'  @SARD                                               CIR017
      *                                                                                       CIR017
     C           @RTCD     IFEQ *BLANKS                                                       CIR017
     C                     MOVE 'Y'       CIR017  1                                           CIR017
     C                     ELSE                                                               CIR017
     C                     MOVE 'N'       CIR017                                              CIR017
     C                     ENDIF                                                              CIR017
      *                                                                                       CIR018
      ** Check if CIR018 is switched on                                                       CIR018
     C                     CALL 'AOSARDR0'                                                    CIR018
     C                     PARM           @RTCD                                               CIR018
     C                     PARM '*VERIFY' @OPTN                                               CIR018
     C                     PARM 'CIR018'  @SARD                                               CIR018
      *                                                                                       CIR018
     C           @RTCD     IFEQ *BLANKS                                                       CIR018
     C                     MOVE 'Y'       CIR018  1                                           CIR018
     C                     ELSE                                                               CIR018
     C                     MOVE 'N'       CIR018                                              CIR018
     C                     ENDIF                                                              CIR018
      ** Check if switchable feature CIR003 is switched on                CIR003
      *                                                                   CIR003
     C                     CALL 'AOSARDR0'                                CIR003
     C                     PARM *BLANKS   @RTCD                           CIR003
     C                     PARM '*VERIFY' @OPTN                           CIR003
     C                     PARM 'CIR003'  @SARD                           CIR003
     C           SCSARD    PARM SCSARD    DSFDY                           CIR003
      *                                                                   CIR003
     C           @RTCD     IFNE *BLANK                                    CIR003
     C           @RTCD     ANDNE'*NRF   '                                 CIR003
     C                     MOVEL'SCSARDPD'DBFILE           ************   CIR003
     C                     MOVEL'008'     DBASE            * DBERR 08 *   CIR003
     C                     MOVEL'CIR003'  DBKEY            ************   CIR003
     C                     MOVE *ON       *INU7                           CIR003
     C                     MOVE *ON       *INU8                           CIR003
     C                     MOVE *ON       *INLR                           CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO END                                       CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           @RTCD     IFEQ *BLANKS                                   CIR003
     C                     MOVE 'Y'       CIR003  1                       CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'N'       CIR003                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR006
      ** Check if switchable feature CIR006 is switched on                CIR006
      *                                                                   CIR006
     C                     CALL 'AOSARDR0'                                CIR006
     C                     PARM *BLANKS   @RTCD                           CIR006
     C                     PARM '*VERIFY' @OPTN                           CIR006
     C                     PARM 'CIR006'  @SARD                           CIR006
     C           SCSARD    PARM SCSARD    DSFDY                           CIR006
      *                                                                   CIR006
     C           @RTCD     IFNE *BLANK                                    CIR006
     C           @RTCD     ANDNE'*NRF   '                                 CIR006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CIR006
     C                     MOVEL'009'     DBASE            * DBERR 09 *   CIR006
     C                     MOVEL'CIR006'  DBKEY            ************   CIR006
     C                     MOVE *ON       *INU7                           CIR006
     C                     MOVE *ON       *INU8                           CIR006
     C                     MOVE *ON       *INLR                           CIR006
     C                     EXSR *PSSR                                     CIR006
     C                     GOTO END                                       CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C           @RTCD     IFEQ *BLANKS                                   CIR006
     C                     MOVE 'Y'       CIR006  1                       CIR006
     C                     ELSE                                           CIR006
     C                     MOVE 'N'       CIR006                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR005
     C/COPY WNCPYSRC,DL0279C029
      *                                                                                       CDL033
      ** Acces Midas General Ledger ICD details.                                              CDL033
      *                                                                                       CDL033
     C                     CALL 'AOGELRR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*FIRST ' @OPTN                                               CDL033
     C           SDGELR    PARM SDGELR    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '010'     DBASE                                               CDL033
     C                     MOVEL@OPTN     DBKEY                                               CDL033
     C                     MOVEL'SDGELRPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO FINEND                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine event control date.                                                        CDL033
      *                                                                                       CDL033
     C           BJDNWD    SUB  1         WEVCD   50                                          CDL033
     C           BKAPDT    IFLT WEVCD                                                         CDL033
     C                     Z-ADDBKAPDT    WEVCD                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Determine if Floating Rate CD Issued feature is                                      CDL033
      ** switched on.                                                                         CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    CDL033  1                                           CDL033
     C                     CALL 'AOSARDR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*VERIFY' @OPTN                                               CDL033
     C                     PARM 'CDL033'  @SARD                                               CDL033
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFEQ *BLANKS                                                       CDL033
     C                     MOVE 'Y'       CDL033                                              CDL033
     C                     ELSE                                                               CDL033
     C           @RTCD     IFNE '*NRF   '                                                     CDL033
     C                     MOVE '031'     DBASE                                               CDL033
     C                     MOVEL'CDL033'  DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SCSARDPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO FINEND                                                        CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CIR014
      ** Check if switchable feature Mark to Market Cross-currency                            CIR014
      ** CIR006 is switched on                                                                CIR014
      *                                                                                       CIR014
     C                     MOVE *BLANK    CIR014  1                                           CIR014
     C                     CALL 'AOSARDR0'                                                    CIR014
     C                     PARM *BLANKS   @RTCD                                               CIR014
     C                     PARM '*VERIFY' @OPTN                                               CIR014
     C                     PARM 'CIR014'  @SARD                                               CIR014
     C           SCSARD    PARM SCSARD    DSFDY                                               CIR014
      *                                                                                       CIR014
     C           @RTCD     IFEQ *BLANKS                                                       CIR014
     C                     MOVE 'Y'       CIR014                                              CIR014
     C                     ELSE                                                               CIR014
     C           @RTCD     IFNE '*NRF   '                                                     CIR014
     C                     MOVEL'034'     DBASE                                               CIR014
     C                     MOVEL'CIR014'  DBKEY                                               CIR014
     C                     MOVEL@OPTN     DBOPTN                                              CIR014
     C                     MOVEL'SCSARDPD'DBFILE                                              CIR014
     C                     MOVE *ON       *INU7                                               CIR014
     C                     MOVE *ON       *INU8                                               CIR014
     C                     MOVE *ON       *INLR                                               CIR014
     C                     EXSR *PSSR                                                         CIR014
     C                     GOTO FINEND                                                        CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
      *                                                                                       CIR014
      ** Check if feature CDL099 is On                                                        CDL099
      *                                                                                       CDL099
     C                     MOVE *BLANK    CDL099  1                                           CDL099
     C                     CALL 'AOSARDR0'                                                    CDL099
     C                     PARM *BLANKS   @RTCD                                               CDL099
     C                     PARM '*VERIFY' @OPTN                                               CDL099
     C                     PARM 'CDL099'  @SARD                                               CDL099
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL099
      *                                                                                       CDL099
     C           @RTCD     IFEQ *BLANKS                                                       CDL099
     C                     MOVE 'Y'       CDL099                                              CDL099
     C                     ELSE                                                               CDL099
     C                     MOVE 'N'       CDL099                                              CDL099
     C                     ENDIF                                                              CDL099
      *                                                                   CSW005
0327 C* CALL MODULE PROG. FOR MODULE DETAILS.                             S01194
     C                     CALL 'AOMMODR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01194
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDMMODPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'002'     DBASE   3        * DBERR 002 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@OPTN     DBKEY  29                    *  S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
0529 C*****      TABKEY    CHAINTABLE                40           *****   S01194
0530 C*****                                                       *****   S01194
0531 C*****ACCESS DEALING MODULE INSTALLATION CONTROL DATA RECORD.*****   S01194
0532 C*****                MOVE '  40'    TABKEY                  *****   S01194
0533 C*****      TABKEY    CHAINTABLE                40           *****   S01194
0535 C*****                                                       *****   S01194
0327 C*  CALL ACCESS PROG.FOR DEALING DETAILS.                            S01194
     C**********           CALL 'AODEALR0'                                S01194              CGL029
     C                     CALL 'AODEALR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDDEAL    PARM SDDEAL    DSFDY                           S01194              CGL029
     C           SDDEAL    PARM SDDEAL    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01194
     C                     MOVEL'SDDEALPD'DBFILE 10        * * * * * * *  S01194
     C                     MOVEL'030'     DBASE   3        * DBERR 030 *  S01194
     C                     MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     C                     MOVEL@OPTN     DBKEY  29                    *  S01194
0349 C                     SETON                     U7U8LR               S01194
     C                     EXSR *PSSR                                     S01194
0350 C                     GOTO END                                       S01194
     C                     END                                            S01194
      *                                                                                     MD035545
      ** Retrieve system value setting                                                      MD035545
      *                                                                                     MD035545
     C                     MOVELWPARML    P@OP01                                            MD035545
     C                     CALL 'AOSVALR0'                                                  MD035545
     C                     PARM *BLANKS   W0RTCD  7                                         MD035545
     C                     PARM           P@OP01 20                                         MD035545
     C                     PARM           P@VL01200                                         MD035545
     C                     PARM           P@OP02 20                                         MD035545
     C                     PARM           P@VL02200                                         MD035545
     C                     PARM           P@OP03 20                                         MD035545
     C                     PARM           P@VL03200                                         MD035545
     C                     PARM           P@OP04 20                                         MD035545
     C                     PARM           P@VL04200                                         MD035545
     C                     PARM           P@OP05 20                                         MD035545
     C                     PARM           P@VL05200                                         MD035545
     C                     PARM           P@OP06 20                                         MD035545
     C                     PARM           P@VL06200                                         MD035545
     C                     PARM           P@OP07 20                                         MD035545
     C                     PARM           P@VL07200                                         MD035545
     C                     PARM           P@OP08 20                                         MD035545
     C                     PARM           P@VL08200                                         MD035545
     C                     PARM           P@OP09 20                                         MD035545
     C                     PARM           P@VL09200                                         MD035545
     C                     PARM           P@OP10 20                                         MD035545
     C                     PARM           P@VL10200                                         MD035545
      *                                                                                     MD035545
      ** If system value is not found then default value to 'N'                             MD035545
      *                                                                                     MD035545
     C           W0RTCD    IFNE '       '                                                   MD035545
     C                     MOVE 'N'       WCALC6                                            MD035545
     C                     ELSE                                                             MD035545
     C                     MOVELP@VL01    WCALC6                                            MD035545
     C********** WCALC6    IFEQ 'Y'                                                MD035545 MD047993
     C********** BKALDI    ANDEQ'Y'                                                MD035545 MD047993
     C**********           MOVE 'Y'       WCALC6                                   MD035545 MD047993
     C**********           ELSE                                                    MD035545 MD047993
     C**********           MOVE 'N'       WCALC6                                   MD035545 MD047993
     C**********           ENDIF                                                   MD035545 MD047993
     C                     ENDIF                                                            MD035545
0535 C*
0534 C                     SETON                     40
0535 C*
0536 C*    SET UP RECORD COUNTS FOR OUTPUT FILES
0537 C                     Z-ADD2         DLCT    50
0538 C                     Z-ADD2         RLCT    50
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0279CP16                                           S01408
     F*                                                                   S01408
     C*
     C*    CHIPS INTERFACE TEST
     C*****                TESTB'0'       CHIM           70-IS*PRESENT*   S01194
     C           BGCHDL    IFEQ 'Y'                        -IS PRESENT    S01194
     C                     SETON                     70                   S01194
     C                     END                                            S01194
0539 C*
0540 C*    CHECK MATURITY CONFIRMATION INDICATOR.
0541 C*****      MCRI      COMP 'Y'                      41       *****   S01194
0541 C           BNMCRI    COMP 'Y'                      41               S01194
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CCPG                                           S01408
     C*                                                                   S01408
0542 C*
0543 C***  SET UP LOWER LIMITS TO ACCESS TABLE CURRENCY RECORDS.          S01093
0544 C***                  MOVEL'20      'TABKEY                          S01093
0545 C***                  MOVE '    '    TABKEY                          S01093
0546 C***        TABKEY    SETLLTABLE2                                    S01093
0547 C***                                                                 S01093
0548 C***  READ TABLE CURRENCY RECORDS.                                   S01093
0549 C***        READ      TAG                             ** READ TAG ***S01093
0550 C***                  SETOF                     0304                 S01093
0551 C***                  READ TABLE2                   20               S01093
0552 C***04      RECT      COMP 20                   2121                 S01093
0553 C***20                                                               S01093
0554 C*R*04 21             GOTO END                                       S01093
0555 C**N03                GOTO READ                                      S01093
0556 C***                                                                 S01093
0557 C**N46      LOCY      COMP CCY                      45               S01093
0558 C***        X         ADD  1         X       30                      S01093
0559 C***                  MOVE CCY       CCYA,X                          S01093
0560 C***                                                                 S01093
0561 C***  SET UP ARRAY FOR TELEX NOTICE DATE.                            S01093
0562 C***                  Z-ADDDNWD      ZDAYNO                          S01093
0563 C***                  MOVE CCY       ZCCY                            S01093
0564 C***                  Z-ADDTNOT      ZNRDYS                          S01093
0565 C***                  EXSR ZTXDAY                                    S01093
0566 C***                  Z-ADDZDYNBR    TNDA,X                          S01093
0567 C***45                Z-ADDZDYNBR    TNDAL   50                      S01093
0568 C**N45                GOTO READ                                      S01093
0569 C***                                                                 S01093
0570 C***  SET UP ARRAY FOR MATURITY ELAPSED CONFIRMATION DATE.           S01093
0571 C***                  Z-ADDRUND      ZDAYNO                          S01093
0572 C***                  Z-ADDMCEP      ZNRDYS                          S01093
0573 C***                  EXSR XDATE3                                    S01093
0574 C***                  Z-ADDZDYNBR    MEDAL   50                      S01093
0575 C***                                                                 S01093
0576 C***  SET UP ARRAY FOR MATURITY CONFIRMATION TO GO DATE.             S01093
0577 C***                  Z-ADDRUND      ZDAYNO                          S01093
0578 C***                  Z-ADDMCLP      ZNRDYS                          S01093
0579 C***                  EXSR ZTXDAY                                    S01093
0580 C***                  Z-ADDZDYNBR    MGDAL   50                      S01093
0581 C***45                SETON                     46                   S01093
0582 C***45                SETOF                     45                   S01093
0583 C***                  GOTO READ                                      S01093
0584 C*********                                                           S01117
     C*****SET UP ARRAY OF TELEX NOTICE DATES                             S01117
     C*********            Z-ADDDNWD      ZDAYNO                  S01093  S01117
     C*********            Z-ADD1         X       30              S01093  S01117
     C*********  CY,X      DOWNE'   '                             S01093  S01117
     C*********            MOVE CYD,X     CYDDS                   S01093  S01117
     C****CALCULATE TELEX NOTICE DATE                             S01093  S01117
     C*********            MOVE BJBPCD    ZCCY1                   S01095  S01117
     C*********            MOVE BJE2TX    ZLOC1                   S01195  S01117
     C*********            MOVE CY,X      ZCCY                    S01095 3S01117
     C*********            MOVE *BLANKS   ZLOC2                   S01095  S01117
     C*********            Z-ADDTNOT      ZNRDYS                  S01093  S01117
     C*********            EXSR ZTXDAY                            S01193  S01117
     C*********            Z-ADDZDYNBR    TNDA,X                  S01093  S01117
     C*********            ADD  1         X                       S01093  S01117
     C*********            END                                    S01093  S01117
     C*****SAVE TELEX NOTICE DATE FOR LOCAL CCY                   S01093  S01117
     C*********            Z-ADD1         X                       S01093  S01117
     C*********  LOCY      LOKUPCY,X                     45       S01093  S01117
     C*********            Z-ADDTNDA,X    TNDAL   50              S01093  S01117
      *                                                                   S01117
      ** SET UP VARIABLES USED BY SR/TLXNOT                               S01117
     C                     Z-ADD1         Y       30                      S01117
     C/COPY WNCPYSRC,DLH00042
     C                     MOVE BJLCCY    ZCCY2                           S01117
     C/COPY WNCPYSRC,DLH00043
     C                     MOVE BJSLCD    ZLOC2                           S01117
     C*                                                                   E21923
     C*    DETERMINE DATE OF NEXT NEXT WORKING DAY.                       E21923
     C*                                                                   E21923
     C/COPY WNCPYSRC,DLH00044
     C                     Z-ADDBJDNWD    ZDAYNO                          E21923
     C                     MOVE BJLCCY    ZCCY                            E21923
     C                     MOVE BJSLCD    ZLOC                            S01117
     C                     Z-ADD1         ZNRDYS                          E21923
     C                     EXSR ZFWDT                                     E21923
     C           ZDYNBR    SUB  1         DNNWD   50                      E21923
     C/COPY WNCPYSRC,DLH00045
     C*                                                                   E21923
      ** OBTAIN TELEX NOTICE DATE FOR LOCAL CCY/SYSTEM LOCATION           S01117
      ** (CANNOT USE SR/TLXNOT B'COS IT IS FOR 2 CCYS/LOCNS)              S01117
     C                     MOVE BJLCCY    ZCCY                            S01117
     C                     MOVE BJSLCD    ZLOC                            S01117
     C*********************MOVE BJDNWD    ZDAYNO                    S01117E21923
     C                     Z-ADDDNNWD     ZDAYNO                          E21923
      *                                                                   S01117
      ** read currencies file for telex notice days                       S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           ZCCY                            S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
      *                                                                   S01117
      ** if database error                                                S01117
     C           @RTCD     IFNE *BLANK                     B1             S01117
     C                     SETON                     U7U8LR*1             S01117
     C                     MOVEL'SDCURRPD'DBFILE           ************** S01117
     C                     MOVEL'005'     DBASE            *DBERROR 005 * S01117
     C                     MOVEL@RTCD     DBOPTN           ************** S01117
     C                     MOVELZCCY      DBKEY  29                       S01194
     C                     DUMP                            *1             S01117
     C                     GOTO END                        *1             S01117
     C                     END                             E1             S01117
     C                     MOVE A6TXND    ZNRDYS                          S01117
      *                                                                   S01117
     C                     EXSR ZFWDT                                     S01117
      *                                                                   S01117
      ** STORE RESULT                                                     S01117
     C                     Z-ADDZDYNBR    TNDAL   50                      S01117
     C/COPY WNCPYSRC,DLH00465
      *                                                                   S01117
     C**   CALC DATE FOR START OF MATURITY CONF ELAPSED PERIOD            S01093
0571 C*****                Z-ADDRUND      ZDAYNO                  S01093  S01194
0572 C*****                Z-ADDMCEP      ZNRDYS                  S01093  S01194
     C*****                MOVE LOCY      ZCCY                    S01093  S01194
0573 C*****                EXSR XDATE3                            S01093  S01195
0571 C                     Z-ADDBJRDNB    ZDAYNO                          S01194
0572 C                     Z-ADDBNMCEL    ZNRDYS                          S01194
     C                     MOVE BJLCCY    ZCCY                            S01194
     C                     MOVE BJSLCD    ZLOC                            S01195
0573 C                     EXSR ZBKDT                                     S01195
0574 C                     Z-ADDZDYNBR    MEDAL   50                      S01093
0575 C**                                                                  S01093
0576 C**   CALC DATE FOR MATURITY CONFS                                   S01093
0578 C*****                Z-ADDMCLP      ZNRDYS                  S01093  S01194
0579 C*****                EXSR ZTXDAY                            S01093  S01195
     C                     Z-ADDBJRDNB    ZDAYNO                          131369
     C                     Z-ADDBNMCTG    ZNRDYS                          S01194
     C                     EXSR ZFWDT                                     S01195
0580 C                     Z-ADDZDYNBR    MGDAL   50                      S01093
     C                     GOTO END                                       S01093
0585 C**************************
0586 C*
0587 C*    END OF FIRST CYCLE PROCESSING.
0588 C           ENDFC     TAG                             ** ENDFC TAG **
0589 C                     SETOF                     333450
     C**   RESET INDICATOR FOR DEALS FILE UPDATE                          S01093
     C                     MOVE '0'       *IN66                           S01093
     C*                                                                   059357
     C** Reset indicator for FX options                                   059357
     C*                                                                   059357
     C                     MOVE '0'       *IN23                           059357
0590 C   10                GOTO END
0591 C*
0592 C*    SET INDICATOR FOR REVERSAL
0593 C           RECI      COMP 'R'                      36
0594 C*
0595 C*    SKIP PROCESSING FOR DELETED RECORDS.
0596 C   11      DECT      ADD  1         DECT    50
0597 C   11                GOTO END
0598 C********** RLCT      ADD  1         RLCT                            S01093
0599 C*
0600 C*    CHECK FOR LIVE DEALS RECORDS.
0601 C           RECI      COMP 'D'                      42
0602 C*
0603 C*    TOTALLING FOR LIVE RECORDS.
0604 C   42      RDCT      ADD  1         RDCT    50
0605 C   42                MOVE AMT       ZZAMT
0606 C   42                EXSR GLZADD
     C/COPY WNCPYSRC,DL0279CP29                                           S01408
     C*                                                                   S01119
     C**  CHECK FOR FRA/IRS DEAL TYPES AS THESE ARE PROCESSED             S01119
     C**  DIFFERENTLY                                                     S01119
     C*                                                                   S01119
     C                     SETOF                     50                   S01119
     C*                                                                   S01119
     C                     Z-ADD0         ZERO1  130                      S01119
     C                     Z-ADD0         ZERO2  117                      S01119
     C                     Z-ADD0         ZERO3   50                      S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C009
     C           DTYP      IFEQ 'FR'                                      S01119
     C           DTYP      OREQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C*                                                                   S01119
     C                     Z-ADD0         PRI1                            193724
     C                     Z-ADD0         PRI2                            193724
     C                     Z-ADD0         PRI3                            193724
      *                                                                   193724
     C           *IN42     IFEQ '1'                                       S01119
     C/COPY WNCPYSRC,DL0279C017
     C                     EXSR FRAIRS                                    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
0607 C*
0608 C**************************
0609 C*
0610 C*    PAY/RECEIVE REPORTING REQUIREMENT.
0611 C*
0612 C**   22-USE DEAL CCY FOR VAL/FX PURCH
0613 C**   35-USE DEAL CCY FOR MAT/FX SALE/INT
0614 C**   ELSE USE LOCAL CCY
0615 C*    RESET OUTPUT FIELDS.
0616 C*
0617 C                     Z-ADD0         PRI1    10
0618 C                     Z-ADD0         PRI2    10
0619 C                     Z-ADD0         PRI3    10
     C/COPY WNCPYSRC,DL0279C087
      *                                                                                       CDL033
      ** Perform initial processing for CF deals.                                             CDL033
      *                                                                                       CDL033
     C                     MOVE *OFF      *IN61                                               CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C           *IN42     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
      *                                                                                       CDL033
     C                     MOVE *ON       *IN61                                               CDL033
     C                     Z-ADD*ZERO     WINTAI                                              CDL033
     C                     Z-ADD*ZERO     WINTAM                                              CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WWINFF  1                                           CDL033
     C                     MOVE *BLANK    WMSGMF  1                                           CDL033
     C                     MOVE *BLANK    WMSGIF  1                                           CDL033
     C                     MOVE *BLANK    WCONMF  1                                           CDL033
     C                     MOVE *BLANK    WCONIF  1                                           CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC1                                                        CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
0620 C*
0621 C********************************************************************
0622 C**** CHECK SETTLEMENT AND DEAL TYPES.
0623 C********************************************************************
0624 C**
     C**
     C**   ALWAYS USE STYP1 FOR VAL.DATE AND STYP2 FOR MATURITY OR INTEREST
     C**
     C********** STYP1     LOKUPTABSET                   22               S01117
     C**N09***** STYP2     LOKUPTABSET                   35               S01117
      *                                                                   S01117
      ** CHECK FOR OPTION TYPE DEALS
0637 C   06      DTYP      COMP 'OP'                     23
      *
0639 C*****LOOK-UP CURRENCY ARRAY.                                        S01117
0640 C*********            MOVE CCY       ACCY    3                       S01117
0641 C***06****            MOVE PUCY      ACCY                            S01117
0642 C*********            Z-ADD1         X                               S01117
0643 C****       ACCY      LOKUPCCYA,X                   24       S01093  S01117
0643 C*********  ACCY      LOKUPCY,X                     24       S01093  S01117
0644 C*
0645 C***********
0646 C**
0647 C*    CHECK VALUE DATE/FX PURCH TELEX INDICATOR.
0648 C                     TESTB'0'       TLXI           25
0649 C   25                GOTO TEST2
      *                                                                   S01117
      ** IF SETTLEMENT BY NOSTRO USE CCY/NOSTRO LOCATION TO DETERMINE     S01117
      ** TELEX NOTICE DATE                                                S01117
     C           STYP1     IFEQ 01                                B1      S01117
     C           STYP1     OREQ 07                                B1      S01117
     C           STYP1     OREQ 08                                B1      S01117
     C*                                                                   CEU003
     C  N06                MOVELCCY       TCYN1   5                                           250569
     C   06                MOVELPUCY      TCYN1                                               250569
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN06     ANDEQ*ON                                       CEU003
     C           RSCY      ANDNE*BLANKS                                   CEU003
     C           CEU003    OREQ 'Y'                                       CEU003
     C           *IN06     ANDEQ*OFF                                      CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C           *IN06     IFEQ *ON                                       CEU003
     C                     MOVELRSCY      TCYN1                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELSTCY      TCYN1                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
      *                                                                   S01117
      ** SET UP CCY/NOSTRO READY TO OBTAIN TELEX NOTICE DAYS              S01117
     C  N06                MOVELCCY       TCYN1   5               *1      S01117
     C   06                MOVELPUCY      TCYN1                   *1      S01117
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE SNOS1     TCYN1                   *1      S01117
     C                     Z-ADD1         X       30              *1      S01117
     C           TCYN1     LOKUPCN,X                     24       *1      S01117
      *                                                                   S01117
      ** IF ELEMENT FOR CCY/NOSTRO NOT FOUND, SET IT UP                   S01117
      ** THIS WILL ALSO SETUP THE INDEX, X.                               S01117
     C  N24                MOVELTCYN1     ZCCY1                   *1      S01117
     C  N24                MOVE SNOS1     ZNOS1                   *1      S01117
     C  N24                EXSR TLXNOT                            *1      S01117
     C   U7N24             GOTO END                               *1      S01117
      *                                                                   S01117
      **   COMPARE EVENT DATE TO FWD DATE                                 S01117
     C           VDAT      COMP TNDA,X                 2626       *1      S01117
     C   23      OTDT      COMP TNDA,X                 2626       *1      S01117
      *                                                                   S01117
     C                     ELSE                                   X1      S01117
      *                                                                   S01117
      ** IF SETTLEMENT TYPE NOT 01,07,08 USE LOCAL CCY/LOCATION           S01117
     C           VDAT      COMP TNDAL                  2626       *1      S01117
     C   23      OTDT      COMP TNDAL                  2626       *1      S01117
     C                     END                                    E1      S01117
0650 C**
0651 C**   COMPARE EVENT DATE TO FWD DATE
0652 C***22****  VDAT      COMP TNDA,X                 2626               S01117
0653 C***22*06*23OTDT      COMP TNDA,X                 2626               S01117
0654 C**N22****  VDAT      COMP TNDAL                  2626               S01117
0655 C**N22*06*23OTDT      COMP TNDAL                  2626               S01117
      *                                                                   S01117
0656 C  N26                GOTO TEST2
0657 C*
0658 C*
0659 C********************************************************************
0660 C**   COMPARE EVENT DATE & LOCAL CCY TX NOTICE DAYS.
0661 C*
0662 C**   COMPARE EVENT DATE & LOWER OF EVENT & LOCAL CCY TX NOT.DAYS
0663 C********************************************************************
0664 C*
0665 C*    SETON VALUE DATE/FX PURCH PAY/REC IND.
0666 C           BITN1     TAG
     C*
     C*    IF CHIPS INTERFACE DETERMINE IF EVNT IS PAYMENT VIA CHIPS
     C   70                Z-ADD1         P       10       START EVENT
     C   70                Z-ADDVDAT      CHDT    50       EVENT DATE
     C   70 06 23          Z-ADDOTDT      CHDT
     C   70                EXSR PAYCHP
     C   70 73             GOTO TEST2                      SUPPRESS OUTPUT
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
0667 C*********************BITON'0'*******TLXI**********************E19374E23886
0667 C                     BITON'0'       TLXI                            E23886
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01093
     C                     MOVE '1'       *IN66                           S01093
     C*
     C*  BY-PASS INDICATOR ON DLIND IF BACK-VALUED EVENT
     C/COPY WNCPYSRC,DL0279C001
     C     N06
     C*R****06N23VDAT      CABLTRUND      TEST2            SUPPRESS*OUTPUTS01194
     COR    06N23VDAT      CABLTBJRDNB    TEST2            SUPPRESS OUTPUTS01194
     C***** 06 23OTDT      CABLTRUND      TEST2            SUPPRESS*OUTPUTS01194
     C      06 23OTDT      CABLTBJRDNB    TEST2            SUPPRESS OUTPUTS01194
     C/COPY WNCPYSRC,DL0279C002
     C*
0668 C  N09                Z-ADD1         PRI1
0669 C   09                Z-ADD1         PRI3
0670 C                     SETON                     50
0671 C**
0672 C***********
0673 C*
0674 C*    CHECK MATURITY DATE/FX SALE TX IND..
0675 C           TEST2     TAG                             ** TEST2 TAG**
0676 C**   END FOR NA SOLD.
0677 C   09                GOTO TAG01
0678 C*
0679 C                     TESTB'1'       TLXI           25
0680 C**   END FOR FX.
0681 C   25 06             GOTO TAG01
0682 C**   ELSE TEST INTEREST.
0683 C   25                GOTO TEST3
0684 C*
0685 C*    MOVE DATE FIELDS TO COMMON AREA
0686 C   06N23             Z-ADDVDAT      ADAT    50
     F*                                                                   S01408
     F/COPY WNCPYSRC,DL0279CP17                                           S01408
      *
      *                                                                                       CDL099
      ** If CDL099 is on, set-up Sell Value Date                                              CDL099
      *                                                                                       CDL099
     C           CDL099    IFEQ 'Y'                                                           CDL099
     C           *IN06     ANDEQ'1'                                                           CDL099
     C           *IN23     ANDEQ'0'                                                           CDL099
     C           BSDT2     ANDNE0                                                             CDL099
     C                     Z-ADDBSDT2     ADAT                                                CDL099
     C                     ENDIF                                                              CDL099
     F*                                                                   S01408
0687 C  N06                Z-ADDMDAT      ADAT
0688 C   06 23             Z-ADDOTDT      ADAT
0689 C*
0690 C*****FOR FX GET SALE CCY                                            S01117
0691 C***06****            Z-ADD1         X                               S01117
0692 C***06      SLCY      LOKUPCCYA,X                   24        S01093 S01117
0692 C***06****  SLCY      LOKUPCY,X                     24        S01093 S01117
0693 C**
0694 C*    IS MATURITY DATE ZERO
0695 C           ADAT      COMP 0                        27
0696 C*
0697 C*    COMPARE DATE TO TELEX NOTICE DAYS
0698 C   27                GOTO TEST3
0699 C***35***   ADAT      COMP TNDA,X                 2626               S01117
0700 C**N35***   ADAT      COMP TNDAL                  2626               S01117
      *                                                                   S01117
      ** FOR NON OPTION DEALS (*IN09) CHECK SETTLEMENT METHOD             S01117
      ** FOR MATURITY/SALE CCY/NOSTRO                                     S01117
     C           *IN09     IFEQ '0'                               B1      S01117
     C           STYP2     IFEQ 01                                B*2     S01117
     C           STYP2     OREQ 07                                B*2     S01117
     C           STYP2     OREQ 08                                B*2     S01117
     C*                                                                   CEU003
     C  N06                MOVELCCY       TCYN2   5                                           250569
     C   06                MOVELSLCY      TCYN2                                               250569
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN06     ANDEQ*ON                                       CEU003
     C           PSCY      ANDNE*BLANKS                                   CEU003
     C           CEU003    OREQ 'Y'                                       CEU003
     C           *IN06     ANDEQ*OFF                                      CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C           *IN06     IFEQ *ON                                       CEU003
     C                     MOVELPSCY      TCYN2                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELSTCY      TCYN2                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
      *                                                                   S01117
      ** SET UP CCY/NOSTRO READY TO OBTAIN TELEX NOTICE DAYS              S01117
     C  N06                MOVELCCY       TCYN2   5               **2     S01117
     C   06                MOVELSLCY      TCYN2                   **2     S01117
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     MOVE SNOS2     TCYN2                   **2     S01117
     C                     Z-ADD1         X                       **2     S01117
     C           TCYN2     LOKUPCN,X                     24       **2     S01117
      *                                                                   S01117
      ** IF ELEMENT FOR CCY/NOSTRO NOT FOUND, SET IT UP                   S01117
      ** THIS WILL ALSO SETUP THE INDEX, X.                               S01117
     C  N24                MOVELTCYN2     ZCCY1                   **2     S01117
     C  N24                MOVE SNOS2     ZNOS1                   **2     S01117
     C  N24                EXSR TLXNOT                            **2     S01117
     C   U7N24             GOTO END                               **2     S01117
      *                                                                   S01117
      **   COMPARE EVENT DATE TO FWD DATE                                 S01117
     C           ADAT      COMP TNDA,X                 2626       **2     S01117
      *                                                                   S01117
     C                     ELSE                                   X*2     S01117
      *                                                                   S01117
      ** IF SETTLEMENT TYPE NOT 01,07,08 USE LOCAL CCY/LOCATION           S01117
     C           ADAT      COMP TNDAL                  2626       **2     S01117
     C                     END                                    E*2     S01117
     C                     END                                    E1      S01117
      *                                                                   S01117
0701 C  N26                GOTO TEST3
0702 C**
0703 C********************************************************************
0704 C*
0705 C*
0706 C********************************************************************
0707 C*
0708 C*    SETON MATURITY DATE/FX SALE IND.
0709 C           BITN2     TAG
     C*
     C*     IF CHIPS INTERFACE DETERMINE IF EVENT IS PAYMENT VIA CHIPS
     C   70                Z-ADD3         P                MATURITY EVENT
     C   70                Z-ADDADAT      CHDT             EVENT DATE
     C   70                EXSR PAYCHP
     C   70 73             GOTO TAG01                      SUPPRESS OUTPUT
     C*
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
0710 C*********************BITON'1'*******TLXI**********************E19374E23886
     C           *IN07     IFNE *ON                                       S01434
     C           *IN07     OREQ *ON                                       S01434
     C           AURO      ANDNE'Y'                                       S01434
     C           *IN07     OREQ *ON                                       S01434
     C           AURO      ANDEQ'Y'                                       S01434
     C           RBDN      ANDNE*ZEROS                                    S01434
0710 C                     BITON'1'       TLXI                            E23886
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01093
     C                     MOVE '1'       *IN66                           S01093
     C*  BY-PASS INDICATOR ON DLIND IF BACK-VALUED EVENT
     C*****      ADAT      CABLTRUND      TEST3            SUPPRESS*OUTPUTS01194
     C/COPY WNCPYSRC,DL0279C003
     C           ADAT      CABLTBJRDNB    TEST3            SUPPRESS OUTPUTS01194
     C/COPY WNCPYSRC,DL0279C004
0711 C                     Z-ADD1         PRI3
0712 C  N50                SETON                     50
     C/COPY WNCPYSRC,DL0279C088
      *                                                                                       CDL033
      ** Flag maturity message as to be generated for                                         CDL033
      ** CF deals.                                                                            CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C           *IN42     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     MOVE 'Y'       WMSGMF                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                          S01434
0713 C*
0714 C**
0715 C***********
0716 C**
0717 C*    CHECK INTEREST-DATE TELEX INDICATOR.
0718 C           TEST3     TAG
0719 C**   END FOR FX.
0720 C   06                GOTO TAG01
0721 C*
0722 C                     TESTB'2'       TLXI           25
     C/COPY WNCPYSRC,DL0279C101
0723 C   25                GOTO TAG01
0724 C*
0725 C**   IS NEXT INT.DATE ZERO.
0726 C           NIDT      COMP 0                        27
0727 C   27                GOTO TAG01
      *                                                                   S01117
      ** FOR NON OPTION DEALS (*IN09) CHECK SETTLEMENT METHOD             S01117
      ** FOR MATURITY/SALE CCY/NOSTRO                                     S01117
     C           *IN09     IFEQ '0'                               B1      S01117
     C           STYP2     IFEQ 01                                B*2     S01117
     C           STYP2     OREQ 07                                B*2     S01117
     C           STYP2     OREQ 08                                B*2     S01117
     C*                                                                   CEU003
     C  N06                MOVELCCY       TCYN2   5                                           250569
     C   06                MOVELSLCY      TCYN2                                               250569
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           *IN07     ANDEQ*ON                                       CEU003
     C           IPDS      ANDEQ'Y'                                       CEU003
     C           ISCY      ANDNE*BLANKS                                   CEU003
     C           CEU003    OREQ 'Y'                                       CEU003
     C           *IN07     ANDEQ*ON                                       CEU003
     C           IPDS      ANDNE'Y'                                       CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C           CEU003    OREQ 'Y'                                       CEU003
     C           *IN07     ANDEQ*OFF                                      CEU003
     C           STCY      ANDNE*BLANKS                                   CEU003
     C*                                                                   CEU003
     C           *IN07     IFEQ *ON                                       CEU003
     C           IPDS      ANDEQ'Y'                                       CEU003
     C           ISCY      ANDNE*BLANKS                                   CEU003
     C                     MOVELISCY      TCYN2                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELSTCY      TCYN2                           CEU003
     C                     ENDIF                                          CEU003
     C*                                                                   CEU003
     C                     ELSE                                           CEU003
      *                                                                   S01117
      ** SET UP CCY/NOSTRO READY TO OBTAIN TELEX NOTICE DAYS              E340
     C  N06                MOVELCCY       TCYN2   5               **2     E340
     C   06                MOVELSLCY      TCYN2                   **2     E340
     C                     ENDIF                                          CEU003
     C                     MOVE SNOS2     TCYN2                   **2     E340
     C                     Z-ADD1         X                       **2     E340
     C           TCYN2     LOKUPCN,X                     24       **2     E340
      *                                                                   E340
      ** IF ELEMENT FOR CCY/NOSTRO NOT FOUND, SET IT UP                   E340
      ** THIS WILL ALSO SETUP THE INDEX, X.                               E340
     C  N24                MOVELTCYN2     ZCCY1                   **2     E340
     C  N24                MOVE SNOS2     ZNOS1                   **2     E340
     C  N24                EXSR TLXNOT                            **2     E340
     C   U7N24             GOTO END                               **2     E340
      *                                                                   E340
      **   COMPARE EVENT DATE TO FWD DATE                                 S01117
     C           NIDT      COMP TNDA,X                 2626       **2     S01117
      *                                                                   S01117
     C                     ELSE                                   X*2     S01117
     C           NIDT      COMP TNDAL                  2626       **2     S01117
     C                     END                                    E*2     S01117
     C/COPY WNCPYSRC,DL0279C018
     C                     END                                    E1      S01117
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP28                                           S01408
     C*                                                                   S01408
      *                                                                   S01117
0728 C***35***** NIDT      COMP TNDA,X                 2626               S01117
0729 C**N35***** NIDT      COMP TNDAL                  2626               S01117
0730 C  N26                GOTO TAG01
0731 C**
0732 C********************************************************************
0733 C*
0734 C********************************************************************
0735 C*
0736 C*    SETON INTEREST-DATE PAY/REC INDICATOR.
0737 C           BITN3     TAG
     C*
     C*    IF CHIPS INTERFACE DETERMINE IF EVENT IS PAYMENT VIA CHIPS
     C   70                Z-ADD2         P                INTEREST EVENT
     C   70                Z-ADDNIDT      CHDT             EVENT DATE
     C   70                EXSR PAYCHP
     C   70 73             GOTO TAG01                      SUPPRESS OUTPUT
     C*
     C** If purchased NA is sold, suppress output if the next             S01378
     C*  interest date is after the sale date. (*IN08 = NAB)              S01378
     C           *IN08     IFEQ '1'                                       S01378
     C           SADT      ANDGT*ZERO                                     S01378
     C           NIDT      ANDGESADT                                      S01378
     C                     GOTO TAG01                      SUPPRESS OUTPUTS01378
     C                     END                                            S01378
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
0738 C*********************BITON'2'*******TLXI**********************E19374E23886
0738 C                     BITON'2'       TLXI                            E23886
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01093
     C                     MOVE '1'       *IN66                           S01093
     C*  BY-PASS INDICATOR ON DLIND IF BACK-VALUED EVENT
     C*****      NIDT      CABLTRUND      TAG01            SUPPRESS*OUTPUTS01194
     C/COPY WNCPYSRC,DL0279C005
     C           NIDT      CABLTBJRDNB    TAG01            SUPPRESS OUTPUTS01194
     C/COPY WNCPYSRC,DL0279C006
0739 C                     Z-ADD1         PRI2
0740 C  N50                SETON                     50
     C/COPY WNCPYSRC,DL0279C089
      *                                                                                       CDL033
      ** Flag interest date message as to be generated                                        CDL033
      ** for CF deals.                                                                        CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C           *IN42     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     MOVE 'Y'       WMSGIF                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
0741 C*
0742 C**************************
0743 C*
0744 C*    CONFIRMATION REPORTING REQUIREMENT.
0745 C           TAG01     TAG                             ** TAG01 TAG **
0744 C**                                                                  E43355
0744 C**   IF MATURITY CONFIRMATIONS ARE NOT REQUIRED, THIS DOES          E43355
0744 C**   NOT MEAN THAT INTEREST CONFIRMATIONS SHOULD NOT BE PRODUCED    E43355
0744 C**                                                                  E43355
0746 C**N41****            GOTO END                                       E43355
0747 C                     SETOF                     282931
0748 C*
0749 C*    PROCESS LIVE RECORDS ONLY
0750 C*
0751 C  N42                GOTO END
0752 C*
0753 C*    PROCESSING FOR FX OPTION AND LOAN/DEP RECORDS ONLY.
0754 C   08
0755 COR 09
0756 COR 06N23             GOTO END
0757 C*
0758 C*    CHECK OPTION TO DATE.
0759 C   06      OTDT      COMP 0                        28
0760 C   28                GOTO END
0761 C   06                GOTO TEST4
0762 C*
0763 C*    CHECK DEAL TYPE.
0764 C           DTYP      LOKUPTABTYP                   29
0765 C  N29                GOTO END
0766 C*
0767 C*    CHECK NEXT INT/MAT DATE.
0768 C           NIDT      COMP 0                    30
0769 C           MDAT      COMP 0                    31
0770 C  N30N31             GOTO END
0771 C   07N31             GOTO TEST5
0772 C*
0773 C           TEST4     TAG
0774 C********************************************************************
0775 C***  ACCESS CURRENCY ARRAY.
0776 C*
0777 C********************************************************************
0778 C*    CHECK LAST INT/VALUE DATE AGAINST MATURITY ELAPSED DATE.
     C/COPY WNCPYSRC,DL0279C030
0779 C   07      SLID      COMP 0                        32
     C   07N32   SLID      COMP MEDAL                  3333
0781 C   06
     COR 07 32   VDAT      COMP MEDAL                  3333
0783 C   07N33             GOTO END
     C/COPY WNCPYSRC,DL0279C031
0784 C********************************************************************E43355
0788 C**   IS SYSTEM CONFIGURED FOR MATURITY CONFIRMATIONS ?              E43355
     C  N41                SETOF                         33               E43355
0793 C  N41                GOTO TEST5                                     E43355
0784 C********************************************************************
0785 C***06
0786 C********************************************************************
0787 C*
0788 C*    CHECK EVENT DATE AGAINST MATURITY TO GO DATE.
0789 C   06      OTDT      COMP MGDAL                  3333
0790 C   07 31   MDAT      COMP MGDAL                  3333
0791 C***07*31 33MDAT      COMP RUND                 33  33       *****   S01194
0791 C   07 31 33MDAT      COMP BJRDNB               33  33               S01194
      *                                                                                     MD027639
      ** Generate maturity confirmation for back-valued maturity of                         MD027639
      ** Call Deals.                                                                        MD027639
      *                                                                                     MD027639
     C           *IN33     IFEQ '0'                                                         MD027639
     C           MDAT      ANDLTBJRDNB                                                      MD027639
     C           RECI      ANDEQ'D'                                                         MD027639
     C           DTYP      ANDEQ'CD'                                                        MD027639
     C                     MOVE '1'       *IN33                                             MD027639
     C                     ENDIF                                                            MD027639
0792 C   06N33
0793 COR 07 31N33          GOTO TEST5
0794 C*
0795 C*    TEST MATURITY CONFIRMATION INDICATOR.
0796 C   06
0797 COR 07 31             TESTB'1'       CNFI       33
0798 C*
0799 C*    SETON MATURITY CONFIRMATION INDICATOR.
0800 C   33                BITON'1'       CNFI
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01093
     C   33                MOVE '1'       *IN66                           S01093
0801 C   33N50             SETON                     50
     C/COPY WNCPYSRC,DL0279C090
      *                                                                                       CDL033
      ** Flag maturity confirmation as to be generated                                        CDL033
      ** for CF deals.                                                                        CDL033
      *                                                                                       CDL033
     C           *IN33     IFEQ *ON                                                           CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C           *IN42     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     MOVE 'Y'       WCONMF                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0802 C*
0803 C*    PROCESSING FOR LOAN/DEP RECORD ONLY.
0804 C           TEST5     TAG                             ** TEST5 TAG **
0805 C   06                GOTO END
0806 C*
0807 C*    CHECK NEXT INTEREST DATE AGAINST MATURITY TO GO DATE.
0808 C   30      NIDT      COMP MGDAL                  3434
0809 C***30*34   NIDT      COMP RUND                 34  34       *****   S01194
0809 C   30 34   NIDT      COMP BJRDNB               34  34               S01194
0810 C*
0811 C*    TEST INTEREST CONFIRMATION INDICATOR.
0812 C   30 34             TESTB'2'       CNFI       34
0813 C*
0814 C*    SETON INTEREST CONFIRMATION INDICATOR.
0815 C   34                BITON'2'       CNFI
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01093
     C   34                MOVE '1'       *IN66                           S01093
0816 C   34N50             SETON                     50
     C/COPY WNCPYSRC,DL0279C091
      *                                                                                       CDL033
      ** Flag interest date confirmation as to be generated                                   CDL033
      ** for CF deals.                                                                        CDL033
      *                                                                                       CDL033
     C           *IN34     IFEQ *ON                                                           CDL033
     C           CDL033    ANDEQ'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C           *IN42     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
     C                     MOVE 'Y'       WCONIF                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
0817 C*
0818 C*
0819 C           END       TAG                             ** END TAG ****
0820 C  N50                GOTO FINEND
0821 C*
0822 C*    SET ACTION CODE ON DLIND
0823 C   36                MOVE 'R'       ACTC    1
0824 C   36                GOTO FINEND
0825 C                     TESTB'7'       CNFI           37
0826 C   37                MOVE 'A'       ACTC
0827 C  N37                MOVE 'I'       ACTC
     C/COPY WNCPYSRC,DL0279C092
      *                                                                                       CDL033
      ** Perform final processing for CF deals.                                               CDL033
      *                                                                                       CDL033
     C           CDL033    IFEQ 'Y'                                                           CDL033
     C           *IN07     ANDEQ*ON                                                           CDL033
     C                     EXSR CKDEAL                                                        CDL033
     C           @FXT      IFEQ *ON                                                           CDL033
     C           DTYP      OREQ 'CF'                                                          CDL033
      *                                                                                       CDL033
      ** CF deals processing if interest date / maturity                                      CDL033
      ** confirmation is to be generated.                                                     CDL033
      *                                                                                       CDL033
     C           WCONIF    IFEQ 'Y'                                                           CDL033
     C           WCONMF    OREQ 'Y'                                                           CDL033
      *                                                                                       CDL033
      ** Check if advice is an amendment.                                                     CDL033
      *                                                                                       CDL033
     C           WAMND     IFEQ 'Y'                                                           CDL033
     C                     MOVE 'A'       ACTC                                                CDL033
     C                     ELSE                                                               CDL033
     C                     MOVE 'I'       ACTC                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Indicate advice as already generated for the current                                 CDL033
      ** interest period.  Then, perform update of new fields                                 CDL033
      ** in DEALSDC.                                                                          CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC2                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Perform interest calculation if interest date / maturity                             CDL033
      ** message / confirmation is to be generated.                                           CDL033
      *                                                                                       CDL033
     C           WMSGIF    IFEQ 'Y'                                                           CDL033
     C           WMSGMF    OREQ 'Y'                                                           CDL033
     C           WCONIF    OREQ 'Y'                                                           CDL033
     C           WCONMF    OREQ 'Y'                                                           CDL033
     C                     EXSR SRFRC3                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C*                                                                   S01119
     C                     END                                            S01119
0828 C*
0829 C*    INCREMENT RECORD COUNT FOR DLIND.
0830 C           FINEND    TAG                             ** FINEND TAG *
0831 C   50      DLCT      ADD  1         DLCT
     C**   PROCESS TRAILER RECORD                                         S01093
     C           *IN10     IFEQ '1'                                       S01093
0839 C                     Z-ADD0         ICT     50                      S01093
0840 C                     Z-ADD0         DCT     50                      S01093
0841 C                     Z-ADD0         VLII   150                      S01093
0842 C                     Z-ADD0         VLID    30                      S01093
0843 C                     Z-ADD0         VLDI   150                      S01093
0844 C                     Z-ADD0         VLDD    30                      S01093
0845 C                     Z-ADD0         LCDO    50                      S01093
0846 C                     Z-ADD0         TNLO    50                      S01093
0847 C**                                                                  S01093
0848 C                     Z-ADDZZTOTI    VLLI   150                      S01093
0849 C                     Z-ADDZZTOTD    VLLD    30                      S01093
0850 C**                                                                  S01093
0851 C********** NLRB      ADD  NINS      CNLRA   50                                 S01093 MD025190
0852 C********** CNLRA     SUB  NDEL      CNLRA                                      S01093 MD025190
     C           NLRB      ADD  NINS      XNLRA   60                                        MD025190
     C           XNLRA     SUB  NDEL      CNLRA   50                                        MD025190
      ** To cover the case of low value in NLRB from previous day and                       MD025190
      ** number of delete higher then NLRB + NINS                                           MD025190
     C           CNLRA     IFLT 0                                                           MD025190
     C           100000    ADD  CNLRA     CNLRA                                             MD025190
     C                     ENDIF                                                            MD025190
0853 C**                                                                  S01093
0854 C                     Z-ADDVLBF      ZZTOTI                          S01093
0855 C                     Z-ADDVLBL      ZZTOTD                          S01093
0856 C                     Z-ADDVRIF      ZZAMTI                          S01093
0857 C                     Z-ADDVRIL      ZZAMTD                          S01093
0858 C                     EXSR GLZSUM                                    S01093
0859 C                     Z-SUBVRDF      ZZAMTI                          S01093
0860 C                     Z-SUBVRDL      ZZAMTD                          S01093
0861 C                     EXSR GLZSUM                                    S01093
0862 C**                                                                  S01093
0863 C                     Z-ADDZZTOTI    CVLF   150                      S01093
0864 C                     Z-ADDZZTOTD    CVLL    30                      S01093
     C                     END
0832 C*
0833 C*
0834 C**************************
0835 C*
0836 C*    LAST CYCLE.
0837 C*
0838 C*****SET CONTROL FIELDS FOR TRAILER RECORDS.                        S01093
0839 C*R***                Z-ADD0         ICT     50                      S01093
0840 C*R***                Z-ADD0         DCT     50                      S01093
0841 C*R***                Z-ADD0         VLII   150                      S01093
0842 C*R***                Z-ADD0         VLID    30                      S01093
0843 C*R***                Z-ADD0         VLDI   150                      S01093
0844 C*R***                Z-ADD0         VLDD    30                      S01093
0845 C*R***                Z-ADD0         LCDO    50                      S01093
0846 C*R***                Z-ADD0         TNLO    50                      S01093
0847 C*****                                                               S01093
0848 C*R***                Z-ADDZZTOTI    VLLI   150                      S01093
0849 C*R***                Z-ADDZZTOTD    VLLD    30                      S01093
0850 C*****                                                               S01093
0851 C*R***      NLRB      ADD  NINS      CNLRA   50                      S01093
0852 C*R***      CNLRA     SUB  NDEL      CNLRA                           S01093
0853 C*****                                                               S01093
0854 C*R***                Z-ADDVLBF      ZZTOTI                          S01093
0855 C*R***                Z-ADDVLBL      ZZTOTD                          S01093
0856 C*R***                Z-ADDVRIF      ZZAMTI                          S01093
0857 C*R***                Z-ADDVRIL      ZZAMTD                          S01093
0858 C*R***                EXSR GLZSUM                                    S01093
0859 C*R***                Z-SUBVRDF      ZZAMTI                          S01093
0860 C*R***                Z-SUBVRDL      ZZAMTD                          S01093
0861 C*R***                EXSR GLZSUM                                    S01093
0862 C*****                                                               S01093
0863 C*R***                Z-ADDZZTOTI    CVLF   150                      S01093
0864 C*R***                Z-ADDZZTOTD    CVLL    30                      S01093
0865 C*
0867 C*LRN40***************EXSR ZSYSTM                             E19920 S01194
0327 C* CALL ACCESS PROG. FOR BANK DETAILS.                               S01194
     CLRN40                CALL 'AOBANKR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     CLRN40      @RTCD     IFNE *BLANK                                    S01194
     CLRN40                MOVEL'SDBANKPD'DBFILE 10        * * * * * * *  S01194
     CLRN40                MOVEL'006'     DBASE   3        * DBERR 006 *  S01194
     CLRN40                MOVEL@OPTN     DBOPTN  7        * * * * * * *  S01194
     CLRN40                MOVEL@OPTN     DBKEY  29                       S01194
0349 CLRN40                SETON                     U7U8                 S01194
     CLRN40                EXSR *PSSR                                     S01194
     CLR                   END                                            S01194
0865 C*
0866 C*    CONTROL TOTAL COMPARISONS.
      ** NLRA may have gone negative in IC when delete are done after new                   MD025190
      ** new input reach 100000 Reset it to positive.                                       MD025190
     CLR         NLRA      IFLT 0                                                           MD025190
     CLR         100000    ADD  NLRA      NLRA                                              MD025190
     CLR                   ENDIF                                                            MD025190
0867 CLR         NLRA      COMP CNLRA                5151
0868 CLRN51      VLAF      COMP CVLF                 5151
0869 CLRN51      VLAL      COMP CVLL                 5151
0870 C*
0871 C**   NOTE-NORE DOES NOT INCLUDE * RECS.
0872 C*R******   NORE      COMP RLCT                 5252                 S01093
0873 C**   TO REPORT TOTAL RECS. ON FILE
0874 C*R******   NORE      ADD  DECT      NORED   50                      S01093
0875 C*
0876 C*    SET SWITCH-8 IF CONTROLS OUT OF BALANCE.
0877 C*R*51*****                                                          S01093
0878 C*R*52*****           SETON                     U8                   S01093
0878 CLR 51                SETON                     U8                   S01093
     C********************************************************************
     C** PAYCHP SR. FOR DEAL PAY EVENTS, DETERMINE IF SETTLED VIA CHIPS.
     C**              IF EVENT IS A CHIPS PAYMENT AND EVENT DATE IS NOT
     C**              DATE OF NEXT WORKING DAY, SETON IND 73 TO BYPASS
     C**              OUTPUT, ELSE ALLOW PAY-RCV IND TO BE CREATED.
     C**                                                     *** PAYCHP **
     C           PAYCHP    BEGSR
     C**   RESET BYPASS INDICATOR
     C                     SETOF                     73
     C**   TEST EVENT INDICATOR
     C           P         COMP 1                        71-START EVENT
     C**   FOREIGN EXCHANGE - TEST SELL CURRENCY SETTLEMENT TYPE.
     C   06N71   SCST      COMP 07                       73
     C**   TAKINGS/PLACINGS/TIME DEPOSISTS/LOANS. MAY BE P-R-R OR R-P-P.
     C   07      RCDC      COMP 15                       72-LOAN
     C   07 72 71SDST      COMP 07                       73  AT START
     C   07N72N71MDST      COMP 07                       73  AT MAT./INT.
     C**   NEGOTIABLE ASSET PURCHASE - PAY AT START
     C   08 71   SDST      COMP 07                       73
     C**
     C**   IF CHIPS PAYMENT, TEST EVENT DATE AGAINST DATE OF
     C**    NEXT WORKING DAY.
     C***73*     CHDT      COMP DNWD                 73           *****   S01194
     C   73      CHDT      COMP BJDNWD               73                   S01194
     C**
     C                     ENDSR
0879 C********************************************************************
     C*                                                                   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    FRAIRS SR: TO CALCULATE INTEREST PAYMENT AMOUNTS IF        *   S01119
     C*               APPLICABLE ,FOR FRA/IRS                         *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : MAIN PROCESSING                              *   S01119
     C*                                                               *   S01119
     C*    CALLS : DLRADS, SUB01U, SUB01T, SUB02, RL1, RL2, RL3       *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           FRAIRS    BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C011
     C                     MOVE '0'       *IN87                           S01119
     C                     Z-ADD0         UEDAT   50                      S01119
     C                     Z-ADD0         TEDAT   50                      S01119
     C******************** Z-ADD0         LTXDT   50              S01119  S01117
     C                     Z-ADD0         UTXDT   50                      S01119
     C                     Z-ADD0         TTXDT   50                      S01119
     C                     MOVE *BLANKS   PRINT   1                       S01119
     C                     MOVE ' '       UPRT    1                       S01119
     C                     MOVE ' '       TPRT    1                       S01119
     C                     MOVE ' '       PRTCF   1                       S01119
     C                     Z-ADD0         WRK2    50                      S01119
     C                     Z-ADD0         WRK3    50                      S01119
     C                     Z-ADD0         WRK4    50                      S01119
     C                     Z-ADD0         WRK5    50                      S01119
     C                     Z-ADD0         DIFF   117                      S01119
     C                     Z-ADD0         NAIANP 130                      S01119
     C                     Z-ADD0         SZVDAT  50                      S01119
     C                     Z-ADD0         SZMDAT  50                      S01119
     C                     Z-ADD0         SZICB   10                      S01119
     C                     Z-ADD0         SZPPL  130                      S01119
     C                     Z-ADD0         SZIANP 130                      S01119
     C                     Z-ADD0         SZFIX  117                      S01119
     C                     Z-ADD0         SZFLT  117                      S01119
     C                     Z-ADD0         WRK6   150                      S01119
     C                     Z-ADD0         INTX   130                      S01119
     C                     Z-ADD0         DSANOT 130                      S01119
     C                     Z-ADD0         EINTR  152                      S01119
     C                     Z-ADD0         ENDDT   50                      S01119
     C                     Z-ADD0         ZTAXC  150                      S01119
     C                     Z-ADD0         TAXC   130                      S01119
     C                     Z-ADD0         UINOT  130                      S01119
     C                     Z-ADD0         TINOT  130                      S01119
     C                     Z-ADD0         NETAMT 130                      S01119
     C                     Z-ADD0         SINTX  130                      S01119
     C                     Z-ADD0         CINTX  130                      S01119
     C                     Z-ADD0         SINOT  130                      S01119
     C                     Z-ADD0         CINOT  130                      S01119
     C                     Z-ADD0         NICD    50                      S01119
     C                     Z-ADD0         EINT   130                      S01119
     C                     Z-ADD0         CALINT 130                      S01119
     C                     Z-ADD0         STINT  130                      S01119
     C                     Z-ADD0         CALINX 130                                        AR845022
     C                     Z-ADD0         STINTX 130                                        AR845022
     C                     Z-ADD0         PAYD    50                      S01119
     C                     Z-ADD0         UINTR  130                      S01119
     C                     Z-ADD0         TINTR  130                      S01119
     C                     Z-ADD0         TAXPY  130                      S01119
     C                     MOVE *BLANKS   SETL    1                       S01119
     C                     MOVE *BLANKS   KEY3    4                       S01119
     C**********           SETOF                     2014                            S01119 AR316628
     C                     SETOF                     201488                                 AR316628
     C/COPY WNCPYSRC,DL0279C007
      *                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
      *                                                                   CIR001
     C                     MOVE *BLANKS   CNPR    1                       CIR001
     C                     MOVE *BLANKS   DADI    1                       CIR001
     C                     Z-ADD0         ICIN    10                      CIR001
     C                     MOVE *BLANKS   REPR    1                       CIR001
     C                     Z-ADD0         RRLA    50                      CIR001
     C                     Z-ADD0         RRNT    50                      CIR001
     C                     MOVE *BLANKS   ZZ022  22                       CIR001
      *                                                                   CIR001
     C                     Z-ADD0         UNIPDX  50                                          232817
     C                     Z-ADD0         TNIPDX  50                                          232817
     C                     MOVE '0'       *IN55                                               232817
     C           DTYP      IFEQ 'RS'                                                          232817
     C           DTYP      OREQ 'RX'                                                          232817
     C           UNIPD     IFEQ 0                                                             232817
     C                     Z-ADDMDAT      UNIPDX                                              232817
     C                     ELSE                                                               232817
     C                     Z-ADDUNIPD     UNIPDX                                              232817
     C                     ENDIF                                                              232817
     C           TNIPD     IFEQ 0                                                             232817
     C                     Z-ADDMDAT      TNIPDX                                              232817
     C                     ELSE                                                               232817
     C                     Z-ADDTNIPD     TNIPDX                                              232817
     C                     ENDIF                                                              232817
     C********** BAPR      IFNE ' '                                                    232817 233128
     C********** BOVD      ANDLEUNIPDX                                                 232817 233128
     C********** BOVD      ANDLETNIPDX                                                 232817 233128
     C********** BOVD      ANDGEBJRDNB                                                 232817 233128
     C**********           MOVE '1'       *IN55                                        232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     ENDIF                                                              232817
     C           DTYP      IFEQ 'RS'                                      CIR001
     C           BOVD      ANDNE0                                         CIR001
     C           DTYP      OREQ 'RX'                                      CIR001
     C           BOVD      ANDNE0                                         CIR001
     C           DTYP      OREQ 'RP'                                      CIR006
     C           BOVD      ANDNE0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RR'                                      CIR006
     C           BOVD      ANDNE0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           DTYP      OREQ 'RF'                                      CIR006
     C           BOVD      ANDNE0                                         CIR006
     C           CIR006    ANDEQ'Y'                                       CIR006
     C           BOVD      IFLE MDAT                                      CIR001
     C                     Z-ADDBOVD      MDAT                            CIR001
     C********** UNIPD     IFGT BOVD                                                   CIR001 232817
     C**********           Z-ADDBOVD      UNIPD                                        CIR001 232817
     C**********           END                                                         CIR001 232817
     C********** UNIPD     IFEQ 0                                                      232817 233128
     C**********           Z-ADDBOVD      UNIPD                                        232817 233128
     C**********           END                                                         232817 233128
     C           UNICD     IFGT BOVD                                      CIR001
     C                     Z-ADDBOVD      UNICD                           CIR001
     C                     END                                            CIR001
     C           TNIPD     IFGT BOVD                                                   CIR001 232817
     C                     Z-ADDBOVD      TNIPD                                        CIR001 232817
     C                     END                                                         CIR001 232817
     C********** TNIPD     IFEQ 0                                                      232817 233128
     C**********           Z-ADDBOVD      TNIPD                                        232817 233128
     C**********           END                                                         232817 233128
     C           TNICD     IFGT BOVD                                      CIR001
     C                     Z-ADDBOVD      TNICD                           CIR001
     C                     END                                            CIR001
     C********** BOVD      IFLE UNIPD                                                  232817 233128
     C********** BOVD      ANDLETNIPD                                                  232817 233128
     C**********           Z-ADDBOVD      UNIPD                                        232817 233128
     C**********           Z-ADDBOVD      TNIPD                                        232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C****FOR*DEAL*TYPES*FR,RS,RL*AND*RX*IDENTIFY*OUR*AND*THEIR*   S01119 S01157
     C**  FOR DEAL TYPES FR,RS,RR,RP,RF AND RX IDENTIFY OUR AND THEIR     S01157
     C**  EVENT DATES (ie.PAYMENT DATES)                                  S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**  FOR FR DEAL TYPE BOTH OUR AND THEIR EVENT DATES = VALUE DATE    S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDVDAT      UEDAT                           S01119
     C                     Z-ADDVDAT      TEDAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  FOR RS,RX DEAL TYPES THE EVENT DATES = NEXT INTEREST            S01119
     C**  PAYMENT DATE IF PRESENT, OTHERWISE = NEXT INTEREST CHANGE       S01119
     C**  DATE IF PRESENT, OTHERWISE = MATURITY DATE                      S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C*                                                                   S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     UEDAT                           S01119
     C                     END                                            S01119
     C           UNICD     IFNE 0                                         S01119
     C           UEDAT     ANDEQ0                                         S01119
     C                     Z-ADDUNICD     UEDAT                           S01119
     C                     END                                            S01119
     C           UEDAT     IFEQ 0                                         S01119
     C                     Z-ADDMDAT      UEDAT                           S01119
     C                     END                                            S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TEDAT                           S01119
     C                     END                                            S01119
     C           TNICD     IFNE 0                                         S01119
     C           TEDAT     ANDEQ0                                         S01119
     C                     Z-ADDTNICD     TEDAT                           S01119
     C                     END                                            S01119
     C           TEDAT     IFEQ 0                                         S01119
     C                     Z-ADDMDAT      TEDAT                           S01119
     C                     END                                            S01119
      *                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
      *                                                                   CIR001
      ** Check if a buy-out is due.  If so, write to DLINDDM              CIR001
      ** for the buy-out confirmation.                                    CIR001
      *                                                                   CIR001
     C           BOVD      IFNE 0                                         CIR001
     C           BOVD      ANDGEBJRDNB                                    CIR001
     C           BOVD      ANDLEMGDAL                                     CIR001
      *                                                                   CIR001
     C                     TESTB'1'       CNFI       65                   CIR001
     C           *IN65     IFEQ '1'                                       CIR001
      *                                                                   CIR001
      ** Interest pay/rec amounts                                         CIR001
      *                                                                   CIR001
     C           BAPR      IFEQ 'P'                                       CIR001
     C                     Z-ADDBOAM      PIAMT                           CIR001
     C                     Z-ADD0         RIAMT                           CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADD0         PIAMT                           CIR001
     C                     Z-ADDBOAM      RIAMT                           CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
      ** Set up fields and write record to DLINDDM.                       CIR001
      *                                                                   CIR001
     C                     MOVE 'D'       RECI                            CIR001
     C                     MOVE 'D'       RCDT                            CIR001
     C                     Z-ADDBOVD      VDAT                            CIR001
     C                     Z-ADD0         DASN                            CIR001
     C                     MOVE *BLANKS   CHTP                            CIR001
     C                     MOVE 'K'       CNRQ                            CIR001
     C                     MOVE 'N'       CNPR                            CIR001
     C                     MOVE *BLANKS   REPR                            CIR001
     C                     Z-ADD0         RRLA                            CIR001
     C                     MOVE *BLANKS   DADI                            CIR001
     C                     Z-ADD0         PRI1                            CIR001
     C                     Z-ADD0         PRI2                            CIR001
     C                     Z-ADD0         PRI3                            CIR001
     C                     MOVE *BLANKS   ZZ004   4                       CIR001
     C                     Z-ADD0         ICIN                            CIR001
     C                     Z-ADD0         RRNT                            CIR001
     C                     Z-ADD0         TNLU                            CIR001
     C                     Z-ADD0         UFIR                            CIR001
     C                     Z-ADD0         TFIR                            CIR001
     C                     Z-ADD0         EVDAT                           CIR001
     C                     Z-ADD0         TAXPY                           CIR001
     C                     MOVE *BLANKS   ZZ022                           CIR001
     C/COPY WNCPYSRC,DL0279C054
     C                     EXCPTIRSFEE                                    CIR001
      *                                                                   CIR001
      ** Maintain record count                                            CIR001
      *                                                                   CIR001
     C                     ADD  1         DLCT                            CIR001
     C/COPY WNCPYSRC,DL0279C055
      *                                                                   CIR001
      ** Set on bit 1 of deal confirmation indicator.                     CIR001
      *                                                                   CIR001
     C                     BITON'1'       CNFI                            CIR001
      *                                                                   CIR001
      ** Set on indicator for deals file update.                          CIR001
      *                                                                   CIR001
     C                     MOVE '1'       *IN66                           CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   110874
     C                     MOVE *BLANK    UBACK   1                       110874
      *                                                                   CIR001
      ** If our interest is up front (discount or yield)                  CIR001
      *                                                                   CIR001
     C           UINPM     IFEQ 'D'                                       CIR001
     C           UINPM     OREQ 'Y'                                       CIR001
      *                                                                   CIR001
     C                     TESTB'1'       ACEI       86                   CIR001
      *                                                                   CIR001
      ** If value date of deal has not yet arrived                        CIR001
      *                                                                   CIR001
     C           *IN86     IFEQ '1'                                       CIR001
      *                                                                   CIR001
      ** Our first interest payment date is value date                    CIR001
      ** and our interest end date is the next interest payment date      CIR001
      *                                                                   CIR001
     C                     Z-ADDUEDAT     UNEDT   50                      CIR001
     C                     Z-ADDVDAT      UEDAT                           CIR001
     C           MEDAL     SUB  1         USLIP                           CIR001
     C                     ENDIF                                          110874
     C***********          ELSE                                    CIR001 110874
      *                                                                   CIR001
      ** If value date of deal has passed                                 CIR001
      ** our interest end date is the following interest payment date     CIR001
      *                                                                   CIR001
     C                     MOVEL'U'       OTIN                            CIR001
     C                     MOVEL'P'       RCIP                            CIR001
     C                     Z-ADDUEDAT     ZDAYNO                          CIR001
     C                     EXSR #LRATS                                    CIR001
     C                     Z-ADDZDAYNO    UNEDT                           CIR001
     C*                                                                   110874
     C**  If interest is up front, any nterest payments from previous     110874
     C**  periods will already have been made therefore pay interest      110874
     C**  for current period only.                                        110874
     C*                                                                   110874
     C           UEDAT     DOWLTBJRDNB                                    110874
     C                     Z-ADDUNEDT     UEDAT                           110874
     C                     Z-ADDUEDAT     ZDAYNO                          110874
     C                     EXSR #LRATS                                    110874
     C                     Z-ADDZDAYNO    UNEDT                           110874
     C                     MOVE 'Y'       UBACK                           110874
     C                     END                                            CIR001
      *                                                                   CIR001
      ** If our rate is floating                                          CIR001
      *                                                                   CIR001
     C********** UBRTT     IFNE *ZERO                                                  CIR001 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UINFD     ANDNE*ZERO                                     CIR001
      *                                                                   CIR001
      ** If our interest fix date is due, fix the effective int. rate.    CIR001
      ** Do not do this if the fix date is <= value date of the deal      CIR001
      ** and the effective interest rate if non-zero.  A short term       CIR001
      ** rate has been defined for the first interest period.             CIR001
      *                                                                   CIR001
     C           UINFD     IFLT BJDNWD                                    CIR001
      *                                                                   CIR001
     C           UINFD     IFGT VDAT                                      CIR001
     C           UEINR     OREQ *ZERO                                     CIR001
     C*                                                                   CSW005
     C* If rate has been fixed in i/c, use it                             CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           URFIN     ANDNE*BLANKS                                   CSW005
     C           URFIN     ANDNE'A'                                                           227642
     C                     MOVE USPIN     WSPIN                           CSW005
     C                     Z-ADDUBRTE     WBRTE                           CSW005
     C                     Z-ADDURTSP     WRTSP                           CSW005
     C                     EXSR #LEFIN                                    CSW005
     C                     ELSE                                           CSW005
     C                     EXSR SUB01U                                    CIR001
     C                     ENDIF                                          CSW005
     C                     Z-ADDRATE      UEINR                           CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else if not due, but falls before the payment date               CIR001
      ** ensure that the payment date is not processed                    CIR001
      *                                                                   CIR001
     C           UINFD     IFLE UEDAT                                     CIR001
     C           UEDAT     IFEQ TEDAT                                     CIR001
     C                     Z-ADD99999     TEDAT                           CIR001
     C                     END                                            CIR001
     C                     Z-ADD99999     UEDAT                           CIR001
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else if not due and falls after the payment date                 CIR001
      ** and after the next rate change date then the rate has been       CIR001
      ** fixed.  Update the effective interest rate.                      CIR001
      *                                                                   CIR001
     C           UINFD     IFGT UNICD                                     CIR001
     C                     MOVE USPIN     WSPIN   1                       CIR001
     C                     Z-ADDUBRTE     WBRTE  117                      CIR001
     C                     Z-ADDURTSP     WRTSP  117                      CIR001
     C                     EXSR #LEFIN                                    CIR001
     C                     Z-ADDRATE      UEINR                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   110874
     C                     MOVE *BLANK    TBACK   1                       110874
      *                                                                   CIR001
      ** If their interest is up front (discount or yield)                CIR001
      *                                                                   CIR001
     C           TINPM     IFEQ 'D'                                       CIR001
     C           TINPM     OREQ 'Y'                                       CIR001
      *                                                                   CIR001
     C                     TESTB'1'       ACEI       86                   CIR001
      *                                                                   CIR001
      ** If value date of deal has not yet arrived                        CIR001
      *                                                                   CIR001
     C           *IN86     IFEQ '1'                                       CIR001
      *                                                                   CIR001
      ** Their first interest payment date is value date                  CIR001
      ** and their interest end date is the next interest payment date    CIR001
      *                                                                   CIR001
     C                     Z-ADDTEDAT     TNEDT   50                      CIR001
     C                     Z-ADDVDAT      TEDAT                           CIR001
     C           MEDAL     SUB  1         TSLIP                           CIR001
     C                     ENDIF                                   CIR001 110874
     C***********          ELSE                                    CIR001 110874
      *                                                                   CIR001
      ** If value date of deal has passed                                 CIR001
      ** their interest end date is the following interest payment date   CIR001
      *                                                                   CIR001
     C                     MOVEL'T'       OTIN                            CIR001
     C                     MOVEL'P'       RCIP                            CIR001
     C                     Z-ADDTEDAT     ZDAYNO                          CIR001
     C                     EXSR #LRATS                                    CIR001
     C                     Z-ADDZDAYNO    TNEDT                           CIR001
     C*                                                                   110874
     C**  If interest is up front, any nterest payments from previous     110874
     C**  periods will already have been made therefore pay interest      110874
     C**  for current period only.                                        110874
     C*                                                                   110874
     C           TEDAT     DOWLTBJRDNB                                    110874
     C                     Z-ADDTNEDT     TEDAT                           110874
     C                     Z-ADDTEDAT     ZDAYNO                          110874
     C                     EXSR #LRATS                                    110874
     C                     Z-ADDZDAYNO    TNEDT                           110874
     C                     MOVE 'Y'       TBACK                           110874
     C                     END                                            CIR001
      *                                                                   CIR001
      ** If their rate is floating                                        CIR001
      *                                                                   CIR001
     C********** TBRTT     IFNE *ZERO                                                  CIR001 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TINFD     ANDNE*ZERO                                     CIR001
      *                                                                   CIR001
      ** If their interest fix date is due, fix the effective int. rate.  CIR001
      ** Do not do this if the fix date <= value date of the deal and     CIR001
      ** the effective interest rate is non-zero.  A short term rate      CIR001
      ** has been defined for the first interest period.                  CIR001
      *                                                                   CIR001
     C           TINFD     IFLT BJDNWD                                    CIR001
      *                                                                   CIR001
     C           TINFD     IFGT VDAT                                      CIR001
     C           TEINR     OREQ *ZERO                                     CIR001
     C*                                                                   CSW005
     C* If rate has been fixed in i/c, use it                             CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           TRFIN     ANDNE*BLANKS                                   CSW005
     C           TRFIN     ANDNE'A'                                                           227642
     C                     MOVE TSPIN     WSPIN                           CSW005
     C                     Z-ADDTBRTE     WBRTE                           CSW005
     C                     Z-ADDTRTSP     WRTSP                           CSW005
     C                     EXSR #LEFIN                                    CSW005
     C                     ELSE                                           CSW005
     C                     EXSR SUB01T                                    CIR001
     C                     ENDIF                                          CSW005
     C                     Z-ADDRATE      TEINR                           CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else if not due, but falls before the payment date               CIR001
      ** ensure that the payment date is not processed                    CIR001
      *                                                                   CIR001
     C           TINFD     IFLE TEDAT                                     CIR001
     C           TEDAT     IFEQ UEDAT                                     CIR001
     C                     Z-ADD99999     UEDAT                           CIR001
     C                     END                                            CIR001
     C                     Z-ADD99999     TEDAT                           CIR001
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else if not due and falls after the payment date                 CIR001
      ** and after the next rate change date then the rate has been       CIR001
      ** fixed.  Update the effective interest rate.                      CIR001
      *                                                                   CIR001
     C           TINFD     IFGT TNICD                                     CIR001
     C                     MOVE TSPIN     WSPIN                           CIR001
     C                     Z-ADDTBRTE     WBRTE                           CIR001
     C                     Z-ADDTRTSP     WRTSP                           CIR001
     C                     EXSR #LEFIN                                    CIR001
     C                     Z-ADDRATE      TEINR                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****FOR*RL*DEAL*TYPE*CHECK*WHICH*IS*FLOATING*RATE*SIDE*AND*  S01119 S01157
     C**  FOR RR,RP,RF DEAL TYPES CHECK WHICH IS FLOATING RATE SIDE AND   S01157
     C**  SET THE EVENT DATE = NEXT INTEREST PAYMENT DATE                 S01119
     C**  IF PRESENT, OTHERWISE = NEXT INTEREST CHANGE                    S01119
     C**  DATE IF PRESENT, OTHERWISE = MATURITY DATE                      S01119
     C**  N.B. SET OPPOSITE EVENT DATE TO THE SAME DATE                   S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C*  USE OUR INTEREST DETAILS                                         S01119
     C           UNIPD     IFNE 0                                         S01119
     C                     Z-ADDUNIPD     UEDAT                           S01119
     C                     END                                            S01119
     C           UNICD     IFNE 0                                         S01119
     C           UEDAT     ANDEQ0                                         S01119
     C                     Z-ADDUNICD     UEDAT                           S01119
     C                     END                                            S01119
     C           UEDAT     IFEQ 0                                         S01119
     C                     Z-ADDMDAT      UEDAT                           S01119
     C                     END                                            S01119
     C                     Z-ADDUEDAT     TEDAT                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C*  OTHERWISE USE THEIR INTEREST DETAILS                             S01119
     C           TNIPD     IFNE 0                                         S01119
     C                     Z-ADDTNIPD     TEDAT                           S01119
     C                     END                                            S01119
     C           TNICD     IFNE 0                                         S01119
     C           TEDAT     ANDEQ0                                         S01119
     C                     Z-ADDTNICD     TEDAT                           S01119
     C                     END                                            S01119
     C           TEDAT     IFEQ 0                                         S01119
     C                     Z-ADDMDAT      TEDAT                           S01119
     C                     END                                            S01119
     C                     Z-ADDTEDAT     UEDAT                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
      ** Process Buy-Out confirmations                                    CIR006
      *                                                                   CIR006
     C           CIR006    IFEQ 'Y'                                       CIR006
     C           BOVD      ANDNE0                                         CIR006
     C           BOVD      ANDGEBJRDNB                                    CIR006
     C           BOVD      ANDLEMGDAL                                     CIR006
     C                     TESTB'1'       CNFI       65                   CIR006
      *                                                                   CIR006
     C           *IN65     IFEQ '1'                                       CIR006
     C           BAPR      IFEQ 'P'                                       CIR006
     C                     Z-ADDBOAM      PIAMT                           CIR006
     C                     Z-ADD0         RIAMT                           CIR006
     C                     ELSE                                           CIR006
     C                     Z-ADD0         PIAMT                           CIR006
     C                     Z-ADDBOAM      RIAMT                           CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     MOVEL'D'       RECI                            CIR006
     C                     MOVEL'D'       RCDT                            CIR006
     C                     Z-ADDBOVD      VDAT                            CIR006
     C                     Z-ADD0         DASN                            CIR006
     C                     MOVE *BLANKS   CHTP                            CIR006
     C                     MOVEL'K'       CNRQ                            CIR006
     C                     MOVEL'N'       CNPR                            CIR006
     C                     MOVE *BLANKS   REPR                            CIR006
     C                     Z-ADD0         RRLA                            CIR006
     C                     MOVE *BLANKS   DADI                            CIR006
     C                     Z-ADD0         PRI1                            CIR006
     C                     Z-ADD0         PRI2                            CIR006
     C                     Z-ADD0         PRI3                            CIR006
     C                     MOVE *BLANKS   ZZ004                           CIR006
     C                     Z-ADD0         ICIN                            CIR006
     C                     Z-ADD0         RRNT                            CIR006
     C                     Z-ADD0         TNLU                            CIR006
     C                     Z-ADD0         UFIR                            CIR006
     C                     Z-ADD0         TFIR                            CIR006
     C                     Z-ADD0         EVDAT                           CIR006
     C                     Z-ADD0         TAXPY                           CIR006
     C                     MOVE *BLANKS   ZZ022                           CIR006
     C                     EXCPTIRSFEE                                    CIR006
      *                                                                   CIR006
     C                     ADD  1         DLCT                            CIR006
     C                     BITON'1'       CNFI                            CIR006
     C                     SETON                     66                   CIR006
     C                     ENDIF                                          CIR006
     C                     ENDIF                                          CIR006
      *                                                                   CIR006
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**  IDENTIFY ALL DEALS FOR WHICH OUR OR THEIR PAY/RECEIVE           S01119
     C**  REPORTING OR INTEREST PAYMENT CONFIRMATIONS ARE REQUIRED        S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**  i) IF EITHER OF OUR OR THEIR EVENT DATES IS LESS OR EQUAL       S01119
     C**     TO DATE OF NEXT WORKING DAY + NO. OF TELEX NOTICE DAYS       S01119
     C**     FOR LOCAL OR DEAL CCY                                        S01119
     C*********                                                   S01119  S01117
     C****OBTAIN LOCAL TELEX NOTICE DAYS                          S01119  S01117
     C*********                                                   S01119  S01117
     C*********            Z-ADD1         I       30              S01119  S01117
     C*********  LOCY      LOKUPCCYA,I                   86       S01119  S01117
     C*********  LOCY      LOKUPCY,I                     86       S01119  S01117
     C*********            Z-ADDTNDA,I    LTXDT                   S01119  S01117
     C*                                                                   S01119
     C**  OBTAIN OUR TELEX NOTICE DAYS                                    S01119
      *                                                                   LN0698
      ** IF SETTLEMENT BY NOSTRO USE CCY/NOSTRO LOCATION TO DETERMINE     LN0698
      ** TELEX NOTICE DATE                                                LN0698
     C           STYP1     IFEQ 01                                        LN0698
     C           STYP1     OREQ 07                                        LN0698
     C           STYP1     OREQ 08                                        LN0698
      *                                                                   S01117
      ** SET UP CCY/NOSTRO READY TO OBTAIN TELEX NOTICE DAYS              S01117
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           PSCY      ANDNE*BLANKS                                   CEU003
     C                     MOVELPSCY      TCYN1                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELUCUCY     TCYN1                           S01117
     C                     ENDIF                                          CEU003
     C                     MOVE SNOS1     TCYN1                           S01117
     C                     Z-ADD1         X                               S01117
     C           TCYN1     LOKUPCN,X                     24               S01117
      *                                                                   S01117
      ** IF ELEMENT FOR CCY/NOSTRO NOT FOUND, SET IT UP                   S01117
      ** THIS WILL ALSO SETUP THE INDEX, X.                               S01117
     C           *IN24     IFEQ '0'                        B1             S01117
     C***********          MOVELUCUCY     ZCCY1            *1      S01117 CEU003
     C                     MOVELTCYN1     ZCCY1            *1             CEU003
     C                     MOVE SNOS1     ZNOS1            *1             S01117
     C                     EXSR TLXNOT                     *1             S01117
     C   U7                GOTO END                        *1             S01117
     C                     END                             E1             S01117
     C                     Z-ADDTNDA,X    UTXDT                           S01117
     C/COPY WNCPYSRC,DL0279C042
      *                                                                   LN0698
     C                     ELSE                                           LN0698
      *                                                                   LN0698
      ** IF SETTLEMENT TYPE NOT 01,07,08 USE LOCAL CCY/LOCATION           LN0698
     C                     Z-ADDTNDAL     UTXDT                           LN0698
     C                     END                                            LN0698
      *                                                                   S01117
     C*********            Z-ADD1         I       30               S01119 S01117
     C*********  UCUCY     LOKUPCCYA,I                   86        S01119 S01117
     C*********  UCUCY     LOKUPCY,I                     86        S01119 S01117
     C*********            Z-ADDTNDA,I    UTXDT                    S01119 S01117
     C*                                                                   S01119
     C**  OBTAIN THEIR TELEX NOTICE DAYS                                  S01119
      *                                                                   LN0698
      ** IF SETTLEMENT BY NOSTRO USE CCY/NOSTRO LOCATION TO DETERMINE     LN0698
      ** TELEX NOTICE DATE                                                LN0698
     C           STYP2     IFEQ 01                                        LN0698
     C           STYP2     OREQ 07                                        LN0698
     C           STYP2     OREQ 08                                        LN0698
      *                                                                   S01117
      ** SET UP CCY/NOSTRO READY TO OBTAIN TELEX NOTICE DAYS              S01117
     C           CEU003    IFEQ 'Y'                                       CEU003
     C           RSCY      ANDNE*BLANKS                                   CEU003
     C                     MOVELRSCY      TCYN2                           CEU003
     C                     ELSE                                           CEU003
     C                     MOVELTCUCY     TCYN2                           S01117
     C                     ENDIF                                          CEU003
     C                     MOVE SNOS2     TCYN2                           S01117
     C                     Z-ADD1         X                               S01117
     C           TCYN2     LOKUPCN,X                     24               S01117
      *                                                                   S01117
      ** IF ELEMENT FOR CCY/NOSTRO NOT FOUND, SET IT UP                   S01117
      ** THIS WILL ALSO SETUP THE INDEX, X.                               S01117
     C           *IN24     IFEQ '0'                        B1             S01117
     C***********          MOVELTCUCY     ZCCY1            *1      S01117 CEU003
     C                     MOVELTCYN2     ZCCY1            *1             CEU003
     C                     MOVE SNOS2     ZNOS1            *1             S01117
     C                     EXSR TLXNOT                     *1             S01117
     C   U7                GOTO END                        *1             S01117
     C                     END                             E1             S01117
     C                     Z-ADDTNDA,X    TTXDT                           S01117
     C/COPY WNCPYSRC,DL0279C043
      *                                                                   LN0698
     C                     ELSE                                           LN0698
      *                                                                   LN0698
      ** IF SETTLEMENT TYPE NOT 01,07,08 USE LOCAL CCY/LOCATION           LN0698
     C                     Z-ADDTNDAL     TTXDT                           LN0698
     C                     END                                            LN0698
     C*                                                                   S01119
     C*********            Z-ADD1         I       30               S01119 S01117
     C********** TCUCY     LOKUPCCYA,I                   86        S01119 S01117
     C*********  TCUCY     LOKUPCY,I                     86        S01119 S01117
     C*********            Z-ADDTNDA,I    TTXDT                    S01119 S01117
     C*                                                                   S01119
     C***FOR*DEAL*TYPES*'FR'*'RL'*                                 S01119 S01157
     C** FOR DEAL TYPES 'FR','RR','RP','RF'                               S01157
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C*                                                                   S01119
     C*                                                                                     AR316355
      ** Check if 'Up_front fee paymend/ receipt ' flag has been set.                       AR316355
     C*                                                                                     AR316355
     C           UPPR      IFEQ *BLANKS                                                     AR316355
     C           UPVD      ANDNE0                                                           MD027692
     C           UPFE      ANDNE0                                                           MD027692
     C           DTYP      ANDNE'FR'                                                        AR316355
     C           BYSL      IFEQ 'B'                                                         AR316355
     C                     MOVE 'P'       UPPR                                              AR316355
     C                     ELSE                                                             AR316355
     C                     MOVE 'R'       UPPR                                              AR316355
     C                     END                                                              AR316355
     C                     END                                                              AR316355
      *                                                                                     AR316628
      ** If value date of deal has not yet arrived                                          AR316628
      *                                                                                     AR316628
     C                     TESTB'1'       ACEI       86                                     AR316628
      *                                                                                     AR316628
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C***********UEDAT     IFLE LTXDT                             S01119  S01117
     C           UEDAT     IFLE TNDAL                                     S01117
     C           UEDAT     ORLE UTXDT                                     S01119
     C           *IN86     OREQ '1'                                                         AR316628
     C                     MOVE 'Y'       PRINT                           S01119
     C/COPY WNCPYSRC,DL0279C019
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C***********TEDAT     IFLE LTXDT                             S01119  S01117
     C           TEDAT     IFLE TNDAL                                     S01117
     C           TEDAT     ORLE TTXDT                                     S01119
     C           *IN86     OREQ '1'                                                         AR316628
     C                     MOVE 'Y'       PRINT                           S01119
     C/COPY WNCPYSRC,DL0279C020
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C** FOR DEAL TYPE 'RS' 'RX'                                          S01119
     C*                                                                   S01119
     C           STYP1     IFEQ 01                                                          BUG7094R
     C           STYP1     OREQ 07                                                          BUG7094R
     C           STYP1     OREQ 08                                                          BUG7094R
     C           UEDAT     IFLE UTXDT                                                       BUG7094R
     C                     MOVE 'Y'       PRINT                                             BUG7094R
     C                     MOVE 'Y'       UPRT                PRINT OUR                     BUG7094R
     C                     END                                                              BUG7094R
     C*                                                                                     BUG7094R
     C                     ELSE                                                             BUG7094R
     C***********UEDAT     IFLE LTXDT                             S01119  S01117
     C           UEDAT     IFLE TNDAL                                     S01117
     C           UEDAT     ORLE UTXDT                                     S01119
     C                     MOVE 'Y'       PRINT                           S01119
     C                     MOVE 'Y'       UPRT                PRINT OUR   S01119
     C/COPY WNCPYSRC,DL0279C021
     C                     END                                            S01119
     C                     ENDIF                                                            BUG7094R
     C*                                                                                     BUG7094R
     C           STYP2     IFEQ 01                                                          BUG7094R
     C           STYP2     OREQ 07                                                          BUG7094R
     C           STYP2     OREQ 08                                                          BUG7094R
     C           TEDAT     IFLE TTXDT                                                       BUG7094R
     C                     MOVE 'Y'       PRINT                                             BUG7094R
     C                     MOVE 'Y'       TPRT                PRINT THEIR                   BUG7094R
     C                     END                                                              BUG7094R
     C*                                                                                     BUG7094R
     C                     ELSE                                                             BUG7094R
     C*                                                                   S01119
     C********** TEDAT     IFLE LTXDT                             S01119  S01117
     C           TEDAT     IFLE TNDAL                                     S01117
     C           TEDAT     ORLE TTXDT                                     S01119
     C                     MOVE 'Y'       PRINT                           S01119
     C                     MOVE 'Y'       TPRT                PRINT THEIR S01119
     C/COPY WNCPYSRC,DL0279C022
     C                     END                                            S01119
     C*                                                                                     BUG7094R
     C                     ENDIF                                                            BUG7094R
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****ii)*IF*THE*MATURITY*CONFIRMATION INDICATOR = Y            S01119E02378
     C**********CHECK*IF*PAYMENT CONFIRMATIONS ARE TO BE PRODUCED.  S01119E02378
     C****************                                              S01119E02378
     C*   ii) CHECK IF PAYMENT CONFIRMATIONS ARE TO BE PRODUCED.          E02378
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'3'       UDSTI          14 ON-AVG RATE   S01119
     C                     ELSE                                           S01119
     C                     TESTB'3'       TDSTI          14               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*****      MCRI      IFEQ 'Y'                               S01119  S01194
     C***********BNMCRI    IFEQ 'Y'                                 S01194E02378
     C*                                                                   S01119
     C*                                                                   S01119
     C****FOR*RS,*RX*AND*RL*NON*AVERAGE*DEALS*EITHER*OUR*OR*THEIR* S01119 S01157
     C**  FOR RS,RX,RR,RA AND RF NON AVERAGE DEALS EITHER OUR OR THEIR    S01157
     C**  START/LAST INTEREST DATE MUST BE LESS THAN, OR EQUAL            S01119
     C**  RUN DATE LESS MATURITY CONFIRMATION ELAPSED (WORKING) DAYS      S01119
     C*                                                                   S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP18                                           S01408
     C*                                                                   S01408
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP19                                           S01408
     C*                                                                   S01408
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C/COPY WNCPYSRC,DL0279C012
     C           *IN14     ANDEQ'0'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
     C*                                                                   S01119
     C           USLIP     IFNE 0                                         S01119
     C           USLIP     ANDLEMEDAL                                     S01119
     C           TSLIP     ORNE 0                                         S01119
     C           TSLIP     ANDLEMEDAL                                     S01119
     C*                                                                   S01119
     C**  EITHER OF OUR OR THEIR EVENT DATES MUST BE LESS THAN OR         S01119
     C**  EQUAL RUN DATE PLUS MATURITY PERIOD TO GO (WORKING) DAYS        S01119
     C*                                                                   S01119
     C           UEDAT     IFLE MGDAL                                     S01119
     C           TEDAT     ORLE MGDAL                                     S01119
     C                     MOVE 'Y'       PRINT                           S01119
     C                     MOVE 'Y'       PRTCF               PRINT CONF. S01119
     C/COPY WNCPYSRC,DL0279C023
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP20                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C*                                                                   S01119
     C**  FOR FRA PRODUCE PAYMENT CONFIRMATIONS IF NEXT INTEREST          S01119
     C**  FIX DATE *LT NEXT WORKING DAY.                                  S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****      UINFD     ANDLTDNWD                              S01119  S01194
     C           UINFD     ANDLTBJDNWD                                    S01194
     C********** TBRTT     ORNE 0                                                      S01119 CSD103
     C           TBRTT     ORNE *BLANKS                                                       CSD103
     C*****      TINFD     ANDLTDNWD                              S01119  S01194
     C           TINFD     ANDLTBJDNWD                                    S01194
     C                     MOVE 'Y'       PRTCF                           S01119
     C                     MOVE 'Y'       PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****FOR*AVERAGE*RL*DEALS*PRODUCE*PAYMENT*CONFIRMATIONS*IF*NE S01119 S01157
     C**  FOR AVERAGE RR,RP,RF DEALS PRODUCE PAY CONFIRMATIONS IF NEXT    S01157
     C**  INTEREST PAYMENT DATE *LT NEXT WORKING DAY.                     S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****      UEDAT     ANDLTDNWD                              S01119  S01194
     C           UEDAT     ANDLTBJDNWD                                    S01194
     C********** TBRTT     ORNE 0                                                      S01119 CSD103
     C           TBRTT     ORNE *BLANKS                                                       CSD103
     C*****      TEDAT     ANDLTDNWD                              S01119  S01194
     C           TEDAT     ANDLTBJDNWD                                    S01194
     C                     MOVE 'Y'       PRTCF                           S01119
     C                     MOVE 'Y'       PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  DETERMINE IF OUR AND/OR THEIR CONF TO BE PRINTED                S01119
     C*                                                                   S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP21                                           S01408
     C*                                                                   S01408
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP22                                           S01408
     C*                                                                   S01408
     C*                                                                   S01119
     C           USLIP     IFNE 0                                         S01119
     C           USLIP     ANDLEMEDAL                                     S01119
     C           UEDAT     ANDLEMGDAL                                     S01119
     C                     MOVE 'Y'       UPRT                  OUR PRINT S01119
     C/COPY WNCPYSRC,DL0279C024
     C                     END                                            S01119
     C*                                                                   S01119
     C           TSLIP     IFNE 0                                         S01119
     C           TSLIP     ANDLEMEDAL                                     S01119
     C           TEDAT     ANDLEMGDAL                                     S01119
     C                     MOVE 'Y'       TPRT                THEIR CONF  S01119
     C/COPY WNCPYSRC,DL0279C025
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*********************END                                      S01119E02378
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP23                                           S01408
      ** For IRS deals where one or both sides are OIS's if the OIS side                      CIR007
      ** only is settling, or both sides are settling, then settlement                        CIR007
      ** processing must be deffered until the actual day of settlement.                      CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
     C           DTYP      ANDEQ'RS'                                                          CIR007
     C           TICFR     IFEQ 'O'                                                           CIR007
     C           TPRT      ANDEQ'Y'                                                           CIR007
     C           TEDAT     ANDNEBJRDNB                                                        CIR007
     C                     MOVE 'N'       TPRT                                                CIR007
     C           TEDAT     IFEQ UEDAT                                                         CIR007
     C                     MOVE 'N'       UPRT                                                CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
     C           UPRT      ANDEQ'Y'                                                           CIR007
     C           UEDAT     ANDNEBJRDNB                                                        CIR007
     C                     MOVE 'N'       UPRT                                                CIR007
     C           UEDAT     IFEQ TEDAT                                                         CIR007
     C                     MOVE 'N'       TPRT                                                CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C           UPRT      IFNE 'Y'                                                           CIR007
     C           TPRT      ANDNE'Y'                                                           CIR007
     C           PRTCF     ANDNE'Y'                                                           CIR007
     C                     MOVE 'N'       PRINT                                               CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C*                                                                   S01408
     C*                                                                   S01119
     C**  iii) PAYMENT CONFIRMATIONS AND TELEXES CAN ONLY BE DONE         S01119
     C**       FOR KNOWN DETAILS, OR IF THEY ARE STILL OUTSTANDING,       S01119
     C**       SO IN ADDITION TO i) & ii) THE FOLLOWING APPLIES           S01119
     C*                                                                   S01119
     C***********UBRTT*****IFNE 0                                   S01119S01157
     C*********************TESTB'3'       TLXI           14 TELX PR S01119S01157
     C*********************TESTB'2'       CNFI           16 CONF PR S01119S01157
     C*********************ELSE                                     S01119S01157
     C*********************TESTB'4'       TLXI           14         S01119S01157
     C*********************TESTB'3'       CNFI           16         S01119S01157
     C*********************END                                      S01119S01157
     C*                                                                   S01157
     C** The above conditioning is wrong; all that need be done is to     S01157
     C** check if either bit is on in both fields.                        S01157
     C*                                                                   S01157
     C                     TESTB'34'      TLXI         14                 S01157
     C                     TESTB'23'      CNFI         16                 S01157
     C*                                                                   S01119
     C*                                                                   S01119
     C**  FOR FR TYPE, INTEREST FIX DATE FOR NON-ZERO BASE RATE DETAILS   S01119
     C**  MUST BE LESS THAN OR EQUAL TO DATE OF NEXT WORKING DAY - 1      S01119
     C*                                                                   S01119
     C*****      DNWD      SUB  1         WRK5                    S01119  S01194
     C           BJDNWD    SUB  1         WRK5                            S01194
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C           UINFD     IFGT WRK5                                      S01119
     C           *IN14     OREQ '1'                                       S01119
     C           *IN16     ANDEQ'1'                                       S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C           TINFD     IFGT WRK5                                      S01119
     C           *IN14     OREQ '1'                                       S01119
     C           *IN16     ANDEQ'1'                                       S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****FOR*RS,RX*AND*RL(NON*AVE.*BASIS)*IF*A*RATE*CHANGE*DATE*E S01119 S01157
     C**  FOR RS,RX,RR,RP,RF(NON AVE. BASIS)IF RATE CHANGE DATE EXISTS    S01157
     C**  BEFORE A PAYMENT DATE AND THE FIX DATE IS NON-ZERO AND IS ON    S01119
     C**  OR BEFORE THE RATE CHANGE DATE THEN THE FIX DATE MUST BE ON     S01119
     C**  OR BEFORE THE DATE OF NEXT WORKING DAY - 1                      S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'3'       UDSTI          14 ON-AVG RATE   S01119
     C                     TESTB'0'       UDNSI          16 INIT RATE SET S01119
     C                     ELSE                                           S01119
     C                     TESTB'3'       TDSTI          14               S01119
     C                     TESTB'0'       TDNSI          16               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                              S01119  S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTUEDAT                                     S01119
     C           UINFD     IFNE 0                                         S01119
     C           UINFD     ANDLEUNICD                                     S01119
     C           UINFD     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTEDAT                                     S01119
     C           TINFD     IFNE 0                                         S01119
     C           TINFD     ANDLETNICD                                     S01119
     C           TINFD     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UNICD     IFNE 0                                         S01119
     C           UNICD     ANDLTUEDAT                                     S01119
     C           UINFD     IFNE 0                                         S01119
     C           UINFD     ANDLEUNICD                                     S01119
     C           UINFD     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C           TNICD     IFNE 0                                         S01119
     C           TNICD     ANDLTTEDAT                                     S01119
     C           TINFD     IFNE 0                                         S01119
     C           TINFD     ANDLETNICD                                     S01119
     C           TINFD     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
      *                                                                                       233128
      ** If buy-out value date is before next int payment or maturity                         233128
      ** do not generate pay/receive message for interest                                     233128
      *                                                                                       233128
     C           BOVD      IFNE 0                                                             233128
     C           BOVD      ANDLTUNIPDX                                                        233128
     C                     MOVE 'N'       UPRT                                                233128
     C                     ENDIF                                                              233128
      *                                                                                       233128
     C           BOVD      IFNE 0                                                             233128
     C           BOVD      ANDLTTNIPDX                                                        233128
     C                     MOVE 'N'       TPRT                                                233128
     C                     ENDIF                                                              233128
      *                                                                                       233128
     C                     END                                            S01119
     C*                                                                   S01119
     C****FOR*RL(AVE.*BASIS)*THE*PAYMENT*DATE*MUST*BE*ON*OR*BEFORE S01119 S01157
     C**  FOR RR,RP,RF(AVE. BASIS)THE PAYMENT DATE MUST BE ON OR BEFORE   S01157
     C**  DATE OF NEXT WORKING DAY - 1                                    S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UEDAT     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           TEDAT     IFGT WRK5                                      S01119
     C                     MOVE *BLANKS   PRINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE AMOUNTS OF INTEREST PAYABLE FOR THOSE DEALS           S01119
     C**  IDENTIFIED ABOVE                                                S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**  ////////////////////////////                                    S01119
     C**  FR DEAL TYPE CALCULATIONS                                       S01119
     C**  ////////////////////////////                                    S01119
     C*                                                                   S01119
     C           PRINT     IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C*                                                                   S01119
     C**  IF THE FIX DATE IS LESS THAN DATE OF THE NEXT WORK DAY          S01119
     C**  AND THE RATE IS NOT SET, OBTAIN EFFECTIVE INT RATE VIA          S01119
     C**  SR:SUB01U/T                                                     S01119
     C*                                                                   S01119
     C                     Z-ADD0         RATE       2079                 S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'1'       UDSTI          20 ON-NEG. INT.  S01119
     C                     TESTB'0'       UDNSI          79 ON-RATE SET   S01119
     C           *IN79     IFEQ '0'                                       S01119
     C*****      UINFD     ANDLTDNWD                              S01119  S01194
     C           UINFD     ANDLTBJDNWD                                    S01194
     C                     EXSR SUB01U                                    S01119
     C                     Z-ADDRATE      UEINR                           S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBRATE      UEINR                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     TESTB'1'       TDSTI          20               S01119
     C                     TESTB'0'       TDNSI          79               S01119
     C           *IN79     IFEQ '0'                                       S01119
     C*****      TINFD     ANDLTDNWD                              S01119  S01194
     C           TINFD     ANDLTBJDNWD                                    S01194
     C                     EXSR SUB01T                                    S01119
     C                     Z-ADDRATE      TEINR                           S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBRATE      TEINR                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  ESTABLISH DISCOUNTED SETTLEMENT AMOUNT NET OF TAX AND WHICH     S01119
     C**  SETTLEMENT INSTRUCTIONS WILL BE USED TO SETTLE THE PAYMENT      S01119
     C*                                                                   S01119
     C**  CALCULATE THE NET ACCRUED INTEREST ADJUSTMENTS NOT POSTED       S01119
     C*                                                                   S01119
     C           UEINR     IFGE TEINR                                     S01119
     C           UAIAN     SUB  TAIAN     NAIANP                          S01119
     C                     MOVE 'P'       SETL                            S01119
     C                     ELSE                                           S01119
     C           TAIAN     SUB  UAIAN     NAIANP                          S01119
     C                     MOVE 'R'       SETL                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF NEGATIVE INTEREST INDICATOR IS ON, REVERSE THE SING          S01119
     C**  OF THE EFECTIVE INTEREST RATE - FOR DLRADS.                     S01119
     C*                                                                   S01119
     C                     Z-ADDUEINR     UEINRX 117                      S01119
     C                     Z-ADDTEINR     TEINRX 117                      S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBUEINR     UEINRX                          S01119
     C                     Z-SUBTEINR     TEINRX                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THE DISCOUNTED SETTLEMENT AMOUNT AS POSITIVE          S01119
     C*                                                                   S01119
     C                     Z-ADDVDAT      SZVDAT                          S01119
     C                     Z-ADDMDAT      SZMDAT                          S01119
     C                     Z-ADDNAIANP    SZIANP                          S01119
     C                     Z-ADDRATE      SZFLT                           S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     MOVE UICBS     SZICB                           S01119
     C                     Z-ADDUPAMT     SZPPL                           S01119
     C                     Z-ADDTEINRX    SZFIX                           S01119
     C                     Z-ADDUEINRX    SZFLT                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     MOVE TICBS     SZICB                           S01119
     C                     Z-ADDTPAMT     SZPPL                           S01119
     C                     Z-ADDUEINRX    SZFIX                           S01119
     C                     Z-ADDTEINRX    SZFLT                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     EXSR DLRADS                                    S01119
     C*                                                                   S01119
     C**  IF DEAL IS TAXABLE CALCULATE INT TAX ON DISCOUNTED              S01119
     C**  SETTLEMENT AMOUNT                                               S01119
     C*                                                                   S01119
     C           TAXI      IFEQ 'Y'                                       S01119
     C           SETL      ANDEQ'P'                                       S01119
     C*****      SZDSA     MULT TAXR      WRK6                    S01119  S01194
     C           SZDSA     MULT BNHKTR    WRK6                            S01194
     C           WRK6      DIV  100       INTX                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THE DISCOUNTED SETTLEMENT AMOUNT NET OF TAX           S01119
     C*                                                                   S01119
     C           SZDSA     SUB  INTX      DSANOT                          S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  ////////////////////////////                                    S01119
     C**  RS,RX DEAL TYPES                                                S01119
     C**  ////////////////////////////                                    S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C*                                                                   S01119
     C**  PROCESS OUR DETAILS IF OUR EVENT DATE DUE   AND                 S01119
     C**  IF PRINT FOR OUR DETAILS REQUESTED.                             S01119
     C*                                                                   S01119
     C           UPRT      IFEQ 'Y'                                       S01119
     C*                                                                   S01119
     C**  IF DETAILS RELATE TO A NON-ZERO BASE RATE TYPE AND THE EVENT    S01119
     C**  DATE IS GREATER THAN THE RATE CHANGE DATE CALCULATE INTEREST    S01119
     C**  RATE FOR THAT PERIOD VIA SR:SUB01U                              S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C                     TESTB'1'       UDSTI          20 ON-NEG. INT.  S01119
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UEDAT     ANDGTUNICD                                     S01119
     C*                                                                   CSW005
     C* If rate has been fixed in i/c, use it                             CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           URFIN     ANDNE*BLANKS                                   CSW005
     C                     MOVE USPIN     WSPIN                           CSW005
     C                     Z-ADDUBRTE     WBRTE                           CSW005
     C                     Z-ADDURTSP     WRTSP                           CSW005
     C                     EXSR #LEFIN                                    CSW005
     C                     ELSE                                           CSW005
     C                     EXSR SUB01U                                    S01119
     C                     ENDIF                                          CSW005
     C*                                                                   S01119
     C**  USE SR:GLINTC TO CALCULATE THE END INTEREST FROM THE INTEREST   S01119
     C**  CHANGE DATE UP TO BUT EXCLUDING THE EVENT DATE                  S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      ZIRATE                          S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBRATE      ZIRATE                          S01119
     C                     END                                            S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDUNICD     ZIBEG                           S01119
     C                     Z-ADDUEDAT     ZIEND                           S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           UIPFR     ANDNE'Z'                                       CIR005
     C           UNIPD     ANDNE0                                         CIR005
     C                     Z-ADDUIPBD     ZIEND                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C044
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     END                                            CIR002
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP1                                           S01408
      *                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01119
      /COPY WNCPYSRC,DL0279CCP2                                           S01408
      *                                                                   S01408
     C                     Z-ADDZINTR     EINTR                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  OTHERWISE ZEROISE END INTEREST                                  S01119
     C*                                                                   S01119
     C                     Z-ADD0         EINTR                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET END DATE TO THE EVENT DATE OR THE RATE CHANGE DATE IF       S01119
     C**  THIS IS BEFORE THE EVENT DATE                                   S01119
     C*                                                                   S01119
     C           UNICD     IFNE 0                                         S01119
     C           UEDAT     ANDGTUNICD                                     S01119
     C                     Z-ADDUNICD     ENDDT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDUEDAT     ENDDT                           S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           UIPFR     ANDNE'Z'                                       CIR005
     C           UNIPD     ANDNE0                                         CIR005
     C                     Z-ADDUIPBD     ENDDT                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE INTEREST DUE VIA SR: SUB02                            S01119
     C*                                                                   S01119
     C** If OUR effective interest rate is zero, use base rate            051696
     C*                                                                   051696
     C           UEINR     IFEQ *ZEROS                                    051696
     C                     EXSR SUB01U                                    051696
     C                     Z-ADDRATE      @UEINR 117                      051696
     C*                                                                   051696
     C           *IN20     IFEQ '1'                                       051696
     C                     Z-SUBRATE      @UEINR                          051696
     C                     END                                            051696
     C*                                                                   051696
     C                     END                                            051696
     C*                                                                   051696
     C                     EXSR USET                                      S01119
     C*                                                                   S01119
      * If Daily rate changes then check whether rate has changed                             CIR018
      * today and if so use the previous rate for calculating the                             CIR018
      * interest from Interest Accrual Date to Next Interest change date.                     CIR018
     C           CIR018    IFEQ 'Y'                                                           CIR018
     C           UICFR     ANDEQ'D'                                                           CIR018
     C           BAVDNR    ANDEQBJRDNB                                                        CIR018
     C                     Z-ADDBACBSR    SZINR                                               CIR018
     C           USPIN     IFEQ 'A'                                                           CIR018
     C           SZINR     ADD  URTSP     SZINR                                               CIR018
     C                     END                                                                CIR018
     C           USPIN     IFEQ 'S'                                                           CIR018
     C           SZINR     SUB  URTSP     SZINR                                               CIR018
     C                     END                                                                CIR018
     C           USPIN     IFEQ 'P'                                                           CIR018
     C           SZINR     MULT URTSP     SZINR                                               CIR018
     C           PCNT      DIV  100       PCNT                                                CIR018
     C           SZINR     ADD  PCNT      SZINR                                               CIR018
     C                     END                                                                CIR018
     C                     ENDIF                                                              CIR018
      /COPY WNCPYSRC,DL0279CP14                                           S01408
      *                                                                   S01408
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           SZINPM    ANDEQ'D'                                       CIR001
     C           CIR001    OREQ 'Y'                                       CIR001
     C           SZINPM    ANDEQ'Y'                                       CIR001
     C                     Z-ADDUNEDT     SZEDAT                          CIR001
     C                     EXSR #LINUF                                    CIR001
     C                     ELSE                                           CIR001
     C                     EXSR SUB02                                     S01119
     C                     END                                            CIR001
     C*                                                                   S01119
     C**  ADD THE END INTEREST TO THE INTEREST DUE                        S01119
     C*                                                                   S01119
     C           INTD      ADD  EINTR     EINTR                           S01119
     C                     Z-ADDEINTR     UINTR     H                     S01119
     C*                                                                   S01119
     C**  IF THE DEAL IS TAX PAYABLE CALCULATE THE TAX ON THE INTEREST    S01119
     C**  DUE                                                             S01119
     C*                                                                   S01119
     C           TAXI      IFEQ 'Y'                                       S01119
     C*****      EINTR     MULT TAXR      ZTAXC     H             S01119  S01194
     C           EINTR     MULT BNHKTR    ZTAXC     H                     S01194
     C           ZTAXC     DIV  100       TAXC                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THE INTEREST NET OF TAX(OUR INTEREST AMOUNT)          S01119
     C*                                                                   S01119
     C           EINTR     SUB  TAXC      UINOT     H                     S01119
     C/COPY WNCPYSRC,DL0279C032
      ** If our side of the deal is OIS call DL1646 to find the interest                      CIR007
      ** amount net of tax.                                                                   CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
     C           UICFR     ANDEQ'O'                                                           CIR007
     C                     CALL 'DL1646'                                                      CIR007
     C                     PARM           DLNO                                                CIR007
     C                     PARM 'O'       PSIDE   1                                           CIR007
     C                     PARM *ZERO     PAMNT  130                                          CIR007
     C                     PARM           PRTRN   1                                           CIR007
     C                     Z-ADDPAMNT     UINOT                                               CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR014
      ** Process this code if switchable feature CIR014 is on                                 CIR014
      *                                                                                       CIR014
     C           CIR014    IFEQ 'Y'                                                           CIR014
     C           DTYP      ANDEQ'RX'                                                          CIR014
     C                     MOVE DLNO      WDLNO   6                                           CIR014
     C           WDLNO     CHAINDLDEALL5             90                                       CIR014
     C           *IN90     IFEQ *OFF                                                          CIR014
     C           F1PRVI    ANDEQ'O'                                                           CIR014
     C                     ADD  F1PCHA    UINOT                                               CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
     C*                                                                   S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C013
     C*                                                                   S01119
     C*                                                                   S01119
     C**  PROCESS THEIR DETAILS IF THEIR EVENT DATE DUE AND               S01119
     C**  IF PRINT FOR THEIR DETAILS REQUESTED.                           S01119
     C*                                                                   S01119
     C           TPRT      IFEQ 'Y'                                       S01119
     C                     Z-ADD0         EINTR                           S01119
     C*                                                                   S01119
     C**  IF DETAILS RELATE TO A NON-ZERO BASE RATE TYPE AND THE EVENT    S01119
     C**  DATE IS GREATER THAN THE RATE CHANGE DATE CALCULATE INTEREST    S01119
     C**  RATE FOR THAT PERIOD VIA SR:SUB01T                              S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C                     TESTB'1'       TDSTI          20 ON-NEG. INT.  S01119
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TEDAT     ANDGTTNICD                                     S01119
     C*                                                                   CSW005
     C* If rate has been fixed in i/c, use it                             CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           TRFIN     ANDNE*BLANKS                                   CSW005
     C                     MOVE TSPIN     WSPIN                           CSW005
     C                     Z-ADDTBRTE     WBRTE                           CSW005
     C                     Z-ADDTRTSP     WRTSP                           CSW005
     C                     EXSR #LEFIN                                    CSW005
     C                     ELSE                                           CSW005
     C                     EXSR SUB01T                                    S01119
     C                     ENDIF                                          CSW005
     C*                                                                   S01119
     C**  USE SR:GLINTC TO CALCULATE THE END INTEREST FROM THE INTEREST   S01119
     C**  CHANGE DATE UP TO BUT EXCLUDING THE EVENT DATE                  S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      ZIRATE                          S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBRATE      ZIRATE                          S01119
     C                     END                                            S01119
     C                     Z-ADDTICBS     ZICALC                          S01119
     C                     Z-ADDTNICD     ZIBEG                           S01119
     C                     Z-ADDTEDAT     ZIEND                           S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           TIPFR     ANDNE'Z'                                       CIR005
     C           TNIPD     ANDNE0                                         CIR005
      *                                                                   CIR005
     C           DTYP      IFEQ 'RX'                                      CIR005
     C           L2AMCN    ANDEQ'A'                                       CIR005
     C           DTYP      OREQ 'RS'                                      CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           CIR017    ANDNE'Y'                                                           CIR017
      *                                                                                       CIR017
     C           DTYP      OREQ 'RS'                                                          CIR017
     C           CIR017    ANDEQ'Y'                                                           CIR017
     C           L2AMCN    ANDEQ'A '                                                          CIR017
     C                     Z-ADDTIPBD     ZIEND                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     Z-ADDTPAMT     ZIAMT                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C045
     C                     ADD  TUSI      ZIAMT                           CIR002
     C                     END                                            CIR002
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP3                                           S01408
      *                                                                   S01408
     C                     EXSR GLINTC                                    S01119
     C*                                                                   S01119
      /COPY WNCPYSRC,DL0279CCP4                                           S01408
      *                                                                   S01408
     C                     Z-ADDZINTR     EINTR                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  OTHERWISE ZEROISE END INTEREST                                  S01119
     C*                                                                   S01119
     C                     Z-ADD0         EINTR                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET END DATE TO THE EVENT DATE OR THE RATE CHANGE DATE IF       S01119
     C**  THIS IS BEFORE THE EVENT DATE                                   S01119
     C*                                                                   S01119
     C           TNICD     IFNE 0                                         S01119
     C           TEDAT     ANDGTTNICD                                     S01119
     C                     Z-ADDTNICD     ENDDT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTEDAT     ENDDT                           S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           TIPFR     ANDNE'Z'                                       CIR005
     C           TNIPD     ANDNE0                                         CIR005
      *                                                                   CIR005
     C           DTYP      IFEQ 'RX'                                      CIR005
     C           L2AMCN    ANDEQ'A'                                       CIR005
     C           DTYP      OREQ 'RS'                                      CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           CIR017    ANDNE'Y'                                                           CIR017
      *                                                                                       CIR017
     C           DTYP      OREQ 'RS'                                                          CIR017
     C           CIR017    ANDEQ'Y'                                                           CIR017
     C           L2AMCN    ANDEQ'A '                                                          CIR017
     C                     Z-ADDTIPBD     ENDDT                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE INTEREST DUE VIA SR: SUB02                            S01119
     C*                                                                   S01119
     C** If their effective interest rate is zero, use base rate          051696
     C*                                                                   051696
     C           TEINR     IFEQ *ZEROS                                    051696
     C                     EXSR SUB01T                                    051696
     C                     Z-ADDRATE      @TEINR 117                      051696
     C*                                                                   051696
     C           *IN20     IFEQ '1'                                       051696
     C                     Z-SUBRATE      @TEINR                          051696
     C                     END                                            051696
     C*                                                                   051696
     C                     END                                            051696
     C*                                                                   051696
     C                     EXSR TSET                                      S01119
      * If Daily rate changes then check whether rate has changed                             CIR018
      * today and if so use the previous rate for calculating the                             CIR018
      * interest from Interest Accrual Date to Next Interest change date.                     CIR018
     C           CIR018    IFEQ 'Y'                                                           CIR018
     C           TICFR     ANDEQ'D'                                                           CIR018
     C           BAVDNR    ANDEQBJRDNB                                                        CIR018
     C                     Z-ADDBACBSR    SZINR                                               CIR018
     C           TSPIN     IFEQ 'A'                                                           CIR018
     C           SZINR     ADD  TRTSP     SZINR                                               CIR018
     C                     END                                                                CIR018
     C           TSPIN     IFEQ 'S'                                                           CIR018
     C           SZINR     SUB  TRTSP     SZINR                                               CIR018
     C                     END                                                                CIR018
     C           TSPIN     IFEQ 'P'                                                           CIR018
     C           SZINR     MULT TRTSP     SZINR                                               CIR018
     C           PCNT      DIV  100       PCNT                                                CIR018
     C           SZINR     ADD  PCNT      SZINR                                               CIR018
     C                     END                                                                CIR018
     C                     ENDIF                                                              CIR018
      /COPY WNCPYSRC,DL0279CP15                                           S01408
      *                                                                   S01408
     C*                                                                   S01119
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           SZINPM    ANDEQ'D'                                       CIR001
     C           CIR001    OREQ 'Y'                                       CIR001
     C           SZINPM    ANDEQ'Y'                                       CIR001
     C                     Z-ADDTNEDT     SZEDAT                          CIR001
     C                     EXSR #LINUF                                    CIR001
     C                     ELSE                                           CIR001
     C                     EXSR SUB02                                     S01119
     C                     END                                            CIR001
     C*                                                                   S01119
     C**  ADD THE END INTEREST TO THE INTEREST DUE                        S01119
     C*                                                                   S01119
     C           INTD      ADD  EINTR     EINTR                           S01119
     C                     Z-ADDEINTR     TINTR     H                     S01119
     C*                                                                   S01119
     C**  INTEREST IS RECEIVABLE THEREFORE NO TAX                         S01119
     C*                                                                   S01119
     C                     Z-ADDEINTR     TINOT     H                     S01119
     C/COPY WNCPYSRC,DL0279C033
      ** If their side of the deal is OIS call DL1646 to find the                             CIR007
      ** interest amount net of tax.                                                          CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
     C           TICFR     ANDEQ'O'                                                           CIR007
     C                     CALL 'DL1646'                                                      CIR007
     C                     PARM           DLNO                                                CIR007
     C                     PARM 'T'       PSIDE                                               CIR007
     C                     PARM *ZERO     PAMNT                                               CIR007
     C                     PARM           PRTRN                                               CIR007
     C                     Z-ADDPAMNT     TINOT                                               CIR007
     C                     ENDIF                                                              CIR007
      *                                                                                       CIR014
      ** Process this code if switchable feature CIR014 is on                                 CIR014
      *                                                                                       CIR014
     C           CIR014    IFEQ 'Y'                                                           CIR014
     C           DTYP      ANDEQ'RX'                                                          CIR014
     C                     MOVE DLNO      WDLNO                                               CIR014
     C           WDLNO     CHAINDLDEALL5             90                                       CIR014
     C           *IN90     IFEQ *OFF                                                          CIR014
     C           F1PRVI    ANDEQ'T'                                                           CIR014
     C                     ADD  F1PCHA    TINOT                                               CIR014
     C                     ENDIF                                                              CIR014
     C                     ENDIF                                                              CIR014
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C014
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C**  FOR RS DEALS DETERMINE IF MATCHED, IF SO, CALCULATE THE NET     S01119
     C**  AMOUNT (PAYMENT AMOUNT)                                         S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C*                                                                   S01119
     C**  OUR NET INT GT. THEIR NET INT - PAY SETTLEMENT                  S01119
     C*                                                                   S01119
     C********** CSW005    IFNE 'Y'                                                   CSW005 BUG7094
     C           UINOT     IFGE TINOT                                     S01119
     C                     MOVE 'P'       SETL                            S01119
     C           UINOT     SUB  TINOT     NETAMT                          S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  THEIR NET INT GT. OUR NET INT - RECEIVE SETTLEMENT              S01119
     C*                                                                   S01119
     C                     MOVE 'R'       SETL                            S01119
     C           TINOT     SUB  UINOT     NETAMT                          S01119
     C                     END                                            S01119
     C**********           ENDIF                                                      CSW005 BUG7094
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C*  UNMATCHED 'RS' OR ANY 'RX'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                          RS          S01119
     C           UEDAT     ANDNETEDAT                          NOT MATCH. S01119
     C           DTYP      OREQ 'RX'                          RX          S01119
     C*                                                                   S01119
     C           UINOT     IFNE 0                                         S01119
     C                     MOVE 'P'       SETL                            S01119
     C                     END                                            S01119
     C           TINOT     IFNE 0                                         S01119
     C                     MOVE 'R'       SETL                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           UINOT     IFNE 0                                         S01119
     C           TINOT     ANDNE0                                         S01119
     C                     MOVE 'B'       SETL                 BOTH       S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  //////////////////////                                          S01119
     C****RL*DEAL*TYPE*                                            S01119 S01157
     C**  RR/RP/RF DEAL TYPES                                             S01157
     C**  //////////////////////                                          S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'1'       UDSTI          20 ON-NEG.INTR   S01119
     C                     TESTB'3'       UDSTI          14 ON-AVG RATE   S01119
     C                     TESTB'1'       UDNSI          15 AVG AMD TODAY S01119
     C                     ELSE                                           S01119
     C                     TESTB'1'       TDSTI          20               S01119
     C                     TESTB'3'       TDSTI          14               S01119
     C                     TESTB'1'       TDNSI          15               S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  //////////////////////                                          S01119
     C****RL*AVERAGE*BASIS*                                        S01119 S01157
     C**  RR/RP/RF AVERAGE BASIS                                          S01157
     C**  //////////////////////                                          S01119
     C*                                                                   S01119
     C**  IF THE AMEND ACTUAL AVERAGE CALC RATE IND IS ON THE ACTUAL      S01119
     C**  AVERAGE CALC RATE = EFFECTIVE INT RATE                          S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C*                                                                   S01119
     C           *IN15     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C**  IF THE AMEND ACTUAL AVERAGE CALC RATE IND IS OFF,OBTAIN         S01119
     C**  BASE RATE AND EXECUTE SR:RL1                                    S01119
     C*                                                                   S01119
     C*****                MOVEL'21'      KEY1                    S01119  S01194
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*********************MOVE UBRTT     KEY2                     S01119 LN0699
     C**********************OVELUCUCY     KEY2                     S01119 LN0699
     C                     MOVE UBRTT     @WBSRT  2                       LN0699
     C                     MOVE UCUCY     @WCCY   3                       LN0699
     C                     ELSE                                           S01119
     C*********************MOVE TBRTT     KEY2                     S01119 LN0699
     C*********************MOVELTCUCY     KEY2                     S01119 LN0699
     C                     MOVE TBRTT     @WBSRT                          LN0699
     C                     MOVE TCUCY     @WCCY                           LN0699
     C                     END                                            S01119
     C*                                                                   S01119
     C*****                MOVE KEY2      KEY1                    S01119  S01194
     C*****      KEY1      CHAINTABLE2               13           *****   S01119
     C*                                                                   S01119
     C*****      KEY1      CHAINTABLE                13           S01119  S01194
     C* CALL ACCESS PROG.FOR BASE RATE DETAILS.                           S01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C*********************PARM KEY2      @BKEY   5                S01194 LN0699
     C                     PARM @WCCY     @BCCY   3                       LN0699
     C                     PARM @WBSRT    @BBSRT  2                       LN0699
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C                     EXSR RL1                                       S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  EXECUTE SR:RL2 FOR ACTUAL AVERAGE RATE TO PAYMENT DATE          S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUEDAT     PAYD                            S01119
     C                     Z-ADDUEINR     EINR                            S01119
     C                     Z-ADDUINFD     INFD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTEDAT     PAYD                            S01119
     C                     Z-ADDTEINR     EINR                            S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     EXSR RL2                                       S01119
     C*                                                                   S01119
     C**  CALCULATE THE AMOUNTS OF INTEREST PAYABLE VIA SR:RL3            S01119
     C*                                                                   S01119
     C                     Z-ADDPAYD      SZEDAT                          S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
      *                                                                   CIR005
     C********** UBRTT     IFNE 0                                                      CIR005 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CIR005
     C           UNIPD     IFNE 0                                         CIR005
     C                     Z-ADDUIPBD     SZEDAT                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
      *                                                                   CIR005
     C           TNIPD     IFNE 0                                         CIR005
     C                     Z-ADDTIPBD     SZEDAT                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C                     EXSR RL3                                       S01119
     C*                                                                   S01119
     C**  IF THE DEAL IS TAXABLE CALCULATE TAX ON STORED INTEREST         S01119
     C**  AMOUNT                                                          S01119
     C*                                                                   S01119
     C           TAXI      IFEQ 'Y'                                       S01119
     C*****      CALINT    MULT TAXR      WRK6                    S01119  S01194
     C           CALINT    MULT BNHKTR    WRK6                            S01194
     C           WRK6      DIV  100       CINTX                           S01119
     C                     Z-ADD0         SINTX                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT TAX CALCULATED FROM THE STORED AND CALCULATED          S01119
     C*   INTEREST AMOUNTS                                                S01119
     C*                                                                   S01119
     C           STINT     SUB  SINTX     SINOT                           S01119
     C           CALINT    SUB  CINTX     CINOT                           S01119
     C*                                                                   S01119
     C**  IF STORED INTEREST NET OF TAX IS GREATER THAN CALC INT          S01119
     C**  NET OF TAX THEN RECEIVE INSTRUCTIONS                            S01119
     C*                                                                   S01119
     C           SINOT     IFGE CINOT                                     S01119
     C                     MOVE 'R'       SETL                            S01119
     C*                                                                   S01119
     C**  NET AMOUNT = STORED NET AMOUNT - CALC NET AMOUNT                S01119
     C*                                                                   S01119
     C           SINOT     SUB  CINOT     NETAMT                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF CALC INTEREST NET OF TAX IS GREATER THAN STORED INTEREST     S01119
     C**  NET OF TAX THEN PAY INSTRUCTIONS                                S01119
     C*                                                                   S01119
     C           CINOT     IFGT SINOT                                     S01119
     C                     MOVE 'P'       SETL                            S01119
     C*                                                                   S01119
     C**  NET AMOUNT = CALC NET AMOUNT - STORED NET AMOUNT                S01119
     C*                                                                   S01119
     C           CINOT     SUB  SINOT     NETAMT                          S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*   ///////////////////////////////////                             S01119
     C****IF*DEAL*TYPE*RL*(NON-AVERAGE*BASIS)*                     S01119 S01157
     C**  IF DEAL TYPE RR/RP/RF (NON-AVERAGE BASIS)                       S01157
     C*   ///////////////////////////////////                             S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'0'                                       S01157
      *                                                                                       246437
      ** Check if the initial rate has been fixed.                                            246437
      *                                                                                       246437
     C           DTYP      IFEQ 'RF'                                                          246437
     C           BYSL      ANDEQ'B'                                                           246437
     C           DTYP      OREQ 'RP'                                                          246437
     C           BYSL      ANDEQ'S'                                                           246437
     C           DTYP      OREQ 'RR'                                                          246437
     C           BYSL      ANDEQ'S'                                                           246437
     C                     TESTB'0'       UDNSI      88                                       246437
     C                     ELSE                                                               246437
     C                     TESTB'0'       TDNSI      88                                       246437
     C                     ENDIF                                                              246437
      *                                                                                       246437
     C*                                                                   S01119
     C**  IF THE PAYMENT DATE IS GREATER THAN THE RATE CHANGE DATE        S01119
     C**  THEN INTEREST MUST BE CALCULATED VIA SR:SUB02                   S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUNIPD     PAYD                            S01119
     C                     Z-ADDUNICD     NICD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTNIPD     PAYD                            S01119
     C                     Z-ADDTNICD     NICD                            S01119
     C                     END                                            S01119
      *                                                                                       246437
      ** If the initial rate has not yet been set, user the Value Date                        246437
      ** as the initial rate change date.                                                     246437
      *                                                                                       246437
     C           NICD      IFEQ 0                                                             246437
     C           *IN88     ANDEQ'1'                                                           246437
     C                     Z-ADDVDAT      NICD                                                246437
     C                     ENDIF                                                              246437
     C*                                                                   S01119
     C                     Z-ADDPAYD      ENDDT                           S01119
     C*                                                                   E24507
     C**  If no next interest pay date but rate change date , use         E24507
     C**  the rate change date as end date for interest calculations .    E24507
     C*                                                                   E24507
     C           UNIPD     IFEQ 0                                         E24507
     C           UNICD     ANDEQUEDAT                                     E24507
     C                     Z-ADDUNICD     PAYD                            E24507
     C                     Z-ADDUNICD     ENDDT                           E24507
     C                     END                                            E24507
     C*                                                                   E24507
     C           TNIPD     IFEQ 0                                         E24507
     C           TNICD     ANDEQTEDAT                                     E24507
     C                     Z-ADDTNICD     PAYD                            E24507
     C                     Z-ADDTNICD     ENDDT                           E24507
     C                     END                                            E24507
     C*                                                                   E24507
     C           PAYD      IFEQ 0                                         E24507
     C           MDAT      ANDEQUEDAT                                     E24507
     C                     Z-ADDMDAT      PAYD                            E24507
     C                     Z-ADDMDAT      ENDDT                           E24507
     C                     END                                            E24507
     C*                                                                   E24507
     C           PAYD      IFEQ 0                                         E24507
     C           MDAT      ANDEQTEDAT                                     E24507
     C                     Z-ADDMDAT      PAYD                            E24507
     C                     Z-ADDMDAT      ENDDT                           E24507
     C                     END                                            E24507
     C*                                                                   S01119
     C           NICD      IFNE 0                                         S01119
     C           PAYD      ANDGTNICD                                      S01119
     C           *IN88     OREQ '1'                                                           246437
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C026
     C********** UBRTT     CASNE0         SUB01U                                       S01119 CSD103
     C********** TBRTT     CASNE0         SUB01T                                       S01119 CSD103
     C           UBRTT     CASNE*BLANKS   SUB01U                                              CSD103
     C           TBRTT     CASNE*BLANKS   SUB01T                                              CSD103
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C027
     C*                                                                   S01119
     C**  PROVIDERS RATE RELATES TO DETAILS OF NON ZERO BASE RATE TYPE    S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      PRAT                            S01119
     C*                                                                   S01119
     C**  REVERSE THE RATE IF NEGATIVE INTEREST                           S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBRATE      PRAT                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT CEILING RATE FROM PROVIDERS RATE = REIMBURSEMENT       S01119
     C*                                                                   S01119
     C           PRAT      SUB  CLRAT     RERAT                           S01119
     C*                                                                   S01119
     C**  IF REIMBURSEMENT RATE LESS THAN 0 THEN SET TO 0                 S01119
     C*                                                                   S01119
     C           RERAT     IFLT 0                                         S01119
     C                     Z-ADD0         RERAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF A FLOOR RATE HAS BEEN ENTERED, SUBTRACT THE PROVIDERS RATE   S01119
     C**  FROM IT TO GIVE THE TOPPING UP RATE, ELSE SET TO 0              S01119
     C*                                                                   S01119
     C           *IN18     IFEQ '1'                                       S01119
     C           FLRAT     SUB  PRAT      TURAT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         TURAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF TOPPING UP RATE LESS THAN 0 THEN SET TO 0                    S01119
     C*                                                                   S01119
     C           TURAT     IFLT 0                                         S01119
     C                     Z-ADD0         TURAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF EITHER RATES OBTAINED ARE GREATER THAN ZERO CALCULATE THE    S01119
     C**  AMOUNT OF INTEREST = END INTEREST                               S01119
     C*                                                                   S01119
     C           RERAT     IFGT 0                                         S01119
     C           TURAT     ORGT 0                                         S01119
     C*                                                                   S01119
     C                     Z-ADDRERAT     ZIRATE                          S01119
     C           TURAT     IFGT 0                                         S01119
     C                     Z-SUBTURAT     ZIRATE                          S01119
     C                     END                                            S01119
     C                     Z-ADDUICBS     ZICALC                          S01119
     C                     Z-ADDNICD      ZIBEG                           S01119
     C                     Z-ADDPAYD      ZIEND                           S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           PAYD      ANDNEMDAT                                      CIR005
      *                                                                   CIR005
     C********** UBRTT     IFNE 0                                                      CIR005 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UNIPD     IFNE 0                                         CIR005
     C                     Z-ADDUIPBD     ZIEND                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
     C           TNIPD     IFNE 0                                         CIR005
     C                     Z-ADDTIPBD     ZIEND                           CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
     C                     Z-ADDUPAMT     ZIAMT                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C046
     C                     ADD  OUSI      ZIAMT                           CIR002
     C                     END                                            CIR002
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP5                                           S01408
      *                                                                   S01408
     C                     EXSR GLINTC                                    S01119
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP6                                           S01408
      *                                                                   S01408
     C                     Z-ADDZINTR     EINT      H                     S01119
     C*                                                                   S01119
     C**  RESET END DATE FOR FURTHER INTR. CALCS.                         S01119
     C*                                                                   S01119
     C                     Z-ADDNICD      ENDDT                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  OTHERWISE ZEROISE END INTEREST                                  S01119
     C*                                                                   S01119
     C                     Z-ADD0         EINT                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THE AMOUNT OF INTEREST PAYABLE                        S01119
     C*                                                                   S01119
     C                     Z-ADDENDDT     SZEDAT                          S01119
      *                                                                   CIR005
      ** Use interest payment base date as end date for transactions      CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
     C           ENDDT     ANDNEMDAT                                      CIR005
      *                                                                   CIR005
     C********** UBRTT     IFNE 0                                                      CIR005 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           UNIPD     IFNE 0                                         CIR005
     C                     Z-ADDUIPBD     SZEDAT                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
     C           TNIPD     IFNE 0                                         CIR005
     C                     Z-ADDTIPBD     SZEDAT                          CIR005
     C                     ENDIF                                          CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
      *                                                                                       246437
      ** Only execute this routine if rate for the first period had                           246437
      ** already been fixed.                                                                  246437
      *                                                                                       246437
     C           *IN88     IFEQ '0'                                                           246437
     C                     EXSR RL3                                       S01119
     C                     ENDIF                                                              246437
     C*                                                                   S01119
     C**  IF THE END INTEREST WAS CALC FOR THEIR DETAILS ADD TO STORED    S01119
     C**  AMOUNT OF INTEREST, IF OUR DETAILS THEN ADD TO CALCULATED       S01119
     C**  AMOUNT OF INTEREST                                              S01119
     C*                                                                   S01119
     C**  i) OUR DETAILS IF REIMBURSEMENT AMOUNT USED AND OUR DETAILS     S01119
     C**     HAVE NON-ZERO BASE RATE TYPE (OR TOPPING UP RATE & THEIR     S01119
     C**     DETAILS)                                                     S01119
     C**  ii)THEIR DETAILS IF REIMBURSEMENT RATE WAS USED AND THEIR       S01119
     C**     DETAILS HAVE NON-ZERO BASE RATE TYPE (OR TOPPING UP          S01119
     C**     RATE & OUR DETAILS)                                          S01119
     C**  IF NEGATIVE INTEREST INDICATOR IS 'ON' THEN OUR DETAILS IN      S01119
     C**  i) SHOULD BE THEIRS, AND THEIR DETAILS IN ii) SHOULD BE OURS    S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           RERAT     IFGT 0                                         S01119
     C********** UBRTT     ANDNE0                                                      S01119 CSD103
     C           UBRTT     ANDNE*BLANKS                                                       CSD103
     C           TURAT     ORGT 0                                         S01119
     C********** TBRTT     ANDNE0                                                      S01119 CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           EINT      ADD  CALINT    CALINT                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           RERAT     IFGT 0                                         S01119
     C********** TBRTT     ANDNE0                                                      S01119 CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           TURAT     ORGT 0                                         S01119
     C********** UBRTT     ANDNE0                                                      S01119 CSD103
     C           UBRTT     ANDNE*BLANKS                                                       CSD103
     C           EINT      ADD  STINT     STINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           RERAT     IFGT 0                                         S01119
     C********** UBRTT     ANDNE0                                                      S01119 CSD103
     C           UBRTT     ANDNE*BLANKS                                                       CSD103
     C           TURAT     ORGT 0                                         S01119
     C********** TBRTT     ANDNE0                                                      S01119 CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           EINT      ADD  STINT     STINT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           RERAT     IFGT 0                                         S01119
     C********** TBRTT     ANDNE0                                                      S01119 CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C           TURAT     ORGT 0                                         S01119
     C********** UBRTT     ANDNE0                                                      S01119 CSD103
     C           UBRTT     ANDNE*BLANKS                                                       CSD103
     C           EINT      ADD  CALINT    CALINT                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF DEAL IS TAXABLE CALCULATE TAX AMOUNTS ON STORED AND          S01119
     C**  CALCULATED INTEREST AMOUNTS                                     S01119
     C*                                                                   S01119
     C           TAXI      IFEQ 'Y'                                       S01119
     C*****      CALINT    MULT TAXR      WORK                    S01119  S01194
     C           CALINT    MULT BNHKTR    WORK                            S01194
     C           WORK      DIV  100       CINTX                           S01119
     C                     Z-ADD0         SINTX                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT TAX AMOUNTS FROM INTEREST AMOUNTS                      S01119
     C*                                                                   S01119
     C           STINT     SUB  SINTX     SINOT                           S01119
     C           CALINT    SUB  CINTX     CINOT                           S01119
     C*                                                                   S01119
     C**  IF STORED INT NET OF TAX GREATER THAN CALCULATED THEN RECEIVE   S01119
     C**  INSTRUCTIONS USED. STORE AMT - CALC AMT = NET AMT               S01119
     C*                                                                   S01119
     C           SINOT     IFGE CINOT                                     S01119
     C                     MOVE 'R'       SETL                            S01119
     C           SINOT     SUB  CINOT     NETAMT                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF CALCULATED INT NET OF TAX GREATER THAN STORED THEN PAY       S01119
     C**  INSTRUCTIONS USED. CALC AMT - STORE AMT = NET AMT               S01119
     C*                                                                   S01119
     C           CINOT     IFGT SINOT                                     S01119
     C                     MOVE 'P'       SETL                            S01119
     C           CINOT     SUB  SINOT     NETAMT                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* /////////////////////////////////////                             S01119
     C**  SET UP PAY/RECEIVE AND CONFIRMATIONS                            S01119
     C*                                                                   S01119
     C**  IF SETL = 'B' EXECUTE 'AB', 'BC' FOR  - SETL=P,  SETL=R         S01119
     C*    ie. run twice through the routines.                            S01119
     C*                                                                   S01119
     C                     MOVE SETL      SESETL  1                       S01119
     C                     Z-ADD1         X                               S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'B'                                       S01119
     C                     ADD  1         X                               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           X         DOUEQ0                             <<<<<<<<<   S01119
     C*                                                                   S01119
     C* /////////////////////////////////////                             S01119
     C**  SET UP PAY/RECEIVE INSTRUCTIONS                                 S01119
     C*                                                                   S01119
     C                     MOVE ' '       CNRQ                            S01119
     C*                                                                   S01119
     C                     EXSR AB                         EXSR **AB**    S01119
     C*                                                                   S01119
     C                     Z-ADD0         PRI1                            S01119
     C                     Z-ADD0         PRI2                            S01119
     C                     Z-ADD0         PRI3                            S01119
     C*                                                                   S01119
     C* /////////////////////////////////////                             S01119
     C**  SET UP INTEREST PAYMENT CONFIRMATIONS                           S01119
     C*                                                                   S01119
     C           PRTCF     CASEQ'Y'       BC               EXSR **BC**    S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C                     SUB  1         X                               S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'B'                                       S01119
     C                     MOVE 'R'       SETL                            S01119
     C                     MOVE 'R'       SESETL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                             >>ENDDO>>>>    S01119
     C*                                                                   S01119
     C                     END                             (PRINT=Y)      S01119
     C/SPACE 3                                                            S01119
     C* /////////////////////////////////////                             S01119
     C**  SET UP INTEREST FIX CONFIRMATIONS                               S01119
     C*                                                                   S01119
     C           *IN14     IFEQ '0'                                       S01119
     C           *IN36     ANDEQ'0'                                       S01119
     C                     EXSR BD                                        S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C* /////////////////////////////////////                             S01119
     C**  SET UP BASE RATE CONFIRMATIONS                                  S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01119
     C           *IN36     ANDEQ'0'                                       S01119
     C*****      VDAT      ANDLERUND                              S01119  S01194
     C           VDAT      ANDLEBJRDNB                                    S01194
     C*****      MDAT      ANDGTRUND                              S01119  S01194
     C           MDAT      ANDGTBJRDNB                                    S01194
     C*                                                                   S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C           *IN36     ANDEQ'0'                                       S01157
     C*****      VDAT      ANDLERUND                              S01157  S01194
     C           VDAT      ANDLEBJRDNB                                    S01194
     C*****      MDAT      ANDGTRUND                              S01157  S01194
     C           MDAT      ANDGTBJRDNB                                    S01157
     C*                                                                   S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           *IN14     ANDEQ'1'                                       S01157
     C           *IN36     ANDEQ'0'                                       S01157
     C*****      VDAT      ANDLERUND                              S01157  S01194
     C           VDAT      ANDLEBJRDNB                                    S01194
     C*****      MDAT      ANDGTRUND                              S01157  S01194
     C           MDAT      ANDGTBJRDNB                                    S01194
     C                     EXSR BE                                        S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           CIR003    IFEQ 'Y'                                       CIR003
     C           DTYP      ANDEQ'RX'                                      CIR003
     C                     EXSR SREXCH                                    CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           UPVD      IFNE 0                                                             237893
     C           UPFE      ANDNE0                                                             237893
     C           DTYP      ANDNE'FR'                                                          237893
     C           UPVD      ANDGEBJRDNB                                                        248668
     C                     EXSR SRUPFE                                                        237893
     C                     ENDIF                                                              237893
      *                                                                                       237893
     C           BOVD      IFNE 0                                                             233128
     C           BOAM      ANDNE0                                                             233128
     C           BOVD      ANDGEBJRDNB                                                        248668
     C********** DTYP      IFEQ 'RX'                                                   233128 237893
     C********** DTYP      OREQ 'RS'                                                   233128 237893
     C           DTYP      IFNE 'FR'                                                          237893
     C                     EXSR SRBUY                                                         233128
     C                     ENDIF                                                              233128
     C                     ENDIF                                                              233128
      *                                                                                       233128
     C/COPY WNCPYSRC,DL0279C008
     C**   SET INDICATOR FOR DEALS FILE UPDATE                            S01119
     C                     MOVE '1'       *IN66                           S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
      *****************************************************************                       CIR007
      *                                                               *                       CIR007
      *  SRCONV - Converts amount to Settlement Currency              *                       CIR007
      *                                                               *                       CIR007
      *  Called by: SRMEMO, SRPRON                                    *                       CIR007
      *                                                               *                       CIR007
      *  Calls    : EU0200, *PSSR                                     *                       CIR007
      *                                                               *                       CIR007
      *****************************************************************                       CIR007
     C           SRCONV    BEGSR                                                              CIR007
      ** Call external program                                                                CIR007
     C                     CALL 'EU0200'                                                      CIR007
     C                     PARM *BLANKS   P@RTCD  7        RETURN CODE                        CIR007
     C                     PARM           P@FRAM 183       TRANS AMT                          CIR007
     C                     PARM           P@FRCY  3        TRANS CCY                          CIR007
     C                     PARM           P@TOCY  3        SETTL CCY                          CIR007
     C                     PARM           P@OUTA 150       SETTL AMT                          CIR007
     C                     PARM           P@INTA 183       INT SET AMT                        CIR007
     C                     PARM           P@EXRT 159       EXCH RATE                          CIR007
     C                     PARM           P@MDIN  1        M/D IND                            CIR007
      ** Error routine                                                                        CIR007
     C           P@RTCD    IFEQ '*ERROR*'                                                     CIR007
     C                     MOVEL'022'     DBASE                                               CIR007
     C                     MOVELP@FRCY    DBKEY                                               CIR007
     C                     MOVEL'EU0200'  DBFILE                                              CIR007
     C                     SETON                     U7U8LR                                   CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDSR                                                              CIR007
      *****************************************************************                       CIR007
      /EJECT                                                                                  CIR007
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    USET  SR: TO SETUP OUR DETAIL FIELDS FOR SUBROUTINES       *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS,RL3                                   *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           USET      BEGSR                                          S01119
     C*                                                                   S01119
     C                     Z-ADDUPAMT     SZPPL  130                      S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C047
     C                     ADD  OUSI      SZPPL                           CIR002
     C                     END                                            CIR002
     C*                                                                   051696
     C** If OUR effective interest rate is zero, use base rate            051696
     C*                                                                   051696
     C           UEINR     IFEQ *ZEROS                                    051696
     C                     Z-ADD@UEINR    SZINR                           051696
     C                     ELSE                                           051696
     C                     Z-ADDUEINR     SZINR  117                      S01119
     C                     END                                            051696
     C*                                                                   051696
     C                     Z-ADDUICBS     SZCBS   10                      S01119
     C                     Z-ADDUIALC     SZLICD 130                      S01119
     C           UBACK     IFEQ 'Y'                                       110874
     C                     Z-ADDUEDAT     SZAICD                          110874
     C                     Z-ADD*ZEROS    SZIACD                          110874
     C                     ELSE                                           110874
     C                     Z-ADDUAITC     SZIACD 130                      S01119
     C                     Z-ADDUIACD     SZAICD  50                      110874
     C                     ENDIF                                          110874
     C                     Z-ADDUAIAN     SZIANP 130                      S01119
     C                     Z-ADDUAIAP     SZAIAP 130                      S01119
     C                     Z-ADDUAIPD     SZIPTD 130                      S01119
     C                     Z-ADDUIPRD     SZIPRD 130                      S01119
     C***********          Z-ADDUIACD     SZAICD  50                      110874
     C                     TESTB'3'       UDSTI          81               S01119
     C           *IN81     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       SZAVRM  1                       S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       SZAVRM                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDENDDT     SZEDAT  50                      S01119
     C                     Z-ADDSDCAR     SZSDCR  50                      S01119
      *                                                                   CIR002
     C           CIR001    IFEQ 'Y'                                       174563
     C                     MOVELUINPM     SZINPM                          174563
     C                     ENDIF                                          174563
      *                                                                   174563
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0279C048
     C                     MOVEL'P'       SZDIR   1                       CIR002
     C                     MOVELUIPFR     SZIPFC  1                       CIR002
     C                     MOVELUINPM     SZINPM  1                       CIR002
     C                     END                                            CIR002
     C*                                                                   S01119
      /COPY WNCPYSRC,DL0279CP11                                           S01408
      *                                                                   S01408
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    TSET  SR: TO SETUP THEIR FIELDS FOR SUB-ROUTINES           *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS,RL3                                   *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           TSET      BEGSR                                          S01119
     C*                                                                   S01119
     C                     Z-ADDTPAMT     SZPPL                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C049
     C                     ADD  TUSI      SZPPL                           CIR002
     C                     END                                            CIR002
     C*                                                                   051696
     C** If THEIR effective interest rate is zero, use base rate          051696
     C*                                                                   051696
     C           TEINR     IFEQ *ZEROS                                    051696
     C                     Z-ADD@TEINR    SZINR                           051696
     C                     ELSE                                           051696
     C                     Z-ADDTEINR     SZINR                           S01119
     C                     END                                            051696
     C*                                                                   051696
     C                     Z-ADDTICBS     SZCBS                           S01119
     C                     Z-ADDTIALC     SZLICD                          S01119
     C                     Z-ADDTAITC     SZIACD                          S01119
     C                     Z-ADDTAIAN     SZIANP                          S01119
     C                     Z-ADDTAIAP     SZAIAP                          S01119
     C                     Z-ADDTAIPD     SZIPTD                          S01119
     C                     Z-ADDTIPRD     SZIPRD                          S01119
     C           TBACK     IFEQ 'Y'                                       110874
     C                     Z-ADDTEDAT     SZAICD                          110874
     C                     ELSE                                           110874
     C                     Z-ADDTIACD     SZAICD                          S01119
     C                     ENDIF                                          110874
     C                     TESTB'3'       TDSTI          81               S01119
     C           *IN81     IFEQ '1'                                       S01119
     C                     MOVE 'Y'       SZAVRM                          S01119
     C                     ELSE                                           S01119
     C                     MOVE 'N'       SZAVRM                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDENDDT     SZEDAT                          S01119
     C                     Z-ADDSDCAR     SZSDCR                          S01119
      *                                                                   CIR002
     C           CIR001    IFEQ 'Y'                                       174563
     C                     MOVELUINPM     SZINPM                          174563
     C                     ENDIF                                          174563
      *                                                                   174563
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C/COPY WNCPYSRC,DL0279C050
     C                     MOVEL'R'       SZDIR                           CIR002
     C                     MOVELTIPFR     SZIPFC                          CIR002
     C                     MOVELTINPM     SZINPM                          CIR002
     C                     END                                            CIR002
     C*                                                                   S01119
      /COPY WNCPYSRC,DL0279CP12                                           S01408
      *                                                                   S01408
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*    SUB01U SR: TO PROCESS FRA/IRS DEAL TYPES                   *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*    CALLS :                                                    *   S01119
     C*****************************************************************   S01119
     C           SUB01U    BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C                     Z-ADD0         BRDAT   50                      S01119
     C                     Z-ADD0         RATE   117                      S01119
     C                     Z-ADD0         PCNT   137                      S01119
     C*****                MOVE *BLANKS   KEY1   12               S01119  S01194
     C*********************MOVE *BLANKS   KEY2    5               S01119  LN0699
     C*                                                                   S01119
     C****ACCESS BASE RATE RECORD                                 S01119  S01194
     C*****                MOVEL'21'      KEY1                    S01119  S01194
     C*********************MOVE UBRTT     KEY2                    S01119  LN0699
     C*********************MOVELUCUCY     KEY2                    S01119  LN0699
     C*****                MOVE KEY2      KEY1                    S01119  S01194
     C*****      KEY1      CHAINTABLE2               13           *****   S01119
     C*                                                                   S01194
     C*****      KEY1      CHAINTABLE                13           S01119  S01194
     C*                                                                   LN0699
     C                     MOVE UBRTT     @WBSRT                          LN0699
     C*                                                                   LN0699
     C* CALL ACCESS PROG.FOR BASE RATE DETAILS.                           S01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C*********************PARM KEY2      @BKEY   5                S01194 LN0699
     C                     PARM UCUCY     @BCCY   3                       LN0699
     C                     PARM @WBSRT    @BBSRT  2                       LN0699
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   S01119
     C**  OBTAIN CURRENT BASE RATE UNLESS NEW VALUE DATE OF RATE CHANGE   S01119
     C**  IS LESS THAN OR EQUAL TO THE FIX DATE IN WHICH CASE OBTAIN      S01119
     C**  NEW BASE RATE                                                   S01119
     C*****      VDNR      IFLE UINFD                             S01119  S01194
     C           BAVDNR    IFLE UINFD                                     S01194
     C*****                Z-ADDNBRT      RATE                    S01119  S01194
     C                     Z-ADDBANBRT    RATE                            S01194
     C*****                Z-ADDVDNR      BRDAT                   S01119  S01194
     C                     Z-ADDBAVDNR    BRDAT                           S01194
     C                     END                                            S01119
     C           RATE      IFEQ 0                                         S01119
     C*********************Z-ADDBRTE      RATE                      S01119LN0762
     C                     Z-ADDBACBSR    RATE                            LN0762
     C*****                Z-ADDVDRC      BRDAT                   S01119  S01194
     C                     Z-ADDBAVDRC    BRDAT                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      BBRTE  117                      S01119
     C                     Z-ADDRATE      UBRTE                                             AR316628
     C*                                                                   S01119
     C**  CALCULATE THE NEW EFFECTIVE INTEREST RATE                       S01119
     C           USPIN     IFEQ 'A'                                       S01119
     C           RATE      ADD  URTSP     RATE                            S01119
     C                     Z-ADDRATE      UEINR                                             AR316628
     C                     END                                            S01119
     C           USPIN     IFEQ 'S'                                       S01119
     C           RATE      SUB  URTSP     RATE                            S01119
     C                     Z-ADDRATE      UEINR                                             AR316628
     C                     END                                            S01119
     C           USPIN     IFEQ 'P'                                       S01119
     C           RATE      MULT URTSP     PCNT                            S01119
     C           PCNT      DIV  100       PCNT                            S01119
     C           RATE      ADD  PCNT      RATE                            S01119
     C                     Z-ADDRATE      UEINR                                             AR316628
     C                     END                                            S01119
     C           *IN88     IFEQ '1'                                                         AR316628
     C                     BITON'0'       UDNSI                                             AR316628
     C                     END                                                              AR316628
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*    SUB01T SR: TO PROCESS FRA/IRS DEAL TYPES                   *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*    CALLS :                                                    *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           SUB01T    BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C                     Z-ADD0         BRDAT   50                      S01119
     C                     Z-ADD0         RATE   117                      S01119
     C                     Z-ADD0         PCNT   137                      S01119
     C*****                MOVE *BLANKS   KEY1   12               S01119  S01194
     C*********************MOVE *BLANKS   KEY2    5               S01119  LN0699
     C*                                                                   S01119
     C**  ACCESS BASE RATE RECORD                                         S01119
     C*****                MOVEL'21'      KEY1                    S01119  S01194
     C*********************MOVE TBRTT     KEY2                    S01119  LN0699
     C*********************MOVELTCUCY     KEY2                    S01119  LN0699
     C*****                MOVE KEY2      KEY1                    S01119  S01194
     C*****      KEY1      CHAINTABLE2               13           *****   S01119
     C*                                                                   S01194
     C*****      KEY1      CHAINTABLE                13           S01119  S01194
     C*                                                                   LN0699
     C                     MOVE TBRTT     @WBSRT                          LN0699
     C*                                                                   LN0699
     C* CALL ACCESS PROG.FOR BASE RATE DETAILS.                           S01194
     C                     CALL 'AOBSRTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY   ' @OPTN   7                       S01194
     C*********************PARM KEY2      @BKEY   5               S01194  LN0699
     C                     PARM TCUCY     @BCCY   3                       LN0699
     C                     PARM @WBSRT    @BBSRT  2                       LN0699
     C********** SDBSRT    PARM SDBSRT    DSFDY                     S01194CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C*                                                                   S01119
     C**  OBTAIN CURRENT BASE RATE UNLESS NEW VALUE DATE OF RATE CHANGE   S01119
     C**  IS LESS THAN OR EQUAL TO THE FIX DATE IN WHICH CASE OBTAIN      S01119
     C**  NEW BASE RATE                                                   S01119
     C*****      VDNR      IFLE TINFD                             S01119  S01194
     C           BAVDNR    IFLE TINFD                                     S01194
     C*****                Z-ADDNBRT      RATE                    S01119  S01194
     C                     Z-ADDBANBRT    RATE                            S01194
     C*****                Z-ADDVDNR      BRDAT                   S01119  S01194
     C                     Z-ADDBAVDNR    BRDAT                           S01194
     C                     END                                            S01119
     C           RATE      IFEQ 0                                         S01119
     C*********************Z-ADDBRTE      RATE                      S01119LN0762
     C                     Z-ADDBACBSR    RATE                            LN0762
     C*****                Z-ADDVDRC      BRDAT                   S01119  S01194
     C                     Z-ADDBAVDRC    BRDAT                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDRATE      BBRTE  117                      S01119
     C                     Z-ADDRATE      TBRTE                                             AR316628
     C*                                                                   S01119
     C**  CALCULATE THE NEW EFFECTIVE INTEREST RATE                       S01119
     C           TSPIN     IFEQ 'A'                                       S01119
     C           RATE      ADD  TRTSP     RATE                            S01119
     C                     Z-ADDRATE      TEINR                                             AR316628
     C                     END                                            S01119
     C           TSPIN     IFEQ 'S'                                       S01119
     C           RATE      SUB  TRTSP     RATE                            S01119
     C                     Z-ADDRATE      TEINR                                             AR316628
     C                     END                                            S01119
     C           TSPIN     IFEQ 'P'                                       S01119
     C           RATE      MULT TRTSP     PCNT                            S01119
     C           PCNT      DIV  100       PCNT                            S01119
     C           RATE      ADD  PCNT      RATE                            S01119
     C                     Z-ADDRATE      TEINR                                             AR316628
     C                     END                                            S01119
     C           *IN88     IFEQ '1'                                                         AR316628
     C                     BITON'0'       TDNSI                                             AR316628
     C                     END                                                              AR316628
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*****************************************************************   S01119
     C/EJECT                                                                                 BUG7543
      ********************************************************************                   BUG7543
      *                                                                  *                   BUG7543
      * SR/INTRTE - Calculate the Interpolated Rate                      *                   BUG7543
      *                                                                  *                   BUG7543
      ********************************************************************                   BUG7543
      *                                                                                      BUG7543
     C           INTRTE    BEGSR                                                             BUG7543
      *                                                                                      BUG7543
      ** Access 1st Base Rate                                                                BUG7543
      *                                                                                      BUG7543
     C                     MOVELWS1B      @BBSRT                                             BUG7543
      *                                                                                      BUG7543
     C                     CALL 'AOBSRTR0'                                                   BUG7543
     C                     PARM '*MSG   ' @RTCD                                              BUG7543
     C                     PARM '*KEY   ' @OPTN                                              BUG7543
     C                     PARM WCCY1     @BCCY                                              BUG7543
     C                     PARM           @BBSRT                                             BUG7543
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7543
      *                                                                                      BUG7543
      ** Determine which Rate to use - Old or New                                            BUG7543
      *                                                                                      BUG7543
     C           WINFD     COMP BAVDNR                 58                                    BUG7543
     C           *IN58     IFEQ *ON                                                          BUG7543
     C                     Z-ADDBACBSR    WS1R   117                                         BUG7543
     C                     ELSE                                                              BUG7543
     C                     Z-ADDBANBRT    WS1R                                               BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
      ** Access 2nd Base Rate                                                                BUG7543
      *                                                                                      BUG7543
     C                     MOVELWS2B      @BBSRT                                             BUG7543
      *                                                                                      BUG7543
     C                     CALL 'AOBSRTR0'                                                   BUG7543
     C                     PARM '*MSG   ' @RTCD                                              BUG7543
     C                     PARM '*KEY   ' @OPTN                                              BUG7543
     C                     PARM WCCY1     @BCCY                                              BUG7543
     C                     PARM           @BBSRT                                             BUG7543
     C           SDBSRT    PARM SDBSRT    DSSDY                                              BUG7543
      *                                                                                      BUG7543
      ** Determine which Rate to use - Old or New                                            BUG7543
      *                                                                                      BUG7543
     C           WINFD     COMP BAVDNR                 58                                    BUG7543
     C           *IN58     IFEQ *ON                                                          BUG7543
     C                     Z-ADDBACBSR    WS2R   117                                         BUG7543
     C                     ELSE                                                              BUG7543
     C                     Z-ADDBANBRT    WS2R                                               BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
      ** 1st Term End Date - Value Date                                                      BUG7543
     C           WS1D      SUB  VDAT      D1VL    50                                         BUG7543
      *                                                                                      BUG7543
      ** 2nd Term End Date - Value Date                                                      BUG7543
     C           WS2D      SUB  VDAT      D2VL    50                                         BUG7543
      *                                                                                      BUG7543
      ** Multiplier difference                                                               BUG7543
     C           WMD1      SUB  WMD2      MDIF    50                                         BUG7543
      *                                                                                      BUG7543
      ** Divider difference                                                                  BUG7543
     C           D2VL      SUB  D1VL      DDIF    50                                         BUG7543
      *                                                                                      BUG7543
      ** 2nd Base Rate - 1st Base Rate                                                       BUG7543
     C           WS2R      SUB  WS1R      BRDF   117                                         BUG7543
      *                                                                                      BUG7543
      ** Interpolated Rate                                                                   BUG7543
     C           DDIF      IFNE 0                                                             236317
     C           BRDF      DIV  DDIF      WRTE1  309H                                        BUG7543
     C                     ELSE                                                               236317
     C                     Z-ADD0         WRTE1                                               236317
     C                     ENDIF                                                              236317
     C           WRTE1     MULT MDIF      WRTE2  309H                                        BUG7543
     C           WRTE2     ADD  WS1R      IRTEW  115H                                        BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDIRTEW     BBRTE                                              BUG7543
     C                     Z-ADDIRTEW     RATE                                               BUG7543
      *                                                                                      BUG7543
      ** Calculate the new Effective Interest Rate                                           BUG7543
     C           WSPIN1    IFEQ 'A'                                                          BUG7543
     C           RATE      ADD  WRTSP1    RATE                                               BUG7543
     C                     END                                                               BUG7543
     C           WSPIN1    IFEQ 'S'                                                          BUG7543
     C           RATE      SUB  WRTSP1    RATE                                               BUG7543
     C                     END                                                               BUG7543
     C           WSPIN1    IFEQ 'P'                                                          BUG7543
     C           RATE      MULT WRTSP1    PCNT                                               BUG7543
     C           PCNT      DIV  100       PCNT                                               BUG7543
     C           RATE      ADD  PCNT      RATE                                               BUG7543
     C                     END                                                               BUG7543
      *                                                                                      BUG7543
     C                     ENDSR                                                             BUG7543
     C*****************************************************************                      BUG7543
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    SUB02  SR: TO PROCESS FRA/IRS DEAL TYPES                   *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS : TTXDT                                              *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           SUB02     BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C                     Z-ADD0         SZAITD 130                      S01119
     C                     Z-ADD0         INTD   130                      S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    ZIEND                           S01119
     C                     Z-ADDSZPPL     ZIAMT                           S01119
     C                     Z-ADDSZINR     ZIRATE                          S01119
     C                     Z-ADDSZCBS     ZICALC                          S01119
     C*                                                                   S01119
     C****IF*DEAL*TYPE*=*RS,RX*OR*(RL*+*AVE.RATE*METHOD*=*N).*CALC S01119 S01157
     C**  IF DEAL TYPE = RS,RX OR (RR/RP/RF + AVE.RATE METHOD = N) CALC   S01157
     C**  INTEREST FROM  AND INCLUDING INTEREST ACCRUAL CONTROL DATE      S01119
     C**  TO BUT EXCLUDING END DATE                                       S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           SZAVRM    ANDEQ'N'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           SZAVRM    ANDEQ'N'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           SZAVRM    ANDEQ'N'                                       S01157
     C*                                                                   S01119
     C                     Z-ADDSZAICD    ZIBEG                           S01119
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP7                                           S01408
      *                                                                   S01408
     C           CIR001    IFNE 'Y'                                       CIR001
     C                     EXSR GLINTC                                    S01119
     C/COPY WNCPYSRC,DL0279C034
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** If no cash flow schedule, use GLINTC to calculate interest       CIR001
      *                                                                   CIR001
     C           SZIPFC    IFNE 'C'                                       CIR001
     C                     EXSR GLINTC                                    CIR001
     C/COPY WNCPYSRC,DL0279C035
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else, determine payment on next date from cash flow schedule.    CIR001
      *                                                                   CIR001
     C           SZDIR     IFEQ 'P'                                       CIR001
     C                     MOVEL'U'       OTIN                            CIR001
     C                     ELSE                                           CIR001
     C                     MOVEL'T'       OTIN                            CIR001
     C                     END                                            CIR001
     C                     EXSR #LCASS                                    CIR001
     C                     Z-ADDCFLA      ZINTR                           CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP8                                           S01408
      *                                                                   S01408
     C                     END                                            S01119
     C*                                                                   S01119
     C****IF*DEAL*TYPE*=RL*AND*AVERAGE*RATE*METHOD*=*Y.*CALC*INTER S01119 S01157
     C**  IF DTYP = RR/RP/RF AND AVERAGE RATE METHOD = Y. CALC INTEREST   S01157
     C**  FROM AND INCLUDING START DATE CURRENT AVERAGING PERIOD TO       S01119
     C**  BUT EXCLUDING END DATE                                          S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           SZAVRM    ANDEQ'Y'                                       S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           SZAVRM    ANDEQ'Y'                                       S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           SZAVRM    ANDEQ'Y'                                       S01157
     C                     Z-ADDSZSDCR    ZIBEG                           S01119
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CCP9                                           S01408
      *                                                                   S01408
     C                     EXSR GLINTC                                    S01119
      *                                                                   S01408
      /COPY WNCPYSRC,DL0279CP10                                           S01408
      *                                                                   S01408
     C                     END                                            S01119
     C*                                                                   S01119
     C**  ADD INTEREST ACCRUED TO CONTROL DATE,ACCRUED INTEREST ADJ.      S01119
     C**  NOT POSTED AND ACCRUED INTEREST ADJ. POSTED TO INTEREST CALC    S01119
     C**  TO GIVE ACCRUED INTEREST TO DATE                                S01119
     C*                                                                   S01119
     C           SZIACD    ADD  SZIANP    SZAITD                          S01119
     C           SZAITD    ADD  SZAIAP    SZAITD                          S01119
     C********** SZAITD    ADD  ZINTR     SZAITD    H                                S01119 MD036619
     C                     Z-ADDZINTR     #WKINT 130H                                       MD036619
     C           SZAITD    ADD  #WKINT    SZAITD                                            MD036619
     C*                                                                   S01119
     C**  SUBTRACT INTEREST PAID/RECEIVED TO DATE FROM ACCRUED INTEREST   S01119
     C**  TO DATE TO GIVE INTEREST DUE                                    S01119
     C*                                                                   S01119
     C           SZAITD    SUB  SZIPRD    INTD                            S01119
     C*                                                                   S01119
      *                                                                   CIR001
      ** If interest is to be capitalised                                 CIR001
      *                                                                   CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           SZINPM    ANDEQ'C'                                       CIR001
     C           CIR006    OREQ 'Y'                                       CIR006
     C           SZINPM    ANDEQ'A'                                       CIR006
      *                                                                   CIR001
      ** If end date is maturity, add interest paid/received              CIR001
      ** to date to interest due.                                         CIR001
      *                                                                   CIR001
     C           SZEDAT    IFEQ MDAT                                      CIR001
     C                     ADD  SZIPRD    INTD                            CIR001
     C                     ELSE                                           CIR001
      *                                                                   CIR001
      ** Else, no interest is payable.                                    CIR001
      *                                                                   CIR001
     C                     Z-ADD0         INTD                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*   SR: DLRADS - TO CALCULATE DISCOUNTED SETTLED AMOUNT FOR FRA *   S01119
     C*                                                               *   S01119
     C*   CALLED FROM :- FRAIRS                                       *   S01119
     C*   CALLS       :- ZDATE1,ZDATE2                                *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           DLRADS    BEGSR                           ** DLRADS **   S01119
     C*                                                                   S01119
     C                     Z-ADDSZVDAT    SZVDAT  50                      S01119
     C                     Z-ADDSZMDAT    SZMDAT  50                      S01119
     C                     Z-ADDSZPPL     SZPPL  130                      S01119
     C                     Z-ADDSZFIX     SZFIX  117                      S01119
     C                     Z-ADDSZFLT     SZFLT  117                      S01119
     C                     Z-ADDSZICB     SZICB   10                      S01119
     C                     Z-ADDSZIANP    SZIANP 130                      S01119
     C                     Z-ADD0         SZICVL  30                      S01119
     C                     Z-ADD0         SZSDAT  50                      S01119
     C                     Z-ADD0         SZEDAT  50                      S01119
     C                     Z-ADD0         SZPER   50                      S01119
     C                     Z-ADD0         SPPER   50                                        MD051152
     C                     Z-ADD0         STYR    20                      S01119
     C                     Z-ADD0         STTXDT  40                      S01119
     C                     Z-ADD0         STDAY   20                      S01119
     C                     Z-ADD0         STMTH   20                      S01119
     C                     Z-ADD0         ENDYR   20                      S01119
     C                     Z-ADD0         ENDWRK  40                      S01119
     C                     Z-ADD0         ENDDAY  20                      S01119
     C                     Z-ADD0         ENDMTH  20                      S01119
     C                     Z-ADD0         YEAR1   40                      S01119
     C                     Z-ADD0         STORE   40                      S01119
     C                     Z-ADD0         CHK     10                      S01119
     C                     Z-ADD0         YEAR2   40                      S01119
     C                     Z-ADD0         DAY1    20                      S01119
     C                     Z-ADD0         MTHS    20                      S01119
     C                     Z-ADD0         MTHS2   40                      S01119
     C                     Z-ADD0         SZWRK1 117                      S01119
     C**********           Z-ADD0         SZWRK2 157                S01119043304
     C                     Z-ADD0         SZWRK2 207                S01119043304
     C                     Z-ADD0         SZWRK3  50                      S01119
     C                     Z-ADD0         SZWRK4 147                      S01119
     C                     Z-ADD0         SZWRK5 147                      S01119
     C**********           Z-ADD0         SZWRK6 159               S01119 E35983
     C                     Z-ADD0         SZWRK6 150                      E35983
     C                     Z-ADD0         SZWRK7 129                      S01119
     C                     Z-ADD0         SZWRK8 150                      AUS021
     C                     Z-ADD0         SZWRK9 157                      AUS021
     C***********          Z-ADD0         SZSETL 150               S01119 051372
     C                     Z-ADD0         SZSETL 180                      051372
     C                     Z-ADD0         SZRDF  117                      S01119
     C                     Z-ADD0         SZRSA  150                      S01119
     C                     Z-ADD0         SZRDS  130                      S01119
     C                     Z-ADD0         SZDISC 117                      S01119
     C                     Z-ADD0         SZDSA  150                      S01119
     C                     Z-ADD0         DATST   60                      S01119
     C                     Z-ADD0         DATEND  60                      S01119
     C                     Z-ADD0         SLEAP   50                      S01119
     C                     Z-ADD0         ELEAP   50                      S01119
     C                     Z-ADD0         CHK2    10                      S01119
     C                     SETOF                     89                   S01119
     C*                                                                   AUS021
     C**  CHECK IF AUSTRALIA FORMULA REQUIRED                             AUS021
     C*                                                                   AUS021
     C           SETF      IFEQ 'A'                                       AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING AUSTRALIAN         AUS021
     C*   FORMULA                                                         AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C           SZMDAT    SUB  SZVDAT    SZWRK3                          AUS021
     C*                                                                   AUS021
     C**  MULTIPLY FACE VALUE BY (DAYS IN YEAR x 100)                     AUS021
     C*                                                                   AUS021
     C           SZPPL     MULT 36500     SZSETL                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FLOATING RATE                           AUS021
     C*                                                                   AUS021
     C           SZWRK3    MULT SZFLT     SZWRK2                          AUS021
     C                     ADD  36500     SZWRK2                          AUS021
     C           SZWRK2    IFNE *ZEROS                                    AUS021
     C           SZSETL    DIV  SZWRK2    SZRSA     H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZRSA                           AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  CALCULATE PROCEEDS FROM FIXED AMOUNT                            AUS021
     C*                                                                   AUS021
     C           SZWRK3    MULT SZFIX     SZWRK2                          AUS021
     C                     ADD  36500     SZWRK2                          AUS021
     C           SZWRK2    IFNE *ZEROS                                    AUS021
     C           SZSETL    DIV  SZWRK2    SZWRK8    H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZWRK8                          AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C           SZRSA     IFGT SZWRK8                                    040318
     C           SZRSA     SUB  SZWRK8    SZRDS                           AUS021
     C                     ELSE                                           040318
     C           SZWRK8    SUB  SZRSA     SZRDS                           040318
     C                     END                                            040318
     C*                                                                   AUS021
     C                     ELSE                                           AUS021
     C*                                                                   AUS021
     C**  CHECK IF U.S.A FORMULA REQUIRED                                 AUS021
     C*                                                                   AUS021
     C           SETF      IFEQ 'U'                                       AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.S.A FORMULA      AUS021
     C*                                                                   AUS021
     C**  CALCULATE DAYS TO MATURITY                                      AUS021
     C*                                                                   AUS021
     C           SZMDAT    SUB  SZVDAT    SZWRK3                          AUS021
     C*                                                                   AUS021
     C**  MULTIPLY INTEREST SETTLEMENT RATE BY DAYS TO MATURITY           AUS021
     C**  AND ADD (DAYS IN YEAR x 100)                                    AUS021
     C*                                                                   AUS021
     C           SZFLT     MULT SZWRK3    SZWRK9                          AUS021
     C                     ADD  36000     SZWRK9                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE DIFFERENCE in RATES                                   AUS021
     C*                                                                   AUS021
     C           SZFLT     IFGT SZFIX                                     AUS021
     C           SZFLT     SUB  SZFIX     SZWRK1                          AUS021
     C                     ELSE                                           AUS021
     C           SZFIX     SUB  SZFLT     SZWRK1                          AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C**  MULTIPLY DIFFERENCE IN RATES BY DAYS TO MATURITY AND            AUS021
     C**  CONTRACT AMOUNT                                                 AUS021
     C*                                                                   AUS021
     C           SZWRK1    MULT SZWRK3    SZWRK2                          AUS021
     C           SZWRK2    MULT SZPPL     SZWRK2                          AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT                          AUS021
     C*                                                                   AUS021
     C           SZWRK9    IFNE *ZEROS                                    AUS021
     C           SZWRK2    DIV  SZWRK9    SZRDS     H                     AUS021
     C                     ELSE                                           AUS021
     C                     Z-ADD*ZEROS    SZRDS                           AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C                     ELSE                                           AUS021
     C*                                                                   AUS021
     C**  CALCULATE DISCOUNTED SETTLEMENT AMOUNT USING U.K. FORMULA       AUS021
     C*                                                                   AUS021
     C*                                                                   S01119
     C**  DETERMINE VALUE ASSOCIATED WITH INTEREST CALCULATION BASIS      S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 2                                         S01119
     C           SZICB     OREQ 3                                         S01119
     C           SZICB     OREQ 5                                         S01119
     C           SZICB     OREQ 7                                         CIR004
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     Z-ADD360       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 1                                         S01119
     C           SZICB     OREQ 4                                         S01119
     C                     Z-ADD365       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 6                                         S01119
     C                     Z-ADD366       SZICVL                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET START DATE EQUAL TO VALUE DATE                              S01119
     C*                                                                   S01119
     C                     Z-ADDSZVDAT    SZSDAT                          S01119
     C*                                                                   S01119
     C**  PROCESS UNTIL END DATE IS GREATER THAN MATURITY DATE            S01119
     C*                                                                   S01119
     C           *IN89     DOUEQ'1'                                       S01119
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE2                                      S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C*                                                                   S01119
     C                     EXSR ZDATE2                                    S01119
     C*                                                                   S01119
     C**  INCREMENT YEAR BY 1                                             S01119
     C*                                                                   S01119
     C                     ADD  1         ZYEAR                           S01119
     C                     MOVE ZYEAR     ZDATE                           S01119
     C*                                                                   100140
     C* 29th February does not exist in a non-leap year.                  100140
     C*                                                                   100140
     C           ZMTH      IFEQ 02                                        100140
     C           ZDAY      ANDEQ29                                        100140
     C                     Z-ADD28        ZDAY                            100140
     C           *IN98     IFEQ '0'                                       156954
     C                     MOVELZDAY      ZDATE                           100140
     C                     ELSE                                           156954
     C                     MOVE ZDAY      W@MDY   40P                     156954
     C                     MOVELZMTH      W@MDY                           156954
     C                     MOVELW@MDY     ZDATE                           156954
     C                     END                                            156954
     C                     END                                            100140
     C*                                                                   S01119
     C**  EXECUTE SUB-ROUTINE ZDATE1                                      S01119
     C*                                                                   S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    SZEDAT                          S01119
     C*                                                                   031967
     C**  CHECK TO SEE IF MATURITY DATE FALLS BETWEEN PERIOD END DATE     031967
     C****AND*PERIOD*END*DATE*+*5*(THIS*WILL*ONLY*HAPPEN*IF*AN*FRA**031967060995
     C**  AND PERIOD END DATE + 10 (THIS WILL ONLY HAPPEN IF AN FRA 031967060995
     C**  WAS ENTERED WITH AN INCREASED MATURITY DATE DUE TO THE          031967
     C**  ACTUAL MATURITY DATE FALLING ON A NON-WORKING DAY).             031967
     C**  IF IT DOES DO THE LATER DISCOUNTED SETTLEMENT AMOUNT            031967
     C**  CALCULATION UPTO MATURITY DATE OTHERWISE UPTO THE PERIOD        031967
     C**  END DATE. THE NUMBER 5 WAS CHOSEN AS THIS IS THE WORST          031967
     C**  POSIBLE CASE OF NON-WORKING DAYS IN A ROW (EASTER).             031967
     C*                                                                   031967
     C***********SZEDAT    ADD  5         #EDAT   50                031967060995
     C           SZEDAT    ADD  10        #EDAT   50                031967060995
     C*                                                                   S01119
     C**  IF END DATE IS GREATER THAN THE MATURITY DATE                   S01119
     C**  THEN REPLACE END DATE  BY MATURITY DATE                         S01119
     C*                                                                   S01119
     C           SZEDAT    IFGE SZMDAT                                    S01119
     C           SZEDAT    ORLT SZMDAT                                    031967
     C           #EDAT     ANDGESZMDAT                                    031967
     C                     SETON                     89                   S01119
     C                     Z-ADDSZMDAT    SZEDAT                          S01119
     C                     END                                            S01119
      *                                                                   CIR013
     C           SZICB     IFEQ 9                                         CIR013
     C           SZICB     OREQ 6                                                           MD051152
      * Convert start date to YYYYMMDD format                             CIR013
     C                     Z-ADDSZSDAT    @@DAYN  50                      CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATA                          CIR013
      *                                                                   CIR013
      * Convert end date to YYYYMMDD format                               CIR013
     C                     Z-ADDSZEDAT    @@DAYN                          CIR013
     C                     EXSR ZDATE9                                    CIR013
     C                     Z-ADD@@VDT     ZZDATB                          CIR013
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
      *                                                                                     MD051152
     C           SZICB     IFEQ 9                                                           MD051152
      *                                                                   CIR013
     C                     EXSR #FEB29                                    CIR013
      *                                                                   CIR013
     C           #29FEB    IFEQ 'N'                                       CIR013
     C                     Z-ADD365       SZICVL                          CIR013
     C                     ELSE                                           CIR013
     C                     Z-ADD366       SZICVL                          CIR013
     C                     ENDIF                                          CIR013
      *                                                                   CIR013
     C                     ENDIF                                          CIR013
     C*                                                                   S01119
     C**  CALCULATE THE PERIOD BETWEEN START DATE AND END DATE            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 1                                         S01119
     C           SZICB     OREQ 2                                         S01119
     C           SZICB     OREQ 6                                         S01119
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'Y'                                       CIR013
     C           SZEDAT    SUB  SZSDAT    SZPER                           S01119
     C                     END                                            S01119
      *                                                                                     MD051152
      ** Perform no. of days calculation for method 6                                       MD051152
     C           SZICB     IFEQ 6                                                           MD051152
      *                                                                                     MD051152
      ** If start and end date are in the same year, check if the                           MD051152
      ** year is a leap year and add no. of interest days to the                            MD051152
      ** relevant total                                                                     MD051152
     C           ZZYY1     IFEQ ZZYY2                                                       MD051152
     C           ZZYY1     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
     C                     Z-ADDSZPER     SPPER                                             MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
      ** else must break down the interest period into leap years                           MD051152
      ** and non-leap years                                                                 MD051152
     C                     ELSE                                                             MD051152
      ** Add 1 to starting year number                                                      MD051152
     C           ZZYY1     ADD  1         ZZYY2                                             MD051152
      * Get Midas day number for 1st Jan of year after start date                           MD051152
     C                     MOVE '01'      ZZMM2                                             MD051152
     C                     MOVE '01'      ZZDD2                                             MD051152
     C                     MOVE ZZDATB    ZZDTIN                                            MD051152
     C                     EXSR ZDAT10                                                      MD051152
     C                     Z-ADDZZMDNO    ZZENDW  50                                        MD051152
     C           ZZENDW    SUB  SZSDAT    SPPER                                             MD051152
      *                                                                                     MD051152
      ** Check if current year is a leap year                                               MD051152
     C           ZZYY1     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
      * Finally calculate the days for the last part-year up                                MD051152
      * to the end date                                                                     MD051152
      *                                                                                     MD051152
      * Get Midas day number for 1st Jan of current year                                    MD051152
     C                     MOVE '01'      ZZMM2                                             MD051152
     C                     MOVE '01'      ZZDD2                                             MD051152
     C                     MOVE ZZDATB    ZZDTIN                                            MD051152
     C                     EXSR ZDAT10                                                      MD051152
     C                     Z-ADDZZMDNO    ZZBEG   50                                        MD051152
     C           SZEDAT    SUB  ZZBEG     SPPER                                             MD051152
      *                                                                                     MD051152
      ** Check if year is a leap year                                                       MD051152
     C           ZZYY2     DIV  4         ZZWN5                                             MD051152
     C                     MVR            ZZWN5                                             MD051152
     C           ZZWN5     IFNE 0                                                           MD051152
     C                     Z-ADD365       SZICVL                                            MD051152
     C                     ELSE                                                             MD051152
     C                     Z-ADD366       SZICVL                                            MD051152
     C                     ENDIF                                                            MD051152
      *                                                                                     MD051152
      ** Calculate Settlement Amount                                                        MD051152
     C                     EXSR FRASR                                                       MD051152
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
     C                     ENDIF                                                            MD051152
     C*                                                                   S01119
     C**  IF THE END DATE IS LESS THAN OR EQUAL TO THE MATURITY DATE      S01119
     C*                                                                   S01119
     C           *IN89     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 3                                         S01119
     C           SZICB     OREQ 4                                         S01119
     C           SZICB     OREQ 7                                         CIR004
     C           CIR004    ANDEQ'Y'                                       CIR004
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C                     Z-ADDSZICVL    SZPER                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 5                                         S01119
     C                     Z-ADD365       SZPER                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  THE END DATE WAS REPLACED BY THE MATURITY DATE                  S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 4                                         S01119
     C           SZICB     OREQ 5                                         S01119
     C           SZICB     OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C           SZEDAT    SUB  SZSDAT    SZPER                           S01119
     C*                                                                   S01119
     C**  CONVERT BOTH START AND END DAY NUMBERS TO DATES                 S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATST                           S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATEND                          S01119
     C*                                                                   S01119
     C**  ATTEMPT TO CALCULATE THE DAY NUMBER FOR 29 FEB IN THE YEAR      S01119
     C*                                                                   S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVEL'2902'    DATST                           S01119
     C                     MOVEL'2902'    DATEND                          S01119
     C                     ELSE                                           S01119
     C                     MOVEL'0229'    DATST                           S01119
     C                     MOVEL'0229'    DATEND                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDDATST     ZDATE                           S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    SLEAP                           S01119
     C*                                                                   S01119
     C**  IF A DAY NUMBER IS FOUND CHECK IF IT LIES BETWEEN START DATE    S01119
     C**  AND END DATE                                                    S01119
     C*                                                                   S01119
     C           *IN99     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           SLEAP     IFGE SZSDAT                                    S01119
     C           SLEAP     ANDLESZEDAT                                    S01119
     C           SZPER     SUB  1         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDDATEND    ZDATE                           S01119
     C                     EXSR ZDATE1                                    S01119
     C                     Z-ADDZDAYNO    ELEAP                           S01119
     C*                                                                   S01119
     C           *IN99     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C           ELEAP     IFGE SZSDAT                                    S01119
     C           ELEAP     ANDLESZEDAT                                    S01119
     C           SZPER     SUB  1         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  FOR METHOD 3 SPLIT BOTH START AND END DATES INTO THEIR          S01119
     C**  RESPECTIVE DAY,MONTH AND YEAR PORTIONS                          S01119
     C*                                                                   S01119
     C           SZICB     IFEQ 3                                         S01119
     C           SZICB     OREQ 7                                         CIR004
     C           CIR004    ANDEQ'Y'                                       CIR004
     C*                                                                   S01119
     C                     Z-ADD0         SZPER                           S01119
     C*                                                                   S01119
     C                     Z-ADDSZSDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATST                           S01119
     C*                                                                   S01119
     C                     MOVE DATST     STYR                            S01119
     C                     MOVE DATST     STTXDT                          S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVELDATST     STDAY                           S01119
     C                     MOVELSTTXDT    STMTH                           S01119
     C                     ELSE                                           S01119
     C                     MOVELDATST     STMTH                           S01119
     C                     MOVELSTTXDT    STDAY                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    ZDAYNO                          S01119
     C                     EXSR ZDATE2                                    S01119
     C                     Z-ADDZDATE     DATEND                          S01119
     C*                                                                   S01119
     C                     MOVE DATEND    ENDYR                           S01119
     C                     MOVE DATEND    ENDWRK                          S01119
     C           *IN98     IFEQ '0'                                       S01119
     C                     MOVELDATEND    ENDDAY                          S01119
     C                     MOVELENDWRK    ENDMTH                          S01119
     C                     ELSE                                           S01119
     C                     MOVELDATEND    ENDMTH                          S01119
     C                     MOVELENDWRK    ENDDAY                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CHECK START DATE FOR LEAP YEAR                                  S01119
     C*                                                                   S01119
     C           STYR      ADD  1900      YEAR1                           S01119
     C           YEAR1     DIV  4         STORE                           S01119
     C                     MVR            CHK                             S01119
     C*                                                                   S01119
     C**  CHECK END DATE FOR LEAP YEAR ALLOWING FOR CHANGE IN CENTURY     S01119
     C*                                                                   S01119
     C           ENDYR     ADD  1900      YEAR2                           S01119
     C           YEAR2     IFLT YEAR1                                     S01119
     C                     ADD  100       YEAR2                           S01119
     C                     END                                            S01119
     C           YEAR2     DIV  4         STORE                           S01119
     C                     MVR            CHK2                            S01119
     C*                                                                   S01119
     C**  IF START MONTH DOES NOT EQUAL 2 SUBTRACT DAY PORTION FROM 30    S01119
     C**  SETTING NEGATIVE RESULT TO ZERO FOR ACTUAL DAYS IN MONTH        S01119
     C*                                                                   S01119
     C           STMTH     IFNE 2                                         S01119
     C           30        SUB  STDAY     SZPER                           S01119
     C           SZPER     IFLT 0                                         S01119
     C                     Z-ADD0         SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF MONTH DOES EQUAL 2                                           S01119
     C*                                                                   S01119
     C           STMTH     IFEQ 2                                         S01119
     C*                                                                   S01119
     C**  IF IT IS NOT A LEAP YEAR SUBTRACT DAY PORTION FROM 28           S01119
     C*                                                                   S01119
     C           CHK       IFNE 0                                         S01119
     C           28        SUB  STDAY     SZPER                           S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  IF IT IS A LEAP YEAR SUBTRACT DAY PORTION FROM 29               S01119
     C*                                                                   S01119
     C           29        SUB  STDAY     SZPER                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  ADJUST START MONTH & YEAR TO CATER FOR YEAR END                 S01119
     C*                                                                   S01119
     C           STMTH     IFEQ 12                                        S01119
     C                     Z-ADD0         STMTH                           S01119
     C                     ADD  1         YEAR1                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF END MONTH IS NOT EQUAL TO 2 AND END DAY IS 31; OR MONTH      S01119
     C**  EQUALS 2 AND IT IS NOT A LEAP YEAR AND END DAY EQUALS 28;       S01119
     C**  OR MONTH EQUALS 2 AND IT IS A LEAP YEAR AND END DAY             S01119
     C**  EQUALS 29 THEN ADD 30 TO PERIOD COUNT                           S01119
     C*                                                                   S01119
     C           ENDMTH    IFNE 2                                         S01119
     C           ENDDAY    ANDEQ31                                        S01119
     C           ENDMTH    OREQ 2                                         S01119
     C           CHK2      ANDNE0                                         S01119
     C           ENDDAY    ANDEQ28                                        S01119
     C           SZICB     ANDEQ3                                         CIR004
     C           ENDMTH    OREQ 2                                         S01119
     C           CHK2      ANDEQ0                                         S01119
     C           ENDDAY    ANDEQ29                                        S01119
     C           SZICB     ANDEQ3                                         CIR004
     C*                                                                   S01119
     C                     ADD  30        SZPER                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  ADD DAY NUMBER PORTION TO PERIOD COUNT                          S01119
     C*                                                                   S01119
     C                     ADD  ENDDAY    SZPER                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT 1 FROM END MONTH                                       S01119
     C*                                                                   S01119
     C                     SUB  1         ENDMTH                          S01119
     C*                                                                   S01119
     C**  IF START YEAR AND END YEAR ARE THE SAME SUBTRACT START          S01119
     C**  MONTH FROM END MONTH                                            S01119
     C*                                                                   S01119
     C           YEAR1     IFEQ YEAR2                                     S01119
     C           ENDMTH    SUB  STMTH     MTHS                            S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  ADD END MTH TO THE RESULT OF SUBTRACTING START MONTH FROM 12    S01119
     C*                                                                   S01119
     C           12        SUB  STMTH     MTHS                            S01119
     C           ENDMTH    ADD  MTHS      MTHS                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  MULTIPLY THE NUMBER OF MONTHS BY 30 AND ADD TO THE PERIOD       S01119
     C*                                                                   S01119
     C           MTHS      MULT 30        MTHS2                           S01119
     C                     ADD  MTHS2     SZPER                           S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  CALCULATE THIS PERIOD'S DISCOUNTED SETTLEMENT AMOUNT USING      S01119
     C**  THIS EQUATION WHERE SS = SETTLEMENT AMOUNT                      S01119
     C**                       D = PERIOD                                 S01119
     C**                                                                  S01119
     C**        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL             S01119
     C**             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~       S01119
     C**             (INTEREST CALC BASIS x 100) + (BASE RATE x D)        S01119
     C*                                                                   S01119
     C           SZICB     IFNE 6                                                           MD051152
      *                                                                                     MD051152
     C           SZFLT     IFGE SZFIX                                     S01119
     C*                                                                   S01119
     C           SZFLT     SUB  SZFIX     SZWRK1                          S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           SZFIX     SUB  SZFLT     SZWRK1                          S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SZWRK1    MULT SZPER     SZWRK2                          S01119
      *                                                                   E35983
      * Multiply now by principal to get larger value for dividing        E35983
      * and avoid errors due to half-adjusting small numbers later        E35983
     C           SZWRK2    MULT SZPPL     SZWRK6                          E35983
      *                                                                   E35983
     C           SZICVL    MULT 100       SZWRK3                          S01119
     C           SZFLT     MULT SZPER     SZWRK4                          S01119
     C           SZWRK3    ADD  SZWRK4    SZWRK5                          S01119
     C********** SZWRK2    DIV  SZWRK5    SZWRK6    H              S01119 E35983
     C********** SZWRK6    MULT SZPPL     SZSETL    H              S01119 E35983
     C           SZWRK6    DIV  SZWRK5    SZSETL    H                     E35983
      *                                                                                     MD051152
     C                     ENDIF                                                            MD051152
     C*                                                                   S01119
     C**  IF VALUE DATE = START DATE THEN FIRST PERIOD SO INITIALISE      S01119
     C**  RUNNING DISCOUNT FACTOR TO 1                                    S01119
     C*                                                                   S01119
     C           SZVDAT    IFEQ SZSDAT                                    S01119
     C*                                                                   S01119
     C                     Z-ADD1         SZRDF                           S01119
     C                     Z-ADDSZSETL    SZRDS                           S01119
     C                     ELSE                                           S01119
     C*                                                                   E22610
     C**  DIVIDE THE DISCOUNTED SETTLEMENT AMOUNT BY THE RUNNING          E22610
     C**  DISCOUNT FACTOR TO REDISCOUNT THIS PERIOD'S SETTLEMENT AMOUNT   E22610
     C**  BACK TO START DATE                                              E22610
     C*                                                                   E22610
     C           SZSETL    DIV  SZRDF     SZRSA     H                     E22610
     C*                                                                   E22610
     C**  ADD THE REDISCOUNTED SETTLEMENT AMOUNT TO THE RUNNING           E22610
     C**  DISCOUNTED  SETTLEMENT TOTAL                                    E22610
     C*                                                                   E22610
     C           SZRSA     ADD  SZRDS     SZRDS                           E22610
     C*                                                                   E22610
     C                     END                                            E22610
      *                                                                                     MD051152
     C                     Z-ADD0         SZSETL                                            MD051152
     C*                                                                   S01119
     C**  CALCULATE THIS PERIOD'S DISCOUNT FACTOR USING THE EQUATION      S01119
     C**                                                                  S01119
     C**    FACTOR = 1 +     (D x BASE RATE)                              S01119
     C**                 ~~~~~~~~~~~~~~~~~~~~~~~~~~                       S01119
     C**                 (INTEREST CALC BASIS x 100)                      S01119
     C*                                                                   S01119
     C           SZWRK4    DIV  SZWRK3    SZWRK7    H                     S01119
     C           1         ADD  SZWRK7    SZDISC    H                     S01119
     C*                                                                   S01119
     C**  MULTIPLY THE DISCOUNT FACTOR BY THE RUNNING DISCOUNT FACTOR     S01119
     C**  TO OBTAIN THE NEW RUNNING DISCOUNT FACTOR FOR REDISCOUNTING     S01119
     C**  SETTLEMENT AMOUNTS BACK TO START DATE                           S01119
     C*                                                                   S01119
     C           SZDISC    MULT SZRDF     SZRDF     H                     S01119
     C*                                                                   S01119
     C****DIVIDE THE DISCOUNTED SETRTLEMENT AMOUNT BY THE RUNNING  S01119 E22610
     C****DISCOUNT FACTOR TO REDISCOUNT THIS PERIOD'S SETTLEMENT AMS01119 E22610
     C****BACK TO START DATE                                       S01119 E22610
     C****                                                         S01119 E22610
     C****       SZSETL    DIV  SZRDF     SZRSA     H              S01119 E22610
     C****                                                         S01119 E22610
     C****ADD THE REDISCOUNTED SETTLEMENT AMOUNT TO THE RUNNING    S01119 E22610
     C****DISCOUNTED  SETTLEMENT TOTAL                             S01119 E22610
     C****                                                         S01119 E22610
     C****       SZRSA     ADD  SZRDS     SZRDS                    S01119 E22610
     C****                                                         S01119 E22610
     C****                 END                                     S01119 E22610
     C*                                                                   S01119
     C**  SET THE START DATE TO THE END DATE                              S01119
     C*                                                                   S01119
     C                     Z-ADDSZEDAT    SZSDAT                          S01119
     C                     END                                            S01119
     C*                                                                   AUS021
     C                     END                                            AUS021
     C*                                                                   AUS021
     C                     END                                            AUS021
     C*                                                                   S01119
     C**  ADD THE NET ACCRUED INTEREST ADJUSTMENTS NOT POSTED TO THE      S01119
     C**  RUNNING DISCOUNTED SETTLEMENT TOTAL TO GIVE THE DISCOUNTED      S01119
     C**  SETTLEMENT AMOUNT TOTAL                                         S01119
     C*                                                                   S01119
     C           SZIANP    ADD  SZRDS     SZDSA                           S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C********************************************************************S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C           FRASR     BEGSR                                                            MD051152
      *                                                                                     MD051152
      **  Calculate this period's discounted settlement amount using                        MD051152
      **  this equation where SS = Settlement amount                                        MD051152
      **                       D = PERIOD                                                   MD051152
      **                                                                                    MD051152
      **        SS = (BASE RATE - FIXED RATE) x D x PRINCIPAL                               MD051152
      **             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                         MD051152
      **             (INTEREST CALC BASIS x 100) + (BASE RATE x D)                          MD051152
      *                                                                                     MD051152
     C           SZFLT     IFGE SZFIX                                                       MD051152
      *                                                                                     MD051152
     C           SZFLT     SUB  SZFIX     SZWRK1                                            MD051152
      *                                                                                     MD051152
     C                     ELSE                                                             MD051152
      *                                                                                     MD051152
     C           SZFIX     SUB  SZFLT     SZWRK1                                            MD051152
      *                                                                                     MD051152
     C                     END                                                              MD051152
      *                                                                                     MD051152
     C           SZWRK1    MULT SPPER     SZWRK2                                            MD051152
      *                                                                                     MD051152
      * Multiply now by principal to get larger value for dividing                          MD051152
      * and avoid errors due to half-adjusting small numbers later                          MD051152
     C           SZWRK2    MULT SZPPL     SZWRK6                                            MD051152
      *                                                                                     MD051152
     C           SZICVL    MULT 100       SZWRK3                                            MD051152
     C           SZFLT     MULT SZPER     SZWRK4                                            MD051152
     C           SZWRK3    ADD  SZWRK4    SZWRK5                                            MD051152
     C           SZWRK6    DIV  SZWRK5    W#SET6 180H                                       MD051152
      *                                                                                     MD051152
     C           W#SET6    ADD  SZSETL    SZSETL                                            MD051152
      *                                                                                     MD051152
     C                     ENDSR                                                            MD051152
      *                                                                                     MD051152
     C**************************************************************************            MD051152
      /SPACE 5                                                                              MD051152
     C**************************************************************************            MD051152
     C*                                                               *   S01119
     C*****RL1*SR:*TO*PROCESS*'RL'*DEAL*TYPES*WITH*AVE.*RATE*METHO S01119 S01157
     C*    RL1 SR: TO PROCESS RR/RP/RF DEAL TYPES WITH AVE. RATE METH.*   S01157
     C*            IND 'ON' AND AMD. AVE. CALC. RATE IND 'OFF'        *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           RL1       BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C                     Z-ADD0         INTMD   50                      S01119
     C                     Z-ADD0         INTMR  157                      S01119
     C                     Z-ADD0         BRATE  117                      S01119
     C                     Z-ADD0         RTSP   117                      S01119
     C                     Z-ADD0         EINR   117                      S01119
     C                     Z-ADD0         WORK   157                      S01119
     C                     Z-ADD0         OLDSP  117                      S01119
     C                     Z-ADD0         WORK1  159                      S01119
     C                     Z-ADD0         NEINR  117                      S01119
     C                     Z-ADD0         INFD    50                      S01119
     C                     Z-ADD0         WDAY    50                      S01119
     C                     Z-ADD0         WRAT   117                      S01119
     C                     Z-ADD0         EBRVD   50                      S01119
     C                     MOVE *BLANKS   SPIN    1                       S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'1'       UDSTI          20  NEG INTR.    S01119
     C*                                                                   S01119
     C*****      VDNR      IFLE UINFD                             S01119  S01194
     C           BAVDNR    IFLE UINFD                                     S01194
     C                     Z-ADDUINFD     EBRVD                           S01119
     C                     ELSE                                           S01119
     C*****                Z-ADDVDNR      EBRVD                   S01119  S01194
     C                     Z-ADDBAVDNR    EBRVD                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDUBRTE     BRATE                           S01119
     C                     MOVE USPIN     SPIN                            S01119
     C                     Z-ADDURTSP     RTSP                            S01119
     C                     Z-ADDUEINR     EINR                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     TESTB'1'       TDSTI          20  NEG INTR.    S01119
     C*                                                                   S01119
     C*****      VDNR      IFLE TINFD                             S01119  S01194
     C           BAVDNR    IFLE TINFD                                     S01194
     C                     Z-ADDTINFD     EBRVD                           S01119
     C                     ELSE                                           S01119
     C*****                Z-ADDVDNR      EBRVD                   S01119  S01194
     C                     Z-ADDBAVDNR    EBRVD                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C                     Z-ADDTBRTE     BRATE                           S01119
     C                     MOVE TSPIN     SPIN                            S01119
     C                     Z-ADDTRTSP     RTSP                            S01119
     C                     Z-ADDTEINR     EINR                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF VALUE DATE OF BASE RATE CHANGE IS LESS THAN RUN DATE IT      S01119
     C**  IS A BACK VALUED RATE CHANGE                                    S01119
     C*                                                                   S01119
     C*****      EBRVD     IFLT RUND                              S01119  S01194
     C           EBRVD     IFLT BJRDNB                                    S01194
     C*                                                                   S01119
     C**  VALUE DATE OF BASE RATE CHANGE - LAST RATE FIX DATE = INTERIM   S01119
     C**  NO. OF DAYS                                                     S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           EBRVD     SUB  UINFD     INTMD                           S01119
     C                     ELSE                                           S01119
     C           EBRVD     SUB  TINFD     INTMD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  AVERAGING PERIOD + INTERIM NO. OF DAYS = NEW AVE. PERIOD        S01119
     C*                                                                   S01119
     C                     ADD  INTMD     AVPER                           S01119
     C*                                                                   S01119
     C**  EFFECTIVE INT RATE x INTERIM NO. DAYS = INTERIM TOTAL RATE      S01119
     C*                                                                   S01119
     C           EINR      MULT INTMD     INTMR                           S01119
     C*                                                                   S01119
     C**  ADD INTERIM TOTAL RATE TO TOTAL INT RATE TO GIVE NEW TOTAL      S01119
     C**  INT RATE                                                        S01119
     C*                                                                   S01119
     C                     ADD  INTMR     TIRAT                           S01119
     C*                                                                   S01119
     C**  SET LAST RATE FIX DATE = VALUE DATE OF BASE RATE CHANGE         S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDEBRVD     UINFD                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDEBRVD     TINFD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  APPLY SPREAD TO THE OLD BASE RATE ON THE DEAL                   S01119
     C*                                                                   S01119
     C                     Z-ADDBRATE     RATE                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'A'                                       S01119
     C           BRATE     ADD  RTSP      RATE                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C           BRATE     SUB  RTSP      RATE                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C           BRATE     MULT RTSP      WORK                            S01119
     C           WORK      DIV  100       WORK                            S01119
     C           BRATE     ADD  WORK      RATE                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THE RESULT OF THE ABOVE CALCULATION IS DIFFERENT TO THE      S01119
     C**  EFFECTIVE INTEREST RATE THE SPREAD HAS BEEN AMENDED TODAY       S01119
     C**  AND THE OLD SPREAD CAN BE CALCULATED                            S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBEINR      EINR                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           RATE      IFNE EINR                                      S01119
     C           EINR      SUB  RATE      DIFF                            S01119
     C                     Z-ADD0         OLDSP                           S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'A'                                       S01119
     C           DIFF      ADD  RTSP      OLDSP                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C           RTSP      SUB  DIFF      OLDSP                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C           EINR      SUB  BRATE     DIFF                            S01119
     C           100       DIV  BRATE     WORK1                           S01119
     C           WORK1     MULT DIFF      OLDSP                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  APPLY OLD SPREAD TO THE NEW BASE RATE TO GIVE THE INTERIM       S01119
     C**  EFFECTIVE INTEREST RATE                                         S01119
     C*                                                                   S01119
     C*****                Z-ADDNBRT      NEINR                   S01119  S01194
     C                     Z-ADDBANBRT    NEINR                           S01194
     C*                                                                   S01119
     C           SPIN      IFEQ 'A'                                       S01119
     C*****      OLDSP     ADD  NBRT      NEINR                   S01119  S01194
     C           OLDSP     ADD  BANBRT    NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C*****      NBRT      SUB  OLDSP     NEINR                   S01119  S01194
     C           BANBRT    SUB  OLDSP     NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C*****      NBRT      MULT OLDSP     WORK                    S01119  S01194
     C           BANBRT    MULT OLDSP     WORK                            S01194
     C           WORK      DIV  100       WORK                            S01119
     C*****      NBRT      ADD  WORK      NEINR                   S01119  S01194
     C           BANBRT    ADD  WORK      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBNEINR     NEINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF SPREAD HAD BEEN CHANGED THEN RESET THE AVERAGE TOTALS        S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****      RUND      SUB  UINFD     INTMD                   S01119  S01194
     C           BJRDNB    SUB  UINFD     INTMD                           S01194
     C                     ELSE                                           S01119
     C*****      RUND      SUB  TINFD     INTMD                   S01119  S01194
     C           BJRDNB    SUB  TINFD     INTMD                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           NEINR     MULT INTMD     INTMR                           S01119
     C                     ADD  INTMD     AVPER                           S01119
     C                     ADD  INTMR     TIRAT                           S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****                Z-ADDRUND      UINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    UINFD                           S01194
     C                     ELSE                                           S01119
     C*****                Z-ADDRUND      TINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    TINFD                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  APPLY THE SPREAD TO THE NEW BASE RATE TO GIVE THE NEW           S01119
     C**  EFFECTIVE INTEREST RATE                                         S01119
     C*                                                                   S01119
     C*****                Z-ADDNBRT      NEINR                   S01119  S01194
     C                     Z-ADDBANBRT    NEINR                           S01194
     C*                                                                   S01119
     C           SPIN      IFEQ 'A'                                       S01119
     C*****      NBRT      ADD  RTSP      NEINR                   S01119  S01194
     C           BANBRT    ADD  RTSP      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C*****      NBRT      SUB  RTSP      NEINR                   S01119  S01194
     C           BANBRT    SUB  RTSP      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C*****      NBRT      MULT RTSP      WORK                    S01119  S01194
     C           BANBRT    MULT RTSP      WORK                            S01194
     C           WORK      DIV  100       WORK                            S01119
     C*****      NBRT      ADD  WORK      NEINR                   S01119  S01194
     C           BANBRT    ADD  WORK      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBNEINR     NEINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  RECALCULATE THE ACTUAL AVERAGE CALCULATED RATE FOR TODAY'S      S01119
     C**  PROCESSING                                                      S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUINFD     INFD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C******     RUND      SUB  INFD      INTMD                   S01119  S01194
     C           BJRDNB    SUB  INFD      INTMD                           S01194
     C           INTMD     MULT NEINR     INTMR                           S01119
     C           INTMD     ADD  AVPER     WDAY                            S01119
     C           INTMR     ADD  TIRAT     WRAT                            S01119
     C           WRAT      DIV  WDAY      AACRT                           S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUINFD     INFD                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THE VALUE DATE OF THE BASE RATE CHANGE IS EQUAL TO           S01119
     C**  THE RUN DATE CALCULATE THE NEW AVERAGING PERIOD AND THE         S01119
     C**  NEW TOTAL INTEREST RATE                                         S01119
     C*                                                                   S01119
     C*****      EBRVD     IFEQ RUND                              S01119  S01194
     C           EBRVD     IFEQ BJRDNB                                    S01194
     C*****      RUND      SUB  INFD      INTMD                   S01119  S01194
     C           BJRDNB    SUB  INFD      INTMD                           S01194
     C           EINR      MULT INTMD     INTMR                           S01119
     C                     ADD  INTMD     AVPER                           S01119
     C                     ADD  INTMR     TIRAT                           S01119
     C           TIRAT     DIV  AVPER     AACRT                           S01119
     C*                                                                   S01119
     C**  SET THE LAST RATE FIX DATE TO EQUAL THE RUN DATE                S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****                Z-ADDRUND      UINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    UINFD                           S01194
     C                     ELSE                                           S01119
     C*****                Z-ADDRUND      TINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    TINFD                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C**  APPLY THE SPREAD TO THE NEW BASE RATE TO GIVE THE               S01119
     C**  EFFECTIVE INTEREST RATE                                         S01119
     C*                                                                   S01119
     C*****                Z-ADDNBRT      NEINR                   S01119  S01194
     C                     Z-ADDBANBRT    NEINR                           S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'A'                                       S01119
     C*****      NBRT      ADD  RTSP      NEINR                   S01119  S01194
     C           BANBRT    ADD  RTSP      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'S'                                       S01119
     C*****      NBRT      SUB  RTSP      NEINR                   S01119  S01194
     C           BANBRT    SUB  RTSP      NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           SPIN      IFEQ 'P'                                       S01119
     C*****      NBRT      MULT RTSP      WORK                    S01119  S01194
     C           BANBRT    MULT RTSP      WORK                            S01194
     C           WORK      DIV  100       WORK                            S01119
     C*****      WORK      ADD  NBRT      NEINR                   S01119  S01194
     C           WORK      ADD  BANBRT    NEINR                           S01194
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '1'                                       S01119
     C                     Z-SUBNEINR     NEINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDNEINR     UEINR                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDNEINR     TEINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    RL2 SR: TO CALCULATE THE ACTUAL AVERAGE CALCULATED RATE    *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           RL2       BEGSR                                          S01119
     C*                                                                   S01119
     C**  SUBTRACT THE LAST RATE FIX DATE FROM THE PAYMENT DATE TO        S01119
     C**  GIVE THE INTERIM NO. OF DAYS                                    S01119
     C*                                                                   S01119
     C           PAYD      SUB  INFD      INTMD                           S01119
      *                                                                   CIR005
      ** Use interest payment base date for transactions                  CIR005
      ** with actual amount conventions                                   CIR005
      *                                                                   CIR005
     C           CIR005    IFEQ 'Y'                                       CIR005
     C           L1AMCN    ANDEQ'A'                                       CIR005
      *                                                                   CIR005
     C********** UBRTT     IFNE 0                                                      CIR005 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
      *                                                                   CIR005
     C           UNIPD     IFNE 0                                         CIR005
     C           UIPBD     SUB  INFD      INTMD                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ELSE                                           CIR005
      *                                                                   CIR005
     C           TNIPD     IFNE 0                                         CIR005
     C           TIPBD     SUB  INFD      INTMD                           CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
      *                                                                   CIR005
     C                     ENDIF                                          CIR005
     C*                                                                   S01119
     C**  MULTIPLY INTERIM NO. OF DAYS BY EFFECTIVE INT. RATE TO          S01119
     C**  GIVE INTERIM TOTAL RATE                                         S01119
     C*                                                                   S01119
     C           INTMD     MULT EINR      INTMR                           S01119
     C*                                                                   S01119
     C**  ADD INTERIM NO. OF DAYS TO THE AVERAGING PERIOD TO GIVE         S01119
     C**  WORK NO. OF DAYS                                                S01119
     C*                                                                   S01119
     C           INTMD     ADD  AVPER     WDAY                            S01119
     C*                                                                   S01119
     C**  ADD INTERIM TOTAL RATE TO THE TOTAL INTEREST RATE TO GIVE       S01119
     C**  WORK RATE                                                       S01119
     C*                                                                   S01119
     C           INTMR     ADD  TIRAT     WRAT                            S01119
     C*                                                                   S01119
     C**  DIVIDE THE WORK RATE BY THE WORK NO. OF DAYS TO GIVE            S01119
     C**  THE ACTUAL AVERAGE CALCULATED RATE                              S01119
     C*                                                                   S01119
     C           WRAT      DIV  WDAY      AACRT     H                     S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    RL3 SR: TO CALCULATE THE ACTUAL AVERAGE CALCULATED RATE    *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS :       SUB02                                        *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           RL3       BEGSR                                          S01119
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C                     Z-ADD0         PRAT   117                      S01119
     C                     Z-ADD0         RERAT  117                      S01119
     C                     Z-ADD0         TURAT  117                      S01119
     C                     MOVE ' '       OTIN                                              AR845022
     C                     MOVE ' '       FLRT    1                                         AR845022
     C           *LIKE     DEFN TUSI      XUSI                                              AR845022
     C*                                                                   S01119
     C**  MOVE PROVIDERS INTEREST PAYMENT DATE FIELDS INTO WORK FIELDS    S01119
     C**  FOR SUB02                                                       S01119
     C*                                                                   S01119
     C                     Z-ADDSDCAR     SZSDCR                          S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUIACD     SZAICD                          S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTIACD     SZAICD                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THE NEXT INTEREST DATE IS GREATER THAN THE PROVIDERS         S01119
     C**  START/LAST INTEREST PAYMENT DATE CALCULATE INTEREST PAYMENT     S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                                                      S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C           SZEDAT    ANDGTTSLIP                                     S01119
     C********** TBRTT     OREQ 0                                                      S01119 CSD103
     C           TBRTT     OREQ *BLANKS                                                       CSD103
     C           SZEDAT    ANDGTUSLIP                                     S01119
     C*                                                                   S01119
     C**  SET UP PROVIDERS RATE AS PROVIDERS EFFECTIVE INT RATE IF        S01119
     C**  AVE. RATE METHOD IND IS OFF                                     S01119
     C*                                                                   S01119
     C           *IN14     IFEQ '0'                                       S01119
     C                     MOVE 'N'       SZAVRM                          S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUEINR     PRAT                            S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTEINR     PRAT                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF THE AVE. RATE METHOD IND IS ON THEN PROVIDERS RATE IS        S01119
     C**  THE ACTUAL AVERAGE CALC. RATE                                   S01119
     C*                                                                   S01119
     C           *IN14     IFEQ '1'                                       S01119
     C                     Z-ADDAACRT     PRAT                            S01119
     C                     MOVE 'Y'       SZAVRM                          S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT CEILING RATE FROM THE PROVIDERS RATE TO GIVE           S01119
     C**  REIMBURSEMENT RATE                                              S01119
     C*                                                                   S01119
     C           PRAT      SUB  CLRAT     RERAT                           S01119
     C*                                                                   S01119
     C**  IF REIMBURSEMENT RATE LESS THAN 0 THEN SET TO 0                 S01119
     C*                                                                   S01119
     C           RERAT     IFLT 0                                         S01119
     C                     Z-ADD0         RERAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SUBTRACT PROVIDERS RATE FROM FLOOR RATE IF ENTERED TO           S01119
     C**  GIVE TOPPING UP RATE, ELSE SET TO 0                             S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'4'       UDSTI          18               S01119
     C                     ELSE                                           S01119
     C                     TESTB'4'       TDSTI          18               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN18     IFEQ '1'                                       S01119
     C           FLRAT     SUB  PRAT      TURAT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         TURAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF TOPPING UP RATE LESS THAN 0 THEN SET TO 0                    S01119
     C*                                                                   S01119
     C           TURAT     IFLT 0                                         S01119
     C                     Z-ADD0         TURAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF NEGATIVE INTEREST INDICATOR OFF                              S01119
     C*                                                                   S01119
     C                     Z-ADDTPAMT     SZPPL                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           TINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C051
     C                     ADD  TUSI      SZPPL                           CIR002
     C                     END                                            CIR002
     C                     Z-ADDTICBS     SZCBS                           S01119
     C                     Z-ADDTIALC     SZLICD                          S01119
     C                     Z-ADDTAITC     SZIACD                          S01119
     C                     Z-ADDTAIAN     SZIANP                          S01119
     C                     Z-ADDTAIAP     SZAIAP                          S01119
     C                     Z-ADDTAIPD     SZIPTD                          S01119
     C                     Z-ADDTIPRD     SZIPRD                          S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C**  IF USER IS TAKER WITH REIMBURSEMENT RATE GREATER THAN OR        S01119
     C**  EQUAL TO 0 MOVE THEIR INT CALC DETAILS AND REIMBURSEMENT        S01119
     C**  RATE INTO WORK FIELDS                                           S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                                                      S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C*                                                                   S01119
     C********** RERAT     IFGE 0                                                    S01119 AR845022
     C           RERAT     IFGT 0                                                           AR845022
     C                     Z-ADDRERAT     SZINR                           S01119
     C                     ELSE                                                             AR845022
      *                                                                                     AR845022
      ** When deal is using the floor rate (i.e. RF, RR), FLRT field                        AR845022
      ** will be set to Y to note that the calculated rate should be                        AR845022
      ** posted the other way around.                                                       AR845022
      *                                                                                     AR845022
     C           TURAT     IFGT 0                                                           AR845022
     C                     Z-ADDTURAT     SZINR                                             AR845022
     C                     MOVE 'Y'       FLRT                                              AR845022
     C                     ELSE                                                             AR845022
     C                     Z-ADD0         SZINR                                             AR845022
     C                     ENDIF                                                            AR845022
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         SZINR                                             AR845022
     C*                                                                   S01119
     C****IF*USER*IS*PROVIDER*WITH*TOPPING*UP*RATE*GREATER*THAN*OR*****              S01119 AR845022
     C****EQUAL*TO*0*MOVE*THEIR*INT*CALC*DETAILS*AND*TOPPING*UP********              S01119 AR845022
     C****RATE*INTO*WORK*FIELDS****************************************              S01119 AR845022
     C*****************************************************************              S01119 AR845022
     C********** TURAT     IFGE 0                                                    S01119 AR845022
     C**********           Z-ADDTURAT     SZINR                                      S01119 AR845022
     C**********           END                                                       S01119 AR845022
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  NEGATIVE INTEREST INDICATOR IS ON                               S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           RERAT     IFGE 0                                         S01119
     C                     Z-ADDRERAT     SZINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C           TURAT     IFGE 0                                         S01119
     C                     Z-ADDTURAT     SZINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
      ** Check for any principal changes that are due until the                             AR845022
      ** next interest payment date                                                         AR845022
      *                                                                                     AR845022
     C                     Z-ADD0         INTDX  130                                        AR845022
     C           TNPCD     IFNE 0                                                           AR845022
     C           TNPCD     ANDLTSZEDAT                                                      AR845022
     C********** TBRTT     ANDNE0                                                    AR845022 CSD103
     C           TBRTT     ANDNE*BLANKS                                                       CSD103
     C                     MOVE TINPM     XINPM   1                                         AR845022
     C                     MOVE TUSI      XUSI                                              AR845022
     C                     EXSR PCCHG                                                       AR845022
     C                     Z-ADDEDATX     SZEDAT                                            AR845022
     C                     ENDIF                                                            AR845022
      *                                                                                     AR845022
     C                     EXSR SUB02                                     S01119
     C**********           Z-ADDINTD      STINT                                      S01119 AR845022
     C           INTDX     ADD  INTD      STINT                                             AR845022
      *                                                                                     AR845022
      ** Store the total amount on a work variable field for the                            AR845022
      ** opposite side since floor rate is used                                             AR845022
      *                                                                                     AR845022
     C           FLRT      IFEQ 'Y'                                                         AR845022
     C           INTDX     ADD  INTD      CALINX                                            AR845022
     C                     ENDIF                                                            AR845022
     C*                                                                   S01119
     C                     MOVE ' '       FLRT                                              AR845022
     C                     Z-ADDUPAMT     SZPPL                           S01119
     C           CIR002    IFEQ 'Y'                                       CIR002
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'A'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'I'                                       CIR006
     C           CIR006    OREQ 'Y'                                       CIR006
     C           UINPM     ANDEQ'L'                                       CIR006
     C/COPY WNCPYSRC,DL0279C052
     C                     ADD  OUSI      SZPPL                           CIR002
     C                     END                                            CIR002
     C                     Z-ADDUICBS     SZCBS                           S01119
     C                     Z-ADDUIALC     SZLICD                          S01119
     C                     Z-ADDUAITC     SZIACD                          S01119
     C                     Z-ADDUAIAN     SZIANP                          S01119
     C                     Z-ADDUAIAP     SZAIAP                          S01119
     C                     Z-ADDUAIPD     SZIPTD                          S01119
     C                     Z-ADDUIPRD     SZIPRD                          S01119
     C*                                                                   S01119
     C           *IN20     IFEQ '0'                                       S01119
     C*                                                                   S01119
     C**  IF USER IS TAKER WITH REIMBURSEMENT RATE GREATER THAN OR        S01119
     C**  EQUAL TO 0 MOVE THEIR INT CALC DETAILS AND REIMBURSEMENT        S01119
     C**  RATE INTO WORK FIELDS                                           S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*                                                                   S01119
     C********** RERAT     IFGE 0                                                    S01119 AR845022
     C           RERAT     IFGT 0                                                           AR845022
     C                     Z-ADDRERAT     SZINR                           S01119
     C                     ELSE                                                             AR845022
      *                                                                                     AR845022
      ** When deal is using the floor rate (i.e. RF, RR), FLRT field                        AR845022
      ** will be set to Y to note that the calculated rate should be                        AR845022
      ** posted the other way around.                                                       AR845022
      *                                                                                     AR845022
     C           TURAT     IFGT 0                                                           AR845022
     C                     Z-ADDTURAT     SZINR                                             AR845022
     C                     MOVE 'Y'       FLRT                                              AR845022
     C                     ELSE                                                             AR845022
     C                     Z-ADD0         SZINR                                             AR845022
     C                     ENDIF                                                            AR845022
      *                                                                                     AR845022
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     Z-ADD0         SZINR                                             AR845022
     C*                                                                   S01119
     C****IF*USER*IS*PROVIDER*WITH*TOPPING*UP*RATE*GREATER*THAN*OR*****              S01119 AR845022
     C****EQUAL*TO*0*MOVE*THEIR*INT*CALC*DETAILS*AND*TOPPING*UP********              S01119 AR845022
     C****RATE*INTO*WORK*FIELDS****************************************              S01119 AR845022
     C*****************************************************************              S01119 AR845022
     C********** TURAT     IFGE 0                                                    S01119 AR845022
     C**********           Z-ADDTURAT     SZINR                                      S01119 AR845022
     C**********           END                                                       S01119 AR845022
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  NEGATIVE INTEREST INDICATOR IS ON                               S01119
     C*                                                                   S01119
     C********** UBRTT     IFEQ 0                                                      S01119 CSD103
     C           UBRTT     IFEQ *BLANKS                                                       CSD103
     C           RERAT     IFGE 0                                         S01119
     C                     Z-ADDRERAT     SZINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C           TURAT     IFGE 0                                         S01119
     C                     Z-ADDTURAT     SZINR                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
      ** Check for any principal changes that are due until the                             AR845022
      ** next interest payment date                                                         AR845022
      *                                                                                     AR845022
     C                     Z-ADD0         INTDX                                             AR845022
     C           UNPCD     IFNE 0                                                           AR845022
     C           UNPCD     ANDLTSZEDAT                                                      AR845022
     C********** UBRTT     ANDNE0                                                    AR845022 CSD103
     C           UBRTT     ANDNE*BLANKS                                                       CSD103
     C                     MOVE UINPM     XINPM                                             AR845022
     C                     MOVE OUSI      XUSI                                              AR845022
     C                     EXSR PCCHG                                                       AR845022
     C                     Z-ADDEDATX     SZEDAT                                            AR845022
     C                     ENDIF                                                            AR845022
     C                     EXSR SUB02                                     S01119
     C**********           Z-ADDINTD      CALINT                                     S01119 AR845022
     C           INTDX     ADD  INTD      CALINT                                            AR845022
      *                                                                                     AR845022
      ** Store the total amount on a work variable field for the                            AR845022
      ** opposite side since floor rate is used                                             AR845022
      *                                                                                     AR845022
     C           FLRT      IFEQ 'Y'                                                         AR845022
     C           INTDX     ADD  INTD      STINTX                                            AR845022
     C                     ENDIF                                                            AR845022
     C*                                                                   S01119
      ** Move the amount to correct fields when floor rate is used.                         AR845022
      *                                                                                     AR845022
     C           STINTX    IFNE 0                                                           AR845022
     C           CALINX    ORNE 0                                                           AR845022
     C                     Z-ADDSTINTX    STINT                                             AR845022
     C                     Z-ADDCALINX    CALINT                                            AR845022
     C                     ENDIF                                                            AR845022
      *                                                                                     AR845022
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    AB SR: FRA/IRS PAY/RECEIVE INSTRUCTIONS                    *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           AB        BEGSR                                          S01119
     C/COPY WNCPYSRC,DL0279C039
      ** Initialise the deal Value Dates for both OUR and THEIR sides.                        CIR007
     C                     Z-ADD*ZERO     WOIUVD  50                                          CIR007
     C                     Z-ADD*ZERO     WOITVD  50                                          CIR007
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
      *                                                                   CSW005
     C                     Z-ADDUINOT     WUINT  150                      CSW005
     C                     Z-ADDTINOT     WTINT  150                      CSW005
      *                                                                   CSW005
     C           SETL      IFEQ 'B'                                       CSW005
     C                     TESTB'3'       TLXI       75                   CSW005
     C                     TESTB'4'       TLXI       76                   CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
      *  Our side already produced                                        CSW005
     C           *IN75     WHEQ *OFF                                      CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C                     MOVEL'R'       SETL                            CSW005
      *  Their side already produced                                      CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*OFF                                      CSW005
     C                     MOVEL'P'       SETL                            CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  For RSs, work net out amounts if necessary                      CSW005
      *                                                                   CSW005
     C           DTYP      IFEQ 'RS'                                      CSW005
     C           UEDAT     ANDEQTEDAT                                     CSW005
     C                     Z-ADD*ZEROS    NETAMT                          CSW005
     C                     TESTB'3'       TLXI       75                   CSW005
     C                     TESTB'4'       TLXI       76                   CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
      *  Our P/R already produced                                         CSW005
     C           *IN75     WHEQ *OFF                                      CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C                     MOVEL'R'       SETL                            CSW005
     C                     Z-ADDTINOT     NETAMT                          CSW005
     C                     Z-ADD*ZEROS    UINOT                           CSW005
      *  Their P/R already produced                                       CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*OFF                                      CSW005
     C                     MOVEL'P'       SETL                            CSW005
     C                     Z-ADDUINOT     NETAMT                          CSW005
     C                     Z-ADD*ZEROS    TINOT                           CSW005
      *  Both sides yet to be produced                                    CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C           UINOT     IFGE TINOT                                     CSW005
     C                     MOVE 'P'       SETL                            CSW005
     C           UINOT     SUB  TINOT     NETAMT                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVE 'R'       SETL                            CSW005
     C           TINOT     SUB  UINOT     NETAMT                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C                     MOVEA'0000'    *IN,75           *IN 75-78      S01119
     C                     MOVE *BLANKS   SETM    2                       S01119
     C                     Z-ADD0         TDNWD   50                      S01119
     C                     Z-ADD0         PIAMT  130                      S01119
     C                     Z-ADD0         RIAMT  130                      S01119
     C                     Z-ADD0         PRI1                            S01119
     C                     Z-ADD0         PRI2                            S01119
     C                     Z-ADD0         PRI3                            S01119
     C                     Z-ADD0         UFIR                            S01119
     C                     Z-ADD0         TFIR                            S01119
     C                     Z-ADD0         EVDAT                           S01119
     C                     Z-ADD0         TAXPY                           S01119
     C*                                                                   S01119
     C**  A PAYMENT EVENT IS DUE TO BE REPORTED IF                        S01119
     C**  1) THE ASSOCIATED TELEX INDICATOR IS OFF                        S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
     C                     TESTB'3'       TLXI       75                   S01119
      *                                                                                     AR923287
     C           *IN75     IFEQ '0'                                                         AR923287
     C           DTYP      IFEQ 'RX'                                                        AR923287
     C           DTYP      OREQ 'RS'                                                        AR923287
     C           UEDAT     ANDNETEDAT                                                       AR923287
     C           UAIAN     IFNE 0                                                           AR923287
     C                     MOVE '1'       *IN75                                             AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
     C           DTYP      IFEQ 'RS'                                                        AR923287
     C           UEDAT     ANDEQTEDAT                                                       AR923287
     C           UAIAN     IFNE 0                                                           AR923287
     C           TAIAN     ORNE 0                                                           AR923287
     C                     MOVE '1'       *IN75                                             AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
      *                                                                                     AR923287
     C                     MOVE PSETM     SETM                            S01119
     C                     Z-ADDUEDAT     PAYD                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C                     TESTB'4'       TLXI       75                   S01119
      *                                                                                     AR923287
     C           *IN75     IFEQ '0'                                                         AR923287
     C           DTYP      IFEQ 'RX'                                                        AR923287
     C           DTYP      OREQ 'RS'                                                        AR923287
     C           TEDAT     ANDNEUEDAT                                                       AR923287
     C           TAIAN     IFNE 0                                                           AR923287
     C                     MOVE '1'       *IN75                                             AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
     C           DTYP      IFEQ 'RS'                                                        AR923287
     C           TEDAT     ANDEQUEDAT                                                       AR923287
     C           TAIAN     IFNE 0                                                           AR923287
     C           UAIAN     ORNE 0                                                           AR923287
     C                     MOVE '1'       *IN75                                             AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
      *                                                                                     AR923287
     C                     MOVE RSETM     SETM                            S01119
     C                     Z-ADDTEDAT     PAYD                            S01119
     C                     END                                            S01119
      *                                                                   185166
      ** Test bit 4 of TLXI when SETL=B.                                  185166
      *                                                                   185166
     C           SETL      IFEQ 'B'                                       185166
     C                     TESTB'4'       TLXI           74               185166
      *                                                                                     AR923287
      ** Reset *IN74 when Their Int Adjustment is inserted                                  AR923287
      *                                                                                     AR923287
     C           DTYP      IFEQ 'RX'                                                        AR923287
     C           DTYP      OREQ 'RS'                                                        AR923287
     C           UEDAT     ANDNETEDAT                                                       AR923287
     C           TAIAN     IFNE 0                                                           AR923287
     C           *IN74     ANDEQ'1'                                                         AR923287
     C                     MOVE '0'       *IN74                                             AR923287
     C                     ENDIF                                                            AR923287
     C                     ENDIF                                                            AR923287
      *                                                                                     AR923287
     C                     ENDIF                                          185166
     C*                                                                   S01119
     C****2)*A*PAYMENT*AMOUNT*EXISTS*(NET*FOR*'RS'*MATCHED*'FR'*&* S01119 S01157
     C**  2) A PAYMENT AMOUNT EXISTS (NET FOR RS MATCHED FR,RR,RA & RF)   S01157
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP26                                           S01408
     C*                                                                   S01408
     C           DSANOT    ANDNE0                                         S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP27                                           S01408
     C*                                                                   S01408
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UINOT     IFNE 0                                         S01119
     C           TINOT     ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           NETAMT    ANDNE0                                         S01119
     C           DTYP      OREQ 'RP'                                      S01157
     C           NETAMT    ANDNE0                                         S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           NETAMT    ANDNE0                                         S01157
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           NETAMT    ANDNE0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           UINOT     IFNE 0                                         S01119
     C           TINOT     ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  3) THE EVENT DATE IS LESS THAN OR EQUAL TO DATE OF NEXT         S01119
     C**     WORKING DAY + NO. OF TELEX NOTICE DAYS.                      S01119
     C*                                                                   S01119
     C           SETM      IFEQ '01'                                      S01119
     C           SETM      OREQ '07'                                      S01119
     C           SETM      OREQ '08'                                      S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                         PAYMENT       S01119
     C           SETL      OREQ 'B'                                       S01119
     C           UEDAT     IFLE UTXDT                                     S01119
     C                     MOVE '1'       *IN77                           S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                         RECEIPT       S01119
     C           TEDAT     ANDLETTXDT                                     S01119
     C                     MOVE '1'       *IN77                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                            not 01,07,08   S01119
     C*                                                                   S01119
     C***********PAYD      IFLE LTXDT                LOCAL TELEX   S01119 S01117
     C           PAYD      IFLE TNDAL                       LOCAL TELEX   S01117
     C                     MOVE '1'       *IN77                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF EVENT TO BE REPORTED.                                        S01119
     C*                                                                   S01119
     C           *IN75     IFEQ '1'                                       S01119
     C           *IN76     ANDEQ'1'                                       S01119
     C           *IN77     ANDEQ'1'                                       S01119
     C*                                                                   S01119
     C**  IF CHIPS INTERFACE IS PRESENT AND EVENT IS CHIPS PAYMENT        S01119
     C**   THEN PROCESS ONLY, IF EVENT DATE *EQ DATE OF NEXT WRK DAY.     S01119
     C*                                                                   S01119
     C*****                TESTB'0'       CHIM           78       S01119  S01194
     C           BGCHDL    IFEQ 'Y'                        -IS PRESENT    S01194
     C                     SETON                     78                   S01194
     C                     END                                            S01194
     C*                                                                   S01119
     C           *IN78     IFEQ '1'                        CHIPS PRESENT  S01119
     C           SETM      ANDEQ'07'                                      S01119
     C*****      PAYD      ANDEQDNWD                              S01119  S01194
     C           PAYD      ANDEQBJDNWD                                    S01194
     C           *IN78     OREQ '1'                                       S01119
     C           SETM      ANDNE'07'                                      S01119
     C           *IN78     OREQ '0'                                       S01119
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
     C********************************************************S01119E19374E23886
     C****SET*ON*APPROPRIATE*TELEX*INDICATOR******************S01119E19374E23886
     C********************************************************S01119EI9374E23886
     C***********SETL******IFEQ*'P'***************************S01119EI9374E23886
     C***********SETL******OREQ*'B'***************************S01119EI9374E23886
     C*********************BITON'3'*******TLXI****************S01119EI9374E23886
     C*********************END********************************S01119EI9374E23886
     C***********SETL******IFEQ*'R'***************************S01119E19374E23886
     C*********************BITON'4'*******TLXI****************S01119E19374E23886
     C*********************END********************************S01119E19374E23886
     C*                                                                   E23886
     C**  SET ON APPROPRIATE TELEX INDICATOR                              E23886
     C*                                                                   E23886
     C           SETL      IFEQ 'P'                                       E23886
     C           SETL      OREQ 'B'                                       E23886
     C                     BITON'3'       TLXI                            E23886
     C                     END                                            E23886
     C           SETL      IFEQ 'R'                                       E23886
     C           SETL      OREQ 'B'                                                           CIR007
     C                     BITON'4'       TLXI                            E23886
     C                     END                                            E23886
     C*                                                                   S01119
     C**  CREATE A RECORD ON PF/DLINDDM IF EVENT DATE IS GREATER THAN     S01119
     C**  OR EQUAL TO THE RUN DATE                                        S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C056
     C*****      PAYD      IFGE RUND                              S01119  S01194
     C           PAYD      IFGE BJRDNB                                    S01194
     C*                                                                   S01119
     C**  SET UP ACTION CODE                                              S01119
     C*                                                                   S01119
     C                     MOVE 'I'       ACTC                            S01119
     C*                                                                   S01119
     C**  SET UP TAX PAYABLE FIELD                                        S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDINTX      TAXPY                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C                     Z-ADDTAXC      TAXPY                           S01119
     C/COPY WNCPYSRC,DL0279C015
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     Z-ADDCINTX     TAXPY                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****SET*UP*RECORD*FOR*'FR','RL'*DEAL*TYPES*                  S01119 S01157
     C**  SET UP RECORD FOR 'FR','RR','RP','RF' DEAL TYPES                S01157
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           SETL      IFEQ 'P'                                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDDSANOT    PIAMT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDNETAMT    PIAMT                           S01119
     C                     END                                            S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADD1         PRI3                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     EXCPTOUR                                       S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDDSANOT    RIAMT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDNETAMT    RIAMT                           S01119
     C                     END                                            S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADD1         PRI1                            S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     EXCPTTHEIR                                     S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RS' MATCHED DEAL RECORD                                 S01119
     C/COPY WNCPYSRC,DL0279C040
     C                     Z-ADD*ZERO     WOIUVD                                              CIR007
     C                     Z-ADD*ZERO     WOITVD                                              CIR007
      ** Save the original values of the event dates.                                         CIR007
     C                     Z-ADDUEDAT     WSAVUD  50                                          CIR007
     C                     Z-ADDTEDAT     WSAVTD  50                                          CIR007
     C           CIR007    IFEQ 'Y'                                                           CIR007
     C           DTYP      ANDEQ'RS'                                                          CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
     C           TICFR     OREQ 'O'                                                           CIR007
      ** If CEU003 is installed and payment currency is                                       CIR007
      ** not blank, use this currency to access the Currencies file                           CIR007
      ** instead of UCUCY                                                                     CIR007
     C           CEU003    IFEQ 'Y'                                                           CIR007
     C           PSCY      ANDNE*BLANKS                                                       CIR007
     C                     MOVE PSCY      PCCY    3                                           CIR007
     C                     ELSE                                                               CIR007
     C                     MOVE UCUCY     PCCY                                                CIR007
     C                     ENDIF                                                              CIR007
     C                     CALL 'AOCURRR0'                                                    CIR007
     C                     PARM *BLANKS   PRTCD                                               CIR007
     C                     PARM '*KEY   ' POPTN                                               CIR007
     C                     PARM           PCCY                                                CIR007
     C           SDCURR    PARM SDCURR    DSSDY                                               CIR007
     C           PRTCD     IFNE *BLANK                                                        CIR007
     C                     MOVEL'SDCURRPD'DBFILE                                              CIR007
     C                     MOVEL'021'     DBASE                                               CIR007
     C                     MOVELPCCY      DBKEY                                               CIR007
     C                     SETON                     U7U8LR                                   CIR007
     C                     EXSR *PSSR                                                         CIR007
     C                     ENDIF                                                              CIR007
      ***If*Settlement*Days*field*is*not*equal**to*zero,*then*either                   CIR007 204923
      ** If Settlement Days or Rate Fix Days Adjustment is not 0, then                        204923
      ** increase the Value Date of OUR, THEIR or BOTH side of the                            CIR007
      ** deal by the Settlement Days.                                                         CIR007
     C           A6SETD    IFNE 0                                                             CIR007
     C           A6FXDY    ORNE 0                                                             204923
     C           UEDAT     IFEQ TEDAT                                                         CIR007
     C                     MOVELUEDAT     ZDAYNO                                              CIR007
     C                     MOVELPCCY      ZCCY                                                CIR007
     C           A6SETD    IFNE 0                                                             204923
     C                     Z-ADDA6SETD    ZNRDYS                                              CIR007
     C                     ELSE                                                               204923
     C                     Z-ADDA6FXDY    ZNRDYS                                              204923
     C                     ENDIF                                                              204923
     C                     EXSR ZFWDT                                                         CIR007
     C                     MOVELZDYNBR    WOIUVD                                              CIR007
     C                     MOVELZDYNBR    WOITVD                                              CIR007
     C                     ENDIF                                                              CIR007
     C           UEDAT     IFNE TEDAT                                                         CIR007
     C           UICFR     IFEQ 'O'                                                           CIR007
     C           SETL      ANDEQ'P'                                                           CIR007
     C           UICFR     OREQ 'O'                                                           CIR007
     C           SETL      ANDEQ'B'                                                           CIR007
     C                     MOVELUEDAT     ZDAYNO                                              CIR007
     C                     MOVELPCCY      ZCCY                                                CIR007
     C           A6SETD    IFNE 0                                                             204923
     C                     Z-ADDA6SETD    ZNRDYS                                              CIR007
     C                     ELSE                                                               204923
     C                     Z-ADDA6FXDY    ZNRDYS                                              204923
     C                     ENDIF                                                              204923
     C                     EXSR ZFWDT                                                         CIR007
     C                     MOVELZDYNBR    WOIUVD                                              CIR007
     C                     ENDIF                                                              CIR007
     C           SETL      IFEQ 'R'                                                           CIR007
     C           TICFR     ANDEQ'O'                                                           CIR007
     C                     MOVELTEDAT     ZDAYNO                                              CIR007
     C                     MOVELPCCY      ZCCY                                                CIR007
     C           A6SETD    IFNE 0                                                             204923
     C                     Z-ADDA6SETD    ZNRDYS                                              CIR007
     C                     ELSE                                                               204923
     C                     Z-ADDA6FXDY    ZNRDYS                                              204923
     C                     ENDIF                                                              204923
     C                     EXSR ZFWDT                                                         CIR007
     C                     MOVELZDYNBR    WOITVD                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
      ** If the dates were advanced, we must also advance the event                           CIR007
      ** dates for the creation of DLINDDM records.                                           CIR007
     C           WOIUVD    IFNE *ZERO                                                         CIR007
     C                     Z-ADDWOIUVD    UEDAT                                               CIR007
     C                     ENDIF                                                              CIR007
     C           WOITVD    IFNE *ZERO                                                         CIR007
     C                     Z-ADDWOITVD    TEDAT                                               CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
      **********                                                                       232817 233128
     C**********           MOVE *BLANKS   SETL1   1                                    232817 233128
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           MOVE SETL      SETL1   1                                    232817 233128
     C**********           MOVE BAPR      SETL                                         232817 233128
     C**********           ENDIF                                                       232817 233128
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C*  Set on telex indicator for their side as well                    CSW005
     C                     BITON'4'       TLXI                            CSW005
      **********                                                                       232817 233128
      ***If*deal*was*bought*out,*SETL1*contains*value*of*original*SETL                 232817 233128
      ***IF*SETL1*is*'R',*set*on*telex*indicator*for*our*side*as*well.                 232817 233128
      **********                                                                       232817 233128
     C********** SETL1     IFEQ 'R'                                                    232817 233128
     C**********           BITON'3'       TLXI                                         232817 233128
     C**********           ENDIF                                                       232817 233128
      **********                                                                       232817 233128
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      PIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C                     Z-ADDNETAMT    PIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADD1         PRI3                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     EXCPTOUR                                       S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     ELSE                                           S01119
     C*  Set on telex indicator for our side as well                      CSW005
     C                     BITON'3'       TLXI                            CSW005
      **********                                                                       232817 233128
      ***If*deal*was*bought*out,*SETL1*contains*value*of*original*SETL                 232817 233128
      ***IF*SETL1*is*'P',*set*on*telex*indicator*for*their*side*as*well.               232817 233128
      **********                                                                       232817 233128
     C********** SETL1     IFEQ 'P'                                                    232817 233128
     C**********           BITON'4'       TLXI                                         232817 233128
     C**********           ENDIF                                                       232817 233128
      **********                                                                       232817 233128
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      RIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C                     Z-ADDNETAMT    RIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADD1         PRI1                            S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     EXCPTTHEIR                                     S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RS' UNMATCHED DEAL RECORDS                              S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           MOVE BAPR      SETL                                         232817 233128
     C**********           ENDIF                                                       232817 233128
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      PIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C                     Z-ADDUINOT     PIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
     C                     Z-ADD1         PRI3                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     EXCPTOUR                                       S01119
     C                     Z-ADD0         PIAMT                           S01119
     C                     Z-ADD0         UFIR                            S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C           SETL      OREQ 'B'                                                          BUG7094
0831 C           DLCT      ADD  1         DLCT                            S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      RIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C                     Z-ADDTINOT     RIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
     C           *IN74     IFEQ '0'                                                         AR923287
     C                     Z-ADD1         PRI1                            S01119
     C                     ENDIF                                                            AR923287
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     EXCPTTHEIR                                     S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C053
     C           CIR007    IFEQ 'Y'                                                           CIR007
      ** Restore original event dates.                                                        CIR007
     C                     MOVE 'N'       WJUMP   1                                           CIR007
     C                     Z-ADDWSAVUD    UEDAT                                               CIR007
     C                     Z-ADDWSAVTD    TEDAT                                               CIR007
      ** Update PF/DLOEVTPD (OIS Held Events) if the dates have                               CIR007
      ** been advanced, else, set 'bypass code' field.                                        CIR007
     C           WOIUVD    IFEQ UEDAT                                                         CIR007
     C           WOITVD    ANDEQTEDAT                                                         CIR007
     C                     MOVE 'Y'       WJUMP                                               CIR007
     C                     ENDIF                                                              CIR007
      ** Key list for DLOEVTPD.                                                               CIR007
     C           KEVNT     KLIST                                                              CIR007
     C                     KFLD           WDEAL   6                                           CIR007
     C                     KFLD           L4VDAT                                              CIR007
     C           WJUMP     IFEQ 'N'                                                           CIR007
      ** Build the key.                                                                       CIR007
     C                     MOVE DLNO      WDEAL                                               CIR007
     C           SETL      IFEQ 'P'                                                           CIR007
     C                     Z-ADDWOIUVD    L4VDAT                                              CIR007
     C                     ELSE                                                               CIR007
     C                     Z-ADDWOITVD    L4VDAT                                              CIR007
     C                     ENDIF                                                              CIR007
      ** Chain to the Held Event record.                                                      CIR007
     C           KEVNT     CHAINDLOEVTL2             90                                       CIR007
     C           *IN90     IFEQ '0'                                                           CIR007
      ** If a matched settlement                                                              CIR007
     C           UEDAT     IFEQ TEDAT                                                         CIR007
     C                     Z-ADDNETAMT    EAMT                                                CIR007
     C                     ENDIF                                                              CIR007
      ** If a non-matched settlement and our side is settling                                 CIR007
     C           UEDAT     IFNE TEDAT                                                         CIR007
     C           SETL      IFEQ 'P'                                                           CIR007
     C                     Z-ADDUINOT     EAMT                                                CIR007
     C                     ENDIF                                                              CIR007
      ** If a non-matched settlement and their side is settling                               CIR007
     C           SETL      IFEQ 'R'                                                           CIR007
     C                     Z-ADDTINOT     EAMT                                                CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C           PSCY      IFEQ *BLANKS                                                       CIR007
      ** Update the record                                                                    CIR007
     C                     UPDATDLOEVTD0                                                      CIR007
     C                     ELSE                                                               CIR007
     C                     Z-ADDEAMT      WEAMT  130                                          CIR007
     C                     MOVE UCUCY     P@FRCY                                              CIR007
     C                     MOVE PSCY      P@TOCY                                              CIR007
     C                     Z-ADDWEAMT     P@FRAM                                              CIR007
     C                     EXSR SRCONV                                                        CIR007
     C                     Z-ADDP@OUTA    WOTHA  130                                          CIR007
     C           *IN74     DOWEQ'0'                                                           CIR007
     C           ECCY      IFEQ UCUCY                                                         CIR007
     C                     Z-ADDWEAMT     EAMT                                                CIR007
     C                     ENDIF                                                              CIR007
     C           ECCY      IFEQ PSCY                                                          CIR007
     C                     Z-ADDWOTHA     EAMT                                                CIR007
     C                     ENDIF                                                              CIR007
     C           OTHC      IFEQ UCUCY                                                         CIR007
     C                     Z-ADDWEAMT     OTHA                                                CIR007
     C                     ENDIF                                                              CIR007
     C           OTHC      IFEQ PSCY                                                          CIR007
     C                     Z-ADDWOTHA     OTHA                                                CIR007
     C                     ENDIF                                                              CIR007
      ** Update the record                                                                    CIR007
     C                     UPDATDLOEVTD0                                                      CIR007
     C           KEVNT     READEDLOEVTL2                 74                                   CIR007
     C                     ENDDO                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C                     ENDIF                                                              CIR007
     C*                                                                   S01119
     C**  SET UP 'RX' MATCHED DEAL RECORD                                 S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           UTXDT     ANDEQTTXDT                                                       AR923287
     C           SETL      ANDEQ'B'                                       S01119
     C                     Z-ADDUINOT     PIAMT                           S01119
     C                     Z-ADDTINOT     RIAMT                           S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C           *IN74     IFEQ '0'                                       185166
     C                     Z-ADD1         PRI1                            S01119
     C                     ENDIF                                          185166
     C                     Z-ADD1         PRI3                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C********** BAPR      IFEQ 'P'                                                    232817 233128
     C**********           Z-ADDBOAM      PIAMT                                        232817 233128
     C**********           Z-ADD0         RIAMT                                        232817 233128
     C**********           Z-ADD1         PRI3                                         232817 233128
     C**********           Z-ADD0         PRI1                                         232817 233128
     C**********           ELSE                                                        232817 233128
     C**********           Z-ADDBOAM      RIAMT                                        232817 233128
     C**********           Z-ADD0         PIAMT                                        232817 233128
     C**********           Z-ADD1         PRI1                                         232817 233128
     C**********           Z-ADD0         PRI3                                         232817 233128
     C**********           ENDIF                                                       232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     EXCPTBOTH                                      S01119
      ** Set their side pay/rec indicator as well to prevent              CSW005
      ** extra record from being output to DLINDDM.                       CSW005
     C           SETL      IFEQ 'B'                                       CSW005
     C                     BITON'4'       TLXI                            CSW005
     C                     ENDIF                                          CSW005
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RX' UNMATCHED DEAL RECORDS                              S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           DTYP      OREQ 'RX'                                      185166
     C           UEDAT     ANDEQTEDAT                                     185166
     C           UTXDT     ANDNETTXDT                                     185166
     C           DTYP      OREQ 'RX'                                      185166
     C           UEDAT     ANDEQTEDAT                                     185166
     C           UTXDT     ANDEQTTXDT                                     185166
     C           SETL      ANDEQ'P'                                       185166
     C           DTYP      OREQ 'RX'                                      185166
     C           UEDAT     ANDEQTEDAT                                     185166
     C           UTXDT     ANDEQTTXDT                                     185166
     C           SETL      ANDEQ'R'                                       185166
     C           CSW005    OREQ 'Y'                                       CSW005
     C           DTYP      ANDEQ'RX'                                      CSW005
     C           SETL      ANDNE'B'                                       CSW005
     C           UEDAT     ANDEQTEDAT                                     CSW005
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           MOVE BAPR      SETL                                         232817 233128
     C**********           ENDIF                                                       232817 233128
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      PIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C                     Z-ADDUINOT     PIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADD1         PRI3                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     EXCPTOUR                                       S01119
     C                     Z-ADD0         PIAMT                           S01119
     C                     Z-ADD0         UFIR                            S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C********** *IN55     IFEQ '1'                                                    232817 233128
     C**********           Z-ADDBOAM      RIAMT                                        232817 233128
     C**********           ELSE                                                        232817 233128
     C           SETL      OREQ 'B'                                                          BUG7094
     C                     Z-ADDTINOT     RIAMT                           S01119
     C**********           ENDIF                                                       232817 233128
0831 C           DLCT      ADD  1         DLCT                            S01119
     C           *IN74     IFEQ '0'                                                         AR923287
     C                     Z-ADD1         PRI1                            S01119
     C                     ENDIF                                                            AR923287
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     EXCPTTHEIR                                     S01119
     C********** BOVD      IFLE MGDAL                                                  232817 233128
     C********** BOVD      ANDNE0                                                      232817 233128
     C********** *IN55     ANDEQ'0'                                                    232817 233128
     C**********           EXSR SRBUY                                                  232817 233128
     C**********           ENDIF                                                       232817 233128
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C057
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           CSW005    IFEQ 'Y'                                       CSW005
     C                     Z-ADDWUINT     UINOT                           CSW005
     C                     Z-ADDWTINT     TINOT                           CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    BC SR: INTEREST PAYMENT CONFIRMATIONS                      *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS :                                                    *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C**  THE FOLLOWING CONDITIONS MUST BE SATISFIED FOR EACH             S01119
     C**  PAYMENT OR RECEIVE CONFIRMATION TO BE PRODUCED                  S01119
     C*                                                                   S01119
     C**  1) MATURITY CONFIRMATIONS REQUIRED INDICATOR = Y                S01119
     C**  2) NON 'FR' DEALS START/LAST INT DATE MUST BE LESS THAN OR      S01119
     C**     EQUAL TO RUN DATE MINUS MATURITY CONF. ELAPSED WORK DAYS     S01119
     C**  3) EVENT DATE MUST BE EQUAL OR LESS THAN                        S01119
     C**     RUN DATE PLUS MATURITY CONFIRMATIONS TO GO WORKING DAYS      S01119
     C*                                                                   S01119
     C**  ABOVE CONDITIONS (1 TO 3) DETERMINED BEFORE ENTRY.              S01119
     C*                                                                   S01119
     C           BC        BEGSR                                          S01119
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C                     MOVELSESETL    SETL                            CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           SETL      ANDEQ'B'                                       CSW005
     C                     TESTB'2'       CNFI       75                   CSW005
     C                     TESTB'3'       CNFI       76                   CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
      *  Our side already produced                                        CSW005
     C           *IN75     WHEQ *OFF                                      CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C                     MOVEL'R'       SETL                            CSW005
      *  Their side already produced                                      CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*OFF                                      CSW005
     C                     MOVEL'P'       SETL                            CSW005
     C                     ENDSL                                          CSW005
      *                                                                   CSW005
     C                     ENDIF                                          CSW005
      *                                                                   CSW005
      **  For RSs with equal event dates, net out amounts if necessary    CSW005
      **  (as one side might have been already produced in I/C.           CSW005
      *                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           DTYP      ANDEQ'RS'                                      CSW005
     C           UEDAT     ANDEQTEDAT                                     CSW005
     C                     Z-ADD*ZEROS    NETAMT                          CSW005
     C                     TESTB'2'       CNFI       75                   CSW005
     C                     TESTB'3'       CNFI       76                   CSW005
     C*                                                                   CSW005
     C                     SELEC                                          CSW005
      *  Our side already produced                                        CSW005
     C           *IN75     WHEQ *OFF                                      CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C                     MOVEL'R'       SETL                            CSW005
     C                     Z-ADDTINOT     NETAMT                          CSW005
     C                     Z-ADD*ZEROS    UINOT                           CSW005
      *  Their side already produced                                      CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*OFF                                      CSW005
     C                     MOVEL'P'       SETL                            CSW005
     C                     Z-ADDUINOT     NETAMT                          CSW005
     C                     Z-ADD*ZEROS    TINOT                           CSW005
      *  Both sides yet to be produced                                    CSW005
     C           *IN75     WHEQ *ON                                       CSW005
     C           *IN76     ANDEQ*ON                                       CSW005
     C           UINOT     IFGE TINOT                                     CSW005
     C                     MOVE 'P'       SETL                            CSW005
     C           UINOT     SUB  TINOT     NETAMT                          CSW005
     C                     ELSE                                           CSW005
     C                     MOVE 'R'       SETL                            CSW005
     C           TINOT     SUB  UINOT     NETAMT                          CSW005
     C                     ENDIF                                          CSW005
     C                     ENDSL                                          CSW005
     C*                                                                   CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01119
     C**  DEFINE FIELDS FOR SUBROUTINE                                    S01119
     C*                                                                   S01119
     C                     MOVEA'00'      *IN,75           *IN 75 & 76    S01119
     C                     MOVE *OFF      *IN87                           CSW005
     C                     MOVE *BLANKS   CNRQ    1                       S01119
     C                     Z-ADD0         MCDAT   50                      S01119
     C                     Z-ADD0         DATE    50                      S01119
     C                     Z-ADD0         DATE1   50                      S01119
     C                     Z-ADD0         UFIR   117                      S01119
     C                     Z-ADD0         EVDAT   50                      S01119
     C                     Z-ADD0         TFIR   117                      S01119
     C*                                                                   S01119
     C**  PAYMENT CONFIRMATIONS                                           S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
     C*                                                                   S01119
     C**  POINTS 1) 2) 3) ,  SEE ABOVE 'BEGSR'                            S01119
     C**  4) THE APPROPRIATE INTEREST CONFIRMATIION IND = 'OFF'           S01119
     C*                                                                   S01119
     C                     TESTB'2'       CNFI       75                   S01119
     C*                                                                   S01119
     C**  5) THE INTEREST AMOUNT CALCULATED BEFORE MUST BE NON-ZERO       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP24                                           S01408
     C*                                                                   S01408
     C           SZDSA     ANDNE0                                         S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP25                                           S01408
     C*                                                                   S01408
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UINTR     ANDNE0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           STINT     IFNE 0                                         S01119
     C           CALINT    ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           UINTR     IFNE 0                                         S01119
     C           TINTR     ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           UINTR     ANDNE0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF CONFIRMATION TO BE PRODUCED                                  S01119
     C**  SET ON APPROPRIATE CONFIRMATION INDICATOR                       S01119
     C*                                                                   S01119
     C           *IN75     IFEQ '1'                                       S01119
     C           *IN76     ANDEQ'1'                                       S01119
     C                     SETON                     87                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C/SPACE 2                                                            S01119
     C**  INTEREST RECEIPT CONFIRMATIONS                                  S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C*                                                                   S01119
     C**  POINTS 1) 2) 3) ,  SEE ABOVE 'BEGSR'                            S01119
     C**  4) THE APPROPRIATE INTEREST CONFIRMATIION IND = 'OFF'           S01119
     C*                                                                   S01119
     C                     TESTB'3'       CNFI       75                   S01119
     C*                                                                   S01119
     C**  5) THE INTEREST AMOUNT CALCULATED BEFORE MUST BE NON-ZERO       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP26                                           S01408
     C*                                                                   S01408
     C           DSANOT    ANDNE0                                         S01119
     C*                                                                   S01408
     C/COPY WNCPYSRC,DL0279CP27                                           S01408
     C*                                                                   S01408
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           TINTR     ANDNE0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C           STINT     IFNE 0                                         S01119
     C           CALINT    ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           UINTR     IFNE 0                                         S01119
     C           TINTR     ORNE 0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           TINTR     ANDNE0                                         S01119
     C                     SETON                     76                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF CONFIRMATION TO BE PRODUCED                                  S01119
     C**  SET ON APPROPRIATE CONFIRMATION INDICATOR                       S01119
     C*                                                                   S01119
     C           *IN75     IFEQ '1'                                       S01119
     C           *IN76     ANDEQ'1'                                       S01119
     C                     SETON                     87                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********                                                         S01119
     C*                                                                   S01119
     C           *IN87     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'3'       UDNSI          86               S01119
     C                     ELSE                                           S01119
     C                     TESTB'3'       TDNSI          86               S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           *IN86     IFEQ '1'                                       S01119
     C                     MOVE 'A'       ACTC                            S01119
     C                     ELSE                                           S01119
     C                     MOVE 'I'       ACTC                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP TAX PAYABLE FIELD & INTEREST RATES                       S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDINTX      TAXPY                           S01119
     C                     Z-ADDUEINR     UFIR                            S01119
     C                     Z-ADDTEINR     TFIR                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           DTYP      OREQ 'RX'                                      S01119
     C                     Z-ADDTAXC      TAXPY                           S01119
     C/COPY WNCPYSRC,DL0279C037
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     Z-ADDCINTX     TAXPY                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C****SET*UP*OF*'FR'*&*'RL'*RECORDS*                           S01119 S01157
     C**  SET UP OF 'FR', 'RR', 'RP' & 'RF' RECORDS                       S01157
     C**  (OUTPUT MADE ONLY IF EVENT DATE *GE RUN DATE)                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C***********DTYP      OREQ 'RL'                               S01119 S01157
     C           DTYP      OREQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C                     MOVE 'E'       CNRQ                            S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDDSANOT    PIAMT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDNETAMT    PIAMT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     MOVE UEDAT     EVDAT                           S01119
     C                     BITON'2'       CNFI                            S01119
     C*                                                                   S01157
     C** UDNSI & TDNSI bit 3 should be set according to whether our or    S01157
     C** their side is floating and bit 2 or 3 of CNFI being on           S01157
     C*                                                                   S01157
     C********** UBRTT     IFGT 0                                                      S01157 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     BITOF'3'       UDNSI                           S01119
     C                     ELSE                                           S01157
     C                     BITOF'3'       TDNSI                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C058
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTOUR                                       S01119
     C/COPY WNCPYSRC,DL0279C059
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C                     MOVE 'G'       CNRQ                            S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C                     Z-ADDDSANOT    RIAMT                           S01119
     C                     ELSE                                           S01119
     C                     Z-ADDNETAMT    RIAMT                           S01119
     C                     END                                            S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     BITON'3'       CNFI                            S01119
     C*                                                                   S01157
     C** UDNSI & TDNSI bit 3 should be set according to whether our or    S01157
     C** their side is floating and bit 2 or 3 of CNFI being on           S01157
     C*                                                                   S01157
     C********** UBRTT     IFGT 0                                                      S01157 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*********************BITOF'3'       TDNSI                     S01119S01157
     C                     BITOF'3'       UDNSI                           S01157
     C                     ELSE                                           S01157
     C                     BITOF'3'       TDNSI                           S01157
     C                     END                                            S01157
     C*                                                                   S01157
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C060
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTTHEIR                                     S01119
     C/COPY WNCPYSRC,DL0279C061
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RS' MATCHED RECORD                                      S01119
     C**  (OUTPUT MADE ONLY IF EVENT DATE *GE RUN DATE)                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C                     Z-ADDUINOT     PIAMT                           S01119
     C                     Z-ADDTINOT     RIAMT                           S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'P'                                       S01119
     C                     MOVE 'E'       CNRQ                            S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     BITON'23'      CNFI                            S01119
     C                     BITOF'3'       UDNSI                           S01119
     C                     BITOF'3'       TDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C062
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTBOTH                                      S01119
     C/COPY WNCPYSRC,DL0279C063
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C                     MOVE 'G'       CNRQ                            S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     BITON'23'      CNFI                            S01119
     C                     BITOF'3'       UDNSI                           S01119
     C                     BITOF'3'       TDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C064
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTBOTH                                      S01119
     C/COPY WNCPYSRC,DL0279C065
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RS' UNMATCHED DEAL RECORDS                              S01119
     C**  (OUTPUT MADE ONLY IF EVENT DATE *GE RUN DATE)                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
     C                     MOVE 'E'       CNRQ                            S01119
     C                     Z-ADDUINOT     PIAMT                           S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     BITON'2'       CNFI                            S01119
     C                     BITOF'3'       UDNSI                           S01119
     C*                                                                   S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C066
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTOUR                                       S01119
     C/COPY WNCPYSRC,DL0279C067
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C                     MOVE 'G'       CNRQ                            S01119
     C                     Z-ADDTINOT     RIAMT                           S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     BITON'3'       CNFI                            S01119
     C                     BITOF'3'       TDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C068
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTTHEIR                                     S01119
     C/COPY WNCPYSRC,DL0279C069
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RX' MATCHED DEAL RECORD                                 S01119
     C**  (OUTPUT MADE ONLY IF EVENT DATE *GE RUN DATE)                   S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C016
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           SETL      ANDEQ'B'                                       S01119
     C                     MOVE 'J'       CNRQ                            S01119
     C                     Z-ADDUINOT     PIAMT                           S01119
     C                     Z-ADDTINOT     RIAMT                           S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     BITON'2'       CNFI                            S01119
     C                     BITON'3'       CNFI                            S01119
     C                     BITOF'3'       UDNSI                           S01119
     C                     BITOF'3'       TDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C070
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTBOTH                                      S01119
     C/COPY WNCPYSRC,DL0279C071
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RX' UNMATCHED DEAL RECORDS                              S01119
     C**  (OUTPUT MADE ONLY IF EVENT DATE *GE RUN DATE)                   S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C           UEDAT     ANDNETEDAT                                     S01119
     C           CSW005    OREQ 'Y'                                       S01119
     C           DTYP      ANDEQ'RX'                                      S01119
     C           SETL      ANDNE'B'                                       S01119
     C           UEDAT     ANDEQTEDAT                                     S01119
     C           SETL      IFEQ 'P'                                       S01119
     C           SETL      OREQ 'B'                                       S01119
     C                     MOVE 'E'       CNRQ                            S01119
     C                     Z-ADDUINOT     PIAMT                           S01119
     C                     Z-ADDUEDAT     EVDAT                           S01119
     C                     BITON'2'       CNFI                            S01119
     C                     BITOF'3'       UDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C072
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTOUR                                       S01119
     C/COPY WNCPYSRC,DL0279C073
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           SETL      IFEQ 'R'                                       S01119
     C                     MOVE 'G'       CNRQ                            S01119
     C                     Z-ADDTINOT     RIAMT                           S01119
     C                     Z-ADDTEDAT     EVDAT                           S01119
     C                     BITON'3'       CNFI                            S01119
     C                     BITOF'3'       TDNSI                           S01119
     C*****      EVDAT     IFGE RUND                              S01119  S01194
     C           EVDAT     IFGE BJRDNB                                    S01194
     C/COPY WNCPYSRC,DL0279C074
     C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTTHEIR                                     S01119
     C/COPY WNCPYSRC,DL0279C075
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           CSW005    IFEQ 'Y'                                       CSW005
     C                     MOVELSESETL    SETL                            CSW005
     C                     ENDIF                                          CSW005
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                               *   S01119
     C*    BD SR: INTEREST FIX CONFIRMATIONS                          *   S01119
     C*                                                               *   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*                                                               *   S01119
     C*    CALLS : SUB01U, SUB01T                                     *   S01119
     C*                                                               *   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           BD        BEGSR                                          S01119
      *                                                                   CIR001
      ** If CIR001 is on and the deal is a swap paying interest           CIR001
      **   up-front, check whether the rate was fixed in input cycle.     CIR001
      **   If so, do not perform any further rate fixing here.            CIR001
      *                                                                   CIR001
     C                     SETOF                     8485                 CIR001
     C           CIR001    IFEQ 'Y'                                       CIR001
     C           CSW005    ANDNE'Y'                                       CSW005
      *                                                                   CIR001
     C           DTYP      IFEQ 'RS'                                      CIR001
     C           DTYP      OREQ 'RX'                                      CIR001
      *                                                                   CIR001
     C           UINPM     IFEQ 'D'                                       CIR001
     C           UINFD     ANDLTBJDNWD                                    CIR001
     C           UINPM     OREQ 'Y'                                       CIR001
     C           UINFD     ANDLTBJDNWD                                    CIR001
     C                     TESTB'4'       CNFI           84               CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           TINPM     IFEQ 'D'                                       CIR001
     C           TINFD     ANDLTBJDNWD                                    CIR001
     C           TINPM     OREQ 'Y'                                       CIR001
     C           TINFD     ANDLTBJDNWD                                    CIR001
     C                     TESTB'5'       CNFI           85               CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
      ** It is possible that a rate fix advice has been produced          177837
      ** yesterday therefore Bit4 of CNFI has not been reset yet.         177837
      ** Set it off here to allow output for next period but only         177837
      ** but only if the rate has not been fixed in input cycle.          177837
     C           CSW005    IFEQ 'Y'                                       177837
     C           UINFD     IFLT BJDNWD                                    177837
     C           URFIN     ANDEQ*BLANK                                    177837
     C                     BITOF'4'       CNFI                            177837
     C                     ENDIF                                          177837
     C           TINFD     IFLT BJDNWD                                    177837
     C           TRFIN     ANDEQ*BLANK                                    177837
     C                     BITOF'5'       CNFI                            177837
     C                     ENDIF                                          177837
     C                     ENDIF                                          177837
      *                                                                   177837
     C           CSW005    IFEQ 'Y'                                       CSW005
      *                                                                   CSW005
     C********** UINFD     IFLT BJDNWD                                                 CSW005 193160
     C                     TESTB'4'       CNFI           84               CSW005
     C**********           END                                                         CSW005 193160
     C********** TINFD     IFLT BJDNWD                                                 CSW005 193160
     C                     TESTB'5'       CNFI           85               CSW005
     C**********           END                                                         CSW005 193160
      *                                                                   CSW005
     C                     END                                            CSW005
     C/COPY WNCPYSRC,DL0279C028
     C*                                                                   S01119
     C                     Z-ADD0         TAXPY                           S01119
     C                     Z-ADD0         PIAMT                           S01119
     C                     Z-ADD0         RIAMT                           S01119
     C                     Z-ADD0         UFIR                            S01119
     C                     Z-ADD0         TFIR                            S01119
     C                     BITOF'45'      CNFI                            S01119
     C                     MOVE ' '       PRTX    1                       S01119
     C                     Z-ADD0         EVDAT                           S01119
     C                     MOVEL*BLANKS   WOUR    1                                           227642
     C                     MOVEL*BLANKS   WTHEIR  1                                           227642
     C*                                                                   S01119
     C**  A RATE FIX CONFIRMATION IS DUE IF THE RATE FIX DATE IS          S01119
     C**  BEFORE THE DATE OF NEXT WORKING DAY THEN OBTAIN NEW FIXED       S01119
     C**  RATE VIA SR:SUB01 AND SET ON RELEVANT RATE FIX CONF. IND        S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C*****      UINFD     ANDLTDNWD                              S01119  S01194
     C           UINFD     ANDLTBJDNWD                                    S01194
     C           UINFD     ANDNE0                                         S01119
     C********** *IN84     ANDEQ'0'                                                    CIR001 227642
      *                                                                                       227642
      ** If int fixing is due, check if short term rate was amended in                        227642
      ** I/C.  If RTFX was not taken, need to produce an MT362 if STR                         227642
      ** was amended, or newly inserted for a backvalued swap.                                227642
      *                                                                                       227642
     C                     TESTB'0'       UDNSI          01                                   227642
     C                     TESTB'2'       UDNSI          02                                   227642
      *                                                                                       227642
     C           *IN01     IFEQ '1'                                                           227642
     C           *IN02     OREQ '1'                                                           227642
     C           URFIN     IFEQ *BLANK                                                        227642
     C           VDAT      ANDLTBJRDNB                                                        227642
     C           ORED      ANDEQBJRDNB                                                      BUG11267
     C           URFIN     OREQ 'B'                                                           227642
     C           VDAT      ANDLTBJRDNB                                                        227642
      *                                                                                       227642
     C                     Z-ADDUEINR     UFIR                                                227642
     C                     BITON'4'       CNFI                                                227642
     C                     MOVEL'U'       PRTX                                                227642
      *                                                                                       227642
      ** Rate fixing indicator is 'B' when base rate is fixed in I/C, then                    227642
      ** short term rate was amended, and RTFX was not taken.  Generate an                    227642
      ** MT362 for current period in this case.                                               227642
      *                                                                                       227642
     C           URFIN     IFEQ 'B'                                                           227642
     C                     MOVEL'Y'       WOUR                                                227642
     C                     ENDIF                                                              227642
      *                                                                                       227642
      ** Only when rate fixing was not taken in I/C should an additional                      227642
      ** record be written to DLINDDM.                                                        227642
      *                                                                                       227642
     C           URFIN     IFEQ *BLANK                                                        227642
     C                     MOVE 'D'       CNRQ                                                227642
     C                     MOVE 'I'       ACTC                                                227642
     C           DLCT      ADD  1         DLCT                                                227642
     C                     Z-ADDUSLIP     EVDAT                                               227642
     C                     EXCPTOUR                                                           227642
     C                     END                                                                227642
      *                                                                                       227642
     C                     END                                                                227642
     C                     END                                                                227642
      *                                                                                       227642
      ** Produce MT362 with base rate for UNICD to next UNICD if rate fix advice              227642
      ** not yet produced.  OR produce MT362 if a rate fix advice was generated               227642
      ** during I/C if it was for short term rate amendment for a valued swap &               227642
      ** RTFX was taken in I/C.  In this case MT362 needs to be generated for                 227642
      ** the new base rate for the next period.                                               227642
      *                                                                                       227642
     C           *IN84     IFEQ '0'                                                           227642
     C           *IN84     OREQ '1'                                                           227642
     C           URFIN     ANDEQ'A'                                                           227642
     C           *IN02     ANDEQ'1'                                                           227642
     C           VDAT      ANDLTBJRDNB                                                        227642
      *                                                                                       227642
     C                     EXSR SUB01U                                    S01119
      *                                                                                      BUG7543
      ** Our Start Stub Date processing for CDL028                                           BUG7543
      *                                                                                      BUG7543
     C           UNICD     IFEQ FSOSDT                                                       BUG7543
     C           INFD      ANDLEVDAT                                                         BUG7543
      *                                                                                      BUG7543
     C           FSOSDT    IFNE *ZERO                                                        BUG7543
     C********** FSOS1B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSOS1B    ANDNE*BLANKS                                                       CSD103
     C           FSOS1D    ANDNE*ZERO                                                        BUG7543
     C********** FSOS2B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSOS2B    ANDNE*BLANKS                                                       CSD103
     C           FSOS2D    ANDNE*ZERO                                                        BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDUINFD     WINFD   50                                         BUG7543
     C                     MOVE UCUCY     WCCY1   3                                          BUG7543
     C                     MOVE USPIN     WSPIN1  1                                          BUG7543
     C                     Z-ADDURTSP     WRTSP1 117                                         BUG7543
      *                                                                                      BUG7543
     C**********           Z-ADDFSOS1B    WS1B    20                                  BUG7543 CSD103
     C                     MOVE FSOS1B    WS1B    2                                           CSD103
     C                     Z-ADDFSOS1D    WS1D    50                                         BUG7543
     C**********           Z-ADDFSOS2B    WS2B    20                                  BUG7543 CSD103
     C                     MOVE FSOS2B    WS2B    2                                           CSD103
     C                     Z-ADDFSOS2D    WS2D    50                                         BUG7543
     C                     Z-ADDFSOSDT    WMD1    50                                         BUG7543
     C                     Z-ADDFSOS1D    WMD2    50                                         BUG7543
      *                                                                                      BUG7543
     C                     EXSR INTRTE                                                       BUG7543
      *                                                                                      BUG7543
     C                     ENDIF                                                             BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
      ** Our End Stub Date processing for CDL028                                             BUG7543
      *                                                                                      BUG7543
     C           UNICD     IFEQ FSOEDT                                                       BUG7543
     C           BJRDNB    ANDGTVDAT                                                         BUG7543
      *                                                                                      BUG7543
     C           FSOEDT    IFNE *ZERO                                                        BUG7543
     C********** FSOE1B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSOE1B    ANDNE*BLANKS                                                       CSD103
     C           FSOE1D    ANDNE*ZERO                                                        BUG7543
     C********** FSOE2B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSOE2B    ANDNE*BLANKS                                                       CSD103
     C           FSOE2D    ANDNE*ZERO                                                        BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDUINFD     WINFD                                              BUG7543
     C                     MOVE UCUCY     WCCY1                                              BUG7543
     C                     MOVE USPIN     WSPIN1                                             BUG7543
     C                     Z-ADDURTSP     WRTSP1                                             BUG7543
      *                                                                                      BUG7543
     C**********           Z-ADDFSOE1B    WS1B                                        BUG7543 CSD103
     C                     MOVE FSOE1B    WS1B                                                CSD103
     C                     Z-ADDFSOE1D    WS1D                                               BUG7543
     C**********           Z-ADDFSOE2B    WS2B                                        BUG7543 CSD103
     C                     MOVE FSOE2B    WS2B                                                CSD103
     C                     Z-ADDFSOE2D    WS2D                                               BUG7543
     C                     Z-ADDMDAT      WMD1                                               BUG7543
     C                     Z-ADDFSOE1D    WMD2                                               BUG7543
      *                                                                                      BUG7543
     C                     EXSR INTRTE                                                       BUG7543
      *                                                                                      BUG7543
     C                     ENDIF                                                             BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDRATE      UFIR                            S01119
      *                                                                   177837
      ** Update Base rate here for use by Rate Fix Advice MT362           177837
      ** Message Generation. (Note that this will be updated again        177837
      ** in DL0280 but no harm will be done as the information will       177837
      ** the same.                                                        177837
     C           CSW005    IFEQ 'Y'                                       177837
     C           URFIN     ANDEQ*BLANKS                                   177837
     C                     Z-ADDBBRTE     UBRTE                           177837
     C                     MOVE *ON       *IN21                                               177837
     C                     ENDIF                                          177837
      *                                                                                       227642
      ** Rate fixing indicator is 'A' when short term rate was amended                        227642
      ** but base rate not yet picked up during I/C.                                          227642
      *                                                                                       227642
     C           CSW005    IFEQ 'Y'                                                           227642
     C           URFIN     ANDEQ'A'                                                           227642
     C                     Z-ADDBBRTE     UBRTE                                               227642
     C                     ENDIF                                                              227642
      *                                                                   177837
     C                     BITON'4'       CNFI                            S01119
     C                     MOVEL'U'       PRTX                            S01119
      *                                                                                       227642
      ** If this is for the first rate fix date (prior to value date)                         227642
      ** use value date or USLIP as start date.                                               227642
      *                                                                                       227642
     C           UINFD     IFLE VDAT                                                          227642
     C                     MOVEL'Y'       WOUR                                                227642
     C                     END                                                                227642
      *                                                                                       227642
     C                     END                                                                227642
     C                     END                                            S01119
     C*                                                                   S01119
     C********** TBRTT     IFNE 0                                                      S01119 CSD103
     C           TBRTT     IFNE *BLANKS                                                       CSD103
     C*****      TINFD     ANDLTDNWD                              S01119  S01194
     C           TINFD     ANDLTBJDNWD                                    S01194
     C           TINFD     ANDNE0                                         S01119
     C********** *IN85     ANDEQ'0'                                                    CIR001 227642
      *                                                                                       227642
      ** If int fixing is due, check if short term rate was amended in                        227642
      ** I/C.  If RTFX was not taken, need to produce an MT362 if STR                         227642
      ** was amended, or newly inserted for a backvalued swap.                                227642
      *                                                                                       227642
     C                     TESTB'0'       TDNSI          01                                   227642
     C                     TESTB'2'       TDNSI          02                                   227642
      *                                                                                       227642
     C           *IN01     IFEQ '1'                                                           227642
     C           *IN02     OREQ '1'                                                           227642
     C           TRFIN     IFEQ *BLANK                                                        227642
     C           VDAT      ANDLTBJRDNB                                                        227642
     C           ORED      ANDEQBJRDNB                                                      BUG11267
     C           TRFIN     OREQ 'B'                                                           227642
     C           VDAT      ANDLTBJRDNB                                                        227642
      *                                                                                       227642
     C                     Z-ADDTEINR     TFIR                                                227642
     C                     BITON'5'       CNFI                                                227642
     C                     MOVEL'T'       PRTX                                                227642
      *                                                                                       227642
      ** Rate fixing indicator is 'B' when base rate is fixed in I/C, then                    227642
      ** short term rate was amended, and RTFX was not taken.  Generate an                    227642
      ** MT362 for current period in this case.                                               227642
      *                                                                                       227642
     C           TRFIN     IFEQ 'B'                                                           227642
     C                     MOVEL'Y'       WTHEIR                                              227642
     C                     ENDIF                                                              227642
      *                                                                                       227642
      ** Only when rate fixing was not taken in I/C should an additional                      227642
      ** record be written to DLINDDM.                                                        227642
      *                                                                                       227642
     C           TRFIN     IFEQ *BLANK                                                        227642
     C                     MOVE 'F'       CNRQ                                                227642
     C                     MOVE 'I'       ACTC                                                227642
     C           DLCT      ADD  1         DLCT                                                227642
     C                     Z-ADDTSLIP     EVDAT                                               227642
     C                     EXCPTTHEIR                                                         227642
     C                     END                                                                227642
      *                                                                                       227642
     C                     END                                                                227642
     C                     END                                                                227642
      *                                                                                       227642
      ** Produce MT362 with base rate for TNICD to next TNICD if rate fix advice              227642
      ** not yet produced.  OR produce MT362 if a rate fix advice was generated               227642
      ** during I/C if it was for short term rate amendment for a valued swap &               227642
      ** RTFX was taken in I/C.  In this case MT362 needs to be generated for                 227642
      ** the new base rate for the next period.                                               227642
      *                                                                                       227642
     C           *IN85     IFEQ '0'                                                           227642
     C           *IN85     OREQ '1'                                                           227642
     C           TRFIN     ANDEQ'A'                                                           227642
     C           *IN02     ANDEQ'1'                                                           227642
     C           VDAT      ANDLTBJRDNB                                                        227642
      *                                                                                       227642
     C                     EXSR SUB01T                                    S01119
      *                                                                                      BUG7543
      ** Their Start Stub Date processing for CDL028                                         BUG7543
      *                                                                                      BUG7543
     C           TNICD     IFEQ FSTSDT                                                       BUG7543
     C           INFD      ANDLEVDAT                                                         BUG7543
      *                                                                                      BUG7543
     C           FSTSDT    IFNE *ZERO                                                        BUG7543
     C********** FSTS1B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSTS1B    ANDNE*BLANKS                                                       CSD103
     C           FSTS1D    ANDNE*ZERO                                                        BUG7543
     C********** FSTS2B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSTS2B    ANDNE*BLANKS                                                       CSD103
     C           FSTS2D    ANDNE*ZERO                                                        BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDTINFD     WINFD                                              BUG7543
     C                     MOVE TCUCY     WCCY1                                              BUG7543
     C                     MOVE TSPIN     WSPIN1                                             BUG7543
     C                     Z-ADDTRTSP     WRTSP1                                             BUG7543
      *                                                                                      BUG7543
     C**********           Z-ADDFSTS1B    WS1B                                        BUG7543 CSD103
     C                     MOVE FSTS1B    WS1B                                                CSD103
     C                     Z-ADDFSTS1D    WS1D                                               BUG7543
     C**********           Z-ADDFSTS2B    WS2B                                        BUG7543 CSD103
     C                     MOVE FSTS2B    WS2B                                                CSD103
     C                     Z-ADDFSTS2D    WS2D                                               BUG7543
     C                     Z-ADDFSTSDT    WMD1                                               BUG7543
     C                     Z-ADDFSTS1D    WMD2                                               BUG7543
      *                                                                                      BUG7543
     C                     EXSR INTRTE                                                       BUG7543
      *                                                                                      BUG7543
     C                     ENDIF                                                             BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
      ** Their End Stub Date processing for CDL028                                           BUG7543
      *                                                                                      BUG7543
     C           TNICD     IFEQ FSTEDT                                                       BUG7543
     C           BJRDNB    ANDGTVDAT                                                         BUG7543
      *                                                                                      BUG7543
     C           FSTEDT    IFNE *ZERO                                                        BUG7543
     C********** FSTE1B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSTE1B    ANDNE*BLANKS                                                       CSD103
     C           FSTE1D    ANDNE*ZERO                                                        BUG7543
     C********** FSTE2B    ANDNE*ZERO                                                 BUG7543 CSD103
     C           FSTE2B    ANDNE*BLANKS                                                       CSD103
     C           FSTE2D    ANDNE*ZERO                                                        BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDTINFD     WINFD                                              BUG7543
     C                     MOVE TCUCY     WCCY1                                              BUG7543
     C                     MOVE TSPIN     WSPIN1                                             BUG7543
     C                     Z-ADDTRTSP     WRTSP1                                             BUG7543
      *                                                                                      BUG7543
     C**********           Z-ADDFSTE1B    WS1B                                        BUG7543 CSD103
     C                     MOVE FSTE1B    WS1B                                                CSD103
     C                     Z-ADDFSTE1D    WS1D                                               BUG7543
     C**********           Z-ADDFSTE2B    WS2B                                        BUG7543 CSD103
     C                     MOVE FSTE2B    WS2B                                                CSD103
     C                     Z-ADDFSTE2D    WS2D                                               BUG7543
     C                     Z-ADDMDAT      WMD1                                               BUG7543
     C                     Z-ADDFSTE1D    WMD2                                               BUG7543
      *                                                                                      BUG7543
     C                     EXSR INTRTE                                                       BUG7543
      *                                                                                      BUG7543
     C                     ENDIF                                                             BUG7543
     C                     ENDIF                                                             BUG7543
      *                                                                                      BUG7543
     C                     Z-ADDRATE      TFIR                            S01119
      *                                                                   177837
      ** Update Base rate here for use by Rate Fix Advice MT362           177837
      ** Message Generation. (Note that this will be updated again        177837
      ** in DL0280 but no harm will be done as the information will       177837
      ** the same.                                                        177837
     C           CSW005    IFEQ 'Y'                                       177837
     C           TRFIN     ANDEQ*BLANKS                                   177837
     C                     Z-ADDBBRTE     TBRTE                           177837
     C                     MOVE *ON       *IN22                                               177837
     C                     ENDIF                                          177837
      *                                                                                       227642
      ** Rate fixing indicator is 'A' when short term rate was amended                        227642
      ** but base rate not yet picked up during I/C.                                          227642
      *                                                                                       227642
     C           CSW005    IFEQ 'Y'                                                           227642
     C           TRFIN     ANDEQ'A'                                                           227642
     C                     Z-ADDBBRTE     TBRTE                                               227642
     C                     ENDIF                                                              227642
      *                                                                   177837
     C                     BITON'5'       CNFI                            S01119
     C           PRTX      IFEQ ' '                                       S01119
      *                                                                                       227642
      ** Ensure record is for Their side, not for combination.                                227642
      *                                                                                       227642
     C           PRTX      OREQ 'T'                                                           227642
     C                     MOVE 'T'       PRTX                            S01119
     C                     ELSE                                           S01119
     C*                                                                   CSW005
     C* If CSW005 is installed and both sides are to be fixed here but    CSW005
     C* for different rate change dates, output one record for our side   CSW005
     C* and one for theirs.  This is necessary to get the Midas amendment CSW005
     C* processing correct for all cases.                                 CSW005
     C*                                                                   CSW005
     C           CSW005    IFEQ 'Y'                                       CSW005
     C           UNICD     ANDNETNICD                                     CSW005
     C                     MOVE 'D'       CNRQ                            CSW005
0831 C           DLCT      ADD  1         DLCT                            CSW005
     C                     Z-ADDUNICD     EVDAT                           CSW005
     C                     MOVE 'I'       ACTC                            CSW005
     C                     EXCPTOUR                                       CSW005
     C                     MOVE 'T'       PRTX                            CSW005
     C                     ELSE                                           CSW005
     C*                                                                   CSW005
     C                     MOVE 'B'       PRTX                            S01119
     C                     END                                            CSW005
     C                     END                                            S01119
      *                                                                                       227642
      ** If this is for the first rate fix date (prior to value date)                         227642
      ** use value date or TSLIP as start date.                                               227642
      *                                                                                       227642
     C           TINFD     IFLE VDAT                                                          227642
     C                     MOVEL'Y'       WTHEIR                                              227642
     C                     END                                                                227642
      *                                                                                       227642
     C                     END                                                                227642
     C                     END                                            S01119
      *                                                                   CSW097
     C**********           MOVEL*BLANKS   WOUR    1                                    CSW097 227642
     C**********           MOVEL*BLANKS   WTHEIR  1                                    CSW097 227642
      *                                                                   CSW097
      **  If CSW005 is installed, allow output of rate fix                CSW097
      **  record to DLINDDM for RS and RX deals for the initial           CSW097
      **  period if:                                                      CSW097
      **  1)  Value date has not been processed yet                       CSW097
      **  2)  A short term rate is defined for the floating leg           CSW097
      **  3)  A rate fix advice has not been produced previously.         CSW097
      *                                                                                       227642
      **  OR when short term rate was amended during I/C.                                     227642
      *                                                                                       227642
      *                                                                   CSW097
     C           CSW005    IFEQ 'Y'                                       CSW097
     C           DTYP      ANDEQ'RS'                                      CSW097
     C           PRTX      ANDEQ*BLANK                                    177837
     C           CSW005    OREQ 'Y'                                       CSW097
     C           DTYP      ANDEQ'RX'                                      CSW097
     C           PRTX      ANDEQ*BLANK                                    177837
      *                                                                   CSW097
     C                     TESTB'1'       ACEI           38Vdat processed?CSW097
     C                     TESTB'0'       UDNSI          39Short trm rate?CSW097
     C                     TESTB'2'       UDNSI          03                                   227642
      *                                                                   CSW097
     C           *IN38     IFEQ *OFF                                      CSW097
     C           *IN39     ANDEQ*ON                                       CSW097
     C           *IN84     ANDEQ*OFF                                      CSW097
     C           *IN03     OREQ *ON                                                           227642
     C           URFIN     ANDEQ*BLANKS                                                       227642
     C           *IN03     OREQ *ON                                                           227642
     C           URFIN     ANDEQ'X'                                                           227642
      *                                                                                       227642
     C                     Z-ADDUEINR     UFIR                            CSW097
     C                     BITON'4'       CNFI                            CSW097
     C                     MOVEL'U'       PRTX                            CSW097
     C                     MOVEL'Y'       WOUR                            CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     TESTB'0'       TDNSI          39Short trm rate?CSW097
     C                     TESTB'2'       TDNSI          03                                   227642
      *                                                                   CSW097
     C           *IN38     IFEQ *OFF                                      CSW097
     C           *IN39     ANDEQ*ON                                       CSW097
     C           *IN85     ANDEQ*OFF                                      CSW097
     C           *IN03     OREQ *ON                                                           227642
     C           TRFIN     ANDEQ*BLANKS                                                       227642
     C           *IN03     OREQ *ON                                                           227642
     C           TRFIN     ANDEQ'X'                                                           227642
      *                                                                                       227642
     C                     Z-ADDTEINR     TFIR                            CSW097
     C                     BITON'5'       CNFI                            CSW097
     C                     MOVEL'Y'       WTHEIR                          CSW097
     C           WOUR      IFNE 'Y'                                       CSW097
     C                     MOVEL'T'       PRTX                            CSW097
     C                     ELSE                                           CSW097
     C                     MOVEL'B'       PRTX                            CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
     C                     ENDIF                                          CSW097
      *  If CSW005 is installed, output settlement amount to              CSW097
      *  rate fix record so this may be reflected on resulting            CSW097
      *  MT362 FRs.                                                       CSW097
     C           DTYP      IFEQ 'FR'                                      CSW097
     C           PRTX      IFEQ 'U'                                       CSW097
     C           PRTX      OREQ 'B'                                       CSW097
     C                     Z-ADDDSANOT    PIAMT                           CSW097
     C                     ENDIF                                          CSW097
     C           PRTX      IFEQ 'T'                                       CSW097
     C           PRTX      OREQ 'B'                                       CSW097
     C                     Z-ADDDSANOT    RIAMT                           CSW097
     C                     ENDIF                                          CSW097
     C                     ENDIF                                          CSW097
      *                                                                   CSW097
      *                                                                   CIR001
      ** If rate fix advice was procuced in input cycle, restore bit      CIR001
      **   settings.                                                      CIR001
      *                                                                   CIR001
     C           *IN84     IFEQ '1'                                       CIR001
     C                     BITON'4'       CNFI                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           *IN85     IFEQ '1'                                       CIR001
     C                     BITON'5'       CNFI                            CIR001
     C                     END                                            CIR001
     C*                                                                   S01119
     C**  OUTPUT DETAILS TO PF/DLINDDM                                    S01119
     C*                                                                   S01119
     C                     MOVE 'I'       ACTC                            S01119
     C*                                                                   S01119
     C****SET*UP*'FR'*&*'RL'*(NON*AVERAGE)*DEAL*RECORDS*           S01119 S01157
     C**  SET UP 'FR', 'RR', 'RP' & 'RF' (NON AVERAGE) DEAL RECORDS       S01157
     C**  PRODUCE FR ONLY IF NOT PREVIOUSLY PRODUCED                      S01119
     C*                                                                   S01119
     C                     MOVE '0'       *IN87                           S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'FR'                                      S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     TESTB'0'       UDNSI      87                   S01119
     C                     ELSE                                           S01119
     C                     TESTB'0'       TDNSI      87                   S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C***********DTYP      IFEQ 'RL'                               S01119 S01157
     C           DTYP      IFEQ 'RR'                                      S01157
     C           DTYP      OREQ 'RP'                                      S01157
     C           DTYP      OREQ 'RF'                                      S01157
     C                     MOVE '1'       *IN87                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C/COPY WNCPYSRC,DL0279C076
     C           *IN87     IFEQ '1'                                       S01119
     C*                                                                   S01119
     C           PRTX      IFEQ 'U'                         OUR DETAILS   S01119
     C                     MOVE 'D'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADDUNICD     EVDAT                           S01119
     C                     EXCPTOUR                                       S01119
     C                     END                                            S01119
     C           PRTX      IFEQ 'T'                         THEIR         S01119
     C                     MOVE 'F'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C                     Z-ADDTNICD     EVDAT                           S01119
     C                     EXCPTTHEIR                                     S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C077
     C*                                                                   S01119
     C**  SET UP 'RS' MATCHED DEAL RECORD                                 S01119
     C*                                                                   S01119
     C           DTYP      IFEQ 'RS'                                      S01119
     C/COPY WNCPYSRC,DL0279C078
     C*                                                                   S01119
     C           PRTX      IFEQ 'B'                         OURS & THEIRS S01119
     C                     MOVE 'H'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C           WOUR      IFNE 'Y'                                       CSW097
     C                     Z-ADDUNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDUSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTBOTH                                      S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  SET UP 'RS' UNMATCHED DEAL RECORDS                              S01119
     C*                                                                   S01119
     C           PRTX      IFEQ 'U'                         OUR           S01119
     C                     MOVE 'D'       CNRQ                            S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C           WOUR      IFNE 'Y'                                       CSW097
     C                     Z-ADDUNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDUSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTOUR                                       S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           PRTX      IFEQ 'T'                        THEIR          S01119
     C                     MOVE 'F'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C           WTHEIR    IFNE 'Y'                                       CSW097
     C                     Z-ADDTNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDTSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTTHEIR                                     S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C079
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET UP 'RX' MATCHED DEAL RECORDS                                S01119
     C           DTYP      IFEQ 'RX'                                      S01119
     C/COPY WNCPYSRC,DL0279C080
     C*                                                                   S01119
     C           PRTX      IFEQ 'B'                         OURS & THEIRS S01119
     C                     MOVE 'H'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C           WOUR      IFNE 'Y'                                       CSW097
     C                     Z-ADDUNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDUSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTBOTH                                      S01119
     C                     ELSE                                           S01119
     C*                                                                   S01119
     C**  SET UP 'RX' UNMATCHED DEAL RECORDS                              S01119
     C*                                                                   S01119
     C           PRTX      IFEQ 'U'                         OUR           S01119
     C                     MOVE 'D'       CNRQ                            S01119
0831 C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C           WOUR      IFNE 'Y'                                       CSW097
     C                     Z-ADDUNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDUSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTOUR                                       S01119
     C                     Z-ADD0         PIAMT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C           PRTX      IFEQ 'T'                          THEIR        S01119
     C                     MOVE 'F'       CNRQ                            S01119
     C           DLCT      ADD  1         DLCT                            S01119
     C*  Use value date if fixing for the first period                    CSW097
     C********** WOUR      IFNE 'Y'                                                  CSW097 BUG11267
     C           WTHEIR    IFNE 'Y'                                                         BUG11267
     C                     Z-ADDTNICD     EVDAT                           S01119
     C                     ELSE                                           CSW097
     C**********           Z-ADDVDAT      EVDAT                                        CSW097 227642
     C                     Z-ADDTSLIP     EVDAT                                               227642
     C                     ENDIF                                          CSW097
     C                     EXCPTTHEIR                                     S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C                     END                                            S01119
     C/COPY WNCPYSRC,DL0279C081
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C*****BE*SR:*BASE*RATE*CONFIRMATIONS*FOR*RL*AVERAGE*RATES*    S01119 S01157
     C*    BE SR: BASE RATE CONFIRMATIONS FOR RR/RD/RF AVERAGE RATES  *   S01157
     C*                                                                   S01119
     C*    CALLED FROM : FRAIRS                                       *   S01119
     C*    CALLS :       SUBO1U/T                                     *   S01119
     C*                                                                   S01119
     C*****************************************************************   S01119
     C*                                                                   S01119
     C           BE        BEGSR                                          S01119
     C*                                                                   S01119
     C                     Z-ADD0         TAXPY                           S01119
     C                     Z-ADD0         PIAMT                           S01119
     C                     Z-ADD0         RIAMT                           S01119
     C*                                                                   S01119
     C**  SET RATE FIX DATE TO RUN DATE TO FORCE BASE RATE PICKUP         S01119
     C**  AND PROCESS VIA SR:SUB01U/T                                     S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C                     Z-ADDUINFD     INFD               SAVE FIX     S01119
     C*****                Z-ADDRUND      UINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    UINFD                           S01194
     C                     EXSR SUB01U                                    S01119
     C                     Z-ADDINFD      UINFD              REST. FIX    S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C                     Z-ADDTINFD     INFD                            S01119
     C*****                Z-ADDRUND      TINFD                   S01119  S01194
     C                     Z-ADDBJRDNB    TINFD                           S01194
     C                     EXSR SUB01T                                    S01119
     C                     Z-ADDINFD      TINFD                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  SET EFFECTIVE (EVENT) DATE OF BASE RATE CHANGE TO LATER OF      S01119
     C**  VALUE DATE, LAST INTEREST FIX DATE AND BASE RATE CHANGE DATE    S01119
     C*                                                                   S01119
     C                     Z-ADDVDAT      EVDAT                           S01119
     C           INFD      IFGT EVDAT                                     S01119
     C                     Z-ADDINFD      EVDAT                           S01119
     C                     END                                            S01119
     C           BRDAT     IFGT EVDAT                                     S01119
     C                     Z-ADDBRDAT     EVDAT                           S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C**  IF BASE RATE USED TO CALCULATE NEW EFFECTIVE INTEREST RATE      S01119
     C**  IS DIFFERENT FROM BASE RATE ON FILE THEN BASE RATE CHANGE       S01119
     C**  HAS OCCURRED, SET ON BASE RATE CHANGE INDICATOR AND OUTPUT      S01119
     C**  A RECORD TO PF/DLINDDM                                          S01119
     C*                                                                   S01119
     C********** UBRTT     IFNE 0                                                      S01119 CSD103
     C           UBRTT     IFNE *BLANKS                                                       CSD103
     C           BBRTE     IFNE UBRTE                      INIT RATE SET  S01119
     C           *IN16     ANDEQ'1'                                       S01119
     C           *IN16     OREQ '0'                        NOT SET        S01119
     C                     BITON'6'       CNFI                            S01119
     C                     MOVE 'B'       CNRQ                            S01119
     C                     Z-ADDBBRTE     UFIR                            S01119
     C/COPY WNCPYSRC,DL0279C082
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTOUR                                       S01119
     C/COPY WNCPYSRC,DL0279C083
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ELSE                                           S01119
     C           BBRTE     IFNE TBRTE                                     S01119
     C           *IN16     ANDEQ'1'                                       S01119
     C           *IN16     OREQ '0'                                       S01119
     C                     BITON'6'       CNFI                            S01119
     C                     MOVE 'B'       CNRQ                            S01119
     C                     Z-ADDBBRTE     TFIR                            S01119
     C/COPY WNCPYSRC,DL0279C084
0831 C           DLCT      ADD  1         DLCT                            S01119
     C                     EXCPTTHEIR                                     S01119
     C/COPY WNCPYSRC,DL0279C085
     C                     END                                            S01119
     C                     END                                            S01119
     C*                                                                   S01119
     C                     ENDSR                                          S01119
     C*****************************************************************   S01119
     C/EJECT                                                              S01119
     C*****************************************************************   S01119
0880 C**
0880 C*****                                                       *****   S01194
0881 C*****ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD*   S01194
0882 C*****                                                       *****   S01194
0883 C*****      ZSYSTM    BEGSR                           *** ZSYSTM**** S01194
0884 C*****                                                       *****   S01194
0885 C*****SET UP KEY FOR INSTALLATION CONTROL RECORD.            *****   S01194
0886 C*****                MOVEL'01      'ZTABKY 12               *****   S01194
0887 C*****                MOVE '  10'    ZTABKY                  *****   S01194
0888 C*****                                                       *****   S01194
0889 C*****      ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0890 C**N99      RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0891 C*****                                                       *****   S01194
0892 C*****CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.            *****   S01194
0893 C*****      DATF      COMP 'M'                      98MMDDYY,*98*ON  S01194
0894 C*****                                                       *****   S01194
0895 C*****                ENDSR                                  *****   S01194
0896 C*****                                                       *****   S01194
0903 C*****************************************************************   S01195
0904 C*****                                                       *****   S01195
0905 C*****ZTXDAY SR. TO CALCULATE ANY NUMBER OF DAYS FORWARD THAT ARE*   S01195
0906 C*****           WORKING DAYS IN BOTH THE LOCAL CURRENCY AND ANY**   S01195
0907 C*****           SPECIFIED CURRENCY.                         *****   S01195
0908 C*****                                                       *****   S01195
0909 C*****    THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING AS*   S01195
0910 C*****    HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY**   S01195
0911 C*****    ADDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED*   S01195
0912 C*****                                                       *****   S01195
0913 C*****      ZTXDAY    BEGSR                           *** ZTXDAY**   S01195
0914 C*****                                                       *****   S01195
0915 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                   *****   S01195
0916 C*****                Z-ADDZDAYNO    ZDAYNO  50       STARTING****   S01195
0917 C*****                MOVE ZCCY      ZCCY    3        DATE CURREN*   S01195
0918 C*****                Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORK*   S01195
0919 C*****LOCY DEFINED ON TABLE,TB-11;  AND SHOULD ALREADY HAVE  *****   S01195
0920 C*****BEEN INPUT.                                            *****   S01195
0921 C*****                                                DAYS FORWAR**  S01195
0922 C*****CLEAR COUNT OF NBR OF DAYS ADDED, & DEFINE ZDYNBR.     *****   S01195
0923 C*****                Z-ADD0         ZDCNT   20              *****   S01195
0924 C*****                Z-ADDZDAYNO    ZDYNBR  50              *****   S01195
     C***** SEE MANUAL ON SYSTEM SUBROUTINES                      *****   S01195
     C***** IF ZNRDYS IS INPUT AS ZERO IT WILL NOW BE TREATED AS Z*****   S01195
     C***** FIRST CHECK FOR ZERO NOTICE DAYS                      *****   S01195
     C*****      ZNRDYS    COMP 0                        95       *****   S01195
     C*****                GOTO ZTXEND                            *****   S01195
0925 C*****                                                       *****   S01195
0926 C*****LOOP TO INCREMENT DAY NUMBER AND CHECK FOR HOLIDAY.    *****   S01195
0927 C*****      ZTLOP1    TAG                             ** ZTLOP1 TAG* S01195
0928 C*****                                                       *****   S01195
0929 C*****                SETOF                     9596         *****   S01195
0930 C*****      ZDYNBR    ADD  1         ZDYNBR                  *****   S01195
0931 C*****                                                       *****   S01195
0932 C*****SET KEY FOR FIRST HOLIDAY RECORD.                      *****   S01195
0933 C*****                MOVEL'22    '  ZDHKEY 12               *****   S01195
0934 C*****                MOVELZDYNBR    ZWRK6   6               *****   S01195
0935 C*****                MOVE '1'       ZWRK6                   *****   S01195
0936 C*****                MOVE ZWRK6     ZDHKEY                  *****   S01195
0937 C*****                                                       *****   S01195
0938 C*****CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                *****   S01195
0939 C*****      ZTHCHN    TAG                             ** ZTHCHN TAG *S01195
0940 C*****                                                       *****   S01195
0941 C*****      ZDHKEY    CHAINTABLE                90    ON NOT THERE   S01195
0942 C**N90      RECI      COMP 'D'                  9090  DELETED*****   S01195
0943 C*****                                                       *****   S01195
0944 C*****NO RECORD 1 FOUND, IS NOT A HOLIDAY                    *****   S01195
0945 C***90N95             GOTO ZTOAGN                            *****   S01195
0946 C*****                                                       *****   S01195
0947 C*****NO RECORD 2 FOUND                                      *****   S01195
0948 C***90 95 96          GOTO ZTLOP1                     EXC. NOT FOUND S01195
0949 C***90 95N96          GOTO ZTOAGN                     INC. NOT FOUND S01195
0950 C*****                                                       *****   S01195
0951 C*****DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE               *****   S01195
0952 C*****      INEX      COMP 'E'                  92  91       *****   S01195
0953 C*****                                                       *****   S01195
0954 C*****CHECK IF DAY IS HOLIDAY FOR CURRENCY.                  *****   S01195
0955 C*****      ZCCY      LOKUPHCCY                     93       *****   S01195
0956 C**N93******LOCY      LOKUPHCCY                     93       E10475  S01195
     C***91 93   LOCY      LOKUPHCCY                     93EXCLUDEE10475  S01195
     C***92N93   LOCY      LOKUPHCCY                     93INCLUDEE10475  S01195
     C*****                                                       E10475  S01195
0957 C***91 93             GOTO ZTOAGN                     EXCLUDE FOUND  S01195
0958 C***92 93             GOTO ZTLOP1                     INCLUDE FOUND  S01195
0959 C*****                                                       *****   S01195
0960 C*****IF EXCLUDE OR INCLUDE NOT FOUND CHECK                  *****   S01195
0961 C*****FOR SECOND HOLIDAY RECORD, IF REQUIRED.                *****   S01195
0962 C*****      '   '     LOKUPHCCY                     94ON IF NO RCD.2 S01195
0963 C*****                MOVE ZDHKEY    ZWRK1   1               *****   S01195
0964 C*****      ZWRK1     COMP '1'                      95       *****   S01195
0965 C***91*95             SETON                     96           *****   S01195
0966 C***95N94             MOVE '2'       ZDHKEY                  *****   S01195
0967 C***95N94             GOTO ZTHCHN                     GET SECOND REC S01195
0968 C*****                                                       *****   S01195
0969 C***91                GOTO ZTLOP1                     EXC. NOT FOUND S01195
0970 C***92                GOTO ZTOAGN                     INC. NOT FOUND S01195
0971 C*****                                                       *****   S01195
0972 C*****INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS   *****   S01195
0973 C*****HAVE BEEN ADDED. IF NOT, GO THROUGH LOOP1 AGAIN.       *****   S01195
0974 C*****      ZTOAGN    TAG                             ** ZTOAGN TAG *S01195
0975 C*****                                                       *****   S01195
0976 C*****      ZDCNT     ADD  1         ZDCNT                   *****   S01195
0977 C*****      ZDCNT     COMP ZNRDYS                 97         *****   S01195
0978 C***97                GOTO ZTLOP1                            *****   S01195
0979 C*****                                                       *****   S01195
0863 C*****      ZTXEND    ENDSR                                  *****   S01195
0981 C*****                                                       *****   S01195
0982 C*****                                                       *****   S01195
0983 C*****************************************************************   S01195
0983 C********************************************************************
0984 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0985 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0986 C*
0987 C           GLZADD    BEGSR                           *** GLZADD ****
0988 C*
0989 C                     Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0990 C   91                GOTO ZZAEND                     AMT = 0.BYPASS
0991 C*
0992 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0993 C                     Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0994 C                     MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0995 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0996 C*
0997 C                     EXSR GLZSUM
0998 C           ZZAEND    ENDSR                           ** ZZAEND TAG *
0999 C*
1000 C********************************************************************
1001 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
1002 C*                        GLZADD, GLZSUB, GLZCMP.
1003 C*          PARAMETERS PASSED -
1004 C*                     I/P ZZAMTI ZZAMTD
1005 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
1006 C*
1007 C           GLZSUM    BEGSR                           *** GLZSUM ****
1008 C*
1009 C                     Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
1010 C                     Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
1011 C                     SETOF                     919293
1012 C                     SETOF                     949599
1013 C*
1014 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1015 C           ZZAMTI    COMP 0                      9293
1016 C   93      ZZAMTD    COMP 0                      9293
1017 C   93                GOTO ZZSEND                     ZERO BYPASS
1018 C*
1019 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1020 C           ZZTOTI    COMP 0                      9193
1021 C   93      ZZTOTD    COMP 0                      9193
1022 C*
1023 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1024 C   93                Z-ADDZZAMTI    ZZTOTI
1025 C   93                Z-ADDZZAMTD    ZZTOTD
1026 C   93                GOTO ZZSEND                     ZERO BYPASS
1027 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1028 C   91N92
1029 CORN91 92             GOTO ZZOFPS
1030 C*
1031 C           ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1032 C           ZZWK2     COMP 999                  93    '93' = CARRY
1033 C  N93      ZZWK2     COMP -999                   93    INTO INTEGER.
1034 C*
1035 C   93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1036 C      93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1037 C   93      ZZTOTI    ADD  ZZWK3     ZZWK3
1038 C  N93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1039 C*
1040 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1041 C  N92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1042 C   92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1043 C  N99                Z-ADDZZWK2     ZZTOTD
1044 C  N99                Z-ADDZZWK3     ZZTOTI
1045 C*
1046 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1047 C   99                Z-ADD0         ZZAMT  153
1048 C                     GOTO ZZSEND
1049 C*
1050 C* THE 'SIGNS' ARE DIFFERENT
1051 C           ZZOFPS    TAG                             ** ZZOFPS TAG**
1052 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1053 C*
1054 C   92                Z-SUBZZAMTI    ZZAMTI 150
1055 C   92                Z-SUBZZAMTD    ZZAMTD  30
1056 C*
1057 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1058 C*
1059 C   91                Z-SUBZZTOTI    ZZTOTI
1060 C   91                Z-SUBZZTOTD    ZZTOTD
1061 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1062 C*
1063 C           ZZTOTI    COMP ZZAMTI               93  95
1064 C   95      ZZTOTD    COMP ZZAMTD               93  95
1065 C*
1066 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1067 C   95                Z-ADD0         ZZTOTI
1068 C   95                Z-ADD0         ZZTOTD
1069 C   95                GOTO ZZSEND
1070 C*
1071 C* IF ZZTOT GT. ZZAMT.
1072 C   93      ZZAMTD    COMP ZZTOTD               94
1073 C   93 94   ZZTOTI    SUB  1         ZZTOTI
1074 C   93 94   ZZTOTD    ADD  1000      ZZWK2
1075 C   93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1076 C   93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1077 C   93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1078 C*
1079 C*
1080 C* IF ZZAMT GT. ZZTOT.
1081 C  N93      ZZTOTD    COMP ZZAMTD               94
1082 C  N93 94   ZZAMTI    SUB  1         ZZWK3  150
1083 C  N93 94   ZZAMTD    ADD  1000      ZZWK2
1084 C  N93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1085 C  N93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1086 C  N93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1087 C  N93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1088 C*
1089 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1090 C                     SETOF                     94
1091 C   93 91
1092 CORN93 92             SETON                     94
1093 C   94                Z-SUBZZTOTI    ZZTOTI
1094 C   94                Z-SUBZZTOTD    ZZTOTD
1095 C**
1096 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1097 C   92                Z-SUBZZAMTI    ZZAMTI
1098 C   92                Z-SUBZZAMTD    ZZAMTD
1099 C           ZZSEND    TAG                             ** ZZSEND TAG *
1100 C**
1101 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1102 C                     SETOF                     96
1103 C           ZZTOTD    COMP 0                        91
1104 C   91      ZZTOTI    COMP 0                      96
1105 C   96                MOVE '.000-'   ZZNEGD  5
1106 C                     ENDSR                             ** ENDSR **
      *****************************************************************   S01117
      *                                                                   S01117
      * SR/TLXNOT  -  To calculate telex notice date for a ccy/nostro     S01117
      *               and add to array.                                   S01117
      *               Saves calculating telex notice dates for all        S01117
      *               possible ccy/location combinations during first     S01117
      *               cycle processing. Stored by nostro for convenience  S01117
      *                                                                   S01117
      * INPUT:     ZCCY1 - currency                                       S01117
      *            ZNOS1 - nostro (may be blank if not entered)           S01117
      *            ZCCY2 - local currency (set up in 1st cycle)           S01117
      *            ZLOC2 - system location (set up in 1st cycle)          S01117
      *                                                                   S01117
      * CALLED BY: MAIN PROCESSING                                        S01117
      *                                                                   S01117
      * CALLS    : ZF2C - calculate common working date                   S01117
      *                                                                   S01117
      *****************************************************************   S01117
     C           TLXNOT    BEGSR                           ** TLXNOT **   S01117
      *                                                                   S01117
      ** increment array index                                            S01117
     C                     ADD  1         Y                               S01117
      *                                                                   S01117
      ***set*up*date*of*next*working*day*for*SR/ZF2C                S01117E21923
      ** set up date of next next working day - 1 for SR/ZF2C             E21923
     C*********************Z-ADDBJDNWD    ZDAYNO                    S01117E21923
     C                     Z-ADDDNNWD     ZDAYNO                          E21923
      *                                                                   S01117
      ** read currencies file for telex notice days                       S01117
     C                     CALL 'AOCURRR0'                                S01117
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM           ZCCY1                           S01117
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
      *                                                                   S01117
      ** if database error                                                S01117
     C           @RTCD     IFNE *BLANK                     B1             S01117
     C                     SETON                     U7U8LR*1             S01117
     C                     MOVEL'SDCURRPD'DBFILE           ************** S01117
     C                     MOVEL'003'     DBASE            *DBERROR 003 * S01117
     C                     MOVEL@RTCD     DBOPTN           *1             S01117
     C                     MOVELZCCY1     DBKEY  29                       S01194
     C                     DUMP                            *1             S01117
     C                     GOTO TLXEND                     *1             S01117
     C                     END                             E1             S01117
      *                                                                   S01117
     C           ZNOS1     IFNE *BLANKS                    B1             S01117
     C           ZNOS1     ANDNE'00'                                      LN0588
      *                                                                   S01117
      ** read nostros file to obtain location                             S01117
     C                     CALL 'AONOSTR0'                 *1             S01117
     C                     PARM '*MSG   ' @RTCD            *1             S01117
     C                     PARM '*KEY   ' @OPTN            *1             S01117
     C                     PARM *BLANKS   @KEY3   6        *1             S01117
     C                     PARM           ZCCY1            *1             S01117
     C**********           PARM *BLANKS   @KEY4   4        *1                          S01117 CGL029
     C                     PARM *BLANKS   @KEY4  10                                           CGL029
     C                     PARM *BLANKS   @KEY2   2        *1             S01117
     C                     PARM           ZNOS1   2        *1             S01117
     C                     PARM *BLANKS   @KEYF   3                       S01194
     C                     PARM *BLANKS   @KEYG  10                       S01194
     C                     PARM *BLANKS   @KEYH   1                       S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
      *                                                                   S01117
      ** if database error                                                S01117
     C           @RTCD     IFNE *BLANKS                    B*2            S01117
     C                     SETON                     U7U8LR**2            S01117
     C                     MOVEL'SDNOSTPD'DBFILE           ************** S01117
     C                     MOVEL'004'     DBASE            *DBERROR 004 * S01117
     C                     MOVEL'*MSG'    DBOPTN           ************** S01117
     C                     MOVELZCCY1     DBKEY  29                       S01194
     C                     MOVE ZNOS1     DBKEY                           S01194
     C                     DUMP                            **2            S01117
     C                     GOTO TLXEND                     **2            S01117
     C                     ELSE                                           LN0588
      ** obtain location code (last 3 chars of shortname)                 LN0588
     C                     MOVE A7NOSN    ZLOC1                           LN0588
     C                     END                             E*2            S01117
      *                                                                   S01117
     C                     ELSE                            X1             S01117
      ** unallocated nostro - set location to blanks                      LN0588
     C                     MOVE *BLANKS   ZLOC1            *1             S01117
     C                     END                             E1             S01117
      *                                                                   S01117
      ***obtain*location*code*(last 3 chars of shortname)           S01117LN0588
     C*********************MOVE A7NOSN    ZLOC1                     S01117LN0588
     C                     Z-ADDA6TXND    ZNRDYS                          S01117
     C           ZNRDYS    IFEQ 0                                         E43201
     C***********ZCCY1     ANDEQZCCY2                              E43201 058890
     C                     Z-ADDDNNWD     TNDA,Y                          E43201
     C                     ELSE                                           E43201
     C                     EXSR ZF2C                                      S01117
     C                     Z-ADDZDYNBR    TNDA,Y                          S01117
     C                     END                                            E43201
     C                     MOVELZCCY1     CN,Y                            S01117
     C                     MOVE ZNOS1     CN,Y                            S01117
     C                     Z-ADDY         X                               S01117
      *                                                                   S01117
     C           TLXEND    ENDSR                           ** TLXEND **   S01117
      *                                                                   S01117
     C/COPY ZSRSRC,ZF2C                                                   S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01117
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
1107 C*****************************************************************   S01195
1108 C*****                                                       *****   S01195
1109 C*****XDATE3 SR. TO CALCULATE ANY NUMBER OF WORKING          *****   S01195
1110 C*****           DAYS BACK IN ANY CURRENCY.                  *****   S01195
1111 C*****                                                       *****   S01195
1112 C*****    THIS SR. CAN BE USED WHEN THE INPUT CYCLE IS RUNNING*AS*   S01195
1113 C*****    HOLIDAY RECORDS ARE ACCESSED BY CHAIN. THEREFORE NEWLY**   S01195
1114 C*****    ADDED RECORDS IN THE OVERFLOW AREA CAN ALSO BE ACCESSED*   S01195
1115 C*****                                                       *****   S01195
1116 C*****      XDATE3    BEGSR                           *** ZDATE3 *** S01195
1117 C*****                                                       *****   S01195
1118 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                   *****   S01195
1119 C*****                Z-ADDZDAYNO    ZDAYNO  50       STARTING*DATE**S01195
1120 C*****                MOVE ZCCY      ZCCY    3        DATE CURRENCY**S01195
1121 C*****                Z-ADDZNRDYS    ZNRDYS  20       NBR OF WORKING*S01195
1122 C*****                                                DAYS BACK******S01195
1123 C*****CLEAR COUNT OF NBR OF DAYS SUBTRACTED, & DEFINE ZDYNBR.*****   S01195
1124 C*****                Z-ADD0         ZDCNT   20              *****   S01195
1125 C*****                Z-ADDZDAYNO    ZDYNBR  50              *****   S01195
1126 C*****                                                       *****   S01195
1127 C*****LOOP TO DECREMENT DAY NUMBER AND CHECK FOR HOLIDAY.    *****   S01195
1128 C*****      XDLOP1    TAG                             ** ZDLOP1*TAG *S01195
1129 C*****                                                       *****   S01195
1130 C*****                SETOF                     9596         *****   S01195
1131 C*****      ZDYNBR    SUB  1         ZDYNBR                  *****   S01195
1132 C*****                                                       *****   S01195
1133 C*****SET KEY FOR FIRST HOLIDAY RECORD.                      *****   S01195
1134 C*****                MOVEL'22    '  ZDHKEY 12               *****   S01195
1135 C*****                MOVELZDYNBR    ZWRK6   6               *****   S01195
1136 C*****                MOVE '1'       ZWRK6                   *****   S01195
1137 C*****                MOVE ZWRK6     ZDHKEY                  *****   S01195
1138 C*****                                                       *****   S01195
1139 C*****CHAIN FOR HOLIDAY RECORD, RECORD 1 OR 2                *****   S01195
1140 C*****      XDHCHN    TAG                             ** ZDHCHN*TAG *S01195
1141 C*****                                                       *****   S01195
1142 C*****      ZDHKEY    CHAINTABLE                90    ON NOT THERE***S01195
1143 C**N90      RECI      COMP 'D'                  9090  DELETED*****   S01195
1144 C*****                                                       *****   S01195
1145 C*****NO RECORD 1 FOUND, IS NOT A HOLIDAY                    *****   S01195
1146 C***90N95             GOTO XDOAGN                            *****   S01195
1147 C*****                                                       *****   S01195
1148 C*****NO RECORD 2 FOUND                                      *****   S01195
1149 C***90 95 96          GOTO XDLOP1                     EXC. NOT*FOUND S01195
1150 C***90 95N96          GOTO XDOAGN                     INC. NOT*FOUND S01195
1151 C*****                                                       *****   S01195
1152 C*****DETERMINE TYPE FOUND, INCLUDE OR EXCLUDE               *****   S01195
1153 C*****      INEX      COMP 'E'                  92  91       *****   S01195
1154 C*****                                                       *****   S01195
1155 C*****CHECK IF DAY IS HOLIDAY FOR CURRENCY.                  *****   S01195
1156 C*****      ZCCY      LOKUPHCCY                     93       *****   S01195
1157 C***91 93             GOTO XDOAGN                     EXCLUDE*FOUND  S01195
1158 C***92 93             GOTO XDLOP1                     INCLUDE*FOUND  S01195
1159 C*****                                                       *****   S01195
1160 C*****IF EXCLUDE OR INCLUDE NOT FOUND CHECK                  *****   S01195
1161 C*****FOR SECOND HOLIDAY RECORD, IF REQUIRED.                *****   S01195
1162 C*****      '   '     LOKUPHCCY                     94ON IF NO*RCD.2 S01195
1163 C*****                MOVE ZDHKEY    ZWRK1   1               *****   S01195
1164 C*****      ZWRK1     COMP '1'                      95       *****   S01195
1165 C***91 95             SETON                     96           *****   S01195
1166 C***95N94             MOVE '2'       ZDHKEY                  *****   S01195
1167 C***95N94             GOTO XDHCHN                     GET SECOND*REC S01195
1168 C*****                                                       *****   S01195
1169 C***91                GOTO XDLOP1                     EXC. NOT*FOUND S01195
1170 C***92                GOTO XDOAGN                     INC. NOT*FOUND S01195
1171 C*****                                                       *****   S01195
1172 C*****INCREMENT COUNT AND CHECK IF REQUIRED NUMBER OF DAYS   *****   S01195
1173 C*****HAS BEEN SUBTRACTED. IF NOT, GO THROUGH LOOP1 AGAIN.   *****   S01195
1174 C*****      XDOAGN    TAG                             ** ZDOAGN*TAG *S01195
1175 C*****                                                       *****   S01195
1176 C*****      ZDCNT     ADD  1         ZDCNT                   *****   S01195
1177 C*****      ZDCNT     COMP ZNRDYS                 97         *****   S01195
1178 C***97                GOTO XDLOP1                            *****   S01195
1179 C*****                                                       *****   S01195
1180 C*****                ENDSR                                  *****   S01195
1181 C*****                                                       *****   S01195
1182 C*****                                                       *****   S01195
1183 C********************************************************************
1184 C/EJECT
2922 C**************************************************************S01119066550
2923 C***********                                                   S01119066550
2924 C*****GLINTC SR. TO CALCULATE INTEREST BETWEEN ANY TWO DAY NUMBS01119066550
2925 C***********                                                   S01119066550
2926 C*****THIS*VERSION REPLACES THE ORIGINAL GLINTC SR. NOW NAMED  S01119066550
2927 C*****GLINTO.                                                  S01119066550
2928 C***********                                                   S01119066550
2929 C*****CALCULATION METHODS ARE -                                S01119066550
2930 C*****1**ACTUAL/365                                            S01119066550
2931 C*****2**ACTUAL/360                                            S01119066550
2932 C*****3**360/360 (SOMETIMES CALLED 30/360)                     S01119066550
2933 C*****4**365/365 (EXCLUDING 29/02)                             S01119066550
2934 C*****5**365/360 (EXCLUDING 29/02)                             S01119066550
2935 C*****6**ACTUAL/366                                            S01119066550
2936 C***********                                                   S01119066550
2937 C*****REQUIRES SUBRS. - ZDATE2, ZSAVE, & ZRSTOR.               S01119066550
2938 C***********                                                   S01119066550
2939 C***********                                                   S01119066550
2940 C*R*********GLINTC    BEGSR                           ** GLINT S01119066550
2941 C***********                                                   S01119066550
2942 C*****CALCULATIONS TO DEFINE INPUT FIELDS.                     S01119066550
2943 C*R*********          Z-ADDZIBEG     ZIBEG   50       STARTING S01119066550
2944 C*R*********          Z-ADDZIEND     ZIEND   50       FINISHIN S01119066550
2945 C*R*********          Z-ADDZICALC    ZICALC  10       CALC. BA S01119066550
2946 C*R*********          Z-ADDZIAMT     ZIAMT  150       PRINCIPA S01119066550
2947 C*R*********          Z-ADDZIRATE    ZIRATE 117       RATE OF  S01119066550
2948 C***********                                                   S01119066550
2949 C****TO*DETERMINE NUMBER OF DAYS INTEREST TO BE CALCULATED     S01119066550
2950 C*R*********ZIEND     SUB  ZIBEG     ZDAYN1  50                S01119066550
2951 C***********                                                   S01119066550
2952 C****CHECK*FOR INTEREST CALCULATION BASIS                      S01119066550
2953 C*****USE*OF INDICATRS                                         S01119066550
2954 C*****1,92**2,90  3,91  4,97  5,96  6,95                       S01119066550
2955 C***********          SETOF                     959697         S01119066550
2956 C***********ZICALC    COMP 2                    919290         S01119066550
2957 C**N91******          GOTO ZICAL                               S01119066550
2958 C***********ZICALC    COMP 5                    959796         S01119066550
2959 C***97******ZICALC    COMP 3                    97  91         S01119066550
2960 C***95******                                                   S01119066550
2961 C*R*96******          SETOF                     91             S01119066550
2962 C**N91******          GOTO ZILPCK                              S01119066550
2963 C***********                                                   S01119066550
2964 C*****THIS*CODING WILL CALCULATE THE NUMBER OF DAYS TO USE WHE S01119066550
2965 C*****USING*THE 30/360 BASIS - METHOD 3.                       S01119066550
2966 C***********          EXSR ZSAVE                               S01119066550
2967 C***********          Z-ADDZIBEG     ZDAYNO                    S01119066550
2968 C***********          EXSR ZDATE2                              S01119066550
2969 C***********          MOVE ZDAY      ZISD    20                S01119066550
2970 C***********          MOVE ZMTH      ZISM    20                S01119066550
2971 C***********          MOVE ZYEAR     ZISY    20                S01119066550
2972 C***********          Z-ADDZIEND     ZDAYNO                    S01119066550
2973 C***********          EXSR ZDATE2                              S01119066550
2974 C***********          MOVE ZDAY      ZIFD    20                S01119066550
2975 C***********          MOVE ZMTH      ZIFM    20                S01119066550
2976 C***********          MOVE ZYEAR     ZIFY    20                S01119066550
2977 C***********          EXSR ZRSTOR                              S01119066550
2978 C***********          SETOF                     93             S01119066550
0    C****IN*ORDER FOR THE FINISH YEAR TO BE LESS THAN THE START YE S01119066550
     C****ZIEND*IS GREATER THAN ZIBEG,THEN THE DATE ZIEND MUST BE I S01119066550
     C****DIFFERENT CENTURY TO ZIBEG.IF SO ADD 100 YEARS TO IT.     S01119066550
     C***********ZIEND     COMP ZIBEG                93             S01119066550
     C***93******ZIFY      COMP ZISY                   93           S01119066550
     C***********          Z-ADDZISY      ZISY2   30                S01119066550
     C**N93******          Z-ADDZIFY      ZIFY2   30                S01119066550
     C***93******ZIFY      ADD  100       ZIFY2                     S01119066550
     C***********                                                   S01119066550
     C*****DETERMINE WHETHER START YEAR IS A LEAP YEAR AND IF START S01119066550
     C*****MONTH*IS FEBRUARY.                                       S01119066550
     C***********                                                   S01119066550
     C**N98******          BITOF'0'       ZGLBIT  1                 E80945066550
     C***98******          BITON'0'       ZGLBIT                    E80945066550
     C***********ZISY2     ADD  1900      ZLYCHK  40                S01119066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01119066550
     C***********          MVR            ZLYREM  20                S01119066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01119066550
     C***********ZISM      COMP 2                        99*FEBRUAR S01119066550
2209 C**N99******30        SUB  ZISD      ZID1    50   93           S01119066550
2210 C**N99*93***          Z-ADD0         ZID1                      S01119066550
     C***99N98***28        SUB  ZISD      ZID1                      S01119066550
     C***99*98***29        SUB  ZISD      ZID1                      S01119066550
2211 C***********ZISM      COMP 12                       93         S01119066550
2212 C***93******          Z-ADD0         ZISM                      S01119066550
2213 C***93******ZISY      ADD  1         ZISY                      S01119066550
     C***93******ZISY2     ADD  1         ZISY2                     S01119066550
     C***********                                                   S01119066550
     C*****DETERMINE WHETHER END YEAR IS A LEAP YEAR AND IF END MON S01119066550
     C*****IS*FEBRUARY.                                             S01119066550
     C***********                                                   S01119066550
     C***********ZIFY2     ADD  1900      ZLYCHK  40                S01119066550
     C***********ZLYCHK    DIV  4         ZLYCHK                    S01119066550
     C***********          MVR            ZLYREM  20                S01119066550
     C***********ZLYREM    COMP *ZERO                    98*LEAP YE S01119066550
     C***********ZIFM      COMP 2                        99*FEBRUAR S01119066550
2214 C**N99******ZIFD      COMP 31                       93         S01119066550
2214 C***99N98***ZIFD      COMP 28                       93         S01119066550
2214 C***99*98***ZIFD      COMP 29                       93         S01119066550
     C***********          SETOF                     98             E80945066550
     C***********          TESTB'0'       ZGLBIT         98         E80945066550
2985 C***93******ZID1      ADD  30        ZID1                      S01119066550
2986 C**N93******ZID1      ADD  ZIFD      ZID1                      S01119066550
2987 C***********ZIFM      SUB  1         ZIFM                      S01119066550
     C***********ZISY      COMP ZIFY                     93         S01119066550
2989 C***93******ZIFM      SUB  ZISM      ZINOM   30                S01119066550
2990 C***93******          GOTO ZIOUT                               S01119066550
2991 C***********12        SUB  ZISM      ZIM1    20                S01119066550
2992 C***********          Z-ADD1         ZISM                      S01119066550
     C*****USE*ENLARGED FIELDS THAT CAN HANDLE 1999 ONWARDS         S01119066550
     C***********ZISY2     ADD  1         ZISY2                     S01119066550
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                S01119066550
2995 C***********ZIY1      MULT 12        ZIM2    30                S01119066550
2996 C***********ZIM2      ADD  ZIFM      ZIM2                      S01119066550
2997 C***********ZIM1      ADD  ZIM2      ZINOM                     S01119066550
2998 C***********ZIOUT     TAG                             * ZIOUT  S01119066550
2999 C***********ZINOM     MULT 30        ZID2    50                S01119066550
3000 C***********ZID2      ADD  ZID1      ZDAYN1                    S01119066550
3001 C***********          SETOF                     93             S01119066550
3002 C***********ZILPCK    TAG                             * ZILPCK S01119066550
3003 C**N96N97***          GOTO ZICAL                               S01119066550
3004 C*****THE*FOLLOWING CODING APPLIES FOR METHODS 4 AND 5 ONLY.   S01119066550
3005 C*****1*DAY*IS SUBTRACTED FROM ZDAYN1 FOR EACH OCCURANCE OF 29 S01119066550
3006 C*****IN*THE INTEREST CALCULATION PERIOD INCLUSIVE OF ZIBEG, &.S01119066550
3007 C***********                                                   S01119066550
3008 C*****FIND*NO OF 4 YEAR PERIODS BETWEEN DATES                  S01119066550
3009 C***********ZDAYN1    DIV  1461      ZIMAN   20                S01119066550
3010 C***********          MVR            ZIREM   50                S01119066550
3011 C*****FIND*NEXT 29 FEB DAY NO. ON OR AFTER ZIBEG.              S01119066550
3012 C***********ZIBEG     SUB  60        ZIBW1   50                S01119066550
3013 C***********ZIBW1     DIV  1461      ZIDW1   20                S01119066550
3014 C***********          MVR            ZIDREM  50                S01119066550
3015 C***********ZIDREM    COMP 0                        94         S01119066550
3016 C***94******          Z-ADDZIBEG     ZIDW2   50                S01119066550
3017 C***94******          GOTO ZILP1                               S01119066550
3018 C*****ROUND*UP RESULT                                          S01119066550
3019 C***********ZIDW1     ADD  1         ZIDW2                     S01119066550
3020 C*****CALCULATE NEXT 29 FEB.                                   S01119066550
3021 C***********ZIDW2     MULT 1461      ZIDW2                     S01119066550
3022 C***********ZIDW2     ADD  60        ZIDW2                     S01119066550
3023 C***********ZILP1     TAG                             * ZILP1  S01119066550
3024 C*****IF*THIS NEXT 29 FEB. DAYNO - ZIBEG IS GR. TH. OR EQ. TO  S01119066550
3025 C*****ZIREM*THEN ADD 1 TO ZIMAN.                               S01119066550
3026 C***********ZIDW2     SUB  ZIBEG     ZILPCP  50               S01119 066550
3027 C***********ZIREM     COMP ZILPCP               94  94        S01119 066550
3028 C***94******ZIMAN     ADD  1         ZIMAN                    S01119 066550
3029 C*****SUBTRACT ZIMAN FROM ZDAYN1 TO GIVE VALUE OF ZDAYN1      S01119 066550
3030 C*****REQUIRED FOR THIS INTEREST CALCULATION.                 S01119 066550
3031 C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                   S01119 066550
3032 C***********          SETOF                     94            S01119 066550
3033 C***********ZICAL     TAG                             * ZICAL S01119 066550
3034 C***********                                                  S01119 066550
3035 C****CALCULATE INTEREST                                       S01119 066550
3036 C***90******                                                  S01119 066550
3037 C*R*91******                                                  S01119 066550
3038 C*R*96******ZIAMT     DIV  36000     ZIWRK1 155H              S01119 066550
3039 C***92******                                                  S01119 066550
3040 C*R*97******ZIAMT     DIV  36500     ZIWRK1    H              S01119 066550
3041 C***95******ZIAMT     DIV  36600     ZIWRK1    H              S01119 066550
3042 C*R*********ZIWRK1    MULT ZIRATE    ZIWRK2 155H               S01119066550
3043 C*R*********ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF  S01119066550
3044 C***********                                                   S01119066550
3045 C***********          SETOF                     909192         S01119066550
3046 C***********          SETOF                     959697         S01119066550
3047 C*R*********          ENDSR                                    S01119066550
3048 C***********                                                   S01119066550
3049 C**************************************************************S01119066550
     C/EJECT                                                              S01119
4842 C********************************************************************S01119
4843 C**                                                                  S01119
4844 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            S01119
4845 C**                                                                  S01119
4846 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01119
4847 C**                                                                  S01119
4848 C           ZDATE2    BEGSR                           *** ZDATE2 *** S01119
4849 C**                                                                  S01119
4850 C**   CLEAR DATE FIELDS.                                             S01119
4851 C                     Z-ADD0         ZDATE   60                      S01119
4852 C                     MOVEL'       ' ZADATE  7                       S01119
4853 C**                                                                  S01119
4854 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        S01119
4855 C                     Z-ADDZDAYNO    ZDAYNO  50                      S01119
4856 C**                                                                  S01119
4857 C**   DETERMINE YEAR NUMBER.                                         S01119
4858 C**                                                                  S01119
4859 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    S01119
4860 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 S01119
4861 C   99                GOTO ZDEND2                                    S01119
4862 C**                                                                  S01119
4863 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             S01119
4864 C           ZDAYN1    DIV  1461      ZLYR    20                      S01119
4865 C                     MVR            ZDAYN1           SAVE REMAINING S01119
4866 C**                                                   DAYS           S01119
4867 C**   CALCULATE NUMBER OF REMAINING YEARS.                           S01119
4868 C                     Z-ADD1         ZWRK2   20                      S01119
4869 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *S01119
4870 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 S01119
4871 C  N90      ZWRK2     ADD  1         ZWRK2                           S01119
4872 C  N90                GOTO ZDTAG1                                    S01119
4873 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON S01119
4874 C**                                                                  S01119
4875 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  S01119
4876 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          S01119
4877 C**                                                                  S01119
4878 C**   CALCULATE ACTUAL YEAR NUMBER.                                  S01119
4879 C           ZLYR      MULT 4         ZWRK3   30                      S01119
4880 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   S01119
4881 C                     Z-ADDZWRK3     ZYEAR   20                      S01119
4882 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           S01119
4883 C**                                                                  S01119
4884 C**   DETERMINE MONTH NUMBER.                                        S01119
4885 C**                                                                  S01119
4886 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         S01119
4887 C                     SETOF                     9293                 S01119
4888 C   91      ZDAYN1    COMP 59                     9293               S01119
4889 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          S01119
4890 C**                                                                  S01119
4891 C**   CALCULATE MONTH NUMBER.                                        S01119
4892 C                     Z-ADD2         ZWRK2                           S01119
4893 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *S01119
4894 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 S01119
4895 C  N94      ZWRK2     ADD  1         ZWRK2                           S01119
4896 C  N94                GOTO ZDTAG2                                    S01119
4897 C           ZWRK2     SUB  1         ZWRK2                           S01119
4898 C**                                                                  S01119
4899 C                     Z-ADDZWRK2     ZMTH    20       MONTH          S01119
4900 C**                                                                  S01119
4901 C**   DETERMINE DAY OF MONTH.                                        S01119
4902 C**                                                                  S01119
4903 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          S01119
4904 C           ZDAYN1    ADD  1         ZDAYN1                          S01119
4905 C**                                                                  S01119
4906 C**   CALCULATE DAY OF MONTH.                                        S01119
4907 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            S01119
4908 C**                                                                  S01119
4909 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       S01119
4910 C   93      ZDAY      ADD  1         ZDAY                            S01119
4911 C**                                                                  S01119
4912 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 S01119
4913 C  N98                MOVELZDAY      ZWRK4   40                      S01119
4914 C   98                MOVE ZDAY      ZWRK4                           S01119
4915 C  N98                MOVE ZMTH      ZWRK4                           S01119
4916 C   98                MOVELZMTH      ZWRK4                           S01119
4917 C                     MOVELZWRK4     ZDATE                           S01119
4918 C                     MOVE ZYEAR     ZDATE                           S01119
4919 C**                                                                  S01119
4920 C**   FORMAT ALPHA DATE, DDMMMYY.                                    S01119
4921 C           ZDAY      COMP 10                     95                 S01119
4922 C                     MOVELZDAY      ZWRK5   5                       S01119
4923 C   95                MOVEL' '       ZWRK5                           S01119
4924 C                     MOVE ZMNM,ZMTH ZWRK5                           S01119
4925 C                     MOVELZWRK5     ZADATE                          S01119
4926 C                     MOVE ZYEAR     ZADATE                          S01119
4927 C**                                                                  S01119
4928 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*S01119
4929 C**                                                                  S01119
4930 C**                                                                  S01119
4931 C********************************************************************S01119
     C/EJECT                                                              S01119
3050 C********************************************************************S01119
3052 C**   ZSAVE SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS   S01119
3053 C**              90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.         S01119
3055 C**   THIS SR. IS REQUIRED ONLY IF INDICATORS                        S01119
3056 C**   90 - 97 ARE USED ELSEWHERE IN A PROGRAM.                       S01119
3057 C**                                                                  S01119
3058 C           ZSAVE     BEGSR                           *** ZSAVE ***  S01119
3059 C**                                                                  S01119
3060 C                     BITOF'01234567'ZBITS   1                       S01119
3059 C**                                                                  S01119
3061 C   90                BITON'0'       ZBITS                           S01119
3062 C   91                BITON'1'       ZBITS                           S01119
3063 C   92                BITON'2'       ZBITS                           S01119
3064 C   93                BITON'3'       ZBITS                           S01119
3065 C   94                BITON'4'       ZBITS                           S01119
3066 C   95                BITON'5'       ZBITS                           S01119
3067 C   96                BITON'6'       ZBITS                           S01119
3068 C   97                BITON'7'       ZBITS                           S01119
3059 C**                                                                  S01119
3070 C                     SETOF                     909192               S01119
3071 C                     SETOF                     939495               S01119
3072 C                     SETOF                     9697                 S01119
3076 C**                                                                  S01119
3074 C                     ENDSR                                          S01119
3077 C********************************************************************S01119
     C/SPACE 2                                                            S01119
3078 C********************************************************************S01119
3080 C**   ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS       S01119
3081 C**              THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.         S01119
3082 C**                                                                  S01119
3083 C           ZRSTOR    BEGSR                           *** ZRSTOR *** S01119
3084 C**                                                                  S01119
3085 C                     TESTB'0'       ZBITS          90               S01119
3086 C                     TESTB'1'       ZBITS          91               S01119
3087 C                     TESTB'2'       ZBITS          92               S01119
3088 C                     TESTB'3'       ZBITS          93               S01119
3089 C                     TESTB'4'       ZBITS          94               S01119
3090 C                     TESTB'5'       ZBITS          95               S01119
3091 C                     TESTB'6'       ZBITS          96               S01119
3092 C                     TESTB'7'       ZBITS          97               S01119
3093 C**                                                                  S01119
3094 C                     ENDSR                                          S01119
3097 C********************************************************************S01119
     C/EJECT                                                              S01119
4631 C********************************************************************S01119
4632 C**                                                                  S01119
4633 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND                     S01119
4634 C**              CONVERT TO A NUMBER OF DAYS.                        S01119
4635 C**                                                                  S01119
4636 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01119
4637 C**                                                                  S01119
4638 C           ZDATE1    BEGSR                           *** ZDATE1 *** S01119
4639 C**                                                                  S01119
4640 C**   CLEAR DAY NUMBER.                                              S01119
4641 C                     Z-ADD0         ZDAYNO  50                      S01119
4642 C**                                                                  S01119
4643 C**   CALCULATION TO DEFINE INPUT DATE FIELD.                        S01119
4644 C                     Z-ADDZDATE     ZDATE   60                      S01119
4645 C**                                                                  S01119
4646 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.                     S01119
4647 C                     MOVE ZDATE     ZYEAR   20                      S01119
4648 C  N98                MOVELZDATE     ZDAY    20                      S01119
4649 C   98                MOVELZDATE     ZMTH    20                      S01119
4650 C                     MOVE ZDATE     ZWRK4   40                      S01119
4651 C  N98                MOVELZWRK4     ZMTH                            S01119
4652 C   98                MOVELZWRK4     ZDAY                            S01119
4653 C**                                                                  S01119
4654 C**   ENSURE MONTH IS VALID.                                         S01119
4655 C           ZMTH      COMP 0                      9999               S01119
4656 C  N99      ZMTH      COMP 12                   99                   S01119
4657 C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
4658 C**                                                                  S01119
4659 C**   CHECK FOR 30 DAY MONTHS.                                       S01119
4660 C           ZMTH      COMP 4                        90IF 90 ON, 30   S01119
4661 C  N90      ZMTH      COMP 6                        90DAY MONTH.     S01119
4662 C  N90      ZMTH      COMP 9                        90               S01119
4663 C  N90      ZMTH      COMP 11                       90               S01119
4664 C**                                                                  S01119
4665 C**   ENSURE DAY IS VALID.                                           S01119
4666 C           ZDAY      COMP 0                      9999               S01119
4667 C   90N99   ZDAY      COMP 30                   99                   S01119
4668 C  N90N99   ZDAY      COMP 31                   99                   S01119
4669 C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
4670 C**                                                                  S01119
4671 C**   CHECK FOR LEAP YEAR AND FEBRUARY.                              S01119
4672 C           ZYEAR     ADD  28        ZYEAR                           S01119
4673 C           ZYEAR     DIV  4         ZLYR    20                      S01119
4674 C                     MVR            ZLY     10     91LEAP YR, 91 ON S01119
4675 C           ZMTH      COMP 2                    93  92FEB., 92 ON    S01119
4676 C**                                                   PAST FEB, 93 ONS01119
4677 C**   IF FEBUARY FURTHER VALIDATE DAY.                               S01119
4678 C  N91 92   ZDAY      COMP 28                   99                   S01119
4679 C   91 92   ZDAY      COMP 29                   99                   S01119
4680 C   99                GOTO ZDEND1                     BYPASS IF ERRORS01119
4681 C**                                                                  S01119
4682 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANSS01119
4683 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.S01119
4684 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YRS01119
4685 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.S01119
4686 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR S01119
4687 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTHS01119
4688 C**                                                                  S01119
4689 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*S01119
4690 C**                                                                  S01119
4691 C**                                                                  S01119
4692 C********************************************************************S01119
     C/EJECT                                                              S01119
0726 C*****************************************************************   S01194
1024 C*    ERROR DUMP SUBROUTINE.                                         S01194
1048 C*                                                                   S01194
1034 C           *PSSR     BEGSR                           ***  PSSR **   S01194
1020 C           @RUN      IFEQ *BLANK                                    S01194
1021 C                     MOVE 'Y'       @RUN    1                       S01194
1020 C                     DUMP                                           S01194
1021 C                     END                                            S01194
1022 C                     ENDSR                           *** *PSSR **   S01194
1048 C**                                                                  S01194
0726 C*****************************************************************   S01194
      /EJECT                                                              CIR001
      *****************************************************************   CIR001
      *                                                               *   CIR001
      *  S/R #LCASS - Determine next cash flow schedule               *   CIR001
      *                                                               *   CIR001
      *****************************************************************   CIR001
     C           #LCASS    BEGSR                                          CIR001
     C                     Z-ADDZIEND     PRDT                            CIR001
     C           IRSCFL    CHAINDLCFSCD0             99                   CIR001
     C           *IN99     IFEQ '1'                                       CIR001
     C                     Z-ADD0         CFLA                            CIR001
     C                     END                                            CIR001
     C                     ENDSR                                          CIR001
      *****************************************************************   CIR001
      /EJECT                                                              CIR001
      *****************************************************************   CIR001
      *                                                               *   CIR001
      *  S/R #LRATS - Determine next rate change/payment schedule     *   CIR001
      *                                                               *   CIR001
      *****************************************************************   CIR001
     C           #LRATS    BEGSR                                          CIR001
     C                     Z-ADDZDAYNO    PRDT                            CIR001
     C           IRSDTL    SETGTDLDTSCD0                                  CIR001
     C           IRSDTP    READEDLDTSCD0                 99               CIR001
     C           *IN99     IFEQ '0'                                       CIR001
     C                     Z-ADDPRDT      ZDAYNO                          CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADDMDAT      ZDAYNO                          CIR001
     C                     END                                            CIR001
     C                     ENDSR                                          CIR001
      *****************************************************************   CIR001
      /EJECT                                                              CIR001
      *****************************************************************   CIR001
      *                                                               *   CIR001
      *  S/R #LINUF - Calculate interest up front                     *   CIR001
      *                                                               *   CIR001
      *****************************************************************   CIR001
     C           #LINUF    BEGSR                                          CIR001
      *                                                                   CIR001
      ** Calculate interest from interest accrual control date            CIR001
      ** to end date (this payment date to next payment date)             CIR001
      *                                                                   CIR001
     C                     Z-ADDSZAICD    ZIBEG                           CIR001
     C                     Z-ADDSZEDAT    ZIEND                           CIR001
     C                     Z-ADDSZPPL     ZIAMT                           CIR001
     C                     Z-ADDSZINR     ZIRATE                          CIR001
     C                     Z-ADDSZCBS     ZICALC                          CIR001
     C                     EXSR GLINTC                                    CIR001
     C/COPY WNCPYSRC,DL0279C036
      *                                                                   CIR001
      ** Calculate interest on yield (method is 'Y') basis.               CIR001
      *                                                                   CIR001
     C           SZINPM    IFEQ 'Y'                                       CIR001
     C                     EXSR #LINDY                                    CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
      ** Add interest accrued to control date, accrued interest           CIR001
      ** adjustments posted/not posted, and interest computed             CIR001
      ** to obtain the accrued interest to date.                          CIR001
      *                                                                   CIR001
     C           SZIACD    ADD  SZIANP    SZAITD 130                      CIR001
     C                     ADD  SZAIAP    SZAITD 130                      CIR001
     C                     ADD  ZINTR     SZAITD    H                     CIR001
      *                                                                   CIR001
      ** Subtract interest paid/received to date from accrued interest    CIR001
      ** to date to give interest due.                                    CIR001
      *                                                                   CIR001
     C           SZAITD    SUB  SZIPRD    INTD                            CIR001
      *                                                                   CIR001
     C                     ENDSR                                          CIR001
      *****************************************************************   CIR001
      /EJECT                                                              CIR001
      *****************************************************************   CIR001
      *                                                               *   CIR001
      *  S/R #LINDY - Calculate interest on discount/yield basis      *   CIR001
      *                                                               *   CIR001
      *****************************************************************   CIR001
     C           #LINDY    BEGSR                                          CIR001
      *                                                                   CIR001
      ** Interest = Principal ( 1 - 1 / ( 1 + Rate X Number of days/360)) CIR001
      **          = Principal ( 1 - 360 / ( 360 + Rate X Number of days)) CIR001
      *                                                                   CIR001
     C           ZICALC    IFEQ 2                                         CIR001
     C           ZICALC    OREQ 3                                         CIR001
     C           ZICALC    OREQ 5                                         CIR001
     C           ZICALC    OREQ 7                                         CIR004
     C           CIR004    ANDEQ'Y'                                       CIR004
     C                     Z-ADD36000     ZIWRK3  50                      CIR001
     C                     ELSE                                           CIR001
     C           ZICALC    IFEQ 1                                         CIR001
     C           ZICALC    OREQ 4                                         CIR001
     C           ZICALC    OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'N'                                       CIR013
     C                     Z-ADD36500     ZIWRK3                          CIR001
     C                     ELSE                                           CIR001
     C                     Z-ADD36600     ZIWRK3                          CIR001
     C                     END                                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           ZICALC    IFEQ 6                                         CIR013
     C           ZICALC    OREQ 9                                         CIR013
     C           #29FEB    ANDEQ'Y'                                       CIR013
     C           INT6DY    MULT ZIRATE    ZIWRK4 157                      CIR013
     C                     ELSE                                           CIR013
     C           ZZINDY    MULT ZIRATE    ZIWRK4 157                      CIR001
     C                     ENDIF                                          CIR013
     C                     ADD  ZIWRK3    ZIWRK4                          CIR001
      *                                                                   CIR001
     C           ZIWRK3    DIV  ZIWRK4    ZIWRK5 159H                     CIR001
     C           1         SUB  ZIWRK5    ZIWRK5                          CIR001
     C           ZIAMT     MULT ZIWRK5    ZINTR     H                     CIR001
     C                     ENDSR                                          CIR001
      *****************************************************************   CIR001
      /EJECT                                                              CIR001
      *****************************************************************   CIR001
      *                                                               *   CIR001
      *  S/R #LEFIN - Update the effective interest rate              *   CIR001
      *                                                               *   CIR001
      *****************************************************************   CIR001
     C           #LEFIN    BEGSR                                          CIR001
      *                                                                   CIR001
     C           WSPIN     IFEQ *BLANK                                    CIR001
     C                     Z-ADDWBRTE     RATE                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           WSPIN     IFEQ 'A'                                       CIR001
     C           WBRTE     ADD  WRTSP     RATE                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           WSPIN     IFEQ 'S'                                       CIR001
     C           WBRTE     SUB  WRTSP     RATE                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C           WSPIN     IFEQ 'P'                                       CIR001
     C           WRTSP     DIV  100       WK119  119                      CIR001
     C           WBRTE     MULT WK119     RATE      H                     CIR001
     C                     ADD  WBRTE     RATE                            CIR001
     C                     END                                            CIR001
      *                                                                   CIR001
     C                     ENDSR                                          CIR001
      *****************************************************************   CIR003
      *                                                               *   CIR003
      *  SREXCH - Principal Exchange Message Generation               *   CIR003
      *                                                               *   CIR003
      *****************************************************************   CIR003
     C           SREXCH    BEGSR                                          CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   WREAD   1                       CIR003
     C                     TESTB'0'       TLXI       21                   CIR003
      *                                                                   CIR003
      ** Generate value date exchange messages                            CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C           VDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'VAL'     KEDCD   3                       CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY    9                       CIR003
     C                     MOVE 'VAL'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'010'     DBASE            * DBERR 10 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
      *                                                                   CIR003
      ** Process THEIR side                                               CIR003
      *                                                                   CIR003
     C                     MOVE 'V'       WREAD                           CIR003
     C                     Z-ADDRXPSTM    WSETM   20                      CIR003
     C                     MOVELTCUCY     WCCY    3                       CIR003
     C                     Z-ADDVDAT      WDATE   50                      CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C                     Z-ADDTPAMT     PIAMT                           CIR003
     C                     MOVEL't'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI3                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTOUR                                       CIR003
     C                     BITON'0'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     TESTB'1'       TLXI       21                   CIR003
      *                                                                   CIR003
      ** Process OUR side                                                 CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C           VDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C           WREAD     IFNE 'V'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'VAL'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'VAL'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'011'     DBASE            * DBERR 11 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
      *                                                                   CIR003
     C                     MOVE 'V'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADDRXRSTM    WSETM   20                      CIR003
     C                     MOVELUCUCY     WCCY    3                       CIR003
     C                     Z-ADDVDAT      WDATE                           CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C                     Z-ADDUPAMT     RIAMT                           CIR003
     C                     MOVEL'o'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI1                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTTHEIR                                     CIR003
     C                     BITON'1'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     TESTB'5'       TLXI       21                   CIR003
      *                                                                   CIR003
      ** Generate maturity date exchange messages                         CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C           MDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C           WREAD     IFNE 'M'                                       CIR003
     C                     MOVEL'MAT'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY    9                       CIR003
     C                     MOVE 'MAT'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'012'     DBASE            * DBERR 12 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'M'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Process THEIR side                                               CIR003
      *                                                                   CIR003
      ** In case maturity message is produced on a principal change date,                    BUG6995
      ** look for the last principal amount before maturity date to make                     BUG6995
      ** sure message will contain the correct maturity principal.                           BUG6995
      *                                                                                      BUG6995
     C           WDLPK2    KLIST                                                             BUG6995
     C                     KFLD           DLNO                                               BUG6995
     C                     KFLD           KUOTIN                                             BUG6995
      *                                                                                      BUG6995
     C                     Z-ADDTPAMT     LTPAMT 150                                         BUG6995
     C                     MOVEL'T'       KUOTIN                                             BUG6995
     C                     Z-ADDVDAT      KPRDT                                              BUG6995
     C                     MOVEL'0'       *IN43                                              BUG6995
      *                                                                                      BUG6995
     C           WDLPKY    SETGTDLPCSCL0                                                     BUG6995
     C           WDLPK2    READEDLPCSCL0                 43                                  BUG6995
      *                                                                                      BUG6995
     C           *IN43     DOWEQ'0'                                                          BUG6995
     C                     Z-ADDPAMT      LTPAMT                                             BUG6995
     C           WDLPK2    READEDLPCSCL0                 43                                  BUG6995
     C                     ENDDO                                                             BUG6995
      *                                                                                      BUG6995
     C                     Z-ADDRXRSTM    WSETM                           CIR003
     C                     MOVELTCUCY     WCCY                            CIR003
     C           BOVD      IFNE 0                                                             233128
     C                     Z-ADDBOVD      WDATE                                               233128
     C                     ELSE                                                               233128
     C                     Z-ADDMDAT      WDATE                           CIR003
     C                     ENDIF                                                              233128
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C**********           Z-ADDTPAMT     RIAMT                                       CIR003 BUG6995
     C                     Z-ADDLTPAMT    RIAMT                                              BUG6995
     C                     MOVEL'T'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI1                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTTHEIR                                     CIR003
     C                     BITON'5'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     TESTB'6'       TLXI       21                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C           MDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C           WREAD     IFNE 'M'                                       CIR003
     C                     MOVEL'MAT'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'MAT'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'013'     DBASE            * DBERR 13 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'M'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Process OUR side                                                 CIR003
      *                                                                   CIR003
      ** In case maturity message is produced on a principal change date,                    BUG6995
      ** look for the last principal amount before maturity date to make                     BUG6995
      ** sure message will contain the correct maturity principal.                           BUG6995
      *                                                                                      BUG6995
     C                     Z-ADDUPAMT     LUPAMT 150                                         BUG6995
     C                     MOVEL'U'       KUOTIN                                             BUG6995
     C                     Z-ADDVDAT      KPRDT                                              BUG6995
     C                     MOVEL'0'       *IN43                                              BUG6995
      *                                                                                      BUG6995
     C           WDLPKY    SETGTDLPCSCL0                                                     BUG6995
     C           WDLPK2    READEDLPCSCL0                 43                                  BUG6995
      *                                                                                      BUG6995
     C           *IN43     DOWEQ'0'                                                          BUG6995
     C                     Z-ADDPAMT      LUPAMT                                             BUG6995
     C           WDLPK2    READEDLPCSCL0                 43                                  BUG6995
     C                     ENDDO                                                             BUG6995
      *                                                                                      BUG6995
     C                     Z-ADDRXPSTM    WSETM                           CIR003
     C                     MOVELUCUCY     WCCY                            CIR003
     C           BOVD      IFNE 0                                                             233128
     C                     Z-ADDBOVD      WDATE                                               233128
     C                     ELSE                                                               233128
     C                     Z-ADDMDAT      WDATE                           CIR003
     C                     ENDIF                                                              233128
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C**********           Z-ADDUPAMT     PIAMT                                       CIR003 BUG6995
     C                     Z-ADDLUPAMT    PIAMT                                              BUG6995
     C                     MOVEL'O'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI3                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTOUR                                       CIR003
     C                     BITON'6'       TLXI                            CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Generate principal change date exchanges messages (THEIR side)   CIR003
      ** only when it is less than buy-out value date                                         233128
      *                                                                   CIR003
     C           BOVD      IFEQ 0                                                             233128
     C           BOVD      ORNE 0                                                             233128
     C           TNPCD     ANDLTBOVD                                                          233128
      *                                                                                       233128
     C           TNPCD     IFNE 0                                         CIR003
     C           PDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'T'       KUOTIN  1                       CIR003
     C                     Z-ADDTNPCD     KPRDT                           CIR003
     C           WDLPKY    CHAINDLPCSCL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY2   7                       CIR003
     C                     MOVE 'T'       WKEY2                           CIR003
     C                     MOVELWKEY2     WKEY3  12                       CIR003
     C                     MOVE TNPCD     WKEY3                           CIR003
     C                     MOVEL'DLPCSCL0'DBFILE           ************   CIR003
     C                     MOVEL'014'     DBASE            * DBERR 14 *   CIR003
     C                     MOVELWKEY3     DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           PMTP      IFNE 'Y'                                       CIR003
      *                                                                   CIR003
      ** Principal Increase                                               CIR003
      *                                                                   CIR003
     C           TPAMT     IFLT PAMT                                      CIR003
      *                                                                   CIR003
     C           WREAD     IFNE 'V'                                       CIR003
     C                     MOVEL'VAL'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'VAL'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'015'     DBASE            * DBERR 15 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'V'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADDRXPSTM    WSETM                           CIR003
     C                     MOVELTCUCY     WCCY                            CIR003
     C                     Z-ADDTNPCD     WDATE                           CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C           PAMT      SUB  TPAMT     PIAMT                           CIR003
     C                     MOVEL't'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI3                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTOUR                                       CIR003
     C                     MOVE 'Y'       PMTP                                               BUG6995
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Principal Decrease                                               CIR003
      *                                                                   CIR003
     C           TPAMT     IFGT PAMT                                      CIR003
     C           WREAD     IFNE 'M'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'MAT'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'MAT'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'016'     DBASE            * DBERR 16 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'M'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADDRXRSTM    WSETM                           CIR003
     C                     MOVELTCUCY     WCCY                            CIR003
     C                     Z-ADDTNPCD     WDATE                           CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C           TPAMT     SUB  PAMT      RIAMT                           CIR003
     C                     MOVEL'T'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI1                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTTHEIR                                     CIR003
     C                     MOVE 'Y'       PMTP                                               BUG6995
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C**********           MOVE 'Y'       PMTP                                        CIR003 BUG6995
     C                     UPDATDLPCSCD0                                  CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                                       233128
     C                     ENDIF                                                              233128
      *                                                                   CIR003
      ** Generate principal change date exchanges messages (OUR side)     CIR003
      ** only when it is less than buy-out value date                                         233128
      *                                                                   CIR003
     C           BOVD      IFEQ 0                                                             233128
     C           BOVD      ORNE 0                                                             233128
     C           UNPCD     ANDLTBOVD                                                          233128
      *                                                                                       233128
     C           UNPCD     IFNE 0                                         CIR003
     C           PDEI      ANDEQ'Y'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'U'       KUOTIN                          CIR003
     C                     Z-ADDUNPCD     KPRDT   50                      CIR003
     C           WDLPKY    CHAINDLPCSCL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY2   7                       CIR003
     C                     MOVE 'U'       WKEY2                           CIR003
     C                     MOVELWKEY2     WKEY3  12                       CIR003
     C                     MOVE UNPCD     WKEY3                           CIR003
     C                     MOVEL'DLPCSCL0'DBFILE           ************   CIR003
     C                     MOVEL'017'     DBASE            * DBERR 17 *   CIR003
     C                     MOVELWKEY3     DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           PMTP      IFNE 'Y'                                       CIR003
      *                                                                   CIR003
      ** Principal Increase                                               CIR003
      *                                                                   CIR003
     C           UPAMT     IFLT PAMT                                      CIR003
      *                                                                   CIR003
     C           WREAD     IFNE 'V'                                       CIR003
     C                     MOVEL'VAL'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'VAL'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'018'     DBASE            * DBERR 18 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'V'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADDRXRSTM    WSETM                           CIR003
     C                     MOVELUCUCY     WCCY                            CIR003
     C                     Z-ADDUNPCD     WDATE                           CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C           PAMT      SUB  UPAMT     RIAMT                           CIR003
     C                     MOVEL'o'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI1                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTTHEIR                                     CIR003
     C                     MOVE 'Y'       PMTP                                               BUG6995
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
      ** Principal Decrease                                               CIR003
      *                                                                   CIR003
     C           UPAMT     IFGT PAMT                                      CIR003
     C           WREAD     IFNE 'M'                                       CIR003
      *                                                                   CIR003
     C                     MOVEL'MAT'     KEDCD                           CIR003
     C           WDLKEY    CHAINDLGXSTL0             21                   CIR003
      *                                                                   CIR003
      ** Database Error                                                   CIR003
      *                                                                   CIR003
     C           *IN21     IFEQ '1'                                       CIR003
     C                     MOVELDLNO      WKEY                            CIR003
     C                     MOVE 'MAT'     WKEY                            CIR003
     C                     MOVEL'DLGXSTL0'DBFILE           ************   CIR003
     C                     MOVEL'019'     DBASE            * DBERR 19 *   CIR003
     C                     MOVELWKEY      DBKEY            ************   CIR003
     C                     MOVEL'*KEY   ' DBOPTN                          CIR003
     C                     SETON                     U7U8LR               CIR003
     C                     EXSR *PSSR                                     CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ELSE                                           CIR003
     C                     MOVE 'M'       WREAD                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     Z-ADDRXPSTM    WSETM                           CIR003
     C                     MOVELUCUCY     WCCY                            CIR003
     C                     Z-ADDUNPCD     WDATE                           CIR003
     C                     EXSR SRCHKM                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDEX                                     CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WGMSG     IFEQ 'Y'                                       CIR003
     C                     EXSR SRINLN                                    CIR003
     C           UPAMT     SUB  PAMT      PIAMT                           CIR003
     C                     MOVEL'O'       CNRQ                            CIR003
     C                     MOVEL'1'       PRI3                            CIR003
     C                     ADD  1         DLCT                            CIR003
     C                     Z-ADDWDATE     EVDAT                           CIR003
     C                     EXCPTOUR                                       CIR003
     C                     MOVE 'Y'       PMTP                                               BUG6995
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C**********           MOVE 'Y'       PMTP                                        CIR003 BUG6995
     C                     UPDATDLPCSCD0                                  CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                                       233128
     C                     ENDIF                                                              233128
      *                                                                   CIR003
     C           ENDEX     ENDSR                                          CIR003
      *****************************************************************   CIR003
      *                                                               *   CIR003
      *  SRCHKM - Determines when Messages are to be Generated        *   CIR003
      *                                                               *   CIR003
      *****************************************************************   CIR003
     C           SRCHKM    BEGSR                                          CIR003
      *                                                                   CIR003
     C                     MOVE *BLANKS   WGMSG   1                       CIR003
      *                                                                   CIR003
     C           WSETM     IFEQ 01                                        CIR003
     C           WSETM     OREQ 02                                        CIR003
     C           WSETM     OREQ 07                                        CIR003
     C           WSETM     OREQ 08                                        CIR003
     C           WSETM     OREQ 12                                        CIR003
      *                                                                   CIR003
     C                     CLEARTCYN1                                     CIR003
     C                     MOVELWCCY      TCYN1                           CIR003
     C                     Z-ADD1         X                               CIR003
     C           TCYN1     LOKUPCN,X                     22               CIR003
      *                                                                   CIR003
     C           *IN22     IFEQ '0'                                       CIR003
     C                     MOVELTCYN1     ZCCY1                           CIR003
     C                     MOVE *BLANKS   ZNOS1                           CIR003
     C                     EXSR TLXNOT                                    CIR003
      *                                                                   CIR003
     C           *INU7     IFEQ '1'                                       CIR003
     C                     GOTO ENDCH                                     CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           WDATE     IFLE TNDA,X                                    CIR003
     C                     MOVE 'Y'       WGMSG                           CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C                     ELSE                                           CIR003
     C           WDATE     IFLE TNDAL                                     CIR003
     C                     MOVE 'Y'       WGMSG                           CIR003
     C                     ENDIF                                          CIR003
     C                     ENDIF                                          CIR003
      *                                                                   CIR003
     C           ENDCH     ENDSR                                          CIR003
     C*****************************************************************   CIR003
      *                                                               *   CIR003
      *  SRINLN - Initialisation of Fields                            *   CIR003
      *                                                               *   CIR003
      *****************************************************************   CIR003
     C           SRINLN    BEGSR                                          CIR003
      *                                                                   CIR003
     C                     Z-ADD0         TDNWD                           CIR003
     C                     Z-ADD0         PIAMT                           CIR003
     C                     Z-ADD0         RIAMT                           CIR003
     C                     Z-ADD0         PRI1                            CIR003
     C                     Z-ADD0         PRI2                            CIR003
     C                     Z-ADD0         PRI3                            CIR003
     C                     Z-ADD0         UFIR                            CIR003
     C                     Z-ADD0         TFIR                            CIR003
     C                     Z-ADD0         EVDAT                           CIR003
     C                     Z-ADD0         TAXPY                           CIR003
      *                                                                   CIR003
     C                     ENDSR                                          CIR003
      *****************************************************************   CIR001
      *****************************************************************                       232817
      *                                                               *                       232817
      *  SRBUY - PROCESS BUY OUTS                                     *                       232817
      *                                                               *                       232817
      *****************************************************************                       232817
     C           SRBUY     BEGSR                                                              232817
      *                                                                                       233128
     C           BAPR      IFEQ 'P'                                                           233128
     C                     TESTB'7'       UDSTI          04                                   233128
     C                     Z-ADDPSETM     WSETM                                               233128
     C                     MOVELUCUCY     WCCY                                                233128
     C                     ELSE                                                               233128
     C                     TESTB'7'       TDSTI          04                                   233128
     C                     Z-ADDRSETM     WSETM                                               233128
     C                     MOVELTCUCY     WCCY                                                233128
     C                     ENDIF                                                              233128
      *                                                                                       233128
     C                     Z-ADDBOVD      WDATE                                               233128
     C                     EXSR SRCHKM                                                        233128
      *                                                                                       233128
      ** If pay/receive message not yet generated and                                         233128
      ** buy-out value date within telex notice days                                          233128
      *                                                                                       233128
     C           *IN04     IFEQ '0'                                                           233128
     C           WGMSG     ANDEQ'Y'                                                           233128
      *                                                                                       232817
     C                     Z-ADD0         PIAMT                                               232817
     C                     Z-ADD0         RIAMT                                               232817
     C                     Z-ADD0         PRI1                                                232817
     C                     Z-ADD0         PRI2                                                232817
     C                     Z-ADD0         PRI3                                                232817
     C                     Z-ADDBOVD      EVDAT                                               232817
     C           DLCT      ADD  1         DLCT                                                232817
     C           BAPR      IFEQ 'P'                                                           232817
     C                     Z-ADDBOAM      PIAMT                                               232817
     C                     Z-ADD1         PRI3                                                232817
     C                     MOVE 'O'       CNRQ                                                236956
     C                     EXCPTOUR                                                           232817
     C                     BITON'7'       UDSTI                                               233128
     C                     ELSE                                                               232817
     C                     Z-ADDBOAM      RIAMT                                               232817
     C                     Z-ADD1         PRI1                                                232817
     C                     MOVE 'T'       CNRQ                                                236956
     C                     EXCPTTHEIR                                                         232817
     C                     BITON'7'       TDSTI                                               233128
     C                     ENDIF                                                              232817
      *                                                                                       232817
     C                     ENDIF                                                              233128
      *                                                                                       233128
     C                     ENDSR                                                              232817
      *****************************************************************                       232817
      /EJECT                                                                                  237893
      *****************************************************************                       237893
      *                                                               *                       237893
      *  SRUPFE - GENERATE P/R MESSAGE FOR UP-FRONT FEE               *                       237893
      *                                                               *                       237893
      *****************************************************************                       237893
     C           SRUPFE    BEGSR                                                              237893
      *                                                                                       237893
     C           UPPR      IFEQ 'P'                                                           237893
     C                     TESTB'6'       UDSTI          03                                   237893
     C                     Z-ADDPSETM     WSETM                                               237893
     C                     MOVELUCUCY     WCCY                                                237893
     C                     ELSE                                                               237893
     C                     TESTB'6'       TDSTI          03                                   237893
     C                     Z-ADDRSETM     WSETM                                               237893
     C                     MOVELTCUCY     WCCY                                                237893
     C                     ENDIF                                                              237893
      *                                                                                       237893
     C                     Z-ADDUPVD      WDATE                                               237893
     C                     EXSR SRCHKM                                                        237893
      *                                                                                       237893
      ** If pay/receive message not yet generated and up-front                                237893
      ** fee value date is within telex notice days, generate                                 237893
      ** pay/receive message for up-front fee.                                                237893
      *                                                                                       237893
     C           *IN03     IFEQ '0'                                                           237893
     C           WGMSG     ANDEQ'Y'                                                           237893
      *                                                                                       237893
     C                     Z-ADD0         PIAMT                                               237893
     C                     Z-ADD0         RIAMT                                               237893
     C                     Z-ADD0         PRI1                                                237893
     C                     Z-ADD0         PRI2                                                237893
     C                     Z-ADD0         PRI3                                                237893
     C                     Z-ADDUPVD      EVDAT                                               237893
     C           DLCT      ADD  1         DLCT                                                237893
      *                                                                                       237893
     C           UPPR      IFEQ 'P'                                                           237893
     C                     Z-ADDUPFE      PIAMT                                               237893
     C                     Z-ADD1         PRI3                                                237893
     C                     MOVE 'P'       CNRQ                                                237893
     C                     EXCPTOUR                                                           237893
     C                     BITON'6'       UDSTI                                               237893
     C                     ELSE                                                               237893
     C                     Z-ADDUPFE      RIAMT                                               237893
     C                     Z-ADD1         PRI1                                                237893
     C                     MOVE 'P'       CNRQ                                                237893
     C                     EXCPTTHEIR                                                         237893
     C                     BITON'6'       TDSTI                                               237893
     C                     ENDIF                                                              237893
      *                                                                                       237893
     C                     ENDIF                                                              237893
      *                                                                                       237893
     C                     ENDSR                                                              237893
      *****************************************************************                       237893
     C/COPY WNCPYSRC,DL0279C093
      *                                                                                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC1 - Processing #1 for CF deals                          *                       CDL033
      *         - Retrieve extension details of deal                  *                       CDL033
      *         - Rate fix date processing                            *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC1    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Check if advice has already been generated.                                          CDL033
      *                                                                                       CDL033
     C                     TESTB'0'       XKFRCI         60                                   CDL033
     C           *IN60     IFEQ *ON                                                           CDL033
     C                     MOVE 'Y'       WAMND   1                                           CDL033
     C                     ELSE                                                               CDL033
     C                     MOVE *BLANK    WAMND                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** No further processing required if rate fix date has                                  CDL033
      ** not been reached, or is equal to zero or it has                                      CDL033
      ** already been processed.                                                              CDL033
      *                                                                                       CDL033
     C           XKINFD    IFGT WEVCD                                                         CDL033
     C           XKINFD    OREQ *ZERO                                                         CDL033
     C           XKINFF    OREQ 'Y'                                                           CDL033
     C                     GOTO EFRC1                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Flag rate fix date as to be processed in this                                        CDL033
      ** run.                                                                                 CDL033
      *                                                                                       CDL033
     C                     MOVE 'Y'       WWINFF                                              CDL033
      *                                                                                       CDL033
      ** If rate has not been set for value date yet or rate                                  CDL033
      ** change date is within the current interest period,                                   CDL033
      ** regenerate interest date message and advice.                                         CDL033
      *                                                                                       CDL033
     C           XKBSVF    IFEQ *BLANK                                                        CDL033
     C           XKRCDT    ORLT NIDT                                                          CDL033
     C                     BITOF'2'       TLXI                                                CDL033
     C                     BITOF'2'       CNFI                                                CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Regenerate maturity message and advice.                                              CDL033
      ** Set on indicator for deals file update.                                              CDL033
      *                                                                                       CDL033
     C                     BITOF'1'       TLXI                                                CDL033
     C                     BITOF'1'       CNFI                                                CDL033
     C                     MOVE *ON       *IN66                                               CDL033
      *                                                                                       CDL033
      ** Generate rate fix advice.                                                            CDL033
      ** Retrieve base rate details.                                                          CDL033
      ** DB error if not found.                                                               CDL033
      *                                                                                       CDL033
     C                     MOVELBRTT      @BBSRT                                              CDL033
     C                     CALL 'AOBSRTR0'                                                    CDL033
     C                     PARM *BLANKS   @RTCD                                               CDL033
     C                     PARM '*KEY   ' @OPTN                                               CDL033
     C                     PARM CCY       @BCCY                                               CDL033
     C                     PARM           @BBSRT                                              CDL033
     C           SDBSRT    PARM SDBSRT    DSFDY                                               CDL033
      *                                                                                       CDL033
     C           @RTCD     IFNE *BLANKS                                                       CDL033
     C                     MOVE '032'     DBASE                                               CDL033
     C                     MOVELCCY       WDBKEY  5                                           CDL033
     C                     MOVE BRTT      WDBKEY                                              CDL033
     C                     MOVELWDBKEY    DBKEY                                               CDL033
     C                     MOVEL@OPTN     DBOPTN                                              CDL033
     C                     MOVEL'SDBSRTPD'DBFILE                                              CDL033
     C                     MOVE *ON       *INU7                                               CDL033
     C                     MOVE *ON       *INU8                                               CDL033
     C                     MOVE *ON       *INLR                                               CDL033
     C                     EXSR *PSSR                                                         CDL033
     C                     GOTO FINEND                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** If rate fix date falls before value date of new                                      CDL033
      ** rate, use old base rate.                                                             CDL033
      *                                                                                       CDL033
     C           XKINFD    IFLT BAVDNR                                                        CDL033
     C                     Z-ADDBACBSR    WCFRAT 117                                          CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDBANBRT    WCFRAT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Add spread rate to base rate.                                                        CDL033
      *                                                                                       CDL033
     C           WCFRAT    ADD  RTSP      WCFRAT                                              CDL033
      *                                                                                       CDL033
      ** Zeroise rate if it is negative.                                                      CDL033
      *                                                                                       CDL033
     C           WCFRAT    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     WCFRAT                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Output to DLINDDM.                                                                   CDL033
      *                                                                                       CDL033
     C                     EXCPTFRCD                                                          CDL033
     C           DLCT      ADD  1         DLCT                                                CDL033
      *                                                                                       CDL033
     C           EFRC1     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC2 - Processing #2 for CF deals                          *                       CDL033
      *         - Update DEALSDCF                                     *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC2    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Indicate advice as already generated for the current                                 CDL033
      ** interest period.  Then, perform update of new fields in                              CDL033
      ** DEALSDC.                                                                             CDL033
      *                                                                                       CDL033
     C                     BITON'0'       XKFRCI                                              CDL033
     C                     MOVE '1'       *IN66                                               CDL033
      *                                                                                       CDL033
     C           EFRC2     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC3 - Processing #3 for CF deals                          *                       CDL033
      *         - Value date processing                               *                       CDL033
      *         - Calculate interest due on next interest date /      *                       CDL033
      *           maturity date                                       *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC3    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Reset processing flag to blank.                                                      CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WCFLAG  1                                           CDL033
      *                                                                                       CDL033
      ** Initialise interest calculation work fields.  Work                                   CDL033
      ** fields are used to prevent file fields from being                                    CDL033
      ** changed.                                                                             CDL033
      *                                                                                       CDL033
     C                     Z-ADDIACD      WIACD   50                                          CDL033
     C                     Z-ADDAITC      WAITC  130                                          CDL033
     C                     Z-ADDIPRD      WIPRD  130                                          CDL033
     C                     MOVE XKINFF    WINFF   1                                           CDL033
      *                                                                                       CDL033
     C                     Z-ADDINTR      ZIRATE                                              CDL033
     C                     Z-ADDICBS      ZICALC                                              CDL033
     C                     Z-ADDPCPL      ZIAMT                                               CDL033
      *                                                                                       CDL033
      ** Value date processing.                                                               CDL033
      *                                                                                       CDL033
      ** Set up effective rate for value date if this rate                                    CDL033
      ** has to be set to the fixed base rate.                                                CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC5                                                        CDL033
      *                                                                                       CDL033
      ** Process rate change date.                                                            CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE VDAT                                                          CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Interest date processing.                                                            CDL033
      *                                                                                       CDL033
     C                     EXSR SRFRC6                                                        CDL033
      *                                                                                       CDL033
      ** Perform interest calculation for maturity if                                         CDL033
      ** message / confirmation is to be generated                                            CDL033
      ** for this event.                                                                      CDL033
      *                                                                                       CDL033
     C           WMSGMF    IFEQ 'Y'                                                           CDL033
     C           WCONMF    OREQ 'Y'                                                           CDL033
     C                     EXSR SRFRC7                                                        CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC3     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC4 - Processing #4 for CF deals                          *                       CDL033
      *         - Rate change processing:                             *                       CDL033
      *           (1) update accrued interest to control date         *                       CDL033
      *           (2) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC4    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing in this subroutine if rate change                                  CDL033
      ** date is zero.                                                                        CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFEQ *ZERO                                                         CDL033
     C                     GOTO EFRC4                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date.                                             CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDXKRCDT    ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT  130H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     WAITC                                               CDL033
      *                                                                                       CDL033
      ** Reset interest accrual control date to rate change                                   CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDXKRCDT    WIACD                                               CDL033
      *                                                                                       CDL033
      ** Update effective rate only if base rate has been                                     CDL033
      ** fixed or if rate fix date is to be processed in                                      CDL033
      ** this run.                                                                            CDL033
      *                                                                                       CDL033
     C           WINFF     IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      ZIRATE                                              CDL033
     C           ZIRATE    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ELSE                                                               CDL033
     C           WWINFF    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWCFRAT    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           EFRC4     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC5 - Processing #5 for CF deals                          *                       CDL033
      *         - Value date processing:                              *                       CDL033
      *           (1) set effective rate to fixed base rate           *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC5    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing if rate for value date has been                                    CDL033
      ** set already.                                                                         CDL033
      *                                                                                       CDL033
     C           XKBSVF    IFEQ 'Y'                                                           CDL033
     C                     GOTO EFRC5                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update effective rate only if base rate has been                                     CDL033
      ** fixed or if rate fix date is to be processed in                                      CDL033
      ** this run.                                                                            CDL033
      *                                                                                       CDL033
     C           WINFF     IFEQ 'Y'                                                           CDL033
     C           XKBSRF    ADD  RTSP      ZIRATE                                              CDL033
     C           ZIRATE    IFLT *ZERO                                                         CDL033
     C                     Z-ADD*ZERO     ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ELSE                                                               CDL033
     C           WWINFF    IFEQ 'Y'                                                           CDL033
     C                     Z-ADDWCFRAT    ZIRATE                                              CDL033
     C                     ENDIF                                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Reset the rate fix date flags.                                                       CDL033
      *                                                                                       CDL033
     C                     MOVE *BLANK    WINFF                                               CDL033
     C                     MOVE *BLANK    WWINFF                                              CDL033
      *                                                                                       CDL033
     C           EFRC5     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC6 - Processing #6 for CF deals                          *                       CDL033
      *         - Interest date processing                            *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC6    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Bypass processing if next interest date is zero.                                     CDL033
      *                                                                                       CDL033
     C           NIDT      IFEQ *ZERO                                                         CDL033
     C                     GOTO EFRC6                                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Process rate change date if it is not yet processed                                  CDL033
      ** before.                                                                              CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE NIDT                                                          CDL033
     C           WCFLAG    ANDEQ*BLANK                                                        CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Update accrued interest to control date up to                                        CDL033
      ** interest payment date.                                                               CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDNIDT      ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT     H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     WAITC                                               CDL033
      *                                                                                       CDL033
      ** Reset interest accrual control date to next interest                                 CDL033
      ** date.                                                                                CDL033
      *                                                                                       CDL033
     C                     Z-ADDNIDT      WIACD                                               CDL033
      *                                                                                       CDL033
      ** Calculate interest due on interest date.                                             CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  AIAP      WINTAI 130                                          CDL033
     C                     ADD  AIAN      WINTAI                                              CDL033
     C                     SUB  WIPRD     WINTAI                                              CDL033
     C                     SUB  ICTD      WINTAI                                              CDL033
      *                                                                                       CDL033
      ** Update interest paid / received to date.                                             CDL033
      *                                                                                       CDL033
     C                     ADD  WINTAI    WIPRD                                               CDL033
      *                                                                                       CDL033
     C           EFRC6     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  SRFRC7 - Processing #7 for CF deals                          *                       CDL033
      *         - Maturity date processing                            *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           SRFRC7    BEGSR                                                              CDL033
      *                                                                                       CDL033
      ** Process rate change date if it is not yet processed                                  CDL033
      ** before.                                                                              CDL033
      *                                                                                       CDL033
     C           XKRCDT    IFLE MDAT                                                          CDL033
     C           WCFLAG    ANDEQ*BLANK                                                        CDL033
     C                     EXSR SRFRC4                                                        CDL033
     C                     MOVE 'Y'       WCFLAG                                              CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Calculate interest from accrued interest to control                                  CDL033
      ** date up to maturity.                                                                 CDL033
      *                                                                                       CDL033
     C                     Z-ADDWIACD     ZIBEG                                               CDL033
     C                     Z-ADDMDAT      ZIEND                                               CDL033
      *                                                                                       CDL033
     C                     EXSR GLINTC                                                        CDL033
      *                                                                                       CDL033
      ** Round down or not.                                                                   CDL033
      ** This replaces a line removed from the internally                                     CDL033
      ** described GLINTC.                                                                    CDL033
      *                                                                                       CDL033
     C           JRDFC     IFEQ 'Y'                                                           CDL033
     C                     Z-ADDZINTR     WKINT                                               CDL033
     C                     ELSE                                                               CDL033
     C                     Z-ADDZINTR     WKINT     H                                         CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
      ** Calculate interest due on maturity.                                                  CDL033
      *                                                                                       CDL033
     C           WAITC     ADD  WKINT     WINTAM 130                                          CDL033
     C                     ADD  AIAP      WINTAM                                              CDL033
     C                     ADD  AIAN      WINTAM                                              CDL033
     C                     SUB  WIPRD     WINTAM                                              CDL033
     C                     SUB  ICTD      WINTAM                                              CDL033
      *                                                                                       CDL033
     C           EFRC7     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
      /EJECT                                                                                  CDL033
      *****************************************************************                       CDL033
      *                                                               *                       CDL033
      *  CKDEAL - Check if Deal Type is included in validations       *                       CDL033
      *                                                               *                       CDL033
      *****************************************************************                       CDL033
      *                                                                                       CDL033
     C           CKDEAL    BEGSR                                                              CDL033
      *                                                                                       CDL033
     C           DTYP      IFNE 'CF'                                                          CDL033
     C                     MOVE *OFF      @FXT    1                                           CDL033
     C                     MOVE *IN49     TVAR    1                                           CDL033
     C           DTYP      LOKUPFXT                      49                                   CDL033
     C           *IN49     IFEQ *ON                                                           CDL033
     C                     MOVE *ON       @FXT                                                CDL033
     C                     ENDIF                                                              CDL033
     C                     MOVE TVAR      *IN49                                               CDL033
     C                     ENDIF                                                              CDL033
      *                                                                                       CDL033
     C                     ENDSR                                                              CDL033
      *                                                                                       CDL033
      *****************************************************************                       CDL033
      /EJECT                                                                                AR845022
      *****************************************************************                     AR845022
      *                                                               *                     AR845022
      *  PCCHG  - Process principal changes schedule for RP, RR, RF   *                     AR845022
      *                                                               *                     AR845022
      *****************************************************************                     AR845022
      *                                                                                     AR845022
     C           PCCHG     BEGSR                                                            AR845022
     C                     Z-ADDSZAICD    PRDT                                              AR845022
     C                     Z-ADDSZAICD    PREV    50                                        AR845022
     C                     Z-ADDSZEDAT    EDATX   50                                        AR845022
      *                                                                                     AR845022
     C           PCSKEY    KLIST                                                            AR845022
     C                     KFLD           DLNO                                              AR845022
     C                     KFLD           OTIN                                              AR845022
     C                     KFLD           PRDT                                              AR845022
      *                                                                                     AR845022
     C           PCLKEY    KLIST                                                            AR845022
     C                     KFLD           DLNO                                              AR845022
     C                     KFLD           OTIN                                              AR845022
      *                                                                                     AR845022
     C           PCSKEY    SETLLDLPCSCD1                                                    AR845022
     C           PCLKEY    READEDLPCSCD1                 85                                 AR845022
      *                                                                                     AR845022
     C           *IN85     DOWEQ'0'                                                         AR845022
     C           PRDT      ANDLTEDATX                                                       AR845022
      *                                                                                     AR845022
     C                     Z-ADDPREV      SZAICD                                            AR845022
     C                     Z-ADDPRDT      SZEDAT                                            AR845022
     C                     EXSR SUB02                                                       AR845022
     C                     ADD  INTD      INTDX                                             AR845022
     C                     Z-ADDPAMT      SZPPL                                             AR845022
      *                                                                                     AR845022
     C           CIR002    IFEQ 'Y'                                                         AR845022
     C           CIR006    OREQ 'Y'                                                         AR845022
     C           XINPM     ANDEQ'A'                                                         AR845022
     C           CIR006    OREQ 'Y'                                                         AR845022
     C           XINPM     ANDEQ'I'                                                         AR845022
     C           CIR006    OREQ 'Y'                                                         AR845022
     C           XINPM     ANDEQ'L'                                                         AR845022
     C                     Z-ADDXUSI      SZPPL                                             AR845022
     C                     ENDIF                                                            AR845022
     C                     Z-ADDPRDT      PREV                                              AR845022
     C           PCLKEY    READEDLPCSCD1                 85                                 AR845022
     C                     ENDDO                                                            AR845022
      *                                                                                     AR845022
     C                     Z-ADDPREV      SZAICD                                            AR845022
     C                     ENDSR                                                            AR845022
      *****************************************************************                     AR845022
      /EJECT                                                              066550
     C/COPY WNCPYSRC,DL0279C086
     C/COPY ZSRSRC,ZINTDYZ2                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDATE9Z3                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,GLINTCZ1                                               066550
      /EJECT                                                              066550
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
      /COPY WNCPYSRC,DL0279CP13                                           S01408
     C/EJECT                                                              CIR013
     C/COPY ZSRSRC,ZFEB29                                                 CIR013
1185 O*LUPDDA*HADD***  05                                                 S01093
1186 O******                   LOTA     256                               S01093
1187 O******                   LOTB     400                               S01093
1188 O*LUPDDB*DADD***  40N05N10                                           S01093
1189 O****** AND       06N11                                              S01093
1190 O******                   LOTA     256                               S01093
1191 O******                   LOTB     400                               S01093
1189 ODEALS   D        06 66                                              S01093
1192 O                         CNFI     372
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
1193 O*************************TLXI*****374*************************E19374E23886
1193 O                         TLXI     374                               E23886
1188 O*LUPDDC*DADD***  40N05N10                                           S01093
1189 O****** AND       07N11                                              S01093
1190 O******                   LOTA     256                               S01093
1191 O******                   LOTB     400                               S01093
1189 O        D        07 66                                              S01093
1192 O                         CNFI     372
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
1193 O*************************TLXI*****374*************************E19374E23886
1193 O                         TLXI     374                               E23886
1188 O*LUPDDD*DADD***  40N05N10                                           S01093
1189 O****** AND       08N11                                              S01093
1190 O******                   LOTA     256                               S01093
1191 O******                   LOTB     400                               S01093
1189 O        D        08 66                                              S01093
1192 O                         CNFI     372
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
1193 O*************************TLXI*****374*************************E19374E23886
1193 O                         TLXI     374                               E23886
1188 O*LUPDDE*DADD***  40N05N10                                           S01093
1189 O****** AND       09N11                                              S01093
1190 O******                   LOTA     256                               S01093
1191 O******                   LOTB     400                               S01093
1189 O        D        09 66                                              S01093
1192 O                         CNFI     372
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
1193 O*************************TLXI*****374*************************E19374E23886
1193 O                         TLXI     374                               E23886
1189 O        D        12 66                                              S01119
1192 O                    21   UBRTE     77P                                                  177837
1192 O                    88   UBRTE     77P                                                AR316628
1192 O                    88   UEINR     90P                                                AR316628
1192 O                    22   TBRTE    221P                                                  177837
1192 O                    88   TBRTE    221P                                                AR316628
1192 O                    88   TEINR    234P                                                AR316628
1192 O                         UDNSI    570                               S01119
1193 O                         TDNSI    571                               S01119
     O                         UDSTI    572                                                   233128
     O                         TDSTI    573                                                   233128
1192 O                         CNFI     574                               S01119
1192 O                         UPPR     634                                                 AR316355
     C*                                                                   E23886
     C** Removed code reinstated:                                         E23886
1193 O*************************TLXI*****576*******************S01119E19374E23886
1193 O                         TLXI     576                               E23886
1194 O*LUPDDF*TADD***  LR                                                 S01093
1195 O******                             16 'T999999Z99999999'            S01093
1189 O        D        10                                                 S01093
1196 O***************          RLCT      19P                              S01093
1197 O                         FLSZ      22P
1198 O                         RDCT      25P
1199 O                         ICT       28P
1200 O                         DCT       31P
1201 O                         RDCT      34P
1202 O                         VLLI      42P
1203 O                         VLLD      44P
1204 O                         VLII      52P
1205 O                         VLID      54P
1206 O                         VLDI      62P
1207 O                         VLDD      64P
1208 O                         VLLI      72P
1209 O                         VLLD      74P
1210 O                         DTMR      77P
1211 O                         ITMR      80P
1212 O                         LCDO     396P
1213 O                                  397 ' '
1214 O                         TNLO     400P
1215 ODLINDHH HADD     05
1216 O                                    8 'H 000000'
1217 ODLINDDM DADD     50
1218 O                                    2 'DD'
1219 O                         DLNO       8
      /COPY WNCPYSRC,DL0279OOP2                                           S01408
1220 O                                   16 '00000000'
      /COPY WNCPYSRC,DL0279OOP3                                           S01408
1221 O                         ACTC      17
1222 O                                   18 'N'
1223 O                 33                18 'M'
1224 O                 34                18 'I'
      /COPY WNCPYSRC,DL0279OOP4                                           S01408
1225 O                         PRI1      27
1226 O                         PRI2      28
1227 O                         PRI3      29
1227 O*******                  BRCA      33                       S01117  LN0293
     O*******                  ZERO1     47P                      S01119  LN0293
     O*******                  ZERO1     54P                      S01119  LN0293
     O*******                  ZERO2     60P                      S01119  LN0293
     O*******                  ZERO2     66P                      S01119  LN0293
     O*******                  ZERO3     69P                      S01119  LN0293
     O*******                  ZERO1     76P                      S01119  LN0293
1227 O                         BRCA      37                               LN0293
     O                         ZERO1     50P                              LN0293
     O/COPY WNCPYSRC,DL0279O005
     O                 61      WINTAI    50P                                                  CDL033
     O                         ZERO1     57P                              LN0293
     O/COPY WNCPYSRC,DL0279O006
     O                 61      WINTAM    57P                                                  CDL033
     O                         ZERO2     63P                              LN0293
     O                         ZERO2     69P                              LN0293
     O                         ZERO3     72P                              LN0293
     O                         ZERO1     79P                              LN0293
     O*                                                                   S01119
1217 ODLINDDM EADD             BOTH                                       S01119
1218 O                                    2 'DD'                          S01119
1219 O                         DLNO       8                               S01119
1220 O                                   16 '00000000'                    S01119
1221 O                         ACTC      17                               S01119
1222 O                         CNRQ      18                               S01119
1225 O                         PRI1      27                               S01119
     O                                   28 '0'                           S01119
1227 O                         PRI3      29                               S01119
     O*******                  PIAMT     47P                      S01119  LN0293
     O*******                  RIAMT     54P                      S01119  LN0293
     O*******                  UFIR      60P                      S01119  LN0293
     O*******                  TFIR      66P                      S01119  LN0293
     O*******                  EVDAT     69P                      S01119  LN0293
     O*******                  TAXPY     76P                      S01119  LN0293
     O                         BRCA      37                               LN0794
     O                         PIAMT     50P                              LN0293
     O                         RIAMT     57P                              LN0293
     O                         UFIR      63P                              LN0293
     O                         TFIR      69P                              LN0293
     O                         EVDAT     72P                              LN0293
     O                         TAXPY     79P                              LN0293
     O*                                                                   S01119
1217 ODLINDDM EADD             OUR                                        S01119
1218 O                                    2 'DD'                          S01119
1219 O                         DLNO       8                               S01119
     O/COPY WNCPYSRC,DL0279O001
1220 O**********                         16 '00000000'                                 S01119 CIR007
     O/COPY WNCPYSRC,DL0279O002
     O                         WOIUVD    13                                                   CIR007
     O                                   16 '000'                                             CIR007
1221 O                         ACTC      17                               S01119
1222 O                         CNRQ      18                               S01119
     O                                   27 '0'                           S01119
     O                                   28 '0'                           S01119
1227 O                         PRI3      29                               S01119
     O******                   PIAMT     47P                       S01119 LN0293
     O******                   ZERO1     54P                       S01119 LN0293
     O******                   UFIR      60P                       S01119 LN0293
     O******                   TFIR      66P                       S01119 LN0293
     O******                   EVDAT     69P                       S01119 LN0293
     O******                   TAXPY     76P                       S01119 LN0293
     O                         BRCA      37                               LN0794
     O                         PIAMT     50P                              LN0293
     O                         ZERO1     57P                              LN0293
     O                         UFIR      63P                              LN0293
     O                         TFIR      69P                              LN0293
     O                         EVDAT     72P                              LN0293
     O                         TAXPY     79P                              LN0293
     O*                                                                   S01119
1217 ODLINDDM EADD             THEIR                                      S01119
1218 O                                    2 'DD'                          S01119
1219 O                         DLNO       8                               S01119
     O/COPY WNCPYSRC,DL0279O003
1220 O**********                         16 '00000000'                                 S01119 CIR007
     O/COPY WNCPYSRC,DL0279O004
     O                         WOITVD    13                                                   CIR007
     O                                   16 '000'                                             CIR007
1221 O                         ACTC      17                               S01119
1222 O                         CNRQ      18                               S01119
1225 O                         PRI1      27                               S01119
     O                                   28 '0'                           S01119
     O                                   29 '0'                           S01119
     O******                   ZERO1     47P                       S01119 LN0293
     O******                   RIAMT     54P                       S01119 LN0293
     O******                   UFIR      60P                       S01119 LN0593
     O******                   TFIR      66P                       S01119 LN0293
     O******                   EVDAT     69P                       S01119 LN0293
     O******                   ZERO1     76P                       S01119 LN0293
     O                         BRCA      37                               LN0794
     O                         ZERO1     50P                              S01119
     O                         RIAMT     57P                              S01119
     O                         UFIR      63P                              S01119
     O                         TFIR      69P                              S01119
     O                         EVDAT     72P                              S01119
     O                         ZERO1     79P                              S01119
      *                                                                   CIR001
     ODLINDDM EADD             IRSFEE                                     CIR001
     O                                    2 'DD'                          CIR001
     O                         DLNO       8                               CIR001
     O                         VDAT      13                               CIR001
     O                         DASN      16                               CIR001
     O                         CHTP      17                               CIR001
     O                         CNRQ      18                               CIR001
     O                         CNPR      19                               CIR001
     O                         REPR      20                               CIR001
     O                         RRLA      25                               CIR001
     O                         DADI      26                               CIR001
     O                         PRI1      27                               CIR001
     O                         PRI2      28                               CIR001
     O                         PRI3      29                               CIR001
     O                         ZZ004     33                               CIR001
     O                         ICIN      34                               CIR001
     O                         BRCA      37                               CIR001
     O                         RRNT      40P                              CIR001
     O                         TNLU      43P                              CIR001
     O                         PIAMT     50P                              CIR001
     O                         RIAMT     57P                              CIR001
     O                         UFIR      63P                              CIR001
     O                         TFIR      69P                              CIR001
     O                         EVDAT     72P                              CIR001
     O                         TAXPY     79P                              CIR001
     O/COPY WNCPYSRC,DL0279O007
     ODLINDDM EADD             FRCD                                                           CDL033
     O                                    2 'DD'                                              CDL033
     O                         DLNO       8                                                   CDL033
     O                                   16 '99999999'                                        CDL033
     O                                   17 'I'                                               CDL033
     O                                   18 'D'                                               CDL033
     O                         PRI1      27                                                   CDL033
     O                         PRI2      28                                                   CDL033
     O                         PRI3      29                                                   CDL033
     O                         BRCA      37                                                   CDL033
     O                         ZERO1     50P                                                  CDL033
     O                         ZERO1     57P                                                  CDL033
     O                         WCFRAT    63P                                                  CDL033
     O                         ZERO2     69P                                                  CDL033
     O                         ZERO3     72P                                                  CDL033
     O                         ZERO1     79P                                                  CDL033
      *                                                                   CIR001
1228 ODLINDZX TADD     LR
1229 O                                    1 'T'
1230 O                         DLCT       6
      /COPY WNCPYSRC,DL0279OOP5                                           S01408
1231 O*L0279P1T  203   LR                                         S01124  S01117
     ODL0279AUT  203   LR                                                 S01117
     O                                   24 'REFERENCE DL0279AU'          S01117
1232 O*                                  22 'REFERENCE DL0279'            S01117
1233 O*****                    TITL      89                       *****   S01194
1233 O                         BJURPT    89                               S01194
1234 O                                  104 'DATE'
1235 O*****                    RUNA     112                       *****   S01194
1235 O                         BJMRDT   112                               S01194
1236 O                                  122 'PAGE'
1237 O                         PAGE  Z  127
1238 O        T  1     LR
1239 O                                   59 'DEALS FILE UPDATE -'
1240 O                                   83 'PHASE 1 - FILE CONTROLS'
1241 O        T  3     LR
1242 O                                   59 '-------------------'
1243 O                                   83 '------------------------'
1244 O        T  1     LR
1245 O                                   28 'S/DEALS - RUN CONTROLS'
1246 O                                   59 'NUMBER'
1247 O                                   84 'VALUE'
1248 O        T  2     LR
1249 O                                   28 '----------------------'
1250 O                                   59 'OF RECORDS'
1251 O                                   84 'OF RECORDS'
1252 O******  T  2     LR                                                 S01093
1253 O******                             29 'TOTAL RECORDS ON FILE'       S01093
1254 O******                   NORED 3   59                               S01093
1255 O        T  2     LR
1256 O******                             25 'CURRENT RECORDS -'           S01093
1256 O                                   25 'LIVE RECORDS  -  '           S01093
1257 O                                   46 'START OF INPUT CYCLE'
1258 O                         NLRB  3   59
1259 O                         VLBF  4   81
1260 O                         VLBL      84
1261 O        T  2     LR
1262 O                                   16 'INSERTED'
1263 O                         NINS  3   59
1264 O                         VRIF  4   81
1265 O                         VRIL      84
1266 O        T  2     LR
1267 O                                   15 'DELETED'
1268 O                         NDEL  3   59
1269 O                         VRDF  4   81
1270 O                         VRDL      84
1271 O        T  2     LR
1272 O******                             25 'CURRENT RECORDS -'           S01093
1272 O                                   25 'LIVE RECORDS  -  '           S01093
1273 O                                   44 'END OF INPUT CYCLE'
1274 O                         NLRA  3   59
1275 O                         VLAF  4   81
1276 O                         VLAL      84
1277 O        T  2     LR
1272 O******                             25 'CURRENT RECORDS -'           S01093
1272 O                                   25 'LIVE RECORDS  -  '           S01093
1279 O                                   49 'END OF I/C - CALCULATED'
1280 O                         CNLRA 3   59
1281 O                         CVLF  4   81
1282 O                         CVLL      84
1283 O                 51               111 '***   DIFFERENCE   ***'
1284 O******  T 21     LR                                                 S01093
1285 O******                             28 'S/DLUPD - RUN CONTROLS'      S01093
1286 O******  T  2     LR                                                 S01093
1287 O******                             28 '----------------------'      S01093
1288 O******  T  2     LR                                                 S01093
1289 O******                             27 'RECORDS NOT BROUGHT'         S01093
1290 O******                             48 'FORWARD FROM S/DEALS'        S01093
1291 O******                   DECT  3   59                               S01093
1292 O******  T  2     LR                                                 S01093
1293 O******                             32 'TOTAL RECORDS ON S/DLUPD'    S01093
1294 O******                   RLCT  3   59                               S01093
1295 O******           52               111 '***   DIFFERENCE   ***'      S01093
1296 O        T  149   LR
1297 O                                   28 'S/DLIND - RUN CONTROLS'
1298 O        T  2     LR
1299 O                                   28 '----------------------'
1300 O        T  3     LR
1301 O                                   29 'TOTAL RECORDS ON FILE'
1302 O                         DLCT  3   59
     O*                                                                   S01117
     O** OUTPUT DATABASE ERROR IF NECESSARY                               S01117
     O        T 3      LR U7 U8                                           S01117
     O                                   71 '*** PRINT TERMINATED ***'    S01117
     O        T 1      LR U7 U8                                           S01117
     O                                   57 'DATABASE ERROR'              S01117
     O                         DBASE     61                               S01117
     O                                   67 'FILE'                        S01117
     O                         DBFILE    78                               S01117
     O        T 13     LR U7 U8                                           S01117
     O                                   49 'OPTION'                      S01117
     O                         DBOPTN    57                               S01117
     O                                   66 'KEY'                         S01117
     O                         DBKEY     96                               S01117
     O*                                                                   S01117
     O**
1303 O*****   T 3      LR                                                 LN0135
1304 O*****                              62 '***   END OF REPORT'         LN0135
1305 O*****                              68 '***'                         LN0135
      ********  TABSET -- TABLE OF SETTLEMENT TYPES.                      S01117
      *********010708                                                     S01117
      /COPY WNCPYSRC,DL0279OOP1                                           S01408
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  TABTYP -- TABLE OF DEAL TYPES.
ITIPTDTICDCLDLILIDFLDPLPFTDTLTCF                                                S01354 CDL006 CDL033
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN                    S01119
0366073110961461                                                          S01119
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        S01119
000031059090120151181212243273304334365                                   S01119
**   ZMNM - MONTHS SHORT NAMES                                            S01119
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                      S01119
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
** FXT                                                                                        CDL033
ITIPTDTICI                                                                                    CDL033
